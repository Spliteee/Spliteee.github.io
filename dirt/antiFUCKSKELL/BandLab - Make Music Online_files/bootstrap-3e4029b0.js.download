!function(e){var t={objectMaxDepth:5,urlErrorParamsEnabled:!0};function n(e){if(!F(e))return t;U(e.objectMaxDepth)&&(t.objectMaxDepth=o(e.objectMaxDepth)?e.objectMaxDepth:NaN),U(e.urlErrorParamsEnabled)&&X(e.urlErrorParamsEnabled)&&(t.urlErrorParamsEnabled=e.urlErrorParamsEnabled)}function o(e){return V(e)&&e>0}function r(e,n){n=n||Error;var o="https://errors.angularjs.org/1.8.3/",r=o.replace(".","\\.")+"[\\s\\S]*",i=new RegExp(r,"g");return function(){var r,a,s=arguments[0],l=arguments[1],c="["+(e?e+":":"")+s+"] ",u=pe(arguments,2).map((function(e){return Ge(e,t.objectMaxDepth)}));if(c+=l.replace(/\{\d+\}/g,(function(e){var t=+e.slice(1,-1);return t<u.length?u[t].replace(i,""):e})),c+="\n"+o+(e?e+"/":"")+s,t.urlErrorParamsEnabled)for(a=0,r="?";a<u.length;a++,r="&")c+=r+"p"+a+"="+encodeURIComponent(u[a]);return new n(c)}}var i,a,s,l,c=/^\/(.+)\/([a-z]*)$/,u="validity",d=Object.prototype.hasOwnProperty,p=function(e){return W(e)?e.toLowerCase():e},m=function(e){return W(e)?e.toUpperCase():e},f=[].slice,h=[].splice,g=[].push,v=Object.prototype.toString,b=Object.getPrototypeOf,y=r("ng"),w=e.angular||(e.angular={}),$=0;function k(e){if(null==e||Y(e))return!1;if(z(e)||W(e)||a&&e instanceof a)return!0;var t="length"in Object(e)&&e.length;return V(t)&&(t>=0&&t-1 in e||"function"==typeof e.item)}function S(e,t,n){var o,r;if(e)if(G(e))for(o in e)"prototype"!==o&&"length"!==o&&"name"!==o&&e.hasOwnProperty(o)&&t.call(n,e[o],o,e);else if(z(e)||k(e)){var i="object"!=typeof e;for(o=0,r=e.length;o<r;o++)(i||o in e)&&t.call(n,e[o],o,e)}else if(e.forEach&&e.forEach!==S)e.forEach(t,n,e);else if(B(e))for(o in e)t.call(n,e[o],o,e);else if("function"==typeof e.hasOwnProperty)for(o in e)e.hasOwnProperty(o)&&t.call(n,e[o],o,e);else for(o in e)d.call(e,o)&&t.call(n,e[o],o,e);return e}function _(e,t,n){for(var o=Object.keys(e).sort(),r=0;r<o.length;r++)t.call(n,e[o[r]],o[r]);return o}function P(e){return function(t,n){e(n,t)}}function M(){return++$}function T(e,t){t?e.$$hashKey=t:delete e.$$hashKey}function C(e,t,n){for(var o=e.$$hashKey,r=0,i=t.length;r<i;++r){var a=t[r];if(F(a)||G(a))for(var s=Object.keys(a),l=0,c=s.length;l<c;l++){var u=s[l],d=a[u];n&&F(d)?q(d)?e[u]=new Date(d.valueOf()):K(d)?e[u]=new RegExp(d):d.nodeName?e[u]=d.cloneNode(!0):ne(d)?e[u]=d.clone():"__proto__"!==u&&(F(e[u])||(e[u]=z(d)?[]:{}),C(e[u],[d],!0)):e[u]=d}}return T(e,o),e}function E(e){return C(e,f.call(arguments,1),!1)}function I(e){return C(e,f.call(arguments,1),!0)}function R(e){return parseInt(e,10)}i=e.document.documentMode;var A=Number.isNaN||function(e){return e!=e};function x(e,t){return E(Object.create(e),t)}function L(){}function O(e){return e}function j(e){return function(){return e}}function D(e){return G(e.toString)&&e.toString!==v}function N(e){return void 0===e}function U(e){return void 0!==e}function F(e){return null!==e&&"object"==typeof e}function B(e){return null!==e&&"object"==typeof e&&!b(e)}function W(e){return"string"==typeof e}function V(e){return"number"==typeof e}function q(e){return"[object Date]"===v.call(e)}function z(e){return Array.isArray(e)||e instanceof Array}function H(e){switch(v.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return e instanceof Error}}function G(e){return"function"==typeof e}function K(e){return"[object RegExp]"===v.call(e)}function Y(e){return e&&e.window===e}function J(e){return e&&e.$evalAsync&&e.$watch}function X(e){return"boolean"==typeof e}function Z(e){return e&&G(e.then)}L.$inject=[],O.$inject=[];var Q=/^\[object (?:Uint8|Uint8Clamped|Uint16|Uint32|Int8|Int16|Int32|Float32|Float64)Array]$/,ee=function(e){return W(e)?e.trim():e},te=function(e){return e.replace(/([-()[\]{}+?*.$^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")};function ne(e){return!(!e||!(e.nodeName||e.prop&&e.attr&&e.find))}function oe(e){return p(e.nodeName||e[0]&&e[0].nodeName)}function re(e,t){return-1!==Array.prototype.indexOf.call(e,t)}function ie(e,t){var n=e.indexOf(t);return n>=0&&e.splice(n,1),n}function ae(e,t,n){var r,i,a=[],s=[];if(n=o(n)?n:NaN,t){if((i=t)&&V(i.length)&&Q.test(v.call(i))||(r=t,"[object ArrayBuffer]"===v.call(r)))throw y("cpta","Can't copy! TypedArray destination cannot be mutated.");if(e===t)throw y("cpi","Can't copy! Source and destination are identical.");return z(t)?t.length=0:S(t,(function(e,n){"$$hashKey"!==n&&delete t[n]})),a.push(e),s.push(t),l(e,t,n)}return c(e,n);function l(e,t,n){if(--n<0)return"...";var o,r=t.$$hashKey;if(z(e))for(var i=0,a=e.length;i<a;i++)t.push(c(e[i],n));else if(B(e))for(o in e)t[o]=c(e[o],n);else if(e&&"function"==typeof e.hasOwnProperty)for(o in e)e.hasOwnProperty(o)&&(t[o]=c(e[o],n));else for(o in e)d.call(e,o)&&(t[o]=c(e[o],n));return T(t,r),t}function c(e,t){if(!F(e))return e;var n=a.indexOf(e);if(-1!==n)return s[n];if(Y(e)||J(e))throw y("cpws","Can't copy! Making copies of Window or Scope instances is not supported.");var o=!1,r=function(e){switch(v.call(e)){case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Float32Array]":case"[object Float64Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return new e.constructor(c(e.buffer),e.byteOffset,e.length);case"[object ArrayBuffer]":if(!e.slice){var t=new ArrayBuffer(e.byteLength);return new Uint8Array(t).set(new Uint8Array(e)),t}return e.slice(0);case"[object Boolean]":case"[object Number]":case"[object String]":case"[object Date]":return new e.constructor(e.valueOf());case"[object RegExp]":var n=new RegExp(e.source,e.toString().match(/[^/]*$/)[0]);return n.lastIndex=e.lastIndex,n;case"[object Blob]":return new e.constructor([e],{type:e.type})}if(G(e.cloneNode))return e.cloneNode(!0)}(e);return void 0===r&&(r=z(e)?[]:Object.create(b(e)),o=!0),a.push(e),s.push(r),o?l(e,r,t):r}}function se(e,t){return e===t||e!=e&&t!=t}function le(e,t){if(e===t)return!0;if(null===e||null===t)return!1;if(e!=e&&t!=t)return!0;var n,o,r,i=typeof e;if(i===typeof t&&"object"===i){if(!z(e)){if(q(e))return!!q(t)&&se(e.getTime(),t.getTime());if(K(e))return!!K(t)&&e.toString()===t.toString();if(J(e)||J(t)||Y(e)||Y(t)||z(t)||q(t)||K(t))return!1;for(o in r=Ue(),e)if("$"!==o.charAt(0)&&!G(e[o])){if(!le(e[o],t[o]))return!1;r[o]=!0}for(o in t)if(!(o in r)&&"$"!==o.charAt(0)&&U(t[o])&&!G(t[o]))return!1;return!0}if(!z(t))return!1;if((n=e.length)===t.length){for(o=0;o<n;o++)if(!le(e[o],t[o]))return!1;return!0}}return!1}var ce=function(){if(!U(ce.rules)){var t=e.document.querySelector("[ng-csp]")||e.document.querySelector("[data-ng-csp]");if(t){var n=t.getAttribute("ng-csp")||t.getAttribute("data-ng-csp");ce.rules={noUnsafeEval:!n||-1!==n.indexOf("no-unsafe-eval"),noInlineStyle:!n||-1!==n.indexOf("no-inline-style")}}else ce.rules={noUnsafeEval:function(){try{return new Function(""),!1}catch(e){return!0}}(),noInlineStyle:!1}}return ce.rules},ue=function(){if(U(ue.name_))return ue.name_;var t,n,o,r,i=Me.length;for(n=0;n<i;++n)if(o=Me[n],t=e.document.querySelector("["+o.replace(":","\\:")+"jq]")){r=t.getAttribute(o+"jq");break}return ue.name_=r};function de(e,t,n){return e.concat(f.call(t,n))}function pe(e,t){return f.call(e,t||0)}function me(e,t){var n=arguments.length>2?pe(arguments,2):[];return!G(t)||t instanceof RegExp?t:n.length?function(){return arguments.length?t.apply(e,de(n,arguments,0)):t.apply(e,n)}:function(){return arguments.length?t.apply(e,arguments):t.call(e)}}function fe(t,n){var o=n;return"string"==typeof t&&"$"===t.charAt(0)&&"$"===t.charAt(1)?o=void 0:Y(n)?o="$WINDOW":n&&e.document===n?o="$DOCUMENT":J(n)&&(o="$SCOPE"),o}function he(e,t){if(!N(e))return V(t)||(t=t?2:null),JSON.stringify(e,fe,t)}function ge(e){return W(e)?JSON.parse(e):e}var ve=/:/g;function be(e,t){e=e.replace(ve,"");var n=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return A(n)?t:n}function ye(e,t){return(e=new Date(e.getTime())).setMinutes(e.getMinutes()+t),e}function we(e,t,n){n=n?-1:1;var o=e.getTimezoneOffset();return ye(e,n*(be(t,o)-o))}function $e(e){e=a(e).clone().empty();var t=a("<div></div>").append(e).html();try{return e[0].nodeType===We?p(t):t.match(/^(<[^>]+>)/)[1].replace(/^<([\w-]+)/,(function(e,t){return"<"+p(t)}))}catch(e){return p(t)}}function ke(e){try{return decodeURIComponent(e)}catch(e){}}function Se(e){var t={};return S((e||"").split("&"),(function(e){var n,o,r;e&&(o=e=e.replace(/\+/g,"%20"),-1!==(n=e.indexOf("="))&&(o=e.substring(0,n),r=e.substring(n+1)),U(o=ke(o))&&(r=!U(r)||ke(r),d.call(t,o)?z(t[o])?t[o].push(r):t[o]=[t[o],r]:t[o]=r))})),t}function _e(e){return Pe(e,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function Pe(e,t){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,t?"%20":"+")}var Me=["ng-","data-ng-","ng:","x-ng-"],Te=function(t){var n=t.currentScript;if(!n)return!0;if(!(n instanceof e.HTMLScriptElement||n instanceof e.SVGScriptElement))return!1;var o=n.attributes;return[o.getNamedItem("src"),o.getNamedItem("href"),o.getNamedItem("xlink:href")].every((function(e){if(!e)return!0;if(!e.value)return!1;var n=t.createElement("a");if(n.href=e.value,t.location.origin===n.origin)return!0;switch(n.protocol){case"http:":case"https:":case"ftp:":case"blob:":case"file:":case"data:":return!0;default:return!1}}))}(e.document);function Ce(t,n,o){F(o)||(o={}),o=E({strictDi:!1},o);var r=function(){if((t=a(t)).injector()){var r=t[0]===e.document?"document":$e(t);throw y("btstrpd","App already bootstrapped with this element '{0}'",r.replace(/</,"&lt;").replace(/>/,"&gt;"))}(n=n||[]).unshift(["$provide",function(e){e.value("$rootElement",t)}]),o.debugInfoEnabled&&n.push(["$compileProvider",function(e){e.debugInfoEnabled(!0)}]),n.unshift("ng");var i=tn(n,o.strictDi);return i.invoke(["$rootScope","$rootElement","$compile","$injector",function(e,t,n,o){e.$apply((function(){t.data("$injector",o),n(t)(e)}))}]),i},i=/^NG_ENABLE_DEBUG_INFO!/,s=/^NG_DEFER_BOOTSTRAP!/;if(e&&i.test(e.name)&&(o.debugInfoEnabled=!0,e.name=e.name.replace(i,"")),e&&!s.test(e.name))return r();e.name=e.name.replace(s,""),w.resumeBootstrap=function(e){return S(e,(function(e){n.push(e)})),r()},G(w.resumeDeferredBootstrap)&&w.resumeDeferredBootstrap()}function Ee(){e.name="NG_ENABLE_DEBUG_INFO!"+e.name,e.location.reload()}function Ie(e){var t=w.element(e).injector();if(!t)throw y("test","no injector found for element argument to getTestability");return t.get("$$testability")}var Re=/[A-Z]/g;function Ae(e,t){return t=t||"_",e.replace(Re,(function(e,n){return(n?t:"")+e.toLowerCase()}))}var xe=!1;function Le(){gt.legacyXHTMLReplacement=!0}function Oe(e,t,n){if(!e)throw y("areq","Argument '{0}' is {1}",t||"?",n||"required");return e}function je(e,t,n){return n&&z(e)&&(e=e[e.length-1]),Oe(G(e),t,"not a function, got "+(e&&"object"==typeof e?e.constructor.name||"Object":typeof e)),e}function De(e,t){if("hasOwnProperty"===e)throw y("badname","hasOwnProperty is not a valid {0} name",t)}function Ne(e){for(var t,n=e[0],o=e[e.length-1],r=1;n!==o&&(n=n.nextSibling);r++)(t||e[r]!==n)&&(t||(t=a(f.call(e,0,r))),t.push(n));return t||e}function Ue(){return Object.create(null)}function Fe(e){if(null==e)return"";switch(typeof e){case"string":break;case"number":e=""+e;break;default:e=!D(e)||z(e)||q(e)?he(e):e.toString()}return e}var Be=1,We=3,Ve=8,qe=9,ze=11;function He(e,t){if(z(e)){t=t||[];for(var n=0,o=e.length;n<o;n++)t[n]=e[n]}else if(F(e))for(var r in t=t||{},e)"$"===r.charAt(0)&&"$"===r.charAt(1)||(t[r]=e[r]);return t||e}function Ge(e,t){return"function"==typeof e?e.toString().replace(/ \{[\s\S]*$/,""):N(e)?"undefined":"string"!=typeof e?function(e,t){var n=[];return o(t)&&(e=w.copy(e,null,t)),JSON.stringify(e,(function(e,t){if(F(t=fe(e,t))){if(n.indexOf(t)>=0)return"...";n.push(t)}return t}))}(e,t):e}var Ke={full:"1.8.3",major:1,minor:8,dot:3,codeName:"ultimate-farewell"};gt.expando="ng339";var Ye=gt.cache={},Je=1;gt._data=function(e){return this.cache[e[this.expando]]||{}};var Xe=/-([a-z])/g,Ze=/^-ms-/,Qe={mouseleave:"mouseout",mouseenter:"mouseover"},et=r("jqLite");function tt(e,t){return t.toUpperCase()}function nt(e){return e.replace(Xe,tt)}var ot=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,rt=/<|&#?\w+;/,it=/<([\w:-]+)/,at=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,st={thead:["table"],col:["colgroup","table"],tr:["tbody","table"],td:["tr","tbody","table"]};st.tbody=st.tfoot=st.colgroup=st.caption=st.thead,st.th=st.td;var lt={option:[1,'<select multiple="multiple">',"</select>"],_default:[0,"",""]};for(var ct in st){var ut=st[ct],dt=ut.slice().reverse();lt[ct]=[dt.length,"<"+dt.join("><")+">","</"+ut.join("></")+">"]}function pt(e){return!rt.test(e)}function mt(e){var t=e.nodeType;return t===Be||!t||t===qe}function ft(t,n){var o,r,a,s,l,c=n.createDocumentFragment(),u=[];if(pt(t))u.push(n.createTextNode(t));else{if(o=c.appendChild(n.createElement("div")),r=(it.exec(t)||["",""])[1].toLowerCase(),s=gt.legacyXHTMLReplacement?t.replace(at,"<$1></$2>"):t,i<10)for(a=lt[r]||lt._default,o.innerHTML=a[1]+s+a[2],l=a[0];l--;)o=o.firstChild;else{for(l=(a=st[r]||[]).length;--l>-1;)o.appendChild(e.document.createElement(a[l])),o=o.firstChild;o.innerHTML=s}u=de(u,o.childNodes),(o=c.firstChild).textContent=""}return c.textContent="",c.innerHTML="",S(u,(function(e){c.appendChild(e)})),c}lt.optgroup=lt.option;var ht=e.Node.prototype.contains||function(e){return!!(16&this.compareDocumentPosition(e))};function gt(t){if(t instanceof gt)return t;var n,o,r,i;if(W(t)&&(t=ee(t),n=!0),!(this instanceof gt)){if(n&&"<"!==t.charAt(0))throw et("nosel","Looking up elements via selectors is not supported by jqLite! See: http://docs.angularjs.org/api/angular.element");return new gt(t)}n?Ct(this,(o=t,r=r||e.document,(i=ot.exec(o))?[r.createElement(i[1])]:(i=ft(o,r))?i.childNodes:[])):G(t)?xt(t):Ct(this,t)}function vt(e){return e.cloneNode(!0)}function bt(e,t){!t&&mt(e)&&a.cleanData([e]),e.querySelectorAll&&a.cleanData(e.querySelectorAll("*"))}function yt(e){var t;for(t in e)return!1;return!0}function wt(e){var t=e.ng339,n=t&&Ye[t],o=n&&n.events,r=n&&n.data;r&&!yt(r)||o&&!yt(o)||(delete Ye[t],e.ng339=void 0)}function $t(e,t,n,o){if(U(o))throw et("offargs","jqLite#off() does not support the `selector` argument");var r=St(e),i=r&&r.events,a=r&&r.handle;if(a){if(t){var s=function(t){var o=i[t];U(n)&&ie(o||[],n),U(n)&&o&&o.length>0||(e.removeEventListener(t,a),delete i[t])};S(t.split(" "),(function(e){s(e),Qe[e]&&s(Qe[e])}))}else for(t in i)"$destroy"!==t&&e.removeEventListener(t,a),delete i[t];wt(e)}}function kt(e,t){var n=e.ng339,o=n&&Ye[n];o&&(t?delete o.data[t]:o.data={},wt(e))}function St(e,t){var n=e.ng339,o=n&&Ye[n];return t&&!o&&(e.ng339=n=++Je,o=Ye[n]={events:{},data:{},handle:void 0}),o}function _t(e,t,n){if(mt(e)){var o,r=U(n),i=!r&&t&&!F(t),a=!t,s=St(e,!i),l=s&&s.data;if(r)l[nt(t)]=n;else{if(a)return l;if(i)return l&&l[nt(t)];for(o in t)l[nt(o)]=t[o]}}}function Pt(e,t){return!!e.getAttribute&&(" "+(e.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+t+" ")>-1}function Mt(e,t){if(t&&e.setAttribute){var n=(" "+(e.getAttribute("class")||"")+" ").replace(/[\n\t]/g," "),o=n;S(t.split(" "),(function(e){e=ee(e),o=o.replace(" "+e+" "," ")})),o!==n&&e.setAttribute("class",ee(o))}}function Tt(e,t){if(t&&e.setAttribute){var n=(" "+(e.getAttribute("class")||"")+" ").replace(/[\n\t]/g," "),o=n;S(t.split(" "),(function(e){e=ee(e),-1===o.indexOf(" "+e+" ")&&(o+=e+" ")})),o!==n&&e.setAttribute("class",ee(o))}}function Ct(e,t){if(t)if(t.nodeType)e[e.length++]=t;else{var n=t.length;if("number"==typeof n&&t.window!==t){if(n)for(var o=0;o<n;o++)e[e.length++]=t[o]}else e[e.length++]=t}}function Et(e,t){return It(e,"$"+(t||"ngController")+"Controller")}function It(e,t,n){e.nodeType===qe&&(e=e.documentElement);for(var o=z(t)?t:[t];e;){for(var r=0,i=o.length;r<i;r++)if(U(n=a.data(e,o[r])))return n;e=e.parentNode||e.nodeType===ze&&e.host}}function Rt(e){for(bt(e,!0);e.firstChild;)e.removeChild(e.firstChild)}function At(e,t){t||bt(e);var n=e.parentNode;n&&n.removeChild(e)}function xt(t){function n(){e.document.removeEventListener("DOMContentLoaded",n),e.removeEventListener("load",n),t()}"complete"===e.document.readyState?e.setTimeout(t):(e.document.addEventListener("DOMContentLoaded",n),e.addEventListener("load",n))}var Lt=gt.prototype={ready:xt,toString:function(){var e=[];return S(this,(function(t){e.push(""+t)})),"["+e.join(", ")+"]"},eq:function(e){return a(e>=0?this[e]:this[this.length+e])},length:0,push:g,sort:[].sort,splice:[].splice},Ot={};S("multiple,selected,checked,disabled,readOnly,required,open".split(","),(function(e){Ot[p(e)]=e}));var jt={};S("input,select,option,textarea,button,form,details".split(","),(function(e){jt[e]=!0}));var Dt={ngMinlength:"minlength",ngMaxlength:"maxlength",ngMin:"min",ngMax:"max",ngPattern:"pattern",ngStep:"step"};function Nt(e,t){var n=Ot[t.toLowerCase()];return n&&jt[oe(e)]&&n}function Ut(e,t,n){n.call(e,t)}function Ft(e,t,n){var o=t.relatedTarget;o&&(o===e||ht.call(e,o))||n.call(e,t)}function Bt(){this.$get=function(){return E(gt,{hasClass:function(e,t){return e.attr&&(e=e[0]),Pt(e,t)},addClass:function(e,t){return e.attr&&(e=e[0]),Tt(e,t)},removeClass:function(e,t){return e.attr&&(e=e[0]),Mt(e,t)}})}}function Wt(e,t){var n=e&&e.$$hashKey;if(n)return"function"==typeof n&&(n=e.$$hashKey()),n;var o=typeof e;return"function"===o||"object"===o&&null!==e?e.$$hashKey=o+":"+(t||M)():o+":"+e}S({data:_t,removeData:kt,hasData:function(e){for(var t in Ye[e.ng339])return!0;return!1},cleanData:function(e){for(var t=0,n=e.length;t<n;t++)kt(e[t]),$t(e[t])}},(function(e,t){gt[t]=e})),S({data:_t,inheritedData:It,scope:function(e){return a.data(e,"$scope")||It(e.parentNode||e,["$isolateScope","$scope"])},isolateScope:function(e){return a.data(e,"$isolateScope")||a.data(e,"$isolateScopeNoTemplate")},controller:Et,injector:function(e){return It(e,"$injector")},removeAttr:function(e,t){e.removeAttribute(t)},hasClass:Pt,css:function(e,t,n){if(t=function(e){return nt(e.replace(Ze,"ms-"))}(t),!U(n))return e.style[t];e.style[t]=n},attr:function(e,t,n){var o,r=e.nodeType;if(r!==We&&2!==r&&r!==Ve&&e.getAttribute){var i=p(t),a=Ot[i];if(!U(n))return o=e.getAttribute(t),a&&null!==o&&(o=i),null===o?void 0:o;null===n||!1===n&&a?e.removeAttribute(t):e.setAttribute(t,a?i:n)}},prop:function(e,t,n){if(!U(n))return e[t];e[t]=n},text:function(){return e.$dv="",e;function e(e,t){if(N(t)){var n=e.nodeType;return n===Be||n===We?e.textContent:""}e.textContent=t}}(),val:function(e,t){if(N(t)){if(e.multiple&&"select"===oe(e)){var n=[];return S(e.options,(function(e){e.selected&&n.push(e.value||e.text)})),n}return e.value}e.value=t},html:function(e,t){if(N(t))return e.innerHTML;bt(e,!0),e.innerHTML=t},empty:Rt},(function(e,t){gt.prototype[t]=function(t,n){var o,r,i=this.length;if(e!==Rt&&N(2===e.length&&e!==Pt&&e!==Et?t:n)){if(F(t)){for(o=0;o<i;o++)if(e===_t)e(this[o],t);else for(r in t)e(this[o],r,t[r]);return this}for(var a=e.$dv,s=N(a)?Math.min(i,1):i,l=0;l<s;l++){var c=e(this[l],t,n);a=a?a+c:c}return a}for(o=0;o<i;o++)e(this[o],t,n);return this}})),S({removeData:kt,on:function(e,t,n,o){if(U(o))throw et("onargs","jqLite#on() does not support the `selector` or `eventData` parameters");if(mt(e)){var r=St(e,!0),i=r.events,a=r.handle;a||(a=r.handle=function(e,t){var n=function(n,o){n.isDefaultPrevented=function(){return n.defaultPrevented};var r=t[o||n.type],i=r?r.length:0;if(i){if(N(n.immediatePropagationStopped)){var a=n.stopImmediatePropagation;n.stopImmediatePropagation=function(){n.immediatePropagationStopped=!0,n.stopPropagation&&n.stopPropagation(),a&&a.call(n)}}n.isImmediatePropagationStopped=function(){return!0===n.immediatePropagationStopped};var s=r.specialHandlerWrapper||Ut;i>1&&(r=He(r));for(var l=0;l<i;l++)n.isImmediatePropagationStopped()||s(e,n,r[l])}};return n.elem=e,n}(e,i));for(var s=t.indexOf(" ")>=0?t.split(" "):[t],l=s.length,c=function(t,o,r){var s=i[t];s||((s=i[t]=[]).specialHandlerWrapper=o,"$destroy"===t||r||e.addEventListener(t,a)),s.push(n)};l--;)t=s[l],Qe[t]?(c(Qe[t],Ft),c(t,void 0,!0)):c(t)}},off:$t,one:function(e,t,n){(e=a(e)).on(t,(function o(){e.off(t,n),e.off(t,o)})),e.on(t,n)},replaceWith:function(e,t){var n,o=e.parentNode;bt(e),S(new gt(t),(function(t){n?o.insertBefore(t,n.nextSibling):o.replaceChild(t,e),n=t}))},children:function(e){var t=[];return S(e.childNodes,(function(e){e.nodeType===Be&&t.push(e)})),t},contents:function(e){return e.contentDocument||e.childNodes||[]},append:function(e,t){var n=e.nodeType;if(n===Be||n===ze)for(var o=0,r=(t=new gt(t)).length;o<r;o++){var i=t[o];e.appendChild(i)}},prepend:function(e,t){if(e.nodeType===Be){var n=e.firstChild;S(new gt(t),(function(t){e.insertBefore(t,n)}))}},wrap:function(e,t){var n,o,r;n=e,o=a(t).eq(0).clone()[0],(r=n.parentNode)&&r.replaceChild(o,n),o.appendChild(n)},remove:At,detach:function(e){At(e,!0)},after:function(e,t){var n=e,o=e.parentNode;if(o)for(var r=0,i=(t=new gt(t)).length;r<i;r++){var a=t[r];o.insertBefore(a,n.nextSibling),n=a}},addClass:Tt,removeClass:Mt,toggleClass:function(e,t,n){t&&S(t.split(" "),(function(t){var o=n;N(o)&&(o=!Pt(e,t)),(o?Tt:Mt)(e,t)}))},parent:function(e){var t=e.parentNode;return t&&t.nodeType!==ze?t:null},next:function(e){return e.nextElementSibling},find:function(e,t){return e.getElementsByTagName?e.getElementsByTagName(t):[]},clone:vt,triggerHandler:function(e,t,n){var o,r,i,a=t.type||t,s=St(e),l=s&&s.events,c=l&&l[a];c&&(o={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return!0===this.defaultPrevented},stopImmediatePropagation:function(){this.immediatePropagationStopped=!0},isImmediatePropagationStopped:function(){return!0===this.immediatePropagationStopped},stopPropagation:L,type:a,target:e},t.type&&(o=E(o,t)),r=He(c),i=n?[o].concat(n):[o],S(r,(function(t){o.isImmediatePropagationStopped()||t.apply(e,i)})))}},(function(e,t){gt.prototype[t]=function(t,n,o){for(var r,i=0,s=this.length;i<s;i++)N(r)?U(r=e(this[i],t,n,o))&&(r=a(r)):Ct(r,e(this[i],t,n,o));return U(r)?r:this}})),gt.prototype.bind=gt.prototype.on,gt.prototype.unbind=gt.prototype.off;var Vt=Object.create(null);function qt(){this._keys=[],this._values=[],this._lastKey=NaN,this._lastIndex=-1}qt.prototype={_idx:function(e){return e!==this._lastKey&&(this._lastKey=e,this._lastIndex=this._keys.indexOf(e)),this._lastIndex},_transformKey:function(e){return A(e)?Vt:e},get:function(e){e=this._transformKey(e);var t=this._idx(e);if(-1!==t)return this._values[t]},has:function(e){return e=this._transformKey(e),-1!==this._idx(e)},set:function(e,t){e=this._transformKey(e);var n=this._idx(e);-1===n&&(n=this._lastIndex=this._keys.length),this._keys[n]=e,this._values[n]=t},delete:function(e){e=this._transformKey(e);var t=this._idx(e);return-1!==t&&(this._keys.splice(t,1),this._values.splice(t,1),this._lastKey=NaN,this._lastIndex=-1,!0)}};var zt=qt,Ht=[function(){this.$get=[function(){return zt}]}],Gt=/^([^(]+?)=>/,Kt=/^[^(]*\(\s*([^)]*)\)/m,Yt=/,/,Jt=/^\s*(_?)(\S+?)\1\s*$/,Xt=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,Zt=r("$injector");function Qt(e){return Function.prototype.toString.call(e)}function en(e){var t=Qt(e).replace(Xt,"");return t.match(Gt)||t.match(Kt)}function tn(e,t){t=!0===t;var n={},o="Provider",r=[],a=new zt,s={$provide:{provider:f(h),factory:f(v),service:f((function(e,t){return v(e,["$injector",function(e){return e.instantiate(t)}])})),value:f((function(e,t){return v(e,j(t),!1)})),constant:f((function(e,t){De(e,"constant"),s[e]=t,u[e]=t})),decorator:function(e,t){var n=c.get(e+o),r=n.$get;n.$get=function(){var e=p.invoke(r,n);return p.invoke(t,null,{$delegate:e})}}}},c=s.$injector=y(s,(function(e,t){throw w.isString(t)&&r.push(t),Zt("unpr","Unknown provider: {0}",r.join(" <- "))})),u={},d=y(u,(function(e,t){var n=c.get(e+o,t);return p.invoke(n.$get,n,void 0,e)})),p=d;s["$injector"+o]={$get:j(d)},p.modules=c.modules=Ue();var m=b(e);return(p=d.get("$injector")).strictDi=t,S(m,(function(e){e&&p.invoke(e)})),p.loadNewModules=function(e){S(b(e),(function(e){e&&p.invoke(e)}))},p;function f(e){return function(t,n){if(!F(t))return e(t,n);S(t,P(e))}}function h(e,t){if(De(e,"service"),(G(t)||z(t))&&(t=c.instantiate(t)),!t.$get)throw Zt("pget","Provider '{0}' must define $get factory method.",e);return s[e+o]=t}function g(e,t){return function(){var n=p.invoke(t,this);if(N(n))throw Zt("undef","Provider '{0}' must return a value from $get factory method.",e);return n}}function v(e,t,n){return h(e,{$get:!1!==n?g(e,t):t})}function b(e){Oe(N(e)||z(e),"modulesToLoad","not an array");var t,n=[];return S(e,(function(e){if(!a.get(e)){a.set(e,!0);try{W(e)?(t=l(e),p.modules[e]=t,n=n.concat(b(t.requires)).concat(t._runBlocks),o(t._invokeQueue),o(t._configBlocks)):G(e)||z(e)?n.push(c.invoke(e)):je(e,"module")}catch(t){throw z(e)&&(e=e[e.length-1]),t.message&&t.stack&&-1===t.stack.indexOf(t.message)&&(t=t.message+"\n"+t.stack),Zt("modulerr","Failed to instantiate module {0} due to:\n{1}",e,t.stack||t.message||t)}}function o(e){var t,n;for(t=0,n=e.length;t<n;t++){var o=e[t],r=c.get(o[0]);r[o[1]].apply(r,o[2])}}})),n}function y(e,a){function l(t,o){if(e.hasOwnProperty(t)){if(e[t]===n)throw Zt("cdep","Circular dependency found: {0}",t+" <- "+r.join(" <- "));return e[t]}try{return r.unshift(t),e[t]=n,e[t]=a(t,o),e[t]}catch(o){throw e[t]===n&&delete e[t],o}finally{r.shift()}}function c(e,n,o){for(var r=[],i=tn.$$annotate(e,t,o),a=0,s=i.length;a<s;a++){var c=i[a];if("string"!=typeof c)throw Zt("itkn","Incorrect injection token! Expected service name as string, got {0}",c);r.push(n&&n.hasOwnProperty(c)?n[c]:l(c,o))}return r}return{invoke:function(e,t,n,o){"string"==typeof n&&(o=n,n=null);var r=c(e,n,o);return z(e)&&(e=e[e.length-1]),function(e){if(i||"function"!=typeof e)return!1;var t=e.$$ngIsClass;return X(t)||(t=e.$$ngIsClass=/^class\b/.test(Qt(e))),t}(e)?(r.unshift(null),new(Function.prototype.bind.apply(e,r))):e.apply(t,r)},instantiate:function(e,t,n){var o=z(e)?e[e.length-1]:e,r=c(e,t,n);return r.unshift(null),new(Function.prototype.bind.apply(o,r))},get:l,annotate:tn.$$annotate,has:function(t){return s.hasOwnProperty(t+o)||e.hasOwnProperty(t)}}}}function nn(){var t=!0;this.disableAutoScrolling=function(){t=!1},this.$get=["$window","$location","$rootScope",function(n,o,r){var i=n.document;function s(e){if(e){e.scrollIntoView();var t=function(){var e=l.yOffset;if(G(e))e=e();else if(ne(e)){var t=e[0];e="fixed"!==n.getComputedStyle(t).position?0:t.getBoundingClientRect().bottom}else V(e)||(e=0);return e}();if(t){var o=e.getBoundingClientRect().top;n.scrollBy(0,o-t)}}else n.scrollTo(0,0)}function l(e){var t,n,r;(e=W(e)?e:V(e)?e.toString():o.hash())?(t=i.getElementById(e))?s(t):(n=i.getElementsByName(e),r=null,Array.prototype.some.call(n,(function(e){if("a"===oe(e))return r=e,!0})),(t=r)?s(t):"top"===e&&s(null)):s(null)}return t&&r.$watch((function(){return o.hash()}),(function(t,n){var o,i;t===n&&""===t||(o=function(){r.$evalAsync(l)},"complete"===(i=i||e).document.readyState?i.setTimeout(o):a(i).on("load",o))})),l}]}tn.$$annotate=function(e,t,n){var o,r;if("function"==typeof e){if(!(o=e.$inject)){if(o=[],e.length){if(t)throw W(n)&&n||(n=e.name||function(e){var t=en(e);return t?"function("+(t[1]||"").replace(/[\s\r\n]+/," ")+")":"fn"}(e)),Zt("strictdi","{0} is not using explicit annotation and cannot be invoked in strict mode",n);S(en(e)[1].split(Yt),(function(e){e.replace(Jt,(function(e,t,n){o.push(n)}))}))}e.$inject=o}}else z(e)?(je(e[r=e.length-1],"fn"),o=e.slice(0,r)):je(e,"fn",!0);return o};var on=r("$animate"),rn="ng-animate";function an(e,t){return e||t?e?t?(z(e)&&(e=e.join(" ")),z(t)&&(t=t.join(" ")),e+" "+t):e:t:""}function sn(e){return F(e)?e:{}}var ln=function(){this.$get=L},cn=function(){var e=new zt,t=[];this.$get=["$$AnimateRunner","$rootScope",function(n,o){return{enabled:L,on:L,off:L,pin:L,push:function(a,s,l,c){c&&c(),(l=l||{}).from&&a.css(l.from),l.to&&a.css(l.to),(l.addClass||l.removeClass)&&function(n,a,s){var l=e.get(n)||{},c=r(l,a,!0),u=r(l,s,!1);(c||u)&&(e.set(n,l),t.push(n),1===t.length&&o.$$postDigest(i))}(a,l.addClass,l.removeClass);var u=new n;return u.complete(),u}};function r(e,t,n){var o=!1;return t&&S(t=W(t)?t.split(" "):z(t)?t:[],(function(t){t&&(o=!0,e[t]=n)})),o}function i(){S(t,(function(t){var n=e.get(t);if(n){var o=function(e){W(e)&&(e=e.split(" "));var t=Ue();return S(e,(function(e){e.length&&(t[e]=!0)})),t}(t.attr("class")),r="",i="";S(n,(function(e,t){e!==!!o[t]&&(e?r+=(r.length?" ":"")+t:i+=(i.length?" ":"")+t)})),S(t,(function(e){r&&Tt(e,r),i&&Mt(e,i)})),e.delete(t)}})),t.length=0}}]},un=["$provide",function(e){var t=this,n=null,o=null;this.$$registeredAnimations=Object.create(null),this.register=function(n,o){if(n&&"."!==n.charAt(0))throw on("notcsel","Expecting class selector starting with '.' got '{0}'.",n);var r=n+"-animation";t.$$registeredAnimations[n.substr(1)]=r,e.factory(r,o)},this.customFilter=function(e){return 1===arguments.length&&(o=G(e)?e:null),o},this.classNameFilter=function(e){if(1===arguments.length&&(n=e instanceof RegExp?e:null)&&new RegExp("[(\\s|\\/)]"+rn+"[(\\s|\\/)]").test(n.toString()))throw n=null,on("nongcls",'$animateProvider.classNameFilter(regex) prohibits accepting a regex value which matches/contains the "{0}" CSS class.',rn);return n},this.$get=["$$animateQueue",function(e){function t(e,t,n){if(n){var o=function(e){for(var t=0;t<e.length;t++){var n=e[t];if(1===n.nodeType)return n}}(n);!o||o.parentNode||o.previousElementSibling||(n=null)}n?n.after(e):t.prepend(e)}return{on:e.on,off:e.off,pin:e.pin,enabled:e.enabled,cancel:function(e){e.cancel&&e.cancel()},enter:function(n,o,r,i){return o=o&&a(o),r=r&&a(r),t(n,o=o||r.parent(),r),e.push(n,"enter",sn(i))},move:function(n,o,r,i){return o=o&&a(o),r=r&&a(r),t(n,o=o||r.parent(),r),e.push(n,"move",sn(i))},leave:function(t,n){return e.push(t,"leave",sn(n),(function(){t.remove()}))},addClass:function(t,n,o){return(o=sn(o)).addClass=an(o.addclass,n),e.push(t,"addClass",o)},removeClass:function(t,n,o){return(o=sn(o)).removeClass=an(o.removeClass,n),e.push(t,"removeClass",o)},setClass:function(t,n,o,r){return(r=sn(r)).addClass=an(r.addClass,n),r.removeClass=an(r.removeClass,o),e.push(t,"setClass",r)},animate:function(t,n,o,r,i){return(i=sn(i)).from=i.from?E(i.from,n):n,i.to=i.to?E(i.to,o):o,r=r||"ng-inline-animate",i.tempClasses=an(i.tempClasses,r),e.push(t,"animate",i)}}}]}],dn=function(){this.$get=["$$rAF",function(e){var t=[];function n(n){t.push(n),t.length>1||e((function(){for(var e=0;e<t.length;e++)t[e]();t=[]}))}return function(){var e=!1;return n((function(){e=!0})),function(t){e?t():n(t)}}}]},pn=function(){this.$get=["$q","$sniffer","$$animateAsyncRun","$$isDocumentHidden","$timeout",function(e,t,n,o,r){function i(e){this.setHost(e);var t=n();this._doneCallbacks=[],this._tick=function(e){o()?function(e){r(e,0,!1)}(e):t(e)},this._state=0}return i.chain=function(e,t){var n=0;!function o(){n!==e.length?e[n]((function(e){!1!==e?(n++,o()):t(!1)})):t(!0)}()},i.all=function(e,t){var n=0,o=!0;function r(r){o=o&&r,++n===e.length&&t(o)}S(e,(function(e){e.done(r)}))},i.prototype={setHost:function(e){this.host=e||{}},done:function(e){2===this._state?e():this._doneCallbacks.push(e)},progress:L,getPromise:function(){if(!this.promise){var t=this;this.promise=e((function(e,n){t.done((function(t){!1===t?n():e()}))}))}return this.promise},then:function(e,t){return this.getPromise().then(e,t)},catch:function(e){return this.getPromise().catch(e)},finally:function(e){return this.getPromise().finally(e)},pause:function(){this.host.pause&&this.host.pause()},resume:function(){this.host.resume&&this.host.resume()},end:function(){this.host.end&&this.host.end(),this._resolve(!0)},cancel:function(){this.host.cancel&&this.host.cancel(),this._resolve(!1)},complete:function(e){var t=this;0===t._state&&(t._state=1,t._tick((function(){t._resolve(e)})))},_resolve:function(e){2!==this._state&&(S(this._doneCallbacks,(function(t){t(e)})),this._doneCallbacks.length=0,this._state=2)}},i}]},mn=function(){this.$get=["$$rAF","$q","$$AnimateRunner",function(e,t,n){return function(t,o){var r=o||{};r.$$prepared||(r=ae(r)),r.cleanupStyles&&(r.from=r.to=null),r.from&&(t.css(r.from),r.from=null);var i,a=new n;return{start:s,end:s};function s(){return e((function(){r.addClass&&(t.addClass(r.addClass),r.addClass=null),r.removeClass&&(t.removeClass(r.removeClass),r.removeClass=null),r.to&&(t.css(r.to),r.to=null),i||a.complete(),i=!0})),a}}}]};function fn(e,t,n,o,r){var i=this,s=e.location,l=e.history,c=e.setTimeout,u=e.clearTimeout,d={},p=r(n);i.isMock=!1,i.$$completeOutstandingRequest=p.completeTask,i.$$incOutstandingRequestCount=p.incTaskCount,i.notifyWhenNoOutstandingRequests=p.notifyWhenNoPendingTasks;var m,f,h=s.href,g=t.find("base"),v=null,b=o.history?function(){try{return l.state}catch(e){}}:L;_(),i.url=function(t,n,r){if(N(r)&&(r=null),s!==e.location&&(s=e.location),l!==e.history&&(l=e.history),t){var a=f===r;if(t=fr(t).href,h===t&&(!o.history||a))return i;var c=h&&mo(h)===mo(t);return h=t,f=r,!o.history||c&&a?(c||(v=t),n?s.replace(t):c?s.hash=function(e){var t=e.indexOf("#");return-1===t?"":e.substr(t)}(t):s.href=t,s.href!==t&&(v=t)):(l[n?"replaceState":"pushState"](r,"",t),_()),v&&(v=t),i}return function(e){return e.replace(/#$/,"")}(v||s.href)},i.state=function(){return m};var y=[],w=!1;function $(){v=null,P()}var k=null;function _(){le(m=N(m=b())?null:m,k)&&(m=k),k=m,f=m}function P(){var e=f;_(),h===i.url()&&e===m||(h=i.url(),f=m,S(y,(function(e){e(i.url(),m)})))}i.onUrlChange=function(t){return w||(o.history&&a(e).on("popstate",$),a(e).on("hashchange",$),w=!0),y.push(t),t},i.$$applicationDestroyed=function(){a(e).off("hashchange popstate",$)},i.$$checkUrlChange=P,i.baseHref=function(){var e=g.attr("href");return e?e.replace(/^(https?:)?\/\/[^/]*/,""):""},i.defer=function(e,t,n){var o;return t=t||0,n=n||p.DEFAULT_TASK_TYPE,p.incTaskCount(n),o=c((function(){delete d[o],p.completeTask(e,n)}),t),d[o]=n,o},i.defer.cancel=function(e){if(d.hasOwnProperty(e)){var t=d[e];return delete d[e],u(e),p.completeTask(L,t),!0}return!1}}function hn(){this.$get=["$window","$log","$sniffer","$document","$$taskTrackerFactory",function(e,t,n,o,r){return new fn(e,o,t,n,r)}]}function gn(){this.$get=function(){var e={};function t(t,n){if(t in e)throw r("$cacheFactory")("iid","CacheId '{0}' is already taken!",t);var o=0,i=E({},n,{id:t}),a=Ue(),s=n&&n.capacity||Number.MAX_VALUE,l=Ue(),c=null,u=null;return e[t]={put:function(e,t){if(!N(t))return s<Number.MAX_VALUE&&d(l[e]||(l[e]={key:e})),e in a||o++,a[e]=t,o>s&&this.remove(u.key),t},get:function(e){if(s<Number.MAX_VALUE){var t=l[e];if(!t)return;d(t)}return a[e]},remove:function(e){if(s<Number.MAX_VALUE){var t=l[e];if(!t)return;t===c&&(c=t.p),t===u&&(u=t.n),p(t.n,t.p),delete l[e]}e in a&&(delete a[e],o--)},removeAll:function(){a=Ue(),o=0,l=Ue(),c=u=null},destroy:function(){a=null,i=null,l=null,delete e[t]},info:function(){return E({},i,{size:o})}};function d(e){e!==c&&(u?u===e&&(u=e.n):u=e,p(e.n,e.p),p(e,c),(c=e).n=null)}function p(e,t){e!==t&&(e&&(e.p=t),t&&(t.n=e))}}return t.info=function(){var t={};return S(e,(function(e,n){t[n]=e.info()})),t},t.get=function(t){return e[t]},t}}function vn(){this.$get=["$cacheFactory",function(e){return e("templates")}]}var bn=r("$compile"),yn=new function(){};function wn(t,n){var o={},r="Directive",s=/^\s*directive:\s*([\w-]+)\s+(.*)$/,l=/(([\w-]+)(?::([^;]+))?;?)/,c=function(){var e,t={},n="ngSrc,ngSrcset,src,srcset".split(",");for(e=0;e<n.length;e++)t[n[e]]=!0;return t}(),u=/^(?:(\^\^?)?(\?)?(\^\^?)?)?/,m=/^(on[a-z]+|formaction)$/,f=Ue();function h(e,t,n){var o=/^([@&]|[=<](\*?))(\??)\s*([\w$]*)$/,r=Ue();return S(e,(function(e,i){if((e=e.trim())in f)r[i]=f[e];else{var a=e.match(o);if(!a)throw bn("iscp","Invalid {3} for directive '{0}'. Definition: {... {1}: '{2}' ...}",t,i,e,n?"controller bindings definition":"isolate scope definition");r[i]={mode:a[1][0],collection:"*"===a[2],optional:"?"===a[3],attrName:a[4]||i},a[4]&&(f[e]=r[i])}})),r}function g(e,t){var n={isolateScope:null,bindToController:null};if(F(e.scope)&&(!0===e.bindToController?(n.bindToController=h(e.scope,t,!0),n.isolateScope={}):n.isolateScope=h(e.scope,t,!1)),F(e.bindToController)&&(n.bindToController=h(e.bindToController,t,!0)),n.bindToController&&!e.controller)throw bn("noctrl","Cannot bind to controller without directive '{0}'s controller.",t);return n}this.directive=function e(n,i){return Oe(n,"name"),De(n,"directive"),W(n)?(function(e){var t=e.charAt(0);if(!t||t!==p(t))throw bn("baddir","Directive/Component name '{0}' is invalid. The first character must be a lowercase letter",e);if(e!==e.trim())throw bn("baddir","Directive/Component name '{0}' is invalid. The name should not contain leading or trailing whitespaces",e)}(n),Oe(i,"directiveFactory"),o.hasOwnProperty(n)||(o[n]=[],t.factory(n+r,["$injector","$exceptionHandler",function(e,t){var r=[];return S(o[n],(function(o,i){try{var a=e.invoke(o);G(a)?a={compile:j(a)}:!a.compile&&a.link&&(a.compile=j(a.link)),a.priority=a.priority||0,a.index=i,a.name=a.name||n,a.require=function(e){var t=e.require||e.controller&&e.name;return!z(t)&&F(t)&&S(t,(function(e,n){var o=e.match(u);e.substring(o[0].length)||(t[n]=o[0]+n)})),t}(a),a.restrict=function(e,t){if(e&&(!W(e)||!/[EACM]/.test(e)))throw bn("badrestrict","Restrict property '{0}' of directive '{1}' is invalid",e,t);return e||"EA"}(a.restrict,n),a.$$moduleName=o.$$moduleName,r.push(a)}catch(e){t(e)}})),r}])),o[n].push(i)):S(n,P(e)),this},this.component=function e(t,n){if(!W(t))return S(t,P(me(this,e))),this;var o=n.controller||function(){};function r(e){function t(t){return G(t)||z(t)?function(n,o){return e.invoke(t,this,{$element:n,$attrs:o})}:t}var r=n.template||n.templateUrl?n.template:"",i={controller:o,controllerAs:En(n.controller)||n.controllerAs||"$ctrl",template:t(r),templateUrl:t(n.templateUrl),transclude:n.transclude,scope:{},bindToController:n.bindings||{},restrict:"E",require:n.require};return S(n,(function(e,t){"$"===t.charAt(0)&&(i[t]=e)})),i}return S(n,(function(e,t){"$"===t.charAt(0)&&(r[t]=e,G(o)&&(o[t]=e))})),r.$inject=["$injector"],this.directive(t,r)},this.aHrefSanitizationTrustedUrlList=function(e){return U(e)?(n.aHrefSanitizationTrustedUrlList(e),this):n.aHrefSanitizationTrustedUrlList()},Object.defineProperty(this,"aHrefSanitizationWhitelist",{get:function(){return this.aHrefSanitizationTrustedUrlList},set:function(e){this.aHrefSanitizationTrustedUrlList=e}}),this.imgSrcSanitizationTrustedUrlList=function(e){return U(e)?(n.imgSrcSanitizationTrustedUrlList(e),this):n.imgSrcSanitizationTrustedUrlList()},Object.defineProperty(this,"imgSrcSanitizationWhitelist",{get:function(){return this.imgSrcSanitizationTrustedUrlList},set:function(e){this.imgSrcSanitizationTrustedUrlList=e}});var b=!0;this.debugInfoEnabled=function(e){return U(e)?(b=e,this):b};var y=!1;this.strictComponentBindingsEnabled=function(e){return U(e)?(y=e,this):y};var w=10;this.onChangesTtl=function(e){return arguments.length?(w=e,this):w};var $=!0;this.commentDirectivesEnabled=function(e){return arguments.length?($=e,this):$};var k=!0;this.cssClassDirectivesEnabled=function(e){return arguments.length?(k=e,this):k};var _=Ue();this.addPropertySecurityContext=function(e,t,n){var o=e.toLowerCase()+"|"+t.toLowerCase();if(o in _&&_[o]!==n)throw bn("ctxoverride","Property context '{0}.{1}' already set to '{2}', cannot override to '{3}'.",e,t,_[o],n);return _[o]=n,this},function(){function e(e,t){S(t,(function(t){_[t.toLowerCase()]=e}))}e(Jo.HTML,["iframe|srcdoc","*|innerHTML","*|outerHTML"]),e(Jo.CSS,["*|style"]),e(Jo.URL,["area|href","area|ping","a|href","a|ping","blockquote|cite","body|background","del|cite","input|src","ins|cite","q|cite"]),e(Jo.MEDIA_URL,["audio|src","img|src","img|srcset","source|src","source|srcset","track|src","video|src","video|poster"]),e(Jo.RESOURCE_URL,["*|formAction","applet|code","applet|codebase","base|href","embed|src","frame|src","form|action","head|profile","html|manifest","iframe|src","link|href","media|src","object|codebase","object|data","script|src"])}(),this.$get=["$injector","$interpolate","$exceptionHandler","$templateRequest","$parse","$controller","$rootScope","$sce","$animate",function(t,n,f,h,P,M,T,C,I){var R,A=/^\w/,j=e.document.createElement("div"),D=$,U=k,B=w;function V(){try{if(! --B)throw R=void 0,bn("infchng","{0} $onChanges() iterations reached. Aborting!\n",w);T.$apply((function(){for(var e=0,t=R.length;e<t;++e)try{R[e]()}catch(e){f(e)}R=void 0}))}finally{B++}}function q(e,t){if(!e)return e;if(!W(e))throw bn("srcset",'Can\'t pass trusted values to `{0}`: "{1}"',t,e.toString());for(var n="",o=ee(e),r=/\s/.test(o)?/(\s+\d+x\s*,|\s+\d+w\s*,|\s+,|,\s+)/:/(,)/,i=o.split(r),a=Math.floor(i.length/2),s=0;s<a;s++){var l=2*s;n+=C.getTrustedMediaUrl(ee(i[l])),n+=" "+ee(i[l+1])}var c=ee(i[2*s]).split(/\s/);return n+=C.getTrustedMediaUrl(ee(c[0])),2===c.length&&(n+=" "+ee(c[1])),n}function K(e,t){if(t){var n,o,r,i=Object.keys(t);for(n=0,o=i.length;n<o;n++)this[r=i[n]]=t[r]}else this.$attr={};this.$$element=e}function Y(e,t){try{e.addClass(t)}catch(e){}}K.prototype={$normalize:_n,$addClass:function(e){e&&e.length>0&&I.addClass(this.$$element,e)},$removeClass:function(e){e&&e.length>0&&I.removeClass(this.$$element,e)},$updateClass:function(e,t){var n=Pn(e,t);n&&n.length&&I.addClass(this.$$element,n);var o=Pn(t,e);o&&o.length&&I.removeClass(this.$$element,o)},$set:function(e,t,n,o){var r=Nt(this.$$element[0],e),i=function(e){return Dt[e]}(e),a=e;r?(this.$$element.prop(e,t),o=r):i&&(this[i]=t,a=i),this[e]=t,o?this.$attr[e]=o:(o=this.$attr[e])||(this.$attr[e]=o=Ae(e,"-")),"img"===oe(this.$$element)&&"srcset"===e&&(this[e]=t=q(t,"$set('srcset', value)")),!1!==n&&(null===t||N(t)?this.$$element.removeAttr(o):A.test(o)?r&&!1===t?this.$$element.removeAttr(o):this.$$element.attr(o,t):function(e,t,n){j.innerHTML="<span "+t+">";var o=j.firstChild.attributes,r=o[0];o.removeNamedItem(r.name),r.value=n,e.attributes.setNamedItem(r)}(this.$$element[0],o,t));var s=this.$$observers;s&&S(s[a],(function(e){try{e(t)}catch(e){f(e)}}))},$observe:function(e,t){var n=this,o=n.$$observers||(n.$$observers=Ue()),r=o[e]||(o[e]=[]);return r.push(t),T.$evalAsync((function(){r.$$inter||!n.hasOwnProperty(e)||N(n[e])||t(n[e])})),function(){ie(r,t)}}};var Z=n.startSymbol(),Q=n.endSymbol(),te="{{"===Z&&"}}"===Q?O:function(e){return e.replace(/\{\{/g,Z).replace(/}}/g,Q)},ne=/^ng(Attr|Prop|On)([A-Z].*)$/,re=/^(.+)Start$/;return ae.$$addBindingInfo=b?function(e,t){var n=e.data("$binding")||[];z(t)?n=n.concat(t):n.push(t),e.data("$binding",n)}:L,ae.$$addBindingClass=b?function(e){Y(e,"ng-binding")}:L,ae.$$addScopeInfo=b?function(e,t,n,o){var r=n?o?"$isolateScopeNoTemplate":"$isolateScope":"$scope";e.data(r,t)}:L,ae.$$addScopeClass=b?function(e,t){Y(e,t?"ng-isolate-scope":"ng-scope")}:L,ae.$$createComment=function(t,n){var o="";return b&&(o=" "+(t||"")+": ",n&&(o+=n+" ")),e.document.createComment(o)},ae;function ae(e,t,n,o,r){e instanceof a||(e=a(e));var i=ce(e,t,e,n,o,r);ae.$$addScopeClass(e);var s=null;return function(t,n,o){if(!e)throw bn("multilink","This element has already been linked.");Oe(t,"scope"),r&&r.needsNewScope&&(t=t.$parent.$new());var l,c,u,d=(o=o||{}).parentBoundTranscludeFn,p=o.transcludeControllers,m=o.futureParentElement;if(d&&d.$$boundTransclude&&(d=d.$$boundTransclude),s||(c=(l=m)&&l[0],s=c&&"foreignobject"!==oe(c)&&v.call(c).match(/SVG/)?"svg":"html"),u="html"!==s?a(Ce(s,a("<div></div>").append(e).html())):n?Lt.clone.call(e):e,p)for(var f in p)u.data("$"+f+"Controller",p[f].instance);return ae.$$addScopeInfo(u,t),n&&n(u,t),i&&i(t,u,u,d),n||(e=i=null),u}}function ce(e,t,n,o,r,s){for(var l,c,u,d,p,m,f,h=[],g=z(e)||e instanceof a,v=0;v<e.length;v++)l=new K,11===i&&ue(e,v,g),(u=(c=fe(e[v],[],l,0===v?o:void 0,r)).length?be(c,e[v],l,t,n,null,[],[],s):null)&&u.scope&&ae.$$addScopeClass(l.$$element),p=u&&u.terminal||!(d=e[v].childNodes)||!d.length?null:ce(d,u?(u.transcludeOnThisElement||!u.templateOnThisElement)&&u.transclude:t),(u||p)&&(h.push(v,u,p),m=!0,f=f||u),s=null;return m?function(e,n,o,r){var i,s,l,c,u,d,p,m;if(f){var g=n.length;for(m=new Array(g),u=0;u<h.length;u+=3)m[p=h[u]]=n[p]}else m=n;for(u=0,d=h.length;u<d;)l=m[h[u++]],i=h[u++],s=h[u++],i?(i.scope?(c=e.$new(),ae.$$addScopeInfo(a(l),c)):c=e,i(s,c,l,o,i.transcludeOnThisElement?de(e,i.transclude,r):!i.templateOnThisElement&&r?r:!r&&t?de(e,t):null)):s&&s(e,l.childNodes,void 0,r)}:null}function ue(e,t,n){var o,r=e[t],i=r.parentNode;if(r.nodeType===We)for(;(o=i?r.nextSibling:e[t+1])&&o.nodeType===We;)r.nodeValue=r.nodeValue+o.nodeValue,o.parentNode&&o.parentNode.removeChild(o),n&&o===e[t+1]&&e.splice(t+1,1)}function de(e,t,n){function o(o,r,i,a,s){return o||((o=e.$new(!1,s)).$$transcluded=!0),t(o,r,{parentBoundTranscludeFn:n,transcludeControllers:i,futureParentElement:a})}var r=o.$$slots=Ue();for(var i in t.$$slots)t.$$slots[i]?r[i]=de(e,t.$$slots[i],n):r[i]=null;return o}function fe(e,t,o,r,i){var a,c,u,d=e.nodeType,p=o.$attr;switch(d){case Be:ke(t,_n(c=oe(e)),"E",r,i);for(var m,f,h,g,v,b=e.attributes,y=0,w=b&&b.length;y<w;y++){var $,k=!1,S=!1,_=!1,P=!1,M=!1;f=(m=b[y]).name,g=m.value,(v=(h=_n(f.toLowerCase())).match(ne))?(_="Attr"===v[1],P="Prop"===v[1],M="On"===v[1],f=f.replace(kn,"").toLowerCase().substr(4+v[1].length).replace(/_(.)/g,(function(e,t){return t.toUpperCase()}))):($=h.match(re))&&Se($[1])&&(k=f,S=f.substr(0,f.length-5)+"end",f=f.substr(0,f.length-6)),P||M?(o[h]=g,p[h]=m.name,P?Ie(e,t,h,f):Re(t,h,f)):(p[h=_n(f.toLowerCase())]=f,!_&&o.hasOwnProperty(h)||(o[h]=g,Nt(e,h)&&(o[h]=!0)),xe(e,t,g,h,_),ke(t,h,"A",r,i,k,S))}if("input"===c&&"hidden"===e.getAttribute("type")&&e.setAttribute("autocomplete","off"),!U)break;if(F(u=e.className)&&(u=u.animVal),W(u)&&""!==u)for(;a=l.exec(u);)ke(t,h=_n(a[2]),"C",r,i)&&(o[h]=ee(a[3])),u=u.substr(a.index+a[0].length);break;case We:!function(e,t){var o=n(t,!0);o&&e.push({priority:0,compile:function(e){var t=e.parent(),n=!!t.length;return n&&ae.$$addBindingClass(t),function(e,t){var r=t.parent();n||ae.$$addBindingClass(r),ae.$$addBindingInfo(r,o.expressions),e.$watch(o,(function(e){t[0].nodeValue=e}))}}})}(t,e.nodeValue);break;case Ve:if(!D)break;!function(e,t,n,o,r){try{var i=s.exec(e.nodeValue);if(i){var a=_n(i[1]);ke(t,a,"M",o,r)&&(n[a]=ee(i[2]))}}catch(e){}}(e,t,o,r,i)}return t.sort(Me),t}function he(e,t,n){var o=[],r=0;if(t&&e.hasAttribute&&e.hasAttribute(t))do{if(!e)throw bn("uterdir","Unterminated attribute, found '{0}' but no matching '{1}' found.",t,n);e.nodeType===Be&&(e.hasAttribute(t)&&r++,e.hasAttribute(n)&&r--),o.push(e),e=e.nextSibling}while(r>0);else o.push(e);return a(o)}function ge(e,t,n){return function(o,r,i,a,s){return r=he(r[0],t,n),e(o,r,i,a,s)}}function ve(e,t,n,o,r,i){var a;return e?ae(t,n,o,r,i):function(){return a||(a=ae(t,n,o,r,i),t=n=i=null),a.apply(this,arguments)}}function be(t,n,o,r,i,s,l,c,u){u=u||{};for(var d,p,m,h,g,v=-Number.MAX_VALUE,b=u.newScopeDirective,y=u.controllerDirectives,w=u.newIsolateScopeDirective,$=u.templateDirective,k=u.nonTlbTranscludeDirective,_=!1,P=!1,T=u.hasElementTranscludeDirective,C=o.$$element=a(n),I=s,R=r,A=!1,x=!1,L=0,O=t.length;L<O;L++){var j=(d=t[L]).$$start,D=d.$$end;if(j&&(C=he(n,j,D)),m=void 0,v>d.priority)break;if((g=d.scope)&&(d.templateUrl||(F(g)?(Te("new/isolated scope",w||b,d,C),w=d):Te("new/isolated scope",w,d,C)),b=b||d),p=d.name,!A&&(d.replace&&(d.templateUrl||d.template)||d.transclude&&!d.$$tlb)){for(var U,B=L+1;U=t[B++];)if(U.transclude&&!U.$$tlb||U.replace&&(U.templateUrl||U.template)){x=!0;break}A=!0}if(!d.templateUrl&&d.controller&&(y=y||Ue(),Te("'"+p+"' controller",y[p],d,C),y[p]=d),g=d.transclude)if(_=!0,d.$$tlb||(Te("transclusion",k,d,C),k=d),"element"===g)T=!0,v=d.priority,m=C,C=o.$$element=a(ae.$$createComment(p,o[p])),n=C[0],Le(i,pe(m),n),R=ve(x,m,r,v,I&&I.name,{nonTlbTranscludeDirective:k});else{var W=Ue();if(F(g)){m=e.document.createDocumentFragment();var V=Ue(),q=Ue();for(var H in S(g,(function(e,t){var n="?"===e.charAt(0);e=n?e.substring(1):e,V[e]=t,W[t]=null,q[t]=n})),S(C.contents(),(function(t){var n=V[_n(oe(t))];n?(q[n]=!0,W[n]=W[n]||e.document.createDocumentFragment(),W[n].appendChild(t)):m.appendChild(t)})),S(q,(function(e,t){if(!e)throw bn("reqslot","Required transclusion slot `{0}` was not filled.",t)})),W)if(W[H]){var Y=a(W[H].childNodes);W[H]=ve(x,Y,r)}m=a(m.childNodes)}else m=a(vt(n)).contents();C.empty(),(R=ve(x,m,r,void 0,void 0,{needsNewScope:d.$$isolateScope||d.$$newScope})).$$slots=W}if(d.template)if(P=!0,Te("template",$,d,C),$=d,g=G(d.template)?d.template(C,o):d.template,g=te(g),d.replace){if(I=d,m=pt(g)?[]:Mn(Ce(d.templateNamespace,ee(g))),n=m[0],1!==m.length||n.nodeType!==Be)throw bn("tplrt","Template for directive '{0}' must have exactly one root element. {1}",p,"");Le(i,C,n);var X={$attr:{}},Z=fe(n,[],X),Q=t.splice(L+1,t.length-(L+1));(w||b)&&we(Z,w,b),t=t.concat(Z).concat(Q),_e(o,X),O=t.length}else C.html(g);if(d.templateUrl)P=!0,Te("template",$,d,C),$=d,d.replace&&(I=d),ie=Pe(t.splice(L,t.length-L),C,o,i,_&&R,l,c,{controllerDirectives:y,newScopeDirective:b!==d&&b,newIsolateScopeDirective:w,templateDirective:$,nonTlbTranscludeDirective:k}),O=t.length;else if(d.compile)try{h=d.compile(C,o,R);var ne=d.$$originalDirective||d;G(h)?re(null,me(ne,h),j,D):h&&re(me(ne,h.pre),me(ne,h.post),j,D)}catch(e){f(e,$e(C))}d.terminal&&(ie.terminal=!0,v=Math.max(v,d.priority))}return ie.scope=b&&!0===b.scope,ie.transcludeOnThisElement=_,ie.templateOnThisElement=P,ie.transclude=R,u.hasElementTranscludeDirective=T,ie;function re(e,t,n,o){e&&(n&&(e=ge(e,n,o)),e.require=d.require,e.directiveName=p,(w===d||d.$$isolateScope)&&(e=je(e,{isolateScope:!0})),l.push(e)),t&&(n&&(t=ge(t,n,o)),t.require=d.require,t.directiveName=p,(w===d||d.$$isolateScope)&&(t=je(t,{isolateScope:!0})),c.push(t))}function ie(e,t,r,i,s){var u,d,p,m,h,g,v,k,_,P;for(var C in n===r?(_=o,k=o.$$element):_=new K(k=a(r),o),h=t,w?m=t.$new(!0):b&&(h=t.$parent),s&&(v=function(e,t,n,o){var r;if(J(e)||(o=n,n=t,t=e,e=void 0),T&&(r=g),n||(n=T?k.parent():k),!o)return s(e,t,r,n,x);var i=s.$$slots[o];if(i)return i(e,t,r,n,x);if(N(i))throw bn("noslot",'No parent directive that requires a transclusion with slot name "{0}". Element: {1}',o,$e(k))},v.$$boundTransclude=s,v.isSlotFilled=function(e){return!!s.$$slots[e]}),y&&(g=function(e,t,n,o,r,i,a){var s=Ue();for(var l in o){var c=o[l],u={$scope:c===a||c.$$isolateScope?r:i,$element:e,$attrs:t,$transclude:n},d=c.controller;"@"===d&&(d=t[c.name]);var p=M(d,u,!0,c.controllerAs);s[c.name]=p,e.data("$"+c.name+"Controller",p.instance)}return s}(k,_,v,y,m,t,w)),w&&(ae.$$addScopeInfo(k,m,!0,!($&&($===w||$===w.$$originalDirective))),ae.$$addScopeClass(k,!0),m.$$isolateBindings=w.$$isolateBindings,(P=Fe(t,_,m,m.$$isolateBindings,w)).removeWatches&&m.$on("$destroy",P.removeWatches)),g){var I=y[C],R=g[C],A=I.$$bindings.bindToController;R.instance=R(),k.data("$"+I.name+"Controller",R.instance),R.bindingInfo=Fe(h,_,R.instance,A,I)}for(S(y,(function(e,t){var n=e.require;e.bindToController&&!z(n)&&F(n)&&E(g[t].instance,ye(t,n,k,g))})),S(g,(function(e){var t=e.instance;if(G(t.$onChanges))try{t.$onChanges(e.bindingInfo.initialChanges)}catch(e){f(e)}if(G(t.$onInit))try{t.$onInit()}catch(e){f(e)}G(t.$doCheck)&&(h.$watch((function(){t.$doCheck()})),t.$doCheck()),G(t.$onDestroy)&&h.$on("$destroy",(function(){t.$onDestroy()}))})),u=0,d=l.length;u<d;u++)De(p=l[u],p.isolateScope?m:t,k,_,p.require&&ye(p.directiveName,p.require,k,g),v);var x=t;for(w&&(w.template||null===w.templateUrl)&&(x=m),e&&e(x,r.childNodes,void 0,s),u=c.length-1;u>=0;u--)De(p=c[u],p.isolateScope?m:t,k,_,p.require&&ye(p.directiveName,p.require,k,g),v);S(g,(function(e){var t=e.instance;G(t.$postLink)&&t.$postLink()}))}}function ye(e,t,n,o){var r;if(W(t)){var i=t.match(u),a=t.substring(i[0].length),s=i[1]||i[3],l="?"===i[2];if("^^"===s?n=n.parent():r=(r=o&&o[a])&&r.instance,!r){var c="$"+a+"Controller";r="^^"===s&&n[0]&&n[0].nodeType===qe?null:s?n.inheritedData(c):n.data(c)}if(!r&&!l)throw bn("ctreq","Controller '{0}', required by directive '{1}', can't be found!",a,e)}else if(z(t)){r=[];for(var d=0,p=t.length;d<p;d++)r[d]=ye(e,t[d],n,o)}else F(t)&&(r={},S(t,(function(t,i){r[i]=ye(e,t,n,o)})));return r||null}function we(e,t,n){for(var o=0,r=e.length;o<r;o++)e[o]=x(e[o],{$$isolateScope:t,$$newScope:n})}function ke(e,n,i,a,s,l,c){if(n===s)return null;var u=null;if(o.hasOwnProperty(n))for(var d,p=t.get(n+r),m=0,f=p.length;m<f;m++)if(d=p[m],(N(a)||a>d.priority)&&-1!==d.restrict.indexOf(i)){if(l&&(d=x(d,{$$start:l,$$end:c})),!d.$$bindings){var h=d.$$bindings=g(d,d.name);F(h.isolateScope)&&(d.$$isolateBindings=h.isolateScope)}e.push(d),u=d}return u}function Se(e){if(o.hasOwnProperty(e))for(var n=t.get(e+r),i=0,a=n.length;i<a;i++)if(n[i].multiElement)return!0;return!1}function _e(e,t){var n=t.$attr,o=e.$attr;S(e,(function(o,r){"$"!==r.charAt(0)&&(t[r]&&t[r]!==o&&(o.length?o+=("style"===r?";":" ")+t[r]:o=t[r]),e.$set(r,o,!0,n[r]))})),S(t,(function(t,r){e.hasOwnProperty(r)||"$"===r.charAt(0)||(e[r]=t,"class"!==r&&"style"!==r&&(o[r]=n[r]))}))}function Pe(e,t,n,o,r,i,s,l){var c,u,d=[],p=t[0],m=e.shift(),g=x(m,{templateUrl:null,transclude:null,replace:null,$$originalDirective:m}),v=G(m.templateUrl)?m.templateUrl(t,n):m.templateUrl,b=m.templateNamespace;return t.empty(),h(v).then((function(f){var h,y,w,$;if(f=te(f),m.replace){if(w=pt(f)?[]:Mn(Ce(b,ee(f))),h=w[0],1!==w.length||h.nodeType!==Be)throw bn("tplrt","Template for directive '{0}' must have exactly one root element. {1}",m.name,v);y={$attr:{}},Le(o,t,h);var k=fe(h,[],y);F(m.scope)&&we(k,!0),e=k.concat(e),_e(n,y)}else h=p,t.html(f);for(e.unshift(g),c=be(e,h,n,r,t,m,i,s,l),S(o,(function(e,n){e===h&&(o[n]=t[0])})),u=ce(t[0].childNodes,r);d.length;){var _=d.shift(),P=d.shift(),M=d.shift(),T=d.shift(),C=t[0];if(!_.$$destroyed){if(P!==p){var E=P.className;l.hasElementTranscludeDirective&&m.replace||(C=vt(h)),Le(M,a(P),C),Y(a(C),E)}$=c.transcludeOnThisElement?de(_,c.transclude,T):T,c(u,_,C,o,$)}}d=null})).catch((function(e){H(e)&&f(e)})),function(e,t,n,o,r){var i=r;t.$$destroyed||(d?d.push(t,n,o,i):(c.transcludeOnThisElement&&(i=de(t,c.transclude,r)),c(u,t,n,o,i)))}}function Me(e,t){var n=t.priority-e.priority;return 0!==n?n:e.name!==t.name?e.name<t.name?-1:1:e.index-t.index}function Te(e,t,n,o){function r(e){return e?" (module: "+e+")":""}if(t)throw bn("multidir","Multiple directives [{0}{1}, {2}{3}] asking for {4} on: {5}",t.name,r(t.$$moduleName),n.name,r(n.$$moduleName),e,$e(o))}function Ce(t,n){switch(t=p(t||"html")){case"svg":case"math":var o=e.document.createElement("div");return o.innerHTML="<"+t+">"+n+"</"+t+">",o.childNodes[0].childNodes;default:return n}}function Ee(e){return q(C.valueOf(e),"ng-prop-srcset")}function Ie(e,t,n,o){if(m.test(o))throw bn("nodomevents","Property bindings for HTML DOM event properties are disallowed");var r=oe(e),i=function(e,t){var n=t.toLowerCase();return _[e+"|"+n]||_["*|"+n]}(r,o),a=O;"srcset"!==o||"img"!==r&&"source"!==r?i&&(a=C.getTrusted.bind(C,i)):a=Ee,t.push({priority:100,compile:function(e,t){var r=P(t[n]),i=P(t[n],(function(e){return C.valueOf(e)}));return{pre:function(e,t){function n(){var n=r(e);t[0][o]=a(n)}n(),e.$watch(i,n)}}}})}function Re(e,t,n){e.push(Vi(P,T,f,t,n,!1))}function xe(e,t,o,r,i){var a=oe(e),s=function(e,t){return"srcdoc"===t?C.HTML:"src"===t||"ngSrc"===t?-1===["img","video","audio","source","track"].indexOf(e)?C.RESOURCE_URL:C.MEDIA_URL:"xlinkHref"===t?"image"===e?C.MEDIA_URL:"a"===e?C.URL:C.RESOURCE_URL:"form"===e&&"action"===t||"base"===e&&"href"===t||"link"===e&&"href"===t?C.RESOURCE_URL:"a"!==e||"href"!==t&&"ngHref"!==t?void 0:C.URL}(a,r),l=!i,u=c[r]||i,d=n(o,l,s,u);if(d){if("multiple"===r&&"select"===a)throw bn("selmulti","Binding to the 'multiple' attribute is not supported. Element: {0}",$e(e));if(m.test(r))throw bn("nodomevents","Interpolations for HTML DOM event attributes are disallowed");t.push({priority:100,compile:function(){return{pre:function(e,t,i){var a=i.$$observers||(i.$$observers=Ue()),l=i[r];l!==o&&(d=l&&n(l,!0,s,u),o=l),d&&(i[r]=d(e),(a[r]||(a[r]=[])).$$inter=!0,(i.$$observers&&i.$$observers[r].$$scope||e).$watch(d,(function(e,t){"class"===r&&e!==t?i.$updateClass(e,t):i.$set(r,e)})))}}}})}}function Le(t,n,o){var r,i,s=n[0],l=n.length,c=s.parentNode;if(t)for(r=0,i=t.length;r<i;r++)if(t[r]===s){t[r++]=o;for(var u=r,d=u+l-1,p=t.length;u<p;u++,d++)d<p?t[u]=t[d]:delete t[u];t.length-=l-1,t.context===s&&(t.context=o);break}c&&c.replaceChild(o,s);var m=e.document.createDocumentFragment();for(r=0;r<l;r++)m.appendChild(n[r]);for(a.hasData(s)&&(a.data(o,a.data(s)),a(s).off("$destroy")),a.cleanData(m.querySelectorAll("*")),r=1;r<l;r++)delete n[r];n[0]=o,n.length=1}function je(e,t){return E((function(){return e.apply(null,arguments)}),e,t)}function De(e,t,n,o,r,i){try{e(t,n,o,r,i)}catch(e){f(e,$e(n))}}function Ne(e,t){if(y)throw bn("missingattr","Attribute '{0}' of '{1}' is non-optional and must be set!",e,t)}function Fe(e,t,o,r,i){var a,s=[],l={};function c(t,n,r){G(o.$onChanges)&&!se(n,r)&&(R||(e.$$postDigest(V),R=[]),a||(a={},R.push(u)),a[t]&&(r=a[t].previousValue),a[t]=new $n(r,n))}function u(){o.$onChanges(a),a=void 0}return S(r,(function(r,a){var u,p,m,f,h,g=r.attrName,v=r.optional;switch(r.mode){case"@":v||d.call(t,g)||(Ne(g,i.name),o[a]=t[g]=void 0),h=t.$observe(g,(function(e){if(W(e)||X(e)){var t=o[a];c(a,e,t),o[a]=e}})),t.$$observers[g].$$scope=e,W(u=t[g])?o[a]=n(u)(e):X(u)&&(o[a]=u),l[a]=new $n(yn,o[a]),s.push(h);break;case"=":if(!d.call(t,g)){if(v)break;Ne(g,i.name),t[g]=void 0}if(v&&!t[g])break;p=P(t[g]),f=p.literal?le:se,m=p.assign||function(){throw u=o[a]=p(e),bn("nonassign","Expression '{0}' in attribute '{1}' used with directive '{2}' is non-assignable!",t[g],g,i.name)},u=o[a]=p(e);var b=function(t){return f(t,o[a])||(f(t,u)?m(e,t=o[a]):o[a]=t),u=t};b.$stateful=!0,h=r.collection?e.$watchCollection(t[g],b):e.$watch(P(t[g],b),null,p.literal),s.push(h);break;case"<":if(!d.call(t,g)){if(v)break;Ne(g,i.name),t[g]=void 0}if(v&&!t[g])break;var y=(p=P(t[g])).literal,w=o[a]=p(e);l[a]=new $n(yn,o[a]),h=e[r.collection?"$watchCollection":"$watch"](p,(function(e,t){if(t===e){if(t===w||y&&le(t,w))return;t=w}c(a,e,t),o[a]=e})),s.push(h);break;case"&":if(v||d.call(t,g)||Ne(g,i.name),(p=t.hasOwnProperty(g)?P(t[g]):L)===L&&v)break;o[a]=function(t){return p(e,t)}}})),{initialChanges:l,removeWatches:s.length&&function(){for(var e=0,t=s.length;e<t;++e)s[e]()}}}}]}function $n(e,t){this.previousValue=e,this.currentValue=t}wn.$inject=["$provide","$$sanitizeUriProvider"],$n.prototype.isFirstChange=function(){return this.previousValue===yn};var kn=/^((?:x|data)[:\-_])/i,Sn=/[:\-_]+(.)/g;function _n(e){return e.replace(kn,"").replace(Sn,(function(e,t,n){return n?t.toUpperCase():t}))}function Pn(e,t){var n="",o=e.split(/\s+/),r=t.split(/\s+/);e:for(var i=0;i<o.length;i++){for(var a=o[i],s=0;s<r.length;s++)if(a===r[s])continue e;n+=(n.length>0?" ":"")+a}return n}function Mn(e){var t=(e=a(e)).length;if(t<=1)return e;for(;t--;){var n=e[t];(n.nodeType===Ve||n.nodeType===We&&""===n.nodeValue.trim())&&h.call(e,t,1)}return e}var Tn=r("$controller"),Cn=/^(\S+)(\s+as\s+([\w$]+))?$/;function En(e,t){if(t&&W(t))return t;if(W(e)){var n=Cn.exec(e);if(n)return n[3]}}function In(){var e={};this.has=function(t){return e.hasOwnProperty(t)},this.register=function(t,n){De(t,"controller"),F(t)?E(e,t):e[t]=n},this.$get=["$injector",function(t){return function(o,r,i,a){var s,l,c,u;if(i=!0===i,a&&W(a)&&(u=a),W(o)){if(!(l=o.match(Cn)))throw Tn("ctrlfmt","Badly formed controller string '{0}'. Must match `__name__ as __id__` or `__name__`.",o);if(c=l[1],u=u||l[3],o=e.hasOwnProperty(c)?e[c]:function(e,t){if(!t)return e;for(var n,o=t.split("."),r=o.length,i=0;i<r;i++)n=o[i],e&&(e=e[n]);return e}(r.$scope,c),!o)throw Tn("ctrlreg","The controller with the name '{0}' is not registered.",c);je(o,c,!0)}if(i){var d=(z(o)?o[o.length-1]:o).prototype;return s=Object.create(d||null),u&&n(r,u,s,c||o.name),E((function(){var e=t.invoke(o,s,r,c);return e!==s&&(F(e)||G(e))&&(s=e,u&&n(r,u,s,c||o.name)),s}),{instance:s,identifier:u})}return s=t.instantiate(o,r,c),u&&n(r,u,s,c||o.name),s};function n(e,t,n,o){if(!e||!F(e.$scope))throw r("$controller")("noscp","Cannot export controller '{0}' as '{1}'! No $scope object provided via `locals`.",o,t);e.$scope[t]=n}}]}function Rn(){this.$get=["$window",function(e){return a(e.document)}]}function An(){this.$get=["$document","$rootScope",function(e,t){var n=e[0],o=n&&n.hidden;function r(){o=n.hidden}return e.on("visibilitychange",r),t.$on("$destroy",(function(){e.off("visibilitychange",r)})),function(){return o}}]}function xn(){this.$get=["$log",function(e){return function(t,n){e.error.apply(e,arguments)}}]}var Ln=function(){this.$get=["$document",function(e){return function(t){return t?!t.nodeType&&t instanceof a&&(t=t[0]):t=e[0].body,t.offsetWidth+1}}]},On="application/json",jn={"Content-Type":On+";charset=utf-8"},Dn=/^\[|^\{(?!\{)/,Nn={"[":/]$/,"{":/}$/},Un=/^\)]\}',?\n/,Fn=r("$http");function Bn(e){return F(e)?q(e)?e.toISOString():he(e):e}function Wn(){this.$get=function(){return function(e){if(!e)return"";var t=[];return _(e,(function(e,n){null===e||N(e)||G(e)||(z(e)?S(e,(function(e){t.push(Pe(n)+"="+Pe(Bn(e)))})):t.push(Pe(n)+"="+Pe(Bn(e))))})),t.join("&")}}}function Vn(){this.$get=function(){return function(e){if(!e)return"";var t=[];return function e(n,o,r){z(n)?S(n,(function(t,n){e(t,o+"["+(F(t)?n:"")+"]")})):F(n)&&!q(n)?_(n,(function(t,n){e(t,o+(r?"":"[")+n+(r?"":"]"))})):(G(n)&&(n=n()),t.push(Pe(o)+"="+(null==n?"":Pe(Bn(n)))))}(e,"",!0),t.join("&")}}}function qn(e,t){if(W(e)){var n=e.replace(Un,"").trim();if(n){var o=t("Content-Type"),r=o&&0===o.indexOf(On);if(r||(a=(i=n).match(Dn))&&Nn[a[0]].test(i))try{e=ge(n)}catch(t){if(!r)return e;throw Fn("baddata",'Data must be a valid JSON object. Received: "{0}". Parse error: "{1}"',e,t)}}}var i,a;return e}function zn(e){var t,n=Ue();function o(e,t){e&&(n[e]=n[e]?n[e]+", "+t:t)}return W(e)?S(e.split("\n"),(function(e){t=e.indexOf(":"),o(p(ee(e.substr(0,t))),ee(e.substr(t+1)))})):F(e)&&S(e,(function(e,t){o(p(t),ee(e))})),n}function Hn(e){var t;return function(n){if(t||(t=zn(e)),n){var o=t[p(n)];return void 0===o&&(o=null),o}return t}}function Gn(e,t,n,o){return G(o)?o(e,t,n):(S(o,(function(o){e=o(e,t,n)})),e)}function Kn(e){return 200<=e&&e<300}function Yn(){var e=this.defaults={transformResponse:[qn],transformRequest:[function(e){return!F(e)||(t=e,"[object File]"===v.call(t))||function(e){return"[object Blob]"===v.call(e)}(e)||function(e){return"[object FormData]"===v.call(e)}(e)?e:he(e);var t}],headers:{common:{Accept:"application/json, text/plain, */*"},post:He(jn),put:He(jn),patch:He(jn)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",paramSerializer:"$httpParamSerializer",jsonpCallbackParam:"callback"},t=!1;this.useApplyAsync=function(e){return U(e)?(t=!!e,this):t};var n=this.interceptors=[],o=this.xsrfTrustedOrigins=[];Object.defineProperty(this,"xsrfWhitelistedOrigins",{get:function(){return this.xsrfTrustedOrigins},set:function(e){this.xsrfTrustedOrigins=e}}),this.$get=["$browser","$httpBackend","$$cookieReader","$cacheFactory","$rootScope","$q","$injector","$sce",function(i,a,s,l,c,u,d,f){var h=l("$http");e.paramSerializer=W(e.paramSerializer)?d.get(e.paramSerializer):e.paramSerializer;var g=[];S(n,(function(e){g.unshift(W(e)?d.get(e):d.invoke(e))}));var v,b=(v=[pr].concat(o.map(fr)),function(e){var t=fr(e);return v.some(hr.bind(null,t))});function y(n){if(!F(n))throw r("$http")("badreq","Http request configuration must be an object.  Received: {0}",n);if(!W(f.valueOf(n.url)))throw r("$http")("badreq","Http request configuration url must be a string or a $sce trusted object.  Received: {0}",n.url);var o=E({method:"get",transformRequest:e.transformRequest,transformResponse:e.transformResponse,paramSerializer:e.paramSerializer,jsonpCallbackParam:e.jsonpCallbackParam},n);o.headers=function(t){var n,o,r,i=e.headers,a=E({},t.headers);i=E({},i.common,i[p(t.method)]);e:for(n in i){for(r in o=p(n),a)if(p(r)===o)continue e;a[n]=i[n]}return function(e,t){var n,o={};return S(e,(function(e,r){G(e)?null!=(n=e(t))&&(o[r]=n):o[r]=e})),o}(a,He(t))}(n),o.method=m(o.method),o.paramSerializer=W(o.paramSerializer)?d.get(o.paramSerializer):o.paramSerializer,i.$$incOutstandingRequestCount("$http");var l=[],v=[],w=u.resolve(o);return S(g,(function(e){(e.request||e.requestError)&&l.unshift(e.request,e.requestError),(e.response||e.responseError)&&v.push(e.response,e.responseError)})),w=(w=$(w,l)).then((function(n){var o=n.headers,r=Gn(n.data,Hn(o),void 0,n.transformRequest);return N(r)&&S(o,(function(e,t){"content-type"===p(t)&&delete o[t]})),N(n.withCredentials)&&!N(e.withCredentials)&&(n.withCredentials=e.withCredentials),function(n,o){var r,i,l=u.defer(),d=l.promise,m=n.headers,g="jsonp"===p(n.method),v=n.url;if(g?v=f.getTrustedResourceUrl(v):W(v)||(v=f.valueOf(v)),v=function(e,t){return t.length>0&&(e+=(-1===e.indexOf("?")?"?":"&")+t),e}(v,n.paramSerializer(n.params)),g&&(v=function(e,t){var n=e.split("?");if(n.length>2)throw Fn("badjsonp",'Illegal use more than one "?", in url, "{1}"',e);return S(Se(n[1]),(function(n,o){if("JSON_CALLBACK"===n)throw Fn("badjsonp",'Illegal use of JSON_CALLBACK in url, "{0}"',e);if(o===t)throw Fn("badjsonp",'Illegal use of callback param, "{0}", in url, "{1}"',t,e)})),e+=(-1===e.indexOf("?")?"?":"&")+t+"=JSON_CALLBACK"}(v,n.jsonpCallbackParam)),y.pendingRequests.push(n),d.then(P,P),!n.cache&&!e.cache||!1===n.cache||"GET"!==n.method&&"JSONP"!==n.method||(r=F(n.cache)?n.cache:F(e.cache)?e.cache:h),r&&(U(i=r.get(v))?Z(i)?i.then(_,_):z(i)?k(i[1],i[0],He(i[2]),i[3],i[4]):k(i,200,{},"OK","complete"):r.put(v,d)),N(i)){var w=b(n.url)?s()[n.xsrfCookieName||e.xsrfCookieName]:void 0;w&&(m[n.xsrfHeaderName||e.xsrfHeaderName]=w),a(n.method,v,o,(function(e,n,o,i,a){function s(){k(n,e,o,i,a)}r&&(Kn(e)?r.put(v,[e,n,zn(o),i,a]):r.remove(v)),t?c.$applyAsync(s):(s(),c.$$phase||c.$apply())}),m,n.timeout,n.withCredentials,n.responseType,$(n.eventHandlers),$(n.uploadEventHandlers))}return d;function $(e){if(e){var n={};return S(e,(function(e,o){n[o]=function(n){function o(){e(n)}t?c.$applyAsync(o):c.$$phase?o():c.$apply(o)}})),n}}function k(e,t,o,r,i){(Kn(t=t>=-1?t:0)?l.resolve:l.reject)({data:e,status:t,headers:Hn(o),config:n,statusText:r,xhrStatus:i})}function _(e){k(e.data,e.status,He(e.headers()),e.statusText,e.xhrStatus)}function P(){var e=y.pendingRequests.indexOf(n);-1!==e&&y.pendingRequests.splice(e,1)}}(n,r).then(k,k)})),(w=$(w,v)).finally((function(){i.$$completeOutstandingRequest(L,"$http")}));function $(e,t){for(var n=0,o=t.length;n<o;){var r=t[n++],i=t[n++];e=e.then(r,i)}return t.length=0,e}function k(e){var t=E({},e);return t.data=Gn(e.data,e.headers,e.status,o.transformResponse),Kn(e.status)?t:u.reject(t)}}return y.pendingRequests=[],function(e){S(arguments,(function(e){y[e]=function(t,n){return y(E({},n||{},{method:e,url:t}))}}))}("get","delete","head","jsonp"),function(e){S(arguments,(function(e){y[e]=function(t,n,o){return y(E({},o||{},{method:e,url:t,data:n}))}}))}("post","put","patch"),y.defaults=e,y}]}function Jn(){this.$get=function(){return function(){return new e.XMLHttpRequest}}}function Xn(){this.$get=["$browser","$jsonpCallbacks","$document","$xhrFactory",function(e,t,n,o){return function(e,t,n,o,r){return function(i,a,s,l,c,u,d,m,f,h){if(a=a||e.url(),"jsonp"===p(i))var g=o.createCallback(a),v=function(e,t,n){e=e.replace("JSON_CALLBACK",t);var i=r.createElement("script"),a=null;return i.type="text/javascript",i.src=e,i.async=!0,a=function(e){i.removeEventListener("load",a),i.removeEventListener("error",a),r.body.removeChild(i),i=null;var s=-1,l="unknown";e&&("load"!==e.type||o.wasCalled(t)||(e={type:"error"}),l=e.type,s="error"===e.type?404:200),n&&n(s,l)},i.addEventListener("load",a),i.addEventListener("error",a),r.body.appendChild(i),a}(a,g,(function(e,t){var n=200===e&&o.getResponse(g);k(l,e,n,"",t,"complete"),o.removeCallback(g)}));else{var b=t(i,a),y=!1;b.open(i,a,!0),S(c,(function(e,t){U(e)&&b.setRequestHeader(t,e)})),b.onload=function(){var e=b.statusText||"",t="response"in b?b.response:b.responseText,n=1223===b.status?204:b.status;0===n&&(n=t?200:"file"===fr(a).protocol?404:0),k(l,n,t,b.getAllResponseHeaders(),e,"complete")};if(b.onerror=function(){k(l,-1,null,null,"","error")},b.ontimeout=function(){k(l,-1,null,null,"","timeout")},b.onabort=function(){k(l,-1,null,null,"",y?"timeout":"abort")},S(f,(function(e,t){b.addEventListener(t,e)})),S(h,(function(e,t){b.upload.addEventListener(t,e)})),d&&(b.withCredentials=!0),m)try{b.responseType=m}catch(e){if("json"!==m)throw e}b.send(N(s)?null:s)}if(u>0)var w=n((function(){$("timeout")}),u);else Z(u)&&u.then((function(){$(U(u.$$timeoutId)?"timeout":"abort")}));function $(e){y="timeout"===e,v&&v(),b&&b.abort()}function k(e,t,o,r,i,a){U(w)&&n.cancel(w),v=b=null,e(t,o,r,i,a)}}}(e,o,e.defer,t,n[0])}]}var Zn=w.$interpolateMinErr=r("$interpolate");function Qn(){var e="{{",t="}}";this.startSymbol=function(t){return t?(e=t,this):e},this.endSymbol=function(e){return e?(t=e,this):t},this.$get=["$parse","$exceptionHandler","$sce",function(n,o,r){var i=e.length,a=t.length,s=new RegExp(e.replace(/./g,c),"g"),l=new RegExp(t.replace(/./g,c),"g");function c(e){return"\\\\\\"+e}function u(n){return n.replace(s,e).replace(l,t)}function d(e,t,n,o){var r=e.$watch((function(e){return r(),o(e)}),t,n);return r}function p(s,l,c,p){var m=c===r.URL||c===r.MEDIA_URL;if(!s.length||-1===s.indexOf(e)){if(l)return;var f=u(s);m&&(f=r.getTrusted(c,f));var h=j(f);return h.exp=s,h.expressions=[],h.$$watchDelegate=d,h}p=!!p;for(var g,v,b,y,w,$=0,k=[],S=s.length,_=[],P=[];$<S;){if(-1===(g=s.indexOf(e,$))||-1===(v=s.indexOf(t,g+i))){$!==S&&_.push(u(s.substring($)));break}$!==g&&_.push(u(s.substring($,g))),y=s.substring(g+i,v),k.push(y),$=v+a,P.push(_.length),_.push("")}w=1===_.length&&1===P.length;var M=m&&w?void 0:function(e){try{return e=c&&!m?r.getTrusted(c,e):r.valueOf(e),p&&!U(e)?e:Fe(e)}catch(e){o(Zn.interr(s,e))}};if(b=k.map((function(e){return n(e,M)})),!l||k.length){var T=function(e){for(var t=0,n=k.length;t<n;t++){if(p&&N(e[t]))return;_[P[t]]=e[t]}return m?r.getTrusted(c,w?_[0]:_.join("")):(c&&_.length>1&&Zn.throwNoconcat(s),_.join(""))};return E((function(e){var t=0,n=k.length,r=new Array(n);try{for(;t<n;t++)r[t]=b[t](e);return T(r)}catch(e){o(Zn.interr(s,e))}}),{exp:s,expressions:k,$$watchDelegate:function(e,t){var n;return e.$watchGroup(b,(function(o,r){var i=T(o);t.call(this,i,o!==r?n:i,e),n=i}))}})}}return p.startSymbol=function(){return e},p.endSymbol=function(){return t},p}]}Zn.throwNoconcat=function(e){throw Zn("noconcat","Error while interpolating: {0}\nStrict Contextual Escaping disallows interpolations that concatenate multiple expressions when a trusted value is required.  See http://docs.angularjs.org/api/ng.$sce",e)},Zn.interr=function(e,t){return Zn("interr","Can't interpolate: {0}\n{1}",e,t.toString())};var eo=r("$interval");function to(){this.$get=["$$intervalFactory","$window",function(e,t){var n={},o=function(e){t.clearInterval(e),delete n[e]},r=e((function(e,o,r){var i=t.setInterval(e,o);return n[i]=r,i}),o);return r.cancel=function(e){if(!e)return!1;if(!e.hasOwnProperty("$$intervalId"))throw eo("badprom","`$interval.cancel()` called with a promise that was not generated by `$interval()`.");if(!n.hasOwnProperty(e.$$intervalId))return!1;var t=e.$$intervalId,r=n[t];return zo(r.promise),r.reject("canceled"),o(t),!0},r}]}function no(){this.$get=["$browser","$q","$$q","$rootScope",function(e,t,n,o){return function(r,i){return function(a,s,l,c){var u=arguments.length>4,d=u?pe(arguments,4):[],p=0,m=U(c)&&!c,f=(m?n:t).defer(),h=f.promise;function g(){u?a.apply(null,d):a(p)}return l=U(l)?l:0,h.$$intervalId=r((function(){m?e.defer(g):o.$evalAsync(g),f.notify(p++),l>0&&p>=l&&(f.resolve(p),i(h.$$intervalId)),m||o.$apply()}),s,f,m),h}}}]}var oo=function(){this.$get=function(){var e=w.callbacks,t={};return{createCallback:function(n){var o="_"+(e.$$counter++).toString(36),r="angular.callbacks."+o,i=function(e){var t=function(e){t.data=e,t.called=!0};return t.id=e,t}(o);return t[r]=e[o]=i,r},wasCalled:function(e){return t[e].called},getResponse:function(e){return t[e].data},removeCallback:function(n){var o=t[n];delete e[o.id],delete t[n]}}}},ro=/^([^?#]*)(\?([^#]*))?(#(.*))?$/,io={http:80,https:443,ftp:21},ao=r("$location");function so(e,t){var n=fr(e);t.$$protocol=n.protocol,t.$$host=n.hostname,t.$$port=R(n.port)||io[n.protocol]||null}var lo=/^\s*[\\/]{2,}/;function co(e,t,n){if(lo.test(e))throw ao("badpath",'Invalid url "{0}".',e);var o="/"!==e.charAt(0);o&&(e="/"+e);var r=fr(e),i=o&&"/"===r.pathname.charAt(0)?r.pathname.substring(1):r.pathname;t.$$path=function(e,t){for(var n=e.split("/"),o=n.length;o--;)n[o]=decodeURIComponent(n[o]),t&&(n[o]=n[o].replace(/\//g,"%2F"));return n.join("/")}(i,n),t.$$search=Se(r.search),t.$$hash=decodeURIComponent(r.hash),t.$$path&&"/"!==t.$$path.charAt(0)&&(t.$$path="/"+t.$$path)}function uo(e,t){return e.slice(0,t.length)===t}function po(e,t){if(uo(t,e))return t.substr(e.length)}function mo(e){var t=e.indexOf("#");return-1===t?e:e.substr(0,t)}function fo(e,t,n){this.$$html5=!0,n=n||"",so(e,this),this.$$parse=function(e){var n=po(t,e);if(!W(n))throw ao("ipthprfx",'Invalid url "{0}", missing path prefix "{1}".',e,t);co(n,this,!0),this.$$path||(this.$$path="/"),this.$$compose()},this.$$normalizeUrl=function(e){return t+e.substr(1)},this.$$parseLinkUrl=function(o,r){return r&&"#"===r[0]?(this.hash(r.slice(1)),!0):(U(i=po(e,o))?(a=i,s=n&&U(i=po(n,i))?t+(po("/",i)||i):e+a):U(i=po(t,o))?s=t+i:t===o+"/"&&(s=t),s&&this.$$parse(s),!!s);var i,a,s}}function ho(e,t,n){so(e,this),this.$$parse=function(o){var r,i=po(e,o)||po(t,o);N(i)||"#"!==i.charAt(0)?this.$$html5?r=i:(r="",N(i)&&(e=o,this.replace())):N(r=po(n,i))&&(r=i),co(r,this,!1),this.$$path=function(e,t,n){var o,r=/^\/[A-Z]:(\/.*)/;return uo(t,n)&&(t=t.replace(n,"")),r.exec(t)?e:(o=r.exec(e))?o[1]:e}(this.$$path,r,e),this.$$compose()},this.$$normalizeUrl=function(t){return e+(t?n+t:"")},this.$$parseLinkUrl=function(t,n){return mo(e)===mo(t)&&(this.$$parse(t),!0)}}function go(e,t,n){this.$$html5=!0,ho.apply(this,arguments),this.$$parseLinkUrl=function(o,r){return r&&"#"===r[0]?(this.hash(r.slice(1)),!0):(e===mo(o)?i=o:(a=po(t,o))?i=e+n+a:t===o+"/"&&(i=t),i&&this.$$parse(i),!!i);var i,a},this.$$normalizeUrl=function(t){return e+n+t}}var vo={$$absUrl:"",$$html5:!1,$$replace:!1,$$compose:function(){this.$$url=function(e,t,n){var o,r=(o=[],S(t,(function(e,t){z(e)?S(e,(function(e){o.push(Pe(t,!0)+(!0===e?"":"="+Pe(e,!0)))})):o.push(Pe(t,!0)+(!0===e?"":"="+Pe(e,!0)))})),o.length?o.join("&"):""),i=n?"#"+_e(n):"";return function(e){for(var t=e.split("/"),n=t.length;n--;)t[n]=_e(t[n].replace(/%2F/g,"/"));return t.join("/")}(e)+(r?"?"+r:"")+i}(this.$$path,this.$$search,this.$$hash),this.$$absUrl=this.$$normalizeUrl(this.$$url),this.$$urlUpdatedByLocation=!0},absUrl:bo("$$absUrl"),url:function(e){if(N(e))return this.$$url;var t=ro.exec(e);return(t[1]||""===e)&&this.path(decodeURIComponent(t[1])),(t[2]||t[1]||""===e)&&this.search(t[3]||""),this.hash(t[5]||""),this},protocol:bo("$$protocol"),host:bo("$$host"),port:bo("$$port"),path:yo("$$path",(function(e){return"/"===(e=null!==e?e.toString():"").charAt(0)?e:"/"+e})),search:function(e,t){switch(arguments.length){case 0:return this.$$search;case 1:if(W(e)||V(e))e=e.toString(),this.$$search=Se(e);else{if(!F(e))throw ao("isrcharg","The first argument of the `$location#search()` call must be a string or an object.");S(e=ae(e,{}),(function(t,n){null==t&&delete e[n]})),this.$$search=e}break;default:N(t)||null===t?delete this.$$search[e]:this.$$search[e]=t}return this.$$compose(),this},hash:yo("$$hash",(function(e){return null!==e?e.toString():""})),replace:function(){return this.$$replace=!0,this}};function bo(e){return function(){return this[e]}}function yo(e,t){return function(n){return N(n)?this[e]:(this[e]=t(n),this.$$compose(),this)}}function wo(){var e="!",t={enabled:!1,requireBase:!0,rewriteLinks:!0};this.hashPrefix=function(t){return U(t)?(e=t,this):e},this.html5Mode=function(e){return X(e)?(t.enabled=e,this):F(e)?(X(e.enabled)&&(t.enabled=e.enabled),X(e.requireBase)&&(t.requireBase=e.requireBase),(X(e.rewriteLinks)||W(e.rewriteLinks))&&(t.rewriteLinks=e.rewriteLinks),this):t},this.$get=["$rootScope","$browser","$sniffer","$rootElement","$window",function(n,o,r,i,s){var l,c,u,d,p=o.baseHref(),m=o.url();if(t.enabled){if(!p&&t.requireBase)throw ao("nobase","$location in HTML5 mode requires a <base> tag to be present!");u=(d=m).substring(0,d.indexOf("/",d.indexOf("//")+2))+(p||"/"),c=r.history?fo:go}else u=mo(m),c=ho;var f=function(e){return e.substr(0,mo(e).lastIndexOf("/")+1)}(u);(l=new c(u,f,"#"+e)).$$parseLinkUrl(m,m),l.$$state=o.state();var h=/^\s*(javascript|mailto):/i;function g(e,t,n){var r=l.url(),i=l.$$state;try{o.url(e,t,n),l.$$state=o.state()}catch(e){throw l.url(r),l.$$state=i,e}}i.on("click",(function(e){var r=t.rewriteLinks;if(r&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&2!==e.which&&2!==e.button){for(var s=a(e.target);"a"!==oe(s[0]);)if(s[0]===i[0]||!(s=s.parent())[0])return;if(!W(r)||!N(s.attr(r))){var c=s.prop("href"),u=s.attr("href")||s.attr("xlink:href");F(c)&&"[object SVGAnimatedString]"===c.toString()&&(c=fr(c.animVal).href),h.test(c)||!c||s.attr("target")||e.isDefaultPrevented()||l.$$parseLinkUrl(c,u)&&(e.preventDefault(),l.absUrl()!==o.url()&&n.$apply())}}})),l.absUrl()!==m&&o.url(l.absUrl(),!0);var v=!0;return o.onUrlChange((function(e,t){uo(e,f)?(n.$evalAsync((function(){var o,r=l.absUrl(),i=l.$$state;l.$$parse(e),l.$$state=t,o=n.$broadcast("$locationChangeStart",e,r,t,i).defaultPrevented,l.absUrl()===e&&(o?(l.$$parse(r),l.$$state=i,g(r,!1,i)):(v=!1,b(r,i)))})),n.$$phase||n.$digest()):s.location.href=e})),n.$watch((function(){if(v||l.$$urlUpdatedByLocation){l.$$urlUpdatedByLocation=!1;var e=o.url(),t=l.absUrl(),i=o.state(),a=l.$$replace,s=!((c=e)===(u=t)||fr(c).href===fr(u).href)||l.$$html5&&r.history&&i!==l.$$state;(v||s)&&(v=!1,n.$evalAsync((function(){var t=l.absUrl(),o=n.$broadcast("$locationChangeStart",t,e,l.$$state,i).defaultPrevented;l.absUrl()===t&&(o?(l.$$parse(e),l.$$state=i):(s&&g(t,a,i===l.$$state?null:l.$$state),b(e,i)))})))}var c,u;l.$$replace=!1})),l;function b(e,t){n.$broadcast("$locationChangeSuccess",l.absUrl(),e,l.$$state,t)}}]}function $o(){var e=!0,t=this;this.debugEnabled=function(t){return U(t)?(e=t,this):e},this.$get=["$window",function(n){var o,r=i||/\bEdge\//.test(n.navigator&&n.navigator.userAgent);return{log:a("log"),info:a("info"),warn:a("warn"),error:a("error"),debug:(o=a("debug"),function(){e&&o.apply(t,arguments)})};function a(e){var t=n.console||{},o=t[e]||t.log||L;return function(){var e=[];return S(arguments,(function(t){e.push(function(e){return H(e)&&(e.stack&&r?e=e.message&&-1===e.stack.indexOf(e.message)?"Error: "+e.message+"\n"+e.stack:e.stack:e.sourceURL&&(e=e.message+"\n"+e.sourceURL+":"+e.line)),e}(t))})),Function.prototype.apply.call(o,t,e)}}}]}S([go,ho,fo],(function(e){e.prototype=Object.create(vo),e.prototype.state=function(t){if(!arguments.length)return this.$$state;if(e!==fo||!this.$$html5)throw ao("nostate","History API state support is available only in HTML5 mode and only in browsers supporting HTML5 History API");return this.$$state=N(t)?null:t,this.$$urlUpdatedByLocation=!0,this}}));var ko=r("$parse"),So={}.constructor.prototype.valueOf;function _o(e){return e+""}var Po=Ue();S("+ - * / % === !== == != < > <= >= && || ! = |".split(" "),(function(e){Po[e]=!0}));var Mo={n:"\n",f:"\f",r:"\r",t:"\t",v:"\v","'":"'",'"':'"'},To=function(e){this.options=e};To.prototype={constructor:To,lex:function(e){for(this.text=e,this.index=0,this.tokens=[];this.index<this.text.length;){var t=this.text.charAt(this.index);if('"'===t||"'"===t)this.readString(t);else if(this.isNumber(t)||"."===t&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdentifierStart(this.peekMultichar()))this.readIdent();else if(this.is(t,"(){}[].,;:?"))this.tokens.push({index:this.index,text:t}),this.index++;else if(this.isWhitespace(t))this.index++;else{var n=t+this.peek(),o=n+this.peek(2),r=Po[t],i=Po[n],a=Po[o];if(r||i||a){var s=a?o:i?n:t;this.tokens.push({index:this.index,text:s,operator:!0}),this.index+=s.length}else this.throwError("Unexpected next character ",this.index,this.index+1)}}return this.tokens},is:function(e,t){return-1!==t.indexOf(e)},peek:function(e){var t=e||1;return this.index+t<this.text.length&&this.text.charAt(this.index+t)},isNumber:function(e){return"0"<=e&&e<="9"&&"string"==typeof e},isWhitespace:function(e){return" "===e||"\r"===e||"\t"===e||"\n"===e||"\v"===e||""===e},isIdentifierStart:function(e){return this.options.isIdentifierStart?this.options.isIdentifierStart(e,this.codePointAt(e)):this.isValidIdentifierStart(e)},isValidIdentifierStart:function(e){return"a"<=e&&e<="z"||"A"<=e&&e<="Z"||"_"===e||"$"===e},isIdentifierContinue:function(e){return this.options.isIdentifierContinue?this.options.isIdentifierContinue(e,this.codePointAt(e)):this.isValidIdentifierContinue(e)},isValidIdentifierContinue:function(e,t){return this.isValidIdentifierStart(e,t)||this.isNumber(e)},codePointAt:function(e){return 1===e.length?e.charCodeAt(0):(e.charCodeAt(0)<<10)+e.charCodeAt(1)-56613888},peekMultichar:function(){var e=this.text.charAt(this.index),t=this.peek();if(!t)return e;var n=e.charCodeAt(0),o=t.charCodeAt(0);return n>=55296&&n<=56319&&o>=56320&&o<=57343?e+t:e},isExpOperator:function(e){return"-"===e||"+"===e||this.isNumber(e)},throwError:function(e,t,n){n=n||this.index;var o=U(t)?"s "+t+"-"+this.index+" ["+this.text.substring(t,n)+"]":" "+n;throw ko("lexerr","Lexer Error: {0} at column{1} in expression [{2}].",e,o,this.text)},readNumber:function(){for(var e="",t=this.index;this.index<this.text.length;){var n=p(this.text.charAt(this.index));if("."===n||this.isNumber(n))e+=n;else{var o=this.peek();if("e"===n&&this.isExpOperator(o))e+=n;else if(this.isExpOperator(n)&&o&&this.isNumber(o)&&"e"===e.charAt(e.length-1))e+=n;else{if(!this.isExpOperator(n)||o&&this.isNumber(o)||"e"!==e.charAt(e.length-1))break;this.throwError("Invalid exponent")}}this.index++}this.tokens.push({index:t,text:e,constant:!0,value:Number(e)})},readIdent:function(){var e=this.index;for(this.index+=this.peekMultichar().length;this.index<this.text.length;){var t=this.peekMultichar();if(!this.isIdentifierContinue(t))break;this.index+=t.length}this.tokens.push({index:e,text:this.text.slice(e,this.index),identifier:!0})},readString:function(e){var t=this.index;this.index++;for(var n="",o=e,r=!1;this.index<this.text.length;){var i=this.text.charAt(this.index);if(o+=i,r){if("u"===i){var a=this.text.substring(this.index+1,this.index+5);a.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+a+"]"),this.index+=4,n+=String.fromCharCode(parseInt(a,16))}else n+=Mo[i]||i;r=!1}else if("\\"===i)r=!0;else{if(i===e)return this.index++,void this.tokens.push({index:t,text:o,constant:!0,value:n});n+=i}this.index++}this.throwError("Unterminated quote",t)}};var Co=function(e,t){this.lexer=e,this.options=t};function Eo(e,t){return void 0!==e?e:t}function Io(e,t){return void 0===e?t:void 0===t?e:e+t}Co.Program="Program",Co.ExpressionStatement="ExpressionStatement",Co.AssignmentExpression="AssignmentExpression",Co.ConditionalExpression="ConditionalExpression",Co.LogicalExpression="LogicalExpression",Co.BinaryExpression="BinaryExpression",Co.UnaryExpression="UnaryExpression",Co.CallExpression="CallExpression",Co.MemberExpression="MemberExpression",Co.Identifier="Identifier",Co.Literal="Literal",Co.ArrayExpression="ArrayExpression",Co.Property="Property",Co.ObjectExpression="ObjectExpression",Co.ThisExpression="ThisExpression",Co.LocalsExpression="LocalsExpression",Co.NGValueParameter="NGValueParameter",Co.prototype={ast:function(e){this.text=e,this.tokens=this.lexer.lex(e);var t=this.program();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),t},program:function(){for(var e=[];;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&e.push(this.expressionStatement()),!this.expect(";"))return{type:Co.Program,body:e}},expressionStatement:function(){return{type:Co.ExpressionStatement,expression:this.filterChain()}},filterChain:function(){for(var e=this.expression();this.expect("|");)e=this.filter(e);return e},expression:function(){return this.assignment()},assignment:function(){var e=this.ternary();if(this.expect("=")){if(!xo(e))throw ko("lval","Trying to assign a value to a non l-value");e={type:Co.AssignmentExpression,left:e,right:this.assignment(),operator:"="}}return e},ternary:function(){var e,t,n=this.logicalOR();return this.expect("?")&&(e=this.expression(),this.consume(":"))?(t=this.expression(),{type:Co.ConditionalExpression,test:n,alternate:e,consequent:t}):n},logicalOR:function(){for(var e=this.logicalAND();this.expect("||");)e={type:Co.LogicalExpression,operator:"||",left:e,right:this.logicalAND()};return e},logicalAND:function(){for(var e=this.equality();this.expect("&&");)e={type:Co.LogicalExpression,operator:"&&",left:e,right:this.equality()};return e},equality:function(){for(var e,t=this.relational();e=this.expect("==","!=","===","!==");)t={type:Co.BinaryExpression,operator:e.text,left:t,right:this.relational()};return t},relational:function(){for(var e,t=this.additive();e=this.expect("<",">","<=",">=");)t={type:Co.BinaryExpression,operator:e.text,left:t,right:this.additive()};return t},additive:function(){for(var e,t=this.multiplicative();e=this.expect("+","-");)t={type:Co.BinaryExpression,operator:e.text,left:t,right:this.multiplicative()};return t},multiplicative:function(){for(var e,t=this.unary();e=this.expect("*","/","%");)t={type:Co.BinaryExpression,operator:e.text,left:t,right:this.unary()};return t},unary:function(){var e;return(e=this.expect("+","-","!"))?{type:Co.UnaryExpression,operator:e.text,prefix:!0,argument:this.unary()}:this.primary()},primary:function(){var e,t;for(this.expect("(")?(e=this.filterChain(),this.consume(")")):this.expect("[")?e=this.arrayDeclaration():this.expect("{")?e=this.object():this.selfReferential.hasOwnProperty(this.peek().text)?e=ae(this.selfReferential[this.consume().text]):this.options.literals.hasOwnProperty(this.peek().text)?e={type:Co.Literal,value:this.options.literals[this.consume().text]}:this.peek().identifier?e=this.identifier():this.peek().constant?e=this.constant():this.throwError("not a primary expression",this.peek());t=this.expect("(","[",".");)"("===t.text?(e={type:Co.CallExpression,callee:e,arguments:this.parseArguments()},this.consume(")")):"["===t.text?(e={type:Co.MemberExpression,object:e,property:this.expression(),computed:!0},this.consume("]")):"."===t.text?e={type:Co.MemberExpression,object:e,property:this.identifier(),computed:!1}:this.throwError("IMPOSSIBLE");return e},filter:function(e){for(var t=[e],n={type:Co.CallExpression,callee:this.identifier(),arguments:t,filter:!0};this.expect(":");)t.push(this.expression());return n},parseArguments:function(){var e=[];if(")"!==this.peekToken().text)do{e.push(this.filterChain())}while(this.expect(","));return e},identifier:function(){var e=this.consume();return e.identifier||this.throwError("is not a valid identifier",e),{type:Co.Identifier,name:e.text}},constant:function(){return{type:Co.Literal,value:this.consume().value}},arrayDeclaration:function(){var e=[];if("]"!==this.peekToken().text)do{if(this.peek("]"))break;e.push(this.expression())}while(this.expect(","));return this.consume("]"),{type:Co.ArrayExpression,elements:e}},object:function(){var e,t=[];if("}"!==this.peekToken().text)do{if(this.peek("}"))break;e={type:Co.Property,kind:"init"},this.peek().constant?(e.key=this.constant(),e.computed=!1,this.consume(":"),e.value=this.expression()):this.peek().identifier?(e.key=this.identifier(),e.computed=!1,this.peek(":")?(this.consume(":"),e.value=this.expression()):e.value=e.key):this.peek("[")?(this.consume("["),e.key=this.expression(),this.consume("]"),e.computed=!0,this.consume(":"),e.value=this.expression()):this.throwError("invalid key",this.peek()),t.push(e)}while(this.expect(","));return this.consume("}"),{type:Co.ObjectExpression,properties:t}},throwError:function(e,t){throw ko("syntax","Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].",t.text,e,t.index+1,this.text,this.text.substring(t.index))},consume:function(e){if(0===this.tokens.length)throw ko("ueoe","Unexpected end of expression: {0}",this.text);var t=this.expect(e);return t||this.throwError("is unexpected, expecting ["+e+"]",this.peek()),t},peekToken:function(){if(0===this.tokens.length)throw ko("ueoe","Unexpected end of expression: {0}",this.text);return this.tokens[0]},peek:function(e,t,n,o){return this.peekAhead(0,e,t,n,o)},peekAhead:function(e,t,n,o,r){if(this.tokens.length>e){var i=this.tokens[e],a=i.text;if(a===t||a===n||a===o||a===r||!t&&!n&&!o&&!r)return i}return!1},expect:function(e,t,n,o){var r=this.peek(e,t,n,o);return!!r&&(this.tokens.shift(),r)},selfReferential:{this:{type:Co.ThisExpression},$locals:{type:Co.LocalsExpression}}};function Ro(e,t,n){var o,r,i,a=e.isPure=function(e,t){switch(e.type){case Co.MemberExpression:if(e.computed)return!1;break;case Co.UnaryExpression:return 1;case Co.BinaryExpression:return"+"!==e.operator&&1;case Co.CallExpression:return!1}return void 0===t?2:t}(e,n);switch(e.type){case Co.Program:o=!0,S(e.body,(function(e){Ro(e.expression,t,a),o=o&&e.expression.constant})),e.constant=o;break;case Co.Literal:e.constant=!0,e.toWatch=[];break;case Co.UnaryExpression:Ro(e.argument,t,a),e.constant=e.argument.constant,e.toWatch=e.argument.toWatch;break;case Co.BinaryExpression:Ro(e.left,t,a),Ro(e.right,t,a),e.constant=e.left.constant&&e.right.constant,e.toWatch=e.left.toWatch.concat(e.right.toWatch);break;case Co.LogicalExpression:Ro(e.left,t,a),Ro(e.right,t,a),e.constant=e.left.constant&&e.right.constant,e.toWatch=e.constant?[]:[e];break;case Co.ConditionalExpression:Ro(e.test,t,a),Ro(e.alternate,t,a),Ro(e.consequent,t,a),e.constant=e.test.constant&&e.alternate.constant&&e.consequent.constant,e.toWatch=e.constant?[]:[e];break;case Co.Identifier:e.constant=!1,e.toWatch=[e];break;case Co.MemberExpression:Ro(e.object,t,a),e.computed&&Ro(e.property,t,a),e.constant=e.object.constant&&(!e.computed||e.property.constant),e.toWatch=e.constant?[]:[e];break;case Co.CallExpression:i=!!e.filter&&function(e,t){return!e(t).$stateful}(t,e.callee.name),o=i,r=[],S(e.arguments,(function(e){Ro(e,t,a),o=o&&e.constant,r.push.apply(r,e.toWatch)})),e.constant=o,e.toWatch=i?r:[e];break;case Co.AssignmentExpression:Ro(e.left,t,a),Ro(e.right,t,a),e.constant=e.left.constant&&e.right.constant,e.toWatch=[e];break;case Co.ArrayExpression:o=!0,r=[],S(e.elements,(function(e){Ro(e,t,a),o=o&&e.constant,r.push.apply(r,e.toWatch)})),e.constant=o,e.toWatch=r;break;case Co.ObjectExpression:o=!0,r=[],S(e.properties,(function(e){Ro(e.value,t,a),o=o&&e.value.constant,r.push.apply(r,e.value.toWatch),e.computed&&(Ro(e.key,t,!1),o=o&&e.key.constant,r.push.apply(r,e.key.toWatch))})),e.constant=o,e.toWatch=r;break;case Co.ThisExpression:case Co.LocalsExpression:e.constant=!1,e.toWatch=[]}}function Ao(e){if(1===e.length){var t=e[0].expression,n=t.toWatch;return 1!==n.length||n[0]!==t?n:void 0}}function xo(e){return e.type===Co.Identifier||e.type===Co.MemberExpression}function Lo(e){if(1===e.body.length&&xo(e.body[0].expression))return{type:Co.AssignmentExpression,left:e.body[0].expression,right:{type:Co.NGValueParameter},operator:"="}}function Oo(e){this.$filter=e}function jo(e){this.$filter=e}function Do(e,t,n){this.ast=new Co(e,n),this.astCompiler=n.csp?new jo(t):new Oo(t)}function No(e){return G(e.valueOf)?e.valueOf():So.call(e)}function Uo(){var e,t,n=Ue(),o={true:!0,false:!1,null:null,undefined:void 0};this.addLiteral=function(e,t){o[e]=t},this.setIdentifierFns=function(n,o){return e=n,t=o,this},this.$get=["$filter",function(r){var i={csp:ce().noUnsafeEval,literals:ae(o),isIdentifierStart:G(e)&&e,isIdentifierContinue:G(t)&&t};return a.$$getAst=function(e){return new Do(new To(i),r,i).getAst(e).ast},a;function a(e,t){var o,a;switch(typeof e){case"string":return e=e.trim(),(o=n[a=e])||(o=new Do(new To(i),r,i).parse(e),n[a]=p(o)),m(o,t);case"function":return m(e,t);default:return m(L,t)}}function s(e,t,n){return null==e||null==t?e===t:!("object"==typeof e&&"object"==typeof(e=No(e))&&!n)&&(e===t||e!=e&&t!=t)}function l(e,t,n,o,r){var i,a=o.inputs;if(1===a.length){var l=s;return a=a[0],e.$watch((function(e){var t=a(e);return s(t,l,a.isPure)||(i=o(e,void 0,void 0,[t]),l=t&&No(t)),i}),t,n,r)}for(var c=[],u=[],d=0,p=a.length;d<p;d++)c[d]=s,u[d]=null;return e.$watch((function(e){for(var t=!1,n=0,r=a.length;n<r;n++){var l=a[n](e);(t||(t=!s(l,c[n],a[n].isPure)))&&(u[n]=l,c[n]=l&&No(l))}return t&&(i=o(e,void 0,void 0,u)),i}),t,n,r)}function c(e,t,n,o,r){var i,a,s=o.literal?u:U,l=o.$$intercepted||o,c=o.$$interceptor||O,d=o.inputs&&!l.inputs;return f.literal=o.literal,f.constant=o.constant,f.inputs=o.inputs,p(f),i=e.$watch(f,t,n,r);function m(){s(a)&&i()}function f(e,t,n,o){return a=d&&o?o[0]:l(e,t,n,o),s(a)&&e.$$postDigest(m),c(a)}}function u(e){var t=!0;return S(e,(function(e){U(e)||(t=!1)})),t}function d(e,t,n,o){var r=e.$watch((function(e){return r(),o(e)}),t,n);return r}function p(e){return e.constant?e.$$watchDelegate=d:e.oneTime?e.$$watchDelegate=c:e.inputs&&(e.$$watchDelegate=l),e}function m(e,t){if(!t)return e;e.$$interceptor&&(t=function(e,t){function n(n){return t(e(n))}return n.$stateful=e.$stateful||t.$stateful,n.$$pure=e.$$pure&&t.$$pure,n}(e.$$interceptor,t),e=e.$$intercepted);var n=!1,o=function(o,r,i,a){var s=n&&a?a[0]:e(o,r,i,a);return t(s)};return o.$$intercepted=e,o.$$interceptor=t,o.literal=e.literal,o.oneTime=e.oneTime,o.constant=e.constant,t.$stateful||(n=!e.inputs,o.inputs=e.inputs?e.inputs:[e],t.$$pure||(o.inputs=o.inputs.map((function(e){return 2===e.isPure?function(t){return e(t)}:e})))),p(o)}}]}function Fo(){var e=!0;this.$get=["$rootScope","$exceptionHandler",function(t,n){return Wo((function(e){t.$evalAsync(e)}),n,e)}],this.errorOnUnhandledRejections=function(t){return U(t)?(e=t,this):e}}function Bo(){var e=!0;this.$get=["$browser","$exceptionHandler",function(t,n){return Wo((function(e){t.defer(e)}),n,e)}],this.errorOnUnhandledRejections=function(t){return U(t)?(e=t,this):e}}function Wo(e,t,n){var o=r("$q",TypeError),i=0,a=[];function s(){return new l}function l(){var e=this.promise=new c;this.resolve=function(t){p(e,t)},this.reject=function(t){f(e,t)},this.notify=function(t){g(e,t)}}function c(){this.$$state={status:0}}function u(){for(;!i&&a.length;){var e=a.shift();if(!Vo(e)){qo(e);var n="Possibly unhandled rejection: "+Ge(e.value);H(e.value)?t(e.value,n):t(n)}}}function d(o){!n||o.pending||2!==o.status||Vo(o)||(0===i&&0===a.length&&e(u),a.push(o)),!o.processScheduled&&o.pending&&(o.processScheduled=!0,++i,e((function(){!function(o){var r,a,s;s=o.pending,o.processScheduled=!1,o.pending=void 0;try{for(var l=0,c=s.length;l<c;++l){qo(o),a=s[l][0],r=s[l][o.status];try{G(r)?p(a,r(o.value)):1===o.status?p(a,o.value):f(a,o.value)}catch(e){f(a,e),e&&!0===e.$$passToExceptionHandler&&t(e)}}}finally{--i,n&&0===i&&e(u)}}(o)})))}function p(e,t){e.$$state.status||(t===e?h(e,o("qcycle","Expected promise to be resolved with value other than itself '{0}'",t)):m(e,t))}function m(e,t){var n,o=!1;try{(F(t)||G(t))&&(n=t.then),G(n)?(e.$$state.status=-1,n.call(t,(function(t){o||(o=!0,m(e,t))}),r,(function(t){g(e,t)}))):(e.$$state.value=t,e.$$state.status=1,d(e.$$state))}catch(e){r(e)}function r(t){o||(o=!0,h(e,t))}}function f(e,t){e.$$state.status||h(e,t)}function h(e,t){e.$$state.value=t,e.$$state.status=2,d(e.$$state)}function g(n,o){var r=n.$$state.pending;n.$$state.status<=0&&r&&r.length&&e((function(){for(var e,n,i=0,a=r.length;i<a;i++){n=r[i][0],e=r[i][3];try{g(n,G(e)?e(o):o)}catch(e){t(e)}}}))}function v(e){var t=new c;return f(t,e),t}function b(e,t,n){var o=null;try{G(n)&&(o=n())}catch(e){return v(e)}return Z(o)?o.then((function(){return t(e)}),v):t(e)}function y(e,t,n,o){var r=new c;return p(r,e),r.then(t,n,o)}E(c.prototype,{then:function(e,t,n){if(N(e)&&N(t)&&N(n))return this;var o=new c;return this.$$state.pending=this.$$state.pending||[],this.$$state.pending.push([o,e,t,n]),this.$$state.status>0&&d(this.$$state),o},catch:function(e){return this.then(null,e)},finally:function(e,t){return this.then((function(t){return b(t,w,e)}),(function(t){return b(t,v,e)}),t)}});var w=y;function $(e){if(!G(e))throw o("norslvr","Expected resolverFn, got '{0}'",e);var t=new c;return e((function(e){p(t,e)}),(function(e){f(t,e)})),t}return $.prototype=c.prototype,$.defer=s,$.reject=v,$.when=y,$.resolve=w,$.all=function(e){var t=new c,n=0,o=z(e)?[]:{};return S(e,(function(e,r){n++,y(e).then((function(e){o[r]=e,--n||p(t,o)}),(function(e){f(t,e)}))})),0===n&&p(t,o),t},$.race=function(e){var t=s();return S(e,(function(e){y(e).then(t.resolve,t.reject)})),t.promise},$}function Vo(e){return!!e.pur}function qo(e){e.pur=!0}function zo(e){e.$$state&&qo(e.$$state)}function Ho(){this.$get=["$window","$timeout",function(e,t){var n=e.requestAnimationFrame||e.webkitRequestAnimationFrame,o=e.cancelAnimationFrame||e.webkitCancelAnimationFrame||e.webkitCancelRequestAnimationFrame,r=!!n,i=r?function(e){var t=n(e);return function(){o(t)}}:function(e){var n=t(e,16.66,!1);return function(){t.cancel(n)}};return i.supported=r,i}]}function Go(){var e=10,t=r("$rootScope"),n=null,o=null;this.digestTtl=function(t){return arguments.length&&(e=t),e},this.$get=["$exceptionHandler","$parse","$browser",function(r,a,s){function l(e){e.currentScope.$$destroyed=!0}function c(e){9===i&&(e.$$childHead&&c(e.$$childHead),e.$$nextSibling&&c(e.$$nextSibling)),e.$parent=e.$$nextSibling=e.$$prevSibling=e.$$childHead=e.$$childTail=e.$root=e.$$watchers=null}function u(){this.$id=M(),this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,this.$root=this,this.$$destroyed=!1,this.$$suspended=!1,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$$isolateBindings=null}u.prototype={constructor:u,$new:function(e,t){var n;return t=t||this,e?(n=new u).$root=this.$root:(this.$$ChildScope||(this.$$ChildScope=function(e){function t(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$id=M(),this.$$ChildScope=null,this.$$suspended=!1}return t.prototype=e,t}(this)),n=new this.$$ChildScope),n.$parent=t,n.$$prevSibling=t.$$childTail,t.$$childHead?(t.$$childTail.$$nextSibling=n,t.$$childTail=n):t.$$childHead=t.$$childTail=n,(e||t!==this)&&n.$on("$destroy",l),n},$watch:function(e,t,o,r){var i=a(e),s=G(t)?t:L;if(i.$$watchDelegate)return i.$$watchDelegate(this,s,o,i,e);var l=this,c=l.$$watchers,u={fn:s,last:$,get:i,exp:r||e,eq:!!o};return n=null,c||((c=l.$$watchers=[]).$$digestWatchIndex=-1),c.unshift(u),c.$$digestWatchIndex++,y(this,1),function(){var e=ie(c,u);e>=0&&(y(l,-1),e<c.$$digestWatchIndex&&c.$$digestWatchIndex--),n=null}},$watchGroup:function(e,t){var n=new Array(e.length),o=new Array(e.length),r=[],i=this,a=!1,s=!0;if(!e.length){var l=!0;return i.$evalAsync((function(){l&&t(o,o,i)})),function(){l=!1}}if(1===e.length)return this.$watch(e[0],(function(e,r,i){o[0]=e,n[0]=r,t(o,e===r?o:n,i)}));function c(){a=!1;try{s?(s=!1,t(o,o,i)):t(o,n,i)}finally{for(var r=0;r<e.length;r++)n[r]=o[r]}}return S(e,(function(e,t){var n=i.$watch(e,(function(e){o[t]=e,a||(a=!0,i.$evalAsync(c))}));r.push(n)})),function(){for(;r.length;)r.shift()()}},$watchCollection:function(e,t){h.$$pure=a(e).literal,h.$stateful=!h.$$pure;var n,o,r,i=this,s=t.length>1,l=0,c=a(e,h),u=[],p={},m=!0,f=0;function h(e){var t,r,i,a;if(!N(n=e)){if(F(n))if(k(n)){o!==u&&(f=(o=u).length=0,l++),t=n.length,f!==t&&(l++,o.length=f=t);for(var s=0;s<t;s++)a=o[s],i=n[s],a!=a&&i!=i||a===i||(l++,o[s]=i)}else{for(r in o!==p&&(o=p={},f=0,l++),t=0,n)d.call(n,r)&&(t++,i=n[r],a=o[r],r in o?a!=a&&i!=i||a===i||(l++,o[r]=i):(f++,o[r]=i,l++));if(f>t)for(r in l++,o)d.call(n,r)||(f--,delete o[r])}else o!==n&&(o=n,l++);return l}}return this.$watch(c,(function(){if(m?(m=!1,t(n,n,i)):t(n,r,i),s)if(F(n))if(k(n)){r=new Array(n.length);for(var e=0;e<n.length;e++)r[e]=n[e]}else for(var o in r={},n)d.call(n,o)&&(r[o]=n[o]);else r=n}))},$digest:function(){var i,a,l,c,u,d,h,y,w,k=e,S=m.length?p:this,P=[];v("$digest"),s.$$checkUrlChange(),this===p&&null!==o&&(s.defer.cancel(o),_()),n=null;do{u=!1,h=S;for(var M=0;M<m.length;M++){try{(0,(w=m[M]).fn)(w.scope,w.locals)}catch(e){r(e)}n=null}m.length=0;e:do{if(c=!h.$$suspended&&h.$$watchers)for(c.$$digestWatchIndex=c.length;c.$$digestWatchIndex--;)try{if(i=c[c.$$digestWatchIndex])if((a=(0,i.get)(h))===(l=i.last)||(i.eq?le(a,l):A(a)&&A(l))){if(i===n){u=!1;break e}}else u=!0,n=i,i.last=i.eq?ae(a,null):a,(0,i.fn)(a,l===$?a:l,h),k<5&&(P[y=4-k]||(P[y]=[]),P[y].push({msg:G(i.exp)?"fn: "+(i.exp.name||i.exp.toString()):i.exp,newVal:a,oldVal:l}))}catch(e){r(e)}if(!(d=!h.$$suspended&&h.$$watchersCount&&h.$$childHead||h!==S&&h.$$nextSibling))for(;h!==S&&!(d=h.$$nextSibling);)h=h.$parent}while(h=d);if((u||m.length)&&!k--)throw b(),t("infdig","{0} $digest() iterations reached. Aborting!\nWatchers fired in the last 5 iterations: {1}",e,P)}while(u||m.length);for(b();g<f.length;)try{f[g++]()}catch(e){r(e)}f.length=g=0,s.$$checkUrlChange()},$suspend:function(){this.$$suspended=!0},$isSuspended:function(){return this.$$suspended},$resume:function(){this.$$suspended=!1},$destroy:function(){if(!this.$$destroyed){var e=this.$parent;for(var t in this.$broadcast("$destroy"),this.$$destroyed=!0,this===p&&s.$$applicationDestroyed(),y(this,-this.$$watchersCount),this.$$listenerCount)w(this,this.$$listenerCount[t],t);e&&e.$$childHead===this&&(e.$$childHead=this.$$nextSibling),e&&e.$$childTail===this&&(e.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$destroy=this.$digest=this.$apply=this.$evalAsync=this.$applyAsync=L,this.$on=this.$watch=this.$watchGroup=function(){return L},this.$$listeners={},this.$$nextSibling=null,c(this)}},$eval:function(e,t){return a(e)(this,t)},$evalAsync:function(e,t){p.$$phase||m.length||s.defer((function(){m.length&&p.$digest()}),null,"$evalAsync"),m.push({scope:this,fn:a(e),locals:t})},$$postDigest:function(e){f.push(e)},$apply:function(e){try{v("$apply");try{return this.$eval(e)}finally{b()}}catch(e){r(e)}finally{try{p.$digest()}catch(e){throw r(e),e}}},$applyAsync:function(e){var t=this;e&&h.push((function(){t.$eval(e)})),e=a(e),null===o&&(o=s.defer((function(){p.$apply(_)}),null,"$applyAsync"))},$on:function(e,t){var n=this.$$listeners[e];n||(this.$$listeners[e]=n=[]),n.push(t);var o=this;do{o.$$listenerCount[e]||(o.$$listenerCount[e]=0),o.$$listenerCount[e]++}while(o=o.$parent);var r=this;return function(){var o=n.indexOf(t);-1!==o&&(delete n[o],w(r,1,e))}},$emit:function(e,t){var n,o,i,a=[],s=this,l=!1,c={name:e,targetScope:s,stopPropagation:function(){l=!0},preventDefault:function(){c.defaultPrevented=!0},defaultPrevented:!1},u=de([c],arguments,1);do{for(n=s.$$listeners[e]||a,c.currentScope=s,o=0,i=n.length;o<i;o++)if(n[o])try{n[o].apply(null,u)}catch(e){r(e)}else n.splice(o,1),o--,i--;if(l)break;s=s.$parent}while(s);return c.currentScope=null,c},$broadcast:function(e,t){var n=this,o=n,i=n,a={name:e,targetScope:n,preventDefault:function(){a.defaultPrevented=!0},defaultPrevented:!1};if(!n.$$listenerCount[e])return a;for(var s,l,c,u=de([a],arguments,1);o=i;){for(a.currentScope=o,l=0,c=(s=o.$$listeners[e]||[]).length;l<c;l++)if(s[l])try{s[l].apply(null,u)}catch(e){r(e)}else s.splice(l,1),l--,c--;if(!(i=o.$$listenerCount[e]&&o.$$childHead||o!==n&&o.$$nextSibling))for(;o!==n&&!(i=o.$$nextSibling);)o=o.$parent}return a.currentScope=null,a}};var p=new u,m=p.$$asyncQueue=[],f=p.$$postDigestQueue=[],h=p.$$applyAsyncQueue=[],g=0;return p;function v(e){if(p.$$phase)throw t("inprog","{0} already in progress",p.$$phase);p.$$phase=e}function b(){p.$$phase=null}function y(e,t){do{e.$$watchersCount+=t}while(e=e.$parent)}function w(e,t,n){do{e.$$listenerCount[n]-=t,0===e.$$listenerCount[n]&&delete e.$$listenerCount[n]}while(e=e.$parent)}function $(){}function _(){for(;h.length;)try{h.shift()()}catch(e){r(e)}o=null}}]}function Ko(){var e=/^\s*(https?|s?ftp|mailto|tel|file):/,t=/^\s*((https?|ftp|file|blob):|data:image\/)/;this.aHrefSanitizationTrustedUrlList=function(t){return U(t)?(e=t,this):e},this.imgSrcSanitizationTrustedUrlList=function(e){return U(e)?(t=e,this):t},this.$get=function(){return function(n,o){var r=o?t:e,i=fr(n&&n.trim()).href;return""===i||i.match(r)?n:"unsafe:"+i}}}Oo.prototype={compile:function(e){var t=this;this.state={nextId:0,filters:{},fn:{vars:[],body:[],own:{}},assign:{vars:[],body:[],own:{}},inputs:[]},Ro(e,t.$filter);var n,o="";if(this.stage="assign",n=Lo(e)){this.state.computing="assign";var r=this.nextId();this.recurse(n,r),this.return_(r),o="fn.assign="+this.generateFunction("assign","s,v,l")}var i=Ao(e.body);t.stage="inputs",S(i,(function(e,n){var o="fn"+n;t.state[o]={vars:[],body:[],own:{}},t.state.computing=o;var r=t.nextId();t.recurse(e,r),t.return_(r),t.state.inputs.push({name:o,isPure:e.isPure}),e.watchId=n})),this.state.computing="fn",this.stage="main",this.recurse(e);var a='"'+this.USE+" "+this.STRICT+'";\n'+this.filterPrefix()+"var fn="+this.generateFunction("fn","s,l,a,i")+o+this.watchFns()+"return fn;",s=new Function("$filter","getStringValue","ifDefined","plus",a)(this.$filter,_o,Eo,Io);return this.state=this.stage=void 0,s},USE:"use",STRICT:"strict",watchFns:function(){var e=[],t=this.state.inputs,n=this;return S(t,(function(t){e.push("var "+t.name+"="+n.generateFunction(t.name,"s")),t.isPure&&e.push(t.name,".isPure="+JSON.stringify(t.isPure)+";")})),t.length&&e.push("fn.inputs=["+t.map((function(e){return e.name})).join(",")+"];"),e.join("")},generateFunction:function(e,t){return"function("+t+"){"+this.varsPrefix(e)+this.body(e)+"};"},filterPrefix:function(){var e=[],t=this;return S(this.state.filters,(function(n,o){e.push(n+"=$filter("+t.escape(o)+")")})),e.length?"var "+e.join(",")+";":""},varsPrefix:function(e){return this.state[e].vars.length?"var "+this.state[e].vars.join(",")+";":""},body:function(e){return this.state[e].body.join("")},recurse:function(e,t,n,o,r,i){var a,s,l,c,u,d=this;if(o=o||L,!i&&U(e.watchId))return t=t||this.nextId(),void this.if_("i",this.lazyAssign(t,this.computedMember("i",e.watchId)),this.lazyRecurse(e,t,n,o,r,!0));switch(e.type){case Co.Program:S(e.body,(function(t,n){d.recurse(t.expression,void 0,void 0,(function(e){s=e})),n!==e.body.length-1?d.current().body.push(s,";"):d.return_(s)}));break;case Co.Literal:c=this.escape(e.value),this.assign(t,c),o(t||c);break;case Co.UnaryExpression:this.recurse(e.argument,void 0,void 0,(function(e){s=e})),c=e.operator+"("+this.ifDefined(s,0)+")",this.assign(t,c),o(c);break;case Co.BinaryExpression:this.recurse(e.left,void 0,void 0,(function(e){a=e})),this.recurse(e.right,void 0,void 0,(function(e){s=e})),c="+"===e.operator?this.plus(a,s):"-"===e.operator?this.ifDefined(a,0)+e.operator+this.ifDefined(s,0):"("+a+")"+e.operator+"("+s+")",this.assign(t,c),o(c);break;case Co.LogicalExpression:t=t||this.nextId(),d.recurse(e.left,t),d.if_("&&"===e.operator?t:d.not(t),d.lazyRecurse(e.right,t)),o(t);break;case Co.ConditionalExpression:t=t||this.nextId(),d.recurse(e.test,t),d.if_(t,d.lazyRecurse(e.alternate,t),d.lazyRecurse(e.consequent,t)),o(t);break;case Co.Identifier:t=t||this.nextId(),n&&(n.context="inputs"===d.stage?"s":this.assign(this.nextId(),this.getHasOwnProperty("l",e.name)+"?l:s"),n.computed=!1,n.name=e.name),d.if_("inputs"===d.stage||d.not(d.getHasOwnProperty("l",e.name)),(function(){d.if_("inputs"===d.stage||"s",(function(){r&&1!==r&&d.if_(d.isNull(d.nonComputedMember("s",e.name)),d.lazyAssign(d.nonComputedMember("s",e.name),"{}")),d.assign(t,d.nonComputedMember("s",e.name))}))}),t&&d.lazyAssign(t,d.nonComputedMember("l",e.name))),o(t);break;case Co.MemberExpression:a=n&&(n.context=this.nextId())||this.nextId(),t=t||this.nextId(),d.recurse(e.object,a,void 0,(function(){d.if_(d.notNull(a),(function(){e.computed?(s=d.nextId(),d.recurse(e.property,s),d.getStringValue(s),r&&1!==r&&d.if_(d.not(d.computedMember(a,s)),d.lazyAssign(d.computedMember(a,s),"{}")),c=d.computedMember(a,s),d.assign(t,c),n&&(n.computed=!0,n.name=s)):(r&&1!==r&&d.if_(d.isNull(d.nonComputedMember(a,e.property.name)),d.lazyAssign(d.nonComputedMember(a,e.property.name),"{}")),c=d.nonComputedMember(a,e.property.name),d.assign(t,c),n&&(n.computed=!1,n.name=e.property.name))}),(function(){d.assign(t,"undefined")})),o(t)}),!!r);break;case Co.CallExpression:t=t||this.nextId(),e.filter?(s=d.filter(e.callee.name),l=[],S(e.arguments,(function(e){var t=d.nextId();d.recurse(e,t),l.push(t)})),c=s+"("+l.join(",")+")",d.assign(t,c),o(t)):(s=d.nextId(),a={},l=[],d.recurse(e.callee,s,a,(function(){d.if_(d.notNull(s),(function(){S(e.arguments,(function(t){d.recurse(t,e.constant?void 0:d.nextId(),void 0,(function(e){l.push(e)}))})),c=a.name?d.member(a.context,a.name,a.computed)+"("+l.join(",")+")":s+"("+l.join(",")+")",d.assign(t,c)}),(function(){d.assign(t,"undefined")})),o(t)})));break;case Co.AssignmentExpression:s=this.nextId(),a={},this.recurse(e.left,void 0,a,(function(){d.if_(d.notNull(a.context),(function(){d.recurse(e.right,s),c=d.member(a.context,a.name,a.computed)+e.operator+s,d.assign(t,c),o(t||c)}))}),1);break;case Co.ArrayExpression:l=[],S(e.elements,(function(t){d.recurse(t,e.constant?void 0:d.nextId(),void 0,(function(e){l.push(e)}))})),c="["+l.join(",")+"]",this.assign(t,c),o(t||c);break;case Co.ObjectExpression:l=[],u=!1,S(e.properties,(function(e){e.computed&&(u=!0)})),u?(t=t||this.nextId(),this.assign(t,"{}"),S(e.properties,(function(e){e.computed?(a=d.nextId(),d.recurse(e.key,a)):a=e.key.type===Co.Identifier?e.key.name:""+e.key.value,s=d.nextId(),d.recurse(e.value,s),d.assign(d.member(t,a,e.computed),s)}))):(S(e.properties,(function(t){d.recurse(t.value,e.constant?void 0:d.nextId(),void 0,(function(e){l.push(d.escape(t.key.type===Co.Identifier?t.key.name:""+t.key.value)+":"+e)}))})),c="{"+l.join(",")+"}",this.assign(t,c)),o(t||c);break;case Co.ThisExpression:this.assign(t,"s"),o(t||"s");break;case Co.LocalsExpression:this.assign(t,"l"),o(t||"l");break;case Co.NGValueParameter:this.assign(t,"v"),o(t||"v")}},getHasOwnProperty:function(e,t){var n=e+"."+t,o=this.current().own;return o.hasOwnProperty(n)||(o[n]=this.nextId(!1,e+"&&("+this.escape(t)+" in "+e+")")),o[n]},assign:function(e,t){if(e)return this.current().body.push(e,"=",t,";"),e},filter:function(e){return this.state.filters.hasOwnProperty(e)||(this.state.filters[e]=this.nextId(!0)),this.state.filters[e]},ifDefined:function(e,t){return"ifDefined("+e+","+this.escape(t)+")"},plus:function(e,t){return"plus("+e+","+t+")"},return_:function(e){this.current().body.push("return ",e,";")},if_:function(e,t,n){if(!0===e)t();else{var o=this.current().body;o.push("if(",e,"){"),t(),o.push("}"),n&&(o.push("else{"),n(),o.push("}"))}},not:function(e){return"!("+e+")"},isNull:function(e){return e+"==null"},notNull:function(e){return e+"!=null"},nonComputedMember:function(e,t){return/^[$_a-zA-Z][$_a-zA-Z0-9]*$/.test(t)?e+"."+t:e+'["'+t.replace(/[^$_a-zA-Z0-9]/g,this.stringEscapeFn)+'"]'},computedMember:function(e,t){return e+"["+t+"]"},member:function(e,t,n){return n?this.computedMember(e,t):this.nonComputedMember(e,t)},getStringValue:function(e){this.assign(e,"getStringValue("+e+")")},lazyRecurse:function(e,t,n,o,r,i){var a=this;return function(){a.recurse(e,t,n,o,r,i)}},lazyAssign:function(e,t){var n=this;return function(){n.assign(e,t)}},stringEscapeRegex:/[^ a-zA-Z0-9]/g,stringEscapeFn:function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)},escape:function(e){if(W(e))return"'"+e.replace(this.stringEscapeRegex,this.stringEscapeFn)+"'";if(V(e))return e.toString();if(!0===e)return"true";if(!1===e)return"false";if(null===e)return"null";if(void 0===e)return"undefined";throw ko("esc","IMPOSSIBLE")},nextId:function(e,t){var n="v"+this.state.nextId++;return e||this.current().vars.push(n+(t?"="+t:"")),n},current:function(){return this.state[this.state.computing]}},jo.prototype={compile:function(e){var t,n,o=this;Ro(e,o.$filter),(t=Lo(e))&&(n=this.recurse(t));var r,i=Ao(e.body);i&&(r=[],S(i,(function(e,t){var n=o.recurse(e);n.isPure=e.isPure,e.input=n,r.push(n),e.watchId=t})));var a=[];S(e.body,(function(e){a.push(o.recurse(e.expression))}));var s=0===e.body.length?L:1===e.body.length?a[0]:function(e,t){var n;return S(a,(function(o){n=o(e,t)})),n};return n&&(s.assign=function(e,t,o){return n(e,o,t)}),r&&(s.inputs=r),s},recurse:function(e,t,n){var o,r,i,a=this;if(e.input)return this.inputs(e.input,e.watchId);switch(e.type){case Co.Literal:return this.value(e.value,t);case Co.UnaryExpression:return r=this.recurse(e.argument),this["unary"+e.operator](r,t);case Co.BinaryExpression:case Co.LogicalExpression:return o=this.recurse(e.left),r=this.recurse(e.right),this["binary"+e.operator](o,r,t);case Co.ConditionalExpression:return this["ternary?:"](this.recurse(e.test),this.recurse(e.alternate),this.recurse(e.consequent),t);case Co.Identifier:return a.identifier(e.name,t,n);case Co.MemberExpression:return o=this.recurse(e.object,!1,!!n),e.computed||(r=e.property.name),e.computed&&(r=this.recurse(e.property)),e.computed?this.computedMember(o,r,t,n):this.nonComputedMember(o,r,t,n);case Co.CallExpression:return i=[],S(e.arguments,(function(e){i.push(a.recurse(e))})),e.filter&&(r=this.$filter(e.callee.name)),e.filter||(r=this.recurse(e.callee,!0)),e.filter?function(e,n,o,a){for(var s=[],l=0;l<i.length;++l)s.push(i[l](e,n,o,a));var c=r.apply(void 0,s,a);return t?{context:void 0,name:void 0,value:c}:c}:function(e,n,o,a){var s,l=r(e,n,o,a);if(null!=l.value){for(var c=[],u=0;u<i.length;++u)c.push(i[u](e,n,o,a));s=l.value.apply(l.context,c)}return t?{value:s}:s};case Co.AssignmentExpression:return o=this.recurse(e.left,!0,1),r=this.recurse(e.right),function(e,n,i,a){var s=o(e,n,i,a),l=r(e,n,i,a);return s.context[s.name]=l,t?{value:l}:l};case Co.ArrayExpression:return i=[],S(e.elements,(function(e){i.push(a.recurse(e))})),function(e,n,o,r){for(var a=[],s=0;s<i.length;++s)a.push(i[s](e,n,o,r));return t?{value:a}:a};case Co.ObjectExpression:return i=[],S(e.properties,(function(e){e.computed?i.push({key:a.recurse(e.key),computed:!0,value:a.recurse(e.value)}):i.push({key:e.key.type===Co.Identifier?e.key.name:""+e.key.value,computed:!1,value:a.recurse(e.value)})})),function(e,n,o,r){for(var a={},s=0;s<i.length;++s)i[s].computed?a[i[s].key(e,n,o,r)]=i[s].value(e,n,o,r):a[i[s].key]=i[s].value(e,n,o,r);return t?{value:a}:a};case Co.ThisExpression:return function(e){return t?{value:e}:e};case Co.LocalsExpression:return function(e,n){return t?{value:n}:n};case Co.NGValueParameter:return function(e,n,o){return t?{value:o}:o}}},"unary+":function(e,t){return function(n,o,r,i){var a=e(n,o,r,i);return a=U(a)?+a:0,t?{value:a}:a}},"unary-":function(e,t){return function(n,o,r,i){var a=e(n,o,r,i);return a=U(a)?-a:-0,t?{value:a}:a}},"unary!":function(e,t){return function(n,o,r,i){var a=!e(n,o,r,i);return t?{value:a}:a}},"binary+":function(e,t,n){return function(o,r,i,a){var s=Io(e(o,r,i,a),t(o,r,i,a));return n?{value:s}:s}},"binary-":function(e,t,n){return function(o,r,i,a){var s=e(o,r,i,a),l=t(o,r,i,a),c=(U(s)?s:0)-(U(l)?l:0);return n?{value:c}:c}},"binary*":function(e,t,n){return function(o,r,i,a){var s=e(o,r,i,a)*t(o,r,i,a);return n?{value:s}:s}},"binary/":function(e,t,n){return function(o,r,i,a){var s=e(o,r,i,a)/t(o,r,i,a);return n?{value:s}:s}},"binary%":function(e,t,n){return function(o,r,i,a){var s=e(o,r,i,a)%t(o,r,i,a);return n?{value:s}:s}},"binary===":function(e,t,n){return function(o,r,i,a){var s=e(o,r,i,a)===t(o,r,i,a);return n?{value:s}:s}},"binary!==":function(e,t,n){return function(o,r,i,a){var s=e(o,r,i,a)!==t(o,r,i,a);return n?{value:s}:s}},"binary==":function(e,t,n){return function(o,r,i,a){var s=e(o,r,i,a)==t(o,r,i,a);return n?{value:s}:s}},"binary!=":function(e,t,n){return function(o,r,i,a){var s=e(o,r,i,a)!=t(o,r,i,a);return n?{value:s}:s}},"binary<":function(e,t,n){return function(o,r,i,a){var s=e(o,r,i,a)<t(o,r,i,a);return n?{value:s}:s}},"binary>":function(e,t,n){return function(o,r,i,a){var s=e(o,r,i,a)>t(o,r,i,a);return n?{value:s}:s}},"binary<=":function(e,t,n){return function(o,r,i,a){var s=e(o,r,i,a)<=t(o,r,i,a);return n?{value:s}:s}},"binary>=":function(e,t,n){return function(o,r,i,a){var s=e(o,r,i,a)>=t(o,r,i,a);return n?{value:s}:s}},"binary&&":function(e,t,n){return function(o,r,i,a){var s=e(o,r,i,a)&&t(o,r,i,a);return n?{value:s}:s}},"binary||":function(e,t,n){return function(o,r,i,a){var s=e(o,r,i,a)||t(o,r,i,a);return n?{value:s}:s}},"ternary?:":function(e,t,n,o){return function(r,i,a,s){var l=e(r,i,a,s)?t(r,i,a,s):n(r,i,a,s);return o?{value:l}:l}},value:function(e,t){return function(){return t?{context:void 0,name:void 0,value:e}:e}},identifier:function(e,t,n){return function(o,r,i,a){var s=r&&e in r?r:o;n&&1!==n&&s&&null==s[e]&&(s[e]={});var l=s?s[e]:void 0;return t?{context:s,name:e,value:l}:l}},computedMember:function(e,t,n,o){return function(r,i,a,s){var l,c,u=e(r,i,a,s);return null!=u&&(l=_o(l=t(r,i,a,s)),o&&1!==o&&u&&!u[l]&&(u[l]={}),c=u[l]),n?{context:u,name:l,value:c}:c}},nonComputedMember:function(e,t,n,o){return function(r,i,a,s){var l=e(r,i,a,s);o&&1!==o&&l&&null==l[t]&&(l[t]={});var c=null!=l?l[t]:void 0;return n?{context:l,name:t,value:c}:c}},inputs:function(e,t){return function(n,o,r,i){return i?i[t]:e(n,o,r)}}},Do.prototype={constructor:Do,parse:function(e){var t=this.getAst(e),n=this.astCompiler.compile(t.ast);return n.literal=function(e){return 0===e.body.length||1===e.body.length&&(e.body[0].expression.type===Co.Literal||e.body[0].expression.type===Co.ArrayExpression||e.body[0].expression.type===Co.ObjectExpression)}(t.ast),n.constant=function(e){return e.constant}(t.ast),n.oneTime=t.oneTime,n},getAst:function(e){var t=!1;return":"===(e=e.trim()).charAt(0)&&":"===e.charAt(1)&&(t=!0,e=e.substring(2)),{ast:this.ast.ast(e),oneTime:t}}};var Yo=r("$sce"),Jo={HTML:"html",CSS:"css",MEDIA_URL:"mediaUrl",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},Xo=/_([a-z])/g;function Zo(e){return e.replace(Xo,tt)}function Qo(e){var t=[];return U(e)&&S(e,(function(e){t.push(function(e){if("self"===e)return e;if(W(e)){if(e.indexOf("***")>-1)throw Yo("iwcard","Illegal sequence *** in string matcher.  String: {0}",e);return e=te(e).replace(/\\\*\\\*/g,".*").replace(/\\\*/g,"[^:/.?&;]*"),new RegExp("^"+e+"$")}if(K(e))return new RegExp("^"+e.source+"$");throw Yo("imatcher",'Matchers may only be "self", string patterns or RegExp objects')}(e))})),t}function er(){this.SCE_CONTEXTS=Jo;var t=["self"],n=[];this.trustedResourceUrlList=function(e){return arguments.length&&(t=Qo(e)),t},Object.defineProperty(this,"resourceUrlWhitelist",{get:function(){return this.trustedResourceUrlList},set:function(e){this.trustedResourceUrlList=e}}),this.bannedResourceUrlList=function(e){return arguments.length&&(n=Qo(e)),n},Object.defineProperty(this,"resourceUrlBlacklist",{get:function(){return this.bannedResourceUrlList},set:function(e){this.bannedResourceUrlList=e}}),this.$get=["$injector","$$sanitizeUri",function(o,r){var i=function(e){throw Yo("unsafe","Attempting to use an unsafe value in a safe context.")};function a(t,n){return"self"===t?hr(n,pr)||hr(n,e.document.baseURI?e.document.baseURI:(ur||((ur=e.document.createElement("a")).href=".",ur=ur.cloneNode(!1)),ur.href)):!!t.exec(n.href)}function s(e){var t=function(e){this.$$unwrapTrustedValue=function(){return e}};return e&&(t.prototype=new e),t.prototype.valueOf=function(){return this.$$unwrapTrustedValue()},t.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()},t}o.has("$sanitize")&&(i=o.get("$sanitize"));var l=s(),c={};return c[Jo.HTML]=s(l),c[Jo.CSS]=s(l),c[Jo.MEDIA_URL]=s(l),c[Jo.URL]=s(c[Jo.MEDIA_URL]),c[Jo.JS]=s(l),c[Jo.RESOURCE_URL]=s(c[Jo.URL]),{trustAs:function(e,t){var n=c.hasOwnProperty(e)?c[e]:null;if(!n)throw Yo("icontext","Attempted to trust a value in invalid context. Context: {0}; Value: {1}",e,t);if(null===t||N(t)||""===t)return t;if("string"!=typeof t)throw Yo("itype","Attempted to trust a non-string value in a content requiring a string: Context: {0}",e);return new n(t)},getTrusted:function(e,o){if(null===o||N(o)||""===o)return o;var s=c.hasOwnProperty(e)?c[e]:null;if(s&&o instanceof s)return o.$$unwrapTrustedValue();if(G(o.$$unwrapTrustedValue)&&(o=o.$$unwrapTrustedValue()),e===Jo.MEDIA_URL||e===Jo.URL)return r(o.toString(),e===Jo.MEDIA_URL);if(e===Jo.RESOURCE_URL){if(function(e){var o,r,i=fr(e.toString()),s=!1;for(o=0,r=t.length;o<r;o++)if(a(t[o],i)){s=!0;break}if(s)for(o=0,r=n.length;o<r;o++)if(a(n[o],i)){s=!1;break}return s}(o))return o;throw Yo("insecurl","Blocked loading resource from url not allowed by $sceDelegate policy.  URL: {0}",o.toString())}if(e===Jo.HTML)return i(o);throw Yo("unsafe","Attempting to use an unsafe value in a safe context.")},valueOf:function(e){return e instanceof l?e.$$unwrapTrustedValue():e}}}]}function tr(){var e=!0;this.enabled=function(t){return arguments.length&&(e=!!t),e},this.$get=["$parse","$sceDelegate",function(t,n){if(e&&i<8)throw Yo("iequirks","Strict Contextual Escaping does not support Internet Explorer version < 11 in quirks mode.  You can fix this by adding the text <!doctype html> to the top of your HTML document.  See http://docs.angularjs.org/api/ng.$sce for more information.");var o=He(Jo);o.isEnabled=function(){return e},o.trustAs=n.trustAs,o.getTrusted=n.getTrusted,o.valueOf=n.valueOf,e||(o.trustAs=o.getTrusted=function(e,t){return t},o.valueOf=O),o.parseAs=function(e,n){var r=t(n);return r.literal&&r.constant?r:t(n,(function(t){return o.getTrusted(e,t)}))};var r=o.parseAs,a=o.getTrusted,s=o.trustAs;return S(Jo,(function(e,t){var n=p(t);o[Zo("parse_as_"+n)]=function(t){return r(e,t)},o[Zo("get_trusted_"+n)]=function(t){return a(e,t)},o[Zo("trust_as_"+n)]=function(t){return s(e,t)}})),o}]}function nr(){this.$get=["$window","$document",function(e,t){var n={},o=!((!e.nw||!e.nw.process)&&e.chrome&&(e.chrome.app&&e.chrome.app.runtime||!e.chrome.app&&e.chrome.runtime&&e.chrome.runtime.id))&&e.history&&e.history.pushState,r=R((/android (\d+)/.exec(p((e.navigator||{}).userAgent))||[])[1]),a=/Boxee/i.test((e.navigator||{}).userAgent),s=t[0]||{},l=s.body&&s.body.style,c=!1,u=!1;return l&&(c=!(!("transition"in l)&&!("webkitTransition"in l)),u=!(!("animation"in l)&&!("webkitAnimation"in l))),{history:!(!o||r<4||a),hasEvent:function(e){if("input"===e&&i)return!1;if(N(n[e])){var t=s.createElement("div");n[e]="on"+e in t}return n[e]},csp:ce(),transitions:c,animations:u,android:r}}]}function or(){this.$get=j((function(e){return new rr(e)}))}function rr(e){var t=this,n={},o=[],r=t.ALL_TASKS_TYPE="$$all$$",i=t.DEFAULT_TASK_TYPE="$$default$$";function a(){var e=o.pop();return e&&e.cb}function s(e){for(var t=o.length-1;t>=0;--t){var n=o[t];if(n.type===e)return o.splice(t,1),n.cb}}t.completeTask=function(t,o){o=o||i;try{t()}finally{!function(e){n[e=e||i]&&(n[e]--,n[r]--)}(o);var l=n[o],c=n[r];if(!c||!l)for(var u,d=c?s:a;u=d(o);)try{u()}catch(t){e.error(t)}}},t.incTaskCount=function(e){n[e=e||i]=(n[e]||0)+1,n[r]=(n[r]||0)+1},t.notifyWhenNoPendingTasks=function(e,t){n[t=t||r]?o.push({type:t,cb:e}):e()}}var ir=r("$templateRequest");function ar(){var e;this.httpOptions=function(t){return t?(e=t,this):e},this.$get=["$exceptionHandler","$templateCache","$http","$q","$sce",function(t,n,o,r,i){function a(s,l){a.totalPendingRequests++,W(s)&&!N(n.get(s))||(s=i.getTrustedResourceUrl(s));var c=o.defaults&&o.defaults.transformResponse;return z(c)?c=c.filter((function(e){return e!==qn})):c===qn&&(c=null),o.get(s,E({cache:n,transformResponse:c},e)).finally((function(){a.totalPendingRequests--})).then((function(e){return n.put(s,e.data)}),(function(e){return l||(e=ir("tpload","Failed to load template: {0} (HTTP status: {1} {2})",s,e.status,e.statusText),t(e)),r.reject(e)}))}return a.totalPendingRequests=0,a}]}function sr(){this.$get=["$rootScope","$browser","$location",function(e,t,n){var o={findBindings:function(e,t,n){var o=e.getElementsByClassName("ng-binding"),r=[];return S(o,(function(e){var o=w.element(e).data("$binding");o&&S(o,(function(o){n?new RegExp("(^|\\s)"+te(t)+"(\\s|\\||$)").test(o)&&r.push(e):-1!==o.indexOf(t)&&r.push(e)}))})),r},findModels:function(e,t,n){for(var o=["ng-","data-ng-","ng\\:"],r=0;r<o.length;++r){var i="["+o[r]+"model"+(n?"=":"*=")+'"'+t+'"]',a=e.querySelectorAll(i);if(a.length)return a}},getLocation:function(){return n.url()},setLocation:function(t){t!==n.url()&&(n.url(t),e.$digest())},whenStable:function(e){t.notifyWhenNoOutstandingRequests(e)}};return o}]}var lr=r("$timeout");function cr(){this.$get=["$rootScope","$browser","$q","$$q","$exceptionHandler",function(e,t,n,o,r){var i={};function a(a,s,l){G(a)||(l=s,s=a,a=L);var c,u=pe(arguments,3),d=U(l)&&!l,p=(d?o:n).defer(),m=p.promise;return c=t.defer((function(){try{p.resolve(a.apply(null,u))}catch(e){p.reject(e),r(e)}finally{delete i[m.$$timeoutId]}d||e.$apply()}),s,"$timeout"),m.$$timeoutId=c,i[c]=p,m}return a.cancel=function(e){if(!e)return!1;if(!e.hasOwnProperty("$$timeoutId"))throw lr("badprom","`$timeout.cancel()` called with a promise that was not generated by `$timeout()`.");if(!i.hasOwnProperty(e.$$timeoutId))return!1;var n=e.$$timeoutId,o=i[n];return zo(o.promise),o.reject("canceled"),delete i[n],t.defer.cancel(n)},a}]}var ur,dr=e.document.createElement("a"),pr=fr(e.location.href);dr.href="http://[::1]";var mr="[::1]"===dr.hostname;function fr(e){if(!W(e))return e;var t=e;i&&(dr.setAttribute("href",t),t=dr.href),dr.setAttribute("href",t);var n=dr.hostname;return!mr&&n.indexOf(":")>-1&&(n="["+n+"]"),{href:dr.href,protocol:dr.protocol?dr.protocol.replace(/:$/,""):"",host:dr.host,search:dr.search?dr.search.replace(/^\?/,""):"",hash:dr.hash?dr.hash.replace(/^#/,""):"",hostname:n,port:dr.port,pathname:"/"===dr.pathname.charAt(0)?dr.pathname:"/"+dr.pathname}}function hr(e,t){return e=fr(e),t=fr(t),e.protocol===t.protocol&&e.host===t.host}function gr(){this.$get=j(e)}function vr(e){var t=e[0]||{},n={},o="";function r(e){try{return decodeURIComponent(e)}catch(t){return e}}return function(){var e,i,a,s,l,c=function(e){try{return e.cookie||""}catch(e){return""}}(t);if(c!==o)for(e=(o=c).split("; "),n={},a=0;a<e.length;a++)(s=(i=e[a]).indexOf("="))>0&&(l=r(i.substring(0,s)),N(n[l])&&(n[l]=r(i.substring(s+1))));return n}}function br(){this.$get=vr}function yr(e){var t="Filter";function n(o,r){if(F(o)){var i={};return S(o,(function(e,t){i[t]=n(t,e)})),i}return e.factory(o+t,r)}this.register=n,this.$get=["$injector",function(e){return function(n){return e.get(n+t)}}],n("currency",Mr),n("date",Nr),n("filter",wr),n("json",Ur),n("limitTo",Wr),n("lowercase",Fr),n("number",Tr),n("orderBy",qr),n("uppercase",Br)}function wr(){return function(e,t,n,o){if(!k(e)){if(null==e)return e;throw r("filter")("notarray","Expected array but received: {0}",e)}var i,a;switch(o=o||"$",kr(t)){case"function":i=t;break;case"boolean":case"null":case"number":case"string":a=!0;case"object":i=function(e,t,n,o){var r=F(e)&&n in e;return!0===t?t=le:G(t)||(t=function(e,t){return!(N(e)||(null===e||null===t?e!==t:F(t)||F(e)&&!D(e)||(e=p(""+e),t=p(""+t),-1===e.indexOf(t))))}),function(i){return r&&!F(i)?$r(i,e[n],t,n,!1):$r(i,e,t,n,o)}}(t,n,o,a);break;default:return e}return Array.prototype.filter.call(e,i)}}function $r(e,t,n,o,r,i){var a=kr(e),s=kr(t);if("string"===s&&"!"===t.charAt(0))return!$r(e,t.substring(1),n,o,r);if(z(e))return e.some((function(e){return $r(e,t,n,o,r)}));switch(a){case"object":var l;if(r){for(l in e)if(l.charAt&&"$"!==l.charAt(0)&&$r(e[l],t,n,o,!0))return!0;return!i&&$r(e,t,n,o,!1)}if("object"===s){for(l in t){var c=t[l];if(!G(c)&&!N(c)){var u=l===o;if(!$r(u?e:e[l],c,n,o,u,u))return!1}}return!0}return n(e,t);case"function":return!1;default:return n(e,t)}}function kr(e){return null===e?"null":typeof e}vr.$inject=["$document"],yr.$inject=["$provide"];var Sr=22,_r=".",Pr="0";function Mr(e){var t=e.NUMBER_FORMATS;return function(e,n,o){N(n)&&(n=t.CURRENCY_SYM),N(o)&&(o=t.PATTERNS[1].maxFrac);var r=n?/\u00A4/g:/\s*\u00A4\s*/g;return null==e?e:Cr(e,t.PATTERNS[1],t.GROUP_SEP,t.DECIMAL_SEP,o).replace(r,n)}}function Tr(e){var t=e.NUMBER_FORMATS;return function(e,n){return null==e?e:Cr(e,t.PATTERNS[0],t.GROUP_SEP,t.DECIMAL_SEP,n)}}function Cr(e,t,n,o,r){if(!W(e)&&!V(e)||isNaN(e))return"";var i,a=!isFinite(e),s=!1,l=Math.abs(e)+"",c="";if(a)c="";else{i=function(e){var t,n,o,r,i,a=0;for((n=e.indexOf(_r))>-1&&(e=e.replace(_r,"")),(o=e.search(/e/i))>0?(n<0&&(n=o),n+=+e.slice(o+1),e=e.substring(0,o)):n<0&&(n=e.length),o=0;e.charAt(o)===Pr;o++);if(o===(i=e.length))t=[0],n=1;else{for(i--;e.charAt(i)===Pr;)i--;for(n-=o,t=[],r=0;o<=i;o++,r++)t[r]=+e.charAt(o)}return n>Sr&&(t=t.splice(0,Sr-1),a=n-1,n=1),{d:t,e:a,i:n}}(l),function(e,t,n,o){var r=e.d,i=r.length-e.i,a=(t=N(t)?Math.min(Math.max(n,i),o):+t)+e.i,s=r[a];if(a>0){r.splice(Math.max(e.i,a));for(var l=a;l<r.length;l++)r[l]=0}else{i=Math.max(0,i),e.i=1,r.length=Math.max(1,a=t+1),r[0]=0;for(var c=1;c<a;c++)r[c]=0}if(s>=5)if(a-1<0){for(var u=0;u>a;u--)r.unshift(0),e.i++;r.unshift(1),e.i++}else r[a-1]++;for(;i<Math.max(0,t);i++)r.push(0);var d=r.reduceRight((function(e,t,n,o){return t+=e,o[n]=t%10,Math.floor(t/10)}),0);d&&(r.unshift(d),e.i++)}(i,r,t.minFrac,t.maxFrac);var u=i.d,d=i.i,p=i.e,m=[];for(s=u.reduce((function(e,t){return e&&!t}),!0);d<0;)u.unshift(0),d++;d>0?m=u.splice(d,u.length):(m=u,u=[0]);var f=[];for(u.length>=t.lgSize&&f.unshift(u.splice(-t.lgSize,u.length).join(""));u.length>t.gSize;)f.unshift(u.splice(-t.gSize,u.length).join(""));u.length&&f.unshift(u.join("")),c=f.join(n),m.length&&(c+=o+m.join("")),p&&(c+="e+"+p)}return e<0&&!s?t.negPre+c+t.negSuf:t.posPre+c+t.posSuf}function Er(e,t,n,o){var r="";for((e<0||o&&e<=0)&&(o?e=1-e:(e=-e,r="-")),e=""+e;e.length<t;)e=Pr+e;return n&&(e=e.substr(e.length-t)),r+e}function Ir(e,t,n,o,r){return n=n||0,function(i){var a=i["get"+e]();return(n>0||a>-n)&&(a+=n),0===a&&-12===n&&(a=12),Er(a,t,o,r)}}function Rr(e,t,n){return function(o,r){var i=o["get"+e]();return r[m((n?"STANDALONE":"")+(t?"SHORT":"")+e)][i]}}function Ar(e){var t=new Date(e,0,1).getDay();return new Date(e,0,(t<=4?5:12)-t)}function xr(e){return function(t){var n,o=Ar(t.getFullYear()),r=(n=t,+new Date(n.getFullYear(),n.getMonth(),n.getDate()+(4-n.getDay()))-+o);return Er(1+Math.round(r/6048e5),e)}}function Lr(e,t){return e.getFullYear()<=0?t.ERAS[0]:t.ERAS[1]}Mr.$inject=["$locale"],Tr.$inject=["$locale"];var Or={yyyy:Ir("FullYear",4,0,!1,!0),yy:Ir("FullYear",2,0,!0,!0),y:Ir("FullYear",1,0,!1,!0),MMMM:Rr("Month"),MMM:Rr("Month",!0),MM:Ir("Month",2,1),M:Ir("Month",1,1),LLLL:Rr("Month",!1,!0),dd:Ir("Date",2),d:Ir("Date",1),HH:Ir("Hours",2),H:Ir("Hours",1),hh:Ir("Hours",2,-12),h:Ir("Hours",1,-12),mm:Ir("Minutes",2),m:Ir("Minutes",1),ss:Ir("Seconds",2),s:Ir("Seconds",1),sss:Ir("Milliseconds",3),EEEE:Rr("Day"),EEE:Rr("Day",!0),a:function(e,t){return e.getHours()<12?t.AMPMS[0]:t.AMPMS[1]},Z:function(e,t,n){var o=-1*n;return(o>=0?"+":"")+(Er(Math[o>0?"floor":"ceil"](o/60),2)+Er(Math.abs(o%60),2))},ww:xr(2),w:xr(1),G:Lr,GG:Lr,GGG:Lr,GGGG:function(e,t){return e.getFullYear()<=0?t.ERANAMES[0]:t.ERANAMES[1]}},jr=/((?:[^yMLdHhmsaZEwG']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|L+|d+|H+|h+|m+|s+|a|Z|G+|w+))([\s\S]*)/,Dr=/^-?\d+$/;function Nr(e){var t=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(n,o,r){var i,a,s="",l=[];if(o=o||"mediumDate",o=e.DATETIME_FORMATS[o]||o,W(n)&&(n=Dr.test(n)?R(n):function(e){var n;if(n=e.match(t)){var o=new Date(0),r=0,i=0,a=n[8]?o.setUTCFullYear:o.setFullYear,s=n[8]?o.setUTCHours:o.setHours;n[9]&&(r=R(n[9]+n[10]),i=R(n[9]+n[11])),a.call(o,R(n[1]),R(n[2])-1,R(n[3]));var l=R(n[4]||0)-r,c=R(n[5]||0)-i,u=R(n[6]||0),d=Math.round(1e3*parseFloat("0."+(n[7]||0)));return s.call(o,l,c,u,d),o}return e}(n)),V(n)&&(n=new Date(n)),!q(n)||!isFinite(n.getTime()))return n;for(;o;)(a=jr.exec(o))?o=(l=de(l,a,1)).pop():(l.push(o),o=null);var c=n.getTimezoneOffset();return r&&(c=be(r,c),n=we(n,r,!0)),S(l,(function(t){i=Or[t],s+=i?i(n,e.DATETIME_FORMATS,c):"''"===t?"'":t.replace(/(^'|'$)/g,"").replace(/''/g,"'")})),s}}function Ur(){return function(e,t){return N(t)&&(t=2),he(e,t)}}Nr.$inject=["$locale"];var Fr=j(p),Br=j(m);function Wr(){return function(e,t,n){return t=Math.abs(Number(t))===1/0?Number(t):R(t),A(t)?e:(V(e)&&(e=e.toString()),k(e)?(n=(n=!n||isNaN(n)?0:R(n))<0?Math.max(0,e.length+n):n,t>=0?Vr(e,n,n+t):0===n?Vr(e,t,e.length):Vr(e,Math.max(0,n+t),n)):e)}}function Vr(e,t,n){return W(e)?e.slice(t,n):f.call(e,t,n)}function qr(e){return function(o,i,a,s){if(null==o)return o;if(!k(o))throw r("orderBy")("notarray","Expected array but received: {0}",o);z(i)||(i=[i]),0===i.length&&(i=["+"]);var l=i.map((function(t){var n=1,o=O;if(G(t))o=t;else if(W(t)&&("+"!==t.charAt(0)&&"-"!==t.charAt(0)||(n="-"===t.charAt(0)?-1:1,t=t.substring(1)),""!==t&&(o=e(t)).constant)){var r=o();o=function(e){return e[r]}}return{get:o,descending:n}})),c=a?-1:1,u=G(s)?s:n,d=Array.prototype.map.call(o,(function(e,n){return{value:e,tieBreaker:{value:n,type:"number",index:n},predicateValues:l.map((function(o){return function(e,n){var o=typeof e;return null===e?o="null":"object"===o&&(e=function(e){return G(e.valueOf)&&t(e=e.valueOf())||D(e)&&t(e=e.toString()),e}(e)),{value:e,type:o,index:n}}(o.get(e),n)}))}}));return d.sort((function(e,t){for(var o=0,r=l.length;o<r;o++){var i=u(e.predicateValues[o],t.predicateValues[o]);if(i)return i*l[o].descending*c}return(u(e.tieBreaker,t.tieBreaker)||n(e.tieBreaker,t.tieBreaker))*c})),d.map((function(e){return e.value}))};function t(e){switch(typeof e){case"number":case"boolean":case"string":return!0;default:return!1}}function n(e,t){var n=0,o=e.type,r=t.type;if(o===r){var i=e.value,a=t.value;"string"===o?(i=i.toLowerCase(),a=a.toLowerCase()):"object"===o&&(F(i)&&(i=e.index),F(a)&&(a=t.index)),i!==a&&(n=i<a?-1:1)}else n="undefined"===o?1:"undefined"===r?-1:"null"===o?1:"null"===r||o<r?-1:1;return n}}function zr(e){return G(e)&&(e={link:e}),e.restrict=e.restrict||"AC",j(e)}qr.$inject=["$parse"];var Hr=j({restrict:"E",compile:function(e,t){if(!t.href&&!t.xlinkHref)return function(e,t){if("a"===t[0].nodeName.toLowerCase()){var n="[object SVGAnimatedString]"===v.call(t.prop("href"))?"xlink:href":"href";t.on("click",(function(e){t.attr(n)||e.preventDefault()}))}}}}),Gr={};S(Ot,(function(e,t){if("multiple"!==e){var n=_n("ng-"+t),o=r;"checked"===e&&(o=function(e,t,o){o.ngModel!==o[n]&&r(e,0,o)}),Gr[n]=function(){return{restrict:"A",priority:100,link:o}}}function r(e,o,r){e.$watch(r[n],(function(e){r.$set(t,!!e)}))}})),S(Dt,(function(e,t){Gr[t]=function(){return{priority:100,link:function(e,n,o){if("ngPattern"===t&&"/"===o.ngPattern.charAt(0)){var r=o.ngPattern.match(c);if(r)return void o.$set("ngPattern",new RegExp(r[1],r[2]))}e.$watch(o[t],(function(e){o.$set(t,e)}))}}}})),S(["src","srcset","href"],(function(e){var t=_n("ng-"+e);Gr[t]=["$sce",function(n){return{priority:99,link:function(o,r,a){var s=e,l=e;"href"===e&&"[object SVGAnimatedString]"===v.call(r.prop("href"))&&(l="xlinkHref",a.$attr[l]="xlink:href",s=null),a.$set(t,n.getTrustedMediaUrl(a[t])),a.$observe(t,(function(t){t?(a.$set(l,t),i&&s&&r.prop(s,a[l])):"href"===e&&a.$set(l,null)}))}}}]}));var Kr={$addControl:L,$getControls:j([]),$$renameControl:function(e,t){e.$name=t},$removeControl:L,$setValidity:L,$setDirty:L,$setPristine:L,$setSubmitted:L,$$setSubmitted:L},Yr="ng-pending",Jr="ng-submitted";function Xr(e,t,n,o,r){this.$$controls=[],this.$error={},this.$$success={},this.$pending=void 0,this.$name=r(t.name||t.ngForm||"")(n),this.$dirty=!1,this.$pristine=!0,this.$valid=!0,this.$invalid=!1,this.$submitted=!1,this.$$parentForm=Kr,this.$$element=e,this.$$animate=o,ti(this)}Xr.$inject=["$element","$attrs","$scope","$animate","$interpolate"],Xr.prototype={$rollbackViewValue:function(){S(this.$$controls,(function(e){e.$rollbackViewValue()}))},$commitViewValue:function(){S(this.$$controls,(function(e){e.$commitViewValue()}))},$addControl:function(e){De(e.$name,"input"),this.$$controls.push(e),e.$name&&(this[e.$name]=e),e.$$parentForm=this},$getControls:function(){return He(this.$$controls)},$$renameControl:function(e,t){var n=e.$name;this[n]===e&&delete this[n],this[t]=e,e.$name=t},$removeControl:function(e){e.$name&&this[e.$name]===e&&delete this[e.$name],S(this.$pending,(function(t,n){this.$setValidity(n,null,e)}),this),S(this.$error,(function(t,n){this.$setValidity(n,null,e)}),this),S(this.$$success,(function(t,n){this.$setValidity(n,null,e)}),this),ie(this.$$controls,e),e.$$parentForm=Kr},$setDirty:function(){this.$$animate.removeClass(this.$$element,Xi),this.$$animate.addClass(this.$$element,Zi),this.$dirty=!0,this.$pristine=!1,this.$$parentForm.$setDirty()},$setPristine:function(){this.$$animate.setClass(this.$$element,Xi,Zi+" "+Jr),this.$dirty=!1,this.$pristine=!0,this.$submitted=!1,S(this.$$controls,(function(e){e.$setPristine()}))},$setUntouched:function(){S(this.$$controls,(function(e){e.$setUntouched()}))},$setSubmitted:function(){for(var e=this;e.$$parentForm&&e.$$parentForm!==Kr;)e=e.$$parentForm;e.$$setSubmitted()},$$setSubmitted:function(){this.$$animate.addClass(this.$$element,Jr),this.$submitted=!0,S(this.$$controls,(function(e){e.$$setSubmitted&&e.$$setSubmitted()}))}},ni({clazz:Xr,set:function(e,t,n){var o=e[t];o?-1===o.indexOf(n)&&o.push(n):e[t]=[n]},unset:function(e,t,n){var o=e[t];o&&(ie(o,n),0===o.length&&delete e[t])}});var Zr=function(e){return["$timeout","$parse",function(t,n){return{name:"form",restrict:e?"EAC":"E",require:["form","^^?form"],controller:Xr,compile:function(n,r){n.addClass(Xi).addClass(Yi);var i=r.name?"name":!(!e||!r.ngForm)&&"ngForm";return{pre:function(e,n,r,a){var s=a[0];if(!("action"in r)){var l=function(t){e.$apply((function(){s.$commitViewValue(),s.$setSubmitted()})),t.preventDefault()};n[0].addEventListener("submit",l),n.on("$destroy",(function(){t((function(){n[0].removeEventListener("submit",l)}),0,!1)}))}(a[1]||s.$$parentForm).$addControl(s);var c=i?o(s.$name):L;i&&(c(e,s),r.$observe(i,(function(t){s.$name!==t&&(c(e,void 0),s.$$parentForm.$$renameControl(s,t),(c=o(s.$name))(e,s))}))),n.on("$destroy",(function(){s.$$parentForm.$removeControl(s),c(e,void 0),E(s,Kr)}))}}}};function o(e){return""===e?n('this[""]').assign:n(e).assign||L}}]},Qr=Zr(),ei=Zr(!0);function ti(e){e.$$classCache={},e.$$classCache[Ji]=!(e.$$classCache[Yi]=e.$$element.hasClass(Yi))}function ni(e){var t=e.clazz,n=e.set,o=e.unset;function r(e,t,n){n&&!e.$$classCache[t]?(e.$$animate.addClass(e.$$element,t),e.$$classCache[t]=!0):!n&&e.$$classCache[t]&&(e.$$animate.removeClass(e.$$element,t),e.$$classCache[t]=!1)}function i(e,t,n){t=t?"-"+Ae(t,"-"):"",r(e,Yi+t,!0===n),r(e,Ji+t,!1===n)}t.prototype.$setValidity=function(e,t,a){var s;N(t)?function(e,t,o,r){e[t]||(e[t]={}),n(e[t],o,r)}(this,"$pending",e,a):function(e,t,n,r){e[t]&&o(e[t],n,r),oi(e[t])&&(e[t]=void 0)}(this,"$pending",e,a),X(t)?t?(o(this.$error,e,a),n(this.$$success,e,a)):(n(this.$error,e,a),o(this.$$success,e,a)):(o(this.$error,e,a),o(this.$$success,e,a)),this.$pending?(r(this,Yr,!0),this.$valid=this.$invalid=void 0,i(this,"",null)):(r(this,Yr,!1),this.$valid=oi(this.$error),this.$invalid=!this.$valid,i(this,"",this.$valid)),i(this,e,s=this.$pending&&this.$pending[e]?void 0:!this.$error[e]&&(!!this.$$success[e]||null)),this.$$parentForm.$setValidity(e,s,this)}}function oi(e){if(e)for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}var ri=/^\d{4,}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+(?:[+-][0-2]\d:[0-5]\d|Z)$/,ii=/^[a-z][a-z\d.+-]*:\/*(?:[^:@]+(?::[^@]+)?@)?(?:[^\s:/?#]+|\[[a-f\d:]+])(?::\d+)?(?:\/[^?#]*)?(?:\?[^#]*)?(?:#.*)?$/i,ai=/^(?=.{1,254}$)(?=.{1,64}@)[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+(\.[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+)*@[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?(\.[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?)*$/,si=/^\s*(-|\+)?(\d+|(\d*(\.\d*)))([eE][+-]?\d+)?\s*$/,li=/^(\d{4,})-(\d{2})-(\d{2})$/,ci=/^(\d{4,})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,ui=/^(\d{4,})-W(\d\d)$/,di=/^(\d{4,})-(\d\d)$/,pi=/^(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,mi="keydown wheel mousedown",fi=Ue();S("date,datetime-local,month,time,week".split(","),(function(e){fi[e]=!0}));var hi={text:function(e,t,n,o,r,i){vi(0,t,n,o,r,i),gi(o)},date:yi("date",li,bi(li,["yyyy","MM","dd"]),"yyyy-MM-dd"),"datetime-local":yi("datetimelocal",ci,bi(ci,["yyyy","MM","dd","HH","mm","ss","sss"]),"yyyy-MM-ddTHH:mm:ss.sss"),time:yi("time",pi,bi(pi,["HH","mm","ss","sss"]),"HH:mm:ss.sss"),week:yi("week",ui,(function(e,t){if(q(e))return e;if(W(e)){ui.lastIndex=0;var n=ui.exec(e);if(n){var o=+n[1],r=+n[2],i=0,a=0,s=0,l=0,c=Ar(o),u=7*(r-1);return t&&(i=t.getHours(),a=t.getMinutes(),s=t.getSeconds(),l=t.getMilliseconds()),new Date(o,0,c.getDate()+u,i,a,s,l)}}return NaN}),"yyyy-Www"),month:yi("month",di,bi(di,["yyyy","MM"]),"yyyy-MM"),number:function(e,t,n,o,r,i,a,s){var l;if(wi(0,t,0,o,"number"),$i(o),vi(0,t,n,o,r,i),U(n.min)||n.ngMin){var c=n.min||s(n.ngMin)(e);l=ki(c),o.$validators.min=function(e,t){return o.$isEmpty(t)||N(l)||t>=l},n.$observe("min",(function(e){e!==c&&(l=ki(e),c=e,o.$validate())}))}if(U(n.max)||n.ngMax){var u=n.max||s(n.ngMax)(e),d=ki(u);o.$validators.max=function(e,t){return o.$isEmpty(t)||N(d)||t<=d},n.$observe("max",(function(e){e!==u&&(d=ki(e),u=e,o.$validate())}))}if(U(n.step)||n.ngStep){var p=n.step||s(n.ngStep)(e),m=ki(p);o.$validators.step=function(e,t){return o.$isEmpty(t)||N(m)||Pi(t,l||0,m)},n.$observe("step",(function(e){e!==p&&(m=ki(e),p=e,o.$validate())}))}},url:function(e,t,n,o,r,i){vi(0,t,n,o,r,i),gi(o),o.$validators.url=function(e,t){var n=e||t;return o.$isEmpty(n)||ii.test(n)}},email:function(e,t,n,o,r,i){vi(0,t,n,o,r,i),gi(o),o.$validators.email=function(e,t){var n=e||t;return o.$isEmpty(n)||ai.test(n)}},radio:function(e,t,n,o){var r=!n.ngTrim||"false"!==ee(n.ngTrim);N(n.name)&&t.attr("name",M()),t.on("change",(function(e){var i;t[0].checked&&(i=n.value,r&&(i=ee(i)),o.$setViewValue(i,e&&e.type))})),o.$render=function(){var e=n.value;r&&(e=ee(e)),t[0].checked=e===o.$viewValue},n.$observe("value",o.$render)},range:function(e,t,n,o,r,i){wi(0,t,0,o,"range"),$i(o),vi(0,t,n,o,r,i);var a=o.$$hasNativeValidators&&"range"===t[0].type,s=a?0:void 0,l=a?100:void 0,c=a?1:void 0,u=t[0].validity,d=U(n.min),p=U(n.max),m=U(n.step),f=o.$render;function h(e,o){t.attr(e,n[e]);var r=n[e];n.$observe(e,(function(e){e!==r&&(r=e,o(e))}))}o.$render=a&&U(u.rangeUnderflow)&&U(u.rangeOverflow)?function(){f(),o.$setViewValue(t.val())}:f,d&&(s=ki(n.min),o.$validators.min=a?function(){return!0}:function(e,t){return o.$isEmpty(t)||N(s)||t>=s},h("min",(function(e){if(s=ki(e),!A(o.$modelValue))if(a){var n=t.val();s>n&&(n=s,t.val(n)),o.$setViewValue(n)}else o.$validate()}))),p&&(l=ki(n.max),o.$validators.max=a?function(){return!0}:function(e,t){return o.$isEmpty(t)||N(l)||t<=l},h("max",(function(e){if(l=ki(e),!A(o.$modelValue))if(a){var n=t.val();l<n&&(t.val(l),n=l<s?s:l),o.$setViewValue(n)}else o.$validate()}))),m&&(c=ki(n.step),o.$validators.step=a?function(){return!u.stepMismatch}:function(e,t){return o.$isEmpty(t)||N(c)||Pi(t,s||0,c)},h("step",(function(e){c=ki(e),A(o.$modelValue)||(a?o.$viewValue!==t.val()&&o.$setViewValue(t.val()):o.$validate())})))},checkbox:function(e,t,n,o,r,i,a,s){var l=Mi(s,e,"ngTrueValue",n.ngTrueValue,!0),c=Mi(s,e,"ngFalseValue",n.ngFalseValue,!1);t.on("change",(function(e){o.$setViewValue(t[0].checked,e&&e.type)})),o.$render=function(){t[0].checked=o.$viewValue},o.$isEmpty=function(e){return!1===e},o.$formatters.push((function(e){return le(e,l)})),o.$parsers.push((function(e){return e?l:c}))},hidden:L,button:L,submit:L,reset:L,file:L};function gi(e){e.$formatters.push((function(t){return e.$isEmpty(t)?t:t.toString()}))}function vi(e,t,n,o,r,i){var a,s=p(t[0].type);if(!r.android){var l=!1;t.on("compositionstart",(function(){l=!0})),t.on("compositionupdate",(function(e){(N(e.data)||""===e.data)&&(l=!1)})),t.on("compositionend",(function(){l=!1,c()}))}var c=function(e){if(a&&(i.defer.cancel(a),a=null),!l){var r=t.val(),c=e&&e.type;"password"===s||n.ngTrim&&"false"===n.ngTrim||(r=ee(r)),(o.$viewValue!==r||""===r&&o.$$hasNativeValidators)&&o.$setViewValue(r,c)}};if(r.hasEvent("input"))t.on("input",c);else{var d=function(e,t,n){a||(a=i.defer((function(){a=null,t&&t.value===n||c(e)})))};t.on("keydown",(function(e){var t=e.keyCode;91===t||15<t&&t<19||37<=t&&t<=40||d(e,this,this.value)})),r.hasEvent("paste")&&t.on("paste cut drop",d)}t.on("change",c),fi[s]&&o.$$hasNativeValidators&&s===n.type&&t.on(mi,(function(e){if(!a){var t=this[u],n=t.badInput,o=t.typeMismatch;a=i.defer((function(){a=null,t.badInput===n&&t.typeMismatch===o||c(e)}))}})),o.$render=function(){var e=o.$isEmpty(o.$viewValue)?"":o.$viewValue;t.val()!==e&&t.val(e)}}function bi(e,t){return function(n,o){var r,i;if(q(n))return n;if(W(n)){if('"'===n.charAt(0)&&'"'===n.charAt(n.length-1)&&(n=n.substring(1,n.length-1)),ri.test(n))return new Date(n);if(e.lastIndex=0,r=e.exec(n)){r.shift(),i=o?{yyyy:o.getFullYear(),MM:o.getMonth()+1,dd:o.getDate(),HH:o.getHours(),mm:o.getMinutes(),ss:o.getSeconds(),sss:o.getMilliseconds()/1e3}:{yyyy:1970,MM:1,dd:1,HH:0,mm:0,ss:0,sss:0},S(r,(function(e,n){n<t.length&&(i[t[n]]=+e)}));var a=new Date(i.yyyy,i.MM-1,i.dd,i.HH,i.mm,i.ss||0,1e3*i.sss||0);return i.yyyy<100&&a.setFullYear(i.yyyy),a}}return NaN}}function yi(e,t,n,o){return function(r,i,a,s,l,c,u,d){wi(0,i,0,s,e),vi(0,i,a,s,l,c);var p,m,f="time"===e||"datetimelocal"===e;if(s.$parsers.push((function(n){return s.$isEmpty(n)?null:t.test(n)?$(n,p):void(s.$$parserName=e)})),s.$formatters.push((function(e){if(e&&!q(e))throw oa("datefmt","Expected `{0}` to be a date",e);if(y(e)){p=e;var t=s.$options.getOption("timezone");return t&&(m=t,p=we(p,t,!0)),function(e,t){var n=o;f&&W(s.$options.getOption("timeSecondsFormat"))&&(n=o.replace("ss.sss",s.$options.getOption("timeSecondsFormat")).replace(/:$/,""));var r=u("date")(e,n,t);return f&&s.$options.getOption("timeStripZeroSeconds")&&(r=r.replace(/(?::00)?(?:\.000)?$/,"")),r}(e,t)}return p=null,m=null,""})),U(a.min)||a.ngMin){var h=a.min||d(a.ngMin)(r),g=w(h);s.$validators.min=function(e){return!y(e)||N(g)||n(e)>=g},a.$observe("min",(function(e){e!==h&&(g=w(e),h=e,s.$validate())}))}if(U(a.max)||a.ngMax){var v=a.max||d(a.ngMax)(r),b=w(v);s.$validators.max=function(e){return!y(e)||N(b)||n(e)<=b},a.$observe("max",(function(e){e!==v&&(b=w(e),v=e,s.$validate())}))}function y(e){return e&&!(e.getTime&&e.getTime()!=e.getTime())}function w(e){return U(e)&&!q(e)?$(e)||void 0:e}function $(e,t){var o=s.$options.getOption("timezone");m&&m!==o&&(t=ye(t,be(m)));var r=n(e,t);return!isNaN(r)&&o&&(r=we(r,o)),r}}}function wi(e,t,n,o,r){var i=t[0];(o.$$hasNativeValidators=F(i.validity))&&o.$parsers.push((function(e){var n=t.prop(u)||{};if(!n.badInput&&!n.typeMismatch)return e;o.$$parserName=r}))}function $i(e){e.$parsers.push((function(t){return e.$isEmpty(t)?null:si.test(t)?parseFloat(t):void(e.$$parserName="number")})),e.$formatters.push((function(t){if(!e.$isEmpty(t)){if(!V(t))throw oa("numfmt","Expected `{0}` to be a number",t);t=t.toString()}return t}))}function ki(e){return U(e)&&!V(e)&&(e=parseFloat(e)),A(e)?void 0:e}function Si(e){return(0|e)===e}function _i(e){var t=e.toString(),n=t.indexOf(".");if(-1===n){if(-1<e&&e<1){var o=/e-(\d+)$/.exec(t);if(o)return Number(o[1])}return 0}return t.length-n-1}function Pi(e,t,n){var o=Number(e),r=!Si(o),i=!Si(t),a=!Si(n);if(r||i||a){var s=r?_i(o):0,l=i?_i(t):0,c=a?_i(n):0,u=Math.max(s,l,c),d=Math.pow(10,u);o*=d,t*=d,n*=d,r&&(o=Math.round(o)),i&&(t=Math.round(t)),a&&(n=Math.round(n))}return(o-t)%n==0}function Mi(e,t,n,o,r){var i;if(U(o)){if(!(i=e(o)).constant)throw oa("constexpr","Expected constant expression for `{0}`, but saw `{1}`.",n,o);return i(t)}return r}var Ti=["$browser","$sniffer","$filter","$parse",function(e,t,n,o){return{restrict:"E",require:["?ngModel"],link:{pre:function(r,i,a,s){s[0]&&(hi[p(a.type)]||hi.text)(r,i,a,s[0],t,e,n,o)}}}}],Ci=function(){var e={configurable:!0,enumerable:!1,get:function(){return this.getAttribute("value")||""},set:function(e){this.setAttribute("value",e)}};return{restrict:"E",priority:200,compile:function(t,n){if("hidden"===p(n.type))return{pre:function(t,n,o,r){var i=n[0];i.parentNode&&i.parentNode.insertBefore(i,i.nextSibling),Object.defineProperty&&Object.defineProperty(i,"value",e)}}}}},Ei=/^(true|false|\d+)$/,Ii=function(){function e(e,t,n){var o=U(n)?n:9===i?"":null;e.prop("value",o),t.$set("value",n)}return{restrict:"A",priority:100,compile:function(t,n){return Ei.test(n.ngValue)?function(t,n,o){e(n,o,t.$eval(o.ngValue))}:function(t,n,o){t.$watch(o.ngValue,(function(t){e(n,o,t)}))}}}},Ri=["$compile",function(e){return{restrict:"AC",compile:function(t){return e.$$addBindingClass(t),function(t,n,o){e.$$addBindingInfo(n,o.ngBind),n=n[0],t.$watch(o.ngBind,(function(e){n.textContent=Fe(e)}))}}}}],Ai=["$interpolate","$compile",function(e,t){return{compile:function(n){return t.$$addBindingClass(n),function(n,o,r){var i=e(o.attr(r.$attr.ngBindTemplate));t.$$addBindingInfo(o,i.expressions),o=o[0],r.$observe("ngBindTemplate",(function(e){o.textContent=N(e)?"":e}))}}}}],xi=["$sce","$parse","$compile",function(e,t,n){return{restrict:"A",compile:function(o,r){var i=t(r.ngBindHtml),a=t(r.ngBindHtml,(function(t){return e.valueOf(t)}));return n.$$addBindingClass(o),function(t,o,r){n.$$addBindingInfo(o,r.ngBindHtml),t.$watch(a,(function(){var n=i(t);o.html(e.getTrustedHtml(n)||"")}))}}}}],Li=j({restrict:"A",require:"ngModel",link:function(e,t,n,o){o.$viewChangeListeners.push((function(){e.$eval(n.ngChange)}))}});function Oi(e,t){var n;return e="ngClass"+e,["$parse",function(a){return{restrict:"AC",link:function(s,l,c){var u,d=l.data("$classCounts"),p=!0;function m(e,t){var n=[];return S(e,(function(e){(t>0||d[e])&&(d[e]=(d[e]||0)+t,d[e]===+(t>0)&&n.push(e))})),n.join(" ")}d||(d=Ue(),l.data("$classCounts",d)),"ngClass"!==e&&(n||(n=a("$index",(function(e){return 1&e}))),s.$watch(n,(function(e){var n;e===t?(n=m(r(n=u),1),c.$addClass(n)):function(e){e=m(r(e),-1),c.$removeClass(e)}(u),p=e}))),s.$watch(a(c[e],i),(function(e){p===t&&function(e,t){var n=r(e),i=r(t),a=o(n,i),s=o(i,n),l=m(a,-1),u=m(s,1);c.$addClass(u),c.$removeClass(l)}(u,e),u=e}))}}}];function o(e,t){if(!e||!e.length)return[];if(!t||!t.length)return e;var n=[];e:for(var o=0;o<e.length;o++){for(var r=e[o],i=0;i<t.length;i++)if(r===t[i])continue e;n.push(r)}return n}function r(e){return e&&e.split(" ")}function i(e){if(!e)return e;var t=e;return z(e)?t=e.map(i).join(" "):F(e)?t=Object.keys(e).filter((function(t){return e[t]})).join(" "):W(e)||(t=e+""),t}}var ji=Oi("",!0),Di=Oi("Odd",0),Ni=Oi("Even",1),Ui=zr({compile:function(e,t){t.$set("ngCloak",void 0),e.removeClass("ng-cloak")}}),Fi=[function(){return{restrict:"A",scope:!0,controller:"@",priority:500}}],Bi={},Wi={blur:!0,focus:!0};function Vi(e,t,n,o,r,i){return{restrict:"A",compile:function(a,s){var l=e(s[o]);return function(e,o){o.on(r,(function(o){var r=function(){l(e,{$event:o})};if(t.$$phase)if(i)e.$evalAsync(r);else try{r()}catch(e){n(e)}else e.$apply(r)}))}}}}S("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),(function(e){var t=_n("ng-"+e);Bi[t]=["$parse","$rootScope","$exceptionHandler",function(n,o,r){return Vi(n,o,r,t,e,Wi[e])}]}));var qi=["$animate","$compile",function(e,t){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(n,o,r,i,a){var s,l,c;n.$watch(r.ngIf,(function(n){n?l||a((function(n,i){l=i,n[n.length++]=t.$$createComment("end ngIf",r.ngIf),s={clone:n},e.enter(n,o.parent(),o)})):(c&&(c.remove(),c=null),l&&(l.$destroy(),l=null),s&&(c=Ne(s.clone),e.leave(c).done((function(e){!1!==e&&(c=null)})),s=null))}))}}}],zi=["$templateRequest","$anchorScroll","$animate",function(e,t,n){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:w.noop,compile:function(o,r){var i=r.ngInclude||r.src,a=r.onload||"",s=r.autoscroll;return function(o,r,l,c,u){var d,p,m,f=0,h=function(){p&&(p.remove(),p=null),d&&(d.$destroy(),d=null),m&&(n.leave(m).done((function(e){!1!==e&&(p=null)})),p=m,m=null)};o.$watch(i,(function(i){var l=function(e){!1===e||!U(s)||s&&!o.$eval(s)||t()},p=++f;i?(e(i,!0).then((function(e){if(!o.$$destroyed&&p===f){var t=o.$new();c.template=e;var s=u(t,(function(e){h(),n.enter(e,null,r).done(l)}));m=s,(d=t).$emit("$includeContentLoaded",i),o.$eval(a)}}),(function(){o.$$destroyed||p===f&&(h(),o.$emit("$includeContentError",i))})),o.$emit("$includeContentRequested",i)):(h(),c.template=null)}))}}}}],Hi=["$compile",function(t){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(n,o,r,i){if(v.call(o[0]).match(/SVG/))return o.empty(),void t(ft(i.template,e.document).childNodes)(n,(function(e){o.append(e)}),{futureParentElement:o});o.html(i.template),t(o.contents())(n)}}}],Gi=zr({priority:450,compile:function(){return{pre:function(e,t,n){e.$eval(n.ngInit)}}}}),Ki=function(){return{restrict:"A",priority:100,require:"ngModel",link:function(e,t,n,o){var r=n.ngList||", ",i="false"!==n.ngTrim,a=i?ee(r):r;o.$parsers.push((function(e){if(!N(e)){var t=[];return e&&S(e.split(a),(function(e){e&&t.push(i?ee(e):e)})),t}})),o.$formatters.push((function(e){if(z(e))return e.join(r)})),o.$isEmpty=function(e){return!e||!e.length}}}},Yi="ng-valid",Ji="ng-invalid",Xi="ng-pristine",Zi="ng-dirty",Qi="ng-untouched",ea="ng-touched",ta="ng-empty",na="ng-not-empty",oa=r("ngModel");function ra(e,t,n,o,r,i,a,s,l){var c;this.$viewValue=Number.NaN,this.$modelValue=Number.NaN,this.$$rawModelValue=void 0,this.$validators={},this.$asyncValidators={},this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$untouched=!0,this.$touched=!1,this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$error={},this.$$success={},this.$pending=void 0,this.$name=l(n.name||"",!1)(e),this.$$parentForm=Kr,this.$options=ia,this.$$updateEvents="",this.$$updateEventHandler=this.$$updateEventHandler.bind(this),this.$$parsedNgModel=r(n.ngModel),this.$$parsedNgModelAssign=this.$$parsedNgModel.assign,this.$$ngModelGet=this.$$parsedNgModel,this.$$ngModelSet=this.$$parsedNgModelAssign,this.$$pendingDebounce=null,this.$$parserValid=void 0,this.$$parserName="parse",this.$$currentValidationRunId=0,this.$$scope=e,this.$$rootScope=e.$root,this.$$attr=n,this.$$element=o,this.$$animate=i,this.$$timeout=a,this.$$parse=r,this.$$q=s,this.$$exceptionHandler=t,ti(this),(c=this).$$scope.$watch((function(e){var t=c.$$ngModelGet(e);return t===c.$modelValue||c.$modelValue!=c.$modelValue&&t!=t||c.$$setModelValue(t),t}))}ra.$inject=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate","$timeout","$q","$interpolate"],ra.prototype={$$initGetterSetters:function(){if(this.$options.getOption("getterSetter")){var e=this.$$parse(this.$$attr.ngModel+"()"),t=this.$$parse(this.$$attr.ngModel+"($$$p)");this.$$ngModelGet=function(t){var n=this.$$parsedNgModel(t);return G(n)&&(n=e(t)),n},this.$$ngModelSet=function(e,n){G(this.$$parsedNgModel(e))?t(e,{$$$p:n}):this.$$parsedNgModelAssign(e,n)}}else if(!this.$$parsedNgModel.assign)throw oa("nonassign","Expression '{0}' is non-assignable. Element: {1}",this.$$attr.ngModel,$e(this.$$element))},$render:L,$isEmpty:function(e){return N(e)||""===e||null===e||e!=e},$$updateEmptyClasses:function(e){this.$isEmpty(e)?(this.$$animate.removeClass(this.$$element,na),this.$$animate.addClass(this.$$element,ta)):(this.$$animate.removeClass(this.$$element,ta),this.$$animate.addClass(this.$$element,na))},$setPristine:function(){this.$dirty=!1,this.$pristine=!0,this.$$animate.removeClass(this.$$element,Zi),this.$$animate.addClass(this.$$element,Xi)},$setDirty:function(){this.$dirty=!0,this.$pristine=!1,this.$$animate.removeClass(this.$$element,Xi),this.$$animate.addClass(this.$$element,Zi),this.$$parentForm.$setDirty()},$setUntouched:function(){this.$touched=!1,this.$untouched=!0,this.$$animate.setClass(this.$$element,Qi,ea)},$setTouched:function(){this.$touched=!0,this.$untouched=!1,this.$$animate.setClass(this.$$element,ea,Qi)},$rollbackViewValue:function(){this.$$timeout.cancel(this.$$pendingDebounce),this.$viewValue=this.$$lastCommittedViewValue,this.$render()},$validate:function(){if(!A(this.$modelValue)){var e=this.$$lastCommittedViewValue,t=this.$$rawModelValue,n=this.$valid,o=this.$modelValue,r=this.$options.getOption("allowInvalid"),i=this;this.$$runValidators(t,e,(function(e){r||n===e||(i.$modelValue=e?t:void 0,i.$modelValue!==o&&i.$$writeModelToScope())}))}},$$runValidators:function(e,t,n){this.$$currentValidationRunId++;var o,r,i,a,s=this.$$currentValidationRunId,l=this;function c(e,t){s===l.$$currentValidationRunId&&l.$setValidity(e,t)}function u(e){s===l.$$currentValidationRunId&&n(e)}a=l.$$parserName,(N(l.$$parserValid)?(c(a,null),1):(l.$$parserValid||(S(l.$validators,(function(e,t){c(t,null)})),S(l.$asyncValidators,(function(e,t){c(t,null)}))),c(a,l.$$parserValid),l.$$parserValid))?(i=!0,S(l.$validators,(function(n,o){var r=Boolean(n(e,t));i=i&&r,c(o,r)})),!i&&(S(l.$asyncValidators,(function(e,t){c(t,null)})),1)?u(!1):(o=[],r=!0,S(l.$asyncValidators,(function(n,i){var a=n(e,t);if(!Z(a))throw oa("nopromise","Expected asynchronous validator to return a promise but got '{0}' instead.",a);c(i,void 0),o.push(a.then((function(){c(i,!0)}),(function(){r=!1,c(i,!1)})))})),o.length?l.$$q.all(o).then((function(){u(r)}),L):u(!0))):u(!1)},$commitViewValue:function(){var e=this.$viewValue;this.$$timeout.cancel(this.$$pendingDebounce),(this.$$lastCommittedViewValue!==e||""===e&&this.$$hasNativeValidators)&&(this.$$updateEmptyClasses(e),this.$$lastCommittedViewValue=e,this.$pristine&&this.$setDirty(),this.$$parseAndValidate())},$$parseAndValidate:function(){var e=this.$$lastCommittedViewValue,t=this;if(this.$$parserValid=!N(e)||void 0,this.$setValidity(this.$$parserName,null),this.$$parserName="parse",this.$$parserValid)for(var n=0;n<this.$parsers.length;n++)if(N(e=this.$parsers[n](e))){this.$$parserValid=!1;break}A(this.$modelValue)&&(this.$modelValue=this.$$ngModelGet(this.$$scope));var o=this.$modelValue,r=this.$options.getOption("allowInvalid");function i(){t.$modelValue!==o&&t.$$writeModelToScope()}this.$$rawModelValue=e,r&&(this.$modelValue=e,i()),this.$$runValidators(e,this.$$lastCommittedViewValue,(function(n){r||(t.$modelValue=n?e:void 0,i())}))},$$writeModelToScope:function(){this.$$ngModelSet(this.$$scope,this.$modelValue),S(this.$viewChangeListeners,(function(e){try{e()}catch(e){this.$$exceptionHandler(e)}}),this)},$setViewValue:function(e,t){this.$viewValue=e,this.$options.getOption("updateOnDefault")&&this.$$debounceViewValueCommit(t)},$$debounceViewValueCommit:function(e){var t=this.$options.getOption("debounce");V(t[e])?t=t[e]:V(t.default)&&-1===this.$options.getOption("updateOn").indexOf(e)?t=t.default:V(t["*"])&&(t=t["*"]),this.$$timeout.cancel(this.$$pendingDebounce);var n=this;t>0?this.$$pendingDebounce=this.$$timeout((function(){n.$commitViewValue()}),t):this.$$rootScope.$$phase?this.$commitViewValue():this.$$scope.$apply((function(){n.$commitViewValue()}))},$overrideModelOptions:function(e){this.$options=this.$options.createChild(e),this.$$setUpdateOnEvents()},$processModelValue:function(){var e=this.$$format();this.$viewValue!==e&&(this.$$updateEmptyClasses(e),this.$viewValue=this.$$lastCommittedViewValue=e,this.$render(),this.$$runValidators(this.$modelValue,this.$viewValue,L))},$$format:function(){for(var e=this.$formatters,t=e.length,n=this.$modelValue;t--;)n=e[t](n);return n},$$setModelValue:function(e){this.$modelValue=this.$$rawModelValue=e,this.$$parserValid=void 0,this.$processModelValue()},$$setUpdateOnEvents:function(){this.$$updateEvents&&this.$$element.off(this.$$updateEvents,this.$$updateEventHandler),this.$$updateEvents=this.$options.getOption("updateOn"),this.$$updateEvents&&this.$$element.on(this.$$updateEvents,this.$$updateEventHandler)},$$updateEventHandler:function(e){this.$$debounceViewValueCommit(e&&e.type)}},ni({clazz:ra,set:function(e,t){e[t]=!0},unset:function(e,t){delete e[t]}});var ia,aa=["$rootScope",function(e){return{restrict:"A",require:["ngModel","^?form","^?ngModelOptions"],controller:ra,priority:1,compile:function(t){return t.addClass(Xi).addClass(Qi).addClass(Yi),{pre:function(e,t,n,o){var r=o[0],i=o[1]||r.$$parentForm,a=o[2];a&&(r.$options=a.$options),r.$$initGetterSetters(),i.$addControl(r),n.$observe("name",(function(e){r.$name!==e&&r.$$parentForm.$$renameControl(r,e)})),e.$on("$destroy",(function(){r.$$parentForm.$removeControl(r)}))},post:function(t,n,o,r){var i=r[0];function a(){i.$setTouched()}i.$$setUpdateOnEvents(),n.on("blur",(function(){i.$touched||(e.$$phase?t.$evalAsync(a):t.$apply(a))}))}}}}}],sa=/(\s+|^)default(\s+|$)/;function la(e){this.$$options=e}la.prototype={getOption:function(e){return this.$$options[e]},createChild:function(e){var t=!1;return S(e=E({},e),(function(n,o){"$inherit"===n?"*"===o?t=!0:(e[o]=this.$$options[o],"updateOn"===o&&(e.updateOnDefault=this.$$options.updateOnDefault)):"updateOn"===o&&(e.updateOnDefault=!1,e[o]=ee(n.replace(sa,(function(){return e.updateOnDefault=!0," "}))))}),this),t&&(delete e["*"],ua(e,this.$$options)),ua(e,ia.$$options),new la(e)}},ia=new la({updateOn:"",updateOnDefault:!0,debounce:0,getterSetter:!1,allowInvalid:!1,timezone:null});var ca=function(){function e(e,t){this.$$attrs=e,this.$$scope=t}return e.$inject=["$attrs","$scope"],e.prototype={$onInit:function(){var e=this.parentCtrl?this.parentCtrl.$options:ia,t=this.$$scope.$eval(this.$$attrs.ngModelOptions);this.$options=e.createChild(t)}},{restrict:"A",priority:10,require:{parentCtrl:"?^^ngModelOptions"},bindToController:!0,controller:e}};function ua(e,t){S(t,(function(t,n){U(e[n])||(e[n]=t)}))}var da=zr({terminal:!0,priority:1e3}),pa=r("ngOptions"),ma=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?(?:\s+disable\s+when\s+([\s\S]+?))?\s+for\s+(?:([$\w][$\w]*)|(?:\(\s*([$\w][$\w]*)\s*,\s*([$\w][$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,fa=["$compile","$document","$parse",function(t,n,o){var r=e.document.createElement("option"),i=e.document.createElement("optgroup");return{restrict:"A",terminal:!0,require:["select","ngModel"],link:{pre:function(e,t,n,o){o[0].registerOption=L},post:function(e,s,l,c){for(var u=c[0],d=c[1],p=l.multiple,m=0,f=s.children(),h=f.length;m<h;m++)if(""===f[m].value){u.hasEmptyOption=!0,u.emptyOption=f.eq(m);break}s.empty();var g,v=!!u.emptyOption;a(r.cloneNode(!1)).val("?");var b=function(e,t,n){var r=e.match(ma);if(!r)throw pa("iexp","Expected expression in form of '_select_ (as _label_)? for (_key_,)?_value_ in _collection_' but got '{0}'. Element: {1}",e,$e(t));var i=r[5]||r[7],a=r[6],s=/ as /.test(r[0])&&r[1],l=r[9],c=o(r[2]?r[1]:i),u=s&&o(s)||c,d=l&&o(l),p=l?function(e,t){return d(n,t)}:function(e){return Wt(e)},m=function(e,t){return p(e,y(e,t))},f=o(r[2]||r[1]),h=o(r[3]||""),g=o(r[4]||""),v=o(r[8]),b={},y=a?function(e,t){return b[a]=t,b[i]=e,b}:function(e){return b[i]=e,b};function w(e,t,n,o,r){this.selectValue=e,this.viewValue=t,this.label=n,this.group=o,this.disabled=r}function $(e){var t;if(!a&&k(e))t=e;else for(var n in t=[],e)e.hasOwnProperty(n)&&"$"!==n.charAt(0)&&t.push(n);return t}return{trackBy:l,getTrackByValue:m,getWatchables:o(v,(function(e){for(var t=[],o=$(e=e||[]),i=o.length,a=0;a<i;a++){var s=e===o?a:o[a],l=e[s],c=y(l,s),u=p(l,c);if(t.push(u),r[2]||r[1]){var d=f(n,c);t.push(d)}if(r[4]){var m=g(n,c);t.push(m)}}return t})),getOptions:function(){for(var e=[],t={},o=v(n)||[],r=$(o),i=r.length,a=0;a<i;a++){var s=o===r?a:r[a],c=o[s],d=y(c,s),b=u(n,d),k=p(b,d),S=new w(k,b,f(n,d),h(n,d),g(n,d));e.push(S),t[k]=S}return{items:e,selectValueMap:t,getOptionFromViewValue:function(e){return t[m(e)]},getViewValueFromOption:function(e){return l?ae(e.viewValue):e.viewValue}}}}}(l.ngOptions,s,e),y=n[0].createDocumentFragment();function w(e,t){var n=r.cloneNode(!1);t.appendChild(n),function(e,t){e.element=t,t.disabled=e.disabled,e.label!==t.label&&(t.label=e.label,t.textContent=e.label),t.value=e.selectValue}(e,n)}function $(e){var t=g.getOptionFromViewValue(e),n=t&&t.element;return n&&!n.selected&&(n.selected=!0),t}u.generateUnknownOptionValue=function(e){return"?"},p?(u.writeValue=function(e){if(g){var t=e&&e.map($)||[];g.items.forEach((function(e){e.element.selected&&!re(t,e)&&(e.element.selected=!1)}))}},u.readValue=function(){var e=s.val()||[],t=[];return S(e,(function(e){var n=g.selectValueMap[e];n&&!n.disabled&&t.push(g.getViewValueFromOption(n))})),t},b.trackBy&&e.$watchCollection((function(){if(z(d.$viewValue))return d.$viewValue.map((function(e){return b.getTrackByValue(e)}))}),(function(){d.$render()}))):(u.writeValue=function(e){if(g){var t=s[0].options[s[0].selectedIndex],n=g.getOptionFromViewValue(e);t&&t.removeAttribute("selected"),n?(s[0].value!==n.selectValue&&(u.removeUnknownOption(),s[0].value=n.selectValue,n.element.selected=!0),n.element.setAttribute("selected","selected")):u.selectUnknownOrEmptyOption(e)}},u.readValue=function(){var e=g.selectValueMap[s.val()];return e&&!e.disabled?(u.unselectEmptyOption(),u.removeUnknownOption(),g.getViewValueFromOption(e)):null},b.trackBy&&e.$watch((function(){return b.getTrackByValue(d.$viewValue)}),(function(){d.$render()}))),v&&(t(u.emptyOption)(e),s.prepend(u.emptyOption),u.emptyOption[0].nodeType===Ve?(u.hasEmptyOption=!1,u.registerOption=function(e,t){""===t.val()&&(u.hasEmptyOption=!0,u.emptyOption=t,u.emptyOption.removeClass("ng-scope"),d.$render(),t.on("$destroy",(function(){var e=u.$isEmptyOptionSelected();u.hasEmptyOption=!1,u.emptyOption=void 0,e&&d.$render()})))}):u.emptyOption.removeClass("ng-scope")),e.$watchCollection(b.getWatchables,(function(){var e=g&&u.readValue();if(g)for(var t=g.items.length-1;t>=0;t--){var n=g.items[t];U(n.group)?At(n.element.parentNode):At(n.element)}g=b.getOptions();var o={};if(g.items.forEach((function(e){var t;U(e.group)?((t=o[e.group])||(t=i.cloneNode(!1),y.appendChild(t),t.label=null===e.group?"null":e.group,o[e.group]=t),w(e,t)):w(e,y)})),s[0].appendChild(y),d.$render(),!d.$isEmpty(e)){var r=u.readValue();(b.trackBy||p?le(e,r):e===r)||(d.$setViewValue(r),d.$render())}}))}}}}],ha=["$locale","$interpolate","$log",function(e,t,n){var o=/{}/g,r=/^when(Minus)?(.+)$/;return{link:function(i,a,s){var l,c=s.count,u=s.$attr.when&&a.attr(s.$attr.when),d=s.offset||0,m=i.$eval(u)||{},f={},h=t.startSymbol(),g=t.endSymbol(),v=h+c+"-"+d+g,b=w.noop;function y(e){a.text(e||"")}S(s,(function(e,t){var n=r.exec(t);if(n){var o=(n[1]?"-":"")+p(n[2]);m[o]=a.attr(s.$attr[t])}})),S(m,(function(e,n){f[n]=t(e.replace(o,v))})),i.$watch(c,(function(t){var o=parseFloat(t),r=A(o);if(r||o in m||(o=e.pluralCat(o-d)),!(o===l||r&&A(l))){b();var a=f[o];N(a)?(null!=t&&n.debug("ngPluralize: no rule defined for '"+o+"' in "+u),b=L,y()):b=i.$watch(a,y),l=o}}))}}}],ga=r("ngRef"),va=["$parse",function(e){return{priority:-1,restrict:"A",compile:function(t,n){var o=_n(oe(t)),r=e(n.ngRef),i=r.assign||function(){throw ga("nonassign",'Expression in ngRef="{0}" is non-assignable!',n.ngRef)};return function(e,t,a){var s;if(a.hasOwnProperty("ngRefRead")){if("$element"===a.ngRefRead)s=t;else if(!(s=t.data("$"+a.ngRefRead+"Controller")))throw ga("noctrl",'The controller for ngRefRead="{0}" could not be found on ngRef="{1}"',a.ngRefRead,n.ngRef)}else s=t.data("$"+o+"Controller");i(e,s=s||t),t.on("$destroy",(function(){r(e)===s&&i(e,null)}))}}}}],ba=["$parse","$animate","$compile",function(e,t,n){var o="$$NG_REMOVED",i=r("ngRepeat"),a=function(e,t,n,o,r,i,a){e[n]=o,r&&(e[r]=i),e.$index=t,e.$first=0===t,e.$last=t===a-1,e.$middle=!(e.$first||e.$last),e.$odd=!(e.$even=!(1&t))},s=function(e){return e.clone[0]},l=function(e){return e.clone[e.clone.length-1]},c=function(e,t,n){return Wt(n)},u=function(e,t){return t};return{restrict:"A",multiElement:!0,transclude:"element",priority:1e3,terminal:!0,$$tlb:!0,compile:function(r,p){var m=p.ngRepeat,f=n.$$createComment("end ngRepeat",m),h=m.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);if(!h)throw i("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",m);var g=h[1],v=h[2],b=h[3],y=h[4];if(!(h=g.match(/^(?:(\s*[$\w]+)|\(\s*([$\w]+)\s*,\s*([$\w]+)\s*\))$/)))throw i("iidexp","'_item_' in '_item_ in _collection_' should be an identifier or '(_key_, _value_)' expression, but got '{0}'.",g);var w,$=h[3]||h[1],_=h[2];if(b&&(!/^[$a-zA-Z_][$a-zA-Z0-9_]*$/.test(b)||/^(null|undefined|this|\$index|\$first|\$middle|\$last|\$even|\$odd|\$parent|\$root|\$id)$/.test(b)))throw i("badident","alias '{0}' is invalid --- must be a valid JS identifier which is not a reserved name.",b);if(y){var P={$id:Wt},M=e(y);w=function(e,t,n,o){return _&&(P[_]=t),P[$]=n,P.$index=o,M(e,P)}}return function(e,n,r,p,h){var g=Ue();e.$watchCollection(v,(function(r){var p,v,y,M,T,C,E,I,R,A,x,L,O=n[0],j=Ue();if(b&&(e[b]=r),k(r))R=r,I=w||c;else for(var D in I=w||u,R=[],r)d.call(r,D)&&"$"!==D.charAt(0)&&R.push(D);for(M=R.length,x=new Array(M),p=0;p<M;p++)if(T=r===R?p:R[p],C=r[T],E=I(e,T,C,p),g[E])A=g[E],delete g[E],j[E]=A,x[p]=A;else{if(j[E])throw S(x,(function(e){e&&e.scope&&(g[e.id]=e)})),i("dupes","Duplicates in a repeater are not allowed. Use 'track by' expression to specify unique keys. Repeater: {0}, Duplicate key: {1}, Duplicate value: {2}",m,E,C);x[p]={id:E,scope:void 0,clone:void 0},j[E]=!0}for(var N in P&&(P[$]=void 0),g){if(L=Ne((A=g[N]).clone),t.leave(L),L[0].parentNode)for(p=0,v=L.length;p<v;p++)L[p][o]=!0;A.scope.$destroy()}for(p=0;p<M;p++)if(T=r===R?p:R[p],C=r[T],(A=x[p]).scope){y=O;do{y=y.nextSibling}while(y&&y[o]);s(A)!==y&&t.move(Ne(A.clone),null,O),O=l(A),a(A.scope,p,$,C,_,T,M)}else h((function(e,n){A.scope=n;var o=f.cloneNode(!1);e[e.length++]=o,t.enter(e,null,O),O=o,A.clone=e,j[A.id]=A,a(A.scope,p,$,C,_,T,M)}));g=j}))}}}}],ya="ng-hide",wa="ng-hide-animate",$a=["$animate",function(e){return{restrict:"A",multiElement:!0,link:function(t,n,o){t.$watch(o.ngShow,(function(t){e[t?"removeClass":"addClass"](n,ya,{tempClasses:wa})}))}}}],ka=["$animate",function(e){return{restrict:"A",multiElement:!0,link:function(t,n,o){t.$watch(o.ngHide,(function(t){e[t?"addClass":"removeClass"](n,ya,{tempClasses:wa})}))}}}],Sa=zr((function(e,t,n){e.$watchCollection(n.ngStyle,(function(e,n){n&&e!==n&&S(n,(function(e,n){t.css(n,"")})),e&&t.css(e)}))})),_a=["$animate","$compile",function(e,t){return{require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(n,o,r,i){var a=r.ngSwitch||r.on,s=[],l=[],c=[],u=[],d=function(e,t){return function(n){!1!==n&&e.splice(t,1)}};n.$watch(a,(function(n){for(var o,r;c.length;)e.cancel(c.pop());for(o=0,r=u.length;o<r;++o){var a=Ne(l[o].clone);u[o].$destroy(),(c[o]=e.leave(a)).done(d(c,o))}l.length=0,u.length=0,(s=i.cases["!"+n]||i.cases["?"])&&S(s,(function(n){n.transclude((function(o,r){u.push(r);var i=n.element;o[o.length++]=t.$$createComment("end ngSwitchWhen");var a={clone:o};l.push(a),e.enter(o,i.parent(),i)}))}))}))}}}],Pa=zr({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(e,t,n,o,r){var i=n.ngSwitchWhen.split(n.ngSwitchWhenSeparator).sort().filter((function(e,t,n){return n[t-1]!==e}));S(i,(function(e){o.cases["!"+e]=o.cases["!"+e]||[],o.cases["!"+e].push({transclude:r,element:t})}))}}),Ma=zr({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(e,t,n,o,r){o.cases["?"]=o.cases["?"]||[],o.cases["?"].push({transclude:r,element:t})}}),Ta=r("ngTransclude"),Ca=["$compile",function(e){return{restrict:"EAC",compile:function(t){var n=e(t.contents());return t.empty(),function(e,t,o,r,i){if(!i)throw Ta("orphan","Illegal use of ngTransclude directive in the template! No parent directive that requires a transclusion found. Element: {0}",$e(t));o.ngTransclude===o.$attr.ngTransclude&&(o.ngTransclude="");var a=o.ngTransclude||o.ngTranscludeSlot;function s(){n(e,(function(e){t.append(e)}))}i((function(e,n){e.length&&function(e){for(var t=0,n=e.length;t<n;t++){var o=e[t];if(o.nodeType!==We||o.nodeValue.trim())return!0}}(e)?t.append(e):(s(),n.$destroy())}),null,a),a&&!i.isSlotFilled(a)&&s()}}}}],Ea=["$templateCache",function(e){return{restrict:"E",terminal:!0,compile:function(t,n){if("text/ng-template"===n.type){var o=n.id,r=t[0].text;e.put(o,r)}}}}],Ia={$setViewValue:L,$render:L};function Ra(e,t){e.prop("selected",t),e.attr("selected",t)}var Aa=["$element","$scope",function(t,n){var o=this,r=new zt;o.selectValueMap={},o.ngModelCtrl=Ia,o.multiple=!1,o.unknownOption=a(e.document.createElement("option")),o.hasEmptyOption=!1,o.emptyOption=void 0,o.renderUnknownOption=function(e){var n=o.generateUnknownOptionValue(e);o.unknownOption.val(n),t.prepend(o.unknownOption),Ra(o.unknownOption,!0),t.val(n)},o.updateUnknownOption=function(e){var n=o.generateUnknownOptionValue(e);o.unknownOption.val(n),Ra(o.unknownOption,!0),t.val(n)},o.generateUnknownOptionValue=function(e){return"? "+Wt(e)+" ?"},o.removeUnknownOption=function(){o.unknownOption.parent()&&o.unknownOption.remove()},o.selectEmptyOption=function(){o.emptyOption&&(t.val(""),Ra(o.emptyOption,!0))},o.unselectEmptyOption=function(){o.hasEmptyOption&&Ra(o.emptyOption,!1)},n.$on("$destroy",(function(){o.renderUnknownOption=L})),o.readValue=function(){var e=t.val(),n=e in o.selectValueMap?o.selectValueMap[e]:e;return o.hasOption(n)?n:null},o.writeValue=function(e){var n=t[0].options[t[0].selectedIndex];if(n&&Ra(a(n),!1),o.hasOption(e)){o.removeUnknownOption();var r=Wt(e);t.val(r in o.selectValueMap?r:e);var i=t[0].options[t[0].selectedIndex];Ra(a(i),!0)}else o.selectUnknownOrEmptyOption(e)},o.addOption=function(e,t){if(t[0].nodeType!==Ve){De(e,'"option value"'),""===e&&(o.hasEmptyOption=!0,o.emptyOption=t);var n=r.get(e)||0;r.set(e,n+1),s()}},o.removeOption=function(e){var t=r.get(e);t&&(1===t?(r.delete(e),""===e&&(o.hasEmptyOption=!1,o.emptyOption=void 0)):r.set(e,t-1))},o.hasOption=function(e){return!!r.get(e)},o.$hasEmptyOption=function(){return o.hasEmptyOption},o.$isUnknownOptionSelected=function(){return t[0].options[0]===o.unknownOption[0]},o.$isEmptyOptionSelected=function(){return o.hasEmptyOption&&t[0].options[t[0].selectedIndex]===o.emptyOption[0]},o.selectUnknownOrEmptyOption=function(e){null==e&&o.emptyOption?(o.removeUnknownOption(),o.selectEmptyOption()):o.unknownOption.parent().length?o.updateUnknownOption(e):o.renderUnknownOption(e)};var i=!1;function s(){i||(i=!0,n.$$postDigest((function(){i=!1,o.ngModelCtrl.$render()})))}var l=!1;function c(e){l||(l=!0,n.$$postDigest((function(){n.$$destroyed||(l=!1,o.ngModelCtrl.$setViewValue(o.readValue()),e&&o.ngModelCtrl.$render())})))}o.registerOption=function(e,t,n,r,i){var a,l;n.$attr.ngValue?n.$observe("value",(function(e){var n,r=t.prop("selected");U(l)&&(o.removeOption(a),delete o.selectValueMap[l],n=!0),l=Wt(e),a=e,o.selectValueMap[l]=e,o.addOption(e,t),t.attr("value",l),n&&r&&c()})):r?n.$observe("value",(function(e){var n;o.readValue();var r=t.prop("selected");U(a)&&(o.removeOption(a),n=!0),a=e,o.addOption(e,t),n&&r&&c()})):i?e.$watch(i,(function(e,r){n.$set("value",e);var i=t.prop("selected");r!==e&&o.removeOption(r),o.addOption(e,t),r&&i&&c()})):o.addOption(n.value,t),n.$observe("disabled",(function(e){("true"===e||e&&t.prop("selected"))&&(o.multiple?c(!0):(o.ngModelCtrl.$setViewValue(null),o.ngModelCtrl.$render()))})),t.on("$destroy",(function(){var e=o.readValue(),t=n.value;o.removeOption(t),s(),(o.multiple&&e&&-1!==e.indexOf(t)||e===t)&&c(!0)}))}}],xa=function(){return{restrict:"E",require:["select","?ngModel"],controller:Aa,priority:1,link:{pre:function(e,t,n,o){var r=o[0],i=o[1];if(i){if(r.ngModelCtrl=i,t.on("change",(function(){r.removeUnknownOption(),e.$apply((function(){i.$setViewValue(r.readValue())}))})),n.multiple){r.multiple=!0,r.readValue=function(){var e=[];return S(t.find("option"),(function(t){if(t.selected&&!t.disabled){var n=t.value;e.push(n in r.selectValueMap?r.selectValueMap[n]:n)}})),e},r.writeValue=function(e){S(t.find("option"),(function(t){var n=!!e&&(re(e,t.value)||re(e,r.selectValueMap[t.value]));n!==t.selected&&Ra(a(t),n)}))};var s,l=NaN;e.$watch((function(){l!==i.$viewValue||le(s,i.$viewValue)||(s=He(i.$viewValue),i.$render()),l=i.$viewValue})),i.$isEmpty=function(e){return!e||0===e.length}}}else r.registerOption=L},post:function(e,t,n,o){var r=o[1];if(r){var i=o[0];r.$render=function(){i.writeValue(r.$viewValue)}}}}}},La=["$interpolate",function(e){return{restrict:"E",priority:100,compile:function(t,n){var o,r;return U(n.ngValue)||(U(n.value)?o=e(n.value,!0):(r=e(t.text(),!0))||n.$set("value",t.text())),function(e,t,n){var i="$selectController",a=t.parent(),s=a.data(i)||a.parent().data(i);s&&s.registerOption(e,t,n,o,r)}}}}],Oa=["$parse",function(e){return{restrict:"A",require:"?ngModel",link:function(t,n,o,r){if(r){var i=o.hasOwnProperty("required")||e(o.ngRequired)(t);o.ngRequired||(o.required=!0),r.$validators.required=function(e,t){return!i||!r.$isEmpty(t)},o.$observe("required",(function(e){i!==e&&(i=e,r.$validate())}))}}}}],ja=["$parse",function(e){return{restrict:"A",require:"?ngModel",compile:function(t,n){var o,r;return n.ngPattern&&(o=n.ngPattern,r="/"===n.ngPattern.charAt(0)&&c.test(n.ngPattern)?function(){return n.ngPattern}:e(n.ngPattern)),function(e,t,n,i){if(i){var a=n.pattern;n.ngPattern?a=r(e):o=n.pattern;var s=Ua(a,o,t);n.$observe("pattern",(function(e){var n=s;s=Ua(e,o,t),(n&&n.toString())!==(s&&s.toString())&&i.$validate()})),i.$validators.pattern=function(e,t){return i.$isEmpty(t)||N(s)||s.test(t)}}}}}}],Da=["$parse",function(e){return{restrict:"A",require:"?ngModel",link:function(t,n,o,r){if(r){var i=o.maxlength||e(o.ngMaxlength)(t),a=Fa(i);o.$observe("maxlength",(function(e){i!==e&&(a=Fa(e),i=e,r.$validate())})),r.$validators.maxlength=function(e,t){return a<0||r.$isEmpty(t)||t.length<=a}}}}}],Na=["$parse",function(e){return{restrict:"A",require:"?ngModel",link:function(t,n,o,r){if(r){var i=o.minlength||e(o.ngMinlength)(t),a=Fa(i)||-1;o.$observe("minlength",(function(e){i!==e&&(a=Fa(e)||-1,i=e,r.$validate())})),r.$validators.minlength=function(e,t){return r.$isEmpty(t)||t.length>=a}}}}}];function Ua(e,t,n){if(e){if(W(e)&&(e=new RegExp("^"+e+"$")),!e.test)throw r("ngPattern")("noregexp","Expected {0} to be a RegExp but was {1}. Element: {2}",t,e,$e(n));return e}}function Fa(e){var t=R(e);return A(t)?-1:t}e.angular.bootstrap?e.console:(function(){var t;if(!xe){var n=ue();(s=N(n)?e.jQuery:n?e[n]:void 0)&&s.fn.on?(a=s,E(s.fn,{scope:Lt.scope,isolateScope:Lt.isolateScope,controller:Lt.controller,injector:Lt.injector,inheritedData:Lt.inheritedData})):a=gt,t=a.cleanData,a.cleanData=function(e){for(var n,o,r=0;null!=(o=e[r]);r++)(n=(a._data(o)||{}).events)&&n.$destroy&&a(o).triggerHandler("$destroy");t(e)},w.element=a,xe=!0}}(),function(t){E(t,{errorHandlingConfig:n,bootstrap:Ce,copy:ae,extend:E,merge:I,equals:le,element:a,forEach:S,injector:tn,noop:L,bind:me,toJson:he,fromJson:ge,identity:O,isUndefined:N,isDefined:U,isString:W,isFunction:G,isObject:F,isNumber:V,isElement:ne,isArray:z,version:Ke,isDate:q,callbacks:{$$counter:0},getTestability:Ie,reloadWithDebugInfo:Ee,UNSAFE_restoreLegacyJqLiteXHTMLReplacement:Le,$$minErr:r,$$csp:ce,$$encodeUriSegment:_e,$$encodeUriQuery:Pe,$$lowercase:p,$$stringify:Fe,$$uppercase:m}),l=function(e){var t=r("$injector"),n=r("ng");function o(e,t,n){return e[t]||(e[t]=n())}var i=o(e,"angular",Object);return i.$$minErr=i.$$minErr||r,o(i,"module",(function(){var e={};return function(r,i,a){var s={};return function(e){if("hasOwnProperty"===e)throw n("badname","hasOwnProperty is not a valid {0} name","module")}(r),i&&e.hasOwnProperty(r)&&(e[r]=null),o(e,r,(function(){if(!i)throw t("nomod","Module '{0}' is not available! You either misspelled the module name or forgot to load it. If registering a module ensure that you specify the dependencies as the second argument.",r);var e=[],o=[],l=[],c=d("$injector","invoke","push",o),u={_invokeQueue:e,_configBlocks:o,_runBlocks:l,info:function(e){if(U(e)){if(!F(e))throw n("aobj","Argument '{0}' must be an object","value");return s=e,this}return s},requires:i,name:r,provider:p("$provide","provider"),factory:p("$provide","factory"),service:p("$provide","service"),value:d("$provide","value"),constant:d("$provide","constant","unshift"),decorator:p("$provide","decorator",o),animation:p("$animateProvider","register"),filter:p("$filterProvider","register"),controller:p("$controllerProvider","register"),directive:p("$compileProvider","directive"),component:p("$compileProvider","component"),config:c,run:function(e){return l.push(e),this}};return a&&c(a),u;function d(t,n,o,r){return r||(r=e),function(){return r[o||"push"]([t,n,arguments]),u}}function p(t,n,o){return o||(o=e),function(e,i){return i&&G(i)&&(i.$$moduleName=r),o.push([t,n,arguments]),u}}}))}}))}(e),l("ng",["ngLocale"],["$provide",function(e){e.provider({$$sanitizeUri:Ko}),e.provider("$compile",wn).directive({a:Hr,input:Ti,textarea:Ti,form:Qr,script:Ea,select:xa,option:La,ngBind:Ri,ngBindHtml:xi,ngBindTemplate:Ai,ngClass:ji,ngClassEven:Ni,ngClassOdd:Di,ngCloak:Ui,ngController:Fi,ngForm:ei,ngHide:ka,ngIf:qi,ngInclude:zi,ngInit:Gi,ngNonBindable:da,ngPluralize:ha,ngRef:va,ngRepeat:ba,ngShow:$a,ngStyle:Sa,ngSwitch:_a,ngSwitchWhen:Pa,ngSwitchDefault:Ma,ngOptions:fa,ngTransclude:Ca,ngModel:aa,ngList:Ki,ngChange:Li,pattern:ja,ngPattern:ja,required:Oa,ngRequired:Oa,minlength:Na,ngMinlength:Na,maxlength:Da,ngMaxlength:Da,ngValue:Ii,ngModelOptions:ca}).directive({ngInclude:Hi,input:Ci}).directive(Gr).directive(Bi),e.provider({$anchorScroll:nn,$animate:un,$animateCss:mn,$$animateJs:ln,$$animateQueue:cn,$$AnimateRunner:pn,$$animateAsyncRun:dn,$browser:hn,$cacheFactory:gn,$controller:In,$document:Rn,$$isDocumentHidden:An,$exceptionHandler:xn,$filter:yr,$$forceReflow:Ln,$interpolate:Qn,$interval:to,$$intervalFactory:no,$http:Yn,$httpParamSerializer:Wn,$httpParamSerializerJQLike:Vn,$httpBackend:Xn,$xhrFactory:Jn,$jsonpCallbacks:oo,$location:wo,$log:$o,$parse:Uo,$rootScope:Go,$q:Fo,$$q:Bo,$sce:tr,$sceDelegate:er,$sniffer:nr,$$taskTrackerFactory:or,$templateCache:vn,$templateRequest:ar,$$testability:sr,$timeout:cr,$window:gr,$$rAF:Ho,$$jqLite:Bt,$$Map:Ht,$$cookieReader:br})}]).info({angularVersion:"1.8.3"})}(w),w.module("ngLocale",[],["$provide",function(e){e.value("$locale",{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ERANAMES:["Before Christ","Anno Domini"],ERAS:["BC","AD"],FIRSTDAYOFWEEK:6,MONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],SHORTDAY:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],SHORTMONTH:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],STANDALONEMONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],WEEKENDRANGE:[5,6],fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",medium:"MMM d, y h:mm:ss a",mediumDate:"MMM d, y",mediumTime:"h:mm:ss a",short:"M/d/yy h:mm a",shortDate:"M/d/yy",shortTime:"h:mm a"},NUMBER_FORMATS:{CURRENCY_SYM:"$",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""}]},id:"en-us",localeID:"en_US",pluralCat:function(e,t){var n=0|e,o=function(e,t){var n=t;void 0===n&&(n=Math.min(function(e){var t=(e+="").indexOf(".");return-1==t?0:e.length-t-1}(e),3));var o=Math.pow(10,n);return{v:n,f:(e*o|0)%o}}(e,t);return 1==n&&0==o.v?"one":"other"}})}]),a((function(){!function(t,n){var o,r,i={};if(S(Me,(function(e){var n=e+"app";!o&&t.hasAttribute&&t.hasAttribute(n)&&(o=t,r=t.getAttribute(n))})),S(Me,(function(e){var n,i=e+"app";!o&&(n=t.querySelector("["+i.replace(":","\\:")+"]"))&&(o=n,r=n.getAttribute(i))})),o){if(!Te)return void e.console.error("AngularJS: disabling automatic bootstrap. <script> protocol indicates an extension, document.location.href does not match.");i.strictDi=null!==function(e){var t,n,o=Me.length;for(n=0;n<o;++n)if(t=Me[n]+"strict-di",W(t=e.getAttribute(t)))return t;return null}(o),n(o,r?[r]:[],i)}}(e.document,Ce)})))}(window),!window.angular.$$csp().noInlineStyle&&window.angular.element(document.head).prepend(window.angular.element("<style>").text('@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\\:form{display:block;}.ng-animate-shim{visibility:hidden;}.ng-anchor{position:absolute;}')),function(e,t){var n,o,r,i,a=1,s="-add",l="-remove",c="ng-animate",u="$$ngAnimateChildren";void 0===e.ontransitionend&&void 0!==e.onwebkittransitionend?(n="WebkitTransition",o="webkitTransitionEnd transitionend"):(n="transition",o="transitionend"),void 0===e.onanimationend&&void 0!==e.onwebkitanimationend?(r="WebkitAnimation",i="webkitAnimationEnd animationend"):(r="animation",i="animationend");var d="Duration",p="Property",m="Delay",f="TimingFunction",h=r+m,g=r+d,v=n+m,b=n+d,y=t.$$minErr("ng");function w(e,t,n){if(!e)throw y("areq","Argument '{0}' is {1}",t||"?",n||"required");return e}function $(e,t){return e||t?e?t?(Y(e)&&(e=e.join(" ")),Y(t)&&(t=t.join(" ")),e+" "+t):e:t:""}function k(e,t,n){var o="";return e=Y(e)?e:e&&ee(e)&&e.length?e.split(/\s+/):[],K(e,(function(e,r){e&&e.length>0&&(o+=r>0?" ":"",o+=n?t+e:e+t)})),o}function S(e){if(e instanceof ne)switch(e.length){case 0:return e;case 1:if(e[0].nodeType===a)return e;break;default:return ne(_(e))}if(e.nodeType===a)return ne(e)}function _(e){if(!e[0])return e;for(var t=0;t<e.length;t++){var n=e[t];if(n.nodeType===a)return n}}function P(e){return function(t,n){n.addClass&&(function(e,t,n){K(t,(function(t){e.addClass(t,n)}))}(e,t,n.addClass),n.addClass=null),n.removeClass&&(function(e,t,n){K(t,(function(t){e.removeClass(t,n)}))}(e,t,n.removeClass),n.removeClass=null)}}function M(e){if(!(e=e||{}).$$prepared){var t=e.domOperation||oe;e.domOperation=function(){e.$$domOperationFired=!0,t(),t=oe},e.$$prepared=!0}return e}function T(e,t){C(e,t),E(e,t)}function C(e,t){t.from&&(e.css(t.from),t.from=null)}function E(e,t){t.to&&(e.css(t.to),t.to=null)}function I(e,t,n){var o=t.options||{},r=n.options||{},i=(o.addClass||"")+" "+(r.addClass||""),a=(o.removeClass||"")+" "+(r.removeClass||""),c=function(e,t,n){var o={};e=i(e),t=i(t),K(t,(function(e,t){o[t]=1})),n=i(n),K(n,(function(e,t){o[t]=1===o[t]?null:-1}));var r={addClass:"",removeClass:""};function i(e){ee(e)&&(e=e.split(" "));var t={};return K(e,(function(e){e.length&&(t[e]=!0)})),t}return K(o,(function(t,n){var o,i;1===t?(o="addClass",i=!e[n]||e[n+l]):-1===t&&(o="removeClass",i=e[n]||e[n+s]),i&&(r[o].length&&(r[o]+=" "),r[o]+=n)})),r}(e.attr("class"),i,a);r.preparationClasses&&(o.preparationClasses=L(r.preparationClasses,o.preparationClasses),delete r.preparationClasses);var u=o.domOperation!==oe?o.domOperation:null;return G(o,r),u&&(o.domOperation=u),c.addClass?o.addClass=c.addClass:o.addClass=null,c.removeClass?o.removeClass=c.removeClass:o.removeClass=null,t.addClass=o.addClass,t.removeClass=o.removeClass,o}function R(e){return e instanceof ne?e[0]:e}function A(e,t){var n=t?"paused":"",o=r+"PlayState";return x(e,[o,n]),[o,n]}function x(e,t){var n=t[0],o=t[1];e.style[n]=o}function L(e,t){return e?t?e+" "+t:e:t}var O=function(e,t){var n=t?"-"+t+"s":"";return x(e,[v,n]),[v,n]},j=["$interpolate",function(e){return{link:function(t,n,o){var r=o.ngAnimateChildren;function i(e){e="on"===e||"true"===e,n.data(u,e)}ee(r)&&0===r.length?n.data(u,!0):(i(e(r)(t)),o.$observe("ngAnimateChildren",i))}}}],D="$$animateCss",N=1e3,U={transitionDuration:b,transitionDelay:v,transitionProperty:n+p,animationDuration:g,animationDelay:h,animationIterationCount:r+"IterationCount"},F={transitionDuration:b,transitionDelay:v,animationDuration:g,animationDelay:h};function B(e,t){return[t?h:v,e+"s"]}function W(e,t,n){var o=Object.create(null),r=e.getComputedStyle(t)||{};return K(n,(function(e,t){var n=r[e];if(n){var i=n.charAt(0);("-"===i||"+"===i||i>=0)&&(n=function(e){var t=0,n=e.split(/\s*,\s*/);return K(n,(function(e){"s"===e.charAt(e.length-1)&&(e=e.substring(0,e.length-1)),e=parseFloat(e)||0,t=t?Math.max(e,t):e})),t}(n)),0===n&&(n=null),o[t]=n}})),o}function V(e){return 0===e||null!=e}function q(e,t){var o=n,r=e+"s";return t?o+=d:r+=" linear all",[o,r]}function z(e,t,n){K(n,(function(n){e[n]=J(e[n])?e[n]:t.style.getPropertyValue(n)}))}var H,G,K,Y,J,X,Z,Q,ee,te,ne,oe,re=["$animateProvider",function(e){this.$get=["$window","$$jqLite","$$AnimateRunner","$timeout","$$animateCache","$$forceReflow","$sniffer","$$rAFScheduler","$$animateQueue",function(e,t,a,c,u,d,m,h,v){var b=P(t),y=[];function w(e){y.push(e),h.waitUntilQuiet((function(){u.flush();for(var e=d(),t=0;t<y.length;t++)y[t](e);y.length=0}))}function $(t,n,o,r){var i=function(t,n,o,r,i){var a=u.get(o);a||"infinite"===(a=W(e,t,i)).animationIterationCount&&(a.animationIterationCount=1);var s=r||a.transitionDuration>0||a.animationDuration>0;return u.put(o,a,s),a}(t,0,o,r,U),a=i.animationDelay,s=i.transitionDelay;return i.maxDelay=a&&s?Math.max(a,s):a||s,i.maxDuration=Math.max(i.animationDuration*i.animationIterationCount,i.transitionDuration),i}return function(d,h){var y=h||{};y.$$prepared||(y=M(H(y)));var S={},_=R(d);if(!_||!_.parentNode||!v.enabled())return Ce();var P,I,L,j,U,G,J,X,Z,Q,ee=[],te=(d.attr("class"),function(e){var t={};return e&&(e.to||e.from)&&(t.to=e.to,t.from=e.from),t}(y)),ne=[];if(0===y.duration||!m.animations&&!m.transitions)return Ce();var re=y.event&&Y(y.event)?y.event.join(" "):y.event,ie=re&&y.structural,ae="",se="";ie?ae=k(re,"ng-",!0):re&&(ae=re),y.addClass&&(se+=k(y.addClass,s)),y.removeClass&&(se.length&&(se+=" "),se+=k(y.removeClass,l)),y.applyClassesEarly&&se.length&&b(d,y);var le=[ae,se].join(" ").trim(),ce=te.to&&Object.keys(te.to).length>0;if(!((y.keyframeStyle||"").length>0||ce||le))return Ce();var ue,de,pe=u.cacheKey(_,re,y.addClass,y.removeClass);if(u.containsCachedAnimationWithoutDuration(pe))return le=null,Ce();if(y.stagger>0){var me=parseFloat(y.stagger);ue={transitionDelay:me,animationDelay:me,transitionDuration:0,animationDuration:0}}else ue=function(n,o,r,i){var a,s="stagger-"+r;if(u.count(r)>0&&!(a=u.get(s))){var l=k(o,"-stagger");t.addClass(n,l),(a=W(e,n,i)).animationDuration=Math.max(a.animationDuration,0),a.transitionDuration=Math.max(a.transitionDuration,0),t.removeClass(n,l),u.put(s,a,!0)}return a||{}}(_,le,pe,F);if(y.$$skipPreparationClasses||t.addClass(d,le),y.transitionStyle){var fe=[n,y.transitionStyle];x(_,fe),ee.push(fe)}if(y.duration>=0){de=_.style[n].length>0;var he=q(y.duration,de);x(_,he),ee.push(he)}if(y.keyframeStyle){var ge=[r,y.keyframeStyle];x(_,ge),ee.push(ge)}var ve=ue?y.staggerIndex>=0?y.staggerIndex:u.count(pe):0,be=0===ve;be&&!y.skipBlocking&&O(_,9999);var ye=$(_,0,pe,!ie),we=ye.maxDelay;G=Math.max(we,0),X=ye.maxDuration;var $e={};if($e.hasTransitions=ye.transitionDuration>0,$e.hasAnimations=ye.animationDuration>0,$e.hasTransitionAll=$e.hasTransitions&&"all"===ye.transitionProperty,$e.applyTransitionDuration=ce&&($e.hasTransitions&&!$e.hasTransitionAll||$e.hasAnimations&&!$e.hasTransitions),$e.applyAnimationDuration=y.duration&&$e.hasAnimations,$e.applyTransitionDelay=V(y.delay)&&($e.applyTransitionDuration||$e.hasTransitions),$e.applyAnimationDelay=V(y.delay)&&$e.hasAnimations,$e.recalculateTimingStyles=se.length>0,($e.applyTransitionDuration||$e.applyAnimationDuration)&&(X=y.duration?parseFloat(y.duration):X,$e.applyTransitionDuration&&($e.hasTransitions=!0,ye.transitionDuration=X,de=_.style[n+p].length>0,ee.push(q(X,de))),$e.applyAnimationDuration&&($e.hasAnimations=!0,ye.animationDuration=X,ee.push([g,X+"s"]))),0===X&&!$e.recalculateTimingStyles)return Ce();var ke,Se=k(le,"-active");return null!=y.delay&&("boolean"!=typeof y.delay&&(ke=parseFloat(y.delay),G=Math.max(ke,0)),$e.applyTransitionDelay&&ee.push(B(ke)),$e.applyAnimationDelay&&ee.push(B(ke,!0))),null==y.duration&&ye.transitionDuration>0&&($e.recalculateTimingStyles=$e.recalculateTimingStyles||be),J=G*N,Z=X*N,y.skipBlocking||($e.blockTransition=ye.transitionDuration>0,$e.blockKeyframeAnimation=ye.animationDuration>0&&ue.animationDelay>0&&0===ue.animationDuration),y.from&&(y.cleanupStyles&&z(S,_,Object.keys(y.from)),C(d,y)),$e.blockTransition||$e.blockKeyframeAnimation?Te(X):y.skipBlocking||O(_,!1),{$$willAnimate:!0,end:_e,start:function(){if(!P)return j=new a(U={end:_e,cancel:Pe,resume:null,pause:null}),w(Ie),j}};function _e(){Me()}function Pe(){Me(!0)}function Me(e){if(!(P||L&&I)){P=!0,I=!1,le&&!y.$$skipPreparationClasses&&t.removeClass(d,le),Se&&t.removeClass(d,Se),A(_,!1),O(_,!1),K(ee,(function(e){_.style[e[0]]=""})),b(d,y),T(d,y),Object.keys(S).length&&K(S,(function(e,t){e?_.style.setProperty(t,e):_.style.removeProperty(t)})),y.onDone&&y.onDone(),ne&&ne.length&&d.off(ne.join(" "),Ee);var n=d.data(D);n&&(c.cancel(n[0].timer),d.removeData(D)),j&&j.complete(!e)}}function Te(e){$e.blockTransition&&O(_,e),$e.blockKeyframeAnimation&&A(_,!!e)}function Ce(){return j=new a({end:_e,cancel:Pe}),w(oe),Me(),{$$willAnimate:!1,start:function(){return j},end:_e}}function Ee(e){e.stopPropagation();var t=e.originalEvent||e;if(t.target===_){var n=t.$manualTimeStamp||Date.now(),o=parseFloat(t.elapsedTime.toFixed(3));Math.max(n-Q,0)>=J&&o>=X&&(L=!0,Me())}}function Ie(){if(!P)if(_.parentNode){var e=function(e){if(L)I&&e&&(I=!1,Me());else if(I=!e,ye.animationDuration){var t=A(_,I);I?ee.push(t):function(e,t){var n=e.indexOf(t);t>=0&&e.splice(n,1)}(ee,t)}},a=ve>0&&(ye.transitionDuration&&0===ue.transitionDuration||ye.animationDuration&&0===ue.animationDuration)&&Math.max(ue.animationDelay,ue.transitionDelay);a?c(s,Math.floor(a*ve*N),!1):s(),U.resume=function(){e(!0)},U.pause=function(){e(!1)}}else Me();function s(){if(!P){if(Te(!1),K(ee,(function(e){var t=e[0],n=e[1];_.style[t]=n})),b(d,y),t.addClass(d,Se),$e.recalculateTimingStyles){if(_.getAttribute("class"),pe=u.cacheKey(_,re,y.addClass,y.removeClass),ye=$(_,0,pe,!1),we=ye.maxDelay,G=Math.max(we,0),0===(X=ye.maxDuration))return void Me();$e.hasTransitions=ye.transitionDuration>0,$e.hasAnimations=ye.animationDuration>0}if($e.applyAnimationDelay&&(we="boolean"!=typeof y.delay&&V(y.delay)?parseFloat(y.delay):we,G=Math.max(we,0),ye.animationDelay=we,ke=B(we,!0),ee.push(ke),_.style[ke[0]]=ke[1]),J=G*N,Z=X*N,y.easing){var e,a=y.easing;$e.hasTransitions&&(e=n+f,ee.push([e,a]),_.style[e]=a),$e.hasAnimations&&(e=r+f,ee.push([e,a]),_.style[e]=a)}ye.transitionDuration&&ne.push(o),ye.animationDuration&&ne.push(i),Q=Date.now();var s=J+1.5*Z,p=Q+s,m=d.data(D)||[],h=!0;if(m.length){var g=m[0];(h=p>g.expectedEndTime)?c.cancel(g.timer):m.push(Me)}if(h){var v=c(l,s,!1);m[0]={timer:v,expectedEndTime:p},m.push(Me),d.data(D,m)}ne.length&&d.on(ne.join(" "),Ee),y.to&&(y.cleanupStyles&&z(S,_,Object.keys(y.to)),E(d,y))}}function l(){var e=d.data(D);if(e){for(var t=1;t<e.length;t++)e[t]();d.removeData(D)}}}}}]}],ie=["$$animationProvider",function(e){e.drivers.push("$$animateCssDriver");var t="ng-animate-shim",n="ng-anchor-out";this.$get=["$animateCss","$rootScope","$$AnimateRunner","$rootElement","$sniffer","$$jqLite","$document",function(e,o,r,i,a,s,l){if(!a.animations&&!a.transitions)return oe;var c,u=l[0].body,d=R(i),p=ne((c=d).parentNode&&11===c.parentNode.nodeType||u.contains(d)?d:u);return function(o){return o.from&&o.to?function(o,i,a,s){var l=h(o),c=h(i),d=[];if(K(s,(function(o){var i=function(o,i,a){var s=ne(R(i).cloneNode(!0)),l=m(v(s));i.addClass(t),a.addClass(t),s.addClass("ng-anchor"),p.append(s);var c,d=function(){var t=e(s,{addClass:n,delay:!0,from:g(i)});return t.$$willAnimate?t:null}();if(!d&&!(c=b()))return y();var h=d||c;return{start:function(){var e,t=h.start();return t.done((function(){if(t=null,!c&&(c=b()))return(t=c.start()).done((function(){t=null,y(),e.complete()})),t;y(),e.complete()})),e=new r({end:n,cancel:n});function n(){t&&t.end()}}};function g(e){var t={},n=R(e).getBoundingClientRect();return K(["width","height","top","left"],(function(e){var o=n[e];switch(e){case"top":o+=u.scrollTop;break;case"left":o+=u.scrollLeft}t[e]=Math.floor(o)+"px"})),t}function v(e){return e.attr("class")||""}function b(){var t=m(v(a)),o=f(t,l),r=f(l,t),i=e(s,{to:g(a),addClass:"ng-anchor-in "+o,removeClass:n+" "+r,delay:!0});return i.$$willAnimate?i:null}function y(){s.remove(),i.removeClass(t),a.removeClass(t)}}(0,o.out,o.in);i&&d.push(i)})),l||c||0!==d.length)return{start:function(){var e=[];l&&e.push(l.start()),c&&e.push(c.start()),K(d,(function(t){e.push(t.start())}));var t=new r({end:n,cancel:n});return r.all(e,(function(e){t.complete(e)})),t;function n(){K(e,(function(e){e.end()}))}}}}(o.from,o.to,o.classes,o.anchors):h(o)};function m(e){return e.replace(/\bng-\S+\b/g,"")}function f(e,t){return ee(e)&&(e=e.split(" ")),ee(t)&&(t=t.split(" ")),e.filter((function(e){return-1===t.indexOf(e)})).join(" ")}function h(t){var n=t.element,o=t.options||{};t.structural&&(o.event=t.event,o.structural=!0,o.applyClassesEarly=!0,"leave"===t.event&&(o.onDone=o.domOperation)),o.preparationClasses&&(o.event=L(o.event,o.preparationClasses));var r=e(n,o);return r.$$willAnimate?r:null}}]}],ae=["$animateProvider",function(e){this.$get=["$injector","$$AnimateRunner","$$jqLite",function(t,n,o){var r=P(o);return function(o,i,a,s){var l=!1;3===arguments.length&&Q(a)&&(s=a,a=null),s=M(s),a||(a=o.attr("class")||"",s.addClass&&(a+=" "+s.addClass),s.removeClass&&(a+=" "+s.removeClass));var c,u,d,p,m,f=s.addClass,h=s.removeClass,g=function(n){n=Y(n)?n:n.split(" ");for(var o=[],r={},i=0;i<n.length;i++){var a=n[i],s=e.$$registeredAnimations[a];s&&!r[a]&&(o.push(t.get(s)),r[a]=!0)}return o}(a);if(g.length&&("leave"===i?(p="leave",d="afterLeave"):(p="before"+i.charAt(0).toUpperCase()+i.substr(1),d=i),"enter"!==i&&"move"!==i&&(c=w(o,i,s,g,p)),u=w(o,i,s,g,d)),c||u)return{$$willAnimate:!0,end:function(){return m?m.end():(b(),(m=new n).complete(!0)),m},start:function(){if(m)return m;var e;m=new n;var t=[];return c&&t.push((function(t){e=c(t)})),t.length?t.push((function(e){v(),e(!0)})):v(),u&&t.push((function(t){e=u(t)})),m.setHost({end:function(){r()},cancel:function(){r(!0)}}),n.chain(t,o),m;function o(e){b(),m.complete(e)}function r(t){l||((e||oe)(t),o(t))}}};function v(){s.domOperation(),r(o,s)}function b(){l=!0,v(),T(o,s)}function y(e,t,o,r,i){var a=[];return K(r,(function(r){var s=r[i];s&&a.push((function(){var r,i,a=!1,l=function(e){a||(a=!0,(i||oe)(e),r.complete(!e))};return r=new n({end:function(){l()},cancel:function(){l(!0)}}),i=function(e,t,o,r,i){var a;switch(o){case"animate":a=[t,r.from,r.to,i];break;case"setClass":a=[t,f,h,i];break;case"addClass":a=[t,f,i];break;case"removeClass":a=[t,h,i];break;default:a=[t,i]}a.push(r);var s=e.apply(e,a);if(s)if(Z(s.start)&&(s=s.start()),s instanceof n)s.done(i);else if(Z(s))return s;return oe}(s,e,t,o,(function(e){l(!1===e)})),r}))})),a}function w(e,t,o,r,i){var a,s,l=y(e,t,o,r,i);if(0===l.length&&("beforeSetClass"===i?(a=y(e,"removeClass",o,r,"beforeRemoveClass"),s=y(e,"addClass",o,r,"beforeAddClass")):"setClass"===i&&(a=y(e,"removeClass",o,r,"removeClass"),s=y(e,"addClass",o,r,"addClass")),a&&(l=l.concat(a)),s&&(l=l.concat(s))),0!==l.length)return function(e){var t=[];return l.length&&K(l,(function(e){t.push(e())})),t.length?n.all(t,e):e(),function(e){K(t,(function(t){e?t.cancel():t.end()}))}}}}}]}],se=["$$animationProvider",function(e){e.drivers.push("$$animateJsDriver"),this.$get=["$$animateJs","$$AnimateRunner",function(e,t){return function(e){if(e.from&&e.to){var o=n(e.from),r=n(e.to);if(!o&&!r)return;return{start:function(){var e=[];o&&e.push(o.start()),r&&e.push(r.start()),t.all(e,(function(e){n.complete(e)}));var n=new t({end:i(),cancel:i()});return n;function i(){return function(){K(e,(function(e){e.end()}))}}}}}return n(e)};function n(t){var n=t.element,o=t.event,r=t.options,i=t.classes;return e(n,o,i,r)}}]}],le="data-ng-animate",ce="$ngAnimatePin",ue=["$animateProvider",function(t){var n=this.rules={skip:[],cancel:[],join:[]};function o(e){return{addClass:e.addClass,removeClass:e.removeClass,from:e.from,to:e.to}}function r(e,t){if(e&&t){var n=function(e){if(!e)return null;var t=e.split(" "),n=Object.create(null);return K(t,(function(e){n[e]=!0})),n}(t);return e.split(" ").some((function(e){return n[e]}))}}function i(e,t,o){return n[e].some((function(e){return e(t,o)}))}function c(e,t){var n=(e.addClass||"").length>0,o=(e.removeClass||"").length>0;return t?n&&o:n||o}n.join.push((function(e,t){return!e.structural&&c(e)})),n.skip.push((function(e,t){return!e.structural&&!c(e)})),n.skip.push((function(e,t){return"leave"===t.event&&e.structural})),n.skip.push((function(e,t){return t.structural&&2===t.state&&!e.structural})),n.cancel.push((function(e,t){return t.structural&&e.structural})),n.cancel.push((function(e,t){return 2===t.state&&e.structural})),n.cancel.push((function(e,t){if(t.structural)return!1;var n=e.addClass,o=e.removeClass,i=t.addClass,a=t.removeClass;return!(te(n)&&te(o)||te(i)&&te(a))&&(r(n,a)||r(o,i))})),this.$get=["$$rAF","$rootScope","$rootElement","$document","$$Map","$$animation","$$AnimateRunner","$templateRequest","$$jqLite","$$forceReflow","$$isDocumentHidden",function(n,r,d,p,m,f,h,g,v,b,y){var $=new m,C=new m,E=null;function A(e){C.delete(e.target)}var x=r.$watch((function(){return 0===g.totalPendingRequests}),(function(e){e&&(x(),r.$$postDigest((function(){r.$$postDigest((function(){null===E&&(E=!0)}))})))})),O=Object.create(null),j=t.customFilter(),D=t.classNameFilter(),N=function(){return!0},U=j||N,F=D?function(e,t){var n=[e.getAttribute("class"),t.addClass,t.removeClass].join(" ");return D.test(n)}:N,B=P(v);function W(e,t){return I(e,t,{})}var V=e.Node.prototype.contains||function(e){return this===e||!!(16&this.compareDocumentPosition(e))};function q(e,t,n){var o=_(t);return e.filter((function(e){return!(e.node===o&&(!n||e.callback===n))}))}function z(e,t){"close"!==e||t.parentNode||Z.off(t)}var Z={on:function(e,t,n){var o=_(t);O[e]=O[e]||[],O[e].push({node:o,callback:n}),ne(t).on("$destroy",(function(){$.get(o)||Z.off(e,t,n)}))},off:function(e,t,n){if(1!==arguments.length||ee(arguments[0])){var o=O[e];o&&(O[e]=1===arguments.length?null:q(o,t,n))}else for(var r in t=arguments[0],O)O[r]=q(O[r],t)},pin:function(e,t){w(X(e),"element","not an element"),w(X(t),"parentElement","not an element"),e.data(ce,t)},push:function(e,t,m,g){return(m=m||{}).domOperation=g,function(e,t,m){var g=H(m),v=S(e),b=R(v),w=b&&b.parentNode;g=M(g);var _,P=new h,A=(_=!1,function(e){_?e():r.$$postDigest((function(){_=!0,e()}))});if(Y(g.addClass)&&(g.addClass=g.addClass.join(" ")),g.addClass&&!ee(g.addClass)&&(g.addClass=null),Y(g.removeClass)&&(g.removeClass=g.removeClass.join(" ")),g.removeClass&&!ee(g.removeClass)&&(g.removeClass=null),g.from&&!Q(g.from)&&(g.from=null),g.to&&!Q(g.to)&&(g.to=null),!(E&&b&&U(b,t,m)&&F(b,g)))return ae(),P;var x=["enter","move","leave"].indexOf(t)>=0,j=y(),D=j||C.get(b),N=!D&&$.get(b)||{},q=!!N.state;if(D||q&&1===N.state||(D=!function(e,t){var n,o=p[0].body,r=R(d),i=e===o||"HTML"===e.nodeName,s=e===r,l=!1,c=C.get(e),m=ne.data(e,ce);for(m&&(t=R(m));t&&(s||(s=t===r),t.nodeType===a);){var f=$.get(t)||{};if(!l){var h=C.get(t);if(!0===h&&!1!==c){c=!0;break}!1===h&&(c=!1),l=f.structural}if(te(n)||!0===n){var g=ne.data(t,u);J(g)&&(n=g)}if(l&&!1===n)break;if(i||(i=t===o),i&&s)break;t=s||!(m=ne.data(t,ce))?t.parentNode:R(m)}return(!l||n)&&!0!==c&&s&&i}(b,w)),D)return j&&ie(P,t,"start",o(g)),ae(),j&&ie(P,t,"close",o(g)),P;x&&function(e){var t=e.querySelectorAll("["+le+"]");K(t,(function(e){var t=parseInt(e.getAttribute(le),10),n=$.get(e);if(n)switch(t){case 2:n.runner.end();case 1:$.delete(e)}}))}(b);var G={structural:x,element:v,event:t,addClass:g.addClass,removeClass:g.removeClass,close:ae,options:g,runner:P};if(q){if(i("skip",G,N))return 2===N.state?(ae(),P):(I(v,N,G),N.runner);if(i("cancel",G,N))if(2===N.state)N.runner.end();else{if(!N.structural)return I(v,N,G),N.runner;N.close()}else if(i("join",G,N)){if(2!==N.state)return function(e,t,n,o){var r="";n&&(r=k(n,"ng-",!0)),o.addClass&&(r=L(r,k(o.addClass,s))),o.removeClass&&(r=L(r,k(o.removeClass,l))),r.length&&(o.preparationClasses=r,t.addClass(r))}(0,v,x?t:null,g),t=G.event=N.event,g=I(v,N,G),N.runner;W(v,G)}}else W(v,G);var X=G.structural;if(X||(X="animate"===G.event&&Object.keys(G.options.to||{}).length>0||c(G)),!X)return ae(),oe(b),P;var Z=(N.counter||0)+1;return G.counter=Z,re(b,1,G),r.$$postDigest((function(){v=S(e);var n=$.get(b),r=!n;n=n||{};var i=(v.parent()||[]).length>0&&("animate"===n.event||n.structural||c(n));if(r||n.counter!==Z||!i)return r&&(B(v,g),T(v,g)),(r||x&&n.event!==t)&&(g.domOperation(),P.end()),void(i||oe(b));t=!n.structural&&c(n,!0)?"setClass":n.event,re(b,2);var a=f(v,t,n.options);P.setHost(a),ie(P,t,"start",o(g)),a.done((function(e){ae(!e);var n=$.get(b);n&&n.counter===Z&&oe(b),ie(P,t,"close",o(g))}))})),P;function ie(e,t,o,r){A((function(){var e=function(e,t,n){var o=[],r=O[n];return r&&K(r,(function(r){(V.call(r.node,t)||"leave"===n&&V.call(r.node,e))&&o.push(r.callback)})),o}(w,b,t);e.length?n((function(){K(e,(function(e){e(v,o,r)})),z(o,b)})):z(o,b)})),e.progress(t,o,r)}function ae(e){!function(e,t){t.preparationClasses&&(e.removeClass(t.preparationClasses),t.preparationClasses=null),t.activeClasses&&(e.removeClass(t.activeClasses),t.activeClasses=null)}(v,g),B(v,g),T(v,g),g.domOperation(),P.complete(!e)}}(e,t,m)},enabled:function(e,t){var n=arguments.length;if(0===n)t=!!E;else if(X(e)){var o=R(e);1===n?t=!C.get(o):(C.has(o)||ne(e).on("$destroy",A),C.set(o,!t))}else t=E=!!e;return t}};return Z;function oe(e){e.removeAttribute(le),$.delete(e)}function re(e,t,n){(n=n||{}).state=t,e.setAttribute(le,t);var o=$.get(e),r=o?G(o,n):n;$.set(e,r)}}]}],de=["$animateProvider",function(e){var t="ng-animate-ref",n=this.drivers=[],o="$$animationRunner",r="$$animatePrepareClasses";function i(e){return e.data(o)}this.$get=["$$jqLite","$rootScope","$injector","$$AnimateRunner","$$Map","$$rAFScheduler","$$animateCache",function(e,a,s,l,u,d,p){var m=[],f=P(e);return function(h,g,v){v=M(v);var b=["enter","move","leave"].indexOf(g)>=0,y=new l({end:function(){P()},cancel:function(){P(!0)}});if(!n.length)return P(),y;var w=$(h.attr("class"),$(v.addClass,v.removeClass)),k=v.tempClasses;return k&&(w+=" "+k,v.tempClasses=null),b&&h.data(r,"ng-"+g+"-prepare"),function(e,t){e.data(o,t)}(h,y),m.push({element:h,classes:w,event:g,structural:b,options:v,beforeStart:function(){k=(k?k+" ":"")+c,e.addClass(h,k);var t=h.data(r);t&&(e.removeClass(h,t),t=null)},close:P}),h.on("$destroy",_),m.length>1||a.$$postDigest((function(){var o=[];K(m,(function(e){i(e.element)?o.push(e):e.close()})),m.length=0;var a=function(e){var n=[],o={};K(e,(function(e,r){var i=R(e.element),a=e.event,s=["enter","move"].indexOf(a)>=0,l=e.structural?function(e){var n="["+t+"]",o=e.hasAttribute(t)?[e]:e.querySelectorAll(n),r=[];return K(o,(function(e){var n=e.getAttribute(t);n&&n.length&&r.push(e)})),r}(i):[];if(l.length){var c=s?"to":"from";K(l,(function(e){var n=e.getAttribute(t);o[n]=o[n]||{},o[n][c]={animationID:r,element:ne(e)}}))}else n.push(e)}));var r={},i={};return K(o,(function(t,o){var a=t.from,s=t.to;if(a&&s){var l=e[a.animationID],c=e[s.animationID],u=a.animationID.toString();if(!i[u]){var d=i[u]={structural:!0,beforeStart:function(){l.beforeStart(),c.beforeStart()},close:function(){l.close(),c.close()},classes:S(l.classes,c.classes),from:l,to:c,anchors:[]};d.classes.length?n.push(d):(n.push(l),n.push(c))}i[u].anchors.push({out:a.element,in:s.element})}else{var p=a?a.animationID:s.animationID,m=p.toString();r[m]||(r[m]=!0,n.push(e[p]))}})),n}(o),l=[];K(a,(function(e){var t=e.from?e.from.element:e.element,o=v.addClass;o=(o?o+" ":"")+c;var r=p.cacheKey(t[0],e.event,o,v.removeClass);l.push({element:t,domNode:R(t),fn:function(){var t,o=e.close;if(p.containsCachedAnimationWithoutDuration(r))o();else{if(e.beforeStart(),i(e.anchors?e.from.element||e.to.element:e.element)){var a=function(e){for(var t=n.length-1;t>=0;t--){var o=n[t],r=s.get(o)(e);if(r)return r}}(e);a&&(t=a.start)}if(t){var l=t();l.done((function(e){o(!e)})),function(e,t){function n(e){var n=i(e);n&&n.setHost(t)}e.from&&e.to?(n(e.from.element),n(e.to.element)):n(e.element)}(e,l)}else o()}}})}));for(var f=function(e){var t,n={children:[]},o=new u;for(t=0;t<e.length;t++){var r=e[t];o.set(r.domNode,e[t]={domNode:r.domNode,element:r.element,fn:r.fn,children:[]})}for(t=0;t<e.length;t++)i(e[t]);return function(e){var t,n=[],o=[];for(t=0;t<e.children.length;t++)o.push(e.children[t]);var r=o.length,i=0,a=[];for(t=0;t<o.length;t++){var s=o[t];r<=0&&(r=i,i=0,n.push(a),a=[]),a.push(s),s.children.forEach((function(e){i++,o.push(e)})),r--}return a.length&&n.push(a),n}(n);function i(e){if(e.processed)return e;e.processed=!0;var t,r=e.domNode,a=r.parentNode;for(o.set(r,e);a;){if(t=o.get(a)){t.processed||(t=i(t));break}a=a.parentNode}return(t||n).children.push(e),e}}(l),h=0;h<f.length;h++)for(var g=f[h],b=0;b<g.length;b++){var y=g[b],w=y.element;if(f[h][b]=y.fn,0!==h){var $=w.data(r);$&&e.addClass(w,$)}else w.removeData(r)}d(f)})),y;function S(e,t){e=e.split(" "),t=t.split(" ");for(var n=[],o=0;o<e.length;o++){var r=e[o];if("ng-"!==r.substring(0,3))for(var i=0;i<t.length;i++)if(r===t[i]){n.push(r);break}}return n.join(" ")}function _(){var e=i(h);!e||"leave"===g&&v.$$domOperationFired||e.end()}function P(t){h.off("$destroy",_),function(e){e.removeData(o)}(h),f(h,v),T(h,v),v.domOperation(),k&&e.removeClass(h,k),y.complete(!t)}}}]}];t.module("ngAnimate",[],(function(){oe=t.noop,H=t.copy,G=t.extend,ne=t.element,K=t.forEach,Y=t.isArray,ee=t.isString,Q=t.isObject,te=t.isUndefined,J=t.isDefined,Z=t.isFunction,X=t.isElement})).info({angularVersion:"1.8.3"}).directive("ngAnimateSwap",["$animate",function(e){return{restrict:"A",transclude:"element",terminal:!0,priority:550,link:function(t,n,o,r,i){var a,s;t.$watchCollection(o.ngAnimateSwap||o.for,(function(t){a&&e.leave(a),s&&(s.$destroy(),s=null),(t||0===t)&&i((function(t,o){a=t,s=o,e.enter(t,null,n)}))}))}}}]).directive("ngAnimateChildren",j).factory("$$rAFScheduler",["$$rAF",function(e){var t,n;function o(e){t=t.concat(e),r()}return t=o.queue=[],o.waitUntilQuiet=function(t){n&&n(),n=e((function(){n=null,t(),r()}))},o;function r(){if(t.length){for(var o=t.shift(),i=0;i<o.length;i++)o[i]();n||e((function(){n||r()}))}}}]).provider("$$animateQueue",ue).provider("$$animateCache",(function(){var e="$$ngAnimateParentKey",t=0,n=Object.create(null);this.$get=[function(){return{cacheKey:function(n,o,r,i){var a=n.parentNode,s=[a[e]||(a[e]=++t),o,n.getAttribute("class")];return r&&s.push(r),i&&s.push(i),s.join(" ")},containsCachedAnimationWithoutDuration:function(e){var t=n[e];return t&&!t.isValid||!1},flush:function(){n=Object.create(null)},count:function(e){var t=n[e];return t?t.total:0},get:function(e){var t=n[e];return t&&t.value},put:function(e,t,o){n[e]?(n[e].total++,n[e].value=t):n[e]={total:1,value:t,isValid:o}}}}]})).provider("$$animation",de).provider("$animateCss",re).provider("$$animateCssDriver",ie).provider("$$animateJs",ae).provider("$$animateJsDriver",se)}(window,window.angular),function(e,t){var n=t.$$minErr("$resource"),o=/^(\.[a-zA-Z_$@][0-9a-zA-Z_$@]*)+$/;function r(e,n){for(var o in n=n||{},t.forEach(n,(function(e,t){delete n[t]})),e)!e.hasOwnProperty(o)||"$"===o.charAt(0)&&"$"===o.charAt(1)||(n[o]=e[o]);return n}t.module("ngResource",["ng"]).info({angularVersion:"1.8.3"}).provider("$resource",(function(){var e=/^https?:\/\/\[[^\]]*][^/]*/,i=this;this.defaults={stripTrailingSlashes:!0,cancellable:!1,actions:{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},delete:{method:"DELETE"}}},this.$get=["$http","$log","$q","$timeout",function(a,s,l,c){var u=t.noop,d=t.forEach,p=t.extend,m=t.copy,f=t.isArray,h=t.isDefined,g=t.isFunction,v=t.isNumber,b=t.$$encodeUriQuery,y=t.$$encodeUriSegment;function w(e,t){this.template=e,this.defaults=p({},i.defaults,t),this.urlParams={}}return w.prototype={setUrlParams:function(t,o,r){var i,a,s=this,l=r||s.template,c="",u=s.urlParams=Object.create(null);d(l.split(/\W/),(function(e){if("hasOwnProperty"===e)throw n("badname","hasOwnProperty is not a valid parameter name.");!new RegExp("^\\d+$").test(e)&&e&&new RegExp("(^|[^\\\\]):"+e+"(\\W|$)").test(l)&&(u[e]={isQueryParamValue:new RegExp("\\?.*=:"+e+"(?:\\W|$)").test(l)})})),l=(l=l.replace(/\\:/g,":")).replace(e,(function(e){return c=e,""})),o=o||{},d(s.urlParams,(function(e,t){i=o.hasOwnProperty(t)?o[t]:s.defaults[t],h(i)&&null!==i?(a=e.isQueryParamValue?b(i,!0):y(i),l=l.replace(new RegExp(":"+t+"(\\W|$)","g"),(function(e,t){return a+t}))):l=l.replace(new RegExp("(/?):"+t+"(\\W|$)","g"),(function(e,t,n){return"/"===n.charAt(0)?n:t+n}))})),s.defaults.stripTrailingSlashes&&(l=l.replace(/\/+$/,"")||"/"),l=l.replace(/\/\.(?=\w+($|\?))/,"."),t.url=c+l.replace(/\/(\\|%5C)\./,"/."),d(o,(function(e,n){s.urlParams[n]||(t.params=t.params||{},t.params[n]=e)}))}},function(e,b,y,$){var k=new w(e,$);function S(e){return e.resource}function _(e){r(e||{},this)}return y=p({},i.defaults.actions,y),_.prototype.toJSON=function(){var e=p({},this);return delete e.$promise,delete e.$resolved,delete e.$cancelRequest,e},d(y,(function(e,i){var y=!0===e.hasBody||!1!==e.hasBody&&/^(POST|PUT|PATCH)$/i.test(e.method),w=e.timeout,$=h(e.cancellable)?e.cancellable:k.defaults.cancellable;w&&!v(w)&&(s.debug("ngResource:\n  Only numeric values are allowed as `timeout`.\n  Promises are not supported in $resource, because the same value would be used for multiple requests. If you are looking for a way to cancel requests, you should use the `cancellable` option."),delete e.timeout,w=null),_[i]=function(s,h,v,P){var M,T,C,E={};switch(arguments.length){case 4:C=P,T=v;case 3:case 2:if(!g(h)){E=s,M=h,T=v;break}if(g(s)){T=s,C=h;break}T=h,C=v;case 1:g(s)?T=s:y?M=s:E=s;break;case 0:break;default:throw n("badargs","Expected up to 4 arguments [params, data, success, error], got {0} arguments",arguments.length)}var I,R,A,x=this instanceof _,L=x?M:e.isArray?[]:new _(M),O={},j=e.interceptor&&e.interceptor.request||void 0,D=e.interceptor&&e.interceptor.requestError||void 0,N=e.interceptor&&e.interceptor.response||S,U=e.interceptor&&e.interceptor.responseError||l.reject,F=T?function(e){T(e,A.headers,A.status,A.statusText)}:void 0,B=C||void 0;d(e,(function(e,t){switch(t){default:O[t]=m(e);case"params":case"isArray":case"interceptor":case"cancellable":}})),!x&&$&&(I=l.defer(),O.timeout=I.promise,w&&(R=c(I.resolve,w))),y&&(O.data=M),k.setUrlParams(O,p({},function(e,r){var i={};return r=p({},b,r),d(r,(function(r,a){g(r)&&(r=r(e)),i[a]=r&&r.charAt&&"@"===r.charAt(0)?function(e,r){if(!function(e){return null!=e&&""!==e&&"hasOwnProperty"!==e&&o.test("."+e)}(r))throw n("badmember",'Dotted member path "@{0}" is invalid.',r);for(var i=r.split("."),a=0,s=i.length;a<s&&t.isDefined(e);a++){var l=i[a];e=null!==e?e[l]:void 0}return e}(e,r.substr(1)):r})),i}(M,e.params||{}),E),e.url);var W=l.resolve(O).then(j).catch(D).then(a);return W=W.then((function(t){var o=t.data;if(o){if(f(o)!==!!e.isArray)throw n("badcfg","Error in resource configuration for action `{0}`. Expected response to contain an {1} but got an {2} (Request: {3} {4})",i,e.isArray?"array":"object",f(o)?"array":"object",O.method,O.url);if(e.isArray)L.length=0,d(o,(function(e){"object"==typeof e?L.push(new _(e)):L.push(e)}));else{var a=L.$promise;r(o,L),L.$promise=a}}return t.resource=L,A=t,N(t)}),(function(e){return e.resource=L,A=e,U(e)})),(W=W.finally((function(){L.$resolved=!0,!x&&$&&(L.$cancelRequest=u,c.cancel(R),I=R=O.timeout=null)}))).then(F,B),x?W:(L.$promise=W,L.$resolved=!1,$&&(L.$cancelRequest=function(e){W.catch(u),null!==I&&I.resolve(e)}),L)},_.prototype["$"+i]=function(e,t,n){g(e)&&(n=t,t=e,e={});var o=_[i].call(this,e,this,t,n);return o.$promise||o}})),_}}]}))}(window,window.angular),function(e,t){var n,o,r,i,a,s,l,c,u,d,p=t.$$minErr("$sanitize");t.module("ngSanitize",[]).provider("$sanitize",(function(){var m=!1,f=!1;this.$get=["$$sanitizeUri",function(e){return m=!0,f&&o(P,S),function(t){var n=[];return u(t,d(n,(function(t,n){return!/^unsafe:/.test(e(t,n))}))),n.join("")}}],this.enableSvg=function(e){return a(e)?(f=e,this):f},this.addValidElements=function(e){return m||(i(e)&&(e={htmlElements:e}),A(S,e.svgElements),A(v,e.htmlVoidElements),A(P,e.htmlVoidElements),A(P,e.htmlElements)),this},this.addValidAttrs=function(e){return m||o(E,R(e,!0)),this},n=t.bind,o=t.extend,r=t.forEach,i=t.isArray,a=t.isDefined,s=t.$$lowercase,l=t.noop,u=function(e,t){null==e?e="":"string"!=typeof e&&(e=""+e);var n=x(e);if(!n)return"";var o=5;do{if(0===o)throw p("uinput","Failed to sanitize html because the input is unstable");o--,e=n.innerHTML,n=x(e)}while(e!==n.innerHTML);for(var r=n.firstChild;r;){switch(r.nodeType){case 1:t.start(r.nodeName.toLowerCase(),L(r.attributes));break;case 3:t.chars(r.textContent)}var i;if(!((i=r.firstChild)||(1===r.nodeType&&t.end(r.nodeName.toLowerCase()),i=D("nextSibling",r))))for(;null==i&&(r=D("parentNode",r))!==n;)i=D("nextSibling",r),1===r.nodeType&&t.end(r.nodeName.toLowerCase());r=i}for(;r=n.firstChild;)n.removeChild(r)},d=function(e,t){var o=!1,i=n(e,e.push);return{start:function(e,n){e=s(e),!o&&_[e]&&(o=e),o||!0!==P[e]||(i("<"),i(e),r(n,(function(n,o){var r=s(o),a="img"===e&&"src"===r||"background"===r;!0!==E[r]||!0===M[r]&&!t(n,a)||(i(" "),i(o),i('="'),i(O(n)),i('"'))})),i(">"))},end:function(e){e=s(e),o||!0!==P[e]||!0===v[e]||(i("</"),i(e),i(">")),e==o&&(o=!1)},chars:function(e){o||i(O(e))}}},c=e.Node.prototype.contains||function(e){return!!(16&this.compareDocumentPosition(e))};var h=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,g=/([^#-~ |!])/g,v=I("area,br,col,hr,img,wbr"),b=I("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),y=I("rp,rt"),w=o({},y,b),$=o({},b,I("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,section,table,ul")),k=o({},y,I("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),S=I("circle,defs,desc,ellipse,font-face,font-face-name,font-face-src,g,glyph,hkern,image,linearGradient,line,marker,metadata,missing-glyph,mpath,path,polygon,polyline,radialGradient,rect,stop,svg,switch,text,title,tspan"),_=I("script,style"),P=o({},v,$,k,w),M=I("background,cite,href,longdesc,src,xlink:href,xml:base"),T=I("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,tabindex,target,title,type,valign,value,vspace,width"),C=I("accent-height,accumulate,additive,alphabetic,arabic-form,ascent,baseProfile,bbox,begin,by,calcMode,cap-height,class,color,color-rendering,content,cx,cy,d,dx,dy,descent,display,dur,end,fill,fill-rule,font-family,font-size,font-stretch,font-style,font-variant,font-weight,from,fx,fy,g1,g2,glyph-name,gradientUnits,hanging,height,horiz-adv-x,horiz-origin-x,ideographic,k,keyPoints,keySplines,keyTimes,lang,marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,mathematical,max,min,offset,opacity,orient,origin,overline-position,overline-thickness,panose-1,path,pathLength,points,preserveAspectRatio,r,refX,refY,repeatCount,repeatDur,requiredExtensions,requiredFeatures,restart,rotate,rx,ry,slope,stemh,stemv,stop-color,stop-opacity,strikethrough-position,strikethrough-thickness,stroke,stroke-dasharray,stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,stroke-width,systemLanguage,target,text-anchor,to,transform,type,u1,u2,underline-position,underline-thickness,unicode,unicode-range,units-per-em,values,version,viewBox,visibility,width,widths,x,x-height,x1,x2,xlink:actuate,xlink:arcrole,xlink:role,xlink:show,xlink:title,xlink:type,xml:base,xml:lang,xml:space,xmlns,xmlns:xlink,y,y1,y2,zoomAndPan",!0),E=o({},M,C,T);function I(e,t){return R(e.split(","),t)}function R(e,t){var n,o={};for(n=0;n<e.length;n++)o[t?s(e[n]):e[n]]=!0;return o}function A(e,t){t&&t.length&&o(e,R(t))}var x=function(e,t){if(function(){try{return!!r("")}catch(e){return!1}}())return r;if(!t||!t.implementation)throw p("noinert","Can't create an inert html document");var n=t.implementation.createHTMLDocument("inert"),o=(n.documentElement||n.getDocumentElement()).querySelector("body");return function(e){return o.innerHTML=e,t.documentMode&&j(o),o};function r(t){t="<remove></remove>"+t;try{var n=(new e.DOMParser).parseFromString(t,"text/html").body;return n.firstChild.remove(),n}catch(e){return}}}(e,e.document);function L(e){for(var t={},n=0,o=e.length;n<o;n++){var r=e[n];t[r.name]=r.value}return t}function O(e){return e.replace(/&/g,"&amp;").replace(h,(function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"})).replace(g,(function(e){return"&#"+e.charCodeAt(0)+";"})).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function j(t){for(;t;){if(t.nodeType===e.Node.ELEMENT_NODE)for(var n=t.attributes,o=0,r=n.length;o<r;o++){var i=n[o],a=i.name.toLowerCase();"xmlns:ns1"!==a&&0!==a.lastIndexOf("ns1:",0)||(t.removeAttributeNode(i),o--,r--)}var s=t.firstChild;s&&j(s),t=D("nextSibling",t)}}function D(e,t){var n=t[e];if(n&&c.call(t,n))throw p("elclob","Failed to sanitize html because the element is clobbered: {0}",t.outerHTML||t.outerText);return n}})).info({angularVersion:"1.8.3"}),t.module("ngSanitize").filter("linky",["$sanitize",function(e){var n=/((s?ftp|https?):\/\/|(www\.)|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"\u201d\u2019]/i,o=/^mailto:/i,r=t.$$minErr("linky"),i=t.isDefined,a=t.isFunction,s=t.isObject,c=t.isString;return function(t,u,p){if(null==t||""===t)return t;if(!c(t))throw r("notstring","Expected string but received: {0}",t);for(var m,f,h,g=a(p)?p:s(p)?function(){return p}:function(){return{}},v=t,b=[];m=v.match(n);)f=m[0],m[2]||m[4]||(f=(m[3]?"http://":"mailto:")+f),h=m.index,y(v.substr(0,h)),w(f,m[0].replace(o,"")),v=v.substring(h+m[0].length);return y(v),e(b.join(""));function y(e){var t,n;e&&b.push((t=e,d(n=[],l).chars(t),n.join("")))}function w(e,t){var n,o=g(e);for(n in b.push("<a "),o)b.push(n+'="'+o[n]+'" ');i(u)&&!("target"in o)&&b.push('target="',u,'" '),b.push('href="',e.replace(/"/g,"&quot;"),'">'),y(t),b.push("</a>")}}}])}(window,window.angular),angular.module("ngLocale",[],["$provide",function(e){e.value("$locale",{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ERANAMES:["Before Christ","Anno Domini"],ERAS:["BC","AD"],FIRSTDAYOFWEEK:6,MONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],SHORTDAY:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],SHORTMONTH:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],STANDALONEMONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],WEEKENDRANGE:[5,6],fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",medium:"MMM d, y h:mm:ss a",mediumDate:"MMM d, y",mediumTime:"h:mm:ss a",short:"M/d/yy h:mm a",shortDate:"M/d/yy",shortTime:"h:mm a"},NUMBER_FORMATS:{CURRENCY_SYM:"$",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""}]},id:"en",localeID:"en",pluralCat:function(e,t){var n=0|e,o=function(e,t){var n=t;void 0===n&&(n=Math.min(function(e){var t=(e+="").indexOf(".");return-1==t?0:e.length-t-1}(e),3));var o=Math.pow(10,n);return{v:n,f:(e*o|0)%o}}(e,t);return 1==n&&0==o.v?"one":"other"}})}]);var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function n(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var n=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach((function(t){var o=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,o.get?o:{enumerable:!0,get:function(){return e[t]}})})),n}var o,r;!function(t,n){Uo.$inject=["$injector","$q","$uiRouter"],Fo.$inject=["$rootScope"],Do.$inject=["$locationProvider"],$o.$inject=["state"];var o=angular,r=n&&n.module?n:o;function i(e){return function t(){if(arguments.length>=e.length)return e.apply(this,arguments);var n=Array.prototype.slice.call(arguments);return t.bind.apply(t,function(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))}([this],n,!1))}}function a(){var e=arguments,t=e.length-1;return function(){for(var n=t,o=e[t].apply(this,arguments);n--;)o=e[n].call(this,o);return o}}function s(){return a.apply(null,[].slice.call(arguments).reverse())}var l=function(e){return function(t){return t&&t[e]}},c=i((function(e,t,n){return n&&n[e]===t})),u=function(e){return s.apply(null,e.split(".").map(l))},d=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return!e.apply(null,t)}};function p(e,t){return function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return e.apply(null,n)&&t.apply(null,n)}}function m(e,t){return function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return e.apply(null,n)||t.apply(null,n)}}var f=function(e){return function(t){return t.reduce((function(t,n){return t&&!!e(n)}),!0)}},h=function(e){return function(t){return t.reduce((function(t,n){return t||!!e(n)}),!1)}},g=function(e){return function(t){return null!=t&&t.constructor===e||t instanceof e}},v=function(e){return function(t){return e===t}},b=function(e){return function(){return e}};function y(e,t){return function(n){return n[e].apply(n,t)}}function w(e){return function(t){for(var n=0;n<e.length;n++)if(e[n][0](t))return e[n][1](t)}}var $=Object.prototype.toString,k=function(e){return function(t){return typeof t===e}},S=k("undefined"),_=d(S),P=function(e){return null===e},M=m(P,S),T=k("function"),C=k("number"),E=k("string"),I=function(e){return null!==e&&"object"==typeof e},R=Array.isArray,A=function(e){return"[object Date]"===$.call(e)},x=function(e){return"[object RegExp]"===$.call(e)};function L(e){if(R(e)&&e.length){var t=e.slice(0,-1),n=e.slice(-1);return!(t.filter(d(E)).length||n.filter(d(T)).length)}return T(e)}var O=p(I,s(l("then"),T)),j=function(e,t){return t.reduce((function(t,n){return t[n]=(o="".concat(e,".").concat(String(n),"()"),function(){throw new Error("No implementation for ".concat(o,". The framework specific code did not implement this method."))}),t;var o}),{})},D={$q:void 0,$injector:void 0},N="object"==typeof self&&self.self===self&&self||"object"==typeof e&&e.global===e&&e||void 0,U=N.angular||{},F=U.fromJson||JSON.parse.bind(JSON),B=U.toJson||JSON.stringify.bind(JSON),W=U.forEach||function(e,t,n){if(R(e))return e.forEach(t,n);Object.keys(e).forEach((function(n){return t(e[n],n)}))},V=Object.assign||Ee,q=U.equals||Ie;function z(e){return e}function H(){}function G(e,t,n,o,r){void 0===r&&(r=!1);var i=function(t){return e()[t].bind(n())};return(o=o||Object.keys(e())).reduce((function(e,n){return e[n]=r?(o=n,function(){return t[o]=i(o),t[o].apply(null,arguments)}):i(n),e;var o}),t)}var K=function(e,t){return V(Object.create(e),t)},Y=i(J);function J(e,t){return-1!==e.indexOf(t)}var X=i(Z);function Z(e,t){var n=e.indexOf(t);return n>=0&&e.splice(n,1),e}var Q=i(ee);function ee(e,t){return e.push(t),t}var te=function(e){return e.slice().forEach((function(t){"function"==typeof t&&t(),X(e,t)}))};function ne(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=V.apply(void 0,function(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))}([{}],t.reverse(),!1));return V(o,ie(e||{},Object.keys(o)))}var oe=function(e,t){return V(e,t)};function re(e,t){var n=[];for(var o in e.path){if(e.path[o]!==t.path[o])break;n.push(e.path[o])}return n}function ie(e,t){var n={};for(var o in e)-1!==t.indexOf(o)&&(n[o]=e[o]);return n}function ae(e,t){return Object.keys(e).filter(d(Y(t))).reduce((function(t,n){return t[n]=e[n],t}),{})}function se(e,t){return de(e,l(t))}function le(e,t){var n=R(e),o=n?[]:{},r=n?function(e){return o.push(e)}:function(e,t){return o[t]=e};return W(e,(function(e,n){t(e,n)&&r(e,n)})),o}function ce(e,t){var n;return W(e,(function(e,o){n||t(e,o)&&(n=e)})),n}var ue=de;function de(e,t,n){return n=n||(R(e)?[]:{}),W(e,(function(e,o){return n[o]=t(e,o)})),n}var pe=function(e){return Object.keys(e).map((function(t){return e[t]}))},me=function(e,t){return e&&t},fe=function(e,t){return e||t},he=function(e,t){return e.concat(t)},ge=function(e,t){return R(t)?e.concat(t.reduce(ge,[])):ve(e,t)};function ve(e,t){return e.push(t),e}var be=function(e,t){return Y(e,t)?e:ve(e,t)},ye=function(e){return e.reduce(he,[])},we=function(e){return e.reduce(ge,[])},$e=Se,ke=Se;function Se(e,t){return void 0===t&&(t="assert failure"),function(n){var o=e(n);if(!o)throw new Error(T(t)?t(n):t);return o}}var _e=function(e){return Object.keys(e).map((function(t){return[t,e[t]]}))};function Pe(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===e.length)return[];for(var n=e.reduce((function(e,t){return Math.min(t.length,e)}),9007199254740991),o=[],r=function(t){switch(e.length){case 1:o.push([e[0][t]]);break;case 2:o.push([e[0][t],e[1][t]]);break;case 3:o.push([e[0][t],e[1][t],e[2][t]]);break;case 4:o.push([e[0][t],e[1][t],e[2][t],e[3][t]]);break;default:o.push(e.map((function(e){return e[t]})))}},i=0;i<n;i++)r(i);return o}function Me(e,t){var n,o;if(R(t)&&(n=t[0],o=t[1]),!E(n))throw new Error("invalid parameters to applyPairs");return e[n]=o,e}function Te(e){return e.length&&e[e.length-1]||void 0}function Ce(e,t){return t&&Object.keys(t).forEach((function(e){return delete t[e]})),t||(t={}),V(t,e)}function Ee(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];if(n)for(var o=Object.keys(n),r=0;r<o.length;r++)e[o[r]]=n[o[r]]}return e}function Ie(e,t){if(e===t)return!0;if(null===e||null===t)return!1;if(e!=e&&t!=t)return!0;var n=typeof e;if(n!==typeof t||"object"!==n)return!1;var o,r,i=[e,t];if(f(R)(i))return r=t,(o=e).length===r.length&&Pe(o,r).reduce((function(e,t){return e&&Ie(t[0],t[1])}),!0);if(f(A)(i))return e.getTime()===t.getTime();if(f(x)(i))return e.toString()===t.toString();if(f(T)(i))return!0;if([T,R,A,x].map(h).reduce((function(e,t){return e||!!t(i)}),!1))return!1;var a={};for(var s in e){if(!Ie(e[s],t[s]))return!1;a[s]=!0}for(var s in t)if(!a[s])return!1;return!0}var Re,Ae=function(e){return e.catch((function(e){return 0}))&&e},xe=function(e){return Ae(D.$q.reject(e))},Le=function(){function e(e){this.text=e,this.glob=e.split(".");var t=this.text.split(".").map((function(e){return"**"===e?"(?:|(?:\\.[^.]*)*)":"*"===e?"\\.[^.]*":"\\."+e})).join("");this.regexp=new RegExp("^"+t+"$")}return e.is=function(e){return!!/[!,*]+/.exec(e)},e.fromString=function(t){return e.is(t)?new e(t):null},e.prototype.matches=function(e){return this.regexp.test("."+e)},e}(),Oe=function(){function e(e,t){void 0===e&&(e=[]),void 0===t&&(t=null),this._items=e,this._limit=t,this._evictListeners=[],this.onEvict=Q(this._evictListeners)}return e.prototype.enqueue=function(e){var t=this._items;return t.push(e),this._limit&&t.length>this._limit&&this.evict(),e},e.prototype.evict=function(){var e=this._items.shift();return this._evictListeners.forEach((function(t){return t(e)})),e},e.prototype.dequeue=function(){if(this.size())return this._items.splice(0,1)[0]},e.prototype.clear=function(){var e=this._items;return this._items=[],e},e.prototype.size=function(){return this._items.length},e.prototype.remove=function(e){var t=this._items.indexOf(e);return t>-1&&this._items.splice(t,1)[0]},e.prototype.peekTail=function(){return this._items[this._items.length-1]},e.prototype.peekHead=function(){if(this.size())return this._items[0]},e}();(Re=t.RejectType||(t.RejectType={}))[Re.SUPERSEDED=2]="SUPERSEDED",Re[Re.ABORTED=3]="ABORTED",Re[Re.INVALID=4]="INVALID",Re[Re.IGNORED=5]="IGNORED",Re[Re.ERROR=6]="ERROR";var je=0,De=function(){function e(e,t,n){this.$id=je++,this.type=e,this.message=t,this.detail=n}return e.isRejectionPromise=function(t){return t&&"function"==typeof t.then&&g(e)(t._transitionRejection)},e.superseded=function(n,o){var r=new e(t.RejectType.SUPERSEDED,"The transition has been superseded by a different transition",n);return o&&o.redirected&&(r.redirected=!0),r},e.redirected=function(t){return e.superseded(t,{redirected:!0})},e.invalid=function(n){return new e(t.RejectType.INVALID,"This transition is invalid",n)},e.ignored=function(n){return new e(t.RejectType.IGNORED,"The transition was ignored",n)},e.aborted=function(n){return new e(t.RejectType.ABORTED,"The transition has been aborted",n)},e.errored=function(n){return new e(t.RejectType.ERROR,"The transition errored",n)},e.normalize=function(t){return g(e)(t)?t:e.errored(t)},e.prototype.toString=function(){var e,t=(e=this.detail)&&e.toString!==Object.prototype.toString?e.toString():Ve(e),n=this,o=n.$id,r=n.type,i=n.message;return"Transition Rejection($id: ".concat(o," type: ").concat(r,", message: ").concat(i,", detail: ").concat(t,")")},e.prototype.toPromise=function(){return V(xe(this),{_transitionRejection:this})},e}();function Ne(e,t){return t.length<=e?t:t.substr(0,e-3)+"..."}function Ue(e,t){for(;t.length<e;)t+=" ";return t}function Fe(e){return e.replace(/^([A-Z])/,(function(e){return e.toLowerCase()})).replace(/([A-Z])/g,(function(e){return"-"+e.toLowerCase()}))}function Be(e){var t=We(e),n=t.match(/^(function [^ ]+\([^)]*\))/),o=n?n[1]:t,r=e.name||"";return r&&o.match(/function \(/)?"function "+r+o.substr(9):o}function We(e){var t=R(e)?e.slice(-1)[0]:e;return t&&t.toString()||"undefined"}function Ve(e){var t=[],n=De.isRejectionPromise,o=w([[S,b("undefined")],[P,b("null")],[O,b("[Promise]")],[n,function(e){return e._transitionRejection.toString()}],[function(e){return I(e)&&!R(e)&&e.constructor!==Object&&T(e.toString)},function(e){return e.toString()}],[L,Be],[b(!0),z]]);function r(e){if(I(e)){if(-1!==t.indexOf(e))return"[circular ref]";t.push(e)}return o(e)}return S(e)?r(e):JSON.stringify(e,(function(e,t){return r(t)})).replace(/\\"/g,'"')}var qe=function(e){return function(t){if(!t)return["",""];var n=t.indexOf(e);return-1===n?[t,""]:[t.substr(0,n),t.substr(n+1)]}},ze=new RegExp("^(?:[a-z]+:)?//[^/]+/"),He=function(e){return e.replace(/\/[^/]*$/,"")},Ge=qe("#"),Ke=qe("?"),Ye=qe("="),Je=function(e){return e?e.replace(/^#/,""):""};function Xe(e){var t=new RegExp("("+e+")","g");return function(e){return e.split(t).filter(z)}}function Ze(e,t){return E(Te(e))&&E(t)?e.slice(0,-1).concat(Te(e)+t):ve(e,t)}var Qe={log:H,error:H,table:H};var et="undefined"!=typeof document&&document.documentMode&&9===document.documentMode?window&&window.console?function(e){var t=function(t){return Function.prototype.bind.call(t,e)};return{log:t(e.log),error:t(e.log),table:t(e.log)}}(window.console):Qe:console.table&&console.error?console:function(e){var t=e.log.bind(e);return{log:t,error:e.error?e.error.bind(e):t,table:e.table?e.table.bind(e):t}}(console);function tt(e){if(!e)return"ui-view (defunct)";var t=e.creationContext?e.creationContext.name||"(root)":"(none)";return"[ui-view#".concat(e.id," ").concat(e.$type,":").concat(e.fqn," (").concat(e.name,"@").concat(t,")]")}var nt;function ot(e){return C(e)?t.Category[e]:t.Category[t.Category[e]]}(nt=t.Category||(t.Category={}))[nt.RESOLVE=0]="RESOLVE",nt[nt.TRANSITION=1]="TRANSITION",nt[nt.HOOK=2]="HOOK",nt[nt.UIVIEW=3]="UIVIEW",nt[nt.VIEWCONFIG=4]="VIEWCONFIG";var rt=u("$id"),it=u("router.$id"),at=function(e){return"Transition #".concat(rt(e),"-").concat(it(e))},st=function(){function e(){this._enabled={},this.approximateDigests=0}return e.prototype._set=function(e,n){var o=this;n.length||(n=Object.keys(t.Category).map((function(e){return parseInt(e,10)})).filter((function(e){return!isNaN(e)})).map((function(e){return t.Category[e]}))),n.map(ot).forEach((function(t){return o._enabled[t]=e}))},e.prototype.enable=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._set(!0,e)},e.prototype.disable=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._set(!1,e)},e.prototype.enabled=function(e){return!!this._enabled[ot(e)]},e.prototype.traceTransitionStart=function(e){this.enabled(t.Category.TRANSITION)&&et.log("".concat(at(e),": Started  -> ").concat(Ve(e)))},e.prototype.traceTransitionIgnored=function(e){this.enabled(t.Category.TRANSITION)&&et.log("".concat(at(e),": Ignored  <> ").concat(Ve(e)))},e.prototype.traceHookInvocation=function(e,n,o){if(this.enabled(t.Category.HOOK)){var r=u("traceData.hookType")(o)||"internal",i=u("traceData.context.state.name")(o)||u("traceData.context")(o)||"unknown",a=Be(e.registeredHook.callback);et.log("".concat(at(n),":   Hook -> ").concat(r," context: ").concat(i,", ").concat(Ne(200,a)))}},e.prototype.traceHookResult=function(e,n,o){this.enabled(t.Category.HOOK)&&et.log("".concat(at(n),":   <- Hook returned: ").concat(Ne(200,Ve(e))))},e.prototype.traceResolvePath=function(e,n,o){this.enabled(t.Category.RESOLVE)&&et.log("".concat(at(o),":         Resolving ").concat(e," (").concat(n,")"))},e.prototype.traceResolvableResolved=function(e,n){this.enabled(t.Category.RESOLVE)&&et.log("".concat(at(n),":               <- Resolved  ").concat(e," to: ").concat(Ne(200,Ve(e.data))))},e.prototype.traceError=function(e,n){this.enabled(t.Category.TRANSITION)&&et.log("".concat(at(n),": <- Rejected ").concat(Ve(n),", reason: ").concat(e))},e.prototype.traceSuccess=function(e,n){this.enabled(t.Category.TRANSITION)&&et.log("".concat(at(n),": <- Success  ").concat(Ve(n),", final state: ").concat(e.name))},e.prototype.traceUIViewEvent=function(e,n,o){void 0===o&&(o=""),this.enabled(t.Category.UIVIEW)&&et.log("ui-view: ".concat(Ue(30,e)," ").concat(tt(n)).concat(o))},e.prototype.traceUIViewConfigUpdated=function(e,n){this.enabled(t.Category.UIVIEW)&&this.traceUIViewEvent("Updating",e," with ViewConfig from context='".concat(n,"'"))},e.prototype.traceUIViewFill=function(e,n){this.enabled(t.Category.UIVIEW)&&this.traceUIViewEvent("Fill",e," with: ".concat(Ne(200,n)))},e.prototype.traceViewSync=function(e){if(this.enabled(t.Category.VIEWCONFIG)){var n="uiview component fqn",o=e.map((function(e){var t,o=e.uiView,r=e.viewConfig,i=o&&o.fqn,a=r&&"".concat(r.viewDecl.$context.name,": (").concat(r.viewDecl.$name,")");return(t={})[n]=i,t["view config state (view name)"]=a,t})).sort((function(e,t){return(e[n]||"").localeCompare(t[n]||"")}));et.table(o)}},e.prototype.traceViewServiceEvent=function(e,n){this.enabled(t.Category.VIEWCONFIG)&&et.log("VIEWCONFIG: ".concat(e," ").concat(function(e){var t=e.viewDecl,n=t.$context.name||"(root)";return"[View#".concat(e.$id," from '").concat(n,"' state]: target ui-view: '").concat(t.$uiViewName,"@").concat(t.$uiViewContextAnchor,"'")}(n)))},e.prototype.traceViewServiceUIViewEvent=function(e,n){this.enabled(t.Category.VIEWCONFIG)&&et.log("VIEWCONFIG: ".concat(e," ").concat(tt(n)))},e}(),lt=new st,ct=function(){function e(e){this.pattern=/.*/,this.inherit=!0,V(this,e)}return e.prototype.is=function(e,t){return!0},e.prototype.encode=function(e,t){return e},e.prototype.decode=function(e,t){return e},e.prototype.equals=function(e,t){return e==t},e.prototype.$subPattern=function(){var e=this.pattern.toString();return e.substr(1,e.length-2)},e.prototype.toString=function(){return"{ParamType:".concat(this.name,"}")},e.prototype.$normalize=function(e){return this.is(e)?e:this.decode(e)},e.prototype.$asArray=function(e,t){if(!e)return this;if("auto"===e&&!t)throw new Error("'auto' array mode is for query parameters only");return new ut(this,e)},e}();function ut(e,t){var n=this;function o(e){return R(e)?e:_(e)?[e]:[]}function r(e,n){return function(r){if(R(r)&&0===r.length)return r;var i=de(o(r),e);return!0===n?0===le(i,(function(e){return!e})).length:function(e){switch(e.length){case 0:return;case 1:return"auto"===t?e[0]:e;default:return e}}(i)}}function i(e){return function(t,n){var r=o(t),i=o(n);if(r.length!==i.length)return!1;for(var a=0;a<r.length;a++)if(!e(r[a],i[a]))return!1;return!0}}["encode","decode","equals","$normalize"].forEach((function(t){var o=e[t].bind(e),a="equals"===t?i:r;n[t]=a(o)})),V(this,{dynamic:e.dynamic,name:e.name,pattern:e.pattern,inherit:e.inherit,raw:e.raw,is:r(e.is.bind(e),!0),$arrayMode:t})}var dt,pt=Object.prototype.hasOwnProperty,mt=function(e){return 0===["value","type","squash","array","dynamic"].filter(pt.bind(e||{})).length};function ft(e,n,o){var r=!1===o.reloadOnSearch&&n===t.DefType.SEARCH||void 0,i=ce([o.dynamic,r],_),a=_(i)?{dynamic:i}:{},s=function(e){function t(){return e.value}e=mt(e)?{value:e}:e,t.__cacheable=!0;var n=L(e.value)?e.value:t;return V(e,{$$fn:n})}(o&&o.params&&o.params[e]);return V(a,s)}(dt=t.DefType||(t.DefType={}))[dt.PATH=0]="PATH",dt[dt.SEARCH=1]="SEARCH",dt[dt.CONFIG=2]="CONFIG";var ht,gt=function(){function e(e,n,o,r,i){var a=ft(e,o,i);n=function(e,n,o,r,i){if(e.type&&n&&"string"!==n.name)throw new Error("Param '".concat(r,"' has two type configurations."));if(e.type&&n&&"string"===n.name&&i.type(e.type))return i.type(e.type);if(n)return n;if(!e.type){var a=o===t.DefType.CONFIG?"any":o===t.DefType.PATH?"path":o===t.DefType.SEARCH?"query":"string";return i.type(a)}return e.type instanceof ct?e.type:i.type(e.type)}(a,n,o,e,r.paramTypes);var s,c,u=(s={array:o===t.DefType.SEARCH&&"auto"},c=e.match(/\[\]$/)?{array:!0}:{},V(s,c,a).array);n=u?n.$asArray(u,o===t.DefType.SEARCH):n;var d=void 0!==a.value||o===t.DefType.SEARCH,p=_(a.dynamic)?!!a.dynamic:!!n.dynamic,m=_(a.raw)?!!a.raw:!!n.raw,f=function(e,t,n){var o=e.squash;if(!t||!1===o)return!1;if(!_(o)||null==o)return n;if(!0===o||E(o))return o;throw new Error("Invalid squash policy: '".concat(o,"'. Valid policies: false, true, or arbitrary string"))}(a,d,r.defaultSquashPolicy()),h=function(e,t,n,o){var r=[{from:"",to:n||t?void 0:""},{from:null,to:n||t?void 0:""}],i=R(e.replace)?e.replace:[];E(o)&&i.push({from:o,to:void 0});var a=de(i,l("from"));return le(r,(function(e){return-1===a.indexOf(e.from)})).concat(i)}(a,u,d,f),g=_(a.inherit)?!!a.inherit:!!n.inherit;V(this,{id:e,type:n,location:o,isOptional:d,dynamic:p,raw:m,squash:f,replace:h,inherit:g,array:u,config:a})}return e.values=function(e,t){void 0===t&&(t={});for(var n={},o=0,r=e;o<r.length;o++){var i=r[o];n[i.id]=i.value(t[i.id])}return n},e.changed=function(e,t,n){return void 0===t&&(t={}),void 0===n&&(n={}),e.filter((function(e){return!e.type.equals(t[e.id],n[e.id])}))},e.equals=function(t,n,o){return void 0===n&&(n={}),void 0===o&&(o={}),0===e.changed(t,n,o).length},e.validates=function(e,t){return void 0===t&&(t={}),e.map((function(e){return e.validates(t[e.id])})).reduce(me,!0)},e.prototype.isDefaultValue=function(e){return this.isOptional&&this.type.equals(this.value(),e)},e.prototype.value=function(e){var t=this;return e=function(e){for(var n=0,o=t.replace;n<o.length;n++){var r=o[n];if(r.from===e)return r.to}return e}(e),S(e)?function(){if(t._defaultValueCache)return t._defaultValueCache.defaultValue;if(!D.$injector)throw new Error("Injectable functions cannot be called at configuration time");var e=D.$injector.invoke(t.config.$$fn);if(null!=e&&!t.type.is(e))throw new Error("Default value (".concat(e,") for parameter '").concat(t.id,"' is not an instance of ParamType (").concat(t.type.name,")"));return t.config.$$fn.__cacheable&&(t._defaultValueCache={defaultValue:e}),e}():this.type.$normalize(e)},e.prototype.isSearch=function(){return this.location===t.DefType.SEARCH},e.prototype.validates=function(e){if((S(e)||null===e)&&this.isOptional)return!0;var t=this.type.$normalize(e);if(!this.type.is(t))return!1;var n=this.type.encode(t);return!(E(n)&&!this.type.pattern.exec(n))},e.prototype.toString=function(){return"{Param:".concat(this.id," ").concat(this.type," squash: '").concat(this.squash,"' optional: ").concat(this.isOptional,"}")},e}(),vt=function(){function e(){this.enqueue=!0,this.typeQueue=[],this.defaultTypes=ie(e.prototype,["hash","string","query","path","int","bool","date","json","any"]);this.types=K(de(this.defaultTypes,(function(e,t){return new ct(V({name:t},e))})),{})}return e.prototype.dispose=function(){this.types={}},e.prototype.type=function(e,t,n){if(!_(t))return this.types[e];if(this.types.hasOwnProperty(e))throw new Error("A type named '".concat(e,"' has already been defined."));return this.types[e]=new ct(V({name:e},t)),n&&(this.typeQueue.push({name:e,def:n}),this.enqueue||this._flushTypeQueue()),this},e.prototype._flushTypeQueue=function(){for(;this.typeQueue.length;){var e=this.typeQueue.shift();if(e.pattern)throw new Error("You cannot override a type's .pattern at runtime.");V(this.types[e.name],D.$injector.invoke(e.def))}},e}();ht=function(e){var t=function(e){return null!=e?e.toString():e},n={encode:t,decode:t,is:g(String),pattern:/.*/,equals:function(e,t){return e==t}};return V({},n,e)},V(vt.prototype,{string:ht({}),path:ht({pattern:/[^/]*/}),query:ht({}),hash:ht({inherit:!1}),int:ht({decode:function(e){return parseInt(e,10)},is:function(e){return!M(e)&&this.decode(e.toString())===e},pattern:/-?\d+/}),bool:ht({encode:function(e){return e?1:0},decode:function(e){return 0!==parseInt(e,10)},is:g(Boolean),pattern:/0|1/}),date:ht({encode:function(e){return this.is(e)?[e.getFullYear(),("0"+(e.getMonth()+1)).slice(-2),("0"+e.getDate()).slice(-2)].join("-"):void 0},decode:function(e){if(this.is(e))return e;var t=this.capture.exec(e);return t?new Date(t[1],t[2]-1,t[3]):void 0},is:function(e){return e instanceof Date&&!isNaN(e.valueOf())},equals:function(e,t){return["getFullYear","getMonth","getDate"].reduce((function(n,o){return n&&e[o]()===t[o]()}),!0)},pattern:/[0-9]{4}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[1-2][0-9]|3[0-1])/,capture:/([0-9]{4})-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])/}),json:ht({encode:B,decode:F,is:g(Object),equals:q,pattern:/[^/]*/}),any:ht({encode:z,decode:z,is:function(){return!0},equals:q})});var bt=function(){function e(e){void 0===e&&(e={}),V(this,e)}return e.prototype.$inherit=function(e,t,n){var o=re(t,n),r={},i=[];for(var a in o)if(o[a]&&o[a].params){var s=o[a].params,l=Object.keys(s);if(l.length)for(var c in l)!l.hasOwnProperty(c)||0==s[l[c]].inherit||i.indexOf(l[c])>=0||(i.push(l[c]),r[l[c]]=this[l[c]])}return V({},r,e)},e}(),yt=function(){function e(t){if(t instanceof e){var n=t;this.state=n.state,this.paramSchema=n.paramSchema.slice(),this.paramValues=V({},n.paramValues),this.resolvables=n.resolvables.slice(),this.views=n.views&&n.views.slice()}else{var o=t;this.state=o,this.paramSchema=o.parameters({inherit:!1}),this.paramValues={},this.resolvables=o.resolvables.map((function(e){return e.clone()}))}}return e.prototype.clone=function(){return new e(this)},e.prototype.applyRawParams=function(e){return this.paramValues=this.paramSchema.reduce((function(t,n){return Me(t,[(o=n).id,o.value(e[o.id])]);var o}),{}),this},e.prototype.parameter=function(e){return ce(this.paramSchema,c("id",e))},e.prototype.equals=function(e,t){var n=this.diff(e,t);return n&&0===n.length},e.prototype.diff=function(e,t){if(this.state!==e.state)return!1;var n=t?t(this):this.paramSchema;return gt.changed(n,this.paramValues,e.paramValues)},e.clone=function(e){return e.clone()},e}(),wt=function(){function e(e,t,n,o){this._stateRegistry=e,this._identifier=t,this._identifier=t,this._params=V({},n||{}),this._options=V({},o||{}),this._definition=e.matcher.find(t,this._options.relative)}return e.prototype.name=function(){return this._definition&&this._definition.name||this._identifier},e.prototype.identifier=function(){return this._identifier},e.prototype.params=function(){return this._params},e.prototype.$state=function(){return this._definition},e.prototype.state=function(){return this._definition&&this._definition.self},e.prototype.options=function(){return this._options},e.prototype.exists=function(){return!(!this._definition||!this._definition.self)},e.prototype.valid=function(){return!this.error()},e.prototype.error=function(){var e=this.options().relative;if(!this._definition&&e){var t=e.name?e.name:e;return"Could not resolve '".concat(this.name(),"' from state '").concat(t,"'")}return this._definition?this._definition.self?void 0:"State '".concat(this.name(),"' has an invalid definition"):"No such state '".concat(this.name(),"'")},e.prototype.toString=function(){return"'".concat(this.name(),"'").concat(Ve(this.params()))},e.prototype.withState=function(t){return new e(this._stateRegistry,t,this._params,this._options)},e.prototype.withParams=function(t,n){void 0===n&&(n=!1);var o=n?t:V({},this._params,t);return new e(this._stateRegistry,this._identifier,o,this._options)},e.prototype.withOptions=function(t,n){void 0===n&&(n=!1);var o=n?t:V({},this._options,t);return new e(this._stateRegistry,this._identifier,this._params,o)},e.isDef=function(e){return e&&e.state&&(E(e.state)||I(e.state)&&E(e.state.name))},e}(),$t=function(){function e(){}return e.makeTargetState=function(e,t){var n=Te(t).state;return new wt(e,n,t.map(l("paramValues")).reduce(oe,{}),{})},e.buildPath=function(e){var t=e.params();return e.$state().path.map((function(e){return new yt(e).applyRawParams(t)}))},e.buildToPath=function(t,n){var o=e.buildPath(n);return n.options().inherit?e.inheritParams(t,o,Object.keys(n.params())):o},e.applyViewConfigs=function(t,n,o){n.filter((function(e){return Y(o,e.state)})).forEach((function(o){var r=pe(o.state.views||{}),i=e.subPath(n,(function(e){return e===o})),a=r.map((function(e){return t.createViewConfig(i,e)}));o.views=a.reduce(he,[])}))},e.inheritParams=function(e,t,n){void 0===n&&(n=[]);var o=e.map((function(e){return e.paramSchema})).reduce(he,[]).filter((function(e){return!e.inherit})).map(l("id"));return t.map((function(t){var r=V({},t&&t.paramValues),i=ie(r,n);r=ae(r,n);var a,s,l,u=ae((a=e,s=t.state,l=ce(a,c("state",s)),V({},l&&l.paramValues)||{}),o),d=V(r,u,i);return new yt(t.state).applyRawParams(d)}))},e.treeChanges=function(t,n,o){for(var r,i,a,s,l=Math.min(t.length,n.length),c=0;c<l&&t[c].state!==o&&(u=t[c],d=n[c],u.equals(d,e.nonDynamicParams));)c++;var u,d;i=(r=t).slice(0,c),a=r.slice(c);var p=i.map((function(e,t){var o=e.clone();return o.paramValues=n[t].paramValues,o}));return s=n.slice(c),{from:r,to:p.concat(s),retained:i,retainedWithToParams:p,exiting:a,entering:s}},e.matching=function(e,t,n){var o=!1;return Pe(e,t).reduce((function(e,t){var r=t[0],i=t[1];return(o=o||!r.equals(i,n))?e:e.concat(r)}),[])},e.equals=function(t,n,o){return t.length===n.length&&e.matching(t,n,o).length===t.length},e.subPath=function(e,t){var n=ce(e,t),o=e.indexOf(n);return-1===o?void 0:e.slice(0,o+1)},e.nonDynamicParams=function(e){return e.state.parameters({inherit:!1}).filter((function(e){return!e.dynamic}))},e.paramValues=function(e){return e.reduce((function(e,t){return V(e,t.paramValues)}),{})},e}(),kt={when:{LAZY:"LAZY",EAGER:"EAGER"},async:{WAIT:"WAIT",NOWAIT:"NOWAIT"}},St={when:"LAZY",async:"WAIT"},_t=function(){function e(t,n,o,r,i){if(this.resolved=!1,this.promise=void 0,t instanceof e)V(this,t);else if(T(n)){if(M(t))throw new Error("new Resolvable(): token argument is required");if(!T(n))throw new Error("new Resolvable(): resolveFn argument must be a function");this.token=t,this.policy=r,this.resolveFn=n,this.deps=o||[],this.data=i,this.resolved=void 0!==i,this.promise=this.resolved?D.$q.when(this.data):void 0}else if(I(t)&&t.token&&(t.hasOwnProperty("resolveFn")||t.hasOwnProperty("data"))){var a=t;return new e(a.token,a.resolveFn,a.deps,a.policy,a.data)}}return e.prototype.getPolicy=function(e){var t=this.policy||{},n=e&&e.resolvePolicy||{};return{when:t.when||n.when||St.when,async:t.async||n.async||St.async}},e.prototype.resolve=function(e,t){var n=this,o=D.$q,r=e.findNode(this),i=r&&r.state,a=this.getPolicy(i).async,s=T(a)?a:z;return this.promise=o.when().then((function(){return o.all(e.getDependencies(n).map((function(n){return n.get(e,t)})))})).then((function(e){return n.resolveFn.apply(null,e)})).then(s).then((function(e){return n.data=e,n.resolved=!0,n.resolveFn=null,lt.traceResolvableResolved(n,t),n.data}))},e.prototype.get=function(e,t){return this.promise||this.resolve(e,t)},e.prototype.toString=function(){return"Resolvable(token: ".concat(Ve(this.token),", requires: [").concat(this.deps.map(Ve),"])")},e.prototype.clone=function(){return new e(this)},e.fromData=function(t,n){return new e(t,(function(){return n}),null,null,n)},e}(),Pt=kt.when,Mt=[Pt.EAGER,Pt.LAZY],Tt=[Pt.EAGER],Ct="Native Injector",Et=function(){function e(e){this._path=e}return e.prototype.getTokens=function(){return this._path.reduce((function(e,t){return e.concat(t.resolvables.map((function(e){return e.token})))}),[]).reduce(be,[])},e.prototype.getResolvable=function(e){return Te(this._path.map((function(e){return e.resolvables})).reduce(he,[]).filter((function(t){return t.token===e})))},e.prototype.getPolicy=function(e){var t=this.findNode(e);return e.getPolicy(t.state)},e.prototype.subContext=function(t){return new e($t.subPath(this._path,(function(e){return e.state===t})))},e.prototype.addResolvables=function(e,t){var n=ce(this._path,c("state",t)),o=e.map((function(e){return e.token}));n.resolvables=n.resolvables.filter((function(e){return-1===o.indexOf(e.token)})).concat(e)},e.prototype.resolvePath=function(e,t){var n=this;void 0===e&&(e="LAZY");var o=(Y(Mt,e)?e:"LAZY")===kt.when.EAGER?Tt:Mt;lt.traceResolvePath(this._path,e,t);var r=function(e,t){return function(o){return Y(e,n.getPolicy(o)[t])}},i=this._path.reduce((function(e,i){var a=i.resolvables.filter(r(o,"when")),s=a.filter(r(["NOWAIT"],"async")),l=a.filter(d(r(["NOWAIT"],"async"))),c=n.subContext(i.state),u=function(e){return e.get(c,t).then((function(t){return{token:e.token,value:t}}))};return s.forEach(u),e.concat(l.map(u))}),[]);return D.$q.all(i)},e.prototype.injector=function(){return this._injector||(this._injector=new It(this))},e.prototype.findNode=function(e){return ce(this._path,(function(t){return Y(t.resolvables,e)}))},e.prototype.getDependencies=function(e){var t=this,n=this.findNode(e),o=$t.subPath(this._path,(function(e){return e===n}))||this._path,r=o.reduce((function(e,t){return e.concat(t.resolvables)}),[]).filter((function(t){return t!==e}));return e.deps.map((function(e){var n=r.filter((function(t){return t.token===e}));if(n.length)return Te(n);var o=t.injector().getNative(e);if(S(o))throw new Error("Could not find Dependency Injection token: "+Ve(e));return new _t(e,(function(){return o}),[],o)}))},e}(),It=function(){function e(e){this.context=e,this.native=this.get(Ct)||D.$injector}return e.prototype.get=function(e){var t=this.context.getResolvable(e);if(t){if("NOWAIT"===this.context.getPolicy(t).async)return t.get(this.context);if(!t.resolved)throw new Error("Resolvable async .get() not complete:"+Ve(t.token));return t.data}return this.getNative(e)},e.prototype.getAsync=function(e){var t=this.context.getResolvable(e);return t?t.get(this.context):D.$q.when(this.native.get(e))},e.prototype.getNative=function(e){return this.native&&this.native.get(e)},e}();function Rt(e){return e.name}function At(e){return e.self.$$state=function(){return e},e.self}function xt(e){return e.parent&&e.parent.data&&(e.data=e.self.data=K(e.parent.data,e.data)),e.data}var Lt=function(e,t){return function(n){var o=n.self;if(o&&o.url&&o.name&&o.name.match(/\.\*\*$/)){var r={};Ce(o,r),r.url+="{remainder:any}",o=r}var i=n.parent,a=function(e){if(!E(e))return!1;var t="^"===e.charAt(0);return{val:t?e.substring(1):e,root:t}}(o.url),s=a?e.compile(a.val,{state:o}):o.url;if(!s)return null;if(!e.isMatcher(s))throw new Error("Invalid url '".concat(s,"' in state '").concat(n,"'"));return a&&a.root?s:(i&&i.navigable||t()).url.append(s)}},Ot=function(e){return function(t){return!e(t)&&t.url?t:t.parent?t.parent.navigable:null}};function jt(e){return e.parent?e.parent.path.concat(e):[e]}function Dt(e){var t=e.parent?V({},e.parent.includes):{};return t[e.name]=!0,t}function Nt(e){var t=function(e){return e.provide||e.token},n=w([[l("resolveFn"),function(e){return new _t(t(e),e.resolveFn,e.deps,e.policy)}],[l("useFactory"),function(e){return new _t(t(e),e.useFactory,e.deps||e.dependencies,e.policy)}],[l("useClass"),function(e){return new _t(t(e),(function(){return new e.useClass}),[],e.policy)}],[l("useValue"),function(e){return new _t(t(e),(function(){return e.useValue}),[],e.policy,e.useValue)}],[l("useExisting"),function(e){return new _t(t(e),z,[e.useExisting],e.policy)}]]),o=w([[s(l("val"),E),function(e){return new _t(e.token,z,[e.val],e.policy)}],[s(l("val"),R),function(e){return new _t(e.token,Te(e.val),e.val.slice(0,-1),e.policy)}],[s(l("val"),T),function(e){return new _t(e.token,e.val,function(e){var t=D.$injector;return e.$inject||t&&t.annotate(e,t.strictDi)||"deferred"}(e.val),e.policy)}]]),r=w([[g(_t),function(e){return e}],[function(e){return!(!e.token||!e.resolveFn)},n],[function(e){return!(!e.provide&&!e.token||!(e.useValue||e.useFactory||e.useExisting||e.useClass))},n],[function(e){return!!(e&&e.val&&(E(e.val)||R(e.val)||T(e.val)))},o],[b(!0),function(e){throw new Error("Invalid resolve value: "+Ve(e))}]]),i=e.resolve;return(R(i)?i:function(e,t){return Object.keys(e||{}).map((function(n){return{token:n,val:e[n],deps:void 0,policy:t[n]}}))}(i,e.resolvePolicy||{})).map(r)}var Ut,Ft,Bt=function(){function e(e,t){this.matcher=e;var n,o=this,r=function(){return e.find("")},i=function(e){return""===e.name};this.builders={name:[Rt],self:[At],parent:[function(t){return i(t)?null:e.find(o.parentName(t))||r()}],data:[xt],url:[Lt(t,r)],navigable:[Ot(i)],params:[(n=t.paramFactory,function(e){var t=e.url&&e.url.parameters({inherit:!1})||[],o=pe(ue(ae(e.params||{},t.map(l("id"))),(function(t,o){return n.fromConfig(o,null,e.self)})));return t.concat(o).map((function(e){return[e.id,e]})).reduce(Me,{})})],views:[],path:[jt],includes:[Dt],resolvables:[Nt]}}return e.prototype.builder=function(e,t){var n=this.builders,o=n[e]||[];return E(e)&&!_(t)?o.length>1?o:o[0]:E(e)&&T(t)?(n[e]=o,n[e].push(t),function(){return n[e].splice(n[e].indexOf(t,1))&&null}):void 0},e.prototype.build=function(e){var t=this.matcher,n=this.builders,o=this.parentName(e);if(o&&!t.find(o,void 0,!1))return null;for(var r in n)if(n.hasOwnProperty(r)){var i=n[r].reduce((function(e,t){return function(n){return t(n,e)}}),H);e[r]=i(e)}return e},e.prototype.parentName=function(e){var t=e.name||"",n=t.split(".");if("**"===n.pop()&&n.pop(),n.length){if(e.parent)throw new Error("States that specify the 'parent:' property should not have a '.' in their name (".concat(t,")"));return n.join(".")}return e.parent?E(e.parent)?e.parent:e.parent.name:""},e.prototype.name=function(e){var t=e.name;if(-1!==t.indexOf(".")||!e.parent)return t;var n=E(e.parent)?e.parent:e.parent.name;return n?n+"."+t:t},e}(),Wt=function(){function e(t){return e.create(t||{})}return e.create=function(t){t=e.isStateClass(t)?new t:t;var n=K(K(t,e.prototype));return t.$$state=function(){return n},n.self=t,n.__stateObjectCache={nameGlob:Le.fromString(n.name)},n},e.prototype.is=function(e){return this===e||this.self===e||this.fqn()===e},e.prototype.fqn=function(){if(!(this.parent&&this.parent instanceof this.constructor))return this.name;var e=this.parent.fqn();return e?e+"."+this.name:this.name},e.prototype.root=function(){return this.parent&&this.parent.root()||this},e.prototype.parameters=function(e){return((e=ne(e,{inherit:!0,matchingKeys:null})).inherit&&this.parent&&this.parent.parameters()||[]).concat(pe(this.params)).filter((function(t){return!e.matchingKeys||e.matchingKeys.hasOwnProperty(t.id)}))},e.prototype.parameter=function(e,t){return void 0===t&&(t={}),this.url&&this.url.parameter(e,t)||ce(pe(this.params),c("id",e))||t.inherit&&this.parent&&this.parent.parameter(e)},e.prototype.toString=function(){return this.fqn()},e.isStateClass=function(e){return T(e)&&!0===e.__uiRouterState},e.isStateDeclaration=function(e){return T(e.$$state)},e.isState=function(e){return I(e.__stateObjectCache)},e}(),Vt=function(){function e(e){this._states=e}return e.prototype.isRelative=function(e){return 0===(e=e||"").indexOf(".")||0===e.indexOf("^")},e.prototype.find=function(e,t,n){if(void 0===n&&(n=!0),e||""===e){var o=E(e),r=o?e:e.name;this.isRelative(r)&&(r=this.resolvePath(r,t));var i=this._states[r];if(i&&(o||!(o||i!==e&&i.self!==e)))return i;if(o&&n){var a=pe(this._states).filter((function(e){return e.__stateObjectCache.nameGlob&&e.__stateObjectCache.nameGlob.matches(r)}));return a.length>1&&et.error("stateMatcher.find: Found multiple matches for ".concat(r," using glob: "),a.map((function(e){return e.name}))),a[0]}}},e.prototype.resolvePath=function(e,t){if(!t)throw new Error("No reference point given for path '".concat(e,"'"));for(var n=this.find(t),o=e.split("."),r=o.length,i=0,a=n;i<r;i++)if(""!==o[i]||0!==i){if("^"!==o[i])break;if(!a.parent)throw new Error("Path '".concat(e,"' not valid for state '").concat(n.name,"'"));a=a.parent}else a=n;var s=o.slice(i).join(".");return a.name+(a.name&&s?".":"")+s},e}(),qt=function(){function e(e,t,n,o){this.router=e,this.states=t,this.builder=n,this.listeners=o,this.queue=[]}return e.prototype.dispose=function(){this.queue=[]},e.prototype.register=function(e){var t=this.queue,n=Wt.create(e),o=n.name;if(!E(o))throw new Error("State must have a valid name");if(this.states.hasOwnProperty(o)||Y(t.map(l("name")),o))throw new Error("State '".concat(o,"' is already defined"));return t.push(n),this.flush(),n},e.prototype.flush=function(){for(var e=this,t=this,n=t.queue,o=t.states,r=t.builder,i=[],a=[],s={},l=function(t){return e.states.hasOwnProperty(t)&&e.states[t]},c=function(){i.length&&e.listeners.forEach((function(e){return e("registered",i.map((function(e){return e.self})))}))};n.length>0;){var u=n.shift(),d=u.name,p=r.build(u),m=a.indexOf(u);if(p){var f=l(d);if(f&&f.name===d)throw new Error("State '".concat(d,"' is already defined"));var h=l(d+".**");h&&this.router.stateRegistry.deregister(h),o[d]=u,this.attachRoute(u),m>=0&&a.splice(m,1),i.push(u)}else{var g=s[d];if(s[d]=n.length,m>=0&&g===n.length)return n.push(u),c(),o;m<0&&a.push(u),n.push(u)}}return c(),o},e.prototype.attachRoute=function(e){if(!e.abstract&&e.url){var t=this.router.urlService.rules;t.rule(t.urlRuleFactory.create(e))}},e}(),zt=function(){function e(e){this.router=e,this.states={},this.listeners=[],this.matcher=new Vt(this.states),this.builder=new Bt(this.matcher,e.urlMatcherFactory),this.stateQueue=new qt(e,this.states,this.builder,this.listeners),this._registerRoot()}return e.prototype._registerRoot=function(){(this._root=this.stateQueue.register({name:"",url:"^",views:null,params:{"#":{value:null,type:"hash",dynamic:!0}},abstract:!0})).navigable=null},e.prototype.dispose=function(){var e=this;this.stateQueue.dispose(),this.listeners=[],this.get().forEach((function(t){return e.get(t)&&e.deregister(t)}))},e.prototype.onStatesChanged=function(e){return this.listeners.push(e),function(){X(this.listeners)(e)}.bind(this)},e.prototype.root=function(){return this._root},e.prototype.register=function(e){return this.stateQueue.register(e)},e.prototype._deregisterTree=function(e){var t=this,n=this.get().map((function(e){return e.$$state()})),o=function(e){var t=n.filter((function(t){return-1!==e.indexOf(t.parent)}));return 0===t.length?t:t.concat(o(t))},r=o([e]),i=[e].concat(r).reverse();return i.forEach((function(e){var n=t.router.urlService.rules;n.rules().filter(c("state",e)).forEach((function(e){return n.removeRule(e)})),delete t.states[e.name]})),i},e.prototype.deregister=function(e){var t=this.get(e);if(!t)throw new Error("Can't deregister state; not found: "+e);var n=this._deregisterTree(t.$$state());return this.listeners.forEach((function(e){return e("deregistered",n.map((function(e){return e.self})))})),n},e.prototype.get=function(e,t){var n=this;if(0===arguments.length)return Object.keys(this.states).map((function(e){return n.states[e].self}));var o=this.matcher.find(e,t);return o&&o.self||null},e.prototype.decorator=function(e,t){return this.builder.builder(e,t)},e}();(Ft=t.TransitionHookPhase||(t.TransitionHookPhase={}))[Ft.CREATE=0]="CREATE",Ft[Ft.BEFORE=1]="BEFORE",Ft[Ft.RUN=2]="RUN",Ft[Ft.SUCCESS=3]="SUCCESS",Ft[Ft.ERROR=4]="ERROR",(Ut=t.TransitionHookScope||(t.TransitionHookScope={}))[Ut.TRANSITION=0]="TRANSITION",Ut[Ut.STATE=1]="STATE";var Ht={current:H,transition:null,traceData:{},bind:null},Gt=function(){function e(e,n,o,r){var i=this;this.transition=e,this.stateContext=n,this.registeredHook=o,this.options=r,this.isSuperseded=function(){return i.type.hookPhase===t.TransitionHookPhase.RUN&&!i.options.transition.isActive()},this.options=ne(r,Ht),this.type=o.eventType}return e.chain=function(e,t){return e.reduce((function(e,t){return e.then((function(){return t.invokeHook()}))}),t||D.$q.when())},e.invokeHooks=function(t,n){for(var o=0;o<t.length;o++){var r=t[o].invokeHook();if(O(r)){var i=t.slice(o+1);return e.chain(i,r).then(n)}}return n()},e.runAllHooks=function(e){e.forEach((function(e){return e.invokeHook()}))},e.prototype.logError=function(e){this.transition.router.stateService.defaultErrorHandler()(e)},e.prototype.invokeHook=function(){var e=this,t=this.registeredHook;if(!t._deregistered){var n=this.getNotCurrentRejection();if(n)return n;var o=this.options;lt.traceHookInvocation(this,this.transition,o);var r=function(n){return t.eventType.getErrorHandler(e)(n)},i=function(n){return t.eventType.getResultHandler(e)(n)};try{var a=t.callback.call(o.bind,e.transition,e.stateContext);return!this.type.synchronous&&O(a)?a.catch((function(e){return De.normalize(e).toPromise()})).then(i,r):i(a)}catch(e){return r(De.normalize(e))}finally{t.invokeLimit&&++t.invokeCount>=t.invokeLimit&&t.deregister()}}},e.prototype.handleHookResult=function(e){var t=this;return this.getNotCurrentRejection()||(O(e)?e.then((function(e){return t.handleHookResult(e)})):(lt.traceHookResult(e,this.transition,this.options),!1===e?De.aborted("Hook aborted transition").toPromise():g(wt)(e)?De.redirected(e).toPromise():void 0))},e.prototype.getNotCurrentRejection=function(){var e=this.transition.router;return e._disposed?De.aborted("UIRouter instance #".concat(e.$id," has been stopped (disposed)")).toPromise():this.transition._aborted?De.aborted().toPromise():this.isSuperseded()?De.superseded(this.options.current()).toPromise():void 0},e.prototype.toString=function(){var e=this.options,t=this.registeredHook,n=u("traceData.hookType")(e)||"internal",o=u("traceData.context.state.name")(e)||u("traceData.context")(e)||"unknown",r=We(t.callback);return"".concat(n," context: ").concat(o,", ").concat(Ne(200,r))},e.HANDLE_RESULT=function(e){return function(t){return e.handleHookResult(t)}},e.LOG_REJECTED_RESULT=function(e){return function(t){O(t)&&t.catch((function(t){return e.logError(De.normalize(t))}))}},e.LOG_ERROR=function(e){return function(t){return e.logError(t)}},e.REJECT_ERROR=function(e){return function(e){return xe(e)}},e.THROW_ERROR=function(e){return function(e){throw e}},e}();function Kt(e,t,n){var o=E(t)?[t]:t;return!!(T(o)?o:function(e){for(var t=o,n=0;n<t.length;n++){var r=new Le(t[n]);if(r&&r.matches(e.name)||!r&&t[n]===e.name)return!0}return!1})(e,n)}var Yt=function(){function e(e,t,n,o,r,i){void 0===i&&(i={}),this.tranSvc=e,this.eventType=t,this.callback=n,this.matchCriteria=o,this.removeHookFromRegistry=r,this.invokeCount=0,this._deregistered=!1,this.priority=i.priority||0,this.bind=i.bind||null,this.invokeLimit=i.invokeLimit}return e.prototype._matchingNodes=function(e,t,n){if(!0===t)return e;var o=e.filter((function(e){return Kt(e.state,t,n)}));return o.length?o:null},e.prototype._getDefaultMatchCriteria=function(){return ue(this.tranSvc._pluginapi._getPathTypes(),(function(){return!0}))},e.prototype._getMatchingNodes=function(e,n){var o=this,r=V(this._getDefaultMatchCriteria(),this.matchCriteria);return pe(this.tranSvc._pluginapi._getPathTypes()).reduce((function(i,a){var s=a.scope===t.TransitionHookScope.STATE,l=e[a.name]||[],c=s?l:[Te(l)];return i[a.name]=o._matchingNodes(c,r[a.name],n),i}),{})},e.prototype.matches=function(e,t){var n=this._getMatchingNodes(e,t);return pe(n).every(z)?n:null},e.prototype.deregister=function(){this.removeHookFromRegistry(this),this._deregistered=!0},e}();function Jt(e,t,n){var o=(e._registeredHooks=e._registeredHooks||{})[n.name]=[],r=X(o);function i(e,i,a){void 0===a&&(a={});var s=new Yt(t,n,i,e,r,a);return o.push(s),s.deregister.bind(s)}return e[n.name]=i,i}var Xt=function(){function e(e){this.transition=e}return e.prototype.buildHooksForPhase=function(e){var t=this;return this.transition.router.transitionService._pluginapi._getEvents(e).map((function(e){return t.buildHooks(e)})).reduce(he,[]).filter(z)},e.prototype.buildHooks=function(e){var n=this.transition,o=n.treeChanges(),r=this.getMatchingHooks(e,o,n);if(!r)return[];var i,a={transition:n,current:n.options().current};return r.map((function(r){return r.matches(o,n)[e.criteriaMatchPath.name].map((function(o){var i=V({bind:r.bind,traceData:{hookType:e.name,context:o}},a),s=e.criteriaMatchPath.scope===t.TransitionHookScope.STATE?o.state.self:null,l=new Gt(n,s,r,i);return{hook:r,node:o,transitionHook:l}}))})).reduce(he,[]).sort((i=e.reverseSort,void 0===i&&(i=!1),function(e,t){var n=i?-1:1,o=(e.node.state.path.length-t.node.state.path.length)*n;return 0!==o?o:t.hook.priority-e.hook.priority})).map((function(e){return e.transitionHook}))},e.prototype.getMatchingHooks=function(e,n,o){var r=e.hookPhase===t.TransitionHookPhase.CREATE,i=this.transition.router.transitionService;return(r?[i]:[this.transition,i]).map((function(t){return t.getHooks(e.name)})).filter($e(R,"broken event named: ".concat(e.name))).reduce(he,[]).filter((function(e){return e.matches(n,o)}))},e}();var Zt=l("self"),Qt=function(){function e(e,n,o){var r=this;if(this._deferred=D.$q.defer(),this.promise=this._deferred.promise,this._registeredHooks={},this._hookBuilder=new Xt(this),this.isActive=function(){return r.router.globals.transition===r},this.router=o,this._targetState=n,!n.valid())throw new Error(n.error());this._options=V({current:b(this)},n.options()),this.$id=o.transitionService._transitionCount++;var i=$t.buildToPath(e,n);this._treeChanges=$t.treeChanges(e,i,this._options.reloadState),this.createTransitionHookRegFns();var a=this._hookBuilder.buildHooksForPhase(t.TransitionHookPhase.CREATE);Gt.invokeHooks(a,(function(){return null})),this.applyViewConfigs(o)}return e.prototype.onBefore=function(e,t,n){},e.prototype.onStart=function(e,t,n){},e.prototype.onExit=function(e,t,n){},e.prototype.onRetain=function(e,t,n){},e.prototype.onEnter=function(e,t,n){},e.prototype.onFinish=function(e,t,n){},e.prototype.onSuccess=function(e,t,n){},e.prototype.onError=function(e,t,n){},e.prototype.createTransitionHookRegFns=function(){var e=this;this.router.transitionService._pluginapi._getEvents().filter((function(e){return e.hookPhase!==t.TransitionHookPhase.CREATE})).forEach((function(t){return Jt(e,e.router.transitionService,t)}))},e.prototype.getHooks=function(e){return this._registeredHooks[e]},e.prototype.applyViewConfigs=function(e){var t=this._treeChanges.entering.map((function(e){return e.state}));$t.applyViewConfigs(e.transitionService.$view,this._treeChanges.to,t)},e.prototype.$from=function(){return Te(this._treeChanges.from).state},e.prototype.$to=function(){return Te(this._treeChanges.to).state},e.prototype.from=function(){return this.$from().self},e.prototype.to=function(){return this.$to().self},e.prototype.targetState=function(){return this._targetState},e.prototype.is=function(t){return t instanceof e?this.is({to:t.$to().name,from:t.$from().name}):!(t.to&&!Kt(this.$to(),t.to,this)||t.from&&!Kt(this.$from(),t.from,this))},e.prototype.params=function(e){return void 0===e&&(e="to"),Object.freeze(this._treeChanges[e].map(l("paramValues")).reduce(oe,{}))},e.prototype.paramsChanged=function(){var e=this.params("from"),t=this.params("to"),n=[].concat(this._treeChanges.to).concat(this._treeChanges.from).map((function(e){return e.paramSchema})).reduce(ge,[]).reduce(be,[]);return gt.changed(n,e,t).reduce((function(e,n){return e[n.id]=t[n.id],e}),{})},e.prototype.injector=function(e,t){void 0===t&&(t="to");var n=this._treeChanges[t];return e&&(n=$t.subPath(n,(function(t){return t.state===e||t.state.name===e}))),new Et(n).injector()},e.prototype.getResolveTokens=function(e){return void 0===e&&(e="to"),new Et(this._treeChanges[e]).getTokens()},e.prototype.addResolvable=function(e,t){void 0===t&&(t=""),e=g(_t)(e)?e:new _t(e);var n="string"==typeof t?t:t.name,o=this._treeChanges.to,r=ce(o,(function(e){return e.state.name===n}));new Et(o).addResolvables([e],r.state)},e.prototype.redirectedFrom=function(){return this._options.redirectedFrom||null},e.prototype.originalTransition=function(){var e=this.redirectedFrom();return e&&e.originalTransition()||this},e.prototype.options=function(){return this._options},e.prototype.entering=function(){return de(this._treeChanges.entering,l("state")).map(Zt)},e.prototype.exiting=function(){return de(this._treeChanges.exiting,l("state")).map(Zt).reverse()},e.prototype.retained=function(){return de(this._treeChanges.retained,l("state")).map(Zt)},e.prototype.views=function(e,t){void 0===e&&(e="entering");var n=this._treeChanges[e];return(n=t?n.filter(c("state",t)):n).map(l("views")).filter(z).reduce(he,[])},e.prototype.treeChanges=function(e){return e?this._treeChanges[e]:this._treeChanges},e.prototype.redirect=function(e){for(var t=1,n=this;null!=(n=n.redirectedFrom());)if(++t>20)throw new Error("Too many consecutive Transition redirects (20+)");var o={redirectedFrom:this,source:"redirect"};"url"===this.options().source&&!1!==e.options().location&&(o.location="replace");var r=V({},this.options(),e.options(),o);e=e.withOptions(r,!0);var i,a=this.router.transitionService.create(this._treeChanges.from,e),s=this._treeChanges.entering,l=a._treeChanges.entering;return $t.matching(l,s,$t.nonDynamicParams).filter(d((i=e.options().reloadState,function(e){return i&&e.state.includes[i.name]}))).forEach((function(e,t){e.resolvables=s[t].resolvables})),a},e.prototype._changedParams=function(){var e=this._treeChanges;if(!(this._options.reload||e.exiting.length||e.entering.length||e.to.length!==e.from.length||Pe(e.to,e.from).map((function(e){return e[0].state!==e[1].state})).reduce(fe,!1))){var t=e.to.map((function(e){return e.paramSchema})),n=[e.to,e.from].map((function(e){return e.map((function(e){return e.paramValues}))}));return Pe(t,n[0],n[1]).map((function(e){var t=e[0],n=e[1],o=e[2];return gt.changed(t,n,o)})).reduce(he,[])}},e.prototype.dynamic=function(){var e=this._changedParams();return!!e&&e.map((function(e){return e.dynamic})).reduce(fe,!1)},e.prototype.ignored=function(){return!!this._ignoredReason()},e.prototype._ignoredReason=function(){var e=this.router.globals.transition,t=this._options.reloadState,n=function(e,n){if(e.length!==n.length)return!1;var o=$t.matching(e,n);return e.length===o.filter((function(e){return!t||!e.state.includes[t.name]})).length},o=this.treeChanges(),r=e&&e.treeChanges();return r&&n(r.to,o.to)&&n(r.exiting,o.exiting)?"SameAsPending":0===o.exiting.length&&0===o.entering.length&&n(o.from,o.to)?"SameAsCurrent":void 0},e.prototype.run=function(){var e=this,n=Gt.runAllHooks,o=function(t){return e._hookBuilder.buildHooksForPhase(t)},r=o(t.TransitionHookPhase.BEFORE);return Gt.invokeHooks(r,(function(){var t=e.router.globals;return t.lastStartedTransitionId=e.$id,t.transition=e,t.transitionHistory.enqueue(e),lt.traceTransitionStart(e),D.$q.when(void 0)})).then((function(){var e=o(t.TransitionHookPhase.RUN);return Gt.invokeHooks(e,(function(){return D.$q.when(void 0)}))})).then((function(){lt.traceSuccess(e.$to(),e),e.success=!0,e._deferred.resolve(e.to()),n(o(t.TransitionHookPhase.SUCCESS))}),(function(r){lt.traceError(r,e),e.success=!1,e._deferred.reject(r),e._error=r,n(o(t.TransitionHookPhase.ERROR))})),this.promise},e.prototype.valid=function(){return!this.error()||void 0!==this.success},e.prototype.abort=function(){S(this.success)&&(this._aborted=!0)},e.prototype.error=function(){var e=this.$to();if(e.self.abstract)return De.invalid("Cannot transition to abstract state '".concat(e.name,"'"));var t=e.parameters(),n=this.params(),o=t.filter((function(e){return!e.validates(n[e.id])}));if(o.length){var r=o.map((function(e){return"[".concat(e.id,":").concat(Ve(n[e.id]),"]")})).join(", "),i="The following parameter values are not valid for state '".concat(e.name,"': ").concat(r);return De.invalid(i)}return!1===this.success?this._error:void 0},e.prototype.toString=function(){var e=this.from(),t=this.to(),n=function(e){return null!==e["#"]&&void 0!==e["#"]?e:ae(e,["#"])},o=this.$id,r=I(e)?e.name:e,i=Ve(n(this._treeChanges.from.map(l("paramValues")).reduce(oe,{}))),a=this.valid()?"":"(X) ",s=I(t)?t.name:t,c=Ve(n(this.params()));return"Transition#".concat(o,"( '").concat(r,"'").concat(i," -> ").concat(a,"'").concat(s,"'").concat(c," )")},e.diToken=e,e}();function en(e,t){var n=["",""],o=e.replace(/[\\\[\]\^$*+?.()|{}]/g,"\\$&");if(!t)return o;switch(t.squash){case!1:n=["(",")"+(t.isOptional?"?":"")];break;case!0:o=o.replace(/\/$/,""),n=["(?:/(",")|/)?"];break;default:n=["(".concat(t.squash,"|"),")?"]}return o+n[0]+t.type.pattern.source+n[1]}var tn=Xe("/"),nn={state:{params:{}},strict:!0,caseInsensitive:!0,decodeParams:!0},on=function(){function e(t,n,o,r){var i=this;this._cache={path:[this]},this._children=[],this._params=[],this._segments=[],this._compiled=[],this.config=r=ne(r,nn),this.pattern=t;for(var a,s,l,u=/([:*])([\w\[\]]+)|\{([\w\[\]]+)(?:\:\s*((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,d=/([:]?)([\w\[\].-]+)|\{([\w\[\].-]+)(?:\:\s*((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,p=[],m=0,f=function(n){if(!e.nameValidator.test(n))throw new Error("Invalid parameter name '".concat(n,"' in pattern '").concat(t,"'"));if(ce(i._params,c("id",n)))throw new Error("Duplicate parameter name '".concat(n,"' in pattern '").concat(t,"'"))},h=function(e,o){var r,a=e[2]||e[3],s=o?e[4]:e[4]||("*"===e[1]?"[\\s\\S]*":null);return{id:a,regexp:s,segment:t.substring(m,e.index),type:s?n.type(s)||(r=s,K(n.type(o?"query":"path"),{pattern:new RegExp(r,i.config.caseInsensitive?"i":void 0)})):null}};(a=u.exec(t))&&!((s=h(a,!1)).segment.indexOf("?")>=0);)f(s.id),this._params.push(o.fromPath(s.id,s.type,r.state)),this._segments.push(s.segment),p.push([s.segment,Te(this._params)]),m=u.lastIndex;var g=(l=t.substring(m)).indexOf("?");if(g>=0){var v=l.substring(g);if(l=l.substring(0,g),v.length>0)for(m=0;a=d.exec(v);)f((s=h(a,!0)).id),this._params.push(o.fromSearch(s.id,s.type,r.state)),m=u.lastIndex}this._segments.push(l),this._compiled=p.map((function(e){return en.apply(null,e)})).concat(en(l))}return e.encodeDashes=function(e){return encodeURIComponent(e).replace(/-/g,(function(e){return"%5C%".concat(e.charCodeAt(0).toString(16).toUpperCase())}))},e.pathSegmentsAndParams=function(e){var n=e._segments,o=e._params.filter((function(e){return e.location===t.DefType.PATH}));return Pe(n,o.concat(void 0)).reduce(he,[]).filter((function(e){return""!==e&&_(e)}))},e.queryParams=function(e){return e._params.filter((function(e){return e.location===t.DefType.SEARCH}))},e.compare=function(t,n){var o=function(t){return t._cache.weights=t._cache.weights||function(t){return t._cache.segments=t._cache.segments||t._cache.path.map(e.pathSegmentsAndParams).reduce(he,[]).reduce(Ze,[]).map((function(e){return E(e)?tn(e):e})).reduce(he,[])}(t).map((function(e){return"/"===e?1:E(e)?2:e instanceof gt?3:void 0}))},r=o(t),i=o(n);!function(e,t,n){for(var o=Math.max(e.length,t.length);e.length<o;)e.push(n);for(;t.length<o;)t.push(n)}(r,i,0);var a,s,l=Pe(r,i);for(s=0;s<l.length;s++)if(0!=(a=l[s][0]-l[s][1]))return a;return 0},e.prototype.append=function(e){return this._children.push(e),e._cache={path:this._cache.path.concat(e),parent:this,pattern:null},e},e.prototype.isRoot=function(){return this._cache.path[0]===this},e.prototype.toString=function(){return this.pattern},e.prototype._getDecodedParamValue=function(e,t){return _(e)&&(this.config.decodeParams&&!t.type.raw&&(e=R(e)?e.map((function(e){return decodeURIComponent(e)})):decodeURIComponent(e)),e=t.type.decode(e)),t.value(e)},e.prototype.exec=function(e,t,n,o){var r=this;void 0===t&&(t={});var i,a,s,c=(i=this._cache,a="pattern",s=function(){return new RegExp(["^",ye(r._cache.path.map(l("_compiled"))).join(""),!1===r.config.strict?"/?":"","$"].join(""),r.config.caseInsensitive?"i":void 0)},i[a]=i[a]||s()).exec(e);if(!c)return null;var u,d,p=this.parameters(),m=p.filter((function(e){return!e.isSearch()})),f=p.filter((function(e){return e.isSearch()})),h=this._cache.path.map((function(e){return e._segments.length-1})).reduce((function(e,t){return e+t})),g={};if(h!==c.length-1)throw new Error("Unbalanced capture group in route '".concat(this.pattern,"'"));for(var v=0;v<h;v++){for(var b=m[v],y=c[v+1],w=0;w<b.replace.length;w++)b.replace[w].from===y&&(y=b.replace[w].to);y&&!0===b.array&&(u=void 0,d=void 0,d=de((u=function(e){return e.split("").reverse().join("")})(y).split(/-(?!\\)/),u),y=de(d,(function(e){return e.replace(/\\-/g,"-")})).reverse()),g[b.id]=this._getDecodedParamValue(y,b)}return f.forEach((function(e){for(var n=t[e.id],o=0;o<e.replace.length;o++)e.replace[o].from===n&&(n=e.replace[o].to);g[e.id]=r._getDecodedParamValue(n,e)})),n&&(g["#"]=n),g},e.prototype.parameters=function(e){return void 0===e&&(e={}),!1===e.inherit?this._params:ye(this._cache.path.map((function(e){return e._params})))},e.prototype.parameter=function(e,t){var n=this;void 0===t&&(t={});var o=this._cache.parent;return function(){for(var t=0,o=n._params;t<o.length;t++){var r=o[t];if(r.id===e)return r}}()||!1!==t.inherit&&o&&o.parameter(e,t)||null},e.prototype.validates=function(e){return e=e||{},this.parameters().filter((function(t){return e.hasOwnProperty(t.id)})).map((function(t){return function(e,t){return!e||e.validates(t)}(t,e[t.id])})).reduce(me,!0)},e.prototype.format=function(t){void 0===t&&(t={});var n=this._cache.path,o=n.map(e.pathSegmentsAndParams).reduce(he,[]).map((function(e){return E(e)?e:i(e)})),r=n.map(e.queryParams).reduce(he,[]).map(i);if(o.concat(r).filter((function(e){return!1===e.isValid})).length)return null;function i(e){var n=e.value(t[e.id]),o=e.validates(n),r=e.isDefaultValue(n),i=!!r&&e.squash,a=e.type.encode(n);return{param:e,value:n,isValid:o,isDefaultValue:r,squash:i,encoded:a}}var a=o.reduce((function(t,n){if(E(n))return t+n;var o=n.squash,r=n.encoded,i=n.param;return!0===o?t.match(/\/$/)?t.slice(0,-1):t:E(o)?t+o:!1!==o||null==r?t:R(r)?t+de(r,e.encodeDashes).join("-"):i.raw?t+r:t+encodeURIComponent(r)}),""),s=r.map((function(e){var t=e.param,n=e.squash,o=e.encoded,r=e.isDefaultValue;if(!(null==o||r&&!1!==n)&&(R(o)||(o=[o]),0!==o.length))return t.raw||(o=de(o,encodeURIComponent)),o.map((function(e){return"".concat(t.id,"=").concat(e)}))})).filter(z).reduce(he,[]).join("&");return a+(s?"?".concat(s):"")+(t["#"]?"#"+t["#"]:"")},e.nameValidator=/^\w+([-.]+\w+)*(?:\[\])?$/,e}(),rn=function(){return rn=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},rn.apply(this,arguments)},an=function(){function e(e){this.router=e}return e.prototype.fromConfig=function(e,n,o){return new gt(e,n,t.DefType.CONFIG,this.router.urlService.config,o)},e.prototype.fromPath=function(e,n,o){return new gt(e,n,t.DefType.PATH,this.router.urlService.config,o)},e.prototype.fromSearch=function(e,n,o){return new gt(e,n,t.DefType.SEARCH,this.router.urlService.config,o)},e}(),sn=function(){function e(e){var t=this;this.router=e,this.paramFactory=new an(this.router),this.UrlMatcher=on,this.Param=gt,this.caseInsensitive=function(e){return t.router.urlService.config.caseInsensitive(e)},this.defaultSquashPolicy=function(e){return t.router.urlService.config.defaultSquashPolicy(e)},this.strictMode=function(e){return t.router.urlService.config.strictMode(e)},this.type=function(e,n,o){return t.router.urlService.config.type(e,n,o)||t}}return e.prototype.compile=function(e,t){var n=this.router.urlService.config,o=t&&!t.state&&t.params;t=o?rn({state:{params:o}},t):t;var r={strict:n._isStrictMode,caseInsensitive:n._isCaseInsensitive,decodeParams:n._decodeParams};return new on(e,n.paramTypes,this.paramFactory,V(r,t))},e.prototype.isMatcher=function(e){if(!I(e))return!1;var t=!0;return W(on.prototype,(function(n,o){T(n)&&(t=t&&_(e[o])&&T(e[o]))})),t},e.prototype.$get=function(){var e=this.router.urlService.config;return e.paramTypes.enqueue=!1,e.paramTypes._flushTypeQueue(),this},e}(),ln=function(){function e(e){this.router=e}return e.prototype.compile=function(e){return this.router.urlMatcherFactory.compile(e)},e.prototype.create=function(e,t){var n=this,o=Wt.isState,r=Wt.isStateDeclaration,i=w([[E,function(e){return i(n.compile(e))}],[g(on),function(e){return n.fromUrlMatcher(e,t)}],[m(o,r),function(e){return n.fromState(e,n.router)}],[g(RegExp),function(e){return n.fromRegExp(e,t)}],[T,function(e){return new cn(e,t)}]]),a=i(e);if(!a)throw new Error("invalid 'what' in when()");return a},e.prototype.fromUrlMatcher=function(e,t){var n=t;E(t)&&(t=this.router.urlMatcherFactory.compile(t)),g(on)(t)&&(n=function(e){return t.format(e)});var o={urlMatcher:e,matchPriority:function(t){var n=e.parameters().filter((function(e){return e.isOptional}));return n.length?n.filter((function(e){return t[e.id]})).length/n.length:1e-6},type:"URLMATCHER"};return V(new cn((function(t){var n=e.exec(t.path,t.search,t.hash);return e.validates(n)&&n}),n),o)},e.prototype.fromState=function(e,t){var n=Wt.isStateDeclaration(e)?e.$$state():e,o={state:n,type:"STATE"};return V(this.fromUrlMatcher(n.url,(function(e){var o=t.stateService,r=t.globals;o.href(n,e)!==o.href(r.current,r.params)&&o.transitionTo(n,e,{inherit:!0,source:"url"})})),o)},e.prototype.fromRegExp=function(e,t){if(e.global||e.sticky)throw new Error("Rule RegExp must not be global or sticky");var n=E(t)?function(e){return t.replace(/\$(\$|\d{1,2})/,(function(t,n){return e["$"===n?0:Number(n)]}))}:t,o={regexp:e,type:"REGEXP"};return V(new cn((function(t){return e.exec(t.path)}),n),o)},e.isUrlRule=function(e){return e&&["type","match","handler"].every((function(t){return _(e[t])}))},e}(),cn=function(e,t){var n=this;this.match=e,this.type="RAW",this.matchPriority=function(e){return 0-n.$id},this.handler=t||z};var un,dn=function(){function e(e){var t=this;this.router=e,this.sync=function(e){return t.router.urlService.sync(e)},this.listen=function(e){return t.router.urlService.listen(e)},this.deferIntercept=function(e){return t.router.urlService.deferIntercept(e)},this.match=function(e){return t.router.urlService.match(e)},this.initial=function(e){return t.router.urlService.rules.initial(e)},this.otherwise=function(e){return t.router.urlService.rules.otherwise(e)},this.removeRule=function(e){return t.router.urlService.rules.removeRule(e)},this.rule=function(e){return t.router.urlService.rules.rule(e)},this.rules=function(){return t.router.urlService.rules.rules()},this.sort=function(e){return t.router.urlService.rules.sort(e)},this.when=function(e,n,o){return t.router.urlService.rules.when(e,n,o)},this.urlRuleFactory=new ln(e)}return e.prototype.update=function(e){var t=this.router.locationService;e?this.location=t.url():t.url()!==this.location&&t.url(this.location,!0)},e.prototype.push=function(e,t,n){var o=n&&!!n.replace;this.router.urlService.url(e.format(t||{}),o)},e.prototype.href=function(e,t,n){var o=e.format(t);if(null==o)return null;n=n||{absolute:!1};var r=this.router.urlService.config,i=r.html5Mode();if(i||null===o||(o="#"+r.hashPrefix()+o),o=function(e,t,n,o){return"/"===o?e:t?He(o)+e:n?o.slice(1)+e:e}(o,i,n.absolute,r.baseHref()),!n.absolute||!o)return o;var a=!i&&o?"/":"",s=r.port(),l=80===s||443===s?"":":"+s;return[r.protocol(),"://",r.host(),l,a,o].join("")},Object.defineProperty(e.prototype,"interceptDeferred",{get:function(){return this.router.urlService.interceptDeferred},enumerable:!1,configurable:!0}),e}(),pn=function(){function e(e){var t=this;this.router=e,this._uiViews=[],this._viewConfigs=[],this._viewConfigFactories={},this._listeners=[],this._pluginapi={_rootViewContext:this._rootViewContext.bind(this),_viewConfigFactory:this._viewConfigFactory.bind(this),_registeredUIView:function(e){return ce(t._uiViews,(function(n){return"".concat(t.router.$id,".").concat(n.id)===e}))},_registeredUIViews:function(){return t._uiViews},_activeViewConfigs:function(){return t._viewConfigs},_onSync:function(e){return t._listeners.push(e),function(){return X(t._listeners,e)}}}}return e.normalizeUIViewTarget=function(e,t){void 0===t&&(t="");var n=t.split("@"),o=n[0]||"$default",r=E(n[1])?n[1]:"^",i=/^(\^(?:\.\^)*)\.(.*$)/.exec(o);if(i&&(r=i[1],o=i[2]),"!"===o.charAt(0)&&(o=o.substr(1),r=""),/^(\^(?:\.\^)*)$/.exec(r)){var a=r.split(".").reduce((function(e,t){return e.parent}),e);r=a.name}else"."===r&&(r=e.name);return{uiViewName:o,uiViewContextAnchor:r}},e.prototype._rootViewContext=function(e){return this._rootContext=e||this._rootContext},e.prototype._viewConfigFactory=function(e,t){this._viewConfigFactories[e]=t},e.prototype.createViewConfig=function(e,t){var n=this._viewConfigFactories[t.$type];if(!n)throw new Error("ViewService: No view config factory registered for type "+t.$type);var o=n(e,t);return R(o)?o:[o]},e.prototype.deactivateViewConfig=function(e){lt.traceViewServiceEvent("<- Removing",e),X(this._viewConfigs,e)},e.prototype.activateViewConfig=function(e){lt.traceViewServiceEvent("-> Registering",e),this._viewConfigs.push(e)},e.prototype.sync=function(){var t=this,n=this._uiViews.map((function(e){return[e.fqn,e]})).reduce(Me,{});function o(e){for(var t=e.viewDecl.$context,n=0;++n&&t.parent;)t=t.parent;return n}var r=i((function(e,t,n,o){return t*(e(n)-e(o))})),a=this._uiViews.sort(r((function(e){var t=function(e){return e&&e.parent?t(e.parent)+1:1};return 1e4*e.fqn.split(".").length+t(e.creationContext)}),1)).map((function(i){var a=t._viewConfigs.filter(e.matches(n,i));return a.length>1&&a.sort(r(o,-1)),{uiView:i,viewConfig:a[0]}})),s=a.map((function(e){return e.viewConfig})),l=this._viewConfigs.filter((function(e){return!Y(s,e)})).map((function(e){return{uiView:void 0,viewConfig:e}}));a.forEach((function(e){-1!==t._uiViews.indexOf(e.uiView)&&e.uiView.configUpdated(e.viewConfig)}));var c=a.concat(l);this._listeners.forEach((function(e){return e(c)})),lt.traceViewSync(c)},e.prototype.registerUIView=function(e){lt.traceViewServiceUIViewEvent("-> Registering",e);var t=this._uiViews;return t.filter((function(t){return t.fqn===e.fqn&&t.$type===e.$type})).length&&lt.traceViewServiceUIViewEvent("!!!! duplicate uiView named:",e),t.push(e),this.sync(),function(){-1!==t.indexOf(e)?(lt.traceViewServiceUIViewEvent("<- Deregistering",e),X(t)(e)):lt.traceViewServiceUIViewEvent("Tried removing non-registered uiView",e)}},e.prototype.available=function(){return this._uiViews.map(l("fqn"))},e.prototype.active=function(){return this._uiViews.filter(l("$config")).map(l("name"))},e.matches=function(e,t){return function(n){if(t.$type!==n.viewDecl.$type)return!1;var o=n.viewDecl,r=o.$uiViewName.split("."),i=t.fqn.split(".");if(!q(r,i.slice(0-r.length)))return!1;var a=1-r.length||void 0,s=i.slice(0,a).join("."),l=e[s].creationContext;return o.$uiViewContextAnchor===(l&&l.name)}},e}(),mn=function(){function e(){this.params=new bt,this.lastStartedTransitionId=-1,this.transitionHistory=new Oe([],1),this.successfulTransitions=new Oe([],1)}return e.prototype.dispose=function(){this.transitionHistory.clear(),this.successfulTransitions.clear(),this.transition=null},e}();function fn(e){if(!(T(e)||E(e)||g(wt)(e)||wt.isDef(e)))throw new Error("'handler' must be a string, function, TargetState, or have a state: 'newtarget' property");return T(e)?e:b(e)}un=function(e,t){var n=function(e,t){return(t.priority||0)-(e.priority||0)}(e,t);return 0!==n||0!==(n=function(e,t){var n={STATE:4,URLMATCHER:4,REGEXP:3,RAW:2,OTHER:1};return(n[e.type]||0)-(n[t.type]||0)}(e,t))||0!==(n=function(e,t){return e.urlMatcher&&t.urlMatcher?on.compare(e.urlMatcher,t.urlMatcher):0}(e,t))?n:function(e,t){var n={STATE:!0,URLMATCHER:!0};return n[e.type]&&n[t.type]?0:(e.$id||0)-(t.$id||0)}(e,t)};var hn=function(){function e(e){this.router=e,this._sortFn=un,this._rules=[],this._id=0,this.urlRuleFactory=new ln(e)}return e.prototype.dispose=function(e){this._rules=[],delete this._otherwiseFn},e.prototype.initial=function(e){var t=fn(e);this.rule(this.urlRuleFactory.create((function(e,t){return 0===t.globals.transitionHistory.size()&&!!/^\/?$/.exec(e.path)}),t))},e.prototype.otherwise=function(e){var t=fn(e);this._otherwiseFn=this.urlRuleFactory.create(b(!0),t),this._sorted=!1},e.prototype.removeRule=function(e){X(this._rules,e)},e.prototype.rule=function(e){var t=this;if(!ln.isUrlRule(e))throw new Error("invalid rule");return e.$id=this._id++,e.priority=e.priority||0,this._rules.push(e),this._sorted=!1,function(){return t.removeRule(e)}},e.prototype.rules=function(){return this.ensureSorted(),this._rules.concat(this._otherwiseFn?[this._otherwiseFn]:[])},e.prototype.sort=function(e){for(var t=this.stableSort(this._rules,this._sortFn=e||this._sortFn),n=0,o=0;o<t.length;o++)t[o]._group=n,o<t.length-1&&0!==this._sortFn(t[o],t[o+1])&&n++;this._rules=t,this._sorted=!0},e.prototype.ensureSorted=function(){this._sorted||this.sort()},e.prototype.stableSort=function(e,t){var n=e.map((function(e,t){return{elem:e,idx:t}}));return n.sort((function(e,n){var o=t(e.elem,n.elem);return 0===o?e.idx-n.idx:o})),n.map((function(e){return e.elem}))},e.prototype.when=function(e,t,n){var o=this.urlRuleFactory.create(e,t);return _(n&&n.priority)&&(o.priority=n.priority),this.rule(o),o},e}(),gn=function(){function e(e){var t=this;this.router=e,this.paramTypes=new vt,this._decodeParams=!0,this._isCaseInsensitive=!1,this._isStrictMode=!0,this._defaultSquashPolicy=!1,this.dispose=function(){return t.paramTypes.dispose()},this.baseHref=function(){return t.router.locationConfig.baseHref()},this.hashPrefix=function(e){return t.router.locationConfig.hashPrefix(e)},this.host=function(){return t.router.locationConfig.host()},this.html5Mode=function(){return t.router.locationConfig.html5Mode()},this.port=function(){return t.router.locationConfig.port()},this.protocol=function(){return t.router.locationConfig.protocol()}}return e.prototype.caseInsensitive=function(e){return this._isCaseInsensitive=_(e)?e:this._isCaseInsensitive},e.prototype.defaultSquashPolicy=function(e){if(_(e)&&!0!==e&&!1!==e&&!E(e))throw new Error("Invalid squash policy: ".concat(e,". Valid policies: false, true, arbitrary-string"));return this._defaultSquashPolicy=_(e)?e:this._defaultSquashPolicy},e.prototype.strictMode=function(e){return this._isStrictMode=_(e)?e:this._isStrictMode},e.prototype.type=function(e,t,n){var o=this.paramTypes.type(e,t,n);return _(t)?this:o},e}(),vn=function(){function e(e){var t=this;this.router=e,this.interceptDeferred=!1,this.rules=new hn(this.router),this.config=new gn(this.router),this.url=function(e,n,o){return t.router.locationService.url(e,n,o)},this.path=function(){return t.router.locationService.path()},this.search=function(){return t.router.locationService.search()},this.hash=function(){return t.router.locationService.hash()},this.onChange=function(e){return t.router.locationService.onChange(e)}}return e.prototype.dispose=function(){this.listen(!1),this.rules.dispose()},e.prototype.parts=function(){return{path:this.path(),search:this.search(),hash:this.hash()}},e.prototype.sync=function(e){if(!e||!e.defaultPrevented){var t=this.router,n=t.urlService,o=t.stateService,r={path:n.path(),search:n.search(),hash:n.hash()},i=this.match(r),a=w([[E,function(e){return n.url(e,!0)}],[wt.isDef,function(e){return o.go(e.state,e.params,e.options)}],[g(wt),function(e){return o.go(e.state(),e.params(),e.options())}]]);a(i&&i.rule.handler(i.match,r,this.router))}},e.prototype.listen=function(e){var t=this;if(!1!==e)return this._stopListeningFn=this._stopListeningFn||this.router.urlService.onChange((function(e){return t.sync(e)}));this._stopListeningFn&&this._stopListeningFn(),delete this._stopListeningFn},e.prototype.deferIntercept=function(e){void 0===e&&(e=!0),this.interceptDeferred=e},e.prototype.match=function(e){var t,n,o=this;e=V({path:"",search:{},hash:""},e);for(var r,i=this.rules.rules(),a=0;a<i.length&&(!r||r.rule._group===i[a]._group);a++){var s=(t=i[a],n=void 0,(n=t.match(e,o.router))&&{match:n,rule:t,weight:t.matchPriority(n)});r=!r||s&&s.weight>r.weight?s:r}return r},e}(),bn=0,yn=j("LocationServices",["url","path","search","hash","onChange"]),wn=j("LocationConfig",["port","protocol","host","baseHref","html5Mode","hashPrefix"]),$n=function(){function e(e,t){void 0===e&&(e=yn),void 0===t&&(t=wn),this.locationService=e,this.locationConfig=t,this.$id=bn++,this._disposed=!1,this._disposables=[],this.trace=lt,this.viewService=new pn(this),this.globals=new mn,this.transitionService=new qn(this),this.urlMatcherFactory=new sn(this),this.urlRouter=new dn(this),this.urlService=new vn(this),this.stateRegistry=new zt(this),this.stateService=new zn(this),this._plugins={},this.viewService._pluginapi._rootViewContext(this.stateRegistry.root()),this.globals.$current=this.stateRegistry.root(),this.globals.current=this.globals.$current.self,this.disposable(this.globals),this.disposable(this.stateService),this.disposable(this.stateRegistry),this.disposable(this.transitionService),this.disposable(this.urlService),this.disposable(e),this.disposable(t)}return e.prototype.disposable=function(e){this._disposables.push(e)},e.prototype.dispose=function(e){var t=this;e&&T(e.dispose)?e.dispose(this):(this._disposed=!0,this._disposables.slice().forEach((function(e){try{"function"==typeof e.dispose&&e.dispose(t),X(t._disposables,e)}catch(e){}})))},e.prototype.plugin=function(e,t){void 0===t&&(t={});var n=new e(this,t);if(!n.name)throw new Error("Required property `name` missing on plugin: "+n);return this._disposables.push(n),this._plugins[n.name]=n},e.prototype.getPlugin=function(e){return e?this._plugins[e]:pe(this._plugins)},e}();function kn(e){e.addResolvable(_t.fromData($n,e.router),""),e.addResolvable(_t.fromData(Qt,e),""),e.addResolvable(_t.fromData("$transition$",e),""),e.addResolvable(_t.fromData("$stateParams",e.params()),""),e.entering().forEach((function(t){e.addResolvable(_t.fromData("$state$",t),t)}))}var Sn=Y(["$transition$",Qt]),_n=function(e){var t=pe(e.treeChanges()).reduce(he,[]).reduce(be,[]),n=function(e){return Sn(e.token)?_t.fromData(e.token,null):e};t.forEach((function(e){e.resolvables=e.resolvables.map(n)}))},Pn=function(e){var t=e.to().redirectTo;if(t){var n=e.router.stateService;return T(t)?D.$q.when(t(e)).then(o):o(t)}function o(t){if(t)return t instanceof wt?t:E(t)?n.target(t,e.params(),e.options()):t.state||t.params?n.target(t.state||e.to(),t.params||e.params(),e.options()):void 0}};function Mn(e){return function(t,n){return(0,n.$$state()[e])(t,n)}}var Tn=Mn("onExit"),Cn=Mn("onRetain"),En=Mn("onEnter"),In=1e3,Rn=function(e){return new Et(e.treeChanges().to).resolvePath("EAGER",e).then(H)},An=function(e,t){return new Et(e.treeChanges().to).subContext(t.$$state()).resolvePath("LAZY",e).then(H)},xn=function(e){return new Et(e.treeChanges().to).resolvePath("LAZY",e).then(H)},Ln=function(e){var t=D.$q,n=e.views("entering");if(n.length)return t.all(n.map((function(e){return t.when(e.load())}))).then(H)},On=function(e){var t=e.views("entering"),n=e.views("exiting");if(t.length||n.length){var o=e.router.viewService;n.forEach((function(e){return o.deactivateViewConfig(e)})),t.forEach((function(e){return o.activateViewConfig(e)})),o.sync()}},jn=function(e){var t=e.router.globals,n=function(){t.transition===e&&(t.transition=null)};e.onSuccess({},(function(){t.successfulTransitions.enqueue(e),t.$current=e.$to(),t.current=t.$current.self,Ce(e.params(),t.params)}),{priority:1e4}),e.promise.then(n,n)},Dn=function(e){var t=e.options(),n=e.router.stateService,o=e.router.urlRouter;if("url"!==t.source&&t.location&&n.$current.navigable){var r={replace:"replace"===t.location};o.push(n.$current.navigable.url,n.params,r)}o.update(!0)},Nn=function(e){var t=e.router;var n=e.entering().filter((function(e){return!!e.$$state().lazyLoad})).map((function(t){return Un(e,t)}));return D.$q.all(n).then((function(){if("url"!==e.originalTransition().options().source){var n=e.targetState();return t.stateService.target(n.identifier(),n.params(),n.options())}var o=t.urlService,r=o.match(o.parts()),i=r&&r.rule;if(i&&"STATE"===i.type){var a=i.state,s=r.match;return t.stateService.target(a,s,e.options())}t.urlService.sync()}))};function Un(e,t){var n=t.$$state().lazyLoad,o=n._promise;if(!o){o=n._promise=D.$q.when(n(e,t)).then((function(t){return t&&Array.isArray(t.states)&&t.states.forEach((function(t){return e.router.stateRegistry.register(t)})),t})).then((function(e){return delete t.lazyLoad,delete t.$$state().lazyLoad,delete n._promise,e}),(function(e){return delete n._promise,D.$q.reject(e)}))}return o}var Fn=function(e,t,n,o,r,i,a,s){void 0===r&&(r=!1),void 0===i&&(i=Gt.HANDLE_RESULT),void 0===a&&(a=Gt.REJECT_ERROR),void 0===s&&(s=!1),this.name=e,this.hookPhase=t,this.hookOrder=n,this.criteriaMatchPath=o,this.reverseSort=r,this.getResultHandler=i,this.getErrorHandler=a,this.synchronous=s};function Bn(e){var t=e._ignoredReason();if(t){lt.traceTransitionIgnored(e);var n=e.router.globals.transition;return"SameAsCurrent"===t&&n&&n.abort(),De.ignored().toPromise()}}function Wn(e){if(!e.valid())throw new Error(e.error().toString())}var Vn={location:!0,relative:null,inherit:!1,notify:!0,reload:!1,supercede:!0,custom:{},current:function(){return null},source:"unknown"},qn=function(){function e(e){this._transitionCount=0,this._eventTypes=[],this._registeredHooks={},this._criteriaPaths={},this._router=e,this.$view=e.viewService,this._deregisterHookFns={},this._pluginapi=G(b(this),{},b(this),["_definePathType","_defineEvent","_getPathTypes","_getEvents","getHooks"]),this._defineCorePaths(),this._defineCoreEvents(),this._registerCoreTransitionHooks(),e.globals.successfulTransitions.onEvict(_n)}return e.prototype.onCreate=function(e,t,n){},e.prototype.onBefore=function(e,t,n){},e.prototype.onStart=function(e,t,n){},e.prototype.onExit=function(e,t,n){},e.prototype.onRetain=function(e,t,n){},e.prototype.onEnter=function(e,t,n){},e.prototype.onFinish=function(e,t,n){},e.prototype.onSuccess=function(e,t,n){},e.prototype.onError=function(e,t,n){},e.prototype.dispose=function(e){pe(this._registeredHooks).forEach((function(e){return e.forEach((function(t){t._deregistered=!0,X(e,t)}))}))},e.prototype.create=function(e,t){return new Qt(e,t,this._router)},e.prototype._defineCoreEvents=function(){var e=t.TransitionHookPhase,n=Gt,o=this._criteriaPaths,r=!1,i=!0;this._defineEvent("onCreate",e.CREATE,0,o.to,r,n.LOG_REJECTED_RESULT,n.THROW_ERROR,i),this._defineEvent("onBefore",e.BEFORE,0,o.to),this._defineEvent("onStart",e.RUN,0,o.to),this._defineEvent("onExit",e.RUN,100,o.exiting,!0),this._defineEvent("onRetain",e.RUN,200,o.retained),this._defineEvent("onEnter",e.RUN,300,o.entering),this._defineEvent("onFinish",e.RUN,400,o.to),this._defineEvent("onSuccess",e.SUCCESS,0,o.to,r,n.LOG_REJECTED_RESULT,n.LOG_ERROR,i),this._defineEvent("onError",e.ERROR,0,o.to,r,n.LOG_REJECTED_RESULT,n.LOG_ERROR,i)},e.prototype._defineCorePaths=function(){var e=t.TransitionHookScope.STATE,n=t.TransitionHookScope.TRANSITION;this._definePathType("to",n),this._definePathType("from",n),this._definePathType("exiting",e),this._definePathType("retained",e),this._definePathType("entering",e)},e.prototype._defineEvent=function(e,t,n,o,r,i,a,s){void 0===r&&(r=!1),void 0===i&&(i=Gt.HANDLE_RESULT),void 0===a&&(a=Gt.REJECT_ERROR),void 0===s&&(s=!1);var l=new Fn(e,t,n,o,r,i,a,s);this._eventTypes.push(l),Jt(this,this,l)},e.prototype._getEvents=function(e){return(_(e)?this._eventTypes.filter((function(t){return t.hookPhase===e})):this._eventTypes.slice()).sort((function(e,t){var n=e.hookPhase-t.hookPhase;return 0===n?e.hookOrder-t.hookOrder:n}))},e.prototype._definePathType=function(e,t){this._criteriaPaths[e]={name:e,scope:t}},e.prototype._getPathTypes=function(){return this._criteriaPaths},e.prototype.getHooks=function(e){return this._registeredHooks[e]},e.prototype._registerCoreTransitionHooks=function(){var e=this._deregisterHookFns;e.addCoreResolves=this.onCreate({},kn),e.ignored=function(e){return e.onBefore({},Bn,{priority:-9999})}(this),e.invalid=function(e){return e.onBefore({},Wn,{priority:-1e4})}(this),e.redirectTo=function(e){return e.onStart({to:function(e){return!!e.redirectTo}},Pn)}(this),e.onExit=function(e){return e.onExit({exiting:function(e){return!!e.onExit}},Tn)}(this),e.onRetain=function(e){return e.onRetain({retained:function(e){return!!e.onRetain}},Cn)}(this),e.onEnter=function(e){return e.onEnter({entering:function(e){return!!e.onEnter}},En)}(this),e.eagerResolve=function(e){return e.onStart({},Rn,{priority:In})}(this),e.lazyResolve=function(e){return e.onEnter({entering:b(!0)},An,{priority:In})}(this),e.resolveAll=function(e){return e.onFinish({},xn,{priority:In})}(this),e.loadViews=function(e){return e.onFinish({},Ln)}(this),e.activateViews=function(e){return e.onSuccess({},On)}(this),e.updateGlobals=function(e){return e.onCreate({},jn)}(this),e.updateUrl=function(e){return e.onSuccess({},Dn,{priority:9999})}(this),e.lazyLoad=function(e){return e.onBefore({entering:function(e){return!!e.lazyLoad}},Nn)}(this)},e}(),zn=function(){function e(t){this.router=t,this.invalidCallbacks=[],this._defaultErrorHandler=function(e){e instanceof Error&&e.stack||e instanceof De&&e.detail&&e.detail.stack};var n=Object.keys(e.prototype).filter(d(Y(["current","$current","params","transition"])));G(b(e.prototype),this,b(this),n)}return Object.defineProperty(e.prototype,"transition",{get:function(){return this.router.globals.transition},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"params",{get:function(){return this.router.globals.params},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"current",{get:function(){return this.router.globals.current},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$current",{get:function(){return this.router.globals.$current},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this.defaultErrorHandler(H),this.invalidCallbacks=[]},e.prototype._handleInvalidTargetState=function(e,t){var n=this,o=$t.makeTargetState(this.router.stateRegistry,e),r=this.router.globals,i=function(){return r.transitionHistory.peekTail()},a=i(),s=new Oe(this.invalidCallbacks.slice()),l=new Et(e).injector(),c=function(e){if(e instanceof wt){var t=e;return(t=n.target(t.identifier(),t.params(),t.options())).valid()?i()!==a?De.superseded().toPromise():n.transitionTo(t.identifier(),t.params(),t.options()):De.invalid(t.error()).toPromise()}};return function e(){var n=s.dequeue();return void 0===n?De.invalid(t.error()).toPromise():D.$q.when(n(t,o,l)).then(c).then((function(t){return t||e()}))}()},e.prototype.onInvalid=function(e){return this.invalidCallbacks.push(e),function(){X(this.invalidCallbacks)(e)}.bind(this)},e.prototype.reload=function(e){return this.transitionTo(this.current,this.params,{reload:!_(e)||e,inherit:!1,notify:!1})},e.prototype.go=function(e,t,n){var o=ne(n,{relative:this.$current,inherit:!0},Vn);return this.transitionTo(e,t,o)},e.prototype.target=function(e,t,n){if(void 0===n&&(n={}),I(n.reload)&&!n.reload.name)throw new Error("Invalid reload state object");var o=this.router.stateRegistry;if(n.reloadState=!0===n.reload?o.root():o.matcher.find(n.reload,n.relative),n.reload&&!n.reloadState)throw new Error("No such reload state '".concat(E(n.reload)?n.reload:n.reload.name,"'"));return new wt(this.router.stateRegistry,e,t,n)},e.prototype.getCurrentPath=function(){var e=this,t=this.router.globals.successfulTransitions.peekTail();return t?t.treeChanges().to:[new yt(e.router.stateRegistry.root())]},e.prototype.transitionTo=function(e,n,o){var r=this;void 0===n&&(n={}),void 0===o&&(o={});var i=this.router,a=i.globals;o=ne(o,Vn);var s=function(){return a.transition};o=V(o,{current:s});var l=this.target(e,n,o),c=this.getCurrentPath();if(!l.exists())return this._handleInvalidTargetState(c,l);if(!l.valid())return xe(l.error());if(!1===o.supercede&&s())return De.ignored("Another transition is in progress and supercede has been set to false in TransitionOptions for the transition. So the transition was ignored in favour of the existing one in progress.").toPromise();var u=function(e){return function(n){if(n instanceof De){var o=i.globals.lastStartedTransitionId<=e.$id;if(n.type===t.RejectType.IGNORED)return o&&i.urlRouter.update(),D.$q.when(a.current);var s=n.detail;if(n.type===t.RejectType.SUPERSEDED&&n.redirected&&s instanceof wt){var l=e.redirect(s);return l.run().catch(u(l))}if(n.type===t.RejectType.ABORTED)return o&&i.urlRouter.update(),D.$q.reject(n)}return r.defaultErrorHandler()(n),D.$q.reject(n)}},d=this.router.transitionService.create(c,l),p=d.run().catch(u(d));return Ae(p),V(p,{transition:d})},e.prototype.is=function(e,t,n){n=ne(n,{relative:this.$current});var o=this.router.stateRegistry.matcher.find(e,n.relative);if(_(o)){if(this.$current!==o)return!1;if(!t)return!0;var r=o.parameters({inherit:!0,matchingKeys:t});return gt.equals(r,gt.values(r,t),this.params)}},e.prototype.includes=function(e,t,n){n=ne(n,{relative:this.$current});var o=E(e)&&Le.fromString(e);if(o){if(!o.matches(this.$current.name))return!1;e=this.$current.name}var r=this.router.stateRegistry.matcher.find(e,n.relative),i=this.$current.includes;if(_(r)){if(!_(i[r.name]))return!1;if(!t)return!0;var a=r.parameters({inherit:!0,matchingKeys:t});return gt.equals(a,gt.values(a,t),this.params)}},e.prototype.href=function(e,t,n){n=ne(n,{lossy:!0,inherit:!0,absolute:!1,relative:this.$current}),t=t||{};var o=this.router.stateRegistry.matcher.find(e,n.relative);if(!_(o))return null;n.inherit&&(t=this.params.$inherit(t,this.$current,o));var r=o&&n.lossy?o.navigable:o;return r&&void 0!==r.url&&null!==r.url?this.router.urlRouter.href(r.url,t,{absolute:n.absolute}):null},e.prototype.defaultErrorHandler=function(e){return this._defaultErrorHandler=e||this._defaultErrorHandler},e.prototype.get=function(e,t){var n=this.router.stateRegistry;return 0===arguments.length?n.get():n.get(e,t||this.$current)},e.prototype.lazyLoad=function(e,t){var n=this.get(e);if(!n||!n.lazyLoad)throw new Error("Can not lazy load "+e);var o=this.getCurrentPath(),r=$t.makeTargetState(this.router.stateRegistry,o);return Un(t=t||this.router.transitionService.create(o,r),n)},e}(),Hn={when:function(e){return new Promise((function(t,n){return t(e)}))},reject:function(e){return new Promise((function(t,n){n(e)}))},defer:function(){var e={};return e.promise=new Promise((function(t,n){e.resolve=t,e.reject=n})),e},all:function(e){if(R(e))return Promise.all(e);if(I(e)){var t=Object.keys(e).map((function(t){return e[t].then((function(e){return{key:t,val:e}}))}));return Hn.all(t).then((function(e){return e.reduce((function(e,t){return e[t.key]=t.val,e}),{})}))}}},Gn={},Kn=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,Yn=/([^\s,]+)/g,Jn={get:function(e){return Gn[e]},has:function(e){return null!=Jn.get(e)},invoke:function(e,t,n){var o=V({},Gn,n||{}),r=Jn.annotate(e),i=$e((function(e){return o.hasOwnProperty(e)}),(function(e){return"DI can't find injectable: '".concat(e,"'")})),a=r.filter(i).map((function(e){return o[e]}));return T(e)?e.apply(t,a):e.slice(-1)[0].apply(t,a)},annotate:function(e){if(!L(e))throw new Error("Not an injectable function: ".concat(e));if(e&&e.$inject)return e.$inject;if(R(e))return e.slice(0,-1);var t=e.toString().replace(Kn,"");return t.slice(t.indexOf("(")+1,t.indexOf(")")).match(Yn)||[]}},Xn=function(e,t){var n=t[0],o=t[1];return e.hasOwnProperty(n)?R(e[n])?e[n].push(o):e[n]=[e[n],o]:e[n]=o,e},Zn=function(e){return e.split("&").filter(z).map(Ye).reduce(Xn,{})};function Qn(e){var t=function(e){return e||""},n=Ge(e).map(t),o=n[0],r=n[1],i=Ke(o).map(t);return{path:i[0],search:i[1],hash:r,url:e}}var eo=function(e){var t=e.path(),n=e.search(),o=e.hash(),r=Object.keys(n).map((function(e){var t=n[e];return(R(t)?t:[t]).map((function(t){return e+"="+t}))})).reduce(he,[]).join("&");return t+(r?"?"+r:"")+(o?"#"+o:"")};function to(e,t,n,o){return function(r){var i=r.locationService=new n(r),a=r.locationConfig=new o(r,t);return{name:e,service:i,configuration:a,dispose:function(e){e.dispose(i),e.dispose(a)}}}}var no,oo=function(){function e(e,t){var n=this;this.fireAfterUpdate=t,this._listeners=[],this._listener=function(e){return n._listeners.forEach((function(t){return t(e)}))},this.hash=function(){return Qn(n._get()).hash},this.path=function(){return Qn(n._get()).path},this.search=function(){return Zn(Qn(n._get()).search)},this._location=N.location,this._history=N.history}return e.prototype.url=function(e,t){return void 0===t&&(t=!0),_(e)&&e!==this._get()&&(this._set(null,null,e,t),this.fireAfterUpdate&&this._listeners.forEach((function(t){return t({url:e})}))),eo(this)},e.prototype.onChange=function(e){var t=this;return this._listeners.push(e),function(){return X(t._listeners,e)}},e.prototype.dispose=function(e){te(this._listeners)},e}(),ro=(no=function(e,t){return no=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},no(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}no(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),io=function(e){function t(t){var n=e.call(this,t,!1)||this;return N.addEventListener("hashchange",n._listener,!1),n}return ro(t,e),t.prototype._get=function(){return Je(this._location.hash)},t.prototype._set=function(e,t,n,o){this._location.hash=n},t.prototype.dispose=function(t){e.prototype.dispose.call(this,t),N.removeEventListener("hashchange",this._listener)},t}(oo),ao=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),so=function(e){function t(t){return e.call(this,t,!0)||this}return ao(t,e),t.prototype._get=function(){return this._url},t.prototype._set=function(e,t,n,o){this._url=n},t}(oo),lo=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),co=function(e){function t(t){var n=e.call(this,t,!0)||this;return n._config=t.urlService.config,N.addEventListener("popstate",n._listener,!1),n}return lo(t,e),t.prototype._getBasePrefix=function(){return He(this._config.baseHref())},t.prototype._get=function(){var e=this._location,t=e.pathname,n=e.hash,o=e.search;o=Ke(o)[1],n=Ge(n)[1];var r=this._getBasePrefix(),i=t===this._config.baseHref(),a=t.substr(0,r.length)===r;return(t=i?"/":a?t.substring(r.length):t)+(o?"?"+o:"")+(n?"#"+n:"")},t.prototype._set=function(e,t,n,o){var r=this._getBasePrefix(),i=n&&"/"!==n[0]?"/":"",a=""===n||"/"===n?this._config.baseHref():r+i+n;o?this._history.replaceState(e,t,a):this._history.pushState(e,t,a)},t.prototype.dispose=function(t){e.prototype.dispose.call(this,t),N.removeEventListener("popstate",this._listener)},t}(oo),uo=function(){var e=this;this.dispose=H,this._baseHref="",this._port=80,this._protocol="http",this._host="localhost",this._hashPrefix="",this.port=function(){return e._port},this.protocol=function(){return e._protocol},this.host=function(){return e._host},this.baseHref=function(){return e._baseHref},this.html5Mode=function(){return!1},this.hashPrefix=function(t){return _(t)?e._hashPrefix=t:e._hashPrefix}},po=function(){function e(e,t){void 0===t&&(t=!1),this._isHtml5=t,this._baseHref=void 0,this._hashPrefix=""}return e.prototype.port=function(){return location.port?Number(location.port):"https"===this.protocol()?443:80},e.prototype.protocol=function(){return location.protocol.replace(/:/g,"")},e.prototype.host=function(){return location.hostname},e.prototype.html5Mode=function(){return this._isHtml5},e.prototype.hashPrefix=function(e){return _(e)?this._hashPrefix=e:this._hashPrefix},e.prototype.baseHref=function(e){return _(e)&&(this._baseHref=e),S(this._baseHref)&&(this._baseHref=this.getBaseHref()),this._baseHref},e.prototype.getBaseHref=function(){var e=document.getElementsByTagName("base")[0];return e&&e.href?e.href.replace(/^([^/:]*:)?\/\/[^/]*/,""):this._isHtml5?"/":location.pathname||"/"},e.prototype.dispose=function(){},e}();function mo(e){return D.$injector=Jn,D.$q=Hn,{name:"vanilla.services",$q:Hn,$injector:Jn,dispose:function(){return null}}}var fo=to("vanilla.hashBangLocation",!1,io,po),ho=to("vanilla.pushStateLocation",!0,co,po),go=to("vanilla.memoryLocation",!1,so,uo),vo=function(){function e(){}return e.prototype.dispose=function(e){},e}(),bo=Object.freeze({__proto__:null,root:N,fromJson:F,toJson:B,forEach:W,extend:V,equals:q,identity:z,noop:H,createProxyFunctions:G,inherit:K,inArray:Y,_inArray:J,removeFrom:X,_removeFrom:Z,pushTo:Q,_pushTo:ee,deregAll:te,defaults:ne,mergeR:oe,ancestors:re,pick:ie,omit:ae,pluck:se,filter:le,find:ce,mapObj:ue,map:de,values:pe,allTrueR:me,anyTrueR:fe,unnestR:he,flattenR:ge,pushR:ve,uniqR:be,unnest:ye,flatten:we,assertPredicate:$e,assertMap:ke,assertFn:Se,pairs:_e,arrayTuples:Pe,applyPairs:Me,tail:Te,copy:Ce,_extend:Ee,silenceUncaughtInPromise:Ae,silentRejection:xe,makeStub:j,services:D,Glob:Le,curry:i,compose:a,pipe:s,prop:l,propEq:c,parse:u,not:d,and:p,or:m,all:f,any:h,is:g,eq:v,val:b,invoke:y,pattern:w,isUndefined:S,isDefined:_,isNull:P,isNullOrUndefined:M,isFunction:T,isNumber:C,isString:E,isObject:I,isArray:R,isDate:A,isRegExp:x,isInjectable:L,isPromise:O,Queue:Oe,maxLength:Ne,padString:Ue,kebobString:Fe,functionToString:Be,fnToString:We,stringify:Ve,beforeAfterSubstr:qe,hostRegex:ze,stripLastPathElement:He,splitHash:Ge,splitQuery:Ke,splitEqual:Ye,trimHashVal:Je,splitOnDelim:Xe,joinNeighborsR:Ze,get Category(){return t.Category},Trace:st,trace:lt,get DefType(){return t.DefType},Param:gt,ParamTypes:vt,StateParams:bt,ParamType:ct,PathNode:yt,PathUtils:$t,resolvePolicies:kt,defaultResolvePolicy:St,Resolvable:_t,NATIVE_INJECTOR_TOKEN:Ct,ResolveContext:Et,resolvablesBuilder:Nt,StateBuilder:Bt,StateObject:Wt,StateMatcher:Vt,StateQueueManager:qt,StateRegistry:zt,StateService:zn,TargetState:wt,get TransitionHookPhase(){return t.TransitionHookPhase},get TransitionHookScope(){return t.TransitionHookScope},HookBuilder:Xt,matchState:Kt,RegisteredHook:Yt,makeEvent:Jt,get RejectType(){return t.RejectType},Rejection:De,Transition:Qt,TransitionHook:Gt,TransitionEventType:Fn,defaultTransOpts:Vn,TransitionService:qn,UrlRules:hn,UrlConfig:gn,UrlMatcher:on,ParamFactory:an,UrlMatcherFactory:sn,UrlRouter:dn,UrlRuleFactory:ln,BaseUrlRule:cn,UrlService:vn,ViewService:pn,UIRouterGlobals:mn,UIRouter:$n,$q:Hn,$injector:Jn,BaseLocationServices:oo,HashLocationService:io,MemoryLocationService:so,PushStateLocationService:co,MemoryLocationConfig:uo,BrowserLocationConfig:po,keyValsToObjectR:Xn,getParams:Zn,parseUrl:Qn,buildUrl:eo,locationPluginFactory:to,servicesPlugin:mo,hashLocationPlugin:fo,pushStateLocationPlugin:ho,memoryLocationPlugin:go,UIRouterPluginBase:vo});function yo(){var e=null;return function(t,n){return e=e||D.$injector.get("$templateFactory"),[new So(t,n,e)]}}var wo=function(e,t){return e.reduce((function(e,n){return e||_(t[n])}),!1)};function $o(e){if(!e.parent)return{};var t=["component","bindings","componentProvider"],n=["templateProvider","templateUrl","template","notify","async"].concat(["controller","controllerProvider","controllerAs","resolveAs"]),o=t.concat(n);if(_(e.views)&&wo(o,e))throw new Error("State '"+e.name+"' has a 'views' object. It cannot also have \"view properties\" at the state level.  Move the following properties into a view (in the 'views' object):  "+o.filter((function(t){return _(e[t])})).join(", "));var r={},i=e.views||{$default:ie(e,o)};return W(i,(function(o,i){if(i=i||"$default",E(o)&&(o={component:o}),o=V({},o),wo(t,o)&&wo(n,o))throw new Error("Cannot combine: "+t.join("|")+" with: "+n.join("|")+" in stateview: '"+i+"@"+e.name+"'");o.resolveAs=o.resolveAs||"$resolve",o.$type="ng1",o.$context=e,o.$name=i;var a=pn.normalizeUIViewTarget(o.$context,o.$name);o.$uiViewName=a.uiViewName,o.$uiViewContextAnchor=a.uiViewContextAnchor,r[i]=o})),r}var ko=0,So=function(){function e(e,t,n){var o=this;this.path=e,this.viewDecl=t,this.factory=n,this.$id=ko++,this.loaded=!1,this.getTemplate=function(e,t){return o.component?o.factory.makeComponentTemplate(e,t,o.component,o.viewDecl.bindings):o.template}}return e.prototype.load=function(){var e=this,t=D.$q,n=new Et(this.path),o=this.path.reduce((function(e,t){return V(e,t.paramValues)}),{}),r={template:t.when(this.factory.fromConfig(this.viewDecl,o,n)),controller:t.when(this.getController(n))};return t.all(r).then((function(t){return lt.traceViewServiceEvent("Loaded",e),e.controller=t.controller,V(e,t.template),e}))},e.prototype.getController=function(e){var t=this.viewDecl.controllerProvider;if(!L(t))return this.viewDecl.controller;var n=D.$injector.annotate(t),o=R(t)?Te(t):t;return new _t("",o,n).get(e)},e}(),_o=function(){function e(){var e=this;this._useHttp=r.version.minor<3,this.$get=["$http","$templateCache","$injector",function(t,n,o){return e.$templateRequest=o.has&&o.has("$templateRequest")&&o.get("$templateRequest"),e.$http=t,e.$templateCache=n,e}]}return e.prototype.useHttpService=function(e){this._useHttp=e},e.prototype.fromConfig=function(e,t,n){var o=function(e){return D.$q.when(e).then((function(e){return{template:e}}))},r=function(e){return D.$q.when(e).then((function(e){return{component:e}}))};return _(e.template)?o(this.fromString(e.template,t)):_(e.templateUrl)?o(this.fromUrl(e.templateUrl,t)):_(e.templateProvider)?o(this.fromProvider(e.templateProvider,t,n)):_(e.component)?r(e.component):_(e.componentProvider)?r(this.fromComponentProvider(e.componentProvider,t,n)):o("<ui-view></ui-view>")},e.prototype.fromString=function(e,t){return T(e)?e(t):e},e.prototype.fromUrl=function(e,t){return T(e)&&(e=e(t)),null==e?null:this._useHttp?this.$http.get(e,{cache:this.$templateCache,headers:{Accept:"text/html"}}).then((function(e){return e.data})):this.$templateRequest(e)},e.prototype.fromProvider=function(e,t,n){var o=D.$injector.annotate(e),r=R(e)?Te(e):e;return new _t("",r,o).get(n)},e.prototype.fromComponentProvider=function(e,t,n){var o=D.$injector.annotate(e),r=R(e)?Te(e):e;return new _t("",r,o).get(n)},e.prototype.makeComponentTemplate=function(e,t,n,o){o=o||{};var i=r.version.minor>=3?"::":"",a=function(e){var t=Fe(e);return/^(x|data)-/.exec(t)?"x-"+t:t},s=function(e){var t=D.$injector.get(e+"Directive");if(!t||!t.length)throw new Error("Unable to find component named '"+e+"'");return t.map(Po).reduce(he,[])}(n).map((function(n){var r=n.name,s=n.type,l=a(r);if(e.attr(l)&&!o[r])return l+"='"+e.attr(l)+"'";var c=o[r]||r;if("@"===s)return l+"='{{"+i+"$resolve."+c+"}}'";if("&"===s){var u=t.getResolvable(c),d=u&&u.data,p=d&&D.$injector.annotate(d)||[];return l+"='$resolve."+c+(R(d)?"["+(d.length-1)+"]":"")+"("+p.join(",")+")'"}return l+"='"+i+"$resolve."+c+"'"})).join(" "),l=a(n);return"<"+l+" "+s+"></"+l+">"},e}();var Po=function(e){return I(e.bindToController)?Mo(e.bindToController):Mo(e.scope)},Mo=function(e){return Object.keys(e||{}).map((function(t){return[t,/^([=<@&])[?]?(.*)/.exec(e[t])]})).filter((function(e){return _(e)&&R(e[1])})).map((function(e){return{name:e[1][2]||e[0],type:e[1][1]}}))},To=function(){function e(t,n){this.stateRegistry=t,this.stateService=n,G(b(e.prototype),this,b(this))}return e.prototype.decorator=function(e,t){return this.stateRegistry.decorator(e,t)||this},e.prototype.state=function(e,t){return I(e)?t=e:t.name=e,this.stateRegistry.register(t),this},e.prototype.onInvalid=function(e){return this.stateService.onInvalid(e)},e}(),Co=function(e){return function(t){var n=t[e],o="onExit"===e?"from":"to";return n?function(e,t){var r=new Et(e.treeChanges(o)).subContext(t.$$state()),i=V(zo(r),{$state$:t,$transition$:e});return D.$injector.invoke(n,this,i)}:void 0}},Eo=function(){function e(e){this._urlListeners=[],this.$locationProvider=e;var t=b(e);G(t,this,t,["hashPrefix"])}return e.monkeyPatchPathParameterType=function(e){var t=e.urlMatcherFactory.type("path");t.encode=function(e){return null!=e?e.toString().replace(/(~|\/)/g,(function(e){return{"~":"~~","/":"~2F"}[e]})):e},t.decode=function(e){return null!=e?e.toString().replace(/(~~|~2F)/g,(function(e){return{"~~":"~","~2F":"/"}[e]})):e}},e.prototype.dispose=function(){},e.prototype.onChange=function(e){var t=this;return this._urlListeners.push(e),function(){return X(t._urlListeners)(e)}},e.prototype.html5Mode=function(){var e=this.$locationProvider.html5Mode();return(e=I(e)?e.enabled:e)&&this.$sniffer.history},e.prototype.baseHref=function(){return this._baseHref||(this._baseHref=this.$browser.baseHref()||this.$window.location.pathname)},e.prototype.url=function(e,t,n){return void 0===t&&(t=!1),_(e)&&this.$location.url(e),t&&this.$location.replace(),n&&this.$location.state(n),this.$location.url()},e.prototype._runtimeServices=function(e,t,n,o,r){var i=this;this.$location=t,this.$sniffer=n,this.$browser=o,this.$window=r,e.$on("$locationChangeSuccess",(function(e){return i._urlListeners.forEach((function(t){return t(e)}))}));var a=b(t);G(a,this,a,["replace","path","search","hash"]),G(a,this,a,["port","protocol","host"])},e}(),Io=function(){function e(e){this.router=e}return e.injectableHandler=function(e,t){return function(n){return D.$injector.invoke(t,null,{$match:n,$stateParams:e.globals.params})}},e.prototype.$get=function(){var e=this.router.urlService;return this.router.urlRouter.update(!0),e.interceptDeferred||e.listen(),this.router.urlRouter},e.prototype.rule=function(e){var t=this;if(!T(e))throw new Error("'rule' must be a function");var n=new cn((function(){return e(D.$injector,t.router.locationService)}),z);return this.router.urlService.rules.rule(n),this},e.prototype.otherwise=function(e){var t=this,n=this.router.urlService.rules;if(E(e))n.otherwise(e);else{if(!T(e))throw new Error("'rule' must be a string or function");n.otherwise((function(){return e(D.$injector,t.router.locationService)}))}return this},e.prototype.when=function(t,n){return(R(n)||T(n))&&(n=e.injectableHandler(this.router,n)),this.router.urlService.rules.when(t,n),this},e.prototype.deferIntercept=function(e){this.router.urlService.deferIntercept(e)},e}();r.module("ui.router.angular1",[]);var Ro=r.module("ui.router.init",["ng"]),Ao=r.module("ui.router.util",["ui.router.init"]),xo=r.module("ui.router.router",["ui.router.util"]),Lo=r.module("ui.router.state",["ui.router.router","ui.router.util","ui.router.angular1"]),Oo=r.module("ui.router",["ui.router.init","ui.router.state","ui.router.angular1"]);r.module("ui.router.compat",["ui.router"]);var jo=null;function Do(e){(jo=this.router=new $n).stateProvider=new To(jo.stateRegistry,jo.stateService),jo.stateRegistry.decorator("views",$o),jo.stateRegistry.decorator("onExit",Co("onExit")),jo.stateRegistry.decorator("onRetain",Co("onRetain")),jo.stateRegistry.decorator("onEnter",Co("onEnter")),jo.viewService._pluginapi._viewConfigFactory("ng1",yo()),jo.urlService.config._decodeParams=!1;var t=jo.locationService=jo.locationConfig=new Eo(e);function n(e,n,o,r,i,a,s){return t._runtimeServices(i,e,r,n,o),delete jo.router,delete jo.$get,jo}return Eo.monkeyPatchPathParameterType(jo),jo.router=jo,jo.$get=n,n.$inject=["$location","$browser","$window","$sniffer","$rootScope","$http","$templateCache"],jo}Do.$inject=["$locationProvider"];var No=function(e){return["$uiRouterProvider",function(t){var n=t.router[e];return n.$get=function(){return n},n}]};function Uo(e,t,n){if(D.$injector=e,D.$q=t,!Object.prototype.hasOwnProperty.call(e,"strictDi"))try{e.invoke(["checkStrictDi",function(e){}])}catch(t){e.strictDi=!!/strict mode/.exec(t&&t.toString())}n.stateRegistry.get().map((function(e){return e.$$state().resolvables})).reduce(he,[]).filter((function(e){return"deferred"===e.deps})).forEach((function(t){return t.deps=e.annotate(t.resolveFn,e.strictDi)}))}Uo.$inject=["$injector","$q","$uiRouter"];function Fo(e){e.$watch((function(){lt.approximateDigests++}))}Fo.$inject=["$rootScope"],Ro.provider("$uiRouter",Do),xo.provider("$urlRouter",["$uiRouterProvider",function(e){return e.urlRouterProvider=new Io(e)}]),Ao.provider("$urlService",No("urlService")),Ao.provider("$urlMatcherFactory",["$uiRouterProvider",function(){return jo.urlMatcherFactory}]),Ao.provider("$templateFactory",(function(){return new _o})),Lo.provider("$stateRegistry",No("stateRegistry")),Lo.provider("$uiRouterGlobals",No("globals")),Lo.provider("$transitions",No("transitionService")),Lo.provider("$state",["$uiRouterProvider",function(){return V(jo.stateProvider,{$get:function(){return jo.stateService}})}]),Lo.factory("$stateParams",["$uiRouter",function(e){return e.globals.params}]),Oo.factory("$view",(function(){return jo.viewService})),Oo.service("$trace",(function(){return lt})),Oo.run(Fo),Ao.run(["$urlMatcherFactory",function(e){}]),Lo.run(["$state",function(e){}]),xo.run(["$urlRouter",function(e){}]),Ro.run(Uo);var Bo,Wo,Vo,qo,zo=function(e){return e.getTokens().filter(E).map((function(t){var n=e.getResolvable(t);return[t,"NOWAIT"===e.getPolicy(n).async?n.promise:n.data]})).reduce(Me,{})};function Ho(e){var t=e.match(/^\s*({[^}]*})\s*$/);t&&(e="("+t[1]+")");var n=e.replace(/\n/g," ").match(/^\s*([^(]*?)\s*(\((.*)\))?\s*$/);if(!n||4!==n.length)throw new Error("Invalid state ref '"+e+"'");return{state:n[1]||null,paramExpr:n[3]||null}}function Go(e){var t=e.parent().inheritedData("$uiView"),n=u("$cfg.path")(t);return n?Te(n).state.name:void 0}function Ko(e,t,n){var o=n.uiState||e.current.name,r=V(function(e,t){return{relative:Go(e)||t.$current,inherit:!0,source:"sref"}}(t,e),n.uiStateOpts||{}),i=e.href(o,n.uiStateParams,r);return{uiState:o,uiStateParams:n.uiStateParams,uiStateOpts:r,href:i}}function Yo(e){var t="[object SVGAnimatedString]"===Object.prototype.toString.call(e.prop("href")),n="FORM"===e[0].nodeName;return{attr:n?"action":t?"xlink:href":"href",isAnchor:"A"===e.prop("tagName").toUpperCase(),clickable:!n}}function Jo(e,t,n,o,r){return function(i){var a=i.which||i.button,s=r();if(!(a>1||i.ctrlKey||i.metaKey||i.shiftKey||i.altKey||e.attr("target"))){var l=n((function(){e.attr("disabled")||t.go(s.uiState,s.uiStateParams,s.uiStateOpts)}));i.preventDefault();var c=o.isAnchor&&!s.href?1:0;i.preventDefault=function(){c--<=0&&n.cancel(l)}}}}function Xo(e,t,n,o){var r;o&&(r=o.events),R(r)||(r=["click"]);for(var i=e.on?"on":"bind",a=0,s=r;a<s.length;a++){var l=s[a];e[i](l,n)}t.$on("$destroy",(function(){for(var t=e.off?"off":"unbind",o=0,i=r;o<i.length;o++){var a=i[o];e[t](a,n)}}))}function Zo(e){var t=function(t,n,o){return e.is(t,n,o)};return t.$stateful=!0,t}function Qo(e){var t=function(t,n,o){return e.includes(t,n,o)};return t.$stateful=!0,t}function er(e,t,n,o,i){var a=u("viewDecl.controllerAs"),s=u("viewDecl.resolveAs");return{restrict:"ECA",priority:-400,compile:function(o){var l=o.html();return o.empty(),function(o,c){var u=c.data("$uiView");if(!u)return c.html(l),void e(c.contents())(o);var d=u.$cfg||{viewDecl:{},getTemplate:H},p=d.path&&new Et(d.path);c.html(d.getTemplate(c,p)||l),lt.traceUIViewFill(u.$uiView,c.html());var m=e(c.contents()),f=d.controller,h=a(d),g=s(d),v=p&&zo(p);if(o[g]=v,f){var b=t(f,V({},v,{$scope:o,$element:c}));h&&(o[h]=b,o[h][g]=v),c.data("$ngControllerController",b),c.children().data("$ngControllerController",b),or(i,n,b,o,d)}if(E(d.component))var y=Fe(d.component),w=new RegExp("^(x-|data-)?"+y+"$","i"),$=o.$watch((function(){var e=[].slice.call(c[0].children).filter((function(e){return e&&e.tagName&&w.exec(e.tagName)}));return e&&r.element(e).data("$"+d.component+"Controller")}),(function(e){e&&(or(i,n,e,o,d),$())}));m(o)}}}}Bo=["$uiRouter","$timeout",function(e,t){var n=e.stateService;return{restrict:"A",require:["?^uiSrefActive","?^uiSrefActiveEq"],link:function(o,r,i,a){var s=Yo(r),l=a[1]||a[0],c=null,u={},d=function(){return Ko(n,r,u)},p=Ho(i.uiSref);function m(){var e=d();c&&c(),l&&(c=l.$$addStateInfo(e.uiState,e.uiStateParams)),null!=e.href&&i.$set(s.attr,e.href)}if(u.uiState=p.state,u.uiStateOpts=i.uiSrefOpts?o.$eval(i.uiSrefOpts):{},p.paramExpr&&(o.$watch(p.paramExpr,(function(e){u.uiStateParams=V({},e),m()}),!0),u.uiStateParams=V({},o.$eval(p.paramExpr))),m(),o.$on("$destroy",e.stateRegistry.onStatesChanged(m)),o.$on("$destroy",e.transitionService.onSuccess({},m)),s.clickable){var f=Jo(r,n,t,s,d);Xo(r,o,f,u.uiStateOpts)}}}}],Wo=["$uiRouter","$timeout",function(e,t){var n=e.stateService;return{restrict:"A",require:["?^uiSrefActive","?^uiSrefActiveEq"],link:function(o,r,i,a){var s,l=Yo(r),c=a[1]||a[0],u=null,d={},p=function(){return Ko(n,r,d)},m=["uiState","uiStateParams","uiStateOpts"],f=m.reduce((function(e,t){return e[t]=H,e}),{});function h(){var e=p();u&&u(),c&&(u=c.$$addStateInfo(e.uiState,e.uiStateParams)),null!=e.href&&i.$set(l.attr,e.href)}m.forEach((function(e){d[e]=i[e]?o.$eval(i[e]):null,i.$observe(e,(function(t){f[e](),f[e]=o.$watch(t,(function(t){d[e]=t,h()}),!0)}))})),h(),o.$on("$destroy",e.stateRegistry.onStatesChanged(h)),o.$on("$destroy",e.transitionService.onSuccess({},h)),l.clickable&&(s=Jo(r,n,t,l,p),Xo(r,o,s,d.uiStateOpts))}}}],Vo=["$state","$stateParams","$interpolate","$uiRouter",function(e,t,n,o){return{restrict:"A",controller:["$scope","$element","$attrs",function(t,r,i){var a,s,l,c,u,d=[];a=n(i.uiSrefActiveEq||"",!1)(t);try{s=t.$eval(i.uiSrefActive)}catch(e){}function p(e){e.promise.then(g,H)}function m(){f(s)}function f(e){I(e)&&(d=[],W(e,(function(e,n){var o=function(e,n){var o=Ho(e);h(o.state,t.$eval(o.paramExpr),n)};E(e)?o(e,n):R(e)&&W(e,(function(e){o(e,n)}))})))}function h(t,n,o){var i={state:e.get(t,Go(r))||{name:t},params:n,activeClass:o};return d.push(i),function(){X(d)(i)}}function g(){var n=function(e){return e.split(/\s/).filter(z)},o=function(e){return e.map((function(e){return e.activeClass})).map(n).reduce(he,[])},i=o(d).concat(n(a)).reduce(be,[]),s=o(d.filter((function(t){return e.includes(t.state.name,t.params)}))),l=!!d.filter((function(t){return e.is(t.state.name,t.params)})).length,c=l?n(a):[],u=s.concat(c).reduce(be,[]),p=i.filter((function(e){return!Y(u,e)}));t.$evalAsync((function(){u.forEach((function(e){return r.addClass(e)})),p.forEach((function(e){return r.removeClass(e)}))}))}f(s=s||n(i.uiSrefActive||"",!1)(t)),this.$$addStateInfo=function(e,t){if(!(I(s)&&d.length>0)){var n=h(e,t,s);return g(),n}},t.$on("$destroy",(l=o.stateRegistry.onStatesChanged(m),c=o.transitionService.onStart({},p),u=t.$on("$stateChangeSuccess",g),function(){l(),c(),u()})),o.globals.transition&&p(o.globals.transition),g()}]}}],r.module("ui.router.state").directive("uiSref",Bo).directive("uiSrefActive",Vo).directive("uiSrefActiveEq",Vo).directive("uiState",Wo),Zo.$inject=["$state"],Qo.$inject=["$state"],r.module("ui.router.state").filter("isState",Zo).filter("includedByState",Qo),qo=["$view","$animate","$uiViewScroll","$interpolate","$q",function(e,t,n,o,i){var a={$cfg:{viewDecl:{$context:e._pluginapi._rootViewContext()}},$uiView:{}},s={count:0,restrict:"ECA",terminal:!0,priority:400,transclude:"element",compile:function(l,c,d){return function(l,c,p){var m,f,h,g,v=p.onload||"",b=p.autoscroll,y={enter:function(e,n,o){r.version.minor>2?t.enter(e,null,n).then(o):t.enter(e,null,n,o)},leave:function(e,n){r.version.minor>2?t.leave(e).then(n):t.leave(e,n)}},w=c.inheritedData("$uiView")||a,$=o(p.uiView||p.name||"")(l)||"$default",k={$type:"ng1",id:s.count++,name:$,fqn:w.$uiView.fqn?w.$uiView.fqn+"."+$:$,config:null,configUpdated:function(e){(!e||e instanceof So)&&(t=g,n=e,t===n||(lt.traceUIViewConfigUpdated(k,e&&e.viewDecl&&e.viewDecl.$context),g=e,P(e)));var t,n},get creationContext(){var e=u("$cfg.viewDecl.$context")(w),t=u("$uiView.creationContext")(w);return e||t}};lt.traceUIViewEvent("Linking",k),c.data("$uiView",{$uiView:k}),P();var S=e.registerUIView(k);function P(e){var t=l.$new(),o=i.defer(),r=i.defer(),a={$cfg:e,$uiView:k},s={$animEnter:o.promise,$animLeave:r.promise,$$animLeave:r};t.$emit("$viewContentLoading",$);var u=d(t,(function(e){e.data("$uiViewAnim",s),e.data("$uiView",a),y.enter(e,c,(function(){o.resolve(),h&&h.$emit("$viewContentAnimationEnded"),(_(b)&&!b||l.$eval(b))&&n(e)})),function(){if(m&&(lt.traceUIViewEvent("Removing (previous) el",m.data("$uiView")),m.remove(),m=null),h&&(lt.traceUIViewEvent("Destroying scope",k),h.$destroy(),h=null),f){var e=f.data("$uiViewAnim");lt.traceUIViewEvent("Animate out",e),y.leave(f,(function(){e.$$animLeave.resolve(),m=null})),m=f,f=null}}()}));f=u,(h=t).$emit("$viewContentLoaded",e||g),h.$eval(v)}l.$on("$destroy",(function(){lt.traceUIViewEvent("Destroying/Unregistering",k),S()}))}}};return s}],er.$inject=["$compile","$controller","$transitions","$view","$q"];var tr="function"==typeof r.module("ui.router").component,nr=0;function or(e,t,n,o,r){!T(n.$onInit)||(r.viewDecl.component||r.viewDecl.componentProvider)&&tr||n.$onInit();var i=Te(r.path).state.self,a={bind:n};if(T(n.uiOnParamsChanged)){var s=new Et(r.path).getResolvable("$transition$").data;o.$on("$destroy",t.onSuccess({},(function(e){if(e!==s&&-1===e.exiting().indexOf(i)){var t=e.params("to"),o=e.params("from"),r=function(e){return e.paramSchema},a=e.treeChanges("to").map(r).reduce(he,[]),l=e.treeChanges("from").map(r).reduce(he,[]),c=a.filter((function(e){var n=l.indexOf(e);return-1===n||!l[n].type.equals(t[e.id],o[e.id])}));if(c.length){var u=c.map((function(e){return e.id})),d=le(t,(function(e,t){return-1!==u.indexOf(t)}));n.uiOnParamsChanged(d,e)}}}),a))}if(T(n.uiCanExit)){var l=nr++,c="_uiCanExitIds",u=function(e){return!!e&&(e[c]&&!0===e[c][l]||u(e.redirectedFrom()))},d={exiting:i.name};o.$on("$destroy",t.onBefore(d,(function(t){var o,r=t[c]=t[c]||{};return u(t)||(o=e.when(n.uiCanExit(t))).then((function(e){return r[l]=!1!==e})),o}),a))}}r.module("ui.router.state").directive("uiView",qo),r.module("ui.router.state").directive("uiView",er),r.module("ui.router.state").provider("$uiViewScroll",(function(){var e=!1;this.useAnchorScroll=function(){e=!0},this.$get=["$anchorScroll","$timeout",function(t,n){return e?t:function(e){return n((function(){e[0].scrollIntoView()}),0,!1)}}]}));t.$injector=Jn,t.$q=Hn,t.BaseLocationServices=oo,t.BaseUrlRule=cn,t.BrowserLocationConfig=po,t.Glob=Le,t.HashLocationService=io,t.HookBuilder=Xt,t.MemoryLocationConfig=uo,t.MemoryLocationService=so,t.NATIVE_INJECTOR_TOKEN=Ct,t.Ng1ViewConfig=So,t.Param=gt,t.ParamFactory=an,t.ParamType=ct,t.ParamTypes=vt,t.PathNode=yt,t.PathUtils=$t,t.PushStateLocationService=co,t.Queue=Oe,t.RegisteredHook=Yt,t.Rejection=De,t.Resolvable=_t,t.ResolveContext=Et,t.StateBuilder=Bt,t.StateMatcher=Vt,t.StateObject=Wt,t.StateParams=bt,t.StateProvider=To,t.StateQueueManager=qt,t.StateRegistry=zt,t.StateService=zn,t.TargetState=wt,t.Trace=st,t.Transition=Qt,t.TransitionEventType=Fn,t.TransitionHook=Gt,t.TransitionService=qn,t.UIRouter=$n,t.UIRouterGlobals=mn,t.UIRouterPluginBase=vo,t.UrlConfig=gn,t.UrlMatcher=on,t.UrlMatcherFactory=sn,t.UrlRouter=dn,t.UrlRouterProvider=Io,t.UrlRuleFactory=ln,t.UrlRules=hn,t.UrlService=vn,t.ViewService=pn,t._extend=Ee,t._inArray=J,t._pushTo=ee,t._removeFrom=Z,t.all=f,t.allTrueR=me,t.ancestors=re,t.and=p,t.any=h,t.anyTrueR=fe,t.applyPairs=Me,t.arrayTuples=Pe,t.assertFn=Se,t.assertMap=ke,t.assertPredicate=$e,t.beforeAfterSubstr=qe,t.buildUrl=eo,t.compose=a,t.copy=Ce,t.core=bo,t.createProxyFunctions=G,t.curry=i,t.default="ui.router",t.defaultResolvePolicy=St,t.defaultTransOpts=Vn,t.defaults=ne,t.deregAll=te,t.eq=v,t.equals=q,t.extend=V,t.filter=le,t.find=ce,t.flatten=we,t.flattenR=ge,t.fnToString=We,t.forEach=W,t.fromJson=F,t.functionToString=Be,t.getLocals=zo,t.getNg1ViewConfigFactory=yo,t.getParams=Zn,t.hashLocationPlugin=fo,t.hostRegex=ze,t.identity=z,t.inArray=Y,t.inherit=K,t.invoke=y,t.is=g,t.isArray=R,t.isDate=A,t.isDefined=_,t.isFunction=T,t.isInjectable=L,t.isNull=P,t.isNullOrUndefined=M,t.isNumber=C,t.isObject=I,t.isPromise=O,t.isRegExp=x,t.isString=E,t.isUndefined=S,t.joinNeighborsR=Ze,t.kebobString=Fe,t.keyValsToObjectR=Xn,t.locationPluginFactory=to,t.makeEvent=Jt,t.makeStub=j,t.map=de,t.mapObj=ue,t.matchState=Kt,t.maxLength=Ne,t.memoryLocationPlugin=go,t.mergeR=oe,t.ng1ViewsBuilder=$o,t.noop=H,t.not=d,t.omit=ae,t.or=m,t.padString=Ue,t.pairs=_e,t.parse=u,t.parseUrl=Qn,t.pattern=w,t.pick=ie,t.pipe=s,t.pluck=se,t.prop=l,t.propEq=c,t.pushR=ve,t.pushStateLocationPlugin=ho,t.pushTo=Q,t.removeFrom=X,t.resolvablesBuilder=Nt,t.resolvePolicies=kt,t.root=N,t.services=D,t.servicesPlugin=mo,t.silenceUncaughtInPromise=Ae,t.silentRejection=xe,t.splitEqual=Ye,t.splitHash=Ge,t.splitOnDelim=Xe,t.splitQuery=Ke,t.stringify=Ve,t.stripLastPathElement=He,t.tail=Te,t.toJson=B,t.trace=lt,t.trimHashVal=Je,t.uniqR=be,t.unnest=ye,t.unnestR=he,t.val=b,t.values=pe,t.watchDigests=Fo,Object.defineProperty(t,"__esModule",{value:!0})}({},r?o:(r=1,o=angular)),angular.module("monospaced.elastic",[]).directive("msdElastic",["$timeout","$window",function(e,t){return{require:"ngModel",restrict:"A, C",link:function(n,o,r,i){var a=o[0],s=o;if("TEXTAREA"===a.nodeName&&t.getComputedStyle){s.css({overflow:"hidden","overflow-y":"hidden","word-wrap":"break-word"});var l=a.value;a.value="",a.value=l;var c,u,d=r.msdElastic?r.msdElastic.replace(/\\n/g,"\n"):"",p=angular.element(t),m="position: absolute; top: -999px; right: auto; bottom: auto;left: 0; overflow: hidden;box-sizing: content-box;min-height: 0 !important; height: 0 !important; padding: 0;word-wrap: break-word; border: 0; margin: 0;",f=angular.element('<textarea aria-hidden="true" tabindex="-1" style="'+m+'"/>').data("elastic",!0),h=f[0],g=getComputedStyle(a),v=g.getPropertyValue("resize"),b=["font-family","font-size","font-weight","font-style","letter-spacing","line-height","text-transform","word-spacing","text-indent"];s.data("elastic")||(s.css({resize:""===v||"none"===v||"vertical"===v?"none":"horizontal"}).data("elastic",!0),a.oninput="onpropertychange"in a&&"oninput"in a?a.onkeyup=w:w,p.bind("resize",$),n.$watch((function(){return i.$modelValue}),(function(e){(e||""===e)&&(h.parentNode!==document.body&&angular.element(document.body).append(h),$())})),n.$on("elastic:adjust",(function(){y(),$()})),n.$on("$destroy",(function(){f.remove(),p.unbind("resize",$)})))}function y(){var e=m;c=a,g=getComputedStyle(a),angular.forEach(b,(function(t){e+=t+":"+g.getPropertyValue(t)+";"})),h.setAttribute("style",e)}function w(){var t,o,r,i,l,p,m,f,v,b,w;c!==a&&y(),u||(u=!0,h.value=a.value+d,h.style.overflowY=a.style.overflowY,b=""===a.style.height?"auto":parseInt(a.style.height,10),v=(f=getComputedStyle(a)).getPropertyValue("width"),r=(r=parseInt(f.getPropertyValue("max-height"),10))&&r>0?r:9e4,t="border-box"===f.getPropertyValue("box-sizing")?{width:parseInt(f.getPropertyValue("border-right-width"),10)+parseInt(f.getPropertyValue("padding-right"),10)+parseInt(f.getPropertyValue("padding-left"),10)+parseInt(f.getPropertyValue("border-left-width"),10),height:parseInt(f.getPropertyValue("border-top-width"),10)+parseInt(f.getPropertyValue("padding-top"),10)+parseInt(f.getPropertyValue("padding-bottom"),10)+parseInt(f.getPropertyValue("border-bottom-width"),10)}:{width:0,height:0},l=parseInt(g.getPropertyValue("min-height"),10),o=parseInt(f.getPropertyValue("height"),10),i=(l||o)-t.height,"px"===v.substr(v.length-2,2)&&(w=parseInt(v,10)-t.width,h.style.width=w+"px"),(p=h.scrollHeight)>r?(p=r,m="scroll"):p<i&&(p=i),p+=t.height,a.style.overflowY=m||"hidden",b!==p&&(n.$emit("elastic:resize",s,b,p),a.style.height=p+"px"),e((function(){u=!1}),1,!1))}function $(){u=!1,w()}}}}]);var i={exports:{}};function a(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)e[o]=n[o]}return e}!function(t,n){(function(){var o,r="Expected a function",i="__lodash_hash_undefined__",a="__lodash_placeholder__",s=1,l=2,c=4,u=1,d=2,p=1/0,m=9007199254740991,f=17976931348623157e292,h=NaN,g=4294967295,v=g-1,b=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],y="[object Arguments]",w="[object Array]",$="[object AsyncFunction]",k="[object Boolean]",S="[object Date]",_="[object Error]",P="[object Function]",M="[object GeneratorFunction]",T="[object Map]",C="[object Number]",E="[object Null]",I="[object Object]",R="[object Promise]",A="[object Proxy]",x="[object RegExp]",L="[object Set]",O="[object String]",j="[object Symbol]",D="[object Undefined]",N="[object WeakMap]",U="[object ArrayBuffer]",F="[object DataView]",B="[object Float32Array]",W="[object Float64Array]",V="[object Int8Array]",q="[object Int16Array]",z="[object Int32Array]",H="[object Uint8Array]",G="[object Uint8ClampedArray]",K="[object Uint16Array]",Y="[object Uint32Array]",J=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,X=/^\w*$/,Z=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Q=/^\s+|\s+$/g,ee=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,te=/\{\n\/\* \[wrapped with (.+)\] \*/,ne=/,? & /,oe=/\\(\\)?/g,re=/\w*$/,ie=/^[-+]0x[0-9a-f]+$/i,ae=/^0b[01]+$/i,se=/^\[object .+?Constructor\]$/,le=/^0o[0-7]+$/i,ce=/^(?:0|[1-9]\d*)$/,ue="\\ud800-\\udfff",de="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",pe="\\ufe0e\\ufe0f",me="["+ue+"]",fe="["+de+"]",he="\\ud83c[\\udffb-\\udfff]",ge="[^"+ue+"]",ve="(?:\\ud83c[\\udde6-\\uddff]){2}",be="[\\ud800-\\udbff][\\udc00-\\udfff]",ye="\\u200d",we="(?:"+fe+"|"+he+")?",$e="["+pe+"]?",ke=$e+we+"(?:"+ye+"(?:"+[ge,ve,be].join("|")+")"+$e+we+")*",Se="(?:"+[ge+fe+"?",fe,ve,be,me].join("|")+")",_e=RegExp(he+"(?="+he+")|"+Se+ke,"g"),Pe=RegExp("["+ye+ue+de+pe+"]"),Me={};Me[B]=Me[W]=Me[V]=Me[q]=Me[z]=Me[H]=Me[G]=Me[K]=Me[Y]=!0,Me[y]=Me[w]=Me[U]=Me[k]=Me[F]=Me[S]=Me[_]=Me[P]=Me[T]=Me[C]=Me[I]=Me[x]=Me[L]=Me[O]=Me[N]=!1;var Te={};Te[y]=Te[w]=Te[U]=Te[F]=Te[k]=Te[S]=Te[B]=Te[W]=Te[V]=Te[q]=Te[z]=Te[T]=Te[C]=Te[I]=Te[x]=Te[L]=Te[O]=Te[j]=Te[H]=Te[G]=Te[K]=Te[Y]=!0,Te[_]=Te[P]=Te[N]=!1;var Ce=parseInt,Ee="object"==typeof e&&e&&e.Object===Object&&e,Ie="object"==typeof self&&self&&self.Object===Object&&self,Re=Ee||Ie||Function("return this")(),Ae=n&&!n.nodeType&&n,xe=Ae&&t&&!t.nodeType&&t,Le=xe&&xe.exports===Ae,Oe=Le&&Ee.process,je=function(){try{return Oe&&Oe.binding&&Oe.binding("util")}catch(e){}}(),De=je&&je.isMap,Ne=je&&je.isRegExp,Ue=je&&je.isSet,Fe=je&&je.isTypedArray;function Be(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function We(e,t,n,o){for(var r=-1,i=null==e?0:e.length;++r<i;){var a=e[r];t(o,a,n(a),e)}return o}function Ve(e,t){for(var n=-1,o=null==e?0:e.length;++n<o&&!1!==t(e[n],n,e););return e}function qe(e,t){for(var n=-1,o=null==e?0:e.length,r=0,i=[];++n<o;){var a=e[n];t(a,n,e)&&(i[r++]=a)}return i}function ze(e,t){return!(null==e||!e.length)&&Ze(e,t,0)>-1}function He(e,t,n){for(var o=-1,r=null==e?0:e.length;++o<r;)if(n(t,e[o]))return!0;return!1}function Ge(e,t){for(var n=-1,o=null==e?0:e.length,r=Array(o);++n<o;)r[n]=t(e[n],n,e);return r}function Ke(e,t){for(var n=-1,o=t.length,r=e.length;++n<o;)e[r+n]=t[n];return e}function Ye(e,t,n,o){var r=-1,i=null==e?0:e.length;for(o&&i&&(n=e[++r]);++r<i;)n=t(n,e[r],r,e);return n}function Je(e,t){for(var n=-1,o=null==e?0:e.length;++n<o;)if(t(e[n],n,e))return!0;return!1}function Xe(e,t,n,o){for(var r=e.length,i=n+(o?1:-1);o?i--:++i<r;)if(t(e[i],i,e))return i;return-1}function Ze(e,t,n){return t==t?function(e,t,n){for(var o=n-1,r=e.length;++o<r;)if(e[o]===t)return o;return-1}(e,t,n):Xe(e,Qe,n)}function Qe(e){return e!=e}function et(e,t,n,o,r){return r(e,(function(e,r,i){n=o?(o=!1,e):t(n,e,r,i)})),n}function tt(e){return function(t){return e(t)}}function nt(e,t){return e.has(t)}function ot(e){return Pe.test(e)}function rt(e){var t=-1,n=Array(e.size);return e.forEach((function(e,o){n[++t]=[o,e]})),n}function it(e,t){return function(n){return e(t(n))}}function at(e,t){return"__proto__"==t?o:e[t]}function st(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function lt(e){return ot(e)?function(e){return e.match(_e)||[]}(e):function(e){return e.split("")}(e)}var ct=Array.prototype,ut=Function.prototype,dt=Object.prototype,pt=Re["__core-js_shared__"],mt=ut.toString,ft=dt.hasOwnProperty,ht=function(){var e=/[^.]+$/.exec(pt&&pt.keys&&pt.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),gt=dt.toString,vt=mt.call(Object),bt=RegExp("^"+mt.call(ft).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),yt=Le?Re.Buffer:o,wt=Re.Symbol,$t=Re.Uint8Array,kt=yt?yt.allocUnsafe:o,St=it(Object.getPrototypeOf,Object),_t=Object.create,Pt=dt.propertyIsEnumerable,Mt=ct.splice,Tt=wt?wt.isConcatSpreadable:o,Ct=wt?wt.iterator:o,Et=wt?wt.toStringTag:o,It=function(){try{var e=bo(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),Rt=Math.floor,At=Object.getOwnPropertySymbols,xt=yt?yt.isBuffer:o,Lt=ct.join,Ot=it(Object.keys,Object),jt=Math.max,Dt=Math.min,Nt=Date.now,Ut=Math.random,Ft=ct.reverse,Bt=bo(Re,"DataView"),Wt=bo(Re,"Map"),Vt=bo(Re,"Promise"),qt=bo(Re,"Set"),zt=bo(Re,"WeakMap"),Ht=bo(Object,"create"),Gt=zt&&new zt,Kt={},Yt=No(Bt),Jt=No(Wt),Xt=No(Vt),Zt=No(qt),Qt=No(zt),en=wt?wt.prototype:o,tn=en?en.valueOf:o,nn=en?en.toString:o;function on(e){if(dr(e)&&!rr(e)&&!(e instanceof ln)){if(e instanceof sn)return e;if(ft.call(e,"__wrapped__"))return Uo(e)}return new sn(e)}var rn=function(){function e(){}return function(t){if(!ur(t))return{};if(_t)return _t(t);e.prototype=t;var n=new e;return e.prototype=o,n}}();function an(){}function sn(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=o}function ln(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=g,this.__views__=[]}function cn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function un(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function dn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function pn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new dn;++t<n;)this.add(e[t])}function mn(e){var t=this.__data__=new un(e);this.size=t.size}function fn(e,t){var n=rr(e),o=!n&&or(e),r=!n&&!o&&sr(e),i=!n&&!o&&!r&&br(e),a=n||o||r||i,s=a?function(e,t){for(var n=-1,o=Array(e);++n<e;)o[n]=t(n);return o}(e.length,String):[],l=s.length;for(var c in e)!t&&!ft.call(e,c)||a&&("length"==c||r&&("offset"==c||"parent"==c)||i&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||_o(c,l))||s.push(c);return s}function hn(e){return Oo(ro(e))}function gn(e,t,n){(n!==o&&!nr(e[t],n)||n===o&&!(t in e))&&wn(e,t,n)}function vn(e,t,n){var r=e[t];ft.call(e,t)&&nr(r,n)&&(n!==o||t in e)||wn(e,t,n)}function bn(e,t){for(var n=e.length;n--;)if(nr(e[n][0],t))return n;return-1}function yn(e,t,n,o){return _n(e,(function(e,r,i){t(o,e,n(e),i)})),o}function wn(e,t,n){"__proto__"==t&&It?It(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function $n(e,t,n,r,i,a){var u,d=t&s,p=t&l,m=t&c;if(n&&(u=i?n(e,r,i,a):n(e)),u!==o)return u;if(!ur(e))return e;var f=rr(e);if(f){if(u=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&ft.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!d)return ro(e,u)}else{var h=$o(e),g=h==P||h==M;if(sr(e))return eo(e,d);if(h==I||h==y||g&&!i){if(u=p||g?{}:ko(e),!d)return p?function(e,t){return io(e,wo(e),t)}(e,function(e,t){return e&&io(t,Er(t),e)}(u,e)):function(e,t){return io(e,yo(e),t)}(e,function(e,t){return e&&io(t,Cr(t),e)}(u,e))}else{if(!Te[h])return i?e:{};u=function(e,t,n){var o,r=e.constructor;switch(t){case U:return to(e);case k:case S:return new r(+e);case F:return function(e,t){var n=t?to(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case B:case W:case V:case q:case z:case H:case G:case K:case Y:return no(e,n);case T:return new r;case C:case O:return new r(e);case x:return function(e){var t=new e.constructor(e.source,re.exec(e));return t.lastIndex=e.lastIndex,t}(e);case L:return new r;case j:return o=e,tn?Object(tn.call(o)):{}}}(e,h,d)}}a||(a=new mn);var v=a.get(e);if(v)return v;if(a.set(e,u),hr(e))return e.forEach((function(o){u.add($n(o,t,n,o,e,a))})),u;if(pr(e))return e.forEach((function(o,r){u.set(r,$n(o,t,n,r,e,a))})),u;var b=f?o:(m?p?fo:mo:p?Er:Cr)(e);return Ve(b||e,(function(o,r){b&&(o=e[r=o]),vn(u,r,$n(o,t,n,r,e,a))})),u}function kn(e,t,n,o){var r=-1,i=ze,a=!0,s=e.length,l=[],c=t.length;if(!s)return l;n&&(t=Ge(t,tt(n))),o?(i=He,a=!1):t.length>=200&&(i=nt,a=!1,t=new pn(t));e:for(;++r<s;){var u=e[r],d=null==n?u:n(u);if(u=o||0!==u?u:0,a&&d==d){for(var p=c;p--;)if(t[p]===d)continue e;l.push(u)}else i(t,d,o)||l.push(u)}return l}on.prototype=an.prototype,on.prototype.constructor=on,sn.prototype=rn(an.prototype),sn.prototype.constructor=sn,ln.prototype=rn(an.prototype),ln.prototype.constructor=ln,cn.prototype.clear=function(){this.__data__=Ht?Ht(null):{},this.size=0},cn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},cn.prototype.get=function(e){var t=this.__data__;if(Ht){var n=t[e];return n===i?o:n}return ft.call(t,e)?t[e]:o},cn.prototype.has=function(e){var t=this.__data__;return Ht?t[e]!==o:ft.call(t,e)},cn.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Ht&&t===o?i:t,this},un.prototype.clear=function(){this.__data__=[],this.size=0},un.prototype.delete=function(e){var t=this.__data__,n=bn(t,e);return!(n<0||(n==t.length-1?t.pop():Mt.call(t,n,1),--this.size,0))},un.prototype.get=function(e){var t=this.__data__,n=bn(t,e);return n<0?o:t[n][1]},un.prototype.has=function(e){return bn(this.__data__,e)>-1},un.prototype.set=function(e,t){var n=this.__data__,o=bn(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this},dn.prototype.clear=function(){this.size=0,this.__data__={hash:new cn,map:new(Wt||un),string:new cn}},dn.prototype.delete=function(e){var t=vo(this,e).delete(e);return this.size-=t?1:0,t},dn.prototype.get=function(e){return vo(this,e).get(e)},dn.prototype.has=function(e){return vo(this,e).has(e)},dn.prototype.set=function(e,t){var n=vo(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this},pn.prototype.add=pn.prototype.push=function(e){return this.__data__.set(e,i),this},pn.prototype.has=function(e){return this.__data__.has(e)},mn.prototype.clear=function(){this.__data__=new un,this.size=0},mn.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},mn.prototype.get=function(e){return this.__data__.get(e)},mn.prototype.has=function(e){return this.__data__.has(e)},mn.prototype.set=function(e,t){var n=this.__data__;if(n instanceof un){var o=n.__data__;if(!Wt||o.length<199)return o.push([e,t]),this.size=++n.size,this;n=this.__data__=new dn(o)}return n.set(e,t),this.size=n.size,this};var Sn,_n=(Sn=En,function(e,t){if(null==e)return e;if(!ir(e))return Sn(e,t);for(var n=e.length,o=-1,r=Object(e);++o<n&&!1!==t(r[o],o,r););return e});function Pn(e,t,n){for(var r=-1,i=e.length;++r<i;){var a=e[r],s=t(a);if(null!=s&&(l===o?s==s&&!vr(s):n(s,l)))var l=s,c=a}return c}function Mn(e,t){var n=[];return _n(e,(function(e,o,r){t(e,o,r)&&n.push(e)})),n}function Tn(e,t,n,o,r){var i=-1,a=e.length;for(n||(n=So),r||(r=[]);++i<a;){var s=e[i];t>0&&n(s)?t>1?Tn(s,t-1,n,o,r):Ke(r,s):o||(r[r.length]=s)}return r}var Cn=function(e,t,n){for(var o=-1,r=Object(e),i=n(e),a=i.length;a--;){var s=i[++o];if(!1===t(r[s],s,r))break}return e};function En(e,t){return e&&Cn(e,t,Cr)}function In(e,t){return qe(t,(function(t){return lr(e[t])}))}function Rn(e,t){for(var n=0,r=(t=Qn(t,e)).length;null!=e&&n<r;)e=e[Do(t[n++])];return n&&n==r?e:o}function An(e,t,n){var o=t(e);return rr(e)?o:Ke(o,n(e))}function xn(e){return null==e?e===o?D:E:Et&&Et in Object(e)?function(e){var t=ft.call(e,Et),n=e[Et];try{e[Et]=o;var r=!0}catch(e){}var i=gt.call(e);return r&&(t?e[Et]=n:delete e[Et]),i}(e):function(e){return gt.call(e)}(e)}function Ln(e,t){return e>t}function On(e,t){return null!=e&&t in Object(e)}function jn(e){return dr(e)&&xn(e)==y}function Dn(e,t,n,r,i){return e===t||(null==e||null==t||!dr(e)&&!dr(t)?e!=e&&t!=t:function(e,t,n,r,i,a){var s=rr(e),l=rr(t),c=s?w:$o(e),p=l?w:$o(t),m=(c=c==y?I:c)==I,f=(p=p==y?I:p)==I,h=c==p;if(h&&sr(e)){if(!sr(t))return!1;s=!0,m=!1}if(h&&!m)return a||(a=new mn),s||br(e)?uo(e,t,n,r,i,a):function(e,t,n,o,r,i,a){switch(n){case F:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case U:return!(e.byteLength!=t.byteLength||!i(new $t(e),new $t(t)));case k:case S:case C:return nr(+e,+t);case _:return e.name==t.name&&e.message==t.message;case x:case O:return e==t+"";case T:var s=rt;case L:var l=o&u;if(s||(s=st),e.size!=t.size&&!l)return!1;var c=a.get(e);if(c)return c==t;o|=d,a.set(e,t);var p=uo(s(e),s(t),o,r,i,a);return a.delete(e),p;case j:if(tn)return tn.call(e)==tn.call(t)}return!1}(e,t,c,n,r,i,a);if(!(n&u)){var g=m&&ft.call(e,"__wrapped__"),v=f&&ft.call(t,"__wrapped__");if(g||v){var b=g?e.value():e,$=v?t.value():t;return a||(a=new mn),i(b,$,n,r,a)}}return!!h&&(a||(a=new mn),function(e,t,n,r,i,a){var s=n&u,l=mo(e),c=l.length;if(c!=mo(t).length&&!s)return!1;for(var d=c;d--;){var p=l[d];if(!(s?p in t:ft.call(t,p)))return!1}var m=a.get(e);if(m&&a.get(t))return m==t;var f=!0;a.set(e,t),a.set(t,e);for(var h=s;++d<c;){var g=e[p=l[d]],v=t[p];if(r)var b=s?r(v,g,p,t,e,a):r(g,v,p,e,t,a);if(!(b===o?g===v||i(g,v,n,r,a):b)){f=!1;break}h||(h="constructor"==p)}if(f&&!h){var y=e.constructor,w=t.constructor;y==w||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof w&&w instanceof w||(f=!1)}return a.delete(e),a.delete(t),f}(e,t,n,r,i,a))}(e,t,n,r,Dn,i))}function Nn(e){return"function"==typeof e?e:null==e?jr:"object"==typeof e?rr(e)?(t=e[0],n=e[1],Mo(t)&&Co(n)?Eo(Do(t),n):function(e){var r=Mr(e,t);return r===o&&r===n?Tr(e,t):Dn(n,r,u|d)}):function(e){var t=function(e){for(var t=Cr(e),n=t.length;n--;){var o=t[n],r=e[o];t[n]=[o,r,Co(r)]}return t}(e);return 1==t.length&&t[0][2]?Eo(t[0][0],t[0][1]):function(n){return n===e||function(e,t,n,r){var i=n.length,a=i;if(null==e)return!a;for(e=Object(e);i--;){var s=n[i];if(s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<a;){var l=(s=n[i])[0],c=e[l],p=s[1];if(s[2]){if(c===o&&!(l in e))return!1}else{var m,f=new mn;if(!(m===o?Dn(p,c,u|d,r,f):m))return!1}}return!0}(n,0,t)}}(e):Fr(e);var t,n}function Un(e,t){return e<t}function Fn(e,t){var n=-1,o=ir(e)?Array(e.length):[];return _n(e,(function(e,r,i){o[++n]=t(e,r,i)})),o}function Bn(e,t,n,r,i){e!==t&&Cn(t,(function(a,s){if(ur(a))i||(i=new mn),function(e,t,n,r,i,a,s){var l=at(e,n),c=at(t,n),u=s.get(c);if(u)gn(e,n,u);else{var d=a?a(l,c,n+"",e,t,s):o,p=d===o;if(p){var m=rr(c),f=!m&&sr(c),h=!m&&!f&&br(c);d=c,m||f||h?rr(l)?d=l:ar(l)?d=ro(l):f?(p=!1,d=eo(c,!0)):h?(p=!1,d=no(c,!0)):d=[]:mr(c)||or(c)?(d=l,or(l)?d=Sr(l):(!ur(l)||r&&lr(l))&&(d=ko(c))):p=!1}p&&(s.set(c,d),i(d,c,r,a,s),s.delete(c)),gn(e,n,d)}}(e,t,s,n,Bn,r,i);else{var l=r?r(at(e,s),a,s+"",e,t,i):o;l===o&&(l=a),gn(e,s,l)}}),Er)}function Wn(e,t,n){var o=-1;t=Ge(t.length?t:[jr],tt(go()));var r=Fn(e,(function(e,n,r){var i=Ge(t,(function(t){return t(e)}));return{criteria:i,index:++o,value:e}}));return function(e){var t=e.length;for(e.sort((function(e,t){return function(e,t,n){for(var o=-1,r=e.criteria,i=t.criteria,a=r.length,s=n.length;++o<a;){var l=oo(r[o],i[o]);if(l)return o>=s?l:l*("desc"==n[o]?-1:1)}return e.index-t.index}(e,t,n)}));t--;)e[t]=e[t].value;return e}(r)}function Vn(e,t){return xo(Io(e,t,jr),e+"")}var qn=Gt?function(e,t){return Gt.set(e,t),e}:jr,zn=It?function(e,t){return It(e,"toString",{configurable:!0,enumerable:!1,value:Or(t),writable:!0})}:jr;function Hn(e){return Oo(Lr(e))}function Gn(e,t,n){var o=-1,r=e.length;t<0&&(t=-t>r?0:r+t),(n=n>r?r:n)<0&&(n+=r),r=t>n?0:n-t>>>0,t>>>=0;for(var i=Array(r);++o<r;)i[o]=e[o+t];return i}function Kn(e,t){var n;return _n(e,(function(e,o,r){return!(n=t(e,o,r))})),!!n}function Yn(e){if("string"==typeof e)return e;if(rr(e))return Ge(e,Yn)+"";if(vr(e))return nn?nn.call(e):"";var t=e+"";return"0"==t&&1/e==-p?"-0":t}function Jn(e,t,n){var o=-1,r=ze,i=e.length,a=!0,s=[],l=s;if(n)a=!1,r=He;else if(i>=200){var c=t?null:lo(e);if(c)return st(c);a=!1,r=nt,l=new pn}else l=t?[]:s;e:for(;++o<i;){var u=e[o],d=t?t(u):u;if(u=n||0!==u?u:0,a&&d==d){for(var p=l.length;p--;)if(l[p]===d)continue e;t&&l.push(d),s.push(u)}else r(l,d,n)||(l!==s&&l.push(d),s.push(u))}return s}function Xn(e,t){return null==(e=Ro(e,t=Qn(t,e)))||delete e[Do(qo(t))]}function Zn(e,t){var n=e;return n instanceof ln&&(n=n.value()),Ye(t,(function(e,t){return t.func.apply(t.thisArg,Ke([e],t.args))}),n)}function Qn(e,t){return rr(e)?e:Mo(e,t)?[e]:jo(_r(e))}function eo(e,t){if(t)return e.slice();var n=e.length,o=kt?kt(n):new e.constructor(n);return e.copy(o),o}function to(e){var t=new e.constructor(e.byteLength);return new $t(t).set(new $t(e)),t}function no(e,t){var n=t?to(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function oo(e,t){if(e!==t){var n=e!==o,r=null===e,i=e==e,a=vr(e),s=t!==o,l=null===t,c=t==t,u=vr(t);if(!l&&!u&&!a&&e>t||a&&s&&c&&!l&&!u||r&&s&&c||!n&&c||!i)return 1;if(!r&&!a&&!u&&e<t||u&&n&&i&&!r&&!a||l&&n&&i||!s&&i||!c)return-1}return 0}function ro(e,t){var n=-1,o=e.length;for(t||(t=Array(o));++n<o;)t[n]=e[n];return t}function io(e,t,n,r){var i=!n;n||(n={});for(var a=-1,s=t.length;++a<s;){var l=t[a],c=r?r(n[l],e[l],l,n,e):o;c===o&&(c=e[l]),i?wn(n,l,c):vn(n,l,c)}return n}function ao(e,t){return function(n,o){var r=rr(n)?We:yn,i=t?t():{};return r(n,e,go(o,2),i)}}function so(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=rn(e.prototype),o=e.apply(n,t);return ur(o)?o:n}}var lo=qt&&1/st(new qt([,-0]))[1]==p?function(e){return new qt(e)}:Ur;function co(e){return mr(e)?o:e}function uo(e,t,n,r,i,a){var s=n&u,l=e.length,c=t.length;if(l!=c&&!(s&&c>l))return!1;var p=a.get(e);if(p&&a.get(t))return p==t;var m=-1,f=!0,h=n&d?new pn:o;for(a.set(e,t),a.set(t,e);++m<l;){var g=e[m],v=t[m];if(r)var b=s?r(v,g,m,t,e,a):r(g,v,m,e,t,a);if(b!==o){if(b)continue;f=!1;break}if(h){if(!Je(t,(function(e,t){if(!nt(h,t)&&(g===e||i(g,e,n,r,a)))return h.push(t)}))){f=!1;break}}else if(g!==v&&!i(g,v,n,r,a)){f=!1;break}}return a.delete(e),a.delete(t),f}function po(e){return xo(Io(e,o,Vo),e+"")}function mo(e){return An(e,Cr,yo)}function fo(e){return An(e,Er,wo)}var ho=Gt?function(e){return Gt.get(e)}:Ur;function go(){var e=on.iteratee||Dr;return e=e===Dr?Nn:e,arguments.length?e(arguments[0],arguments[1]):e}function vo(e,t){var n,o,r=e.__data__;return("string"==(o=typeof(n=t))||"number"==o||"symbol"==o||"boolean"==o?"__proto__"!==n:null===n)?r["string"==typeof t?"string":"hash"]:r.map}function bo(e,t){var n=function(e,t){return null==e?o:e[t]}(e,t);return function(e){return!(!ur(e)||(t=e,ht&&ht in t))&&(lr(e)?bt:se).test(No(e));var t}(n)?n:o}var yo=At?function(e){return null==e?[]:(e=Object(e),qe(At(e),(function(t){return Pt.call(e,t)})))}:Br,wo=At?function(e){for(var t=[];e;)Ke(t,yo(e)),e=St(e);return t}:Br,$o=xn;function ko(e){return"function"!=typeof e.constructor||To(e)?{}:rn(St(e))}function So(e){return rr(e)||or(e)||!!(Tt&&e&&e[Tt])}function _o(e,t){var n=typeof e;return!!(t=null==t?m:t)&&("number"==n||"symbol"!=n&&ce.test(e))&&e>-1&&e%1==0&&e<t}function Po(e,t,n){if(!ur(n))return!1;var o=typeof t;return!!("number"==o?ir(n)&&_o(t,n.length):"string"==o&&t in n)&&nr(n[t],e)}function Mo(e,t){if(rr(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!vr(e))||X.test(e)||!J.test(e)||null!=t&&e in Object(t)}function To(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||dt)}function Co(e){return e==e&&!ur(e)}function Eo(e,t){return function(n){return null!=n&&n[e]===t&&(t!==o||e in Object(n))}}function Io(e,t,n){return t=jt(t===o?e.length-1:t,0),function(){for(var o=arguments,r=-1,i=jt(o.length-t,0),a=Array(i);++r<i;)a[r]=o[t+r];r=-1;for(var s=Array(t+1);++r<t;)s[r]=o[r];return s[t]=n(a),Be(e,this,s)}}function Ro(e,t){return t.length<2?e:Rn(e,Gn(t,0,-1))}(Bt&&$o(new Bt(new ArrayBuffer(1)))!=F||Wt&&$o(new Wt)!=T||Vt&&$o(Vt.resolve())!=R||qt&&$o(new qt)!=L||zt&&$o(new zt)!=N)&&($o=function(e){var t=xn(e),n=t==I?e.constructor:o,r=n?No(n):"";if(r)switch(r){case Yt:return F;case Jt:return T;case Xt:return R;case Zt:return L;case Qt:return N}return t});var Ao=Lo(qn),xo=Lo(zn);function Lo(e){var t=0,n=0;return function(){var r=Nt(),i=16-(r-n);if(n=r,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(o,arguments)}}function Oo(e,t){var n,r,i=-1,a=e.length,s=a-1;for(t=t===o?a:t;++i<t;){var l=(r=s,(n=i)+Rt(Ut()*(r-n+1))),c=e[l];e[l]=e[i],e[i]=c}return e.length=t,e}var jo=function(){var e=er((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Z,(function(e,n,o,r){t.push(o?r.replace(oe,"$1"):n||e)})),t}),(function(e){return 500===t.size&&t.clear(),e})),t=e.cache;return e}();function Do(e){if("string"==typeof e||vr(e))return e;var t=e+"";return"0"==t&&1/e==-p?"-0":t}function No(e){if(null!=e){try{return mt.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Uo(e){if(e instanceof ln)return e.clone();var t=new sn(e.__wrapped__,e.__chain__);return t.__actions__=ro(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Fo=Vn((function(e,t){return ar(e)?kn(e,Tn(t,1,ar,!0)):[]})),Bo=Vn((function(e,t){var n=qo(t);return ar(n)&&(n=o),ar(e)?kn(e,Tn(t,1,ar,!0),go(n,2)):[]}));function Wo(e,t,n){var o=null==e?0:e.length;if(!o)return-1;var r=null==n?0:$r(n);return r<0&&(r=jt(o+r,0)),Xe(e,go(t,3),r)}function Vo(e){return null!=e&&e.length?Tn(e,1):[]}function qo(e){var t=null==e?0:e.length;return t?e[t-1]:o}function zo(e){return null==e?e:Ft.call(e)}function Ho(e){var t=on(e);return t.__chain__=!0,t}function Go(e,t){return t(e)}po((function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,i=function(t){return function(e,t){for(var n=-1,r=t.length,i=Array(r),a=null==e;++n<r;)i[n]=a?o:Mr(e,t[n]);return i}(t,e)};return!(t>1||this.__actions__.length)&&r instanceof ln&&_o(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:Go,args:[i],thisArg:o}),new sn(r,this.__chain__).thru((function(e){return t&&!e.length&&e.push(o),e}))):this.thru(i)}));var Ko,Yo=(Ko=Wo,function(e,t,n){var r=Object(e);if(!ir(e)){var i=go(t,3);e=Cr(e),t=function(e){return i(r[e],e,r)}}var a=Ko(e,t,n);return a>-1?r[i?e[a]:a]:o});function Jo(e,t){return(rr(e)?Ve:_n)(e,go(t,3))}var Xo=ao((function(e,t,n){ft.call(e,n)?e[n].push(t):wn(e,n,[t])})),Zo=ao((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]})),Qo=Vn((function(e,t){if(null==e)return[];var n=t.length;return n>1&&Po(e,t[0],t[1])?t=[]:n>2&&Po(t[0],t[1],t[2])&&(t=[t[0]]),Wn(e,Tn(t,1),[])}));function er(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(r);var n=function(){var o=arguments,r=t?t.apply(this,o):o[0],i=n.cache;if(i.has(r))return i.get(r);var a=e.apply(this,o);return n.cache=i.set(r,a)||i,a};return n.cache=new(er.Cache||dn),n}function tr(e){if("function"!=typeof e)throw new TypeError(r);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function nr(e,t){return e===t||e!=e&&t!=t}er.Cache=dn;var or=jn(function(){return arguments}())?jn:function(e){return dr(e)&&ft.call(e,"callee")&&!Pt.call(e,"callee")},rr=Array.isArray;function ir(e){return null!=e&&cr(e.length)&&!lr(e)}function ar(e){return dr(e)&&ir(e)}var sr=xt||Wr;function lr(e){if(!ur(e))return!1;var t=xn(e);return t==P||t==M||t==$||t==A}function cr(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=m}function ur(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function dr(e){return null!=e&&"object"==typeof e}var pr=De?tt(De):function(e){return dr(e)&&$o(e)==T};function mr(e){if(!dr(e)||xn(e)!=I)return!1;var t=St(e);if(null===t)return!0;var n=ft.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&mt.call(n)==vt}var fr=Ne?tt(Ne):function(e){return dr(e)&&xn(e)==x},hr=Ue?tt(Ue):function(e){return dr(e)&&$o(e)==L};function gr(e){return"string"==typeof e||!rr(e)&&dr(e)&&xn(e)==O}function vr(e){return"symbol"==typeof e||dr(e)&&xn(e)==j}var br=Fe?tt(Fe):function(e){return dr(e)&&cr(e.length)&&!!Me[xn(e)]};function yr(e){if(!e)return[];if(ir(e))return gr(e)?lt(e):ro(e);if(Ct&&e[Ct])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[Ct]());var t=$o(e);return(t==T?rt:t==L?st:Lr)(e)}function wr(e){return e?(e=kr(e))===p||e===-p?(e<0?-1:1)*f:e==e?e:0:0===e?e:0}function $r(e){var t=wr(e),n=t%1;return t==t?n?t-n:t:0}function kr(e){if("number"==typeof e)return e;if(vr(e))return h;if(ur(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ur(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(Q,"");var n=ae.test(e);return n||le.test(e)?Ce(e.slice(2),n?2:8):ie.test(e)?h:+e}function Sr(e){return io(e,Er(e))}function _r(e){return null==e?"":Yn(e)}var Pr=Vn((function(e,t){e=Object(e);var n=-1,r=t.length,i=r>2?t[2]:o;for(i&&Po(t[0],t[1],i)&&(r=1);++n<r;)for(var a=t[n],s=Er(a),l=-1,c=s.length;++l<c;){var u=s[l],d=e[u];(d===o||nr(d,dt[u])&&!ft.call(e,u))&&(e[u]=a[u])}return e}));function Mr(e,t,n){var r=null==e?o:Rn(e,t);return r===o?n:r}function Tr(e,t){return null!=e&&function(e,t,n){for(var o=-1,r=(t=Qn(t,e)).length,i=!1;++o<r;){var a=Do(t[o]);if(!(i=null!=e&&n(e,a)))break;e=e[a]}return i||++o!=r?i:!!(r=null==e?0:e.length)&&cr(r)&&_o(a,r)&&(rr(e)||or(e))}(e,t,On)}function Cr(e){return ir(e)?fn(e):function(e){if(!To(e))return Ot(e);var t=[];for(var n in Object(e))ft.call(e,n)&&"constructor"!=n&&t.push(n);return t}(e)}function Er(e){return ir(e)?fn(e,!0):function(e){if(!ur(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=To(e),n=[];for(var o in e)("constructor"!=o||!t&&ft.call(e,o))&&n.push(o);return n}(e)}var Ir,Rr,Ar=(Ir=function(e,t,n){Bn(e,t,n)},Vn((function(e,t){var n=-1,r=t.length,i=r>1?t[r-1]:o,a=r>2?t[2]:o;for(i=Ir.length>3&&"function"==typeof i?(r--,i):o,a&&Po(t[0],t[1],a)&&(i=r<3?o:i,r=1),e=Object(e);++n<r;){var s=t[n];s&&Ir(e,s,n)}return e}))),xr=po((function(e,t){var n={};if(null==e)return n;var o=!1;t=Ge(t,(function(t){return t=Qn(t,e),o||(o=t.length>1),t})),io(e,fo(e),n),o&&(n=$n(n,s|l|c,co));for(var r=t.length;r--;)Xn(n,t[r]);return n}));function Lr(e){return null==e?[]:function(e,t){return Ge(t,(function(t){return e[t]}))}(e,Cr(e))}function Or(e){return function(){return e}}function jr(e){return e}function Dr(e){return Nn("function"==typeof e?e:$n(e,s))}function Nr(e,t,n){var o=Cr(t),r=In(t,o);null!=n||ur(t)&&(r.length||!o.length)||(n=t,t=e,e=this,r=In(t,Cr(t)));var i=!(ur(n)&&"chain"in n&&!n.chain),a=lr(e);return Ve(r,(function(n){var o=t[n];e[n]=o,a&&(e.prototype[n]=function(){var t=this.__chain__;if(i||t){var n=e(this.__wrapped__);return(n.__actions__=ro(this.__actions__)).push({func:o,args:arguments,thisArg:e}),n.__chain__=t,n}return o.apply(e,Ke([this.value()],arguments))})})),e}function Ur(){}function Fr(e){return Mo(e)?(t=Do(e),function(e){return null==e?o:e[t]}):function(e){return function(t){return Rn(t,e)}}(e);var t}function Br(){return[]}function Wr(){return!1}on.chain=Ho,on.compact=function(e){for(var t=-1,n=null==e?0:e.length,o=0,r=[];++t<n;){var i=e[t];i&&(r[o++]=i)}return r},on.concat=function(){var e=arguments.length;if(!e)return[];for(var t=Array(e-1),n=arguments[0],o=e;o--;)t[o-1]=arguments[o];return Ke(rr(n)?ro(n):[n],Tn(t,1))},on.constant=Or,on.defaults=Pr,on.difference=Fo,on.differenceBy=Bo,on.filter=function(e,t){return(rr(e)?qe:Mn)(e,go(t,3))},on.flatten=Vo,on.groupBy=Xo,on.iteratee=Dr,on.keys=Cr,on.keysIn=Er,on.map=function(e,t){return(rr(e)?Ge:Fn)(e,go(t,3))},on.memoize=er,on.merge=Ar,on.mixin=Nr,on.negate=tr,on.omit=xr,on.orderBy=function(e,t,n,r){return null==e?[]:(rr(t)||(t=null==t?[]:[t]),rr(n=r?o:n)||(n=null==n?[]:[n]),Wn(e,t,n))},on.partition=Zo,on.property=Fr,on.reject=function(e,t){return(rr(e)?qe:Mn)(e,tr(go(t,3)))},on.reverse=zo,on.shuffle=function(e){return(rr(e)?hn:Hn)(e)},on.slice=function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&Po(e,t,n)?(t=0,n=r):(t=null==t?0:$r(t),n=n===o?r:$r(n)),Gn(e,t,n)):[]},on.sortBy=Qo,on.split=function(e,t,n){return n&&"number"!=typeof n&&Po(e,t,n)&&(t=n=o),(n=n===o?g:n>>>0)?(e=_r(e))&&("string"==typeof t||null!=t&&!fr(t))&&!(t=Yn(t))&&ot(e)?(r=lt(e),i=n,a=r.length,(i=i===o?a:i)>=a?r:Gn(r,0,i)):e.split(t,n):[];var r,i,a},on.tap=function(e,t){return t(e),e},on.thru=Go,on.toArray=yr,on.toPlainObject=Sr,on.uniq=function(e){return e&&e.length?Jn(e):[]},on.uniqBy=function(e,t){return e&&e.length?Jn(e,go(t,2)):[]},on.values=Lr,Nr(on,on),on.clone=function(e){return $n(e,c)},on.cloneDeep=function(e){return $n(e,s|c)},on.eq=nr,on.find=Yo,on.findIndex=Wo,on.forEach=Jo,on.get=Mr,on.hasIn=Tr,on.identity=jr,on.includes=function(e,t,n,o){e=ir(e)?e:Lr(e),n=n&&!o?$r(n):0;var r=e.length;return n<0&&(n=jt(r+n,0)),gr(e)?n<=r&&e.indexOf(t,n)>-1:!!r&&Ze(e,t,n)>-1},on.isArguments=or,on.isArray=rr,on.isArrayLike=ir,on.isArrayLikeObject=ar,on.isBuffer=sr,on.isFunction=lr,on.isLength=cr,on.isMap=pr,on.isObject=ur,on.isObjectLike=dr,on.isPlainObject=mr,on.isRegExp=fr,on.isSet=hr,on.isString=gr,on.isSymbol=vr,on.isTypedArray=br,on.join=function(e,t){return null==e?"":Lt.call(e,t)},on.last=qo,on.max=function(e){return e&&e.length?Pn(e,jr,Ln):o},on.maxBy=function(e,t){return e&&e.length?Pn(e,go(t,2),Ln):o},on.min=function(e){return e&&e.length?Pn(e,jr,Un):o},on.minBy=function(e,t){return e&&e.length?Pn(e,go(t,2),Un):o},on.stubArray=Br,on.stubFalse=Wr,on.noop=Ur,on.reduce=function(e,t,n){var o=rr(e)?Ye:et,r=arguments.length<3;return o(e,go(t,4),n,r,_n)},on.some=function(e,t,n){var r=rr(e)?Je:Kn;return n&&Po(e,t,n)&&(t=o),r(e,go(t,3))},on.sortedIndexBy=function(e,t,n){return function(e,t,n){t=n(t);for(var r=0,i=null==e?0:e.length,a=t!=t,s=null===t,l=vr(t),c=t===o;r<i;){var u=Rt((r+i)/2),d=n(e[u]),p=d!==o,m=null===d,f=d==d,h=vr(d);if(a)var g=f;else g=c?f&&p:s?f&&p&&!m:l?f&&p&&!m&&!h:!m&&!h&&d<t;g?r=u+1:i=u}return Dt(i,v)}(e,t,go(n,2))},on.toFinite=wr,on.toInteger=$r,on.toNumber=kr,on.toString=_r,on.each=Jo,Nr(on,(Rr={},En(on,(function(e,t){ft.call(on.prototype,t)||(Rr[t]=e)})),Rr),{chain:!1}),on.VERSION="4.17.5",Ve(["drop","take"],(function(e,t){ln.prototype[e]=function(n){n=n===o?1:jt($r(n),0);var r=this.__filtered__&&!t?new ln(this):this.clone();return r.__filtered__?r.__takeCount__=Dt(n,r.__takeCount__):r.__views__.push({size:Dt(n,g),type:e+(r.__dir__<0?"Right":"")}),r},ln.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),Ve(["filter","map","takeWhile"],(function(e,t){var n=t+1,o=1==n||3==n;ln.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:go(e,3),type:n}),t.__filtered__=t.__filtered__||o,t}})),Ve(["head","last"],(function(e,t){var n="take"+(t?"Right":"");ln.prototype[e]=function(){return this[n](1).value()[0]}})),Ve(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");ln.prototype[e]=function(){return this.__filtered__?new ln(this):this[n](1)}})),ln.prototype.compact=function(){return this.filter(jr)},ln.prototype.find=function(e){return this.filter(e).head()},ln.prototype.findLast=function(e){return this.reverse().find(e)},ln.prototype.invokeMap=Vn((function(e,t){return"function"==typeof e?new ln(this):this.map((function(n){return function(e,t,n){var r=null==(e=Ro(e,t=Qn(t,e)))?e:e[Do(qo(t))];return null==r?o:Be(r,e,n)}(n,e,t)}))})),ln.prototype.reject=function(e){return this.filter(tr(go(e)))},ln.prototype.slice=function(e,t){e=$r(e);var n=this;return n.__filtered__&&(e>0||t<0)?new ln(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==o&&(n=(t=$r(t))<0?n.dropRight(-t):n.take(t-e)),n)},ln.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},ln.prototype.toArray=function(){return this.take(g)},En(ln.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),i=on[r?"take"+("last"==t?"Right":""):t],a=r||/^find/.test(t);i&&(on.prototype[t]=function(){var t=this.__wrapped__,s=r?[1]:arguments,l=t instanceof ln,c=s[0],u=l||rr(t),d=function(e){var t=i.apply(on,Ke([e],s));return r&&p?t[0]:t};u&&n&&"function"==typeof c&&1!=c.length&&(l=u=!1);var p=this.__chain__,m=!!this.__actions__.length,f=a&&!p,h=l&&!m;if(!a&&u){t=h?t:new ln(this);var g=e.apply(t,s);return g.__actions__.push({func:Go,args:[d],thisArg:o}),new sn(g,p)}return f&&h?e.apply(this,s):(g=this.thru(d),f?r?g.value()[0]:g.value():g)})})),Ve(["pop","push","shift","sort","splice","unshift"],(function(e){var t=ct[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",o=/^(?:pop|shift)$/.test(e);on.prototype[e]=function(){var e=arguments;if(o&&!this.__chain__){var r=this.value();return t.apply(rr(r)?r:[],e)}return this[n]((function(n){return t.apply(rr(n)?n:[],e)}))}})),En(ln.prototype,(function(e,t){var n=on[t];if(n){var o=n.name+"";(Kt[o]||(Kt[o]=[])).push({name:t,func:n})}})),Kt[function e(t,n,r,i,s,l,c,u,d,p){var m=128&n,f=1&n,h=2&n,g=24&n,v=512&n,y=h?o:so(t);return function w(){for(var $=arguments.length,k=Array($),S=$;S--;)k[S]=arguments[S];if(g)var _=function(e){return(ft.call(on,"placeholder")?on:e).placeholder}(w),P=function(e,t){for(var n=e.length,o=0;n--;)e[n]===t&&++o;return o}(k,_);if(i&&(k=function(e,t,n,o){for(var r=-1,i=e.length,a=n.length,s=-1,l=t.length,c=jt(i-a,0),u=Array(l+c),d=!o;++s<l;)u[s]=t[s];for(;++r<a;)(d||r<i)&&(u[n[r]]=e[r]);for(;c--;)u[s++]=e[r++];return u}(k,i,s,g)),l&&(k=function(e,t,n,o){for(var r=-1,i=e.length,a=-1,s=n.length,l=-1,c=t.length,u=jt(i-s,0),d=Array(u+c),p=!o;++r<u;)d[r]=e[r];for(var m=r;++l<c;)d[m+l]=t[l];for(;++a<s;)(p||r<i)&&(d[m+n[a]]=e[r++]);return d}(k,l,c,g)),$-=P,g&&$<p){var M=function(e,t){for(var n=-1,o=e.length,r=0,i=[];++n<o;){var s=e[n];s!==t&&s!==a||(e[n]=a,i[r++]=n)}return i}(k,_);return function(e,t,n,r,i,a,s,l,c,u){var d=8&t;t|=d?32:64,4&(t&=~(d?64:32))||(t&=-4);var p=[e,t,i,d?a:o,d?s:o,d?o:a,d?o:s,l,c,u],m=n.apply(o,p);return function(e){var t=function(e){for(var t=e.name+"",n=Kt[t],o=ft.call(Kt,t)?n.length:0;o--;){var r=n[o],i=r.func;if(null==i||i==e)return r.name}return t}(e),n=on[t];if("function"!=typeof n||!(t in ln.prototype))return!1;if(e===n)return!0;var o=ho(n);return!!o&&e===o[0]}(e)&&Ao(m,p),m.placeholder=r,function(e,t,n){var o=t+"";return xo(e,function(e,t){var n=t.length;if(!n)return e;var o=n-1;return t[o]=(n>1?"& ":"")+t[o],t=t.join(n>2?", ":" "),e.replace(ee,"{\n/* [wrapped with "+t+"] */\n")}(o,function(e,t){return Ve(b,(function(n){var o="_."+n[0];t&n[1]&&!ze(e,o)&&e.push(o)})),e.sort()}(function(e){var t=e.match(te);return t?t[1].split(ne):[]}(o),n)))}(m,e,t)}(t,n,e,w.placeholder,r,k,M,u,d,p-$)}var T=f?r:this,C=h?T[t]:t;return $=k.length,u?k=function(e,t){for(var n=e.length,r=Dt(t.length,n),i=ro(e);r--;){var a=t[r];e[r]=_o(a,n)?i[a]:o}return e}(k,u):v&&$>1&&k.reverse(),m&&d<$&&(k.length=d),this&&this!==Re&&this instanceof w&&(C=y||so(C)),C.apply(T,k)}}(o,2).name]=[{name:"wrapper",func:o}],ln.prototype.clone=function(){var e=new ln(this.__wrapped__);return e.__actions__=ro(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=ro(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=ro(this.__views__),e},ln.prototype.reverse=function(){if(this.__filtered__){var e=new ln(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},ln.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=rr(e),o=t<0,r=n?e.length:0,i=function(e,t,n){for(var o=-1,r=n.length;++o<r;){var i=n[o],a=i.size;switch(i.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=Dt(t,e+a);break;case"takeRight":e=jt(e,t-a)}}return{start:e,end:t}}(0,r,this.__views__),a=i.start,s=i.end,l=s-a,c=o?s:a-1,u=this.__iteratees__,d=u.length,p=0,m=Dt(l,this.__takeCount__);if(!n||!o&&r==l&&m==l)return Zn(e,this.__actions__);var f=[];e:for(;l--&&p<m;){for(var h=-1,g=e[c+=t];++h<d;){var v=u[h],b=v.iteratee,y=v.type,w=b(g);if(2==y)g=w;else if(!w){if(1==y)continue e;break e}}f[p++]=g}return f},on.prototype.chain=function(){return Ho(this)},on.prototype.commit=function(){return new sn(this.value(),this.__chain__)},on.prototype.next=function(){this.__values__===o&&(this.__values__=yr(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?o:this.__values__[this.__index__++]}},on.prototype.plant=function(e){for(var t,n=this;n instanceof an;){var r=Uo(n);r.__index__=0,r.__values__=o,t?i.__wrapped__=r:t=r;var i=r;n=n.__wrapped__}return i.__wrapped__=e,t},on.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof ln){var t=e;return this.__actions__.length&&(t=new ln(this)),(t=t.reverse()).__actions__.push({func:Go,args:[zo],thisArg:o}),new sn(t,this.__chain__)}return this.thru(zo)},on.prototype.toJSON=on.prototype.valueOf=on.prototype.value=function(){return Zn(this.__wrapped__,this.__actions__)},on.prototype.first=on.prototype.head,Ct&&(on.prototype[Ct]=function(){return this}),Re._=on}).call(e)}(i,i.exports),angular.module("bandlab.account",[]);var s=function e(t,n){function o(e,o,r){if("undefined"!=typeof document){"number"==typeof(r=a({},n,r)).expires&&(r.expires=new Date(Date.now()+864e5*r.expires)),r.expires&&(r.expires=r.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var i="";for(var s in r)r[s]&&(i+="; "+s,!0!==r[s]&&(i+="="+r[s].split(";")[0]));return document.cookie=e+"="+t.write(o,e)+i}}return Object.create({set:o,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var n=document.cookie?document.cookie.split("; "):[],o={},r=0;r<n.length;r++){var i=n[r].split("="),a=i.slice(1).join("=");try{var s=decodeURIComponent(i[0]);if(o[s]=t.read(a,s),e===s)break}catch(e){}}return e?o[e]:o}},remove:function(e,t){o(e,"",a({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,a({},this.attributes,t))},withConverter:function(t){return e(a({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});const l=s.withAttributes({path:"/",secure:!0});function c(e){l.set("sessionKey",e.sessionKey||e.access_token,{expires:365}),e.refresh_token&&l.set("refreshToken",e.refresh_token,{expires:365})}function u(){return"true"===l.get("doNotTrack")}function d(){return l.get("sessionKey")}function p(){return"true"===l.get("webview")}function m(){return(Math.random()+1).toString(36).substring(2,13)}function f(e,t){const n=new Set(e.split(","));return t?e=>n.has(e.toLowerCase()):e=>n.has(e)}l.put=function(e,t,n){if(void 0!==t)return l.set(e,t,n)},angular.module("bandlab.account").controller("AuthCtrl",["$scope",function(e){e.$on("auth:start",(function(){e.waitingForAuth=!0})),e.$on("auth:error",(function(){e.waitingForAuth=!1})),e.$on("ageRestrictedError",(function(){e.ageError=!0})),e.hasAgeRestrictedCookie=function(){return"true"===l.get("ageRestricted")}}]),angular.module("bandlab.account").controller("SnsConnectCtrl",["$scope","authService",function(e,t){e.snsConnect=function(e,n){t.setAfterAuthState();const o=new URLSearchParams({redirect_uri:"https://www.bandlab.com/auth/bandlab/callback",nonce:m()});n&&o.append("state",n);const r=`https://accounts.bandlab.com/oauth/connect/authorize?client_id=bandlab_web&scope=openid+profile+email+linked_accounts+offline_access&response_type=code&response_mode=fragment&auth_type=bandlab_auth_code&${o.toString()}`;window.location.href=`https://accounts.bandlab.com/login?provider=${e}&ReturnUrl=${encodeURIComponent(r)}`}}]);const h={},g=[],v=()=>{},b=()=>!1,y=e=>111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),w=e=>e.startsWith("onUpdate:"),$=Object.assign,k=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},S=Object.prototype.hasOwnProperty,P=(e,t)=>S.call(e,t),M=Array.isArray,T=e=>"[object Map]"===j(e),C=e=>"[object Set]"===j(e),E=e=>"[object Date]"===j(e),I=e=>"function"==typeof e,R=e=>"string"==typeof e,A=e=>"symbol"==typeof e,x=e=>null!==e&&"object"==typeof e,L=e=>(x(e)||I(e))&&I(e.then)&&I(e.catch),O=Object.prototype.toString,j=e=>O.call(e),D=e=>j(e).slice(8,-1),N=e=>"[object Object]"===j(e),U=e=>R(e)&&"NaN"!==e&&"-"!==e[0]&&""+parseInt(e,10)===e,F=f(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),B=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},W=/-(\w)/g,V=B((e=>e.replace(W,((e,t)=>t?t.toUpperCase():"")))),q=/\B([A-Z])/g,z=B((e=>e.replace(q,"-$1").toLowerCase())),H=B((e=>e.charAt(0).toUpperCase()+e.slice(1))),G=B((e=>e?`on${H(e)}`:"")),K=(e,t)=>!Object.is(e,t),Y=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];for(let t=0;t<e.length;t++)e[t](...n)},J=function(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:o,value:n})},X=e=>{const t=parseFloat(e);return isNaN(t)?e:t},Z=e=>{const t=R(e)?Number(e):NaN;return isNaN(t)?e:t};let Q;const ee=()=>Q||(Q="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{});function te(e){if(M(e)){const t={};for(let n=0;n<e.length;n++){const o=e[n],r=R(o)?ie(o):te(o);if(r)for(const e in r)t[e]=r[e]}return t}if(R(e)||x(e))return e}const ne=/;(?![^(]*\))/g,oe=/:([^]+)/,re=/\/\*[^]*?\*\//g;function ie(e){const t={};return e.replace(re,"").split(ne).forEach((e=>{if(e){const n=e.split(oe);n.length>1&&(t[n[0].trim()]=n[1].trim())}})),t}function ae(e){let t="";if(R(e))t=e;else if(M(e))for(let n=0;n<e.length;n++){const o=ae(e[n]);o&&(t+=o+" ")}else if(x(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}function se(e){if(!e)return null;let{class:t,style:n}=e;return t&&!R(t)&&(e.class=ae(t)),n&&(e.style=te(n)),e}const le=f("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function ce(e){return!!e||""===e}function ue(e,t){if(e===t)return!0;let n=E(e),o=E(t);if(n||o)return!(!n||!o)&&e.getTime()===t.getTime();if(n=A(e),o=A(t),n||o)return e===t;if(n=M(e),o=M(t),n||o)return!(!n||!o)&&function(e,t){if(e.length!==t.length)return!1;let n=!0;for(let o=0;n&&o<e.length;o++)n=ue(e[o],t[o]);return n}(e,t);if(n=x(e),o=x(t),n||o){if(!n||!o)return!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e){const o=e.hasOwnProperty(n),r=t.hasOwnProperty(n);if(o&&!r||!o&&r||!ue(e[n],t[n]))return!1}}return String(e)===String(t)}function de(e,t){return e.findIndex((e=>ue(e,t)))}const pe=e=>!(!e||!0!==e.__v_isRef),me=e=>R(e)?e:null==e?"":M(e)||x(e)&&(e.toString===O||!I(e.toString))?pe(e)?me(e.value):JSON.stringify(e,fe,2):String(e),fe=(e,t)=>pe(t)?fe(e,t.value):T(t)?{[`Map(${t.size})`]:[...t.entries()].reduce(((e,t,n)=>{let[o,r]=t;return e[he(o,n)+" =>"]=r,e}),{})}:C(t)?{[`Set(${t.size})`]:[...t.values()].map((e=>he(e)))}:A(t)?he(t):!x(t)||M(t)||N(t)?t:String(t),he=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";var n;return A(e)?`Symbol(${null!=(n=e.description)?n:t})`:e};let ge,ve;class be{constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=ge,!e&&ge&&(this.index=(ge.scopes||(ge.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const t=ge;try{return ge=this,e()}finally{ge=t}}}on(){ge=this}off(){ge=this.parent}stop(e){if(this._active){let t,n;for(t=0,n=this.effects.length;t<n;t++)this.effects[t].stop();for(t=0,n=this.cleanups.length;t<n;t++)this.cleanups[t]();if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].stop(!0);if(!this.detached&&this.parent&&!e){const e=this.parent.scopes.pop();e&&e!==this&&(this.parent.scopes[this.index]=e,e.index=this.index)}this.parent=void 0,this._active=!1}}}function ye(){return ge}function we(e){ge&&ge.cleanups.push(e)}class $e{constructor(e,t,n,o){this.fn=e,this.trigger=t,this.scheduler=n,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ge;t&&t.active&&t.effects.push(e)}(this,o)}get dirty(){if(2===this._dirtyLevel||3===this._dirtyLevel){this._dirtyLevel=1,Ee();for(let e=0;e<this._depsLength;e++){const t=this.deps[e];if(t.computed&&(ke(t.computed),this._dirtyLevel>=4))break}1===this._dirtyLevel&&(this._dirtyLevel=0),Ie()}return this._dirtyLevel>=4}set dirty(e){this._dirtyLevel=e?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let e=Me,t=ve;try{return Me=!0,ve=this,this._runnings++,Se(this),this.fn()}finally{_e(this),this._runnings--,ve=t,Me=e}}stop(){this.active&&(Se(this),_e(this),this.onStop&&this.onStop(),this.active=!1)}}function ke(e){return e.value}function Se(e){e._trackId++,e._depsLength=0}function _e(e){if(e.deps.length>e._depsLength){for(let t=e._depsLength;t<e.deps.length;t++)Pe(e.deps[t],e);e.deps.length=e._depsLength}}function Pe(e,t){const n=e.get(t);void 0!==n&&t._trackId!==n&&(e.delete(t),0===e.size&&e.cleanup())}let Me=!0,Te=0;const Ce=[];function Ee(){Ce.push(Me),Me=!1}function Ie(){const e=Ce.pop();Me=void 0===e||e}function Re(){Te++}function Ae(){for(Te--;!Te&&Le.length;)Le.shift()()}function xe(e,t,n){if(t.get(e)!==e._trackId){t.set(e,e._trackId);const n=e.deps[e._depsLength];n!==t?(n&&Pe(n,e),e.deps[e._depsLength++]=t):e._depsLength++}}const Le=[];function Oe(e,t,n){Re();for(const n of e.keys()){let o;n._dirtyLevel<t&&(null!=o?o:o=e.get(n)===n._trackId)&&(n._shouldSchedule||(n._shouldSchedule=0===n._dirtyLevel),n._dirtyLevel=t),n._shouldSchedule&&(null!=o?o:o=e.get(n)===n._trackId)&&(n.trigger(),n._runnings&&!n.allowRecurse||2===n._dirtyLevel||(n._shouldSchedule=!1,n.scheduler&&Le.push(n.scheduler)))}Ae()}const je=(e,t)=>{const n=new Map;return n.cleanup=e,n.computed=t,n},De=new WeakMap,Ne=Symbol(""),Ue=Symbol("");function Fe(e,t,n){if(Me&&ve){let t=De.get(e);t||De.set(e,t=new Map);let o=t.get(n);o||t.set(n,o=je((()=>t.delete(n)))),xe(ve,o)}}function Be(e,t,n,o,r,i){const a=De.get(e);if(!a)return;let s=[];if("clear"===t)s=[...a.values()];else if("length"===n&&M(e)){const e=Number(o);a.forEach(((t,n)=>{("length"===n||!A(n)&&n>=e)&&s.push(t)}))}else switch(void 0!==n&&s.push(a.get(n)),t){case"add":M(e)?U(n)&&s.push(a.get("length")):(s.push(a.get(Ne)),T(e)&&s.push(a.get(Ue)));break;case"delete":M(e)||(s.push(a.get(Ne)),T(e)&&s.push(a.get(Ue)));break;case"set":T(e)&&s.push(a.get(Ne))}Re();for(const e of s)e&&Oe(e,4);Ae()}const We=f("__proto__,__v_isRef,__isVue"),Ve=new Set(Object.getOwnPropertyNames(Symbol).filter((e=>"arguments"!==e&&"caller"!==e)).map((e=>Symbol[e])).filter(A)),qe=ze();function ze(){const e={};return["includes","indexOf","lastIndexOf"].forEach((t=>{e[t]=function(){const e=Ot(this);for(let t=0,n=this.length;t<n;t++)Fe(e,0,t+"");for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];const i=e[t](...o);return-1===i||!1===i?e[t](...o.map(Ot)):i}})),["push","pop","shift","unshift","splice"].forEach((t=>{e[t]=function(){Ee(),Re();for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];const r=Ot(this)[t].apply(this,n);return Ae(),Ie(),r}})),e}function He(e){A(e)||(e=String(e));const t=Ot(this);return Fe(t,0,e),t.hasOwnProperty(e)}class Ge{constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._isReadonly=e,this._isShallow=t}get(e,t,n){const o=this._isReadonly,r=this._isShallow;if("__v_isReactive"===t)return!o;if("__v_isReadonly"===t)return o;if("__v_isShallow"===t)return r;if("__v_raw"===t)return n===(o?r?Pt:_t:r?St:kt).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const i=M(e);if(!o){if(i&&P(qe,t))return Reflect.get(qe,t,n);if("hasOwnProperty"===t)return He}const a=Reflect.get(e,t,n);return(A(t)?Ve.has(t):We(t))?a:(o||Fe(e,0,t),r?a:Wt(a)?i&&U(t)?a:a.value:x(a)?o?Ct(a):Mt(a):a)}}class Ke extends Ge{constructor(){super(!1,arguments.length>0&&void 0!==arguments[0]&&arguments[0])}set(e,t,n,o){let r=e[t];if(!this._isShallow){const t=At(r);if(xt(n)||At(n)||(r=Ot(r),n=Ot(n)),!M(e)&&Wt(r)&&!Wt(n))return!t&&(r.value=n,!0)}const i=M(e)&&U(t)?Number(t)<e.length:P(e,t),a=Reflect.set(e,t,n,o);return e===Ot(o)&&(i?K(n,r)&&Be(e,"set",t,n):Be(e,"add",t,n)),a}deleteProperty(e,t){const n=P(e,t);e[t];const o=Reflect.deleteProperty(e,t);return o&&n&&Be(e,"delete",t,void 0),o}has(e,t){const n=Reflect.has(e,t);return A(t)&&Ve.has(t)||Fe(e,0,t),n}ownKeys(e){return Fe(e,0,M(e)?"length":Ne),Reflect.ownKeys(e)}}class Ye extends Ge{constructor(){super(!0,arguments.length>0&&void 0!==arguments[0]&&arguments[0])}set(e,t){return!0}deleteProperty(e,t){return!0}}const Je=new Ke,Xe=new Ye,Ze=new Ke(!0),Qe=new Ye(!0),et=e=>e,tt=e=>Reflect.getPrototypeOf(e);function nt(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=Ot(e=e.__v_raw),i=Ot(t);n||(K(t,i)&&Fe(r,0,t),Fe(r,0,i));const{has:a}=tt(r),s=o?et:n?Nt:Dt;return a.call(r,t)?s(e.get(t)):a.call(r,i)?s(e.get(i)):void(e!==r&&e.get(t))}function ot(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.__v_raw,o=Ot(n),r=Ot(e);return t||(K(e,r)&&Fe(o,0,e),Fe(o,0,r)),e===r?n.has(e):n.has(e)||n.has(r)}function rt(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e=e.__v_raw,!t&&Fe(Ot(e),0,Ne),Reflect.get(e,"size",e)}function it(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]||xt(e)||At(e)||(e=Ot(e));const t=Ot(this);return tt(t).has.call(t,e)||(t.add(e),Be(t,"add",e,e)),this}function at(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2]||xt(t)||At(t)||(t=Ot(t));const n=Ot(this),{has:o,get:r}=tt(n);let i=o.call(n,e);i||(e=Ot(e),i=o.call(n,e));const a=r.call(n,e);return n.set(e,t),i?K(t,a)&&Be(n,"set",e,t):Be(n,"add",e,t),this}function st(e){const t=Ot(this),{has:n,get:o}=tt(t);let r=n.call(t,e);r||(e=Ot(e),r=n.call(t,e)),o&&o.call(t,e);const i=t.delete(e);return r&&Be(t,"delete",e,void 0),i}function lt(){const e=Ot(this),t=0!==e.size,n=e.clear();return t&&Be(e,"clear",void 0,void 0),n}function ct(e,t){return function(n,o){const r=this,i=r.__v_raw,a=Ot(i),s=t?et:e?Nt:Dt;return!e&&Fe(a,0,Ne),i.forEach(((e,t)=>n.call(o,s(e),s(t),r)))}}function ut(e,t,n){return function(){const o=this.__v_raw,r=Ot(o),i=T(r),a="entries"===e||e===Symbol.iterator&&i,s="keys"===e&&i,l=o[e](...arguments),c=n?et:t?Nt:Dt;return!t&&Fe(r,0,s?Ue:Ne),{next(){const{value:e,done:t}=l.next();return t?{value:e,done:t}:{value:a?[c(e[0]),c(e[1])]:c(e),done:t}},[Symbol.iterator](){return this}}}}function dt(e){return function(){return"delete"!==e&&("clear"===e?void 0:this)}}function pt(){const e={get(e){return nt(this,e)},get size(){return rt(this)},has:ot,add:it,set:at,delete:st,clear:lt,forEach:ct(!1,!1)},t={get(e){return nt(this,e,!1,!0)},get size(){return rt(this)},has:ot,add(e){return it.call(this,e,!0)},set(e,t){return at.call(this,e,t,!0)},delete:st,clear:lt,forEach:ct(!1,!0)},n={get(e){return nt(this,e,!0)},get size(){return rt(this,!0)},has(e){return ot.call(this,e,!0)},add:dt("add"),set:dt("set"),delete:dt("delete"),clear:dt("clear"),forEach:ct(!0,!1)},o={get(e){return nt(this,e,!0,!0)},get size(){return rt(this,!0)},has(e){return ot.call(this,e,!0)},add:dt("add"),set:dt("set"),delete:dt("delete"),clear:dt("clear"),forEach:ct(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach((r=>{e[r]=ut(r,!1,!1),n[r]=ut(r,!0,!1),t[r]=ut(r,!1,!0),o[r]=ut(r,!0,!0)})),[e,n,t,o]}const[mt,ft,ht,gt]=pt();function vt(e,t){const n=t?e?gt:ht:e?ft:mt;return(t,o,r)=>"__v_isReactive"===o?!e:"__v_isReadonly"===o?e:"__v_raw"===o?t:Reflect.get(P(n,o)&&o in t?n:t,o,r)}const bt={get:vt(!1,!1)},yt={get:vt(!1,!0)},wt={get:vt(!0,!1)},$t={get:vt(!0,!0)},kt=new WeakMap,St=new WeakMap,_t=new WeakMap,Pt=new WeakMap;function Mt(e){return At(e)?e:It(e,!1,Je,bt,kt)}function Tt(e){return It(e,!1,Ze,yt,St)}function Ct(e){return It(e,!0,Xe,wt,_t)}function Et(e){return It(e,!0,Qe,$t,Pt)}function It(e,t,n,o,r){if(!x(e))return e;if(e.__v_raw&&(!t||!e.__v_isReactive))return e;const i=r.get(e);if(i)return i;const a=(s=e).__v_skip||!Object.isExtensible(s)?0:function(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}(D(s));var s;if(0===a)return e;const l=new Proxy(e,2===a?o:n);return r.set(e,l),l}function Rt(e){return At(e)?Rt(e.__v_raw):!(!e||!e.__v_isReactive)}function At(e){return!(!e||!e.__v_isReadonly)}function xt(e){return!(!e||!e.__v_isShallow)}function Lt(e){return!!e&&!!e.__v_raw}function Ot(e){const t=e&&e.__v_raw;return t?Ot(t):e}function jt(e){return Object.isExtensible(e)&&J(e,"__v_skip",!0),e}const Dt=e=>x(e)?Mt(e):e,Nt=e=>x(e)?Ct(e):e;class Ut{constructor(e,t,n,o){this.getter=e,this._setter=t,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new $e((()=>e(this._value)),(()=>Bt(this,2===this.effect._dirtyLevel?2:3))),this.effect.computed=this,this.effect.active=this._cacheable=!o,this.__v_isReadonly=n}get value(){const e=Ot(this);return e._cacheable&&!e.effect.dirty||!K(e._value,e._value=e.effect.run())||Bt(e,4),Ft(e),e.effect._dirtyLevel>=2&&Bt(e,2),e._value}set value(e){this._setter(e)}get _dirty(){return this.effect.dirty}set _dirty(e){this.effect.dirty=e}}function Ft(e){var t;Me&&ve&&(e=Ot(e),xe(ve,null!=(t=e.dep)?t:e.dep=je((()=>e.dep=void 0),e instanceof Ut?e:void 0)))}function Bt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;const n=(e=Ot(e)).dep;n&&Oe(n,t)}function Wt(e){return!(!e||!0!==e.__v_isRef)}function Vt(e){return zt(e,!1)}function qt(e){return zt(e,!0)}function zt(e,t){return Wt(e)?e:new Ht(e,t)}class Ht{constructor(e,t){this.__v_isShallow=t,this.dep=void 0,this.__v_isRef=!0,this._rawValue=t?e:Ot(e),this._value=t?e:Dt(e)}get value(){return Ft(this),this._value}set value(e){const t=this.__v_isShallow||xt(e)||At(e);if(e=t?e:Ot(e),K(e,this._rawValue)){const n=this._rawValue;this._rawValue=e,this._value=t?e:Dt(e),Bt(this,4,e,n)}}}function Gt(e){return Wt(e)?e.value:e}function Kt(e){return I(e)?e():Gt(e)}const Yt={get:(e,t,n)=>Gt(Reflect.get(e,t,n)),set:(e,t,n,o)=>{const r=e[t];return Wt(r)&&!Wt(n)?(r.value=n,!0):Reflect.set(e,t,n,o)}};function Jt(e){return Rt(e)?e:new Proxy(e,Yt)}function Xt(e){const t=M(e)?new Array(e.length):{};for(const n in e)t[n]=tn(e,n);return t}class Zt{constructor(e,t,n){this._object=e,this._key=t,this._defaultValue=n,this.__v_isRef=!0}get value(){const e=this._object[this._key];return void 0===e?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return function(e,t){const n=De.get(e);return n&&n.get(t)}(Ot(this._object),this._key)}}class Qt{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function en(e,t,n){return Wt(e)?e:I(e)?new Qt(e):x(e)&&arguments.length>1?tn(e,t,n):Vt(e)}function tn(e,t,n){const o=e[t];return Wt(o)?o:new Zt(e,t,n)}function nn(e,t,n,o){try{return o?e(...o):e()}catch(e){rn(e,t,n)}}function on(e,t,n,o){if(I(e)){const r=nn(e,t,n,o);return r&&L(r)&&r.catch((e=>{rn(e,t,n)})),r}if(M(e)){const r=[];for(let i=0;i<e.length;i++)r.push(on(e[i],t,n,o));return r}}function rn(e,t,n){if(t&&t.vnode,t){let o=t.parent;const r=t.proxy,i=`https://vuejs.org/error-reference/#runtime-${n}`;for(;o;){const t=o.ec;if(t)for(let n=0;n<t.length;n++)if(!1===t[n](e,r,i))return;o=o.parent}const a=t.appContext.config.errorHandler;if(a)return Ee(),nn(a,null,10,[e,r,i]),void Ie()}}let an=!1,sn=!1;const ln=[];let cn=0;const un=[];let dn=null,pn=0;const mn=Promise.resolve();let fn=null;function hn(e){const t=fn||mn;return e?t.then(this?e.bind(this):e):t}function gn(e){ln.length&&ln.includes(e,an&&e.allowRecurse?cn+1:cn)||(null==e.id?ln.push(e):ln.splice(function(e){let t=cn+1,n=ln.length;for(;t<n;){const o=t+n>>>1,r=ln[o],i=$n(r);i<e||i===e&&r.pre?t=o+1:n=o}return t}(e.id),0,e),vn())}function vn(){an||sn||(sn=!0,fn=mn.then(Sn))}function bn(e){M(e)?un.push(...e):dn&&dn.includes(e,e.allowRecurse?pn+1:pn)||un.push(e),vn()}function yn(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:an?cn+1:0;for(;n<ln.length;n++){const t=ln[n];if(t&&t.pre){if(e&&t.id!==e.uid)continue;ln.splice(n,1),n--,t()}}}function wn(e){if(un.length){const e=[...new Set(un)].sort(((e,t)=>$n(e)-$n(t)));if(un.length=0,dn)return void dn.push(...e);for(dn=e,pn=0;pn<dn.length;pn++){const e=dn[pn];!1!==e.active&&e()}dn=null,pn=0}}const $n=e=>null==e.id?1/0:e.id,kn=(e,t)=>{const n=$n(e)-$n(t);if(0===n){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return n};function Sn(e){sn=!1,an=!0,ln.sort(kn);try{for(cn=0;cn<ln.length;cn++){const e=ln[cn];e&&!1!==e.active&&nn(e,e.i,e.i?15:14)}}finally{cn=0,ln.length=0,wn(),an=!1,fn=null,(ln.length||un.length)&&Sn()}}let _n=null,Pn=null;function Mn(e){const t=_n;return _n=e,Pn=e&&e.type.__scopeId||null,t}function Tn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_n;if(!t)return e;if(e._n)return e;const n=function(){n._d&&ui(-1);const o=Mn(t);let r;try{r=e(...arguments)}finally{Mn(o),n._d&&ui(1)}return r};return n._n=!0,n._c=!0,n._d=!0,n}function Cn(e,t){if(null===_n)return e;const n=zi(_n),o=e.dirs||(e.dirs=[]);for(let e=0;e<t.length;e++){let[r,i,a,s=h]=t[e];r&&(I(r)&&(r={mounted:r,updated:r}),r.deep&&Nr(i),o.push({dir:r,instance:n,value:i,oldValue:void 0,arg:a,modifiers:s}))}return e}function En(e,t,n,o){const r=e.dirs,i=t&&t.dirs;for(let a=0;a<r.length;a++){const s=r[a];i&&(s.oldValue=i[a].value);let l=s.dir[o];l&&(Ee(),on(l,n,8,[e.el,s,e,t]),Ie())}}const In=Symbol("_leaveCb"),Rn=Symbol("_enterCb");function An(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return ao((()=>{e.isMounted=!0})),co((()=>{e.isUnmounting=!0})),e}const xn=[Function,Array],Ln={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:xn,onEnter:xn,onAfterEnter:xn,onEnterCancelled:xn,onBeforeLeave:xn,onLeave:xn,onAfterLeave:xn,onLeaveCancelled:xn,onBeforeAppear:xn,onAppear:xn,onAfterAppear:xn,onAppearCancelled:xn},On=e=>{const t=e.subTree;return t.component?On(t.component):t},jn={name:"BaseTransition",props:Ln,setup(e,t){let{slots:n}=t;const o=xi(),r=An();return()=>{const t=n.default&&Wn(n.default(),!0);if(!t||!t.length)return;let i=t[0];if(t.length>1)for(const e of t)if(e.type!==oi){i=e;break}const a=Ot(e),{mode:s}=a;if(r.isLeaving)return Un(i);const l=Fn(i);if(!l)return Un(i);let c=Nn(l,a,r,o,(e=>c=e));Bn(l,c);const u=o.subTree,d=u&&Fn(u);if(d&&d.type!==oi&&!hi(l,d)&&On(o).type!==oi){const e=Nn(d,a,r,o);if(Bn(d,e),"out-in"===s&&l.type!==oi)return r.isLeaving=!0,e.afterLeave=()=>{r.isLeaving=!1,!1!==o.update.active&&(o.effect.dirty=!0,o.update())},Un(i);"in-out"===s&&l.type!==oi&&(e.delayLeave=(e,t,n)=>{Dn(r,d)[String(d.key)]=d,e[In]=()=>{t(),e[In]=void 0,delete c.delayedLeave},c.delayedLeave=n})}return i}}};function Dn(e,t){const{leavingVNodes:n}=e;let o=n.get(t.type);return o||(o=Object.create(null),n.set(t.type,o)),o}function Nn(e,t,n,o,r){const{appear:i,mode:a,persisted:s=!1,onBeforeEnter:l,onEnter:c,onAfterEnter:u,onEnterCancelled:d,onBeforeLeave:p,onLeave:m,onAfterLeave:f,onLeaveCancelled:h,onBeforeAppear:g,onAppear:v,onAfterAppear:b,onAppearCancelled:y}=t,w=String(e.key),$=Dn(n,e),k=(e,t)=>{e&&on(e,o,9,t)},S=(e,t)=>{const n=t[1];k(e,t),M(e)?e.every((e=>e.length<=1))&&n():e.length<=1&&n()},_={mode:a,persisted:s,beforeEnter(t){let o=l;if(!n.isMounted){if(!i)return;o=g||l}t[In]&&t[In](!0);const r=$[w];r&&hi(e,r)&&r.el[In]&&r.el[In](),k(o,[t])},enter(e){let t=c,o=u,r=d;if(!n.isMounted){if(!i)return;t=v||c,o=b||u,r=y||d}let a=!1;const s=e[Rn]=t=>{a||(a=!0,k(t?r:o,[e]),_.delayedLeave&&_.delayedLeave(),e[Rn]=void 0)};t?S(t,[e,s]):s()},leave(t,o){const r=String(e.key);if(t[Rn]&&t[Rn](!0),n.isUnmounting)return o();k(p,[t]);let i=!1;const a=t[In]=n=>{i||(i=!0,o(),k(n?h:f,[t]),t[In]=void 0,$[r]===e&&delete $[r])};$[r]=e,m?S(m,[t,a]):a()},clone(e){const i=Nn(e,t,n,o,r);return r&&r(i),i}};return _}function Un(e){if(Gn(e))return(e=$i(e)).children=null,e}function Fn(e){if(!Gn(e))return e;const{shapeFlag:t,children:n}=e;if(n){if(16&t)return n[0];if(32&t&&I(n.default))return n.default()}}function Bn(e,t){6&e.shapeFlag&&e.component?Bn(e.component.subTree,t):128&e.shapeFlag?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Wn(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,o=[],r=0;for(let i=0;i<e.length;i++){let a=e[i];const s=null==n?a.key:String(n)+String(null!=a.key?a.key:i);a.type===ti?(128&a.patchFlag&&r++,o=o.concat(Wn(a.children,t,s))):(t||a.type!==oi)&&o.push(null!=s?$i(a,{key:s}):a)}if(r>1)for(let e=0;e<o.length;e++)o[e].patchFlag=-2;return o}function Vn(e,t){return I(e)?(()=>$({name:e.name},t,{setup:e}))():e}const qn=e=>!!e.type.__asyncLoader;function zn(e){I(e)&&(e={loader:e});const{loader:t,loadingComponent:n,errorComponent:o,delay:r=200,timeout:i,suspensible:a=!0,onError:s}=e;let l,c=null,u=0;const d=()=>{let e;return c||(e=c=t().catch((e=>{if(e=e instanceof Error?e:new Error(String(e)),s)return new Promise(((t,n)=>{s(e,(()=>t((u++,c=null,d()))),(()=>n(e)),u+1)}));throw e})).then((t=>e!==c&&c?c:(t&&(t.__esModule||"Module"===t[Symbol.toStringTag])&&(t=t.default),l=t,t))))};return Vn({name:"AsyncComponentWrapper",__asyncLoader:d,get __asyncResolved(){return l},setup(){const e=Ai;if(l)return()=>Hn(l,e);const t=t=>{c=null,rn(t,e,13)};if(a&&e.suspense||Fi)return d().then((t=>()=>Hn(t,e))).catch((e=>(t(e),()=>o?yi(o,{error:e}):null)));const s=Vt(!1),u=Vt(),p=Vt(!!r);return r&&setTimeout((()=>{p.value=!1}),r),null!=i&&setTimeout((()=>{if(!s.value&&!u.value){const e=new Error(`Async component timed out after ${i}ms.`);t(e),u.value=e}}),i),d().then((()=>{s.value=!0,e.parent&&Gn(e.parent.vnode)&&(e.parent.effect.dirty=!0,gn(e.parent.update))})).catch((e=>{t(e),u.value=e})),()=>s.value&&l?Hn(l,e):u.value&&o?yi(o,{error:u.value}):n&&!p.value?yi(n):void 0}})}function Hn(e,t){const{ref:n,props:o,children:r,ce:i}=t.vnode,a=yi(e,o,r);return a.ref=n,a.ce=i,delete t.vnode.ce,a}const Gn=e=>e.type.__isKeepAlive,Kn={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(e,t){let{slots:n}=t;const o=xi(),r=o.ctx;if(!r.renderer)return()=>{const e=n.default&&n.default();return e&&1===e.length?e[0]:e};const i=new Map,a=new Set;let s=null;const l=o.suspense,{renderer:{p:c,m:u,um:d,o:{createElement:p}}}=r,m=p("div");function f(e){to(e),d(e,o,l,!0)}function h(e){i.forEach(((t,n)=>{const o=Hi(t.type);!o||e&&e(o)||g(n)}))}function g(e){const t=i.get(e);s&&hi(t,s)?s&&to(s):f(t),i.delete(e),a.delete(e)}r.activate=(e,t,n,o,r)=>{const i=e.component;u(e,t,n,0,l),c(i.vnode,e,t,n,i,l,o,e.slotScopeIds,r),Sr((()=>{i.isDeactivated=!1,i.a&&Y(i.a);const t=e.props&&e.props.onVnodeMounted;t&&Ei(t,i.parent,e)}),l)},r.deactivate=e=>{const t=e.component;Er(t.m),Er(t.a),u(e,m,null,1,l),Sr((()=>{t.da&&Y(t.da);const n=e.props&&e.props.onVnodeUnmounted;n&&Ei(n,t.parent,e),t.isDeactivated=!0}),l)},Lr((()=>[e.include,e.exclude]),(e=>{let[t,n]=e;t&&h((e=>Jn(t,e))),n&&h((e=>!Jn(n,e)))}),{flush:"post",deep:!0});let v=null;const b=()=>{null!=v&&(Kr(o.subTree.type)?Sr((()=>{i.set(v,no(o.subTree))}),o.subTree.suspense):i.set(v,no(o.subTree)))};return ao(b),lo(b),co((()=>{i.forEach((e=>{const{subTree:t,suspense:n}=o,r=no(t);if(e.type!==r.type||e.key!==r.key)f(e);else{to(r);const e=r.component.da;e&&Sr(e,n)}}))})),()=>{if(v=null,!n.default)return null;const t=n.default(),o=t[0];if(t.length>1)return s=null,t;if(!fi(o)||!(4&o.shapeFlag||128&o.shapeFlag))return s=null,o;let r=no(o);const l=r.type,c=Hi(qn(r)?r.type.__asyncResolved||{}:l),{include:u,exclude:d,max:p}=e;if(u&&(!c||!Jn(u,c))||d&&c&&Jn(d,c))return s=r,o;const m=null==r.key?l:r.key,f=i.get(m);return r.el&&(r=$i(r),128&o.shapeFlag&&(o.ssContent=r)),v=m,f?(r.el=f.el,r.component=f.component,r.transition&&Bn(r,r.transition),r.shapeFlag|=512,a.delete(m),a.add(m)):(a.add(m),p&&a.size>parseInt(p,10)&&g(a.values().next().value)),r.shapeFlag|=256,s=r,Kr(o.type)?o:r}}},Yn=Kn;function Jn(e,t){return M(e)?e.some((e=>Jn(e,t))):R(e)?e.split(",").includes(t):"[object RegExp]"===j(e)&&e.test(t)}function Xn(e,t){Qn(e,"a",t)}function Zn(e,t){Qn(e,"da",t)}function Qn(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ai;const o=e.__wdc||(e.__wdc=()=>{let t=n;for(;t;){if(t.isDeactivated)return;t=t.parent}return e()});if(oo(t,o,n),n){let e=n.parent;for(;e&&e.parent;)Gn(e.parent.vnode)&&eo(o,t,n,e),e=e.parent}}function eo(e,t,n,o){const r=oo(t,e,o,!0);uo((()=>{k(o[t],r)}),n)}function to(e){e.shapeFlag&=-257,e.shapeFlag&=-513}function no(e){return 128&e.shapeFlag?e.ssContent:e}function oo(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ai,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(n){const r=n[e]||(n[e]=[]),i=t.__weh||(t.__weh=function(){Ee();const o=ji(n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];const s=on(t,n,e,i);return o(),Ie(),s});return o?r.unshift(i):r.push(i),i}}const ro=e=>function(t){Fi&&"sp"!==e||oo(e,(function(){return t(...arguments)}),arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ai)},io=ro("bm"),ao=ro("m"),so=ro("bu"),lo=ro("u"),co=ro("bum"),uo=ro("um"),po=ro("sp"),mo=ro("rtg"),fo=ro("rtc");function ho(e){oo("ec",e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ai)}const go="components";function vo(e,t){return $o(go,e,!0,t)||e}const bo=Symbol.for("v-ndc");function yo(e){return R(e)?$o(go,e,!1)||e:e||bo}function wo(e){return $o("directives",e)}function $o(e,t){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const o=_n||Ai;if(o){const r=o.type;if(e===go){const e=Hi(r,!1);if(e&&(e===t||e===V(t)||e===H(V(t))))return r}const i=ko(o[e]||r[e],t)||ko(o.appContext[e],t);return!i&&n?r:i}}function ko(e,t){return e&&(e[t]||e[V(t)]||e[H(V(t))])}function So(e,t,n,o){let r;const i=n&&n[o];if(M(e)||R(e)){r=new Array(e.length);for(let n=0,o=e.length;n<o;n++)r[n]=t(e[n],n,void 0,i&&i[n])}else if("number"==typeof e){r=new Array(e);for(let n=0;n<e;n++)r[n]=t(n+1,n,void 0,i&&i[n])}else if(x(e))if(e[Symbol.iterator])r=Array.from(e,((e,n)=>t(e,n,void 0,i&&i[n])));else{const n=Object.keys(e);r=new Array(n.length);for(let o=0,a=n.length;o<a;o++){const a=n[o];r[o]=t(e[a],a,o,i&&i[o])}}else r=[];return n&&(n[o]=r),r}function _o(e,t){for(let n=0;n<t.length;n++){const o=t[n];if(M(o))for(let t=0;t<o.length;t++)e[o[t].name]=o[t].fn;else o&&(e[o.name]=o.key?function(){const e=o.fn(...arguments);return e&&(e.key=o.key),e}:o.fn)}return e}function Po(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;if(_n.isCE||_n.parent&&qn(_n.parent)&&_n.parent.isCE)return"default"!==t&&(n.name=t),yi("slot",n,o&&o());let i=e[t];i&&i._c&&(i._d=!1),si();const a=i&&Mo(i(n)),s=mi(ti,{key:(n.key||a&&a.key||`_${t}`)+(!a&&o?"_fb":"")},a||(o?o():[]),a&&1===e._?64:-2);return!r&&s.scopeId&&(s.slotScopeIds=[s.scopeId+"-s"]),i&&i._c&&(i._d=!0),s}function Mo(e){return e.some((e=>!fi(e)||e.type!==oi&&!(e.type===ti&&!Mo(e.children))))?e:null}const To=e=>e?Ni(e)?zi(e):To(e.parent):null,Co=$(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>To(e.parent),$root:e=>To(e.root),$emit:e=>e.emit,$options:e=>Uo(e),$forceUpdate:e=>e.f||(e.f=()=>{e.effect.dirty=!0,gn(e.update)}),$nextTick:e=>e.n||(e.n=hn.bind(e.proxy)),$watch:e=>jr.bind(e)}),Eo=(e,t)=>e!==h&&!e.__isScriptSetup&&P(e,t),Io={get(e,t){let{_:n}=e;if("__v_skip"===t)return!0;const{ctx:o,setupState:r,data:i,props:a,accessCache:s,type:l,appContext:c}=n;let u;if("$"!==t[0]){const e=s[t];if(void 0!==e)switch(e){case 1:return r[t];case 2:return i[t];case 4:return o[t];case 3:return a[t]}else{if(Eo(r,t))return s[t]=1,r[t];if(i!==h&&P(i,t))return s[t]=2,i[t];if((u=n.propsOptions[0])&&P(u,t))return s[t]=3,a[t];if(o!==h&&P(o,t))return s[t]=4,o[t];jo&&(s[t]=0)}}const d=Co[t];let p,m;return d?("$attrs"===t&&Fe(n.attrs,0,""),d(n)):(p=l.__cssModules)&&(p=p[t])?p:o!==h&&P(o,t)?(s[t]=4,o[t]):(m=c.config.globalProperties,P(m,t)?m[t]:void 0)},set(e,t,n){let{_:o}=e;const{data:r,setupState:i,ctx:a}=o;return Eo(i,t)?(i[t]=n,!0):r!==h&&P(r,t)?(r[t]=n,!0):!(P(o.props,t)||"$"===t[0]&&t.slice(1)in o||(a[t]=n,0))},has(e,t){let n,{_:{data:o,setupState:r,accessCache:i,ctx:a,appContext:s,propsOptions:l}}=e;return!!i[t]||o!==h&&P(o,t)||Eo(r,t)||(n=l[0])&&P(n,t)||P(a,t)||P(Co,t)||P(s.config.globalProperties,t)},defineProperty(e,t,n){return null!=n.get?e._.accessCache[t]=0:P(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function Ro(){return xo().slots}function Ao(){return xo().attrs}function xo(){const e=xi();return e.setupContext||(e.setupContext=qi(e))}function Lo(e){return M(e)?e.reduce(((e,t)=>(e[t]=null,e)),{}):e}function Oo(e){const t=xi();let n=e();return Di(),L(n)&&(n=n.catch((e=>{throw ji(t),e}))),[n,()=>ji(t)]}let jo=!0;function Do(e,t,n){on(M(e)?e.map((e=>e.bind(t.proxy))):e.bind(t.proxy),t,n)}function No(e,t,n,o){const r=o.includes(".")?Dr(n,o):()=>n[o];if(R(e)){const n=t[e];I(n)&&Lr(r,n)}else if(I(e))Lr(r,e.bind(n));else if(x(e))if(M(e))e.forEach((e=>No(e,t,n,o)));else{const o=I(e.handler)?e.handler.bind(n):t[e.handler];I(o)&&Lr(r,o,e)}}function Uo(e){const t=e.type,{mixins:n,extends:o}=t,{mixins:r,optionsCache:i,config:{optionMergeStrategies:a}}=e.appContext,s=i.get(t);let l;return s?l=s:r.length||n||o?(l={},r.length&&r.forEach((e=>Fo(l,e,a,!0))),Fo(l,t,a)):l=t,x(t)&&i.set(t,l),l}function Fo(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const{mixins:r,extends:i}=t;i&&Fo(e,i,n,!0),r&&r.forEach((t=>Fo(e,t,n,!0)));for(const r in t)if(o&&"expose"===r);else{const o=Bo[r]||n&&n[r];e[r]=o?o(e[r],t[r]):t[r]}return e}const Bo={data:Wo,props:Ho,emits:Ho,methods:zo,computed:zo,beforeCreate:qo,created:qo,beforeMount:qo,mounted:qo,beforeUpdate:qo,updated:qo,beforeDestroy:qo,beforeUnmount:qo,destroyed:qo,unmounted:qo,activated:qo,deactivated:qo,errorCaptured:qo,serverPrefetch:qo,components:zo,directives:zo,watch:function(e,t){if(!e)return t;if(!t)return e;const n=$(Object.create(null),e);for(const o in t)n[o]=qo(e[o],t[o]);return n},provide:Wo,inject:function(e,t){return zo(Vo(e),Vo(t))}};function Wo(e,t){return t?e?function(){return $(I(e)?e.call(this,this):e,I(t)?t.call(this,this):t)}:t:e}function Vo(e){if(M(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function qo(e,t){return e?[...new Set([].concat(e,t))]:t}function zo(e,t){return e?$(Object.create(null),e,t):t}function Ho(e,t){return e?M(e)&&M(t)?[...new Set([...e,...t])]:$(Object.create(null),Lo(e),Lo(null!=t?t:{})):t}function Go(){return{app:null,config:{isNativeTag:b,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Ko=0;function Yo(e,t){return function(n){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;I(n)||(n=$({},n)),null==o||x(o)||(o=null);const r=Go(),i=new WeakSet;let a=!1;const s=r.app={_uid:Ko++,_component:n,_props:o,_container:null,_context:r,_instance:null,version:Yi,get config(){return r.config},set config(e){},use(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return i.has(e)||(e&&I(e.install)?(i.add(e),e.install(s,...n)):I(e)&&(i.add(e),e(s,...n))),s},mixin:e=>(r.mixins.includes(e)||r.mixins.push(e),s),component:(e,t)=>t?(r.components[e]=t,s):r.components[e],directive:(e,t)=>t?(r.directives[e]=t,s):r.directives[e],mount(i,l,c){if(!a){const u=yi(n,o);return u.appContext=r,!0===c?c="svg":!1===c&&(c=void 0),l&&t?t(u,i):e(u,i,c),a=!0,s._container=i,i.__vue_app__=s,zi(u.component)}},unmount(){a&&(e(null,s._container),delete s._container.__vue_app__)},provide:(e,t)=>(r.provides[e]=t,s),runWithContext(e){const t=Jo;Jo=s;try{return e()}finally{Jo=t}}};return s}}let Jo=null;function Xo(e,t){if(Ai){let n=Ai.provides;const o=Ai.parent&&Ai.parent.provides;o===n&&(n=Ai.provides=Object.create(o)),n[e]=t}}function Zo(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=Ai||_n;if(o||Jo){const r=o?null==o.parent?o.vnode.appContext&&o.vnode.appContext.provides:o.parent.provides:Jo._context.provides;if(r&&e in r)return r[e];if(arguments.length>1)return n&&I(t)?t.call(o&&o.proxy):t}}const Qo={},er=()=>Object.create(Qo),tr=e=>Object.getPrototypeOf(e)===Qo;function nr(e,t,n,o){const[r,i]=e.propsOptions;let a,s=!1;if(t)for(let l in t){if(F(l))continue;const c=t[l];let u;r&&P(r,u=V(l))?i&&i.includes(u)?(a||(a={}))[u]=c:n[u]=c:Wr(e.emitsOptions,l)||l in o&&c===o[l]||(o[l]=c,s=!0)}if(i){const t=Ot(n),o=a||h;for(let a=0;a<i.length;a++){const s=i[a];n[s]=or(r,t,s,o[s],e,!P(o,s))}}return s}function or(e,t,n,o,r,i){const a=e[n];if(null!=a){const e=P(a,"default");if(e&&void 0===o){const e=a.default;if(a.type!==Function&&!a.skipFactory&&I(e)){const{propsDefaults:i}=r;if(n in i)o=i[n];else{const a=ji(r);o=i[n]=e.call(null,t),a()}}else o=e}a[0]&&(i&&!e?o=!1:!a[1]||""!==o&&o!==z(n)||(o=!0))}return o}const rr=new WeakMap;function ir(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=n?rr:t.propsCache,r=o.get(e);if(r)return r;const i=e.props,a={},s=[];let l=!1;if(!I(e)){const o=e=>{l=!0;const[n,o]=ir(e,t,!0);$(a,n),o&&s.push(...o)};!n&&t.mixins.length&&t.mixins.forEach(o),e.extends&&o(e.extends),e.mixins&&e.mixins.forEach(o)}if(!i&&!l)return x(e)&&o.set(e,g),g;if(M(i))for(let e=0;e<i.length;e++){const t=V(i[e]);ar(t)&&(a[t]=h)}else if(i)for(const e in i){const t=V(e);if(ar(t)){const n=i[e],o=a[t]=M(n)||I(n)?{type:n}:$({},n),r=o.type;let l=!1,c=!0;if(M(r))for(let e=0;e<r.length;++e){const t=r[e],n=I(t)&&t.name;if("Boolean"===n){l=!0;break}"String"===n&&(c=!1)}else l=I(r)&&"Boolean"===r.name;o[0]=l,o[1]=c,(l||P(o,"default"))&&s.push(t)}}const c=[a,s];return x(e)&&o.set(e,c),c}function ar(e){return"$"!==e[0]&&!F(e)}const sr=e=>"_"===e[0]||"$stable"===e,lr=e=>M(e)?e.map(Pi):[Pi(e)],cr=(e,t,n)=>{if(t._n)return t;const o=Tn((function(){return lr(t(...arguments))}),n);return o._c=!1,o},ur=(e,t,n)=>{const o=e._ctx;for(const n in e){if(sr(n))continue;const r=e[n];if(I(r))t[n]=cr(0,r,o);else if(null!=r){const e=lr(r);t[n]=()=>e}}},dr=(e,t)=>{const n=lr(t);e.slots.default=()=>n},pr=(e,t,n)=>{for(const o in t)(n||"_"!==o)&&(e[o]=t[o])};function mr(e,t,n,o){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(M(e))return void e.forEach(((e,i)=>mr(e,t&&(M(t)?t[i]:t),n,o,r)));if(qn(o)&&!r)return;const i=4&o.shapeFlag?zi(o.component):o.el,a=r?null:i,{i:s,r:l}=e,c=t&&t.r,u=s.refs===h?s.refs={}:s.refs,d=s.setupState;if(null!=c&&c!==l&&(R(c)?(u[c]=null,P(d,c)&&(d[c]=null)):Wt(c)&&(c.value=null)),I(l))nn(l,s,12,[a,u]);else{const t=R(l),o=Wt(l);if(t||o){const s=()=>{if(e.f){const n=t?P(d,l)?d[l]:u[l]:l.value;r?M(n)&&k(n,i):M(n)?n.includes(i)||n.push(i):t?(u[l]=[i],P(d,l)&&(d[l]=u[l])):(l.value=[i],e.k&&(u[e.k]=l.value))}else t?(u[l]=a,P(d,l)&&(d[l]=a)):o&&(l.value=a,e.k&&(u[e.k]=a))};a?(s.id=-1,Sr(s,n)):s()}}}const fr=Symbol("_vte"),hr=e=>e&&(e.disabled||""===e.disabled),gr=e=>"undefined"!=typeof SVGElement&&e instanceof SVGElement,vr=e=>"function"==typeof MathMLElement&&e instanceof MathMLElement,br=(e,t)=>{const n=e&&e.to;return R(n)?t?t(n):null:n};function yr(e,t,n,o){let{o:{insert:r},m:i}=o,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2;0===a&&r(e.targetAnchor,t,n);const{el:s,anchor:l,shapeFlag:c,children:u,props:d}=e,p=2===a;if(p&&r(s,t,n),(!p||hr(d))&&16&c)for(let e=0;e<u.length;e++)i(u[e],t,n,2);p&&r(l,t,n)}const wr={name:"Teleport",__isTeleport:!0,process(e,t,n,o,r,i,a,s,l,c){const{mc:u,pc:d,pbc:p,o:{insert:m,querySelector:f,createText:h,createComment:g}}=c,v=hr(t.props);let{shapeFlag:b,children:y,dynamicChildren:w}=t;if(null==e){const e=t.el=h(""),c=t.anchor=h("");m(e,n,o),m(c,n,o);const d=t.target=br(t.props,f),p=kr(d,t,h,m);d&&("svg"===a||gr(d)?a="svg":("mathml"===a||vr(d))&&(a="mathml"));const g=(e,t)=>{16&b&&u(y,e,t,r,i,a,s,l)};v?g(n,c):d&&g(d,p)}else{t.el=e.el,t.targetStart=e.targetStart;const o=t.anchor=e.anchor,u=t.target=e.target,m=t.targetAnchor=e.targetAnchor,h=hr(e.props),g=h?n:u,b=h?o:m;if("svg"===a||gr(u)?a="svg":("mathml"===a||vr(u))&&(a="mathml"),w?(p(e.dynamicChildren,w,g,r,i,a,s),Tr(e,t,!0)):l||d(e,t,g,b,r,i,a,s,!1),v)h?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):yr(t,n,o,c,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const e=t.target=br(t.props,f);e&&yr(t,e,null,c,0)}else h&&yr(t,u,m,c,1)}$r(t)},remove(e,t,n,o,r){let{um:i,o:{remove:a}}=o;const{shapeFlag:s,children:l,anchor:c,targetStart:u,targetAnchor:d,target:p,props:m}=e;if(p&&(a(u),a(d)),r&&a(c),16&s){const e=r||!hr(m);for(let o=0;o<l.length;o++){const r=l[o];i(r,t,n,e,!!r.dynamicChildren)}}},move:yr,hydrate:function(e,t,n,o,r,i,a,s){let{o:{nextSibling:l,parentNode:c,querySelector:u,insert:d,createText:p}}=a;const m=t.target=br(t.props,u);if(m){const a=m._lpa||m.firstChild;if(16&t.shapeFlag)if(hr(t.props))t.anchor=s(l(e),t,c(e),n,o,r,i),t.targetStart=a,t.targetAnchor=a&&l(a);else{t.anchor=l(e);let c=a;for(;c;){if(c&&8===c.nodeType)if("teleport start anchor"===c.data)t.targetStart=c;else if("teleport anchor"===c.data){t.targetAnchor=c,m._lpa=t.targetAnchor&&l(t.targetAnchor);break}c=l(c)}t.targetAnchor||kr(m,t,p,d),s(a&&l(a),t,m,n,o,r,i)}$r(t)}return t.anchor&&l(t.anchor)}};function $r(e){const t=e.ctx;if(t&&t.ut){let n=e.children[0].el;for(;n&&n!==e.targetAnchor;)1===n.nodeType&&n.setAttribute("data-v-owner",t.uid),n=n.nextSibling;t.ut()}}function kr(e,t,n,o){const r=t.targetStart=n(""),i=t.targetAnchor=n("");return r[fr]=i,e&&(o(r,e),o(i,e)),i}const Sr=function(e,t){t&&t.pendingBranch?M(e)?t.effects.push(...e):t.effects.push(e):bn(e)};function _r(e){return function(e){"boolean"!=typeof __VUE_PROD_HYDRATION_MISMATCH_DETAILS__&&(ee().__VUE_PROD_HYDRATION_MISMATCH_DETAILS__=!1),ee().__VUE__=!0;const{insert:t,remove:n,patchProp:o,createElement:r,createText:i,createComment:a,setText:s,setElementText:l,parentNode:c,nextSibling:u,setScopeId:d=v,insertStaticContent:p}=e,m=function(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:!!t.dynamicChildren;if(e===t)return;e&&!hi(e,t)&&(o=G(e),U(e,r,i,!0),e=null),-2===t.patchFlag&&(l=!1,t.dynamicChildren=null);const{type:c,ref:u,shapeFlag:d}=t;switch(c){case ni:f(e,t,n,o);break;case oi:b(e,t,n,o);break;case ri:null==e&&y(t,n,o,a);break;case ti:C(e,t,n,o,r,i,a,s,l);break;default:1&d?w(e,t,n,o,r,i,a,s,l):6&d?E(e,t,n,o,r,i,a,s,l):(64&d||128&d)&&c.process(e,t,n,o,r,i,a,s,l,Z)}null!=u&&r&&mr(u,e&&e.ref,i,t||e,!t)},f=(e,n,o,r)=>{if(null==e)t(n.el=i(n.children),o,r);else{const t=n.el=e.el;n.children!==e.children&&s(t,n.children)}},b=(e,n,o,r)=>{null==e?t(n.el=a(n.children||""),o,r):n.el=e.el},y=(e,t,n,o)=>{[e.el,e.anchor]=p(e.children,t,n,o,e.el,e.anchor)},w=(e,t,n,o,r,i,a,s,l)=>{"svg"===t.type?a="svg":"math"===t.type&&(a="mathml"),null==e?$(t,n,o,r,i,a,s,l):_(e,t,r,i,a,s,l)},$=(e,n,i,a,s,c,u,d)=>{let p,m;const{props:f,shapeFlag:h,transition:g,dirs:v}=e;if(p=e.el=r(e.type,c,f&&f.is,f),8&h?l(p,e.children):16&h&&S(e.children,p,null,a,s,Pr(e,c),u,d),v&&En(e,null,a,"created"),k(p,e,e.scopeId,u,a),f){for(const e in f)"value"===e||F(e)||o(p,e,null,f[e],c,a);"value"in f&&o(p,"value",null,f.value,c),(m=f.onVnodeBeforeMount)&&Ei(m,a,e)}v&&En(e,null,a,"beforeMount");const b=function(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}(s,g);b&&g.beforeEnter(p),t(p,n,i),((m=f&&f.onVnodeMounted)||b||v)&&Sr((()=>{m&&Ei(m,a,e),b&&g.enter(p),v&&En(e,null,a,"mounted")}),s)},k=(e,t,n,o,r)=>{if(n&&d(e,n),o)for(let t=0;t<o.length;t++)d(e,o[t]);if(r&&t===r.subTree){const t=r.vnode;k(e,t,t.scopeId,t.slotScopeIds,r.parent)}},S=function(e,t,n,o,r,i,a,s){for(let l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;l<e.length;l++){const c=e[l]=s?Mi(e[l]):Pi(e[l]);m(null,c,t,n,o,r,i,a,s)}},_=(e,t,n,r,i,a,s)=>{const c=t.el=e.el;let{patchFlag:u,dynamicChildren:d,dirs:p}=t;u|=16&e.patchFlag;const m=e.props||h,f=t.props||h;let g;if(n&&Mr(n,!1),(g=f.onVnodeBeforeUpdate)&&Ei(g,n,t,e),p&&En(t,e,n,"beforeUpdate"),n&&Mr(n,!0),(m.innerHTML&&null==f.innerHTML||m.textContent&&null==f.textContent)&&l(c,""),d?M(e.dynamicChildren,d,c,n,r,Pr(t,i),a):s||O(e,t,c,null,n,r,Pr(t,i),a,!1),u>0){if(16&u)T(c,m,f,n,i);else if(2&u&&m.class!==f.class&&o(c,"class",null,f.class,i),4&u&&o(c,"style",m.style,f.style,i),8&u){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const r=e[t],a=m[r],s=f[r];s===a&&"value"!==r||o(c,r,a,s,i,n)}}1&u&&e.children!==t.children&&l(c,t.children)}else s||null!=d||T(c,m,f,n,i);((g=f.onVnodeUpdated)||p)&&Sr((()=>{g&&Ei(g,n,t,e),p&&En(t,e,n,"updated")}),r)},M=(e,t,n,o,r,i,a)=>{for(let s=0;s<t.length;s++){const l=e[s],u=t[s],d=l.el&&(l.type===ti||!hi(l,u)||70&l.shapeFlag)?c(l.el):n;m(l,u,d,null,o,r,i,a,!0)}},T=(e,t,n,r,i)=>{if(t!==n){if(t!==h)for(const a in t)F(a)||a in n||o(e,a,t[a],null,i,r);for(const a in n){if(F(a))continue;const s=n[a],l=t[a];s!==l&&"value"!==a&&o(e,a,l,s,i,r)}"value"in n&&o(e,"value",t.value,n.value,i)}},C=(e,n,o,r,a,s,l,c,u)=>{const d=n.el=e?e.el:i(""),p=n.anchor=e?e.anchor:i("");let{patchFlag:m,dynamicChildren:f,slotScopeIds:h}=n;h&&(c=c?c.concat(h):h),null==e?(t(d,o,r),t(p,o,r),S(n.children||[],o,p,a,s,l,c,u)):m>0&&64&m&&f&&e.dynamicChildren?(M(e.dynamicChildren,f,o,a,s,l,c),(null!=n.key||a&&n===a.subTree)&&Tr(e,n,!0)):O(e,n,o,p,a,s,l,c,u)},E=(e,t,n,o,r,i,a,s,l)=>{t.slotScopeIds=s,null==e?512&t.shapeFlag?r.ctx.activate(t,n,o,a,l):I(t,n,o,r,i,a,l):R(e,t,l)},I=(e,t,n,o,r,i,a)=>{const s=e.component=function(e,t,n){const o=e.type,r=(t?t.appContext:e.appContext)||Ii,i={uid:Ri++,vnode:e,type:o,parent:t,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,scope:new be(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(r.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:ir(o,r),emitsOptions:Br(o,r),emit:null,emitted:null,propsDefaults:h,inheritAttrs:o.inheritAttrs,ctx:h,data:h,props:h,attrs:h,slots:h,refs:h,setupState:h,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=Fr.bind(null,i),e.ce&&e.ce(i),i}(e,o,r);if(Gn(e)&&(s.ctx.renderer=Z),function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t&&Oi(t);const{props:o,children:r}=e.vnode,i=Ni(e);(function(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r={},i=er();e.propsDefaults=Object.create(null),nr(e,t,r,i);for(const t in e.propsOptions[0])t in r||(r[t]=void 0);n?e.props=o?r:Tt(r):e.type.props?e.props=r:e.props=i,e.attrs=i})(e,o,i,t),((e,t,n)=>{const o=e.slots=er();if(32&e.vnode.shapeFlag){const e=t._;e?(pr(o,t,n),n&&J(o,"_",e,!0)):ur(t,o)}else t&&dr(e,t)})(e,r,n);i&&function(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Io);const{setup:o}=n;if(o){const n=e.setupContext=o.length>1?qi(e):null,r=ji(e);Ee();const i=nn(o,e,0,[e.props,n]);if(Ie(),r(),L(i)){if(i.then(Di,Di),t)return i.then((n=>{Bi(e,n,t)})).catch((t=>{rn(t,e,0)}));e.asyncDep=i}else Bi(e,i,t)}else Wi(e,t)}(e,t);t&&Oi(!1)}(s,!1,a),s.asyncDep){if(r&&r.registerDep(s,A,a),!e.el){const e=s.subTree=yi(oi);b(null,e,t,n)}}else A(s,e,t,n,r,i,a)},R=(e,t,n)=>{const o=t.component=e.component;if(function(e,t,n){const{props:o,children:r,component:i}=e,{props:a,children:s,patchFlag:l}=t,c=i.emitsOptions;if(t.dirs||t.transition)return!0;if(!(n&&l>=0))return!(!r&&!s||s&&s.$stable)||o!==a&&(o?!a||Hr(o,a,c):!!a);if(1024&l)return!0;if(16&l)return o?Hr(o,a,c):!!a;if(8&l){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const n=e[t];if(a[n]!==o[n]&&!Wr(c,n))return!0}}return!1}(e,t,n)){if(o.asyncDep&&!o.asyncResolved)return void x(o,t,n);o.next=t,function(e){const t=ln.indexOf(e);t>cn&&ln.splice(t,1)}(o.update),o.effect.dirty=!0,o.update()}else t.el=e.el,o.vnode=t},A=(e,t,n,o,r,i,a)=>{const s=()=>{if(e.isMounted){let{next:t,bu:n,u:o,parent:l,vnode:u}=e;{const n=Cr(e);if(n)return t&&(t.el=u.el,x(e,t,a)),void n.asyncDep.then((()=>{e.isUnmounted||s()}))}let d,p=t;Mr(e,!1),t?(t.el=u.el,x(e,t,a)):t=u,n&&Y(n),(d=t.props&&t.props.onVnodeBeforeUpdate)&&Ei(d,l,t,u),Mr(e,!0);const f=Vr(e),h=e.subTree;e.subTree=f,m(h,f,c(h.el),G(h),e,r,i),t.el=f.el,null===p&&Gr(e,f.el),o&&Sr(o,r),(d=t.props&&t.props.onVnodeUpdated)&&Sr((()=>Ei(d,l,t,u)),r)}else{let a;const{el:s,props:l}=t,{bm:c,m:u,parent:d}=e,p=qn(t);if(Mr(e,!1),c&&Y(c),!p&&(a=l&&l.onVnodeBeforeMount)&&Ei(a,d,t),Mr(e,!0),s&&te){const n=()=>{e.subTree=Vr(e),te(s,e.subTree,e,r,null)};p?t.type.__asyncLoader().then((()=>!e.isUnmounted&&n())):n()}else{const a=e.subTree=Vr(e);m(null,a,n,o,e,r,i),t.el=a.el}if(u&&Sr(u,r),!p&&(a=l&&l.onVnodeMounted)){const e=t;Sr((()=>Ei(a,d,e)),r)}(256&t.shapeFlag||d&&qn(d.vnode)&&256&d.vnode.shapeFlag)&&e.a&&Sr(e.a,r),e.isMounted=!0,t=n=o=null}},l=e.effect=new $e(s,v,(()=>gn(u)),e.scope),u=e.update=()=>{l.dirty&&l.run()};u.i=e,u.id=e.uid,Mr(e,!0),u()},x=(e,t,n)=>{t.component=e;const o=e.vnode.props;e.vnode=t,e.next=null,function(e,t,n,o){const{props:r,attrs:i,vnode:{patchFlag:a}}=e,s=Ot(r),[l]=e.propsOptions;let c=!1;if(!(o||a>0)||16&a){let o;nr(e,t,r,i)&&(c=!0);for(const i in s)t&&(P(t,i)||(o=z(i))!==i&&P(t,o))||(l?!n||void 0===n[i]&&void 0===n[o]||(r[i]=or(l,s,i,void 0,e,!0)):delete r[i]);if(i!==s)for(const e in i)t&&P(t,e)||(delete i[e],c=!0)}else if(8&a){const n=e.vnode.dynamicProps;for(let o=0;o<n.length;o++){let a=n[o];if(Wr(e.emitsOptions,a))continue;const u=t[a];if(l)if(P(i,a))u!==i[a]&&(i[a]=u,c=!0);else{const t=V(a);r[t]=or(l,s,t,u,e,!1)}else u!==i[a]&&(i[a]=u,c=!0)}}c&&Be(e.attrs,"set","")}(e,t.props,o,n),((e,t,n)=>{const{vnode:o,slots:r}=e;let i=!0,a=h;if(32&o.shapeFlag){const e=t._;e?n&&1===e?i=!1:pr(r,t,n):(i=!t.$stable,ur(t,r)),a=t}else t&&(dr(e,t),a={default:1});if(i)for(const e in r)sr(e)||null!=a[e]||delete r[e]})(e,t.children,n),Ee(),yn(e),Ie()},O=function(e,t,n,o,r,i,a,s){let c=arguments.length>8&&void 0!==arguments[8]&&arguments[8];const u=e&&e.children,d=e?e.shapeFlag:0,p=t.children,{patchFlag:m,shapeFlag:f}=t;if(m>0){if(128&m)return void D(u,p,n,o,r,i,a,s,c);if(256&m)return void j(u,p,n,o,r,i,a,s,c)}8&f?(16&d&&H(u,r,i),p!==u&&l(n,p)):16&d?16&f?D(u,p,n,o,r,i,a,s,c):H(u,r,i,!0):(8&d&&l(n,""),16&f&&S(p,n,o,r,i,a,s,c))},j=(e,t,n,o,r,i,a,s,l)=>{t=t||g;const c=(e=e||g).length,u=t.length,d=Math.min(c,u);let p;for(p=0;p<d;p++){const o=t[p]=l?Mi(t[p]):Pi(t[p]);m(e[p],o,n,null,r,i,a,s,l)}c>u?H(e,r,i,!0,!1,d):S(t,n,o,r,i,a,s,l,d)},D=(e,t,n,o,r,i,a,s,l)=>{let c=0;const u=t.length;let d=e.length-1,p=u-1;for(;c<=d&&c<=p;){const o=e[c],u=t[c]=l?Mi(t[c]):Pi(t[c]);if(!hi(o,u))break;m(o,u,n,null,r,i,a,s,l),c++}for(;c<=d&&c<=p;){const o=e[d],c=t[p]=l?Mi(t[p]):Pi(t[p]);if(!hi(o,c))break;m(o,c,n,null,r,i,a,s,l),d--,p--}if(c>d){if(c<=p){const e=p+1,d=e<u?t[e].el:o;for(;c<=p;)m(null,t[c]=l?Mi(t[c]):Pi(t[c]),n,d,r,i,a,s,l),c++}}else if(c>p)for(;c<=d;)U(e[c],r,i,!0),c++;else{const f=c,h=c,v=new Map;for(c=h;c<=p;c++){const e=t[c]=l?Mi(t[c]):Pi(t[c]);null!=e.key&&v.set(e.key,c)}let b,y=0;const w=p-h+1;let $=!1,k=0;const S=new Array(w);for(c=0;c<w;c++)S[c]=0;for(c=f;c<=d;c++){const o=e[c];if(y>=w){U(o,r,i,!0);continue}let u;if(null!=o.key)u=v.get(o.key);else for(b=h;b<=p;b++)if(0===S[b-h]&&hi(o,t[b])){u=b;break}void 0===u?U(o,r,i,!0):(S[u-h]=c+1,u>=k?k=u:$=!0,m(o,t[u],n,null,r,i,a,s,l),y++)}const _=$?function(e){const t=e.slice(),n=[0];let o,r,i,a,s;const l=e.length;for(o=0;o<l;o++){const l=e[o];if(0!==l){if(r=n[n.length-1],e[r]<l){t[o]=r,n.push(o);continue}for(i=0,a=n.length-1;i<a;)s=i+a>>1,e[n[s]]<l?i=s+1:a=s;l<e[n[i]]&&(i>0&&(t[o]=n[i-1]),n[i]=o)}}for(i=n.length,a=n[i-1];i-- >0;)n[i]=a,a=t[a];return n}(S):g;for(b=_.length-1,c=w-1;c>=0;c--){const e=h+c,d=t[e],p=e+1<u?t[e+1].el:o;0===S[c]?m(null,d,n,p,r,i,a,s,l):$&&(b<0||c!==_[b]?N(d,n,p,2):b--)}}},N=function(e,n,o,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const{el:a,type:s,transition:l,children:c,shapeFlag:d}=e;if(6&d)N(e.component.subTree,n,o,r);else if(128&d)e.suspense.move(n,o,r);else if(64&d)s.move(e,n,o,Z);else if(s!==ti)if(s!==ri)if(2!==r&&1&d&&l)if(0===r)l.beforeEnter(a),t(a,n,o),Sr((()=>l.enter(a)),i);else{const{leave:e,delayLeave:r,afterLeave:i}=l,s=()=>t(a,n,o),c=()=>{e(a,(()=>{s(),i&&i()}))};r?r(a,s,c):c()}else t(a,n,o);else((e,n,o)=>{let r,{el:i,anchor:a}=e;for(;i&&i!==a;)r=u(i),t(i,n,o),i=r;t(a,n,o)})(e,n,o);else{t(a,n,o);for(let e=0;e<c.length;e++)N(c[e],n,o,r);t(e.anchor,n,o)}},U=function(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const{type:i,props:a,ref:s,children:l,dynamicChildren:c,shapeFlag:u,patchFlag:d,dirs:p,cacheIndex:m}=e;if(-2===d&&(r=!1),null!=s&&mr(s,null,n,e,!0),null!=m&&(t.renderCache[m]=void 0),256&u)return void t.ctx.deactivate(e);const f=1&u&&p,h=!qn(e);let g;if(h&&(g=a&&a.onVnodeBeforeUnmount)&&Ei(g,t,e),6&u)q(e.component,n,o);else{if(128&u)return void e.suspense.unmount(n,o);f&&En(e,null,t,"beforeUnmount"),64&u?e.type.remove(e,t,n,Z,o):c&&!c.hasOnce&&(i!==ti||d>0&&64&d)?H(c,t,n,!1,!0):(i===ti&&384&d||!r&&16&u)&&H(l,t,n),o&&B(e)}(h&&(g=a&&a.onVnodeUnmounted)||f)&&Sr((()=>{g&&Ei(g,t,e),f&&En(e,null,t,"unmounted")}),n)},B=e=>{const{type:t,el:o,anchor:r,transition:i}=e;if(t===ti)return void W(o,r);if(t===ri)return void(e=>{let t,{el:o,anchor:r}=e;for(;o&&o!==r;)t=u(o),n(o),o=t;n(r)})(e);const a=()=>{n(o),i&&!i.persisted&&i.afterLeave&&i.afterLeave()};if(1&e.shapeFlag&&i&&!i.persisted){const{leave:t,delayLeave:n}=i,r=()=>t(o,a);n?n(e.el,a,r):r()}else a()},W=(e,t)=>{let o;for(;e!==t;)o=u(e),n(e),e=o;n(t)},q=(e,t,n)=>{const{bum:o,scope:r,update:i,subTree:a,um:s,m:l,a:c}=e;Er(l),Er(c),o&&Y(o),r.stop(),i&&(i.active=!1,U(a,e,t,n)),s&&Sr(s,t),Sr((()=>{e.isUnmounted=!0}),t),t&&t.pendingBranch&&!t.isUnmounted&&e.asyncDep&&!e.asyncResolved&&e.suspenseId===t.pendingId&&(t.deps--,0===t.deps&&t.resolve())},H=function(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];for(let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;i<e.length;i++)U(e[i],t,n,o,r)},G=e=>{if(6&e.shapeFlag)return G(e.component.subTree);if(128&e.shapeFlag)return e.suspense.next();const t=u(e.anchor||e.el),n=t&&t[fr];return n?u(n):t};let K=!1;const X=(e,t,n)=>{null==e?t._vnode&&U(t._vnode,null,null,!0):m(t._vnode||null,e,t,null,null,null,n),K||(K=!0,yn(),wn(),K=!1),t._vnode=e},Z={p:m,um:U,m:N,r:B,mt:I,mc:S,pc:O,pbc:M,n:G,o:e};let Q,te;return{render:X,hydrate:Q,createApp:Yo(X,Q)}}(e)}function Pr(e,t){let{type:n,props:o}=e;return"svg"===t&&"foreignObject"===n||"mathml"===t&&"annotation-xml"===n&&o&&o.encoding&&o.encoding.includes("html")?void 0:t}function Mr(e,t){let{effect:n,update:o}=e;n.allowRecurse=o.allowRecurse=t}function Tr(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=e.children,r=t.children;if(M(o)&&M(r))for(let e=0;e<o.length;e++){const t=o[e];let i=r[e];1&i.shapeFlag&&!i.dynamicChildren&&((i.patchFlag<=0||32===i.patchFlag)&&(i=r[e]=Mi(r[e]),i.el=t.el),n||-2===i.patchFlag||Tr(t,i)),i.type===ni&&(i.el=t.el)}}function Cr(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Cr(t)}function Er(e){if(e)for(let t=0;t<e.length;t++)e[t].active=!1}const Ir=Symbol.for("v-scx"),Rr=()=>Zo(Ir);function Ar(e,t){return Or(e,null,t)}const xr={};function Lr(e,t,n){return Or(e,t,n)}function Or(e,t){let{immediate:n,deep:o,flush:r,once:i,onTrack:a,onTrigger:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h;if(t&&i){const e=t;t=function(){e(...arguments),_()}}const l=Ai,c=e=>!0===o?e:Nr(e,!1===o?1:void 0);let u,d,p=!1,m=!1;if(Wt(e)?(u=()=>e.value,p=xt(e)):Rt(e)?(u=()=>c(e),p=!0):M(e)?(m=!0,p=e.some((e=>Rt(e)||xt(e))),u=()=>e.map((e=>Wt(e)?e.value:Rt(e)?c(e):I(e)?nn(e,l,2):void 0))):u=I(e)?t?()=>nn(e,l,2):()=>(d&&d(),on(e,l,3,[g])):v,t&&o){const e=u;u=()=>Nr(e())}let f,g=e=>{d=$.onStop=()=>{nn(e,l,4),d=$.onStop=void 0}};if(Fi){if(g=v,t?n&&on(t,l,3,[u(),m?[]:void 0,g]):u(),"sync"!==r)return v;{const e=Rr();f=e.__watcherHandles||(e.__watcherHandles=[])}}let b=m?new Array(e.length).fill(xr):xr;const y=()=>{if($.active&&$.dirty)if(t){const e=$.run();(o||p||(m?e.some(((e,t)=>K(e,b[t]))):K(e,b)))&&(d&&d(),on(t,l,3,[e,b===xr?void 0:m&&b[0]===xr?[]:b,g]),b=e)}else $.run()};let w;y.allowRecurse=!!t,"sync"===r?w=y:"post"===r?w=()=>Sr(y,l&&l.suspense):(y.pre=!0,l&&(y.id=l.uid),w=()=>gn(y));const $=new $e(u,v,w),S=ye(),_=()=>{$.stop(),S&&k(S.effects,$)};return t?n?y():b=$.run():"post"===r?Sr($.run.bind($),l&&l.suspense):$.run(),f&&f.push(_),_}function jr(e,t,n){const o=this.proxy,r=R(e)?e.includes(".")?Dr(o,e):()=>o[e]:e.bind(o,o);let i;I(t)?i=t:(i=t.handler,n=t);const a=ji(this),s=Or(r,i.bind(o),n);return a(),s}function Dr(e,t){const n=t.split(".");return()=>{let t=e;for(let e=0;e<n.length&&t;e++)t=t[n[e]];return t}}function Nr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=arguments.length>2?arguments[2]:void 0;if(t<=0||!x(e)||e.__v_skip)return e;if(n=n||new Set,n.has(e))return e;if(n.add(e),t--,Wt(e))Nr(e.value,t,n);else if(M(e))for(let o=0;o<e.length;o++)Nr(e[o],t,n);else if(C(e)||T(e))e.forEach((e=>{Nr(e,t,n)}));else if(N(e)){for(const o in e)Nr(e[o],t,n);for(const o of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,o)&&Nr(e[o],t,n)}return e}const Ur=(e,t)=>"modelValue"===t||"model-value"===t?e.modelModifiers:e[`${t}Modifiers`]||e[`${V(t)}Modifiers`]||e[`${z(t)}Modifiers`];function Fr(e,t){if(e.isUnmounted)return;const n=e.vnode.props||h;for(var o=arguments.length,r=new Array(o>2?o-2:0),i=2;i<o;i++)r[i-2]=arguments[i];let a=r;const s=t.startsWith("update:"),l=s&&Ur(n,t.slice(7));let c;l&&(l.trim&&(a=r.map((e=>R(e)?e.trim():e))),l.number&&(a=r.map(X)));let u=n[c=G(t)]||n[c=G(V(t))];!u&&s&&(u=n[c=G(z(t))]),u&&on(u,e,6,a);const d=n[c+"Once"];if(d){if(e.emitted){if(e.emitted[c])return}else e.emitted={};e.emitted[c]=!0,on(d,e,6,a)}}function Br(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=t.emitsCache,r=o.get(e);if(void 0!==r)return r;const i=e.emits;let a={},s=!1;if(!I(e)){const o=e=>{const n=Br(e,t,!0);n&&(s=!0,$(a,n))};!n&&t.mixins.length&&t.mixins.forEach(o),e.extends&&o(e.extends),e.mixins&&e.mixins.forEach(o)}return i||s?(M(i)?i.forEach((e=>a[e]=null)):$(a,i),x(e)&&o.set(e,a),a):(x(e)&&o.set(e,null),null)}function Wr(e,t){return!(!e||!y(t))&&(t=t.slice(2).replace(/Once$/,""),P(e,t[0].toLowerCase()+t.slice(1))||P(e,z(t))||P(e,t))}function Vr(e){const{type:t,vnode:n,proxy:o,withProxy:r,propsOptions:[i],slots:a,attrs:s,emit:l,render:c,renderCache:u,props:d,data:p,setupState:m,ctx:f,inheritAttrs:h}=e,g=Mn(e);let v,b;try{if(4&n.shapeFlag){const e=r||o,t=e;v=Pi(c.call(t,e,u,d,m,p,f)),b=s}else{const e=t;v=Pi(e.length>1?e(d,{attrs:s,slots:a,emit:l}):e(d,null)),b=t.props?s:qr(s)}}catch(t){ii.length=0,rn(t,e,1),v=yi(oi)}let y=v;if(b&&!1!==h){const e=Object.keys(b),{shapeFlag:t}=y;e.length&&7&t&&(i&&e.some(w)&&(b=zr(b,i)),y=$i(y,b,!1,!0))}return n.dirs&&(y=$i(y,null,!1,!0),y.dirs=y.dirs?y.dirs.concat(n.dirs):n.dirs),n.transition&&(y.transition=n.transition),v=y,Mn(g),v}const qr=e=>{let t;for(const n in e)("class"===n||"style"===n||y(n))&&((t||(t={}))[n]=e[n]);return t},zr=(e,t)=>{const n={};for(const o in e)w(o)&&o.slice(9)in t||(n[o]=e[o]);return n};function Hr(e,t,n){const o=Object.keys(t);if(o.length!==Object.keys(e).length)return!0;for(let r=0;r<o.length;r++){const i=o[r];if(t[i]!==e[i]&&!Wr(n,i))return!0}return!1}function Gr(e,t){let{vnode:n,parent:o}=e;for(;o;){const e=o.subTree;if(e.suspense&&e.suspense.activeBranch===n&&(e.el=n.el),e!==n)break;(n=o.vnode).el=t,o=o.parent}}const Kr=e=>e.__isSuspense;let Yr=0;const Jr={name:"Suspense",__isSuspense:!0,process(e,t,n,o,r,i,a,s,l,c){if(null==e)!function(e,t,n,o,r,i,a,s,l){const{p:c,o:{createElement:u}}=l,d=u("div"),p=e.suspense=Zr(e,r,o,t,d,n,i,a,s,l);c(null,p.pendingBranch=e.ssContent,d,null,o,p,i,a),p.deps>0?(Xr(e,"onPending"),Xr(e,"onFallback"),c(null,e.ssFallback,t,n,o,null,i,a),ei(p,e.ssFallback)):p.resolve(!1,!0)}(t,n,o,r,i,a,s,l,c);else{if(i&&i.deps>0&&!e.suspense.isInFallback)return t.suspense=e.suspense,t.suspense.vnode=t,void(t.el=e.el);!function(e,t,n,o,r,i,a,s,l){let{p:c,um:u,o:{createElement:d}}=l;const p=t.suspense=e.suspense;p.vnode=t,t.el=e.el;const m=t.ssContent,f=t.ssFallback,{activeBranch:h,pendingBranch:g,isInFallback:v,isHydrating:b}=p;if(g)p.pendingBranch=m,hi(m,g)?(c(g,m,p.hiddenContainer,null,r,p,i,a,s),p.deps<=0?p.resolve():v&&(b||(c(h,f,n,o,r,null,i,a,s),ei(p,f)))):(p.pendingId=Yr++,b?(p.isHydrating=!1,p.activeBranch=g):u(g,r,p),p.deps=0,p.effects.length=0,p.hiddenContainer=d("div"),v?(c(null,m,p.hiddenContainer,null,r,p,i,a,s),p.deps<=0?p.resolve():(c(h,f,n,o,r,null,i,a,s),ei(p,f))):h&&hi(m,h)?(c(h,m,n,o,r,p,i,a,s),p.resolve(!0)):(c(null,m,p.hiddenContainer,null,r,p,i,a,s),p.deps<=0&&p.resolve()));else if(h&&hi(m,h))c(h,m,n,o,r,p,i,a,s),ei(p,m);else if(Xr(t,"onPending"),p.pendingBranch=m,512&m.shapeFlag?p.pendingId=m.component.suspenseId:p.pendingId=Yr++,c(null,m,p.hiddenContainer,null,r,p,i,a,s),p.deps<=0)p.resolve();else{const{timeout:e,pendingId:t}=p;e>0?setTimeout((()=>{p.pendingId===t&&p.fallback(f)}),e):0===e&&p.fallback(f)}}(e,t,n,o,r,a,s,l,c)}},hydrate:function(e,t,n,o,r,i,a,s,l){const c=t.suspense=Zr(t,o,n,e.parentNode,document.createElement("div"),null,r,i,a,s,!0),u=l(e,c.pendingBranch=t.ssContent,n,c,i,a);return 0===c.deps&&c.resolve(!1,!0),u},normalize:function(e){const{shapeFlag:t,children:n}=e,o=32&t;e.ssContent=Qr(o?n.default:n),e.ssFallback=o?Qr(n.fallback):yi(oi)}};function Xr(e,t){const n=e.props&&e.props[t];I(n)&&n()}function Zr(e,t,n,o,r,i,a,s,l,c){let u=arguments.length>10&&void 0!==arguments[10]&&arguments[10];const{p:d,m:p,um:m,n:f,o:{parentNode:h,remove:g}}=c;let v;const b=function(e){const t=e.props&&e.props.suspensible;return null!=t&&!1!==t}(e);b&&t&&t.pendingBranch&&(v=t.pendingId,t.deps++);const y=e.props?Z(e.props.timeout):void 0,w=i,$={vnode:e,parent:t,parentComponent:n,namespace:a,container:o,hiddenContainer:r,deps:0,pendingId:Yr++,timeout:"number"==typeof y?y:-1,activeBranch:null,pendingBranch:null,isInFallback:!u,isHydrating:u,isUnmounted:!1,effects:[],resolve(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{vnode:o,activeBranch:r,pendingBranch:a,pendingId:s,effects:l,parentComponent:c,container:u}=$;let d=!1;$.isHydrating?$.isHydrating=!1:e||(d=r&&a.transition&&"out-in"===a.transition.mode,d&&(r.transition.afterLeave=()=>{s===$.pendingId&&(p(a,u,i===w?f(r):i,0),bn(l))}),r&&(h(r.el)!==$.hiddenContainer&&(i=f(r)),m(r,c,$,!0)),d||p(a,u,i,0)),ei($,a),$.pendingBranch=null,$.isInFallback=!1;let g=$.parent,y=!1;for(;g;){if(g.pendingBranch){g.effects.push(...l),y=!0;break}g=g.parent}y||d||bn(l),$.effects=[],b&&t&&t.pendingBranch&&v===t.pendingId&&(t.deps--,0!==t.deps||n||t.resolve()),Xr(o,"onResolve")},fallback(e){if(!$.pendingBranch)return;const{vnode:t,activeBranch:n,parentComponent:o,container:r,namespace:i}=$;Xr(t,"onFallback");const a=f(n),c=()=>{$.isInFallback&&(d(null,e,r,a,o,null,i,s,l),ei($,e))},u=e.transition&&"out-in"===e.transition.mode;u&&(n.transition.afterLeave=c),$.isInFallback=!0,m(n,o,null,!0),u||c()},move(e,t,n){$.activeBranch&&p($.activeBranch,e,t,n),$.container=e},next:()=>$.activeBranch&&f($.activeBranch),registerDep(e,t,n){const o=!!$.pendingBranch;o&&$.deps++;const r=e.vnode.el;e.asyncDep.catch((t=>{rn(t,e,0)})).then((i=>{if(e.isUnmounted||$.isUnmounted||$.pendingId!==e.suspenseId)return;e.asyncResolved=!0;const{vnode:s}=e;Bi(e,i,!1),r&&(s.el=r);const l=!r&&e.subTree.el;t(e,s,h(r||e.subTree.el),r?null:f(e.subTree),$,a,n),l&&g(l),Gr(e,s.el),o&&0==--$.deps&&$.resolve()}))},unmount(e,t){$.isUnmounted=!0,$.activeBranch&&m($.activeBranch,n,e,t),$.pendingBranch&&m($.pendingBranch,n,e,t)}};return $}function Qr(e){let t;if(I(e)){const n=ci&&e._c;n&&(e._d=!1,si()),e=e(),n&&(e._d=!0,t=ai,li())}if(M(e)){const t=function(e){let t;for(let n=0;n<e.length;n++){const o=e[n];if(!fi(o))return;if(o.type!==oi||"v-if"===o.children){if(t)return;t=o}}return t}(e);e=t}return e=Pi(e),t&&!e.dynamicChildren&&(e.dynamicChildren=t.filter((t=>t!==e))),e}function ei(e,t){e.activeBranch=t;const{vnode:n,parentComponent:o}=e;let r=t.el;for(;!r&&t.component;)r=(t=t.component.subTree).el;n.el=r,o&&o.subTree===n&&(o.vnode.el=r,Gr(o,r))}const ti=Symbol.for("v-fgt"),ni=Symbol.for("v-txt"),oi=Symbol.for("v-cmt"),ri=Symbol.for("v-stc"),ii=[];let ai=null;function si(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];ii.push(ai=e?null:[])}function li(){ii.pop(),ai=ii[ii.length-1]||null}let ci=1;function ui(e){ci+=e,e<0&&ai&&(ai.hasOnce=!0)}function di(e){return e.dynamicChildren=ci>0?ai||g:null,li(),ci>0&&ai&&ai.push(e),e}function pi(e,t,n,o,r,i){return di(bi(e,t,n,o,r,i,!0))}function mi(e,t,n,o,r){return di(yi(e,t,n,o,r,!0))}function fi(e){return!!e&&!0===e.__v_isVNode}function hi(e,t){return e.type===t.type&&e.key===t.key}const gi=e=>{let{key:t}=e;return null!=t?t:null},vi=e=>{let{ref:t,ref_key:n,ref_for:o}=e;return"number"==typeof t&&(t=""+t),null!=t?R(t)||Wt(t)||I(t)?{i:_n,r:t,k:n,f:!!o}:t:null};function bi(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e===ti?0:1,a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&gi(t),ref:t&&vi(t),scopeId:Pn,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:o,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:_n};return s?(Ti(l,n),128&i&&e.normalize(l)):n&&(l.shapeFlag|=R(n)?8:16),ci>0&&!a&&ai&&(l.patchFlag>0||6&i)&&32!==l.patchFlag&&ai.push(l),l}const yi=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(e&&e!==bo||(e=oi),fi(e)){const o=$i(e,t,!0);return n&&Ti(o,n),ci>0&&!i&&ai&&(6&o.shapeFlag?ai[ai.indexOf(e)]=o:ai.push(o)),o.patchFlag=-2,o}var a;if(I(a=e)&&"__vccOpts"in a&&(e=e.__vccOpts),t){t=wi(t);let{class:e,style:n}=t;e&&!R(e)&&(t.class=ae(e)),x(n)&&(Lt(n)&&!M(n)&&(n=$({},n)),t.style=te(n))}return bi(e,t,n,o,r,R(e)?1:Kr(e)?128:(e=>e.__isTeleport)(e)?64:x(e)?4:I(e)?2:0,i,!0)};function wi(e){return e?Lt(e)||tr(e)?$({},e):e:null}function $i(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const{props:r,ref:i,patchFlag:a,children:s,transition:l}=e,c=t?Ci(r||{},t):r,u={__v_isVNode:!0,__v_skip:!0,type:e.type,props:c,key:c&&gi(c),ref:t&&t.ref?n&&i?M(i)?i.concat(vi(t)):[i,vi(t)]:vi(t):i,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:s,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==ti?-1===a?16:16|a:a,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:l,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&$i(e.ssContent),ssFallback:e.ssFallback&&$i(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return l&&o&&Bn(u,l.clone(u)),u}function ki(){return yi(ni,null,arguments.length>0&&void 0!==arguments[0]?arguments[0]:" ",arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)}function Si(e,t){const n=yi(ri,null,e);return n.staticCount=t,n}function _i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?(si(),mi(oi,null,e)):yi(oi,null,e)}function Pi(e){return null==e||"boolean"==typeof e?yi(oi):M(e)?yi(ti,null,e.slice()):"object"==typeof e?Mi(e):yi(ni,null,String(e))}function Mi(e){return null===e.el&&-1!==e.patchFlag||e.memo?e:$i(e)}function Ti(e,t){let n=0;const{shapeFlag:o}=e;if(null==t)t=null;else if(M(t))n=16;else if("object"==typeof t){if(65&o){const n=t.default;return void(n&&(n._c&&(n._d=!1),Ti(e,n()),n._c&&(n._d=!0)))}{n=32;const o=t._;o||tr(t)?3===o&&_n&&(1===_n.slots._?t._=1:(t._=2,e.patchFlag|=1024)):t._ctx=_n}}else I(t)?(t={default:t,_ctx:_n},n=32):(t=String(t),64&o?(n=16,t=[ki(t)]):n=8);e.children=t,e.shapeFlag|=n}function Ci(){const e={};for(let t=0;t<arguments.length;t++){const n=t<0||arguments.length<=t?void 0:arguments[t];for(const t in n)if("class"===t)e.class!==n.class&&(e.class=ae([e.class,n.class]));else if("style"===t)e.style=te([e.style,n.style]);else if(y(t)){const o=e[t],r=n[t];!r||o===r||M(o)&&o.includes(r)||(e[t]=o?[].concat(o,r):r)}else""!==t&&(e[t]=n[t])}return e}function Ei(e,t,n){on(e,t,7,[n,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null])}const Ii=Go();let Ri=0,Ai=null;const xi=()=>Ai||_n;let Li,Oi;{const e=ee(),t=(t,n)=>{let o;return(o=e[t])||(o=e[t]=[]),o.push(n),e=>{o.length>1?o.forEach((t=>t(e))):o[0](e)}};Li=t("__VUE_INSTANCE_SETTERS__",(e=>Ai=e)),Oi=t("__VUE_SSR_SETTERS__",(e=>Fi=e))}const ji=e=>{const t=Ai;return Li(e),e.scope.on(),()=>{e.scope.off(),Li(t)}},Di=()=>{Ai&&Ai.scope.off(),Li(null)};function Ni(e){return 4&e.vnode.shapeFlag}let Ui,Fi=!1;function Bi(e,t,n){I(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:x(t)&&(e.setupState=Jt(t)),Wi(e,n)}function Wi(e,t,n){const o=e.type;if(!e.render){if(!t&&Ui&&!o.render){const t=o.template||Uo(e).template;if(t){const{isCustomElement:n,compilerOptions:r}=e.appContext.config,{delimiters:i,compilerOptions:a}=o,s=$($({isCustomElement:n,delimiters:i},r),a);o.render=Ui(t,s)}}e.render=o.render||v}{const t=ji(e);Ee();try{!function(e){const t=Uo(e),n=e.proxy,o=e.ctx;jo=!1,t.beforeCreate&&Do(t.beforeCreate,e,"bc");const{data:r,computed:i,methods:a,watch:s,provide:l,inject:c,created:u,beforeMount:d,mounted:p,beforeUpdate:m,updated:f,activated:h,deactivated:g,beforeDestroy:b,beforeUnmount:y,destroyed:w,unmounted:$,render:k,renderTracked:S,renderTriggered:_,errorCaptured:P,serverPrefetch:T,expose:C,inheritAttrs:E,components:R,directives:A,filters:L}=t;if(c&&function(e,t){M(e)&&(e=Vo(e));for(const n in e){const o=e[n];let r;r=x(o)?"default"in o?Zo(o.from||n,o.default,!0):Zo(o.from||n):Zo(o),Wt(r)?Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:()=>r.value,set:e=>r.value=e}):t[n]=r}}(c,o),a)for(const e in a){const t=a[e];I(t)&&(o[e]=t.bind(n))}if(r){const t=r.call(n,n);x(t)&&(e.data=Mt(t))}if(jo=!0,i)for(const e in i){const t=i[e],r=I(t)?t.bind(n,n):I(t.get)?t.get.bind(n,n):v,a=!I(t)&&I(t.set)?t.set.bind(n):v,s=Gi({get:r,set:a});Object.defineProperty(o,e,{enumerable:!0,configurable:!0,get:()=>s.value,set:e=>s.value=e})}if(s)for(const e in s)No(s[e],o,n,e);if(l){const e=I(l)?l.call(n):l;Reflect.ownKeys(e).forEach((t=>{Xo(t,e[t])}))}function O(e,t){M(t)?t.forEach((t=>e(t.bind(n)))):t&&e(t.bind(n))}if(u&&Do(u,e,"c"),O(io,d),O(ao,p),O(so,m),O(lo,f),O(Xn,h),O(Zn,g),O(ho,P),O(fo,S),O(mo,_),O(co,y),O(uo,$),O(po,T),M(C))if(C.length){const t=e.exposed||(e.exposed={});C.forEach((e=>{Object.defineProperty(t,e,{get:()=>n[e],set:t=>n[e]=t})}))}else e.exposed||(e.exposed={});k&&e.render===v&&(e.render=k),null!=E&&(e.inheritAttrs=E),R&&(e.components=R),A&&(e.directives=A)}(e)}finally{Ie(),t()}}}const Vi={get:(e,t)=>(Fe(e,0,""),e[t])};function qi(e){return{attrs:new Proxy(e.attrs,Vi),slots:e.slots,emit:e.emit,expose:t=>{e.exposed=t||{}}}}function zi(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(Jt(jt(e.exposed)),{get:(t,n)=>n in t?t[n]:n in Co?Co[n](e):void 0,has:(e,t)=>t in e||t in Co})):e.proxy}function Hi(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return I(e)?e.displayName||e.name:e.name||t&&e.__name}const Gi=(e,t)=>{const n=function(e,t){let n,o,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=I(e);return i?(n=e,o=v):(n=e.get,o=e.set),new Ut(n,o,i||!o,r)}(e,t,Fi);return n};function Ki(e,t,n){const o=arguments.length;return 2===o?x(t)&&!M(t)?fi(t)?yi(e,null,[t]):yi(e,t):yi(e,null,t):(o>3?n=Array.prototype.slice.call(arguments,2):3===o&&fi(n)&&(n=[n]),yi(e,t,n))}const Yi="3.4.35",Ji="undefined"!=typeof document?document:null,Xi=Ji&&Ji.createElement("template"),Zi={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,o)=>{const r="svg"===t?Ji.createElementNS("http://www.w3.org/2000/svg",e):"mathml"===t?Ji.createElementNS("http://www.w3.org/1998/Math/MathML",e):n?Ji.createElement(e,{is:n}):Ji.createElement(e);return"select"===e&&o&&null!=o.multiple&&r.setAttribute("multiple",o.multiple),r},createText:e=>Ji.createTextNode(e),createComment:e=>Ji.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Ji.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,o,r,i){const a=n?n.previousSibling:t.lastChild;if(r&&(r===i||r.nextSibling))for(;t.insertBefore(r.cloneNode(!0),n),r!==i&&(r=r.nextSibling););else{Xi.innerHTML="svg"===o?`<svg>${e}</svg>`:"mathml"===o?`<math>${e}</math>`:e;const r=Xi.content;if("svg"===o||"mathml"===o){const e=r.firstChild;for(;e.firstChild;)r.appendChild(e.firstChild);r.removeChild(e)}t.insertBefore(r,n)}return[a?a.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},Qi="transition",ea="animation",ta=Symbol("_vtc"),na=(e,t)=>{let{slots:n}=t;return Ki(jn,sa(e),n)};na.displayName="Transition";const oa={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},ra=na.props=$({},Ln,oa),ia=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];M(e)?e.forEach((e=>e(...t))):e&&e(...t)},aa=e=>!!e&&(M(e)?e.some((e=>e.length>1)):e.length>1);function sa(e){const t={};for(const n in e)n in oa||(t[n]=e[n]);if(!1===e.css)return t;const{name:n="v",type:o,duration:r,enterFromClass:i=`${n}-enter-from`,enterActiveClass:a=`${n}-enter-active`,enterToClass:s=`${n}-enter-to`,appearFromClass:l=i,appearActiveClass:c=a,appearToClass:u=s,leaveFromClass:d=`${n}-leave-from`,leaveActiveClass:p=`${n}-leave-active`,leaveToClass:m=`${n}-leave-to`}=e,f=function(e){if(null==e)return null;if(x(e))return[la(e.enter),la(e.leave)];{const t=la(e);return[t,t]}}(r),h=f&&f[0],g=f&&f[1],{onBeforeEnter:v,onEnter:b,onEnterCancelled:y,onLeave:w,onLeaveCancelled:k,onBeforeAppear:S=v,onAppear:_=b,onAppearCancelled:P=y}=t,M=(e,t,n)=>{ua(e,t?u:s),ua(e,t?c:a),n&&n()},T=(e,t)=>{e._isLeaving=!1,ua(e,d),ua(e,m),ua(e,p),t&&t()},C=e=>(t,n)=>{const r=e?_:b,a=()=>M(t,e,n);ia(r,[t,a]),da((()=>{ua(t,e?l:i),ca(t,e?u:s),aa(r)||ma(t,o,h,a)}))};return $(t,{onBeforeEnter(e){ia(v,[e]),ca(e,i),ca(e,a)},onBeforeAppear(e){ia(S,[e]),ca(e,l),ca(e,c)},onEnter:C(!1),onAppear:C(!0),onLeave(e,t){e._isLeaving=!0;const n=()=>T(e,t);ca(e,d),ca(e,p),va(),da((()=>{e._isLeaving&&(ua(e,d),ca(e,m),aa(w)||ma(e,o,g,n))})),ia(w,[e,n])},onEnterCancelled(e){M(e,!1),ia(y,[e])},onAppearCancelled(e){M(e,!0),ia(P,[e])},onLeaveCancelled(e){T(e),ia(k,[e])}})}function la(e){return Z(e)}function ca(e,t){t.split(/\s+/).forEach((t=>t&&e.classList.add(t))),(e[ta]||(e[ta]=new Set)).add(t)}function ua(e,t){t.split(/\s+/).forEach((t=>t&&e.classList.remove(t)));const n=e[ta];n&&(n.delete(t),n.size||(e[ta]=void 0))}function da(e){requestAnimationFrame((()=>{requestAnimationFrame(e)}))}let pa=0;function ma(e,t,n,o){const r=e._endId=++pa,i=()=>{r===e._endId&&o()};if(n)return setTimeout(i,n);const{type:a,timeout:s,propCount:l}=fa(e,t);if(!a)return o();const c=a+"end";let u=0;const d=()=>{e.removeEventListener(c,p),i()},p=t=>{t.target===e&&++u>=l&&d()};setTimeout((()=>{u<l&&d()}),s+1),e.addEventListener(c,p)}function fa(e,t){const n=window.getComputedStyle(e),o=e=>(n[e]||"").split(", "),r=o(`${Qi}Delay`),i=o(`${Qi}Duration`),a=ha(r,i),s=o(`${ea}Delay`),l=o(`${ea}Duration`),c=ha(s,l);let u=null,d=0,p=0;return t===Qi?a>0&&(u=Qi,d=a,p=i.length):t===ea?c>0&&(u=ea,d=c,p=l.length):(d=Math.max(a,c),u=d>0?a>c?Qi:ea:null,p=u?u===Qi?i.length:l.length:0),{type:u,timeout:d,propCount:p,hasTransform:u===Qi&&/\b(transform|all)(,|$)/.test(o(`${Qi}Property`).toString())}}function ha(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map(((t,n)=>ga(t)+ga(e[n]))))}function ga(e){return"auto"===e?0:1e3*Number(e.slice(0,-1).replace(",","."))}function va(){return document.body.offsetHeight}const ba=Symbol("_vod"),ya=Symbol("_vsh"),wa={beforeMount(e,t,n){let{value:o}=t,{transition:r}=n;e[ba]="none"===e.style.display?"":e.style.display,r&&o?r.beforeEnter(e):$a(e,o)},mounted(e,t,n){let{value:o}=t,{transition:r}=n;r&&o&&r.enter(e)},updated(e,t,n){let{value:o,oldValue:r}=t,{transition:i}=n;!o!=!r&&(i?o?(i.beforeEnter(e),$a(e,!0),i.enter(e)):i.leave(e,(()=>{$a(e,!1)})):$a(e,o))},beforeUnmount(e,t){let{value:n}=t;$a(e,n)}};function $a(e,t){e.style.display=t?e[ba]:"none",e[ya]=!t}const ka=Symbol(""),Sa=/(^|;)\s*display\s*:/,_a=/\s*!important$/;function Pa(e,t,n){if(M(n))n.forEach((n=>Pa(e,t,n)));else if(null==n&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const o=function(e,t){const n=Ta[t];if(n)return n;let o=V(t);if("filter"!==o&&o in e)return Ta[t]=o;o=H(o);for(let n=0;n<Ma.length;n++){const r=Ma[n]+o;if(r in e)return Ta[t]=r}return t}(e,t);_a.test(n)?e.setProperty(z(o),n.replace(_a,""),"important"):e[o]=n}}const Ma=["Webkit","Moz","ms"],Ta={},Ca="http://www.w3.org/1999/xlink";function Ea(e,t,n,o,r){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:le(t);o&&t.startsWith("xlink:")?null==n?e.removeAttributeNS(Ca,t.slice(6,t.length)):e.setAttributeNS(Ca,t,n):null==n||i&&!ce(n)?e.removeAttribute(t):e.setAttribute(t,i?"":A(n)?String(n):n)}function Ia(e,t,n,o){e.addEventListener(t,n,o)}const Ra=Symbol("_vei");const Aa=/(?:Once|Passive|Capture)$/;let xa=0;const La=Promise.resolve(),Oa=()=>xa||(La.then((()=>xa=0)),xa=Date.now()),ja=e=>111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,Da=new WeakMap,Na=new WeakMap,Ua=Symbol("_moveCb"),Fa=Symbol("_enterCb"),Ba={name:"TransitionGroup",props:$({},ra,{tag:String,moveClass:String}),setup(e,t){let{slots:n}=t;const o=xi(),r=An();let i,a;return lo((()=>{if(!i.length)return;const t=e.moveClass||`${e.name||"v"}-move`;if(!function(e,t,n){const o=e.cloneNode(),r=e[ta];r&&r.forEach((e=>{e.split(/\s+/).forEach((e=>e&&o.classList.remove(e)))})),n.split(/\s+/).forEach((e=>e&&o.classList.add(e))),o.style.display="none";const i=1===t.nodeType?t:t.parentNode;i.appendChild(o);const{hasTransform:a}=fa(o);return i.removeChild(o),a}(i[0].el,o.vnode.el,t))return;i.forEach(Wa),i.forEach(Va);const n=i.filter(qa);va(),n.forEach((e=>{const n=e.el,o=n.style;ca(n,t),o.transform=o.webkitTransform=o.transitionDuration="";const r=n[Ua]=e=>{e&&e.target!==n||e&&!/transform$/.test(e.propertyName)||(n.removeEventListener("transitionend",r),n[Ua]=null,ua(n,t))};n.addEventListener("transitionend",r)}))})),()=>{const t=Ot(e),s=sa(t);let l=t.tag||ti;if(i=[],a)for(let e=0;e<a.length;e++){const t=a[e];t.el&&t.el instanceof Element&&(i.push(t),Bn(t,Nn(t,s,r,o)),Da.set(t,t.el.getBoundingClientRect()))}a=n.default?Wn(n.default()):[];for(let e=0;e<a.length;e++){const t=a[e];null!=t.key&&Bn(t,Nn(t,s,r,o))}return yi(l,null,a)}}};function Wa(e){const t=e.el;t[Ua]&&t[Ua](),t[Fa]&&t[Fa]()}function Va(e){Na.set(e,e.el.getBoundingClientRect())}function qa(e){const t=Da.get(e),n=Na.get(e),o=t.left-n.left,r=t.top-n.top;if(o||r){const t=e.el.style;return t.transform=t.webkitTransform=`translate(${o}px,${r}px)`,t.transitionDuration="0s",e}}const za=e=>{const t=e.props["onUpdate:modelValue"]||!1;return M(t)?e=>Y(t,e):t};function Ha(e){e.target.composing=!0}function Ga(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Ka=Symbol("_assign"),Ya={created(e,t,n){let{modifiers:{lazy:o,trim:r,number:i}}=t;e[Ka]=za(n);const a=i||n.props&&"number"===n.props.type;Ia(e,o?"change":"input",(t=>{if(t.target.composing)return;let n=e.value;r&&(n=n.trim()),a&&(n=X(n)),e[Ka](n)})),r&&Ia(e,"change",(()=>{e.value=e.value.trim()})),o||(Ia(e,"compositionstart",Ha),Ia(e,"compositionend",Ga),Ia(e,"change",Ga))},mounted(e,t){let{value:n}=t;e.value=null==n?"":n},beforeUpdate(e,t,n){let{value:o,oldValue:r,modifiers:{lazy:i,trim:a,number:s}}=t;if(e[Ka]=za(n),e.composing)return;const l=null==o?"":o;if((!s&&"number"!==e.type||/^0\d/.test(e.value)?e.value:X(e.value))!==l){if(document.activeElement===e&&"range"!==e.type){if(i&&o===r)return;if(a&&e.value.trim()===l)return}e.value=l}}},Ja={deep:!0,created(e,t,n){e[Ka]=za(n),Ia(e,"change",(()=>{const t=e._modelValue,n=ts(e),o=e.checked,r=e[Ka];if(M(t)){const e=de(t,n),i=-1!==e;if(o&&!i)r(t.concat(n));else if(!o&&i){const n=[...t];n.splice(e,1),r(n)}}else if(C(t)){const e=new Set(t);o?e.add(n):e.delete(n),r(e)}else r(ns(e,o))}))},mounted:Xa,beforeUpdate(e,t,n){e[Ka]=za(n),Xa(e,t,n)}};function Xa(e,t,n){let{value:o,oldValue:r}=t;e._modelValue=o,M(o)?e.checked=de(o,n.props.value)>-1:C(o)?e.checked=o.has(n.props.value):o!==r&&(e.checked=ue(o,ns(e,!0)))}const Za={created(e,t,n){let{value:o}=t;e.checked=ue(o,n.props.value),e[Ka]=za(n),Ia(e,"change",(()=>{e[Ka](ts(e))}))},beforeUpdate(e,t,n){let{value:o,oldValue:r}=t;e[Ka]=za(n),o!==r&&(e.checked=ue(o,n.props.value))}},Qa={deep:!0,created(e,t,n){let{value:o,modifiers:{number:r}}=t;const i=C(o);Ia(e,"change",(()=>{const t=Array.prototype.filter.call(e.options,(e=>e.selected)).map((e=>r?X(ts(e)):ts(e)));e[Ka](e.multiple?i?new Set(t):t:t[0]),e._assigning=!0,hn((()=>{e._assigning=!1}))})),e[Ka]=za(n)},mounted(e,t){let{value:n,modifiers:{number:o}}=t;es(e,n)},beforeUpdate(e,t,n){e[Ka]=za(n)},updated(e,t){let{value:n,modifiers:{number:o}}=t;e._assigning||es(e,n)}};function es(e,t,n){const o=e.multiple,r=M(t);if(!o||r||C(t)){for(let n=0,i=e.options.length;n<i;n++){const i=e.options[n],a=ts(i);if(o)if(r){const e=typeof a;i.selected="string"===e||"number"===e?t.some((e=>String(e)===String(a))):de(t,a)>-1}else i.selected=t.has(a);else if(ue(ts(i),t))return void(e.selectedIndex!==n&&(e.selectedIndex=n))}o||-1===e.selectedIndex||(e.selectedIndex=-1)}}function ts(e){return"_value"in e?e._value:e.value}function ns(e,t){const n=t?"_trueValue":"_falseValue";return n in e?e[n]:t}const os={created(e,t,n){rs(e,t,n,null,"created")},mounted(e,t,n){rs(e,t,n,null,"mounted")},beforeUpdate(e,t,n,o){rs(e,t,n,o,"beforeUpdate")},updated(e,t,n,o){rs(e,t,n,o,"updated")}};function rs(e,t,n,o,r){const i=function(e,t){switch(e){case"SELECT":return Qa;case"TEXTAREA":return Ya;default:switch(t){case"checkbox":return Ja;case"radio":return Za;default:return Ya}}}(e.tagName,n.props&&n.props.type)[r];i&&i(e,t,n,o)}const is=["ctrl","shift","alt","meta"],as={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&0!==e.button,middle:e=>"button"in e&&1!==e.button,right:e=>"button"in e&&2!==e.button,exact:(e,t)=>is.some((n=>e[`${n}Key`]&&!t.includes(n)))},ss=(e,t)=>{const n=e._withMods||(e._withMods={}),o=t.join(".");return n[o]||(n[o]=function(n){for(let e=0;e<t.length;e++){const o=as[t[e]];if(o&&o(n,t))return}for(var o=arguments.length,r=new Array(o>1?o-1:0),i=1;i<o;i++)r[i-1]=arguments[i];return e(n,...r)})},ls={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},cs=(e,t)=>{const n=e._withKeys||(e._withKeys={}),o=t.join(".");return n[o]||(n[o]=n=>{if(!("key"in n))return;const o=z(n.key);return t.some((e=>e===o||ls[e]===o))?e(n):void 0})},us=$({patchProp:(e,t,n,o,r,i)=>{const a="svg"===r;"class"===t?function(e,t,n){const o=e[ta];o&&(t=(t?[t,...o]:[...o]).join(" ")),null==t?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}(e,o,a):"style"===t?function(e,t,n){const o=e.style,r=R(n);let i=!1;if(n&&!r){if(t)if(R(t))for(const e of t.split(";")){const t=e.slice(0,e.indexOf(":")).trim();null==n[t]&&Pa(o,t,"")}else for(const e in t)null==n[e]&&Pa(o,e,"");for(const e in n)"display"===e&&(i=!0),Pa(o,e,n[e])}else if(r){if(t!==n){const e=o[ka];e&&(n+=";"+e),o.cssText=n,i=Sa.test(n)}}else t&&e.removeAttribute("style");ba in e&&(e[ba]=i?o.display:"",e[ya]&&(o.display="none"))}(e,n,o):y(t)?w(t)||function(e,t,n,o){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const i=e[Ra]||(e[Ra]={}),a=i[t];if(o&&a)a.value=o;else{const[n,s]=function(e){let t;if(Aa.test(e)){let n;for(t={};n=e.match(Aa);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[":"===e[2]?e.slice(3):z(e.slice(2)),t]}(t);if(o){const a=i[t]=function(e,t){const n=e=>{if(e._vts){if(e._vts<=n.attached)return}else e._vts=Date.now();on(function(e,t){if(M(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map((e=>t=>!t._stopped&&e&&e(t)))}return t}(e,n.value),t,5,[e])};return n.value=e,n.attached=Oa(),n}(o,r);Ia(e,n,a,s)}else a&&(function(e,t,n,o){e.removeEventListener(t,n,o)}(e,n,a,s),i[t]=void 0)}}(e,t,n,o,i):("."===t[0]?(t=t.slice(1),1):"^"===t[0]?(t=t.slice(1),0):function(e,t,n,o){if(o)return"innerHTML"===t||"textContent"===t||!!(t in e&&ja(t)&&I(n));if("spellcheck"===t||"draggable"===t||"translate"===t)return!1;if("form"===t)return!1;if("list"===t&&"INPUT"===e.tagName)return!1;if("type"===t&&"TEXTAREA"===e.tagName)return!1;if("width"===t||"height"===t){const t=e.tagName;if("IMG"===t||"VIDEO"===t||"CANVAS"===t||"SOURCE"===t)return!1}return(!ja(t)||!R(n))&&t in e}(e,t,o,a))?(function(e,t,n){if("innerHTML"===t||"textContent"===t){if(null==n)return;return void(e[t]=n)}const o=e.tagName;if("value"===t&&"PROGRESS"!==o&&!o.includes("-")){const r="OPTION"===o?e.getAttribute("value")||"":e.value,i=null==n?"":String(n);return r===i&&"_value"in e||(e.value=i),null==n&&e.removeAttribute(t),void(e._value=n)}let r=!1;if(""===n||null==n){const o=typeof e[t];"boolean"===o?n=ce(n):null==n&&"string"===o?(n="",r=!0):"number"===o&&(n=0,r=!0)}try{e[t]=n}catch(e){}r&&e.removeAttribute(t)}(e,t,o),e.tagName.includes("-")||"value"!==t&&"checked"!==t&&"selected"!==t||Ea(e,t,o,a,i,"value"!==t)):("true-value"===t?e._trueValue=o:"false-value"===t&&(e._falseValue=o),Ea(e,t,o,a))}},Zi);let ds;const ps=function(){const e=(ds||(ds=_r(us))).createApp(...arguments),{mount:t}=e;return e.mount=n=>{const o=function(e){return R(e)?document.querySelector(e):e}(n);if(!o)return;const r=e._component;I(r)||r.render||r.template||(r.template=o.innerHTML),o.innerHTML="";const i=t(o,!1,function(e){return e instanceof SVGElement?"svg":"function"==typeof MathMLElement&&e instanceof MathMLElement?"mathml":void 0}(o));return o instanceof Element&&(o.removeAttribute("v-cloak"),o.setAttribute("data-v-app","")),i},e};function ms(e,t){return`${e}${Math.round(255*t).toString(16).padStart(2,"0")}`}function fs(e){let t=0,n=0;for(let o=0;o<e.length;o++){const r=e[o];r>n?n=r:r<t&&(t=r)}return Math.max(n,-t)}function hs(e,t,n){return(t-e)*n+e}function gs(e,t){return Math.sqrt(e*t)}function vs(e,t){return e*e/t}function bs(e){return 20*Math.log10(e)}function ys(e){const t=bs(e).toFixed(1).replace(/^-0.0$/,"0.0");return t>=0?`+${t} dB`:`${t} dB`}function ws(e){return 60/e.bpm/e.signature.noteValue*4}function $s(e){return ws(e)*e.signature.notesCount}function ks(e,t){let{scale:n,unit:o,min:r,max:i,displayUnit:a,displayMin:s,displayMax:l}=t;return angular.isDefined(s)&&angular.isDefined(l)?s+(l-s)*Ss(e,{scale:n,min:r,max:i}):e*Ms({unit:o,displayUnit:a})}function Ss(e,t){let{scale:n,min:o,max:r}=t;const i="log"===n?Math.log(e/o)/Math.log(r/o):(e-o)/(r-o);return Math.min(Math.max(i,0),1)}function _s(e,t){let{scale:n,unit:o,min:r,max:i,displayUnit:a,displayMin:s,displayMax:l}=t;return angular.isDefined(s)&&angular.isDefined(l)?Ps((e-s)/(l-s),{scale:n,min:r,max:i}):e/Ms({unit:o,displayUnit:a})}function Ps(e,t){let{scale:n,min:o,max:r}=t;return e=Math.min(Math.max(e,0),1),"log"===n?o*Math.pow(r/o,e):(r-o)*e+o}function Ms(e){let{unit:t,displayUnit:n}=e;return"s"===t&&"ms"===n?1e3:"ms"===t&&"s"===n?.001:""===t&&"%"===n?100:1}function Ts(e,t){return t===pl?ys(e):(e=ks(e,t),e=1===t.step?e.toFixed(0):.1===t.step?e.toFixed(1):.01===t.step?e.toFixed(2):.001===t.step?e.toFixed(3):`${e}`,`${(t.min<0&&e>0?"+":"")+(e=e.replace(/^-0(\.0+)?$/,"0$1"))} ${t.displayUnit??t.unit}`)}function Cs(e,t){return t?Math.round(Math.round(e/t)*t*1e3)/1e3:e}function Es(e,t){const n={C:0,"C#":1,Db:1,D:2,"D#":3,Eb:3,E:4,F:5,"F#":6,Gb:6,G:7,"G#":8,Ab:8,A:9,"A#":10,Bb:10,B:11},o=Is(e),r=Is(t),i=Rs(e);let a=n[Rs(t)]-n[i];return a=(a+12)%12,o&&!r?a+=3:!o&&r&&(a-=3),a>6&&(a-=12),a}function Is(e){return/(maj|M)*[^m]$/.test(e)&&e.indexOf("minor")<0}function Rs(e){return(e=(e=(e=(e=(e=(e=(e=e.replace("major","")).replace("maj","")).replace("M","")).replace("minor","")).replace("m","")).replace("","b")).replace("","#")).replace(/\s/g,"")}function As(e,t,n){return Math.max(t,Math.min(n,e))}function xs(e,t,n){const o={position:t,value:n};e.push(o),e.sort(((e,t)=>e.position-t.position)),e.length=e.indexOf(o)+1}function Ls(e,t,n){let{regex:o,callback:r}=t;const i=e.match(o)||[],[a,s,l]=i.slice(1).filter((e=>e.trim())),c=r(parseFloat(a),s,l);return isNaN(c)?n:c}angular.module("bandlab.account").directive("completeProfileGoals",(function(){return{restrict:"A",scope:{selectedGoal:"=",nextStep:"&"},link:function(e,t){const n=Mt({selectedGoal:e.selectedGoal,nextStep:e.nextStep,onUpdateSelectedGoal:function(t){e.selectedGoal=t}}),o=import("./chunk-7ef517b8.js").then((function(e){let{mountCompleteProfileGoals:o}=e;return o(t[0],{},n)}));e.$on("$destroy",(async function(){(await o).unmount()}))}}})).directive("completeProfileSkills",(function(){return{restrict:"A",scope:{skills:"=",nextStep:"&"},link:function(e,t){const n=Mt({skills:e.skills,nextStep:e.nextStep}),o=import("./chunk-7ef517b8.js").then((function(e){let{mountCompleteProfileSkills:o}=e;return o(t[0],{},n)}));e.$on("$destroy",(async function(){(await o).unmount()}))}}})).directive("completeProfileGenres",(function(){return{restrict:"A",scope:{genres:"=",nextStep:"&",submittedState:"="},link:function(e,t){const n=Mt({genres:e.genres,nextStep:e.nextStep,submittedState:e.submittedState}),o=import("./chunk-7ef517b8.js").then((function(e){let{mountCompleteProfileGenres:o}=e;return o(t[0],{},n)}));e.$on("$destroy",(async function(){(await o).unmount()}))}}})),angular.module("bandlab.account.login",["bandlab.account"]),angular.module("bandlab.account.login.routes",["ui.router"]).config(["$stateProvider",function(e){e.state("login",{url:"/login?state",resolve:{redirect:["$stateParams",function(e){const t=new URLSearchParams({redirect_uri:"https://www.bandlab.com/auth/bandlab/callback",nonce:m(),prompt:"login"});return e.state&&t.append("state",e.state),new Promise((function(){window.location.href=`https://accounts.bandlab.com/oauth/connect/authorize?client_id=bandlab_web&scope=openid+profile+email+linked_accounts+offline_access&response_type=code&response_mode=fragment&auth_type=bandlab_auth_code&${t.toString()}`}))}]}}).state("oauthBandlabCallback",{url:"/auth/bandlab/callback",params:{rewriteTracking:function(){return()=>"/auth/bandlab/callback"}},template:"<div></div>",controller:["$analytics","$location","$state","authService","ChatNotifications",function(e,t,n,o,r){const i=Object.fromEntries(new URLSearchParams(t.hash()));if(d()&&i.state){const{path:e=""}=JSON.parse(atob(i.state));window.location.href=e}return i.code?o.getNewAccessToken(i.code).then((function(t){return e.eventTrack("API_Auth_finished",{platform:"firebase",params:{is_signup:!1,success:!0}}),t})).catch((function(t){return e.eventTrack("API_Auth_finished",{platform:"firebase",params:{is_signup:!1,success:!1}}),n.go("500"),Promise.reject(t)})).then((function(e){return c(e),o.refreshMe()})).then((function(t){return e.eventTrack("initial_profile_load_finished",{platform:"firebase",params:{is_signup:!1,success:!0}}),o.identifyUserForTrackers(t)})).catch((function(t){return e.eventTrack("initial_profile_load_finished",{platform:"firebase",params:{is_signup:!1,success:!1}}),Promise.reject(t)})).then((function(t){if(new Date-new Date(t.createdOn)<6e4&&e.eventTrack("Register",{category:"Authentication",label:l.get("signupProvider")}),i.state){const{path:e=""}=JSON.parse(atob(i.state));window.location.href=e}return r.start(),o.redirectAfterAuth()})):n.go("login",{state:i.state})}]}).state("oauthAirbitCallback",{url:"/auth/airbit/callback?state&code",params:{rewriteTracking:function(){return()=>"/auth/airbit/callback"}},template:"<div></div>",controller:["$http","$state","$stateParams","authService","Identity","Me",function(e,t,n,o,r,i){if(!n.code)return u();const a=l.get("airbitState");if(l.remove("airbitState"),n.state!==a)return void t.go("500");const s=l.get("airbitCodeVerifier");l.remove("airbitCodeVerifier");const c=new FormData;function u(){return"true"===l.get("webview")&&(location.href="_#bl_closeWebView"),Promise.resolve().then((()=>rb)).then((function(e){let{logSocialLinkAdd:t}=e;t("airbit")})),t.go("settings.profile")}c.append("grant_type","authorization_code"),c.append("client_id","bandlab"),c.append("redirect_uri","https://www.bandlab.com/auth/airbit/callback"),c.append("code",n.code),c.append("state",a),c.append("code_verifier",s),e.post("https://accounts.airbit.com/oauth/token",c,{headers:{"Content-Type":void 0}}).then((function(t){const n=t.data.access_token;return e.get("https://api.airbit.com/sso/profile",{headers:{Authorize:n}})})).then((function(e){return r.update({links:{...i.links,airbit:`https://www.airbit.com/${e.data.data.nickname}`}}).$promise})).then((function(e){return delete e.genres,delete e.skills,o.setMe(e)})).then(u).catch((function(){return t.go("500")}))}]}).state("oauthInstagramCallback",{url:"/auth/instagram/callback?access_token&user_id",params:{rewriteTracking:function(){return()=>"/auth/instagram/callback"}},template:"<div></div>",controller:["$http","$state","$stateParams","authService","Identity","Me",function(e,t,n,o,r,i){if(!n.access_token)return a();function a(){return"true"===l.get("webview")&&(location.href="_#bl_closeWebView"),Promise.resolve().then((()=>rb)).then((function(e){let{logSocialLinkAdd:t}=e;t("instagram")})),t.go("settings.profile")}e({url:"https://graph.instagram.com/me",params:{fields:"id,username",access_token:n.access_token}}).then((function(e){return r.update({links:{...i.links,instagram:`https://www.instagram.com/${e.data.username}`}}).$promise})).then((function(e){return delete e.genres,delete e.skills,o.setMe(e)})).then(a).catch((function(){return t.go("500")}))}]}).state("oauthSoundcloudCallback",{url:"/auth/soundcloud/callback?success",params:{rewriteTracking:function(){return()=>"/auth/soundcloud/callback"}},template:"<div></div>",controller:["$state","$stateParams",function(e,t){return t.success?("true"===l.get("webview")&&(location.href="_#bl_closeWebView"),Promise.resolve().then((()=>rb)).then((function(e){let{logSocialLinkAdd:t}=e;t("soundcloud")})),e.go("settings.profile")):e.go("500")}]}).state("oauthTiktokCallback",{url:"/auth/tiktok/callback?success",params:{rewriteTracking:function(){return()=>"/auth/tiktok/callback"}},template:"<div></div>",controller:["$state","$stateParams",function(e,t){return t.success?("true"===l.get("webview")&&(location.href="_#bl_closeWebView"),Promise.resolve().then((()=>rb)).then((function(e){let{logSocialLinkAdd:t}=e;t("tiktok")})),e.go("settings.profile")):e.go("500")}]}).state("emailConfirmation",{url:"/email-confirm?userId&code",controller:["$stateParams",function(e){location.href=`https://accounts.bandlab.com/email-confirmation?${new URLSearchParams({code:e.code,userId:e.userId}).toString()}`}]}).state("logout",{url:"/logout",resolve:{redirect:["authService",function(e){e.logoutAccounts()}]}}).state("logoutSuccess",{url:"/logout-success",resolve:{redirect:["authService",function(e){e.logout()}]}}).state("captchaChallenge",{url:"/captcha-challenge",template:'<div class="invisible-recaptcha">',controller:["$state",function(e){import("./chunk-33d5c541.js").then((function(e){let{solveInvisibleCaptcha:t}=e;return t(!0)})).then((function(t){let{xCaptchaResponse:n}=t;e.go("captchaResponse",{token:n},{reload:!0})})).catch((function(t){e.go("captchaResponse",{error:t?.toString()},{reload:!0})}))}]}).state("captchaResponse",{url:"/captcha-response?token&error"})}]);const Os=/([+-\d.]+)/,js=/([+-\d.]+)(\s*)([%\w]*)/,Ds=/([+-\d.]+)(\s*)([%\w]*)(\s*)([%\w]*)/;function Ns(e){const t=e.tracks.flatMap((function(e){return e.regions})).map((function(e){return e.endPosition}));return fs(t)}function Us(e,t){let n=0,o=e.length-1;for(;n<=o;){const r=Math.floor((n+o)/2);if(e[r]===t)return e[r];e[r]<t?n=r+1:o=r-1}return o<0?e[n]:n>=e.length?e[o]:Math.abs(t-e[n])<=Math.abs(t-e[o])?e[n]:e[o]}function Fs(e,t){return(Math.exp(t*e)-Math.exp(-t*e))/(Math.exp(t*e)+Math.exp(-t*e))}const Bs=1e6;function Ws(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return+Math.round(e*Bs)/Bs}const Vs={name:"None",description:"Remove all Fx",slug:"none",effects:[]},qs={id:null,kit:{layers:[]},sampleIds:[],type:"MultipadSampler"},zs=[{hex:"#B400FF",name:"Violet"},{hex:"#2F93F6",name:"Blue"},{hex:"#00C6D1",name:"Cyan"},{hex:"#00C37D",name:"Green"},{hex:"#FFAF13",name:"Yellow"},{hex:"#FF690D",name:"Orange"},{hex:"#F12C18",name:"Red"}],Hs="audioinput",Gs="bandlab-instrument",Ks="drum-machine",Ys="guitar-bass",Js="guitar-electric",Xs="looper",Zs="sampler",Qs="voice",el=32,tl=["B major","B major","A major","A major","G major","G major","F major","F major","E major","E major","D major","D major","C major","C major","C major"],nl=["B minor","B minor","A minor","A minor","A minor","G minor","G minor","F minor","F minor","E minor","E minor","D minor","D minor","C minor","C minor"],ol=240,rl=[1,2,3,4,5,6],il=[1,2,4,8],al="studio-grand-v2-v4",sl="62-p-bass-v3-v4",ll="future-trap-kit-v4",cl="rhodes-v2-v4",ul="audioFilesDB",dl="audioFilesStore",pl={name:"volume",default:1,label:"Volume",max:2,min:0,base:0,range:2,scale:"log"},ml={default:0,display:{name:"Pan"},displayMax:50,displayMin:-50,displayUnit:"",max:1,min:-1,name:"pan",scale:"lin",step:1,type:"float",base:0,label:"Pan",origin:0,range:2},fl={default:.15,display:{name:"Reverb"},displayMax:100,displayMin:0,displayUnit:"%",max:1,min:0,name:"sendLevel",scale:"lin",step:1,type:"float",unit:"",label:"Reverb",range:1},hl=[{name:"Bass",icon:"bass",kind:"audioinput",slug:"guitar-bass"},{name:"Guitar",icon:"electric-guitar",kind:"audioinput",slug:"guitar-electric"},{name:"Looper",icon:"drum-machine",kind:"audioinput",slug:"looper"},{name:"Voice/Audio",icon:"micro",kind:"audioinput",slug:"voice"}],gl={icon:"drum-machine",kind:"drum-machine",slug:"drum-machine"},vl={name:"Sampler",icon:"sampler",kind:"sampler",slug:"sampler"},bl=[{filter:"instrument-808-basses",kind:"bandlab-instrument",slug:"synth-bass"},{filter:"instrument-acoustic-basses",kind:"bandlab-instrument",slug:"bass"},{filter:"instrument-acoustic-guitars",kind:"bandlab-instrument",slug:"guitars"},{filter:"instrument-drum-kits",kind:"bandlab-instrument",slug:"drum-kit"},{filter:"instrument-drum-pads",kind:"bandlab-instrument",slug:"drum-pads"},{filter:"instrument-electric-basses",kind:"bandlab-instrument",slug:"bass"},{filter:"instrument-electric-guitars",kind:"bandlab-instrument",slug:"guitars"},{filter:"instrument-organs",kind:"bandlab-instrument",slug:"piano"},{filter:"instrument-pianos",kind:"bandlab-instrument",slug:"piano"},{filter:"instrument-synth-basses",kind:"bandlab-instrument",slug:"synth-bass"},{filter:"instrument-synth-keys",kind:"bandlab-instrument",slug:"synth-keys"},{filter:"instrument-synth-leads",kind:"bandlab-instrument",slug:"synth-leads"},{filter:"instrument-synth-pads",kind:"bandlab-instrument",slug:"synth-pads"},{filter:"instrument-type-brass",kind:"bandlab-instrument",slug:"brass"},{filter:"instrument-type-creator-kits",kind:"bandlab-instrument",slug:"creators-kit"},{filter:"instrument-type-guitars",kind:"bandlab-instrument",slug:"guitars"},{filter:"instrument-type-percussion",kind:"bandlab-instrument",slug:"percussion"},{filter:"instrument-type-special-effects",kind:"bandlab-instrument",slug:"special-effects"},{filter:"instrument-type-strings",kind:"bandlab-instrument",slug:"strings"},{filter:"instrument-type-voices",kind:"bandlab-instrument",slug:"voices"},{filter:"instrument-type-winds",kind:"bandlab-instrument",slug:"wind"}],yl=[...hl,gl,vl,...bl],wl=[{scaleMin:1,scaleMax:4,primary:10,secondary:1},{scaleMin:4,scaleMax:6,primary:5,secondary:1},{scaleMin:6,scaleMax:10,primary:2,secondary:1},{scaleMin:10,scaleMax:160,primary:1,secondary:.25},{scaleMin:160,scaleMax:640,primary:.2,secondary:.01}],$l=[{readable:"Smart",value:0},{readable:"Bar",value:1},{readable:"1/2",value:.5},{readable:"1/2T",value:.5,triplet:!0},{readable:"1/4",value:1/4},{readable:"1/4T",value:1/4,triplet:!0},{readable:"1/8",value:1/8},{readable:"1/8T",value:1/8,triplet:!0},{readable:"1/16",value:1/16},{readable:"1/16T",value:1/16,triplet:!0},{readable:"1/32",value:1/32},{readable:"1/32T",value:1/32,triplet:!0}],kl=10,Sl=20,_l=40,Pl=80,Ml=160,Tl=320,Cl=640,El=[kl,Sl,_l,Pl,Ml,Tl,Cl],Il={[1/4]:{[kl]:3,[Sl]:2,[_l]:2,[Pl]:1,[Ml]:.5,[Tl]:1/4,[Cl]:1/4},.5:{[kl]:2,[Sl]:1,[_l]:1,[Pl]:.5,[Ml]:1/4,[Tl]:1/8,[Cl]:1/8},[3/4]:{[kl]:2,[Sl]:2,[_l]:1,[Pl]:1/3,[Ml]:1/6,[Tl]:1/12,[Cl]:1/12},1:{[kl]:2,[Sl]:1,[_l]:.5,[Pl]:1/4,[Ml]:1/8,[Tl]:1/16,[Cl]:1/16},[5/4]:{[kl]:2,[Sl]:1,[_l]:1,[Pl]:.2,[Ml]:.2,[Tl]:.05,[Cl]:.05},1.5:{[kl]:2,[Sl]:1,[_l]:.5,[Pl]:1/6,[Ml]:1/12,[Tl]:1/24,[Cl]:1/24}},Rl=281,Al=12,xl=22,Ll=1,Ol=640,jl=Array.from({length:101},((e,t)=>Ps(t/100,{scale:"log",min:1,max:Ol}))),Dl={};for(const e in Il){Dl[e]={};for(const t of jl)if(t>=10){const n=Us(El,t),o=Il[e][n];Dl[e][t]=o}}const Nl=1/127,Ul=100/127,Fl="sharedReverb";function Bl(){return[{id:"aux1",returnLevel:1,preset:Fl}]}function Wl(){return[{automation:[],id:"aux1",sendLevel:0}]}const Vl=.05,ql=function(){try{return localStorage.key(0),localStorage}catch(e){return{key:()=>{},getItem:()=>{},setItem:()=>{},removeItem:()=>{},clear:()=>{}}}}(),zl="object"==typeof global&&global&&global.Object===Object&&global;var Hl="object"==typeof self&&self&&self.Object===Object&&self;const Gl=zl||Hl||Function("return this")(),Kl=Gl.Symbol;var Yl=Object.prototype,Jl=Yl.hasOwnProperty,Xl=Yl.toString,Zl=Kl?Kl.toStringTag:void 0,Ql=Object.prototype.toString,ec="[object Null]",tc="[object Undefined]",nc=Kl?Kl.toStringTag:void 0;function oc(e){return null==e?void 0===e?tc:ec:nc&&nc in Object(e)?function(e){var t=Jl.call(e,Zl),n=e[Zl];try{e[Zl]=void 0;var o=!0}catch(e){}var r=Xl.call(e);return o&&(t?e[Zl]=n:delete e[Zl]),r}(e):function(e){return Ql.call(e)}(e)}function rc(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var ic="[object AsyncFunction]",ac="[object Function]",sc="[object GeneratorFunction]",lc="[object Proxy]";function cc(e){if(!rc(e))return!1;var t=oc(e);return t==ac||t==sc||t==ic||t==lc}const uc=Gl["__core-js_shared__"];var dc=function(){var e=/[^.]+$/.exec(uc&&uc.keys&&uc.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),pc=Function.prototype.toString;function mc(e){if(null!=e){try{return pc.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var fc=/^\[object .+?Constructor\]$/,hc=Function.prototype,gc=Object.prototype,vc=hc.toString,bc=gc.hasOwnProperty,yc=RegExp("^"+vc.call(bc).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function wc(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!rc(e)||(t=e,dc&&dc in t))&&(cc(e)?yc:fc).test(mc(e));var t}(n)?n:void 0}const $c=wc(Object,"create");var kc=Object.prototype.hasOwnProperty,Sc=Object.prototype.hasOwnProperty;function _c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function Pc(e,t){return e===t||e!=e&&t!=t}function Mc(e,t){for(var n=e.length;n--;)if(Pc(e[n][0],t))return n;return-1}_c.prototype.clear=function(){this.__data__=$c?$c(null):{},this.size=0},_c.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},_c.prototype.get=function(e){var t=this.__data__;if($c){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return kc.call(t,e)?t[e]:void 0},_c.prototype.has=function(e){var t=this.__data__;return $c?void 0!==t[e]:Sc.call(t,e)},_c.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=$c&&void 0===t?"__lodash_hash_undefined__":t,this};var Tc=Array.prototype.splice;function Cc(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}Cc.prototype.clear=function(){this.__data__=[],this.size=0},Cc.prototype.delete=function(e){var t=this.__data__,n=Mc(t,e);return!(n<0||(n==t.length-1?t.pop():Tc.call(t,n,1),--this.size,0))},Cc.prototype.get=function(e){var t=this.__data__,n=Mc(t,e);return n<0?void 0:t[n][1]},Cc.prototype.has=function(e){return Mc(this.__data__,e)>-1},Cc.prototype.set=function(e,t){var n=this.__data__,o=Mc(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this};const Ec=wc(Gl,"Map");function Ic(e,t){var n,o,r=e.__data__;return("string"==(o=typeof(n=t))||"number"==o||"symbol"==o||"boolean"==o?"__proto__"!==n:null===n)?r["string"==typeof t?"string":"hash"]:r.map}function Rc(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}Rc.prototype.clear=function(){this.size=0,this.__data__={hash:new _c,map:new(Ec||Cc),string:new _c}},Rc.prototype.delete=function(e){var t=Ic(this,e).delete(e);return this.size-=t?1:0,t},Rc.prototype.get=function(e){return Ic(this,e).get(e)},Rc.prototype.has=function(e){return Ic(this,e).has(e)},Rc.prototype.set=function(e,t){var n=Ic(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this};function Ac(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var o=arguments,r=t?t.apply(this,o):o[0],i=n.cache;if(i.has(r))return i.get(r);var a=e.apply(this,o);return n.cache=i.set(r,a)||i,a};return n.cache=new(Ac.Cache||Rc),n}Ac.Cache=Rc;const xc=Ac((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.head,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise(((o,r)=>{const i=document.createElement("script");n.id&&(i.id=n.id),i.src=e,i.onload=o,i.onerror=r,t.appendChild(i)}))})),Lc=Object.freeze(Object.defineProperty({__proto__:null,load:xc},Symbol.toStringTag,{value:"Module"})),Oc="feed",jc="onboarding",Dc=new Set(["landing","login","passwordReset","signUp"]),Nc=new Set(["album","beatsDownload","beatsPurchase","checkout","connectTipaltiAccount","feed","chat","classroom","classrooms","dashboard","distributionCreate","distributionEdit","creatorConnect","fanReachCreate","getMembership","joinProject","library","me","membershipOnboarding","mixEditor","notifications","playbackhistory","radioConsent","postNew","proFeedback","promoteWizard","promoteOverview","report","reportEntity","reportGeneral","school","search","settings","subscribers","userMe","onboarding","logout","warning"]);class Uc extends Error{response;request;options;constructor(e,t,n){const o=`${e.status||0===e.status?e.status:""} ${e.statusText||""}`.trim();super(`Request failed with ${o?`status code ${o}`:"an unknown error"}: ${t.method} ${t.url}`),this.name="HTTPError",this.response=e,this.request=t,this.options=n}}class Fc extends Error{request;constructor(e){super(`Request timed out: ${e.method} ${e.url}`),this.name="TimeoutError",this.request=e}}const Bc=e=>null!==e&&"object"==typeof e,Wc=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const e of t)if((!Bc(e)||Array.isArray(e))&&void 0!==e)throw new TypeError("The `options` argument must be an object");return qc({},...t)},Vc=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=new globalThis.Headers(e),o=t instanceof globalThis.Headers,r=new globalThis.Headers(t);for(const[e,t]of r.entries())o&&"undefined"===t||void 0===t?n.delete(e):n.set(e,t);return n},qc=function(){let e={},t={};for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];for(const n of o)if(Array.isArray(n))Array.isArray(e)||(e=[]),e=[...e,...n];else if(Bc(n)){for(let[t,o]of Object.entries(n))Bc(o)&&t in e&&(o=qc(e[t],o)),e={...e,[t]:o};Bc(n.headers)&&(t=Vc(t,n.headers),e.headers=t)}return e},zc=(()=>{let e=!1,t=!1;const n="function"==typeof globalThis.ReadableStream,o="function"==typeof globalThis.Request;if(n&&o)try{t=new globalThis.Request("https://empty.invalid",{body:new globalThis.ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type")}catch(e){if(e instanceof Error&&"unsupported BodyInit type"===e.message)return!1;throw e}return e&&!t})(),Hc="function"==typeof globalThis.AbortController,Gc="function"==typeof globalThis.ReadableStream,Kc="function"==typeof globalThis.FormData,Yc=["get","post","put","patch","head","delete"],Jc={json:"application/json",text:"text/*",formData:"multipart/form-data",arrayBuffer:"*/*",blob:"*/*"},Xc=2147483647,Zc=Symbol("stop"),Qc={json:!0,parseJson:!0,stringifyJson:!0,searchParams:!0,prefixUrl:!0,retry:!0,timeout:!0,hooks:!0,throwHttpErrors:!0,onDownloadProgress:!0,fetch:!0},eu={method:!0,headers:!0,body:!0,mode:!0,credentials:!0,cache:!0,redirect:!0,referrer:!0,referrerPolicy:!0,integrity:!0,keepalive:!0,signal:!0,window:!0,dispatcher:!0,duplex:!0,priority:!0},tu=e=>Yc.includes(e)?e.toUpperCase():e,nu={limit:2,methods:["get","put","head","delete","options","trace"],statusCodes:[408,413,429,500,502,503,504],afterStatusCodes:[413,429,503],maxRetryAfter:Number.POSITIVE_INFINITY,backoffLimit:Number.POSITIVE_INFINITY,delay:e=>.3*2**(e-1)*1e3},ou=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("number"==typeof e)return{...nu,limit:e};if(e.methods&&!Array.isArray(e.methods))throw new Error("retry.methods must be an array");if(e.statusCodes&&!Array.isArray(e.statusCodes))throw new Error("retry.statusCodes must be an array");return{...nu,...e}};class ru{static create(e,t){const n=new ru(e,t),o=async()=>{if("number"==typeof n._options.timeout&&n._options.timeout>Xc)throw new RangeError("The `timeout` option cannot be greater than 2147483647");await Promise.resolve();let e=await n._fetch();for(const t of n._options.hooks.afterResponse){const o=await t(n.request,n._options,n._decorateResponse(e.clone()));o instanceof globalThis.Response&&(e=o)}if(n._decorateResponse(e),!e.ok&&n._options.throwHttpErrors){let t=new Uc(e,n.request,n._options);for(const e of n._options.hooks.beforeError)t=await e(t);throw t}if(n._options.onDownloadProgress){if("function"!=typeof n._options.onDownloadProgress)throw new TypeError("The `onDownloadProgress` option must be a function");if(!Gc)throw new Error("Streams are not supported in your environment. `ReadableStream` is missing.");return n._stream(e.clone(),n._options.onDownloadProgress)}return e},r=n._options.retry.methods.includes(n.request.method.toLowerCase())?n._retry(o):o();for(const[e,o]of Object.entries(Jc))r[e]=async()=>{n.request.headers.set("accept",n.request.headers.get("accept")||o);const i=(await r).clone();if("json"===e){if(204===i.status)return"";if(0===(await i.clone().arrayBuffer()).byteLength)return"";if(t.parseJson)return t.parseJson(await i.text())}return i[e]()};return r}request;abortController;_retryCount=0;_input;_options;constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._input=e;const n=this._input instanceof Request&&"credentials"in Request.prototype?this._input.credentials:void 0;if(this._options={...n&&{credentials:n},...t,headers:Vc(this._input.headers,t.headers),hooks:qc({beforeRequest:[],beforeRetry:[],beforeError:[],afterResponse:[]},t.hooks),method:tu(t.method??this._input.method),prefixUrl:String(t.prefixUrl||""),retry:ou(t.retry),throwHttpErrors:!1!==t.throwHttpErrors,timeout:t.timeout??1e4,fetch:t.fetch??globalThis.fetch.bind(globalThis)},"string"!=typeof this._input&&!(this._input instanceof URL||this._input instanceof globalThis.Request))throw new TypeError("`input` must be a string, URL, or Request");if(this._options.prefixUrl&&"string"==typeof this._input){if(this._input.startsWith("/"))throw new Error("`input` must not begin with a slash when using `prefixUrl`");this._options.prefixUrl.endsWith("/")||(this._options.prefixUrl+="/"),this._input=this._options.prefixUrl+this._input}if(Hc){if(this.abortController=new globalThis.AbortController,this._options.signal){const e=this._options.signal;this._options.signal.addEventListener("abort",(()=>{this.abortController.abort(e.reason)}))}this._options.signal=this.abortController.signal}if(zc&&(this._options.duplex="half"),void 0!==this._options.json&&(this._options.body=this._options.stringifyJson?.(this._options.json)??JSON.stringify(this._options.json),this._options.headers.set("content-type",this._options.headers.get("content-type")??"application/json")),this.request=new globalThis.Request(this._input,this._options),this._options.searchParams){const e="?"+("string"==typeof this._options.searchParams?this._options.searchParams.replace(/^\?/,""):new URLSearchParams(this._options.searchParams).toString()),t=this.request.url.replace(/(?:\?.*?)?(?=#|$)/,e);!(Kc&&this._options.body instanceof globalThis.FormData||this._options.body instanceof URLSearchParams)||this._options.headers&&this._options.headers["content-type"]||this.request.headers.delete("content-type"),this.request=new globalThis.Request(new globalThis.Request(t,{...this.request}),this._options)}}_calculateRetryDelay(e){if(this._retryCount++,this._retryCount>this._options.retry.limit||e instanceof Fc)throw e;if(e instanceof Uc){if(!this._options.retry.statusCodes.includes(e.response.status))throw e;const t=e.response.headers.get("Retry-After");if(t&&this._options.retry.afterStatusCodes.includes(e.response.status)){let e=1e3*Number(t);Number.isNaN(e)&&(e=Date.parse(t)-Date.now());const n=this._options.retry.maxRetryAfter??e;return e<n?e:n}if(413===e.response.status)throw e}const t=this._options.retry.delay(this._retryCount);return Math.min(this._options.retry.backoffLimit,t)}_decorateResponse(e){return this._options.parseJson&&(e.json=async()=>this._options.parseJson(await e.text())),e}async _retry(e){try{return await e()}catch(t){const n=Math.min(this._calculateRetryDelay(t),Xc);if(this._retryCount<1)throw t;await async function(e,t){let{signal:n}=t;return new Promise(((t,o)=>{function r(){clearTimeout(i),o(n.reason)}n&&(n.throwIfAborted(),n.addEventListener("abort",r,{once:!0}));const i=setTimeout((()=>{n?.removeEventListener("abort",r),t()}),e)}))}(n,{signal:this._options.signal});for(const e of this._options.hooks.beforeRetry)if(await e({request:this.request,options:this._options,error:t,retryCount:this._retryCount})===Zc)return;return this._retry(e)}}async _fetch(){for(const e of this._options.hooks.beforeRequest){const t=await e(this.request,this._options);if(t instanceof Request){this.request=t;break}if(t instanceof Response)return t}const e=((e,t)=>{const n={};for(const o in t)o in eu||o in Qc||o in e||(n[o]=t[o]);return n})(this.request,this._options),t=this.request;return this.request=t.clone(),!1===this._options.timeout?this._options.fetch(t,e):async function(e,t,n,o){return new Promise(((r,i)=>{const a=setTimeout((()=>{n&&n.abort(),i(new Fc(e))}),o.timeout);o.fetch(e,t).then(r).catch(i).then((()=>{clearTimeout(a)}))}))}(t,e,this.abortController,this._options)}_stream(e,t){const n=Number(e.headers.get("content-length"))||0;let o=0;return 204===e.status?(t&&t({percent:1,totalBytes:n,transferredBytes:o},new Uint8Array),new globalThis.Response(null,{status:e.status,statusText:e.statusText,headers:e.headers})):new globalThis.Response(new globalThis.ReadableStream({async start(r){const i=e.body.getReader();t&&t({percent:0,transferredBytes:0,totalBytes:n},new Uint8Array),await async function e(){const{done:a,value:s}=await i.read();a?r.close():(t&&(o+=s.byteLength,t({percent:0===n?0:o/n,transferredBytes:o,totalBytes:n},s)),r.enqueue(s),await e())}()}}),{status:e.status,statusText:e.statusText,headers:e.headers})}}const iu=e=>{const t=(t,n)=>ru.create(t,Wc(e,n));for(const n of Yc)t[n]=(t,o)=>ru.create(t,Wc(e,o,{method:n}));return t.create=e=>iu(Wc(e)),t.extend=t=>("function"==typeof t&&(t=t(e??{})),iu(Wc(e,t))),t.stop=Zc,t},au=iu(),su="cdMaster",lu=["cdMaster","bassBoostMastering","enhanceClarity","tapeMaster","naturalMastering","spatialMastering","cinematicMastering","punchMastering"];function cu(e){return e.replace("Light","").replace("Heavy","")}function uu(e){return e.match(/Light$/)?"Light":e.match(/Heavy$/)?"Heavy":"Normal"}function du(e){return"cd-master"===e?"cdMaster":"bass-boost"===e?"bassBoostMastering":"enhance-clarity"===e?"enhanceClarity":e}function pu(e){const t=du(e);if(!t||"none"===t)return"None";if("custom"===t)return"Custom";const n=cu(t);return hu[n]?hu[n].name:"None"}function mu(e){const t=du(e);if(!t||"none"===t)return"none";if("custom"===t)return"custom";const n=cu(t),o=uu(t),r={cdMaster:"universal",bassBoostMastering:"fire",enhanceClarity:"clarity",tapeMaster:"tape",naturalMastering:"natural",spatialMastering:"spatial",cinematicMastering:"cinematic",punchMastering:"punch",custom:"custom"}[n]??"none";return r?r+("Normal"===o?"":`_${o.toLowerCase()}`):"none"}function fu(e){const t=du(e);if(!t)return"off";if("custom"===t)return"manual";if("none"===t)return"off";switch(cu(t)){case"cdMaster":return"auto";case"bassBoostMastering":case"enhanceClarity":case"tapeMaster":case"cinematicMastering":case"naturalMastering":case"punchMastering":case"spatialMastering":return"manual"}}const hu={cdMaster:{slug:"cdMaster",tryUrl:"https://www.bandlab.com/web-app/common/static/kpop4u-mastered-7530fe9dbf.m4a",tryOriginalUrl:"https://www.bandlab.com/web-app/common/static/kpop4u-unmastered-3e747bd48e.m4a",name:"Universal",shortDescription:"Natural dynamic and tonal balancing.",genres:["Rock","Pop","Electronic","Alternative"],color:"#b500ff",colorName:"purple",lottieUrl48:"https://www.bandlab.com/web-app/common/static/mastering_universal_48-a7d0d0e529.json",lottieUrl144:"https://www.bandlab.com/web-app/common/static/mastering_universal_144-8b4ec2a16e.json"},bassBoostMastering:{slug:"bassBoostMastering",tryUrl:"https://www.bandlab.com/web-app/common/static/space-juice-mastered-7ad475ac28.m4a",tryOriginalUrl:"https://www.bandlab.com/web-app/common/static/space-juice-unmastered-11c442bbfc.m4a",name:"Fire",shortDescription:"Punchy lows and midrange clarity.",genres:["Trap","Experimental","Reggaeton"],color:"#f22c18",colorName:"red",lottieUrl48:"https://www.bandlab.com/web-app/common/static/mastering_fire_48-ab0cf24a8b.json",lottieUrl144:"https://www.bandlab.com/web-app/common/static/mastering_fire_144-5dec31977d.json"},enhanceClarity:{slug:"enhanceClarity",tryUrl:"https://www.bandlab.com/web-app/common/static/fuchsia-days-mastered-d01cea74ed.m4a",tryOriginalUrl:"https://www.bandlab.com/web-app/common/static/fuchsia-days-unmastered-9231503fe3.m4a",name:"Clarity",shortDescription:"Pristine highs with light dynamic expansion.",genres:["Classical","R&B","Singer-songwriter"],color:"#2f94f7",colorName:"blue",lottieUrl48:"https://www.bandlab.com/web-app/common/static/mastering_clarity_48-6c94b2cec1.json",lottieUrl144:"https://www.bandlab.com/web-app/common/static/mastering_clarity_144-6473757ed1.json"},tapeMaster:{slug:"tapeMaster",tryUrl:"https://www.bandlab.com/web-app/common/static/tape-mastered-604f2624be.m4a",tryOriginalUrl:"https://www.bandlab.com/web-app/common/static/tape-unmastered-3bb2b0622c.m4a",name:"Tape",shortDescription:"Warm saturation with analog dynamics.",genres:["Jazz","Alternative","Indie","Rock"],color:"#ff690d",colorName:"orange",lottieUrl48:"https://www.bandlab.com/web-app/common/static/mastering_tape_48-f78496d43f.json",lottieUrl144:"https://www.bandlab.com/web-app/common/static/mastering_tape_144-a22be20905.json"},naturalMastering:{slug:"naturalMastering",tryUrl:"https://www.bandlab.com/web-app/common/static/natural-mastered-91041c0820.m4a",tryOriginalUrl:"https://www.bandlab.com/web-app/common/static/natural-unmastered-4240fb7874.m4a",name:"Natural",shortDescription:"Balanced dynamics and gentle compression.",genres:["Acoustic","Jazz","Singer-songwriter"],color:"#00c37d",colorName:"green",isPaid:!0,lottieUrl48:"https://www.bandlab.com/web-app/common/static/mastering_natural_48-468ae6d052.json",lottieUrl144:"https://www.bandlab.com/web-app/common/static/mastering_natural_144-53b709c130.json"},spatialMastering:{slug:"spatialMastering",tryUrl:"https://www.bandlab.com/web-app/common/static/spatial-mastered-1daea2ed53.m4a",tryOriginalUrl:"https://www.bandlab.com/web-app/common/static/spatial-unmastered-151a3192ec.m4a",name:"Spatial",shortDescription:"Atmospheric reverb and enhanced stereo width.",genres:["Ambient","Experimental","Electronic"],color:"#00c6d1",colorName:"cyan",isPaid:!0,lottieUrl48:"https://www.bandlab.com/web-app/common/static/mastering_spatial_48-f9c31ffdd8.json",lottieUrl144:"https://www.bandlab.com/web-app/common/static/mastering_spatial_144-4e7ca9fab2.json"},cinematicMastering:{slug:"cinematicMastering",tryUrl:"https://www.bandlab.com/web-app/common/static/cinematic-mastered-1b7cd1a6b0.m4a",tryOriginalUrl:"https://www.bandlab.com/web-app/common/static/cinematic-unmastered-5e7cfe7e0b.m4a",name:"Cinematic",shortDescription:"Intense saturation and harmonic distortion.",genres:["Soundtrack","Orchestral","Classical"],color:"#ffaf13",colorName:"yellow",isPaid:!0,lottieUrl48:"https://www.bandlab.com/web-app/common/static/mastering_cinematic_48-06fa8434f5.json",lottieUrl144:"https://www.bandlab.com/web-app/common/static/mastering_cinematic_144-e6919fa12e.json"},punchMastering:{slug:"punchMastering",tryUrl:"https://www.bandlab.com/web-app/common/static/punch-mastered-555590b454.m4a",tryOriginalUrl:"https://www.bandlab.com/web-app/common/static/punch-unmastered-4b93045d78.m4a",name:"Punch",shortDescription:"Energetic bass combined with boosted highs.",genres:["Hip Hop","Trap","R&B"],color:"#f443c2",colorName:"pink",isPaid:!0,lottieUrl48:"https://www.bandlab.com/web-app/common/static/mastering_punch_48-eed5cbdfa5.json",lottieUrl144:"https://www.bandlab.com/web-app/common/static/mastering_punch_144-1ad243020f.json"}},gu={cdMaster:"https://www.bandlab.com/web-app/common/static/cd-master-c2e81c8143.mp3",bassBoostMastering:"https://www.bandlab.com/web-app/common/static/bass-boost-d6feda1c1a.mp3",enhanceClarity:"https://www.bandlab.com/web-app/common/static/enhance-clarity-47d3b66585.mp3",tapeMaster:"https://www.bandlab.com/web-app/common/static/tape-mastered-268eafd7de.mp3",dry:"https://www.bandlab.com/web-app/common/static/original-ec8a81dad9.mp3"};function vu(){return[{imageAlt:"MiKE TUCCi",quote:'<p>As an artist centric engineer, my goal is to vibe and feel the artist\'s vision, and <span class="mastering-designer-quote-highlight">push it another 20%</span>.</p><p>My approach is to incite a reaction to make you turn up the volume, to move, to get up and dance. I\'m always trying to <span class="mastering-designer-quote-highlight">tap into</span> that kind of <span class="mastering-designer-quote-highlight">energy</span>.</p>',citation:'<cite class="mastering-designer-cite">MIKE TUCCI</cite> is a Multi-Platinum Mastering Engineer, formerly of Masterdisk NYC, currently based out of his private room in Hollywood, CA.',image:"https://www.bandlab.com/web-app/images/mastering/mike-tucci-1020fe76cb.png"},{imageAlt:"Maria Elisa Ayerbe",quote:'<p>The fact that you can <span class="mastering-designer-quote-highlight">collaborate with anyone</span> in the world is incredible.</p><p>I can see any singer/songwriter using this service. Somebody who just recorded themselves and is looking to come up with <span class="mastering-designer-quote-highlight">a really good demo</span><span class="mastering-designer-quote-highlight">this quickly does that</span>.</p>',citation:'<cite class="mastering-designer-cite">MARIA ELISA AYERBE</cite> is an audio engineer for GRAMMY and Latin Grammy nominated albums living in Miami, with more than 13 years of experience in recording, mixing, music production, and audio post production.',image:"https://www.bandlab.com/web-app/images/mastering/maria-066bafa0e4.png"},{imageAlt:"Will Quinnell",quote:'<p>My job is to make sure this idea, this song, this message, is <span class="mastering-designer-quote-highlight">best presented to the world</span>.</p><p>I listen with a technical ear and the ear of a fan. You have to use both to get the best out of a track. <span class="mastering-designer-quote-highlight">It has to sound AND feel right</span>.</p>',citation:'<cite class="mastering-designer-cite">WILL QUINNELL</cite> is a mastering engineer at <a href="https://sterling-sound.com/" target="_blank">Sterling Sound</a> with 25+ years of experience. His work with PJ Morton was nominated for the 2020 Grammys Best R&B Album, Best R&B Song, and Best R&B Performance.',image:"https://www.bandlab.com/web-app/images/mastering/will-08b4d80c18.png"}]}const bu={defaultTitle:"Import Your Track",uploadingTitle:"Mastering",dragoverTitle:"Drop",cancel:"Cancel",defaultDescription:"Select any audio or video file",uploadingDescription:"Rendering track for distribution"},yu={qrTitle:"Download Mastering QR Code",bannerTitle:"Video export for Mastering is now available on mobile!",bannerDescription:"Scan the QR code with your phone camera to access Mastering on the BandLab app."},wu="https://get-bandlab.app.link/NYCJJxfUcEb",$u="https://blog.bandlab.com/bandlab-mastering-update-video-export/",ku=Object.freeze(Object.defineProperty({__proto__:null,MASTERING_DEFAULT_PRESET:su,bannerCopy:yu,getAnalyticsNameFromSlug:mu,getDisplayNameFromSlug:pu,getEngineers:vu,getModalStateFromSlug:fu,masteringBlogLink:$u,masteringBranchLink:wu,masteringDemoUrls:gu,masteringPresetDetails:hu,masteringPresetSlugs:["cdMaster","cdMasterLight","cdMasterHeavy","bassBoostMastering","bassBoostMasteringLight","bassBoostMasteringHeavy","enhanceClarity","enhanceClarityLight","enhanceClarityHeavy","tapeMaster","tapeMasterLight","tapeMasterHeavy","naturalMastering","naturalMasteringLight","naturalMasteringHeavy","spatialMastering","spatialMasteringLight","spatialMasteringHeavy","cinematicMastering","cinematicMasteringLight","cinematicMasteringHeavy","punchMastering","punchMasteringLight","punchMasteringHeavy"],rootMasteringPresetSlugs:lu,rootSlug:cu,slugIntensity:uu,uploadZoneCopy:bu},Symbol.toStringTag,{value:"Module"}));function Su(e,t,n,o,r,i,a,s,l){function c(){const e=angular.element(document.body).injector().get("EditorState"),t=e.isRevisionLoadedFromTemplateBrowser;return e.isRevisionLoadedFromTemplateBrowser=null,t}function u(e){const t=angular.element(document.body).injector().get("EditorMidiSamples"),n=e.tracks.filter((e=>e.type===Ks&&e.regions.length>0)),o=n.length;if(0===o.length)return{};let r=0;return n.forEach((e=>{r+=e.patterns.filter((e=>{let{sampleId:n}=e;const o=t.get(n);return o&&0!==o.notes.length})).length})),r/o}function d(e){const t=e.tracks.filter((e=>e.type===Ks&&e.regions.length>0)),n=t.length;if(0===n)return{};let o=0;return t.forEach((e=>{e.patterns.forEach((t=>{e.regions.some((e=>e.sampleId===t.sampleId))&&o++}))})),o/n}function p(e){return e.effectsData?.originalPresetId&&!e.effectsData.originalPresetId.includes("-")}function m(e){return e.effectsData?.originalPresetId?.includes("-")}a.resourceUrlWhitelist(["self","https://www.bandlab.com/web-app/**"]),t.classNameFilter(/animate|creator-connect-dropdown-menu|dropdown-container|modal-overlay|top-bar-dropdown/),e.registerEventTrack((function(e){let{category:t,label:n,value:o,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};gtag("event",e,{event_category:t,event_label:n,send_to:"G-SD5MPWV79Q",value:o,...r})})),e.registerPageTrack((function(e){gtag("event","page_view",{page_location:`https://www.bandlab.com${e}`,send_to:"G-SD5MPWV79Q"})})),e.registerSetUsername((function(e){gtag("set",{user_id:e})})),e.registerEventTrack((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("firebase"===t.platform&&Promise.resolve().then((()=>fv)).then((function(n){let{logEvent:o}=n;o(e,t.params)})),t.platforms?.includes("amplitude")&&Promise.resolve().then((()=>Ap)).then((function(n){let{logEvent:o}=n;o(e,t.params)})),t.platforms?.includes("branch")&&Promise.resolve().then((()=>rv)).then((function(n){let{logEvent:o}=n;o(e,t.params)})),t.platforms?.includes("braze")&&Promise.resolve().then((()=>lv)).then((function(n){let{logCustomEvent:o}=n;o(e,t.params)})),"Register"===e&&Promise.resolve().then((()=>rb)).then((function(n){let{logSignUp:o}=n;o(e,t)})),"Create Project"===e&&Promise.resolve().then((()=>Ap)).then((function(e){let{logEvent:t}=e;t("create_project")})),"Like"===e&&"Post"===t.label&&!t.commentId){const e="post_like",n={post_creator_user_id:t.entityCreatorId,post_id:t.entityId,post_type:t.extra.post_type,post_visibility:t.extra.post_visibility,triggered_from:t.extra.triggered_from,trending_post_type:t.extra.trending_post_type};void 0===n.trending_post_type&&delete n.trending_post_type,Promise.resolve().then((()=>Ap)).then((function(t){let{logEvent:o}=t;o(e,n)})),Promise.resolve().then((()=>fv)).then((function(t){let{logEvent:o}=t;o(e,n)}))}if("Like"!==e||"Collection"!==t.label||t.commentId||Promise.resolve().then((()=>rb)).then((function(e){let{logPlaylistLike:n}=e;n(t.entityId,t.entityCreatorId,t.extra.triggered_from)})),"Create Comment"===e&&"Post"===t.category&&Promise.resolve().then((()=>rb)).then((function(e){let{logPostComment:n}=e;n(t)})),"Create Comment"===e&&"Album"===t.category&&Promise.resolve().then((()=>rb)).then((function(e){let{logAlbumComment:n}=e;n(t)})),"Follow"===e&&"User"===t.category&&Promise.resolve().then((()=>rb)).then((function(e){let{logUserFollow:n}=e;n(t.extra.following_user_id,t.extra.triggered_from)})),["Download Loop","Download Pack","Download Pack Preview","Download loop from sample editor"].includes(e)&&"Sounds"===t.category&&Promise.resolve().then((()=>Ap)).then((function(e){let{incrementProperty:t}=e;t("used sounds")})),("Import sample from Loops API"===e&&"Mix Editor"===t.category||"Download Loop"===e&&"Sounds"===t.category)&&Promise.all([Promise.resolve().then((()=>Ap)),Promise.resolve().then((()=>rv)),Promise.resolve().then((()=>lv)),Promise.resolve().then((()=>fv))]).then((function(n){let[{logEvent:o},{logEvent:r},{logCustomEvent:i},{logEvent:a}]=n;const s={"Import sample from Loops API":"blsounds_sample_add_to_mix_editor","Download Loop":"blsounds_sample_download"}[e],l={content_id:t.extra.id,content_type:t.extra.features?Object.keys(t.extra.features):null,product_origin:"Mix Editor"===t.category?"mix_editor":"blsounds",triggered_from:"Sampler"===t.extra.target?"sampler_library":"sound_library",genres:t.extra.genres??[],characters:t.extra.characters??[],instrument_id:t.extra.instrumentId??"",pack_slug:t.extra.packSlug??""};o(s,l),r(s,l),i(s,l),"Import sample from Loops API"===e&&(i("me_loops_select"),a("blsounds_action",{action:"add",category:"studio",content_type:"sample",content_id:t.extra.id,...t.extra.packSlug?{pack_slug:t.extra.packSlug}:{},is_user_content:!!t.extra.isUserUploaded,target:t.extra.importTarget,triggered_from:t.extra.triggeredFrom,gesture:t.extra.gesture}))})),"Add Sample To Favorites"!==e&&"Add Pack To Favorites"!==e||Promise.all([Promise.resolve().then((()=>Ap)),Promise.resolve().then((()=>lv)),Promise.resolve().then((()=>fv))]).then((function(e){let[{logEvent:n},{logCustomEvent:o},{logEvent:r}]=e;const i="blsounds_content_favorite",a={content_id:t.extra.id,content_type:t.extra.sampleId?t.extra.features?.loop?"loop":"one_shot":"pack",product_origin:"Mix Editor"===t.category?"mix_editor":"blsounds",triggered_from:t.extra.target??"",genres:t.extra.genres??[],characters:t.extra.characters??[],instrument_id:t.extra.instrumentId??"",pack_slug:t.extra.packSlug??""};n(i,a),o(i,a),r("blsounds_action",{action:"add",content_type:t.extra.sampleId?"sample":"pack",category:"Mix Editor"===t.category?"studio":"sounds",content_id:t.extra.id,...t.extra.packSlug?{pack_slug:t.extra.packSlug}:{},is_user_content:!1,target:"favorites",triggered_from:t.extra.triggeredFrom})})),("Load sampler kit"===e&&"Mix Editor"===t.category||"Download Pack"===e&&"Sounds"===t.category)&&Promise.all([Promise.resolve().then((()=>Ap)),Promise.resolve().then((()=>rv)),Promise.resolve().then((()=>lv))]).then((function(e){let[{logEvent:n},{logEvent:o},{logCustomEvent:r}]=e;const i={"Mix Editor":"blsounds_pack_add_to_mix_editor",Sounds:"blsounds_pack_download"}[t.category],a={content_id:t.extra.id,content_type:Object.keys(t.extra.features??{multipadSampler:!0}),product_origin:"Mix Editor"===t.category?"mix_editor":"blsounds",triggered_from:"Mix Editor"===t.category?"sampler_library":"sound_library",genres:t.extra.genres??[]};n(i,a),o(i,a),r(i,a)})),"End Saving"===e&&"Mix Editor"===t.category&&Promise.resolve().then((()=>Ap)).then((function(e){let{incrementProperty:t}=e;t("used mix editor")})),"Freeze Track"===e&&"Mix Editor"===t.category&&Promise.resolve().then((()=>fv)).then((function(e){let{logEvent:t}=e;t("me_mixer_actions",{action:"freeze_track"})})),"Unfreeze Track"===e&&"Mix Editor"===t.category&&Promise.resolve().then((()=>fv)).then((function(e){let{logEvent:t}=e;t("me_mixer_actions",{action:"unfreeze_track"})})),"Delete Track"===e&&"Mix Editor"===t.category&&Promise.resolve().then((()=>fv)).then((function(e){let{logEvent:t}=e;t("me_mixer_actions",{action:"remove_track"})})),"Duplicate Track"===e&&"Mix Editor"===t.category&&Promise.resolve().then((()=>fv)).then((function(e){let{logEvent:t}=e;t("me_mixer_actions",{action:"duplicate_track"})})),"Rename Track"===e&&"Mix Editor"===t.category&&Promise.resolve().then((()=>fv)).then((function(e){let{logEvent:t}=e;t("me_mixer_actions",{action:"rename_track"})})),"Toggle Solo"===e&&"Mix Editor"===t.category&&Promise.resolve().then((()=>fv)).then((function(e){let{logEvent:n}=e;n("me_mixer_actions",{action:"solo_"+(t.label?"on":"off")})})),"Toggle Mute"===e&&"Mix Editor"===t.category&&Promise.resolve().then((()=>fv)).then((function(e){let{logEvent:n}=e;n("me_mixer_actions",{action:"mute_"+(t.label?"on":"off")})})),"Adjust Volume"===e&&"Mix Editor"===t.category&&"Track"===t.label&&Promise.resolve().then((()=>fv)).then((function(e){let{logEvent:t}=e;t("me_mixer_actions",{action:"volume_adjust"})})),"Adjust Pan"===e&&"Mix Editor"===t.category&&"Track"===t.label&&Promise.resolve().then((()=>fv)).then((function(e){let{logEvent:t}=e;t("me_mixer_actions",{action:"pan_adjust"})})),"Select Sound Bank"===e&&Promise.resolve().then((()=>rb)).then((function(e){let{logBlsoundsInstrumentSelect:n}=e;n(t.extra.soundbank)})),"Select FX Preset"===e&&(Promise.resolve().then((()=>lv)).then((function(e){let{logCustomEvent:n}=e;n("me_fx_preset_select",t.extra)})),Promise.resolve().then((()=>fv)).then((function(e){let{logEvent:n}=e;n("me_fx_preset_select",t.extra)}))),"Add Effect"===e&&Promise.resolve().then((()=>rb)).then((function(e){let{logEffectsSelect:n}=e;n({effect:t.label})})),"Connect MIDI device"===e&&Promise.resolve().then((()=>rb)).then((function(e){let{logMeMidiDeviceConnect:n}=e;n(t.label)})),"Add Audio Input"===e&&Promise.resolve().then((()=>rb)).then((function(e){let{logStudioDeviceConnect:n}=e;n(t.label)})),"Create Revision"===e){const{autokeyUsedCount:e,song:o,revision:r,cleanedRevision:i,createdFrom:a,projectOrigin:s,triggeredFrom:l}=t.extra,f=i.tracks.filter((e=>e.autoPitch&&!e.autoPitch.bypass&&e.autoPitch.slug)),h={project_id:o.id,...o.originalSongId?{original_project_id:o.originalSongId}:{},revision_id:r.id,has_parent:!!r.parentId,is_fork:r.isFork,is_in_band_project:"Band"===o.author.type,is_published:r.isPublic,created_from:a,mastering_preset:mu(i.mastering?.preset),effects_used:i.tracks.flatMap((e=>e.effects)).filter((e=>!e.bypass)).map((function(e){return Object.keys(e.params).some((e=>["irType","cabModel","micModel","micPosition"].includes(e)))?[e.slug,e.params.irType,e.params.cabModel,e.params.micModel,e.params.micPosition].filter(Boolean).join("_"):e.slug})),bandlab_effects_presets_used:i.tracks.filter(p).map((e=>e.effectsData.originalPresetId)),num_collaborators:o.counters.collaborators,num_total_tracks:i.tracks.length,num_tracks_with_fx:i.tracks.filter((e=>e.effects.some((e=>!e.bypass)))).length,num_voice_tracks:i.tracks.filter((e=>e.type===Qs)).length,num_midi_instrument_tracks:i.tracks.filter((e=>e.soundbank)).length,num_looper_tracks:i.tracks.filter((e=>e.type===Xs)).length,num_guitar_tracks:i.tracks.filter((e=>e.type===Js)).length,num_bass_tracks:i.tracks.filter((e=>e.type===Ys)).length,num_drum_machine_tracks:i.tracks.filter((e=>e.type===Ks)).length,avg_num_patterns_used_per_track:d(i),avg_num_patterns_per_track:u(i),num_tracks_with_automation:(n=i.tracks,n.filter((e=>{const{automation:t,effects:n}=e;return t.volume.length>0||t.pan.length>0||n.some((e=>{let{automation:t={}}=e;return Object.values(t).some((e=>e.length>0))}))})).length),num_tracks_with_autopitch:i.tracks.filter((e=>e.autoPitch&&!e.autoPitch.bypass)).length,num_tracks_with_premium_vocal_effects:f.length,num_tracks_with_user_presets:i.tracks.filter(m).length,num_sampler_tracks:i.tracks.filter((e=>e.type===Zs)).length,premium_vocal_effects_used:Array.from(new Set(f.map((e=>e.autoPitch.slug)))),song_template_first_save:c()??{},triggered_from:l,...s?{traceability_project_origin:s}:{},autokey_used_count:e};Promise.resolve().then((()=>rb)).then((async function(e){let{logRevisionCreate:t}=e;const n=await async function(e){const t=e.tracks.filter((e=>e.type===Ks)).map((e=>e.id));if(0===t.length)return null;const n=angular.element(document.body).injector().get("EditorPlayer");return await n.current.getDrumMachineAnalytics(t)}(i);n&&Object.assign(h,n),t(h)}))}var n})),n.debugInfoEnabled(!1),i.errorOnUnhandledRejections(!1),s.strictMode(!1),s.caseInsensitive(!0),l.otherwise("/404"),o.interceptors.push(Mu),o.useApplyAsync(!0),r.html5Mode(!0).hashPrefix("!")}Mu.$inject=["$q","$injector","$rootScope","$timeout"],Su.$inject=["$analyticsProvider","$animateProvider","$compileProvider","$httpProvider","$locationProvider","$qProvider","$sceDelegateProvider","$urlMatcherFactoryProvider","$urlRouterProvider"];const _u=Ac((function(e){try{return JSON.parse(atob(e.split(".")[1]))}catch(e){return{}}}));async function Pu(e){const t=l.get("sessionKey"),{exp:n}=t?_u(t):{};return n<(new Date).getTime()/1e3+180&&!e.url.startsWith("https://accounts.bandlab.com")?(await window.renewSession(),_u.cache.clear(),l.get("sessionKey")):t}function Mu(e,t,n,o){return{request:async function(e){if(!/bandlab\.com|bandlab\.io|execute-api|bandlab-web|run\.app/.test(e.url)||"arraybuffer"===e.responseType||/samples\.bandlab\.com/.test(e.url))return e;const t=await Pu(e);return e.headers.Authorization=`Bearer ${t}`,e.headers["Accept-Language"]=l.get("language")||void 0,e.headers["X-Client-Id"]=e.headers["X-Client-Id"]||"BandLab-Web",e.headers["X-Client-Version"]=e.headers["X-Client-Version"]||"10.1.47",/songstarter|songstarter-test\.bandlab\.io/.test(e.url),e},response:function(e){if(angular.isObject(e.data)&&e.data.paging?.cursors.after&&0===e.data.paging.itemsCount&&gtag("event",'Received empty data with "after" cursor',{send_to:"G-SD5MPWV79Q"}),!0!==e.config.preservePagination&&angular.isObject(e.data)&&e.data.paging&&e.data.data&&(e.data=e.data.data),function(e){const t=_.get(e,"config.url","");return!!angular.isString(t)&&(!!(t.includes("https://www.bandlab.com/api/v1.3/users")||t.includes("https://www.bandlab.com/api/v1.3/bands")||t.includes("https://www.bandlab.com/api/v1.3/revisions")||t.includes("/posts")||t.includes("https://www.bandlab.com/api/v1.3/search/collaborators"))&&!!(_.get(e,"data.skills")||_.get(e,"data.genres")||_.get(e,"data.revision.genres")||angular.isArray(_.get(e,"data.data[0].skills"))||angular.isArray(_.get(e,"data.data[0].genres"))||_.get(e,"data.data")?.some((e=>e.revision&&e.revision.genres))||angular.isArray(_.get(e,"data.lookingFor.genres"))||angular.isArray(_.get(e,"data.lookingFor.skills"))))}(e)){const n=t.get("Tag");return Promise.all([n.getGenres(),n.getSkills()]).then((function(t){let[n,o]=t;const r=n.reduce((function(e,t){return e[t.id]=t,e}),{}),i=o.reduce((function(e,t){return e[t.id]=t,e}),{});return angular.isArray(_.get(e,"data.skills"))&&e.data.skills.map(s),angular.isArray(_.get(e,"data.genres"))&&e.data.genres.map(a),angular.isArray(_.get(e,"data.revision.genres"))&&e.data.revision.genres.map(a),angular.isArray(_.get(e,"data.data[0].skills"))&&e.data.data.map((function(e){(e.skills||[]).map(s)})),angular.isArray(_.get(e,"data.data"))&&e.data.data.map((function(e){(e.genres||_.get(e,"revision.genres")||[]).map(a)})),angular.isArray(_.get(e,"data.lookingFor.genres"))&&e.data.lookingFor.genres.map(a),angular.isArray(_.get(e,"data.lookingFor.skills"))&&e.data.lookingFor.skills.map(s),e;function a(e){Object.assign(e,r[e.id]||{})}function s(e){Object.assign(e,i[e.id]||{})}})).catch((function(){return e}))}return e},responseError:function(r){return[-1,500,501,502,503,504].includes(r.status)&&["GET","HEAD"].includes(r.config.method)&&(!r.config.retryNumber||r.config.retryNumber<1)?(r.config.retryNumber=r.config.retryNumber||0,r.config.retryNumber++,o((function(){return t.get("$http")(r.config)}),500*r.config.retryNumber)):(!r.config.silent&&403===r.status&&r.data&&n.$broadcast("$request:forbidden",r.data),e.reject(r))}}}const Tu=new Map,Cu=au.extend({prefixUrl:"https://cdn.contentful.com",headers:{Authorization:"Bearer 54b3aab7f3d462dd74f15e4f17f983d900dd747ebf1c5901ceca8b073339fe36"},hooks:{afterResponse:[function(e,t,n){return t.kyCache&&200===n.status&&!Tu.has(n.url)&&n.clone().arrayBuffer().then((function(t){Tu.set(e.url,new Response(t))})),n}],beforeRequest:[async function(e,t){if(t.kyCache&&Tu.has(e.url))return Tu.get(e.url)}]}});function Eu(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ob0gzt6pkpwb",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"master";return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cu).get(`spaces/${e}/environments/${t}/entries/?content_type=banner-opportunity`).json().catch((()=>import("./chunk-af444991.js")))}function Iu(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ob0gzt6pkpwb",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"master";return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cu).get(`spaces/${e}/environments/${t}/entries/?content_type=landingPageShell&sys.id=6d11aAKsOUplq2362z0ls2&include=3`).json().catch((()=>import("./chunk-e7353f01.js")))}function Ru(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ob0gzt6pkpwb",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"master";return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cu).get(`spaces/${e}/environments/${t}/entries/?content_type=landingPageShell&sys.id=4FTHaWUamCmymUCgi0PnVS&include=1`).json().catch((()=>import("./chunk-81b498cb.js")))}function Au(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ob0gzt6pkpwb",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"master";return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cu).get(`spaces/${e}/environments/${t}/entries/?content_type=landingPageShell&sys.id=1xkwKF48EzzqLxfjYfiZXV&include=2`).json().catch((()=>import("./chunk-833c0a7d.js")))}function xu(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ob0gzt6pkpwb",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"master";return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cu).get(`spaces/${e}/environments/${t}/entries/?content_type=landingPageMembership&sys.id=7vDND2HKrtUNoJWZrSrQv&include=3`).json().catch((()=>import("./chunk-b4deeb43.js")))}function Lu(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ob0gzt6pkpwb",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"master";return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cu).get(`spaces/${e}/environments/${t}/entries/?content_type=landingPageShell&sys.id=Bu47D1oQPWMKkji7ghlam&include=3`).json().catch((()=>import("./chunk-f2bb211e.js")))}function Ou(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ob0gzt6pkpwb",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"master";return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cu).get(`spaces/${e}/environments/${t}/entries/?content_type=memPaywallCampaigns&fields.isActive=true&limit=1&include=2`,{kyCache:!0}).json().catch((()=>import("./chunk-fb40eb69.js")))}const ju={getBannerOpportunities:Eu,getLandingPageDistribution:Iu,getLandingPageDownload:Ru,getLandingPageFanReach:Au,getLandingPageMembership:xu,getLandingPagePlayground:Lu,getPaywallCampaign:Ou},Du=Object.freeze(Object.defineProperty({__proto__:null,getBannerOpportunities:Eu,getLandingPageDistribution:Iu,getLandingPageDownload:Ru,getLandingPageFanReach:Au,getLandingPageMembership:xu,getLandingPagePlayground:Lu,getPaywallCampaign:Ou,requestsWithFallbackSupport:ju},Symbol.toStringTag,{value:"Module"})),Nu=new Map,Uu=au.extend({hooks:{afterResponse:[function(e,t,n){return t.$applyAsync&&angular.element(document.body).injector().get("$rootScope").$applyAsync(),t.kyCache&&200===n.status&&!Nu.has(n.url)&&n.clone().arrayBuffer().then((function(t){Nu.set(e.url,new Response(t))})),n}],beforeRequest:[async function(e,t){if(t.kyCache&&Nu.has(e.url))return Nu.get(e.url);const n=await Pu(e);e.headers.set("Authorization",`Bearer ${n}`),e.headers.set("X-Client-Id",t.useClientCookies&&s.get("X-Client-Id")||"BandLab-Web"),e.headers.set("X-Client-Version",t.useClientCookies&&s.get("X-Client-Version")||"10.1.47"),s.get("language")&&e.headers.set("Accept-Language",s.get("language"))}],beforeRetry:[function(e){let{error:t}=e;if("AbortError"===t.name)return Promise.reject(t)}]},retry:{limit:1,methods:["get"],statusCodes:[500]},timeout:!1});function Fu(e){return Ou().then((e=>{if(0===e.items?.length)throw new Error("No content found");return e})).then((async function(t){const[n]=t.items;if(n.fields.featureFlag){const o=await Promise.resolve().then((()=>Ap)).then((t=>{let{getAmplitudeFeatureFlag:o}=t;return o(e,n.fields.featureFlag)})).then((e=>"true"===e||"on"===e));t=o?t:null}return t})).catch((()=>null))}const Bu=Object.freeze(Object.defineProperty({__proto__:null,getActiveMembershipPaywallCampaignContentful:Fu,ky:Uu,kyCacheMap:Nu},Symbol.toStringTag,{value:"Module"})),Wu=function(e){return{getDirHandle:t,deleteFile:async function(e){try{const n=await t();await n.removeEntry(e)}catch(e){}},deleteFiles:async function(e){const n=await t();await Promise.all(e.map((e=>n.removeEntry(e))))},deleteAllFiles:async function(){const e=await t();for await(const t of e.values())e.removeEntry(t.name)},getAll:async function(){const e=await t(),n=[];for await(const t of e.values())n.push(await t.getFile());return n},getAllFileHandles:async function(){const e=await t(),n=[];for await(const t of e.values())n.push(t);return n},getFile:n,hasFile:async function(e){try{return await n(e,{create:!1}),!0}catch(e){return!1}},updateFile:async function(n,o){const r=await t(),i=await r.getFileHandle(n,{create:!0});if(!i.createWritable)return void await function(e,t,n){return new Promise(((o,r)=>{const i=new Worker("https://www.bandlab.com/web-app/common/workers/updateFileWorker-d682f9cca1.js");i.onmessage=function(e){e.data.success?o():r()},i.postMessage({blob:e,fileName:t,dirName:n})}))}(o,n,e);const a=await i.createWritable();await a.write(o),await a.close()}};async function t(){const t=await navigator.storage.getDirectory();return await t.getDirectoryHandle(e,{create:!0})}async function n(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{const o=await t(),r=await o.getFileHandle(e,n);return await r.getFile()}catch(e){return}}}("splitter");var Vu=/\s/,qu=/^\s+/;function zu(e){return null!=e&&"object"==typeof e}var Hu="[object Symbol]";function Gu(e){return"symbol"==typeof e||zu(e)&&oc(e)==Hu}var Ku=NaN,Yu=/^[-+]0x[0-9a-f]+$/i,Ju=/^0b[01]+$/i,Xu=/^0o[0-7]+$/i,Zu=parseInt;function Qu(e){if("number"==typeof e)return e;if(Gu(e))return Ku;if(rc(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=rc(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;var n;e=(n=e)?n.slice(0,function(e){for(var t=e.length;t--&&Vu.test(e.charAt(t)););return t}(n)+1).replace(qu,""):n;var o=Ju.test(e);return o||Xu.test(e)?Zu(e.slice(2),o?2:8):Yu.test(e)?Ku:+e}var ed=1/0,td=17976931348623157e292;function nd(e){var t=function(e){return e?(e=Qu(e))===ed||e===-ed?(e<0?-1:1)*td:e==e?e:0:0===e?e:0}(e),n=t%1;return t==t?n?t-n:t:0}var od="Expected a function";function rd(e){return function(e,t){var n;if("function"!=typeof t)throw new TypeError(od);return e=nd(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=void 0),n}}(2,e)}const id="00000000-0000-0000-0000-000000000000";function ad(){return e()+e(!0)+e(!0)+e();function e(e){const t=`${Math.random().toString(16)}000000000`.substr(2,8);return e?`-${t.substr(0,4)}-${t.substr(4,4)}`:t}}const sd={privacy_consent_title:"Your privacy preferences",privacy_consent_weusecookies:"We use cookies and other tracking technologies to improve your browsing experience on our website for the following purposes: measure your interest in our products and services and to personalize marketing interactions, deliver ads that are more relevant to you, analyze the use of the website and improve its performance, provide a better customer experience on the website, enable basic features of the website to function. To find out more or to opt-out, please read our <a href='https://blog.bandlab.com/cookies-policy/' target='_blank' rel='noopener'>Cookies Policy</a> and <a href='https://blog.bandlab.com/privacy-policy/' target='_blank' rel='noopener'>Privacy Policy</a>.",privacy_consent_youcanchange:"You can always change your privacy preferences by visiting Privacy Preferences.",privacy_consent_california:"California residents can visit Do Not Sell My Personal Information.",privacy_consent_essentialvendors_title:"Essential vendors",privacy_consent_essentialvendors_text:"Essential vendors help us make our website usable, enable basic functions and secure areas of the website. The website cannot function properly without these vendors.",privacy_consent_functionalityvendors_title:"Functionality vendors",privacy_consent_functionalityvendors_text:"Functionality vendors help us provide you with a more personalized experience on our website and to remember choices you make when you use our website.",privacy_consent_analyticsvendors_title:"Analytics vendors",privacy_consent_analyticsvendors_text:"Analytics vendors help us understand how visitors interact with our website by collecting and reporting information anonymously.",privacy_consent_marketingvendors_title:"Marketing vendors",privacy_consent_marketingvendors_text:"Marketing vendors are used to create user profiles or to track the user on this website or across several websites for marketing purposes. These vendors may also be used for advertising purposes.",privacy_consent_acceptall:"Accept All",privacy_consent_rejectall:"Reject All",privacy_consent_close:"Close",privacy_consent_aboutpreferencescenter:"On this page you can change your privacy preferences and learn more about the vendors we partner with.",privacy_consent_purposes_title:"Purposes",privacy_consent_purposes_text:"We and the vendors we partner with use your information for the following purposes:",privacy_consent_purposes_measuresyourinterest:"measure your interest in our products and services and to personalize marketing interactions",privacy_consent_purposes_deliverads:"deliver ads that are more relevant to you",privacy_consent_purposes_analysetheuse:"analyze the use of the website and improve its performance",privacy_consent_purposes_provideabettercustomerexperience:"provide a better customer experience on the website",privacy_consent_purposes_enablebasicfeatures:"enable basic features of the website to function",privacy_consent_vendors_title:"Vendors we use",privacy_consent_vendors_text:"We have grouped the vendors we use in multiple categories.",privacy_consent_moreinfo_title:"More info",privacy_consent_moreinfo_text:"To find out more or to opt-out, please read our <a href='https://blog.bandlab.com/cookies-policy/' target='_blank' rel='noopener'>Cookies Policy</a> and <a href='https://blog.bandlab.com/privacy-policy/' target='_blank' rel='noopener'>Privacy Policy</a>. For any information about the vendors we use, please contact us.",privacy_consent_donotsell_title:"Do Not Sell My Personal Information",privacy_consent_donotsell_text:"Under CCPA, sharing an advertising or device identifier to a third party may be considered a \"sale\". To find out more or to opt-out, please read our <a href='https://blog.bandlab.com/cookies-policy/' target='_blank' rel='noopener'>Cookies Policy</a> and <a href='https://blog.bandlab.com/privacy-policy/' target='_blank' rel='noopener'>Privacy Policy</a>."},ld=(e,t)=>{const n=e.__vccOpts||e;for(const[e,o]of t)n[e]=o;return n},cd={props:{modelValue:{type:Boolean,required:!0},switchId:{type:String,required:!0}},emits:["update:modelValue"],setup(e,t){let{attrs:n,emit:o}=t;const r=Gi({get:()=>e.modelValue,set(e){o("update:modelValue",e)}});return{isChecked:r,toggleSwitch:function(){n.disabled||(r.value=!r.value)}}}},ud=["id","checked"],dd=ld(cd,[["render",function(e,t,n,o,r,i){return si(),pi(ti,null,[bi("input",Ci({id:n.switchId,type:"checkbox",role:"switch",class:"visually-hidden ds-switch-input",checked:o.isChecked},e.$attrs,{onChange:t[0]||(t[0]=function(){return o.toggleSwitch&&o.toggleSwitch(...arguments)})}),null,16,ud),bi("div",{class:"ds-switch","aria-hidden":"true",onClick:t[1]||(t[1]=function(){return o.toggleSwitch&&o.toggleSwitch(...arguments)})})],64)}]]),pd=Object.freeze(Object.defineProperty({__proto__:null,default:dd},Symbol.toStringTag,{value:"Module"})),md=ld({props:{switchId:{type:String,default:()=>ad()},size:{required:!0,validator:e=>["default","compact","custom"].includes(e)}}},[["render",function(e,t,n,o,r,i){return si(),pi("div",{class:ae(["ds-switch-container","custom"===n.size?null:`ds-switch-size-${n.size}`])},[Po(e.$slots,"default",{switchId:n.switchId})],2)}]]),fd=Object.freeze(Object.defineProperty({__proto__:null,default:md},Symbol.toStringTag,{value:"Module"}));function hd(){let{accordionId:e=ad(),initiallyExpanded:t=!1,isPanelExpanded:n=Vt(t)}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const o=Gi((()=>`${e}-title`)),r=Gi((()=>`${e}-panel`)),i=Vt(null);return ao((()=>{n.value?i.value.style.height="auto":(i.value.style.height="0px",i.value.style.display="none")})),Lr(n,(function(e){e?(i.value.removeEventListener("transitionend",s),i.value.style.removeProperty("display"),i.value.style.height=`${i.value.scrollHeight}px`,i.value.classList.add("accordion-segment-panel-collapsing"),i.value.addEventListener("transitionend",a)):(i.value.removeEventListener("transitionend",a),requestAnimationFrame((()=>{i.value.style.height=`${i.value.scrollHeight}px`,requestAnimationFrame((()=>{i.value.style.height="0px"}))})),i.value.addEventListener("transitionend",s))})),{isPanelExpanded:n,panel:i,panelId:r,titleId:o,togglePanelState:function(e){e.stopPropagation(),n.value=!n.value}};function a(){i.value.style.height="auto",i.value.classList.remove("accordion-segment-panel-collapsing"),i.value.removeEventListener("transitionend",a)}function s(){i.value.style.display="none",i.value.removeEventListener("transitionend",s)}}const gd=["width","height","aria-hidden"],vd=[bi("path",{fill:"currentColor","fill-rule":"evenodd",d:"m12 16 .7.7-.7.71-7.7-7.7 1.4-1.42 6.3 6.3 6.3-6.3 1.4 1.42-7 7z","clip-rule":"evenodd"},null,-1)],bd={__name:"chevron-down",props:{size:{type:Number,required:!0}},setup:e=>(t,n)=>(si(),pi("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none","aria-hidden":t.$attrs["aria-label"]||t.$attrs["aria-labelledby"]?null:"true"},vd,8,gd))},yd=Object.freeze(Object.defineProperty({__proto__:null,default:bd},Symbol.toStringTag,{value:"Module"})),wd=["width","height","aria-hidden"],$d=[bi("path",{fill:"currentColor","fill-rule":"evenodd",d:"m12 6.59 7.7 7.7-1.4 1.42L12 9.4l-6.3 6.3-1.4-1.42z","clip-rule":"evenodd"},null,-1)],kd={__name:"chevron-up",props:{size:{type:Number,required:!0}},setup:e=>(t,n)=>(si(),pi("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none","aria-hidden":t.$attrs["aria-label"]||t.$attrs["aria-labelledby"]?null:"true"},$d,8,wd))},Sd=Object.freeze(Object.defineProperty({__proto__:null,default:kd},Symbol.toStringTag,{value:"Module"})),_d={components:{ChevronDown:bd,ChevronUp:kd},props:{titleId:{type:String,required:!0},panelId:{type:String,required:!0},isPanelExpanded:{type:Boolean,required:!0},togglePanelState:{type:Function,required:!0},buttonSize:{type:Number,default:20},isDisabled:{type:Boolean,default:!1}}},Pd=["aria-expanded","aria-controls","aria-labelledby"],Md=ld(_d,[["render",function(e,t,n,o,r,i){const a=vo("ChevronUp"),s=vo("ChevronDown");return si(),pi("button",{type:"button",class:ae(["accordion-segment-toggle-button",{disabled:n.isDisabled}]),"aria-expanded":n.isPanelExpanded,"aria-controls":n.panelId,"aria-labelledby":n.titleId,style:te(`height: ${n.buttonSize}px;`),onClick:t[0]||(t[0]=e=>n.togglePanelState(e))},[n.isPanelExpanded?(si(),mi(a,{key:0,size:n.buttonSize},null,8,["size"])):(si(),mi(s,{key:1,size:n.buttonSize},null,8,["size"]))],14,Pd)}]]),Td={components:{AccordionToggleButton:Md,Switch:dd,SwitchContainer:md},props:{modelValue:{type:Boolean,required:!0}},emits:["update:modelValue"],setup(e,t){let{emit:n}=t;return{localModelValue:Gi({get:()=>e.modelValue,set(e){n("update:modelValue",e)}}),...hd()}}},Cd=["id"],Ed=["id"],Id={class:"privacy-banner-vendor-description regular-14/20"},Rd=ld(Td,[["render",function(e,t,n,o,r,i){const a=vo("AccordionToggleButton"),s=vo("Switch"),l=vo("SwitchContainer");return si(),pi("div",null,[bi("header",{class:"cursor-pointer",style:{"align-items":"center",display:"flex",gap:"8px"},onClick:t[2]||(t[2]=t=>e.togglePanelState(t))},[yi(a,{"button-size":24,"is-panel-expanded":e.isPanelExpanded,"panel-id":e.panelId,"title-id":e.titleId,"toggle-panel-state":e.togglePanelState},null,8,["is-panel-expanded","panel-id","title-id","toggle-panel-state"]),bi("span",{id:e.titleId,class:"privacy-banner-vendor-title semibold-16/24"},[Po(e.$slots,"title")],8,Cd),yi(l,{size:"default",style:{"margin-left":"auto"},onClick:t[1]||(t[1]=ss((()=>{}),["stop"]))},{default:Tn((n=>[yi(s,Ci({modelValue:o.localModelValue,"onUpdate:modelValue":t[0]||(t[0]=e=>o.localModelValue=e),"aria-labelledby":e.titleId},n),null,16,["modelValue","aria-labelledby"])])),_:1})]),bi("div",{id:e.panelId,ref:"panel",style:{"margin-left":"32px",overflow:"hidden",transition:"all 300ms cubic-bezier(0, 0, .2, 1)"}},[bi("p",Id,[Po(e.$slots,"description")])],8,Ed)])}]]),Ad=["width","height","aria-hidden"],xd=[bi("path",{fill:"currentColor","fill-rule":"evenodd",d:"M21 12a9 9 0 0 0-9-9V1A11 11 0 1 1 1 12h2a9 9 0 1 0 18 0","clip-rule":"evenodd"},null,-1)],Ld={__name:"loading",props:{size:{type:Number,required:!0}},setup:e=>(t,n)=>(si(),pi("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none","aria-hidden":t.$attrs["aria-label"]||t.$attrs["aria-labelledby"]?null:"true"},xd,8,Ad))},Od=Object.freeze(Object.defineProperty({__proto__:null,default:Ld},Symbol.toStringTag,{value:"Module"})),jd={key:1,class:"ds-button-text"},Dd={__name:"Button",props:{as:{default:"button",type:String},size:{required:!0,validator:e=>["large","medium","small","tiny","compact"].includes(e)},color:{required:!0,validator:e=>["primary","secondary","destructive","fader","brand-red","boost","monetization","red","red-secondary","blue","blue-secondary","yellow","yellow-secondary","transparent","brand-facebook","brand-google","brand-zire"].includes(e)},padding:{default:"",validator:e=>["default","compact",""].includes(e)},isDisabled:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},loadingMessage:{type:String,default:"Loading"},isCore11:{type:Boolean,default:!1}},emits:["click"],setup(e,t){let{emit:n}=t;const o=e,r=n,i=Gi((()=>o.isDisabled||o.isLoading));function a(e){if(i.value)return e.preventDefault(),void e.stopPropagation();r("click",e)}return(e,t)=>(si(),mi(yo(o.as),{class:ae(["ds-button",[o.isCore11?["core-11-ds-button core-11-ds-button-colors",`ds-button-color-${o.color}`,`ds-button-size-${o.size}`]:[`ds-button-${o.color}`,`ds-button-${o.size}`,`ds-button-padding-${o.padding}`],{"is-loading":o.isLoading}]]),"aria-disabled":i.value||null,onClick:a},{default:Tn((()=>[e.$slots["leading-icon"]?Po(e.$slots,"leading-icon",{key:0,class:"ds-button-icon"}):_i("v-if",!0),e.$slots.default?(si(),pi("span",jd,[Po(e.$slots,"default")])):_i("v-if",!0),e.$slots.label?Po(e.$slots,"label",{key:2,class:"ds-button-text"}):_i("v-if",!0),e.$slots["trailing-icon"]?Po(e.$slots,"trailing-icon",{key:3,class:"ds-button-icon"}):_i("v-if",!0),o.isLoading?(si(),mi(Ld,{key:4,size:24,class:"ds-button-loading-icon","aria-live":"assertive","aria-label":o.loadingMessage},null,8,["aria-label"])):_i("v-if",!0)])),_:3},8,["class","aria-disabled"]))}},Nd=Object.freeze(Object.defineProperty({__proto__:null,default:Dd},Symbol.toStringTag,{value:"Module"})),Ud=["width","height","aria-hidden"],Fd=[bi("path",{fill:"currentColor",d:"m12 13.41 6.8 6.8 1.4-1.42L13.42 12l6.8-6.8-1.42-1.4-6.8 6.78-6.8-6.8L3.8 5.2l6.78 6.8-6.8 6.8 1.42 1.4z"},null,-1)],Bd={__name:"x",props:{size:{type:Number,required:!0}},setup:e=>(t,n)=>(si(),pi("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none","aria-hidden":t.$attrs["aria-label"]||t.$attrs["aria-labelledby"]?null:"true"},Fd,8,Ud))},Wd=Object.freeze(Object.defineProperty({__proto__:null,default:Bd},Symbol.toStringTag,{value:"Module"})),Vd=["aria-label"],qd={__name:"CloseButton",props:{size:{required:!0,validator:e=>["default","large","compact"].includes(e)},color:{required:!0,validator:e=>["transparent","transparent-inverted","translucent","translucent-inverted","overlay"].includes(e)},isCore11:{type:Boolean,default:!1}},setup(e){const t=e;return(e,n)=>(si(),pi("button",{type:"button",class:ae(["ds-close-button",[`ds-close-button-size-${t.size}`,`ds-close-button-color-${t.color}`,{"core-11-ds-close-button":t.isCore11}]]),"aria-label":e.$attrs["aria-label"]??"Close"},[yi(Bd,{size:20})],10,Vd))}},zd=Object.freeze(Object.defineProperty({__proto__:null,default:qd},Symbol.toStringTag,{value:"Module"}));function Hd(e){const t=Vt(!1),n=new IntersectionObserver((function(e){t.value=!e[0].isIntersecting}),{threshold:1});return Lr(e,(function(t){t?n.observe(e.value):n.disconnect()})),co((function(){n.disconnect()})),t}const Gd={components:{Button:Dd,CloseButton:qd,PrivacyBannerVendor:Rd},props:{isCCPA:{type:Boolean,default:!1},isGDPR:{type:Boolean,default:!1},locale:{type:Object,required:!0},onClose:{type:Function,required:!0},processPrivacyConsent:{type:Function,required:!0}},setup(e){const t={essential:!0,functionality:!0,analytics:!0,marketing:!0},n=Vt({...t}),o=Vt(1),r=Vt(null),i=Vt(null),a=Hd(r),s=Hd(i);return{acceptAll:function(){Object.assign(n.value,t),l()},close:l,currentView:o,settings:n,VIEW_MAIN:1,VIEW_SETTINGS:2,sentinel1:r,sentinel2:i,divider1:a,divider2:s};function l(){o.value=0,ql.privacyConsent=JSON.stringify(n.value),e.processPrivacyConsent(),e.onClose()}}},Kd={key:0,class:"privacy-banner"},Yd={class:"privacy-banner-title semibold-20/24"},Jd=["innerHTML"],Xd={ref:"sentinel1",class:"scroll-bottom-child"},Zd={class:"privacy-banner-footer"},Qd={key:1,class:"privacy-banner privacy-banner-preferences"},ep={class:"privacy-banner-title semibold-20/24"},tp={class:"regular-14/20"},np={class:"privacy-banner-title semibold-20/24"},op={class:"regular-14/20"},rp={style:{"margin-bottom":"0"}},ip={class:"privacy-banner-title semibold-20/24"},ap={class:"regular-14/20"},sp={key:0},lp={class:"privacy-banner-title semibold-20/24"},cp=["innerHTML"],up={class:"privacy-banner-title semibold-20/24"},dp=["innerHTML"],pp={ref:"sentinel2",class:"scroll-bottom-child"},mp={class:"privacy-banner-footer"},fp=ld(Gd,[["render",function(e,t,n,o,r,i){const a=vo("Button"),s=vo("CloseButton"),l=vo("PrivacyBannerVendor");return o.currentView===o.VIEW_MAIN?(si(),pi("div",Kd,[bi("div",{class:ae(["privacy-banner-body scroll-divider",[o.divider1?"scroll-divider-bottom":""]])},[bi("div",Yd,me(n.locale.privacy_consent_title),1),bi("div",{class:"regular-14/20",innerHTML:n.locale.privacy_consent_weusecookies},null,8,Jd),bi("div",Xd,null,512)],2),bi("div",Zd,[n.isGDPR?(si(),mi(a,{key:0,type:"button",size:"medium",color:"transparent",padding:"default",onClick:t[0]||(t[0]=e=>o.currentView=o.VIEW_SETTINGS)},{default:Tn((()=>[ki(me("Customize"),1)])),_:1})):_i("v-if",!0),n.isGDPR?(si(),mi(a,{key:1,type:"button",size:"medium",color:"primary",padding:"default",onClick:o.acceptAll},{default:Tn((()=>[ki(me(n.locale.privacy_consent_acceptall),1)])),_:1},8,["onClick"])):(si(),mi(a,{key:2,type:"button",size:"medium",color:"primary",padding:"default",onClick:o.acceptAll},{default:Tn((()=>[ki(me("Got It"),1)])),_:1},8,["onClick"]))]),yi(s,{class:"privacy-banner-button-close",size:"default",color:"transparent",onClick:o.close},null,8,["onClick"])])):o.currentView===o.VIEW_SETTINGS?(si(),pi("div",Qd,[bi("div",{class:ae(["privacy-banner-body row-gap-18 scroll-divider",[o.divider2?"scroll-divider-bottom":""]])},[bi("div",null,[bi("div",ep,me(n.locale.privacy_consent_title),1),bi("div",tp,me(n.locale.privacy_consent_aboutpreferencescenter),1)]),bi("div",null,[bi("div",np,me(n.locale.privacy_consent_purposes_title),1),bi("div",op,[ki(me(n.locale.privacy_consent_purposes_text)+" ",1),bi("ul",rp,[bi("li",null,me(n.locale.privacy_consent_purposes_measuresyourinterest),1),bi("li",null,me(n.locale.privacy_consent_purposes_deliverads),1),bi("li",null,me(n.locale.privacy_consent_purposes_analysetheuse),1),bi("li",null,me(n.locale.privacy_consent_purposes_provideabettercustomerexperience),1),bi("li",null,me(n.locale.privacy_consent_purposes_enablebasicfeatures),1)])])]),bi("div",null,[bi("div",ip,me(n.locale.privacy_consent_vendors_title),1),bi("div",ap,me(n.locale.privacy_consent_vendors_text),1)]),yi(l,{modelValue:o.settings.essential,"onUpdate:modelValue":t[1]||(t[1]=e=>o.settings.essential=e)},{title:Tn((()=>[ki(me(n.locale.privacy_consent_essentialvendors_title),1)])),description:Tn((()=>[ki(me(n.locale.privacy_consent_essentialvendors_text),1)])),_:1},8,["modelValue"]),yi(l,{modelValue:o.settings.functionality,"onUpdate:modelValue":t[2]||(t[2]=e=>o.settings.functionality=e)},{title:Tn((()=>[ki(me(n.locale.privacy_consent_functionalityvendors_title),1)])),description:Tn((()=>[ki(me(n.locale.privacy_consent_functionalityvendors_text),1)])),_:1},8,["modelValue"]),yi(l,{modelValue:o.settings.analytics,"onUpdate:modelValue":t[3]||(t[3]=e=>o.settings.analytics=e)},{title:Tn((()=>[ki(me(n.locale.privacy_consent_analyticsvendors_title),1)])),description:Tn((()=>[ki(me(n.locale.privacy_consent_analyticsvendors_text),1)])),_:1},8,["modelValue"]),yi(l,{modelValue:o.settings.marketing,"onUpdate:modelValue":t[4]||(t[4]=e=>o.settings.marketing=e)},{title:Tn((()=>[ki(me(n.locale.privacy_consent_marketingvendors_title),1)])),description:Tn((()=>[ki(me(n.locale.privacy_consent_marketingvendors_text),1)])),_:1},8,["modelValue"]),n.isCCPA?(si(),pi("div",sp,[bi("div",lp,me(n.locale.privacy_consent_donotsell_title),1),bi("div",{class:"regular-14/20",innerHTML:n.locale.privacy_consent_donotsell_text},null,8,cp)])):_i("v-if",!0),bi("div",null,[bi("div",up,me(n.locale.privacy_consent_moreinfo_title),1),bi("div",{class:"regular-14/20",innerHTML:n.locale.privacy_consent_moreinfo_text},null,8,dp)]),bi("div",pp,null,512)],2),bi("div",mp,[yi(a,{type:"button",size:"medium",color:"transparent",padding:"default",onClick:o.close},{default:Tn((()=>[ki(me(n.locale.privacy_consent_close),1)])),_:1},8,["onClick"]),yi(a,{type:"button",size:"medium",color:"primary",padding:"default",onClick:o.acceptAll},{default:Tn((()=>[ki(me(n.locale.privacy_consent_acceptall),1)])),_:1},8,["onClick"])]),yi(s,{class:"privacy-banner-button-close",size:"default",color:"transparent",onClick:o.close},null,8,["onClick"])])):_i("v-if",!0)}]]),hp=new Map,gp=new Map;window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},window.twq=function(){};const vp=["allowAmplitude","allowBranch","allowBraze","allowFacebook","allowGoogleAnalytics","allowOutbrain","allowSentry","allowTikTok","allowTwitter","close"].map((function(e){const t=new AbortController,n=new Promise((function(e){t.signal.addEventListener("abort",e)}));return hp.set(e,n),gp.set(e,(function(){return t.abort()})),n}));function bp(){const e=JSON.parse(ql.privacyConsent);for(const[t,n]of Object.entries(e))if(n)switch(t){case"functionality":gp.get("allowBraze")();break;case"analytics":gp.get("allowAmplitude")(),gp.get("allowGoogleAnalytics")(),gp.get("allowSentry")();break;case"marketing":gp.get("allowBranch")(),gp.get("allowFacebook")(),gp.get("allowOutbrain")(),gp.get("allowTikTok")(),gp.get("allowTwitter")()}}const yp=Object.freeze(Object.defineProperty({__proto__:null,consentMethods:gp,consentPromises:hp,setupPrivacyConsent:async function(e){if(async function(){var e,t,n,o,r,i;await hp.get("allowFacebook"),e=window,t=document,n="script",e.fbq||(o=e.fbq=function(){o.callMethod?o.callMethod.apply(o,arguments):o.queue.push(arguments)},e._fbq||(e._fbq=o),o.push=o,o.loaded=!0,o.version="2.0",o.queue=[],(r=t.createElement(n)).async=!0,r.src="https://connect.facebook.net/en_US/fbevents.js",(i=t.getElementsByTagName(n)[0]).parentNode.insertBefore(r,i)),fbq("init","934134190043053"),fbq("track","PageView")}(),async function(){await hp.get("allowTikTok"),function(e,t,n){e.TiktokAnalyticsObject=n;var o=e[n]=e[n]||[];o.methods=["page","track","identify","instances","debug","on","off","once","ready","alias","group","enableCookie","disableCookie"],o.setAndDefer=function(e,t){e[t]=function(){e.push([t].concat(Array.prototype.slice.call(arguments,0)))}};for(var r=0;r<o.methods.length;r++)o.setAndDefer(o,o.methods[r]);o.instance=function(e){for(var t=o._i[e]||[],n=0;n<o.methods.length;n++)o.setAndDefer(t,o.methods[n]);return t},o.load=function(e,t){var r="https://analytics.tiktok.com/i18n/pixel/events.js";o._i=o._i||{},o._i[e]=[],o._i[e]._u=r,o._t=o._t||{},o._t[e]=+new Date,o._o=o._o||{},o._o[e]=t||{};var i=document.createElement("script");i.type="text/javascript",i.async=!0,i.src=r+"?sdkid="+e+"&lib="+n;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(i,a)},o.load("C5HQQ8FGE0M3SF4JC1K0"),o.page()}(window,document,"ttq")}(),async function(){await hp.get("allowOutbrain"),function(e,t){var n="000980d81c55fee14cffd2e7f56b93d52c";if(e.obApi){var o=function(e){return"[object Array]"===Object.prototype.toString.call(e)?e:[e]};e.obApi.marketerId=o(e.obApi.marketerId).concat(o(n))}else{var r=e.obApi=function(){r.dispatch?r.dispatch.apply(r,arguments):r.queue.push(arguments)};r.version="1.1",r.loaded=!0,r.marketerId=n,r.queue=[];var i=t.createElement("script");i.async=!0,i.src="//amplify.outbrain.com/cp/obtp.js",i.type="text/javascript";var a=t.getElementsByTagName("script")[0];a.parentNode.insertBefore(i,a)}}(window,document),obApi("track","PAGE_VIEW",{content:{id:"XXXXX"},contentType:"product"})}(),async function(){var e,t,n,o,r,i;await hp.get("allowTwitter"),e=window,t=document,n="script",e.twq||(o=e.twq=function(){o.exe?o.exe.apply(o,arguments):o.queue.push(arguments)},o.version="1.1",o.queue=[],(r=t.createElement(n)).async=!0,r.src="https://static.ads-twitter.com/uwt.js",(i=t.getElementsByTagName(n)[0]).parentNode.insertBefore(r,i)),twq("config","oasnr")}(),async function(){await hp.get("allowGoogleAnalytics"),xc("https://www.googletagmanager.com/gtag/js?id=G-SD5MPWV79Q"),gtag("js",new Date),gtag("config","G-SD5MPWV79Q",{send_page_view:!1,user_id:window.fromAPI&&window.fromAPI.me&&window.fromAPI.me.id,viewport_dimensions:`${window.innerWidth}x${window.innerHeight}`}),gtag("consent","default",{ad_personalization:"granted",ad_user_data:"granted"}),gtag("config","AW-876226372")}(),ql.privacyConsent)return void bp();const t=await fetch("https://geo.bandlab.io/v2/ip/"),{countryCode:n}=await t.json(),o=new Set(["AT","BE","BG","HR","CY","CZ","DK","EE","FI","FR","DE","GR","HU","IS","IE","IT","LV","LI","LT","LU","MT","NL","NO","PL","PT","RO","SK","SI","ES","SE"]),r=new Set(["US"]),i=o.has(n),a=r.has(n);if((!i||u()||p())&&(ql.privacyConsent=JSON.stringify({essential:!0,functionality:!0,analytics:!0,marketing:!0}),bp()),u()||p())return;const s=function(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=ps({provide:arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},render:()=>Ki(fp,t)});return n.mount(e),n}(e,{},{isCCPA:a,isGDPR:i,locale:sd,onClose:gp.get("close"),processPrivacyConsent:bp});return Promise.allSettled(vp).finally((function(){s.unmount()}))}},Symbol.toStringTag,{value:"Module"})),wp=rd((async function(){await hp.get("allowAmplitude");const{default:e}=await import("./chunk-4a8724a2.js"),t=e.getInstance();return t.init("bc41569992447fd368ea77b0748c966b",void 0,{apiEndpoint:"amplitude.bandlab.com"}),t.setVersionName("BandLab-Web 10.1.47"),t}));async function $p(e,t,n){d()&&(await wp()).logEvent(e,t,n)}async function kp(e,t){const n=await wp(),o=(new n.Identify).set(e,t);n.identify(o)}async function Sp(e){const t=await wp(),n=(new t.Identify).add(e,1);t.identify(n)}function _p(e,t){switch(!0){case t&&!!t[0].closest(".global-player-queue"):return"playback_queue";case t&&!!t[0].closest(".global-player"):return"global_player";case e.includes("explore.home")&&t&&!!t[0].closest(".explore-section-geolocated-tracks"):return"explore_trending_hits";case e.includes("explore.home")&&t&&!!t[0].closest(".explore-section-geolocated-artists"):return"explore_trending_artists";case e.includes("explore.home")&&t&&!!t[0].closest(".explore-featured-artists"):return"explore_featured_artists";case e.includes("explore.home")&&t&&!!t[0].closest(".explore-section-trending-tracks"):return"explore_featured_tracks";case e.includes("explore.home")&&t&&!!t[0].closest(".explore-section-featured-albums"):return"explore_featured_albums";case e.includes("explore.home")&&t&&!!t[0].closest(".explore-section-recent-albums"):return"explore_recent_releases";case e.includes("explore.home")&&t&&!!t[0].closest(".explore-section-collections"):return"explore_featured_playlists";case e.includes("explore.channel")&&t&&!!t[0].closest(".explore-section-featured-albums"):return"explore_channel_featured_albums";case e.includes("explore.channel")&&t&&!!t[0].closest(".explore-section-recent-albums"):return"explore_channel_recent_releases";case e.includes("explore.channel")&&t&&!!t[0].closest(".explore-section-collections"):return"explore_channel_featured_playlists";case e.includes("explore.channel")&&t&&!!t[0].closest(".explore-channel-playlist"):return"explore_channel_header_playlist";case e.includes("explore.home")&&t&&!!t[0].closest(".explore-popular-in-all"):return"explore_popular_in_all_genres";case e.includes("explore.home")&&t&&!!t[0].closest(".explore-popular-in-hip-hop"):return"explore_popular_in_hip_hop";case e.includes("explore.home")&&t&&!!t[0].closest(".explore-popular-in-rock"):return"explore_popular_in_rock";case e.includes("explore.home")&&t&&!!t[0].closest(".explore-popular-in-pop"):return"explore_popular_in_pop";case e.includes("explore.home")&&t&&!!t[0].closest(".explore-popular-in-r-n-b"):return"explore_popular_in_rnb";case e.includes("explore.home")&&t&&!!t[0].closest(".explore-popular-in-electronic"):return"explore_popular_in_electronic";case e.includes("collection")&&("explore_popular_in_all_genres"===e.params?.triggeredFrom||"explore_popular_in_hip_hop"===e.params?.triggeredFrom||"explore_popular_in_rock"===e.params?.triggeredFrom||"explore_popular_in_pop"===e.params?.triggeredFrom||"explore_popular_in_rnb"===e.params?.triggeredFrom||"explore_popular_in_electronic"===e.params?.triggeredFrom):return e.params?.triggeredFrom;case e.includes("collection")&&"explore_tracks_chart"===e.params?.triggeredFrom:return"explore_tracks_chart";case e.includes("playbackhistory"):return"playback_history";case e.includes("contest"):return"contest";case e.includes("explore.channel"):return"explore_channels";case e.includes("explore.genre"):return`explore_channel_${e.params.sort??"recent"}`;case e.includes("explore"):return"explore";case e.includes("feed.following"):return"following";case e.includes("feed.forYou"):return"for_you";case e.includes("feed.trending"):return"trending";case e.includes("band"):return"band";case e.includes("collection"):return"playlist_page";case e.includes("community"):return"community";case e.includes("user")&&t&&!!t[0].closest(".top-popular-tracks"):return"profile_top_tracks";case e.includes("user")&&t&&!!t[0].closest(".user-achievement-cell-featured-track"):return"profile_label_featured_track";case e.includes("user")&&t&&!!t[0].closest(".user-fan-also-like"):return"fan_also_like_section";case e.includes("user"):return"user_profile";case e.includes("post")&&"feed_video_carousel"===e.params?.from:return"feed_video_carousel";case e.includes("post"):case e.includes("track"):return"post_page";case e.includes("library"):return"user_library";case e.includes("search.results")&&"explore_channel_hashtag"===e.params?.triggeredFrom:return"explore_channel_hashtag";case e.includes("search.results"):return"search";case e.includes("mixEditor"):return"studio";default:return"other"}}const Pp=Ac((async function(e){if(!ql.privacyConsent||!JSON.parse(ql.privacyConsent).analytics)return Promise.reject(new Error("USER_DID_NOT_CONSENT"));const t={serverUrl:"https://amplitude-experiment.bandlab.com"},[{Experiment:n}]=await Promise.all([await import("./chunk-8effbeb6.js"),wp()]),o=e===id?n.initialize("client-ZzWoQ3u5pnFbLX4YLDErXdoAXvWVqZc2",t):n.initializeWithAmplitudeAnalytics("client-ZzWoQ3u5pnFbLX4YLDErXdoAXvWVqZc2",t),r={user_id:e};return await o.fetch(r),o}));async function Mp(e,t){try{return(await Pp(e.id)).variant(t).value}catch(e){return void e.message}}const Tp=Mt({}),Cp=Vt(null);async function Ep(e){try{const t=await Pp(e.id);Cp.value=t}catch(e){const t=e;return Cp.value=null,void t.message}}function Ip(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>"true"===e;return Gi((()=>!angular.isUndefined(Cp.value)&&null!==Cp.value&&(void 0!==Tp[e]?t(Tp[e]):t(Cp.value.variant(e).value))))}async function Rp(e,t){try{return(await Pp(e.id)).variant(t)}catch(e){return e.message,{}}}const Ap=Object.freeze(Object.defineProperty({__proto__:null,clearUserProperties:async function(){const e=await wp();e.clearUserProperties(),e.setUserId(null),e.regenerateDeviceId()},getAmplitudeFeatureFlag:Mp,getAmplitudeFeatureVariant:Rp,getOrigin:_p,incrementProperty:Sp,logEvent:$p,preloadAmplitudeExperiment:Ep,setUserProperties:async function(e){const t=await wp(),n=l.get("amplitudeSessionId");n&&t.setSessionId(+n),t.setUserId(e.id);const o=(new t.Identify).set("confirmed_email",e.ftue.confirmedEmail).set("num of followers",e.counters.followers).set("num of following",e.counters.following).set("is tippable",e.isTippable).set("skills",e.skills.map((e=>e.id))).set("genres",e.genres.map((e=>e.id)));return new Promise((function(e,n){t.identify(o,e,n),setTimeout(n,5e3)}))},setUserProperty:kp,useAmplitudeFlag:Ip},Symbol.toStringTag,{value:"Module"}));function xp(e){var t=this.__data__=new Cc(e);this.size=t.size}function Lp(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Rc;++t<n;)this.add(e[t])}function Op(e,t){for(var n=-1,o=null==e?0:e.length;++n<o;)if(t(e[n],n,e))return!0;return!1}function jp(e,t){return e.has(t)}angular.module("bandlab.account").factory("authService",["$analytics","$cookies","$http","$q","$rootScope","$state","$transitions","$window","AppNotifications","ChatNotifications","Identity","Me","Modal","Page",function(e,t,n,o,r,i,a,s,u,p,m,f,h,g){var v,b,y,w=o.resolve();try{v=JSON.parse(ql.afterAuthState)}catch(e){v=null}return r.$on("$request:forbidden",(function(e,t){f.isAnonymous()||(203!==t.errorCode?function(e,t,n){switch(e){case 201:$(n);break;case 202:u.addNotification({title:t||"Your account has been suspended",content:'<a href="https://help.bandlab.com/hc/en-us/articles/360026519473" target="_blank" rel="noopener">Learn More</a>',classList:"alert"});break;case 205:u.addNotification({content:t,classList:"alert",autoclose:1e4});break;case 207:u.addNotification({content:"Unblock this user to view his/her profile.",classList:"alert",autoclose:1e4})}}(t.errorCode,t.message,t.action):i.go("404"))})),window.renewSession=T,{displayAuthModal:function(){let{title:e,description:t,onCancel:n,redirectState:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(y=new h({id:"authModal",class:"light",templateUrl:"https://www.bandlab.com/web-app/account/signUp/partials/_sign-up-modal-c9282255.html",contentScope:{title:e,description:t,redirectState:o},onCancel:n})).show()},displayConfirmationEmailError:$,getNewAccessToken:M,getUser:S,identifyUserForTrackers:P,initSession:function(e){return k(new m(e)).then((e=>(P(e),p.start(),g.update(),e)))},logout:C,logoutAccounts:async function(){try{await Uu.post("https://accounts.bandlab.com/oauth/logout?client_id=bandlab_web")}catch(e){}return C()},redirectAfterAuth:function(){f.isOnboarded?v?(i.go(v.toState,v.toParams,{location:"replace"}),v=null,delete ql.afterAuthState):(i.go(Oc,{username:f.username},{location:"replace"}),a.onSuccess({from:"onboarding"},(function(){Mp(f,"on_signup_paywall").then((e=>"true"===e||"on"===e)).then((e=>{e&&new h({id:"paywallModal",templateUrl:"https://www.bandlab.com/web-app/membership/partials/_paywall-modal-ee6789e7.html",contentScope:{useCheckoutModal:!0,productAttribution:"on_signup_paywall",productAttributionGroup:"misc"}}).show()}))}))):E(),y&&y.destroy()},redirectAfterSignUp:E,refreshFtue:function(){return m.ftue().$promise.then((function(e){return f.ftue=e,f}))},refreshMe:function(){return S().catch(_)},renewSession:T,setAfterAuthState:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{toState:i.current.name,toParams:i.params};Dc.has(e.toState)?(v=null,delete ql.afterAuthState):(v={toState:e.toState,toParams:{...e.toParams}},ql.afterAuthState=JSON.stringify(e))},setMe:k,signUp:function(n){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const r={...o?{"x-captcha-response":o}:{}};return n.client_id="bandlab_web",n.scope="openid profile email linked_accounts offline_access",t.get("invitationKey")&&(n.accessKey=t.get("invitationKey")),b=!0,w=Uu.post("https://accounts.bandlab.com/oauth/users",{headers:r,json:n}).json().then((function(t){return e.eventTrack("API_Auth_finished",{platform:"firebase",params:{is_signup:!0,method:n.provider,success:!0}}),t})).catch((function(t){return e.eventTrack("API_Auth_finished",{platform:"firebase",params:{is_signup:!0,method:n.provider,success:!1}}),Promise.reject(t)})).then(c).then(S).then((function(t){return e.eventTrack("initial_profile_load_finished",{platform:"firebase",params:{is_signup:!0,method:n.provider,success:!0}}),t})).catch((function(t){return e.eventTrack("initial_profile_load_finished",{platform:"firebase",params:{is_signup:!0,method:n.provider,success:!1}}),Promise.reject(t)})).then((function(e){return P(e)})).then((function(n){return p.start(),e.eventTrack("Register",{category:"Authentication",label:"Password"}),t.remove("invitationKey"),n})).finally((function(){b=!1}))},solveCaptcha:function(){return new Promise((function(e,t){const o=new h({overlayClose:!1,template:'<div class="modal-content-small"><div class="modal-close" ng-click="cancel()"></div><div class="modal-content recaptcha"></div><div>',onCancel:()=>t(new Error("Cancel")),onCreate:function(r){xc("https://www.recaptcha.net/recaptcha/api.js?render=explicit").then((function(){return new Promise((e=>grecaptcha.ready(e)))})).then((function(){return new Promise((function(e){grecaptcha.render(r[0].querySelector(".recaptcha"),{sitekey:"6LeulbUUAAAAAPyBTaqWfZcxwuwG1u9tw37__Ahn",callback:e})}))})).then((function(r){n.post("https://www.bandlab.com/api/v1.3/recaptcha/verify",{"g-recaptcha-response":r}).then(e).catch(t).finally((()=>o.destroy()))}))}});o.show()}))}};function $(e){const t={bandInvite:"Requests to join are locked",comment:"Comments are disabled",communityInvite:"Requests to join are locked",invite:"Requests to join are locked",projectInvite:"Requests to join are locked",stream:"Streaming is disabled",talkTo:"Chat is disabled"}[e];u.addNotification({id:"confirmationEmailError",title:t||"This feature is locked",content:"Confirm your email to access all features.",image:"https://www.bandlab.com/web-app/images/settings/warning-54e511afc4.svg",action:`\n          <a class="button-scd button-height-32 button-padding-16 button-rounded" href="${i.href("settings.account")}"><i class="icon-arrow-right"></i></a>\n        `,classList:"light"})}function k(e){return o((function(t){Object.assign(f,e),f.isOnboarded=f.ftue.createdBand||f.ftue.createdSong||f.ftue.setCustomUsername||f.ftue.setGenres||f.ftue.setSkills,f.isOnboarded&&=!!f.email,t(f)}))}function S(){return Promise.all([m.info().$promise,m.ftue().$promise]).then((function(e){let[t,n]=e;return t.ftue=n,t})).then(k).then((function(e){return g.update(),e}))}function _(e){return e.status?Promise.resolve().then((()=>rb)).then((function(t){let{logRefreshTokenFailed:n}=t;return n(e)})):Promise.resolve().then((()=>rb)).then((function(e){let{logForceSignOut:t}=e;return t()})),C()}function P(t){return Sentry.onLoad((function(){Sentry.configureScope((e=>{e.setTag("touch",matchMedia("(any-hover: none)").matches),e.setUser({id:t.id,username:t.username})}))})),e.setUsername(t.id),Ep(f),Promise.all([Promise.resolve().then((()=>rb)).then((function(e){let{logDailyOpen:t}=e;return t()})),Promise.resolve().then((()=>fv)).then((function(e){let{setUserProperties:n}=e;return n(t)})),Promise.resolve().then((()=>Ap)).then((function(e){let{setUserProperties:n}=e;return n(t)})),Promise.resolve().then((()=>lv)).then((function(e){let{startSession:n}=e;return n(t)})),Promise.resolve().then((()=>rv)).then((function(e){let{setIdentity:n}=e;return n(t)}))]).then((function(){return t})).catch((function(e){return t}))}function M(e){const t=new URLSearchParams;return t.append("client_id","bandlab_web"),t.append("redirect_uri","https://www.bandlab.com/auth/bandlab/callback"),t.append("auth_type","bandlab_auth_code"),e?(t.append("grant_type","authorization_code"),t.append("code",e)):(t.append("grant_type","refresh_token"),t.append("refresh_token",l.get("refreshToken"))),Uu.post("https://accounts.bandlab.com/oauth/connect/token?auth_type=bandlab_auth_code",{body:t}).json()}function T(){return b?w:d()?(b=!0,w=M().then(c).then(S).then((function(e){return P(e),p.start(),e})).catch(_).finally((function(){b=!1}))):o.reject()}async function C(){const e=ql.getItem("accountDeleted"),t=ql.getItem("redirectAfterLogout")??"";await async function(){l.remove("refreshToken"),l.remove("sessionKey"),l.remove("joinCode"),l.remove("request_2fa"),l.remove("request_2fa_timestamp"),ql.clear(),"indexedDB"in window&&indexedDB.deleteDatabase(ul),"FileSystemHandle"in window&&async function(){Wu.deleteAllFiles()}(),await Promise.resolve().then((()=>Ap)).then((function(e){let{clearUserProperties:t}=e;return t()}))}(),e&&ql.setItem("accountDeleted",!0),s.location.href=`${document.baseURI}${t}`}function E(){v?.toUrl&&(window.location.href=v.toUrl);const e=["mastering","sounds","mixEditor","songStarter","splitter"].includes(v?.toState)?v.toState:jc;i.go(e,{...v?.toParams??{}},{location:"replace",reload:!0}),y&&y.destroy()}}]),angular.module("bandlab.user",[]).directive("collaborationBadge",["$injector",function(e){return{scope:{as:"@"},link:function(t,n){const o=import("./chunk-f54fd161.js").then((function(o){let{mountCollaborationBadge:r}=o;return r(n[0],{$injector:e,scope:t})}));t.$on("$destroy",(async function(){(await o).unmount()}))}}}]).directive("userProfileHeader",["$injector",function(e){return{scope:{user:"="},link:function(t,n){const o=import("./chunk-514c9f4d.js").then((function(o){let{mountUserProfileHeader:r}=o;return r(n[0],{$injector:e,scope:t})}));t.$on("$destroy",(async function(){(await o).unmount()}))}}}]).directive("userAchievements",["$injector",function(e){return{scope:{user:"<"},link:function(t,n){const o=import("./chunk-a3b951ee.js").then((function(o){let{mountUserAchievements:r}=o;return r(n[0],{$injector:e,scope:t},{user:t.user})}));t.$on("$destroy",(async function(){(await o).unmount()}))}}}]),angular.module("bandlab.user").factory("completeProfile",["$analytics","$http","$q","$rootScope","authService","Identity","Me","Modal","Tag","User",function(e,t,n,o,r,i,a,s,l,c){var u,d,p,m={current:1,total:5};return{start:function(){return Array.from({length:3},(function(e,t){const n=t+1;var o=new Image;return o.src=`https://static.bandlab.com/image/misc-web-original/bg-complete-profile-${n}/bg-complete-profile-${n}.jpg`,o})),d=o.$on("$user:changed",(function(e,t){let{action:n,data:o}=t;p[0].pictureId=o.pictureId,"updateProfilePicture"!==n&&c.get({id:a.id}).$promise.then((function(){a.picture.isDefault=!1}))})),n.all([l.getSkills(),l.getGenres(),t.get(`https://www.bandlab.com/api/v1.3/users/${a.id}/goals`).then((e=>e.data.goals||[])).catch((()=>[])),c.getProfilePictures({userId:a.id}),Mp(a,"onboarding-mandatory-inspired-by")]).then((function(o){let[l,c,d,f,h]=o;return p=f,c=_.map(c,(function(e){return e.isSelected=_.some(a.genres,{id:e.id}),e})),l=_.map(l,(function(e){return e.isSelected=_.some(a.skills,{id:e.id}),e})),d={selectedGoal:d[0]},function(o){let{genres:l,skills:c,goals:d,isInspiredByMandatory:f}=o;var h,g=n.defer();return(u=new s({id:"completeProfileModal",templateUrl:"https://www.bandlab.com/web-app/account/partials/_complete-profile-9ff69bf3.html",overlayClose:!1,contentScope:{isInspiredByMandatory:"true"===f,steps:m,me:a,genres:l,skills:c,goals:d,profilePictures:p,user:{inspiredBy:a.inspiredBy,username:a.username,email:a.email},submitProfile:function(){const n=d.selectedGoal?{Create:"Artist",Connect:"Social Musician",Listen:"#1 Fan"}[d.selectedGoal]:"None";e.eventTrack(n,{category:"Onboarding"}),d.selectedGoal||(d.selectedGoal="Listen"),localStorage.setItem("ftueCards",["feature1","feature2","blog"]),new i({genres:_.filter(l,{isSelected:!0}),skills:_.filter(c,{isSelected:!0}),inspiredBy:a.inspiredBy,username:a.username,email:a.email}).$update().then((function(e){return r.setMe({...e,goals:[d.selectedGoal]}),function(e){return t.put(`https://www.bandlab.com/api/v1.3/users/${a.id}/goals`,{goals:e}).catch((()=>[]))}([d.selectedGoal])})).then((function(){Promise.resolve().then((()=>rb)).then((function(e){let{logMainOnboardingComplete:t,logInspiredByArtistAdd:n}=e;t(),a.inspiredBy.length>0&&(i.setInspiredBy(),n(a.inspiredBy,"onboarding"))})),g.resolve()}))},nextStep:function(){h.classList.add("step-"+ ++m.current),h.scrollTop=0,5===m.current&&Promise.resolve().then((()=>rb)).then((function(e){let{logInspiredByOpen:t}=e;t("onboarding")}))},clickPictureUpload:function(){document.querySelectorAll(".picture-upload-drop-placeholder")[0].click()}},onCreate:function(e){h=e[0]}})).show(),g.promise}({skills:l,genres:c,goals:d,isInspiredByMandatory:h})}))},stop:function(){u.destroy(),d()}}}]),angular.module("bandlab.account").factory("Grants",["$resource",function(e){var t="https://accounts.bandlab.com/oauth";return e(t,{},{get:{method:"GET",url:`${t}/grants`},revoke:{method:"DELETE",params:{clientId:"@clientId"},url:`${t}/grants/:clientId`}})}]),angular.module("bandlab.account").factory("Identity",["$resource",function(e){var t="https://www.bandlab.com/api/v1.3/";return e(t,{},{info:{cache:!1,method:"GET",url:`${t}me`},ftue:{cache:!1,method:"GET",url:`${t}me/ftue`},counters:{cache:!1,method:"GET",params:{id:"@id"},url:`${t}users/:id/counters`},resendEmailConfirmation:{method:"POST",url:`${t}emails/confirmations`},setUsedStudio:{method:"POST",url:`${t}me/ftue/used-studio`},setInspiredBy:{method:"POST",url:`${t}me/ftue/set-inspired-by`},update:{method:"PATCH",url:`${t}me`,transformRequest:[function(e){return _.get(e,"place.name")&&!_.get(e,"place.id")&&delete(e=angular.copy(e)).place,e},angular.toJson]},delete:{method:"DELETE",url:`${t}me`,params:{force:"@force"}},getWarning:{method:"GET",url:"https://www.bandlab.com/api/v1.3/users/:id/warnings"}})}]),angular.module("bandlab.account").factory("Login",["$resource",function(e){var t="https://www.bandlab.com/api/v1.3/logins";return e(t,{},{delete:{method:"DELETE",params:{provider:"@provider"},url:`${t}/:provider`}})}]),angular.module("bandlab.account").factory("Me",(function(){return{isAnonymous:function(){return angular.isUndefined(this.username)},isUser:function(){return angular.isDefined(this.username)}}})),angular.module("bandlab.account").factory("Password",["$resource",function(e){var t="https://www.bandlab.com/api/v1.3/passwords";return e(t,{},{reset:{method:"POST",url:`${t}/reset`},update:{method:"PUT"}})}]),angular.module("bandlab.account").factory("Settings",["$resource","Me",function(e,t){return e("https://www.bandlab.com/api/v1.3/settings",{},{getPrivacySettings:{method:"GET",url:`https://www.bandlab.com/api/v1.3/users/${t.id}/settings/privacy/:service`},savePrivacySettings:{method:"PUT",params:{service:"@service"},url:`https://www.bandlab.com/api/v1.3/users/${t.id}/settings/privacy/:service`}})}]),angular.module("bandlab.account.settings",["bandlab.account"]),angular.module("bandlab.account.settings").controller("AccountDeleteCtrl",["$analytics","$scope","$state","Identity","Modal",function(e,t,n,o,r){t.deactivateAccount=function(i,a){return o.delete({force:a}).$promise.then((function(){e.eventTrack(`Reason: ${t.reason}`,{category:"Delete account",label:t.details}),p()?location.href="_#bl_closeWebView":(localStorage.setItem("accountDeleted",!0),n.go("logoutSuccess"))})).catch((function(e){i.$submitted=!1;const n=new r({templateUrl:"https://www.bandlab.com/web-app/account/settings/partials/_account-delete-confirm-a48c5363.html",contentScope:{forceDeactivateAccount:()=>t.deactivateAccount(i,!0)}});403===e.status&&n.show()}))}}]),angular.module("bandlab.account.settings").controller("AccountEditCtrl",["$location","$scope","$state","$timeout","AppNotifications","authService","ConfirmModal","Identity","Me","Modal",function(e,t,n,o,r,i,a,s,l,c){t.changeSuccess={username:!1,email:!1},t.changeError={username:!1,email:!1},t.hasEmail=!!l.email,t.user=new s,t.user.username=l.username,t.user.email=l.email,t.user.phone=l.phone,t.editMe=function(e,o){t.changeError[e]=!1,t.user.$update().then((function(e){i.setMe(e).then((function(){i.identifyUserForTrackers(e)})),t.hasEmail=!!e.email,r.addNotification({title:"Profile updated",action:`<a class="button-scd button-height-32 button-padding-16 button-rounded" href="${n.href("user.feed",{username:e.username})}"><i class="icon-arrow-right"></i></a>`,classList:"success",autoclose:8e3}),o.$setPristine()})).catch((function(){t.changeError[e]=!0,o.$setPristine()}))},t.setupEmail=function(){const e=new c({id:"setupEmail",templateUrl:"https://www.bandlab.com/web-app/account/settings/partials/_setup-email-form-93a2f664.html"});e.show();const n=t.$on("$account:emailSetup",(function(o,r){t.user.email=r.email,t.hasEmail=!0,e.destroy(),n()}))},t.removePhone=function(){return t.hasEmail?new a({confirmLabel:"Remove",contentScope:{title:"Remove phone number?",message:"<p>You will not be able to log in using this phone number.</p>"},onConfirm:function(){s.update({phone:""}).$promise.then((function(e){i.setMe(e),t.user.phone=l.phone})).catch((function(){t.changeError=!0}))}}).show():new c({templateUrl:"https://www.bandlab.com/web-app/account/settings/partials/_add-email-first-90cbfc7c.html",escapeClose:!0,onConfirm:function(){t.setupEmail()}}).show()},o((()=>{const t=e.hash();t&&document.getElementById(t).scrollIntoView({behavior:"smooth",inline:"center"})}))}]),angular.module("bandlab.account.settings").controller("AppsPermissionsCtrl",["$scope","ConfirmModal","Grants",function(e,t,n){function o(){n.get().$promise.then((t=>{let{grants:n}=t;e.apps=n.filter((e=>"bandlab"!==e.clientId))}))}e.revokeConfirm=function(r){new t({confirmLabel:"Remove",contentScope:{title:"Remove access?",message:`<p><strong>${r.clientName}</strong>? will not be able to access your BandLab account unless you grant permissions.</p>`},onConfirm:()=>function(t){let{clientId:r}=t;n.revoke({clientId:r}).$promise.then((()=>{e.apps=e.apps.filter((e=>r!==e.clientId))})).catch(o)}(r)}).show()},o()}]),angular.module("bandlab.account.settings").controller("PrivacyCtrl",["$q","$scope","AppNotifications","authService","chatPrivacy","commentsPrivacy","ConfirmModal","Identity","invitesPrivacy","Me","Settings","User",function(e,t,n,o,r,i,a,s,l,c,u,d){t.privacy={account:c.isPrivate,comments:i,chat:r,invites:l};var p,m=null,f=!1;function h(){return f?e.resolve([]):((p=d.blocked({id:c.id,after:m}).$promise).then((function(e){m=e.paging.cursors.after,f=!m})),p)}t.loadMore=function(){return t.infiniteScrollEnded?e.resolve():(p=p.then((function(e){let{data:n}=e;return t.infiniteScrollEnded=f,t.users=t.users||[],t.users=t.users.concat(n),h()})),p)},h().then(t.loadMore),t.saveAccountSettings=async function(){await new Promise((function(e,n){t.privacy.account?new a({confirmLabel:"Make Private",contentScope:{title:"Make account private",message:"Making your profile private will stop active Boost campaigns and Profile promotions."},onConfirm:e,onCancel:function(){t.privacy.account=!1,t.$applyAsync(),n()}}).show():e()})),s.update({isPrivate:t.privacy.account}).$promise.then((function(e){return t.accountPrivacyForm.$setPristine(),n.addNotification({title:"Privacy settings updated",classList:"success",autoclose:8e3}),o.setMe(e)}))},t.saveChatSettings=function(){u.savePrivacySettings({service:"chat",allowMessagesFrom:t.privacy.chat}).$promise.then((function(){t.chatPrivacyForm.$setPristine(),n.addNotification({title:"Privacy settings updated",classList:"success",autoclose:8e3})}))},t.saveCommentsSettings=function(){u.savePrivacySettings({service:"comments",allowCommentsFrom:t.privacy.comments}).$promise.then((function(){t.commentsPrivacyForm.$setPristine(),n.addNotification({title:"Privacy settings updated",classList:"success",autoclose:8e3})}))},t.saveInvitesSettings=function(){u.savePrivacySettings({service:"invites",allowInvitesFrom:t.privacy.invites}).$promise.then((function(){t.invitesPrivacyForm.$setPristine(),n.addNotification({title:"Privacy settings updated",classList:"success",autoclose:8e3})}))}}]),xp.prototype.clear=function(){this.__data__=new Cc,this.size=0},xp.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},xp.prototype.get=function(e){return this.__data__.get(e)},xp.prototype.has=function(e){return this.__data__.has(e)},xp.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Cc){var o=n.__data__;if(!Ec||o.length<199)return o.push([e,t]),this.size=++n.size,this;n=this.__data__=new Rc(o)}return n.set(e,t),this.size=n.size,this},Lp.prototype.add=Lp.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Lp.prototype.has=function(e){return this.__data__.has(e)};var Dp=1,Np=2;function Up(e,t,n,o,r,i){var a=n&Dp,s=e.length,l=t.length;if(s!=l&&!(a&&l>s))return!1;var c=i.get(e),u=i.get(t);if(c&&u)return c==t&&u==e;var d=-1,p=!0,m=n&Np?new Lp:void 0;for(i.set(e,t),i.set(t,e);++d<s;){var f=e[d],h=t[d];if(o)var g=a?o(h,f,d,t,e,i):o(f,h,d,e,t,i);if(void 0!==g){if(g)continue;p=!1;break}if(m){if(!Op(t,(function(e,t){if(!jp(m,t)&&(f===e||r(f,e,n,o,i)))return m.push(t)}))){p=!1;break}}else if(f!==h&&!r(f,h,n,o,i)){p=!1;break}}return i.delete(e),i.delete(t),p}const Fp=Gl.Uint8Array;function Bp(e){var t=-1,n=Array(e.size);return e.forEach((function(e,o){n[++t]=[o,e]})),n}function Wp(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var Vp=1,qp=2,zp="[object Boolean]",Hp="[object Date]",Gp="[object Error]",Kp="[object Map]",Yp="[object Number]",Jp="[object RegExp]",Xp="[object Set]",Zp="[object String]",Qp="[object Symbol]",em="[object ArrayBuffer]",tm="[object DataView]",nm=Kl?Kl.prototype:void 0,om=nm?nm.valueOf:void 0;function rm(e,t){for(var n=-1,o=t.length,r=e.length;++n<o;)e[r+n]=t[n];return e}const im=Array.isArray;function am(e,t,n){var o=t(e);return im(e)?o:rm(o,n(e))}function sm(){return[]}var lm=Object.prototype.propertyIsEnumerable,cm=Object.getOwnPropertySymbols,um=cm?function(e){return null==e?[]:(e=Object(e),function(t){for(var n=-1,o=null==t?0:t.length,r=0,i=[];++n<o;){var a=t[n];s=a,lm.call(e,s)&&(i[r++]=a)}var s;return i}(cm(e)))}:sm;const dm=um;function pm(e){return zu(e)&&"[object Arguments]"==oc(e)}var mm=Object.prototype,fm=mm.hasOwnProperty,hm=mm.propertyIsEnumerable;const gm=pm(function(){return arguments}())?pm:function(e){return zu(e)&&fm.call(e,"callee")&&!hm.call(e,"callee")};var vm="object"==typeof exports&&exports&&!exports.nodeType&&exports,bm=vm&&"object"==typeof module&&module&&!module.nodeType&&module,ym=bm&&bm.exports===vm?Gl.Buffer:void 0;const wm=(ym?ym.isBuffer:void 0)||function(){return!1};var $m=9007199254740991,km=/^(?:0|[1-9]\d*)$/;function Sm(e,t){var n=typeof e;return!!(t=null==t?$m:t)&&("number"==n||"symbol"!=n&&km.test(e))&&e>-1&&e%1==0&&e<t}var _m=9007199254740991;function Pm(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=_m}var Mm={};function Tm(e){return function(t){return e(t)}}Mm["[object Float32Array]"]=Mm["[object Float64Array]"]=Mm["[object Int8Array]"]=Mm["[object Int16Array]"]=Mm["[object Int32Array]"]=Mm["[object Uint8Array]"]=Mm["[object Uint8ClampedArray]"]=Mm["[object Uint16Array]"]=Mm["[object Uint32Array]"]=!0,Mm["[object Arguments]"]=Mm["[object Array]"]=Mm["[object ArrayBuffer]"]=Mm["[object Boolean]"]=Mm["[object DataView]"]=Mm["[object Date]"]=Mm["[object Error]"]=Mm["[object Function]"]=Mm["[object Map]"]=Mm["[object Number]"]=Mm["[object Object]"]=Mm["[object RegExp]"]=Mm["[object Set]"]=Mm["[object String]"]=Mm["[object WeakMap]"]=!1;var Cm="object"==typeof exports&&exports&&!exports.nodeType&&exports,Em=Cm&&"object"==typeof module&&module&&!module.nodeType&&module,Im=Em&&Em.exports===Cm&&zl.process;const Rm=function(){try{return Em&&Em.require&&Em.require("util").types||Im&&Im.binding&&Im.binding("util")}catch(e){}}();var Am=Rm&&Rm.isTypedArray;const xm=Am?Tm(Am):function(e){return zu(e)&&Pm(e.length)&&!!Mm[oc(e)]};var Lm=Object.prototype.hasOwnProperty;function Om(e,t){var n=im(e),o=!n&&gm(e),r=!n&&!o&&wm(e),i=!n&&!o&&!r&&xm(e),a=n||o||r||i,s=a?function(e,t){for(var n=-1,o=Array(e);++n<e;)o[n]=t(n);return o}(e.length,String):[],l=s.length;for(var c in e)!t&&!Lm.call(e,c)||a&&("length"==c||r&&("offset"==c||"parent"==c)||i&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Sm(c,l))||s.push(c);return s}var jm=Object.prototype;function Dm(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||jm)}function Nm(e,t){return function(n){return e(t(n))}}const Um=Nm(Object.keys,Object);var Fm=Object.prototype.hasOwnProperty;function Bm(e){if(!Dm(e))return Um(e);var t=[];for(var n in Object(e))Fm.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Wm(e){return null!=e&&Pm(e.length)&&!cc(e)}function Vm(e){return Wm(e)?Om(e):Bm(e)}function qm(e){return am(e,Vm,dm)}var zm=1,Hm=Object.prototype.hasOwnProperty;const Gm=wc(Gl,"DataView"),Km=wc(Gl,"Promise"),Ym=wc(Gl,"Set"),Jm=wc(Gl,"WeakMap");var Xm="[object Map]",Zm="[object Promise]",Qm="[object Set]",ef="[object WeakMap]",tf="[object DataView]",nf=mc(Gm),of=mc(Ec),rf=mc(Km),af=mc(Ym),sf=mc(Jm),lf=oc;(Gm&&lf(new Gm(new ArrayBuffer(1)))!=tf||Ec&&lf(new Ec)!=Xm||Km&&lf(Km.resolve())!=Zm||Ym&&lf(new Ym)!=Qm||Jm&&lf(new Jm)!=ef)&&(lf=function(e){var t=oc(e),n="[object Object]"==t?e.constructor:void 0,o=n?mc(n):"";if(o)switch(o){case nf:return tf;case of:return Xm;case rf:return Zm;case af:return Qm;case sf:return ef}return t});const cf=lf;var uf=1,df="[object Arguments]",pf="[object Array]",mf="[object Object]",ff=Object.prototype.hasOwnProperty;function hf(e,t,n,o,r){return e===t||(null==e||null==t||!zu(e)&&!zu(t)?e!=e&&t!=t:function(e,t,n,o,r,i){var a=im(e),s=im(t),l=a?pf:cf(e),c=s?pf:cf(t),u=(l=l==df?mf:l)==mf,d=(c=c==df?mf:c)==mf,p=l==c;if(p&&wm(e)){if(!wm(t))return!1;a=!0,u=!1}if(p&&!u)return i||(i=new xp),a||xm(e)?Up(e,t,n,o,r,i):function(e,t,n,o,r,i,a){switch(n){case tm:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case em:return!(e.byteLength!=t.byteLength||!i(new Fp(e),new Fp(t)));case zp:case Hp:case Yp:return Pc(+e,+t);case Gp:return e.name==t.name&&e.message==t.message;case Jp:case Zp:return e==t+"";case Kp:var s=Bp;case Xp:var l=o&Vp;if(s||(s=Wp),e.size!=t.size&&!l)return!1;var c=a.get(e);if(c)return c==t;o|=qp,a.set(e,t);var u=Up(s(e),s(t),o,r,i,a);return a.delete(e),u;case Qp:if(om)return om.call(e)==om.call(t)}return!1}(e,t,l,n,o,r,i);if(!(n&uf)){var m=u&&ff.call(e,"__wrapped__"),f=d&&ff.call(t,"__wrapped__");if(m||f){var h=m?e.value():e,g=f?t.value():t;return i||(i=new xp),r(h,g,n,o,i)}}return!!p&&(i||(i=new xp),function(e,t,n,o,r,i){var a=n&zm,s=qm(e),l=s.length;if(l!=qm(t).length&&!a)return!1;for(var c=l;c--;){var u=s[c];if(!(a?u in t:Hm.call(t,u)))return!1}var d=i.get(e),p=i.get(t);if(d&&p)return d==t&&p==e;var m=!0;i.set(e,t),i.set(t,e);for(var f=a;++c<l;){var h=e[u=s[c]],g=t[u];if(o)var v=a?o(g,h,u,t,e,i):o(h,g,u,e,t,i);if(!(void 0===v?h===g||r(h,g,n,o,i):v)){m=!1;break}f||(f="constructor"==u)}if(m&&!f){var b=e.constructor,y=t.constructor;b==y||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof y&&y instanceof y||(m=!1)}return i.delete(e),i.delete(t),m}(e,t,n,o,r,i))}(e,t,n,o,hf,r))}function gf(e,t){return hf(e,t)}var vf=1,bf=2;function yf(e){return e==e&&!rc(e)}function wf(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in Object(n))}}var $f=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,kf=/^\w*$/;function Sf(e,t){if(im(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Gu(e))||kf.test(e)||!$f.test(e)||null!=t&&e in Object(t)}var _f=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Pf=/\\(\\)?/g,Mf=function(){var e=Ac((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(_f,(function(e,n,o,r){t.push(o?r.replace(Pf,"$1"):n||e)})),t}),(function(e){return 500===t.size&&t.clear(),e})),t=e.cache;return e}();const Tf=Mf;function Cf(e,t){for(var n=-1,o=null==e?0:e.length,r=Array(o);++n<o;)r[n]=t(e[n],n,e);return r}var Ef=1/0,If=Kl?Kl.prototype:void 0,Rf=If?If.toString:void 0;function Af(e){if("string"==typeof e)return e;if(im(e))return Cf(e,Af)+"";if(Gu(e))return Rf?Rf.call(e):"";var t=e+"";return"0"==t&&1/e==-Ef?"-0":t}function xf(e){return null==e?"":Af(e)}function Lf(e,t){return im(e)?e:Sf(e,t)?[e]:Tf(xf(e))}var Of=1/0;function jf(e){if("string"==typeof e||Gu(e))return e;var t=e+"";return"0"==t&&1/e==-Of?"-0":t}function Df(e,t){for(var n=0,o=(t=Lf(t,e)).length;null!=e&&n<o;)e=e[jf(t[n++])];return n&&n==o?e:void 0}function Nf(e,t){return null!=e&&t in Object(e)}var Uf=1,Ff=2;function Bf(e,t){return Sf(e)&&yf(t)?wf(jf(e),t):function(n){var o=function(e,t){var n=null==e?void 0:Df(e,t);return void 0===n?void 0:n}(n,e);return void 0===o&&o===t?function(e,t){return null!=e&&function(e,t,n){for(var o=-1,r=(t=Lf(t,e)).length,i=!1;++o<r;){var a=jf(t[o]);if(!(i=null!=e&&n(e,a)))break;e=e[a]}return i||++o!=r?i:!!(r=null==e?0:e.length)&&Pm(r)&&Sm(a,r)&&(im(e)||gm(e))}(e,t,Nf)}(n,e):hf(t,o,Uf|Ff)}}function Wf(e){return e}function Vf(e){return"function"==typeof e?e:null==e?Wf:"object"==typeof e?im(e)?Bf(e[0],e[1]):(r=function(e){for(var t=Vm(e),n=t.length;n--;){var o=t[n],r=e[o];t[n]=[o,r,yf(r)]}return t}(o=e),1==r.length&&r[0][2]?wf(r[0][0],r[0][1]):function(e){return e===o||function(e,t,n,o){var r=n.length,i=r;if(null==e)return!i;for(e=Object(e);r--;){var a=n[r];if(a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++r<i;){var s=(a=n[r])[0],l=e[s],c=a[1];if(a[2]){if(void 0===l&&!(s in e))return!1}else{var u,d=new xp;if(!(void 0===u?hf(c,l,vf|bf,o,d):u))return!1}}return!0}(e,0,r)}):Sf(t=e)?(n=jf(t),function(e){return null==e?void 0:e[n]}):function(e){return function(t){return Df(t,e)}}(t);var t,n,o,r}function qf(e,t,n){var o=-1,r=e.length;t<0&&(t=-t>r?0:r+t),(n=n>r?r:n)<0&&(n+=r),r=t>n?0:n-t>>>0,t>>>=0;for(var i=Array(r);++o<r;)i[o]=e[o+t];return i}function zf(e,t){return null==(e=function(e,t){return t.length<2?e:Df(e,qf(t,0,-1))}(e,t=Lf(t,e)))||delete e[jf((n=t,o=null==n?0:n.length,o?n[o-1]:void 0))];var n,o}var Hf=Array.prototype.splice;function Gf(e,t){var n=[];if(!e||!e.length)return n;var o=-1,r=[],i=e.length;for(t=Vf(t);++o<i;){var a=e[o];t(a,o,e)&&(n.push(a),r.push(o))}return function(e,t){for(var n=e?t.length:0,o=n-1;n--;){var r=t[n];if(n==o||r!==i){var i=r;Sm(r)?Hf.call(e,r,1):zf(e,r)}}}(e,r),n}const Kf=window?.fromAPI?.userAgent??(window.UAParser?(new UAParser).getResult():{browser:{},os:{},device:{}}),Yf="Android"===Kf.os.name,Jf="iOS"===Kf.os.name,Xf="Mac OS"===Kf.os.name,Zf="mobile"===Kf.device.type,Qf="tablet"===Kf.device.type,eh="ontouchstart"in window||navigator.maxTouchPoints,th="Windows"===Kf.os.name,nh=Kf;function oh(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]||!Zf&&!Jf?ih()?void 0:Zf||Jf?"unavailable":"Chrome"!==nh.browser.name?"useChrome":"updateBrowser":"unavailable"}function rh(){const e={Safari:16,Firefox:105,Chrome:99,Edge:99};return!(nh.browser.name in e)||parseInt(nh.browser.major)>=e[nh.browser.name]}function ih(){return"crypto"in window&&"randomUUID"in crypto&&"storage"in navigator&&"Exception"in WebAssembly&&"structuredClone"in window}function ah(){return import("./chunk-a57284d5.js").then((e=>{let{simd:t}=e;return t()}))}function sh(){return import("./chunk-a57284d5.js").then((e=>{let{exceptions:t}=e;return t()}))}const lh=rd((function(){const e={...navigator.mediaDevices.getSupportedConstraints().sampleRate?{sampleRate:44100}:{}},t=new AudioContext(e);return window.addEventListener("click",n,!0),window.addEventListener("keydown",n,!0),t;function n(){t.suspend().then((()=>t.resume())),window.removeEventListener("click",n,!0),window.removeEventListener("keydown",n,!0)}}));function ch(e){const t=lh();return t.decodeAudioData(e).then((function(e){return function(e,t){if(1===t.numberOfChannels){const n=e.createBuffer(2,t.length,e.sampleRate);return n.getChannelData(0).set(t.getChannelData(0)),n.getChannelData(1).set(t.getChannelData(0)),n}if(t.numberOfChannels>2){const n=e.createBuffer(2,t.length,e.sampleRate);return n.getChannelData(0).set(t.getChannelData(0)),n.getChannelData(1).set(t.getChannelData(1)),n}return t}(t,e)}))}const uh=Ac((function(e){return Promise.all([Promise.resolve().then((()=>SA)),Promise.all([sh(),ah()]).then((function(t){let[n,o]=t;return n&&o?(gtag("event","Use libaudioengine",{send_to:"G-SD5MPWV79Q"}),e.audioWorklet.addModule("https://www.bandlab.com/web-app/common/workers/libaudioengine-a01e5e8f96.js")):n?(gtag("event","Use libaudioengine_no_simd",{send_to:"G-SD5MPWV79Q"}),e.audioWorklet.addModule("https://www.bandlab.com/web-app/common/workers/libaudioengine_no_simd-5fb41c70d6.js")):(gtag("event","No libaudioengine compatible",{send_to:"G-SD5MPWV79Q"}),Promise.reject(new Error("No libaudioengine compatible")))}))])})),dh="Action canceled",ph="Unable to encode audio",mh="Please try again, or refer to our Help Center article for a solution.",fh="Unable to import file. Please check that your file is not corrupted.",hh="Some regions cannot be played.",gh="Unable to initialize Studio. Please re-open it.",vh="Microphone access is not allowed",bh="Something went wrong while saving",yh="Saving is unavailable.",wh="Track couldnt be added",$h="Youve reached the maximum number of tracks ({$1})";let kh=[];function Sh(e){const t=Ph(e);return _h(new Worker("https://www.bandlab.com/web-app/common/workers/encoderWorker-fddd6d5123.js"),{dataChannel:t,sampleRate:e.sampleRate}).then((function(e){return new Blob([e],{type:"audio/wav"})}))}function _h(e,t){return new Promise((function(n,o){e.onerror=function(e){Sentry.onLoad((function(){Sentry.captureException(e&&e.message,{extra:{colno:e&&e.colno,lineno:e&&e.lineno,message:e&&e.message}})})),o(e)},e.onmessage=function(t){t.data?n(t.data):o(ph),e.terminate()},e.postMessage(t)}))}function Ph(e){return 2===e.numberOfChannels?[e.getChannelData(0).buffer,e.getChannelData(1).buffer]:[e.getChannelData(0).buffer]}function Mh(e){let{minWidth:t=320,minHeight:n=320,maxWidth:o=6e3,maxHeight:r=6e3,rotate:i=0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){return new Promise(((n,o)=>{const r=new Image;r.src=URL.createObjectURL(e),r.onerror=o,r.onload=function(){const e=document.createElement("canvas"),o=e.getContext("2d");[e.height,e.width]=180===t||0===t?[r.height,r.width]:[r.width,r.height],180===t?o.translate(r.width,r.height):90===t?o.translate(r.height,0):270===t&&o.translate(0,r.width),o.rotate(t*(Math.PI/180)),o.drawImage(r,0,0),e.toBlob((e=>{n(e)}),"image/jpeg",1)}}))}(e,i).then((e=>new Promise((function(i,a){const s=new Image;s.src=URL.createObjectURL(e),s.onload=function(){return this.width<t||this.height<n?a(new Error(`Minimum image size is ${t} x ${n} pixels.`)):this.width>o||this.height>r?a(new Error(`Maximum image size is ${o} x ${r} pixels.`)):i({image:s,file:e})},s.onerror=function(){a(new Error("File format is not supported"))}}))))}function Th(e){let{currentTime:t=.5,isSquare:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=document.createElement("canvas").getContext("2d"),r=document.createElement("video");return r.src=URL.createObjectURL(e),r.load(),new Promise(((e,t)=>{r.addEventListener("loadeddata",e),r.addEventListener("error",t)})).then((function(){return new Promise(((e,n)=>{r.currentTime=t,r.addEventListener("seeked",e),r.addEventListener("error",n)}))})).then((function(){let e=r.videoHeight,t=r.videoWidth,i=0,a=0;return n&&(e<t?(i=(e-t)/2,t=e):e>t&&(a=(t-e)/2,e=t)),o.canvas.width=t,o.canvas.height=e,o.drawImage(r,i,a,r.videoWidth,r.videoHeight),new Promise((e=>{o.canvas.toBlob((function(t){t.name="thumbnail.jpg",e(t)}),"image/jpeg")}))}))}function Ch(e){if(e.type)return Promise.resolve(e);const t=[{type:"audio/flac",extension:"flac",signature:[102,76,97,67,0]},{type:"audio/m4a",extension:"m4a",signature:[0,0,0,32,102,116,121,112,77,52,65]},{type:"audio/midi",extension:"mid",signature:[77,84,104,100]},{type:"audio/mp3",extension:"mp3",signature:[255,243]},{type:"audio/mp3",extension:"mp3",signature:[255,251]},{type:"audio/mp3",extension:"mp3",signature:[73,68,51]},{type:"audio/ogg",extension:"ogg",signature:[79,103,103,83]},{type:"audio/wav",extension:"wav",signature:[82,73,70,70]},{type:"audio/webm",extension:"webm",signature:[26,69,223,163]},{type:"image/png",extension:"png",signature:[137,80,78,71,13,10,26,10]},{type:"image/jpeg",extension:"jpeg",signature:[255,216,255]}];return e.arrayBuffer().then((function(n){const o=new Uint8Array(n),r=t.find((e=>e.signature.every(((e,t)=>e===o[t])))),i=Rh(e.name);if(!r)return e;const a=i?e.name.replace(new RegExp(`${i}$`),r.extension):`${e.name}.${r.extension}`;return new File([n],a,{type:r.type})}))}const Eh={flac:["audio/flac"],m4a:["audio/m4a","audio/x-m4a","audio/mp4","audio/aac","audio/x-aac"],mid:["audio/midi","audio/mid","audio/x-midi"],mp3:["audio/mpeg","audio/mp3"],mp4:["audio/mp4","video/mp4"],ogg:["audio/ogg","video/ogg"],wav:["audio/wav","audio/wave","audio/x-wav","audio/s-wav"],webm:["audio/webm"]};function Ih(e){for(const[t,n]of Object.entries(Eh))if(n.includes(e))return t}function Rh(e){const t=e.split(".").pop();return Object.keys(Eh).includes(t)?t:""}function Ah(e){return Ih(e.type)||Rh(e.name)}function xh(e){return new Promise((function(t,n){const o=URL.createObjectURL(e),r=new Audio(o);r.onloadedmetadata=function(){URL.revokeObjectURL(o),t(r.duration)},r.onerror=function(e){URL.revokeObjectURL(o),4===r.error.code&&n({message:"Unable to import file. Please check that your file is not corrupted."}),n(e)}}))}function Lh(e){const t=Rh(e);return e.replace(new RegExp(`\\.${t}$`),"")}function Oh(e){const t=e.type,n=e.name;return e.arrayBuffer().then((function(e){const o=new Blob([e],{type:t});return o.name=n,o})).catch((function(){return e}))}function jh(e,t){return xh(e).then((function(n){return n>t?Promise.reject({message:(o=t/60,{one:`The file you are trying to import is too long. The maximum is ${o} minute.`,other:`The file you are trying to import is too long. The maximum is ${o} minutes.`}[new Intl.PluralRules("en").select(o)])}):e;var o}))}function Dh(e,t){return e.size>1024*t*1024?Promise.reject(new Error(`Your file is too large, the maximum is ${t} MB.`)):0===e.size?Promise.reject(new Error("Unable to import file. Please check that your file is not corrupted.")):Promise.resolve(e)}function Nh(e){let{formats:t=["image/png","image/jpeg"],readable:n="JPG, PNG"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Ch(e).then((function(e){return-1===t.indexOf(e.type)?Promise.reject(new Error(`File format is not supported for ${e.name}\nSupported file formats: ${n}`)):e}))}const Uh="audio/x-aac, audio/aac, audio/flac, audio/m4a, audio/x-m4a, audio/mp4, audio/mpeg, audio/mp3, audio/ogg, audio/wav, audio/wave, audio/x-wav, audio/s-wav "+(Jf?"":", audio/webm");function Fh(){let{accept:e,multiple:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=document.createElement("input");return n.setAttribute("type","file"),e&&n.setAttribute("accept",e),t&&n.setAttribute("multiple",t),new Promise((function(e){n.addEventListener("change",(function(){e(Array.from(n.files))}),{once:!0}),n.classList.add("visually-hidden"),document.body.appendChild(n),n.click(),setTimeout((function(){document.body.addEventListener("click",(function(){document.body.removeChild(n)}),{once:"true"})}))}))}function Bh(e){return zh(e).then(Sh).then((function(t){return t.name=e.name||"New Track",t})).catch((function(){throw new Error("File format is not supported")}))}function Wh(e){return lh().decodeAudioData(e).then(Sh).catch((function(){throw new Error("File format is not supported")}))}const Vh={formats:["audio/aac","audio/aiff","audio/amr","audio/asf","audio/flac","audio/m4a","audio/mp3","audio/mp4","audio/mpeg","audio/ogg","audio/wav","audio/webm","audio/x-m4a","audio/x-ms-wma","audio/x-wav","video/mp4","video/ogg"],readable:"mp3, mp4, wav, aac, ogg, flac"};function qh(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1800;const n=Ah(e);return((e.type??"").startsWith("video/")||!n?Bh(e):Promise.resolve(e)).then((function(e){return Nh(e,Vh)})).then((function(e){return jh(e,t)}))}function zh(e){return e.arrayBuffer().then((function(e){return lh().decodeAudioData(e)}))}function Hh(e){return zh(e).then((function(e){return function(e){const t=Ph(e);return _h(new Worker("https://www.bandlab.com/web-app/common/workers/flacWorker-6d3bb31a0a.js"),{dataChannel:t,sampleRate:e.sampleRate,url:"https://www.bandlab.com/web-app/common/workers/libflac-3bd08093e3.js"}).then((function(e){return new Blob([e],{type:"audio/flac"})}))}(e)})).then((function(t){return t.name=e.name,t})).catch((function(t){return e}))}function Gh(e){const t=document.createElement("a");t.href=e,t.click()}function Kh(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=document.createElement("a");n.href=URL.createObjectURL(e),n.download=t,n.click(),URL.revokeObjectURL(n.href)}const Yh={id:"aac-44100-16bit-128kbps",extension:"m4a",quality:"Medium",specs:"128kbps, 44.1kHz",description:"Lightweight, heavily compressed file. Great for sharing."},Jh={id:"aac-44100-16bit-192kbps",extension:"m4a",quality:"High",specs:"192kbps, 44.1kHz",description:"Lightweight, good quality. Optimized for streaming."},Xh={id:"mp3-44100-16bit-320kbps",extension:"mp3",quality:"Highest",specs:"320kbps, 44.1kHz",description:"Great sound, while still lightweight."},Zh={id:"wav-44100-16bit",extension:"wav",quality:"No compression",specs:"16bit, 44.1kHz",description:"Amazing sound. Larger file."};function Qh(e){return new Promise((function(t){const n=new Image;n.src=e,n.onload=t,n.onerror=t}))}function eg(e,t){let{minDuration:n=3,maxDuration:o}=t;return new Promise(((t,r)=>{const i=document.createElement("video");i.src=URL.createObjectURL(e),i.onloadedmetadata=function(){n=parseInt(n),o=parseInt(o),o&&i.duration>o?r({message:`Video length should be less than ${o} seconds.`}):i.duration<n?r({message:`Video length must be more than ${n} seconds.`}):i.videoHeight&&i.videoWidth?t({video:i,file:e}):r({message:"File format is not supported"})},i.onerror=e=>{4===e.target.error.code&&r({message:"Something went wrong. Ensure that your file format is correct"}),r({message:"Something went wrong, please try again later"})}}))}function tg(e){const t=e.split(".");return{jpg:"image",jpeg:"image",png:"image",gif:"image",json:"json"}[t[t.length-1].toLowerCase()]||"unknown"}angular.module("bandlab.account.settings").controller("CreatorConnectEditCtrl",["$q","$scope","$state","AppNotifications","authService","FileHelper","Identity","Me","Modal","Tag","User",function(e,t,n,o,r,i,a,s,l,c,u){t.changeSuccess=!1,t.changeError=!1,t.user=new a,t.user.about=s.about,t.user.introVideo=s.introVideo||(s.introVideoId?{status:"Processing",picture:{url:"https://bandlab-test-images.azureedge.net/v1.0/videos/default/640x640/blur"}}:null),t.user.introVideoId=s.introVideoId,t.user.collaborationStatus=s.collaborationStatus,t.user.place=s.place,t.user.inspiredBy=[...s.inspiredBy],t.accordions={aboutMe:{isExpanded:!1},lookingFor:{isExpanded:!1}},t.isCollabSkillsValid=!0,t.isLoading=!0,t.toggleAccordion=function(e){t.accordions[e].isExpanded=!t.accordions[e].isExpanded};const d={introVideoId:s.introVideoId,place:s.place,about:s.about,inspiredBy:angular.copy(s.inspiredBy),skills:[],genres:[]},m={place:null,skills:[],genres:[],inspiredBy:[]};function f(e){return e.map((e=>e.id))}function h(e,t){e.$watch(t,(function(t,n){gf(t.map((e=>e.id)),n.map((e=>e.id)))||e.profileForm.$setDirty()}),!0)}this.uiCanExit=function(e){return t.profileForm.$dirty?new Promise((function(t){const n=new l({toFocusConfirm:!0,contentScope:{leave:function(){n.destroy(),t(e)}},onCancel:function(){n.destroy(),t(!1)},templateUrl:"https://www.bandlab.com/web-app/account/settings/partials/_profile-leave-confirm-fc21fe6e.html"});n.show()})):e},this.$onInit=function(){Mp(s,"collab_preferences_enabled").then((function(e){return t.collabPreferencesEnabled="true"===e,t.collabPreferencesEnabled?Promise.all([c.getSkills(),c.getGenres(),u.getCollaborationPreferences({userId:s.id}).$promise]):Promise.all([c.getSkills(),c.getGenres()])})).then((function(e){let n,o,r;t.collabPreferencesEnabled?[n,o,r]=e:[n,o]=e,t.skills=_.map(n,(function(e){return e.isSelected=_.some(s.skills,{id:e.id}),e})),t.genres=_.map(o,(function(e){return e.isSelected=_.some(s.genres,{id:e.id}),e})),d.skills=angular.copy(t.skills),d.genres=angular.copy(t.genres),h(t,"user.inspiredBy"),t.collabPreferencesEnabled&&(t.collaborationSkills=angular.copy(n),t.collaborationGenres=angular.copy(o),t.collaborationPlace=r.lookingFor.place,t.collaborationPreferences=r,t.collaborationSkills=_.map(t.collaborationSkills,(function(e){return e.isSelected=_.some(t.collaborationPreferences.lookingFor.skills,{id:e.id}),e})).filter((function(e){return"1-fan"!==e.id&&"other"!==e.id})),t.collaborationGenres=_.map(t.collaborationGenres,(function(e){return e.isSelected=_.some(t.collaborationPreferences.lookingFor.genres,{id:e.id}),e})).filter((function(e){return"other"!==e.id}))),t.collabPreferencesEnabled&&(m.skills=angular.copy(t.collaborationSkills),m.genres=angular.copy(t.collaborationGenres),m.inspiredById=angular.copy(t.collaborationPreferences.lookingFor.inspiredBy.id),m.place=r.lookingFor.place??null,h(t,"collaborationPreferences.lookingFor.inspiredBy")),t.isLoading=!1,t.$applyAsync()}))},t.editMe=function(){let a;t.changeError=!1,t.user.genres=_.filter(t.genres,{isSelected:!0}),t.user.skills=_.filter(t.skills,{isSelected:!0}),t.collabPreferencesEnabled&&(a={genres:_.filter(t.collaborationGenres,{isSelected:!0}),inspiredBy:t.collaborationPreferences.lookingFor.inspiredBy,place:t.collaborationPlace,skills:_.filter(t.collaborationSkills,{isSelected:!0})});const l="Ready"===t.user.collaborationStatus?"on":"off";return e.resolve(!t.videoFile||Th(t.videoFile).then((function(e){return i.upload([t.videoFile,e],"https://storage.bandlab.com/v1.3/videos").then((function(e){let{data:n}=e;t.user.introVideoId=n.id}))}))).then((function(){return t.collabPreferencesEnabled?u.updateCollaborationPreferences({userId:s.id},a):e.resolve(!0)})).then((function(){return t.user.$update()})).then((function(e){let i;i=!(!t.collabPreferencesEnabled||gf(m.skills,t.collaborationSkills)&&gf(m.genres,t.collaborationGenres)&&gf(f(m.inspiredBy),f(t.collaborationPreferences.lookingFor.inspiredBy))&&m.place?.name===t.collaborationPlace?.name);const a=d.introVideoId!==t.user.introVideoId||d.place?.name!==t.user.place?.name||d.about!==t.user.about||!gf(d.skills,t.skills)||!gf(d.genres,t.genres)||!gf(f(d.inspiredBy),f(t.user.inspiredBy));!function(e,t,n){Promise.resolve().then((()=>rb)).then((function(o){let{logCreatorConnectSettingsUpdate:r}=o;r(e,"creator_connect_settings",t,n)}))}(l,a,i),a&&(d.introVideoId=t.user.introVideoId,d.place=t.user.place??null,d.about=t.user.about,d.skills=angular.copy(t.skills),d.genres=angular.copy(t.genres),d.inspiredBy=angular.copy(t.user.inspiredBy)),i&&(m.skills=angular.copy(t.collaborationSkills),m.genres=angular.copy(t.collaborationGenres),m.inspiredBy=angular.copy(t.collaborationPreferences.lookingFor.inspiredBy),m.place=t.collaborationPlace??null),r.setMe(e),t.profileForm.$setPristine(),p()?location.href="_#bl_closeWebView":o.addNotification({title:"Profile updated",action:`<a class="button-scd button-height-32 button-padding-16 button-rounded" href="${n.href("user.feed",{username:e.username})}"><i class="icon-arrow-right"></i></a>`,classList:"success",autoclose:8e3})})).catch((function(e){t.profileForm.$setPristine(),t.changeError=e||!0}))},t.removeInspireByArtist=function(e){Gf(t.user.inspiredBy,e)},t.removeCollabInspireByArtist=function(e){Gf(t.collaborationPreferences.lookingFor.inspiredBy,e)}}]),angular.module("bandlab.account.settings").controller("EmailConfirmationCtrl",["$scope","Identity",function(e,t){e.resendEmailConfirmation=function(){t.resendEmailConfirmation().$promise.then((function(){e.emailConfirmationRequestSent=!0}))}}]),angular.module("bandlab.account.settings").controller("EmailSetupCtrl",["$rootScope","$scope","authService","Identity","Password",function(e,t,n,o,r){t.user=new o,t.password=new r,t.setupEmailPassword=function(){t.wrongPassword=!1,t.user.$update().then((function(o){t.password.$update().then((function(){o.hasPassword=!0,n.setMe(o),e.$broadcast("$account:emailSetup",{email:o.email}),e.$broadcast("$account:passwordSetup")})).catch((function(e){t.wrongPassword=!0,t.accountForm.$setPristine(),t.errorMessage=_.get(e,"data.message")}))})).catch((function(){t.accountForm.$setPristine()}))},t.setupEmail=function(){t.user.$update().then((function(t){n.setMe(t),e.$broadcast("$account:emailSetup",{email:t.email})})).catch((function(){t.accountForm.$setPristine()}))},t.setupPassword=function(){t.user.$info().then((function(o){t.password.$update().then((function(){o.hasPassword=!0,n.setMe(o),e.$broadcast("$account:passwordSetup")}))})).catch((function(){t.wrongPassword=!0,t.accountForm.$setPristine()}))}}]);var ng=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");function og(e){return ng.test(e)}var rg="\\ud800-\\udfff",ig="["+rg+"]",ag="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",sg="\\ud83c[\\udffb-\\udfff]",lg="[^"+rg+"]",cg="(?:\\ud83c[\\udde6-\\uddff]){2}",ug="[\\ud800-\\udbff][\\udc00-\\udfff]",dg="(?:"+ag+"|"+sg+")?",pg="[\\ufe0e\\ufe0f]?",mg=pg+dg+"(?:\\u200d(?:"+[lg,cg,ug].join("|")+")"+pg+dg+")*",fg="(?:"+[lg+ag+"?",ag,cg,ug,ig].join("|")+")",hg=RegExp(sg+"(?="+sg+")|"+fg+mg,"g");const gg=function(e){var t,n,o,r=og(e=xf(e))?function(e){return og(e)?function(e){return e.match(hg)||[]}(e):function(e){return e.split("")}(e)}(e):void 0,i=r?r[0]:e.charAt(0),a=r?(t=r,o=t.length,qf(t,1,n=void 0===n?o:n)).join(""):e.slice(1);return i.toUpperCase()+a};function vg(e){return gg(xf(e).toLowerCase())}async function bg(){const e=function(){const e=new Uint32Array(16);return crypto.getRandomValues(e),Array.from(e).map((e=>e.toString(16).padStart(2,"0"))).join("")}(),t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t);return{codeVerifier:e,codeChallenge:btoa(String.fromCharCode.apply(null,new Uint8Array(n))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}}function yg(e){return Uu.get(`https://www.bandlab.com/api/v1.3/settings/notifications/${e}`).json()}function wg(e,t){return Uu.patch(`https://www.bandlab.com/api/v1.3/settings/notifications/${e}`,{json:t})}function $g(){return Uu.get("https://accounts.bandlab.com/oauth/external/token").json()}angular.module("bandlab.account.settings").controller("LinkedAccountsEditCtrl",["$q","$scope","AppNotifications","Login","Me",function(e,t,n,o,r){function i(){o.query().$promise.then((function(e){t.linkedAccounts=e,angular.forEach(e,(function(e){e.isLinked=!0,e.title=vg(e.provider)})),_.find(t.linkedAccounts,{provider:"google"})||t.linkedAccounts.push({provider:"google",title:"Google",isLinked:!1}),_.find(t.linkedAccounts,{provider:"facebook"})||t.linkedAccounts.push({provider:"facebook",title:"Facebook",isLinked:!1})}))}function a(e,n){t.errorConflict=!1,new o({provider:e,accessToken:n}).$save().then((function(){i()})).catch((function(e){409===e.status&&(t.errorConflict=!0,t.errorMessage=_.get(e,"data.message"))}))}return t.toggleLinkAccount=function(s,l){s.preventDefault(),l.isLinked?function(e){t.linkedAccounts.filter((function(t){return t!==e})).reduce((function(e,t){return e||t.isLinked}),!1)||r.phone||r.email&&r.hasPassword?o.delete({provider:e.provider}).$promise.then((function(){i()})).catch((function(e){401===e.status||404===e.status?alert(e.data.message):alert("Something went wrong, please try again later")})):window.alert("To continue accessing your account, please set an email and/or password before unlinking.")}(l):function(t){"facebook"===t.provider?import("./chunk-b006dddf.js").then((function(e){let{login:t}=e;return t()})).then((function(e){return e.authResponse.accessToken})).catch((function(t){return e.reject(t.status)})).then((function(e){a(t.provider,e)})):"google"===t.provider&&import("./chunk-972795c8.js").then((function(e){let{startSignIn:t}=e;return t()})).then((function(e){return e.credential})).then((function(e){a(t.provider,e)})).catch((function(){n.addNotification({title:"Failed to link to Google",classList:"alert",autoclose:8e3})}))}(l)},i()}]),angular.module("bandlab.account.settings").controller("PasswordChangeCtrl",["$scope","AppNotifications","Me","Password",function(e,t,n,o){e.password=new o,e.changeSuccess=!1,e.passwordError=!1,e.doChangePassword=function(){e.passwordError=!1,e.password.$update().then((function(){t.addNotification({title:"Password changed",classList:"success",autoclose:8e3}),e.changeSuccess=!0,e.changePasswordForm.$setPristine()})).catch((function(t){e.passwordError=!0,e.changePasswordForm.$setPristine(),e.errorMessage=_.get(t,"data.message")}))},e.resetPassword=function(){new o({email:n.email}).$reset().then((function(){t.addNotification({title:"An email has been sent",content:`An email has been sent to ${n.email} for you to set a new password.`,autoclose:8e3})})).catch((function(){e.requestFailed=!0}))}}]),angular.module("bandlab.account.settings").controller("PasswordRenewCtrl",["$injector","$scope",function(e,t){import("./chunk-a6e48af6.js").then((function(n){let{mountPasswordRenew:o}=n;const r=o(document.getElementById("passwordRenewMount"),{$injector:e});t.$on("$destroy",(function(){r.unmount()}))}))}]),angular.module("bandlab.account.settings").controller("PasswordResetCtrl",["$injector","$scope",function(e,t){import("./chunk-a6e48af6.js").then((function(n){let{mountPasswordReset:o}=n;const r=o(document.getElementById("passwordResetMount"),{$injector:e});t.$on("$destroy",(function(){r.unmount()}))}))}]),angular.module("bandlab.account.settings").controller("PictureEditCtrl",["$scope",function(e){e.changeError=!1,e.$on("$file:uploadFailed",(function(){e.changeError=!0}))}]);const kg=Vt(!1),Sg=qt([]);function _g(e,t){let{id:n=ad(),escapeClose:o=!0,overlayClose:r=!0,onClose:i=()=>{}}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Sg.value=Sg.value.concat({component:e,props:Mt(t??{}),options:{id:n,escapeClose:o,overlayClose:r,onClose:i}})}function Pg(e){Sg.value=Sg.value.filter((t=>t.component!==e))}async function Mg(e){_g(zn((()=>import("./chunk-091985fb.js"))),{videoId:e})}const Tg=Object.freeze(Object.defineProperty({__proto__:null,createModal:_g,createYouTubeModal:Mg,isModalGroupsMounted:kg,modals:Sg,removeModalByComponent:Pg},Symbol.toStringTag,{value:"Module"}));function Cg(e,t,n){return!!e&&(Jf||Xf?function(e,t){const n=e.split("."),o=t.split(".");for(var r=0;r<n.length;r++){if(n[r]>o[r])return!0;if(n[r]<o[r])return!1;if(r===n.length-1)return n[r]===o[r]}}(e,t):!!Yf&&e>=n)}const Eg="https://www.bandlab.com/api/v1.3/payments",Ig=Mt({expiresOn:"",isCanceled:!1,isTrial:!1,isTrialUsed:!1,paymentProvider:"",plan:"Free",price:0,priceCurrency:"usd",trialPeriodEndDate:""});function Rg(e,t){const n={beats:zn((()=>import("./chunk-59bf27e9.js")))}[e];return new Promise((function(e,o){if(!n)return e(!0);_g(n,{...t,onConfirm:function(){e(!0)},onDismiss:function(){o()}},{overlayClose:!1,escapeClose:!1})}))}function Ag(e,t,n,o,r){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"USD";return Uu.post(`${Eg}/intents`,{json:{payerId:e,payeeId:t,amount:{cents:n,currency:i},subject:{id:o,type:r}}}).json().catch((async e=>{const t=await e.response.json();throw{name:`${e.name}: Unable to proceed with payment`,message:t.message||e.message||_.get(e,"[0].message")||_.get(e,"error.message"),stack:e.stack,code:t.errorCode||e.error?.code,error:e.error,response:t}}))}function xg(e,t,n,o){return Uu.post(`https://www.bandlab.com/api/v1.3/checkout/products/${e}/payment-providers/${t}/payment-intents/${n}/payments`,{json:{paymentMethod:o},useClientCookies:!0}).json().catch((async function(e){throw await e.response.json()}))}function Lg(e,t,n){return Uu.post(`https://www.bandlab.com/api/v1.3/checkout/products/${e}/payment-providers/${t}/payment-intents`,{json:n,useClientCookies:!0}).json().catch((async function(e){throw await e.response.json()}))}function Og(e,t,n,o){return Uu.post(`https://www.bandlab.com/api/v1.3/checkout/products/${e}/payment-providers/${t}/payment-intents/${n}/payment-confirmations`,{json:{orderId:o},useClientCookies:!0}).json().catch((async function(e){throw await e.response.json()}))}function jg(e,t){return Uu.post(`${Eg}/payers`,{json:{email:e,token:t}}).json().catch((async function(e){throw await e.response.json()}))}function Dg(e){return Uu.delete(`${Eg}/payers/${e}`).json().catch((async function(e){throw await e.response.json()}))}function Ng(e){return Uu.get(`${Eg}/payers/${e}`).json()}function Ug(e,t,n){return Uu.get(`https://www.bandlab.com/api/v1.3/checkout/products/${e}/payment-providers/${t}/payment-intents/${n}`).json()}function Fg(){if(Zg()){if(Jf||Xf)return"apple-app-store";if(Yf)return"google-play-store"}return"paddle"}function Bg(e){return Uu.get(`https://www.bandlab.com/api/v1.3/users/${e}/payment-methods`).json()}function Wg(e){return Uu.get(`https://www.bandlab.com/api/v1.3/users/${e}/payout-methods/tipalti/balance`).json()}function Vg(e){return Uu.get(`https://www.bandlab.com/api/v1.3/users/${e}/tipalti-balance/tracks`).json()}function qg(e,t){return Uu.get(`https://www.bandlab.com/api/v1.3/users/${e}/payout-methods/tipalti/payouts`,{searchParams:{...t?{from:t}:{}}}).json()}function zg(e,t){return Uu.get(`https://www.bandlab.com/api/v1.3/users/${e}/payout-methods/tipalti/payouts/${t}/tracks`).json()}function Hg(e){return Uu.delete(`https://www.bandlab.com/api/v1.3/users/${e}/membership`).then((()=>Qg(e,!0)))}function Gg(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fallbackToFree:!1,useCache:!1};return Uu.get(`https://www.bandlab.com/api/v1.3/users/${e}/membership`,{kyCache:t.useCache}).json().then(ev).catch((function(e){if(t.fallbackToFree)return ev({plan:"Free"});throw e}))}function Kg(e){return Uu.get(`https://www.bandlab.com/api/v1.3/users/${e}/membership-status`).json()}function Yg(e){return Uu.post(`https://www.bandlab.com/api/v1.3/users/${e}/membership/campaigns`).json()}function Jg(e){return Uu.delete(`https://www.bandlab.com/api/v1.3/users/${e}/membership/campaigns`)}function Xg(e){return Uu.get(`${Eg}/users/${e}/wallets`).json().then((e=>{let{data:t}=e;return t})).catch((()=>[]))}function Zg(){const e=l.get("X-Client-Version");return!!p()&&Cg(e,"10.56.1",10560100)}function Qg(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&(ql.membershipRefreshing=Date.now()),Nu.delete(`https://www.bandlab.com/api/v1.3/users/${e}/membership`),Gg(e,{useCache:!0})}function ev(e){return Object.assign(Ig,e),Promise.resolve().then((()=>Ap)).then((function(t){let{setUserProperty:n}=t;n("last_polled_membership_status","Free"===e.plan?"Free":e.isTrial?"Trial":"Paid")})),Ig}const tv=Object.freeze(Object.defineProperty({__proto__:null,confirmProductProviderPaymentIntent:Og,createIntent:Ag,createPayer:jg,createProductProviderPaymentByIntent:xg,createProductProviderPaymentIntent:Lg,createUserMembershipCampaigns:Yg,deletePayer:Dg,deleteUserMembership:Hg,deleteUserMembershipCampaigns:Jg,getPayerDetails:Ng,getPaymentIntentById:Ug,getPaymentProvider:Fg,getTipaltiBalance:Wg,getTipaltiBalanceBreakdownByTracks:Vg,getTipaltiFrameUrl:function(e,t){return Uu.get(`https://www.bandlab.com/api/v1.3/payments/users/${e}/payout-methods/tipalti/url?redirectto=${t}`).json()},getTipaltiPayoutBreakdownByTracks:zg,getTipaltiPayouts:qg,getUserAgreement:Rg,getUserMembership:Gg,getUserMembershipStatus:Kg,getUserPaymentMethods:Bg,getWallets:Xg,hasMobileNativeReusableFlow:Zg,membership:Ig,refreshMembership:Qg,setMembership:ev,trackActionsAndPromptTip:async function(e,t,n){let{entityId:o,user:r}=n;const i=e.get("Me"),{getAmplitudeFeatureFlag:a}=await Promise.resolve().then((()=>Ap));if(l.get("showLessTipPrompt")||!r.isTippable||r.id===i.id)return;const s=await a(i,"motivate-tipping"),c=new Set;let u,d;const p=t.$on("like",(function(e,t){let{commentId:n,creatorId:i,id:a,isLiked:s}=t;s&&!n&&(i===r.id&&c.add(a),a===o&&(u=!0),h())})),m=t.$on("$comment:changed",(function(e,t){let{action:n,entityId:r}=t;"create"===n&&o===r&&(d=!0,h())}));function f(){p(),m(),e.get("$rootScope").$broadcast("tipUserPrompt:hide")}function h(){let t;switch(s){case"variant-1":t=c.size>=3;break;case"variant-2":t=u&&d;break;case"variant-3":t=u}t&&(f(),e.get("$rootScope").$broadcast("tipUserPrompt:show",{variant:s,user:r}),Promise.resolve().then((()=>Ap)).then((function(e){let{logEvent:t}=e;t("tipjar_prompt_open")})))}t.$on("$destroy",(function(){f()}))},updateTipaltiPayeeDetails:function(e){return Uu.post(`${Eg}/users/${e}/payout-methods/tipalti/payee-details`).json()}},Symbol.toStringTag,{value:"Module"})),nv=Ac((async function(){await hp.get("allowBranch");const{default:e}=await import("./chunk-50722183.js").then((e=>e.b));return new Promise((function(t,n){e.init("key_live_ehsesnU0bA7gPKMU4HxpdgklyrdigCGX",{},(function(o){return o?n(o):t(e)}))}))}));function ov(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return nv().then((function(n){return n.logEvent(e,{...t})})).catch((()=>{}))}const rv=Object.freeze(Object.defineProperty({__proto__:null,logEvent:ov,setIdentity:function(e){return nv().then((function(t){return new Promise((function(n,o){t.setIdentity(e.id,(function(e,t){return e?o(e):n(t)}))}))}))}},Symbol.toStringTag,{value:"Module"}));async function iv(){return await hp.get("allowBraze"),import("./chunk-f3513797.js")}const av={};async function sv(e,t){return(await av.promise).logCustomEvent(e,t)}av.promise=new Promise((function(e){av.resolve=e}));const lv=Object.freeze(Object.defineProperty({__proto__:null,destroyBraze:async function(){(await iv()).destroy()},getContentCards:async function(e){return(await av.promise).getCachedContentCards().cards.filter((t=>t.extras.placement===e))},logCardClick:async function(e){(await av.promise).logCardClick(e,!0)},logCardImpressions:async function(e){(await av.promise).logCardImpressions(e,!0)},logCustomEvent:sv,refreshContentCards:async function(){const e=await av.promise;return new Promise((function(t,n){e.requestContentCardsRefresh(t,n)}))},startSession:async function(e){const t=await iv();t.initialize("c6f4ad64-9704-46af-94be-3f420cee3a5c",{allowUserSuppliedJavascript:!0,baseUrl:"sdk.iad-06.braze.com",manageServiceWorkerExternally:!0,safariWebsitePushId:"web.com.bandlab.bandlab-prod"}),t.changeUser(e.id),t.requestPushPermission(),t.removeAllSubscriptions(),t.subscribeToInAppMessage((function(e){if(!p()||e.extras.webview)if(e.extras.parentElementId){const n=document.createElement("div");n.id=e.extras.parentElementId,document.body.appendChild(n),t.showInAppMessage(e,n,(()=>{const t=n.querySelector("iframe"),o=t.contentDocument.querySelector(".modal");function r(e){t.style.height=`${e.detail}px`}t.style.height=`${o.scrollHeight}px`,document.addEventListener("iFrameHeightEvent",r),e.subscribeToDismissedEvent((()=>{document.removeEventListener("iFrameHeightEvent",r),document.body.removeChild(n)}))}))}else t.showInAppMessage(e)})),t.requestContentCardsRefresh(),t.openSession(),av.resolve(t)}},Symbol.toStringTag,{value:"Module"})),cv=Ac((async function(){const{initializeApp:e}=await import("./chunk-324ac75c.js").then((e=>e.j));return e({apiKey:"AIzaSyC3sJmNbyj8_iSeBxu3mQPWZQApKrjIi6Q",authDomain:"bandlab-web.firebaseapp.com",databaseURL:"https://bandlab-web.firebaseio.com",projectId:"bandlab-web",storageBucket:"bandlab-web.appspot.com",messagingSenderId:"976411153779",appId:"1:976411153779:web:721220a204a9a1aafce106",measurementId:"G-FH1GTMTL3J"})})),uv=Ac((async function(){const{getAnalytics:e,isSupported:t}=await import("./chunk-98e1cc00.js");return await t()?e(await cv()):Promise.reject()})),dv=Ac((async function(){const{getRemoteConfig:e,fetchAndActivate:t,isSupported:n}=await import("./chunk-b0e56b14.js");if(await n()){const n=e(await cv());return await t(n),n}return Promise.reject()})),pv=Ac((function(e){return Promise.all([import("./chunk-b0e56b14.js"),dv()]).then((function(t){let[{getValue:n},o]=t;return e in ql?ql[e]:n(o,e).asString()})).then((function(e){try{return JSON.parse(e)}catch{return e}}))}));function mv(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Promise.all([import("./chunk-98e1cc00.js"),uv()]).then((n=>{let[{logEvent:o},r]=n;return o(r,e,t)})).catch((()=>{}))}const fv=Object.freeze(Object.defineProperty({__proto__:null,getFirebaseRemoteConfigValue:pv,logEvent:mv,setUserProperties:function(e){return Promise.all([import("./chunk-98e1cc00.js"),uv()]).then((t=>{let[{setUserId:n},o]=t;return n(o,e.id)})).catch((()=>{}))}},Symbol.toStringTag,{value:"Module"}));function hv(e,t){switch(!0){case t&&!!t[0].closest("album-track-tile"):return"album_track";case e.includes("userAlbum"):return"album_page_header";case e.includes("explore"):return"explore_album_tile";case e.includes("feed.following"):return"following";case e.includes("feed.forYou"):return"for_you";case e.includes("feed.trending"):return"trending";case e.includes("user.albums"):return"user_profile_albums";case e.includes("user.feed"):return"user_profile_activity";default:return"other"}}function gv(){const e="artist_services_dashboard_open";$p(e),sv(e),mv(e)}function vv(e){let{bandId:t}=e;const n="band_page_banner_published",o={band_id:t};$p(n,o),sv(n,o),mv(n,o)}function bv(e){let{bandId:t,isBandMember:n}=e;const o="band_page_open",r={band_id:t,is_band_member:n};$p(o,r),mv(o,r)}function yv(e){let{bandId:t,triggeredFrom:n}=e;const o="band_follow",r={band_id:t,triggered_from:n};$p(o,r),mv(o,r)}function wv(e){const t="boost_insights_open",n={content_type:e};$p(t,n),sv(t,n),mv(t,n)}function $v(e){const t="boost_post_start",n={triggered_from:e};$p(t,n),ov(t,n),sv(t,n),mv(t,n)}function kv(e,t,n){const o="boost_post_details_confirm",r={budget:e,duration:t,...n&&{discount_price:n}};$p(o,r),sv(o,r),mv(o,r)}function Sv(){const e="gift_start";$p(e),mv(e),sv(e)}function _v(e){const t="creator_connect_settings_open",n={triggered_from:e};$p(t,n),sv(t,n),mv(t,n)}function Pv(){mv("effects_preset_fav_filter_select")}function Mv(e){mv("effects_preset_library_category_select",{category:e})}function Tv(e){const t="explore_clickthrough",n={triggered_from:e,...arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}};$p(t,n),sv(t,n),mv(t,n)}function Cv(e){let{sortBy:t,genre:n,timeframe:o,forksOnly:r}=e;const i="explore_tracks_filter_apply",a={sort_by:{trending:"trending",inspiring:"most_forked",recent:"recent"}[t],genre:n,timeframe:{week:"this_week",month:"this_month"}[o],forks_only:r};$p(i,a),sv(i,a),mv(i,a)}function Ev(){const e="follower_section_view";$p(e),sv(e),mv(e)}function Iv(e){const t="mastering_import";$p(t,e),mv(t,e)}function Rv(e){const t="mastering_download";$p(t,e),mv(t,e),ov(t,e)}function Av(e,t,n){const o="post_share",r={destination:t,post_creator_user_id:e.creator.id,post_id:e.postId??e.id,post_type:e.type?.toLowerCase()??e.post?.type?.toLowerCase()??"revision",post_visibility:e.state?.toLowerCase()??e.post?.state?.toLowerCase()??(e.isPublic?"public":"private"),trending_post_type:e.trendingPostType??e.post?.trendingPostType,triggered_from:n};$p(o,r),mv(o,r)}function xv(){$p("profile_boost_pause")}function Lv(e){const t="achievement_label_clickthrough";$p(t,e),sv(t,e),mv(t,e)}function Ov(){mv("chat_read_status_open")}function jv(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const o={chat_message_type:function(e){return e.repliedMessage?"replies":e.animation?"gif":e.links?.length?"link":"Image"===e.attachments?.[0].type||"Video"===e.attachments?.[0].type?"gallery_attachment":"Audio"===e.attachments?.[0].type?"audio_attachment":e.reaction?"emoji":"text"}(e),triggered_from:function(e,t){return t||(!0===e.includes("mixEditor")?"studio":"chat")}(t,n)};mv("chat_send_message",o);const r="daily_chat_send_message";Nv(r)||($p(r,o),sv(r,o))}function Dv(e){$p("chat_share_fork_open",{triggered_from:e})}function Nv(e){const t=new Date,n=`${t.getUTCMonth()}${t.getUTCDate()}`,o=ql[e]===n;return ql[e]=n,o}function Uv(e){const t="project_invitation_link_open",n={triggered_from:e};$p(t,n),mv(t,n)}function Fv(e){const t="promote_campaign_create",n={};e&&(n.triggered_from=e),$p(t,n),mv(t,n)}function Bv(e,t){const n="promote_campaign_post_select",o={post_id:e,triggered_from:t};$p(n,o),sv(n,o),mv(n,o)}function Wv(e){const t="promote_campaign_destination_select",n={destination:e};$p(t,n),mv(t,n)}function Vv(e,t){const n="promote_campaign_budget_confirm",o={budget_usd_cents:e*t,duration_days:t};$p(n,o),mv(n,o)}function qv(){mv("studio_guided_onboarding_start")}function zv(){mv("studio_guided_onboarding_finish")}function Hv(){mv("me_add_drum_machine_track")}function Gv(e){mv("me_region_actions",{action:e})}function Kv(e,t){const n="user_profile_open",o={profile_user_id:e.id,triggered_from:t};mv(n,o),$p(n,o),sv(n,o)}function Yv(){const e="user_profile_banner_cta_click";mv(e),$p(e),sv(e)}function Jv(){const e="user_profile_banner_publish";mv(e),$p(e),sv(e)}function Xv(e){const t="user_profile_picture_add_start",n={triggered_from:e};mv(t,n),$p(t,n),sv(t,n)}function Zv(e,t){const n="user_profile_picture_publish",o={triggered_from:e,num_profile_pictures:t};mv(n,o),$p(n,o),sv(n,o)}function Qv(e){mv("studio_smart_view",{enabled:e})}function eb(e){let{postCreatorUserId:t,postId:n,emoji:o,postType:r,postVisibility:i,triggeredFrom:a,trendingPostType:s,isLike:l=!1}=e;const c=l?"post_like":"post_reaction_send",u={post_creator_user_id:t,post_id:n,post_type:r.toLowerCase(),post_visibility:i.toLowerCase(),triggered_from:a,trending_post_type:s};l||(u.emoji=o),mv(c,u),$p(c,u)}function tb(e){let{postCreatorUserId:t,postId:n}=e;mv("post_reaction_menu_open",{post_creator_user_id:t,post_id:n})}function nb(e){let{postCreatorUserId:t,postId:n}=e;mv("post_reaction_list_open",{post_creator_user_id:t,post_id:n})}function ob(e){const t="track_publish_pop_up_open",n={triggered_from:e};mv(t,n),$p(t,n)}const rb=Object.freeze(Object.defineProperty({__proto__:null,logAchievementLabelClickthrough:Lv,logAddDrumMachineTrack:Hv,logAlbumComment:function(e){const t="album_comment",n={is_reply:e.isReply,album_creator_user_id:e.entityCreatorId,album_id:e.entityId};$p(t,n),mv(t,n)},logAlbumPlay:function(e,t){const n="album_play",o={triggered_from:hv(e,t)};$p(n,o),mv(n,o)},logArtistServicesDashboardOpen:gv,logBandCreate:function(e){let{bandId:t}=e;const n="band_create",o={band_id:t};$p(n,o),sv(n,o),mv(n,o)},logBandFollow:yv,logBandJoin:function(e){let{bandId:t}=e;const n="band_join",o={band_id:t};$p(n,o),sv(n,o),mv(n,o)},logBandPageBannerPublished:vv,logBandPageOpen:bv,logBandRequestAccept:function(e){let{bandId:t}=e;const n="band_request_accept",o={band_id:t};$p(n,o),sv(n,o),mv(n,o)},logBlsoundsInstrumentSelect:function(e){const t="blsounds_instrument_select",n={name:e.name,slug:e.slug,synth_type:e.synth};$p(t,n),sv(t,n),mv(t,n)},logBoostInsightsOpen:wv,logBoostPostDetailsConfirm:kv,logBoostPostStart:$v,logBoostRatingTriggered:function(){const e="boost_satisfaction_triggered";$p(e),sv(e)},logCampaignBoostAgain:function(){const e="promote_campaign_boost_again";$p(e),sv(e),mv(e)},logChatAttachmentDownload:function(e){mv("chat_attachment_download",{attachement_type:{Audio:"audio",Image:"gallery",Video:"gallery"}[e.attachments[0].type]})},logChatInviteToBand:function(){const e="chat_invite_to_band";$p(e),mv(e)},logChatOpen:function(){const e="chat_open";Nv(e)||($p(e),mv(e))},logChatProjectInvitationSend:function(){const e="chat_project_invitation_send";$p(e),mv(e)},logChatReadStatusOpen:Ov,logChatSendMessage:jv,logChatShareForkOpen:Dv,logChatStudioAudioImport:function(){const e="chat_studio_audio_import";$p(e),mv(e),sv(e)},logCheckoutOpen:function(e,t,n,o,r,i){const a="checkout_open",s={content_id:o,product_attribution:n?"deeplink":t,product_attribution_group:n?"marketing":i,product_id:e,source:n,triggered_from:r};$p(a,s),sv(a,s),mv(a,s)},logCheckoutPaymentError:function(e,t,n,o){$p("checkout_payment_error",{content_id:o,product_id:e,reason:t,step:n})},logCommunityCreate:function(){const e="community_create";$p(e),sv(e),mv(e)},logCommunityInvitationSend:function(){const e="community_invitation_send";$p(e),sv(e),mv(e)},logCommunityJoin:function(){const e="community_join";$p(e),sv(e),mv(e)},logCreatorConnectFindTalentsOpen:function(e){const t="creator_connect_find_talents_open",n={triggered_from:e};$p(t,n),sv(t,n),mv(t,n)},logCreatorConnectSettingsOpen:_v,logCreatorConnectSettingsUpdate:function(e,t,n,o){const r="creator_connect_settings_update",i={collab_status:e,triggered_from:t,my_preferences_changed:n,looking_for_changed:o};$p(r,i),sv(r,i),mv(r,i)},logDailyOpen:function(){const e="daily_open";Nv(e)||($p(e),sv(e))},logDistroLandingPageOpen:function(){mv("distro_landing_page_open")},logDistroLpDashboardOpen:function(){const e="distro_lp_dashboard_open";$p(e),mv(e)},logDistroRating:function(e){const t="distro_rating";$p(t,e),mv(t,e)},logDistroReleaseComplete:function(e){const t="distro_release_complete",n={release_id:e,package:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"solo_release",num_tracks:arguments.length>2&&void 0!==arguments[2]?arguments[2]:1};$p(t,n),sv(t,n),mv(t,n)},logDistroReleaseDismiss:function(e){const t="distro_release_dismiss",n={state:e};$p(t,n),sv(t,n),mv(t,n)},logDistroReleaseStart:function(){const e="distro_release_start",t={num_tracks:arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,triggered_from:arguments.length>1&&void 0!==arguments[1]?arguments[1]:""};$p(e,t),sv(e,t),mv(e,t)},logDuplicateSong:function(e){$p("revision_duplicate",e)},logEarningsOpen:function(){const e="earnings_open";$p(e),sv(e)},logEarningsTracksBreakdownOpen:function(){const e="earnings_tracks_breakdown_open";$p(e),sv(e)},logEffectsPresetCreate:function(e){const t="effects_preset_create";$p(t,e),sv(t,e),mv(t,e)},logEffectsPresetFavFilterSelect:Pv,logEffectsPresetLibraryCategorySelect:Mv,logEffectsPresetLinkOpen:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"add_to_library";const n="effects_preset_link_open",o={author_user_id:e.attributors[0].userId,open_destination:t,preset_id:e.id,parent_preset_id:e.savedFromPresetId};$p(n,o),sv(n,o),mv(n,o)},logEffectsSelect:function(e){const t="me_fx_effect_select";sv(t,e),mv(t,e)},logExploreClickthrough:Tv,logExploreOpen:function(){mv("explore_open")},logExploreTracksFilterApply:Cv,logFanReachActivate:function(){const e="fan_reach_activate";$p(e),sv(e),mv(e),kp("fan_reach_activated",!0)},logFanReachCampaignCreate:function(e){const t="fan_reach_campaign_create",n={campaign_type:{Track:"new_track",Text:"custom_message",Album:"new_album"}[e.type]};$p(t,n),sv(t,n),mv(t,n)},logFanReachCampaignSend:function(e){const t="fan_reach_campaign_send",n={campaign_type:{Track:"new_track",Text:"custom_message",Album:"new_album"}[e.type]};$p(t,n),sv(t,n),mv(t,n)},logFanReachSubscribe:function(e){const t="fan_reach_subscribe",n={artist_user_id:e.id};$p(t,n),sv(t,n),mv(t,n)},logFeedTabOpen:function(e){const t="feed_tab_open",n=_p(e),o={triggered_from:{feed:"following"}[n]??n};$p(t,o),mv(t,o)},logFeedTenthPostView:function(e){const t="feed_tenth_post_view",n=_p(e),o={triggered_from:{feed:"following"}[n]??n};$p(t,o),mv(t,o)},logFeedThirdPostView:function(e){const t="feed_third_post_view",n=_p(e),o={triggered_from:{feed:"following"}[n]??n};$p(t,o),mv(t,o)},logFollowerSectionView:Ev,logForceSignOut:function(){mv("force_sign_out",{success:!0})},logGiftStart:Sv,logInspiredByArtistAdd:function(e,t){const n="inspired_by_artist_add",o=e.map((e=>e.id)),r={artists:e.map((e=>e.name)),artist_ids:o,triggered_from:t};$p(n,r),mv(n,r)},logInspiredByOpen:function(e){const t="inspired_by_open",n={triggered_from:e};$p(t,n),mv(t,n)},logMainOnboardingComplete:function(){const e="main_onboarding_complete";$p(e),sv(e),mv(e)},logMarketingBannerCardTap:function(e){const t="marketing_banner_card_tap",n={url:e};$p(t,n),sv(t,n),mv(t,n)},logMasteringDownload:Rv,logMasteringImport:Iv,logMeAutoPitchOpen:function(){sv("me_auto_pitch_open")},logMeMidiDeviceConnect:function(e){mv("me_midi_device_connect",{device_name:e})},logMeMixerActions:function(e){mv("me_mixer_actions",{action:e})},logMembershipPaywallModalOpen:function(){let e=arguments.length>1?arguments[1]:void 0;const t="membership_paywall_modal_open",n={content_id:arguments.length>2?arguments[2]:void 0,product_attribution:e?"deeplink":arguments.length>0&&void 0!==arguments[0]?arguments[0]:"boost_profile",product_attribution_group:e?"marketing":arguments.length>3?arguments[3]:void 0,source:e};$p(t,n),ov(t,n),sv(t,n),mv(t,n)},logMixEditorOpen:function(e){const t="mix_editor_open",n=e;Sp("num of me open"),$p(t,n),sv(t,n),mv(t,n)},logPlaylistCreate:function(e,t){const n="playlist_create",o={is_public:e,triggered_from:t};$p(n,o),mv(n,o)},logPlaylistLike:function(e,t,n){const o="playlist_like",r={playlist_creator_user_id:t,playlist_id:e,triggered_from:n};$p(o,r),mv(o,r)},logPlaylistShare:function(e,t,n){const o="playlist_share",r={destination:t,playlist_creator_user_id:e.creator.id,playlist_id:e.id,triggered_from:n};$p(o,r),mv(o,r)},logPostComment:function(e){const t="post_comment",n={is_reply:e.isReply,post_creator_user_id:e.entityCreatorId,post_id:e.entityId,post_type:e.extra.post_type,post_visibility:e.extra.post_visibility,triggered_from:e.extra.triggered_from,trending_post_type:e.extra.trending_post_type};void 0===n.trending_post_type&&delete n.trending_post_type,$p(t,n),mv(t,n)},logPostCreate:function(e){const t="post_create";$p(t,e),sv(t,e),mv(t,e)},logPostImpression:function(e,t){e.state&&mv("post_impression",{post_creator_user_id:e.creator.id,post_id:e.id,post_type:(e.type||e.attachment.type).toLowerCase(),post_visibility:e.state.toLowerCase(),triggered_from:t})},logPostReactionListOpen:nb,logPostReactionMenuOpen:tb,logPostReactionSend:eb,logPostShare:Av,logProfileBoostPause:xv,logProjectInvitationLinkOpen:Uv,logPromoteBudgetConfirm:Vv,logPromoteCampaignCreate:Fv,logPromoteDestinationSelect:Wv,logPromotePostSelect:Bv,logRefreshTokenFailed:function(e){mv("refresh_token_failed",{success:!1,details:e.status})},logRegionActions:Gv,logRevisionCreate:function(e){const t="revision_create";$p(t,e),ov(t,e),sv(t,e),mv(t,["created_from","effects_used","has_parent","is_fork","is_in_band_project","is_published","mastering_preset","num_collaborators","num_total_tracks","original_project_id","project_id","revision_id","traceability_project_origin","triggered_from"].reduce(((t,n)=>(n in e&&(t[n]="effect_used"===n?function(e){const t=[];for(const n of e){if(t.concat(n).join(",").length>100)return t;t.push(n)}return t}(e[n]):e[n]),t)),{}))},logRevisionCreateFailure:function(){mv("revision_create_failure")},logRevisionFork:function(e,t,n,o,r){const i="revision_fork",a={triggered_from:_p(r,o),original_post_id:t,original_revision_id:e,original_creator_user_id:n};$p(i,a),sv(i,a),mv(i,a)},logSearchCategoryOpen:function(e){mv("search_category_open",{content_type:e})},logSearchClickthrough:function(e,t){mv("search_clickthrough",{destination:e,position:t})},logSearchPerform:function(e){const t="search_perform",n={search_term:e};$p(t,n),sv(t,n),mv(t,n)},logSignUp:function(e,t){const n="sign_up",o={method:{Apple:"apple",Facebook:"facebook",Google:"google",Password:"email"}[t.label]||t.label,sign_up_source:l.get("signupSource")||"bandlab"};l.remove("signupSource"),$p(n,o),ov(n,o),sv(n,o),mv(n,o),(window.fbq||angular.noop)("trackCustom",e,t),(window.gtag||angular.noop)("event","conversion",{send_to:"AW-876226372/5MRUCN7pvZ0BEMTO6KED"}),(window.ttq?.track||angular.noop)("CompleteRegistration")},logSocialLinkAdd:function(e){const t="social_link_add",n={destination:e.toLowerCase()};$p(t,n),mv(t,n)},logSocialLinkVisit:function(e){let{triggeredFrom:t,destination:n,userId:o}=e;const r="social_link_visit",i={triggered_from:t,destination:n,source_user_id:o};$p(r,i),mv(r,i)},logSongTemplateFirstModify:function(){mv("song_template_first_modify")},logSongTemplateLoad:function(){mv("song_template_load")},logStudioAutokeyCancel:function(){mv("studio_autokey_cancel")},logStudioAutokeyComplete:function(e){mv("studio_autokey_complete",{key_detected:e})},logStudioAutokeyStart:function(e,t){mv("studio_autokey_start",{is_track_empty:e,triggered_from:t})},logStudioDeviceConnect:function(e){mv("studio_device_connect",{device:e,input:!0})},logStudioDrumMachinePatternSelect:function(e){mv("studio_drum_machine_pattern_select",{item_type:e})},logStudioGuidedOnboardingFinish:zv,logStudioGuidedOnboardingStart:qv,logStudioNewModalClose:function(){mv("studio_new_modal_close")},logStudioNewNotificationTry:function(){mv("studio_new_notification_try")},logStudioRating:function(e){const t="studio_rating";$p(t,e),sv(t,e),mv(t,e)},logStudioSmartView:Qv,logTrackPublishPopUpOpen:ob,logUserFollow:function(e,t){const n="user_follow",o={following_user_id:e,triggered_from:t};$p(n,o),sv(n,o),mv(n,o)},logUserProfileBannerCtaClick:Yv,logUserProfileBannerPublish:Jv,logUserProfileOpen:Kv,logUserProfilePictureAddStart:Xv,logUserProfilePicturePublish:Zv,logVideoPlayEvent:function(e,t){const n="video_play",o={post_creator_user_id:t.creator.id,triggered_from:_p(e)};$p(n,o),sv(n,o),mv(n,o)}},Symbol.toStringTag,{value:"Module"})),ib={__name:"ModalCloseButton",props:{color:{default:"transparent",validator:e=>["transparent","transparent-inverted","translucent","translucent-inverted","overlay"].includes(e)}},setup(e){const t=e;return(e,n)=>(si(),mi(qd,{"is-core-11":"",class:"ds-modal-close-button",size:"compact",color:t.color},null,8,["color"]))}},ab=Object.freeze(Object.defineProperty({__proto__:null,default:ib},Symbol.toStringTag,{value:"Module"})),sb=["width","height","aria-hidden"],lb=[bi("path",{fill:"currentColor","fill-rule":"evenodd",d:"m8.41 12 6.3 6.3-1.42 1.4L5.6 12l7.7-7.7 1.42 1.4z","clip-rule":"evenodd"},null,-1)],cb={__name:"chevron-left",props:{size:{type:Number,required:!0}},setup:e=>(t,n)=>(si(),pi("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none","aria-hidden":t.$attrs["aria-label"]||t.$attrs["aria-labelledby"]?null:"true"},lb,8,sb))},ub=Object.freeze(Object.defineProperty({__proto__:null,default:cb},Symbol.toStringTag,{value:"Module"})),db=["width","height","aria-hidden"],pb=[bi("path",{fill:"currentColor","fill-rule":"evenodd",d:"m14.59 12-6.3-6.3 1.42-1.4 7.7 7.7-7.7 7.7-1.42-1.4z","clip-rule":"evenodd"},null,-1)],mb={__name:"chevron-right",props:{size:{type:Number,required:!0}},setup:e=>(t,n)=>(si(),pi("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none","aria-hidden":t.$attrs["aria-label"]||t.$attrs["aria-labelledby"]?null:"true"},pb,8,db))},fb=Object.freeze(Object.defineProperty({__proto__:null,default:mb},Symbol.toStringTag,{value:"Module"})),hb=["disabled"],gb=["srcset","data-id"],vb=["disabled"],bb={key:2,class:"carousel-counter-label typography-footnote-regular"},yb={__name:"UserCounterCarousel",props:{carouselItems:{type:Array,default:()=>[]},isContinuous:{type:Boolean,default:!0},displayCounter:{type:Boolean,default:!0}},emits:["update:activeImageId"],setup(e,t){let{emit:n}=t;const o=e,r=Vt(0),i=n,a=Gi((()=>r.value<o.carouselItems.length-1)),s=Gi((()=>r.value>0));function l(){r.value<o.carouselItems.length-1?r.value++:o.isContinuous&&(r.value=0)}function c(){r.value>0?r.value--:o.isContinuous&&(r.value=o.carouselItems.length-1)}function u(e){"ArrowLeft"===e.key?c():"ArrowRight"===e.key&&l()}return Lr(r,(e=>{o.carouselItems[e]&&i("update:activeImageId",o.carouselItems[e].pictureId)})),Lr((()=>o.carouselItems),(()=>{r.value=0}),{deep:!0}),(t,n)=>e.carouselItems.length?(si(),pi("div",{key:0,class:"carousel-counter-container",tabindex:"0",onKeydown:u},[e.carouselItems.length>1?(si(),pi("button",{key:0,type:"button",class:"carousel-counter-button carousel-counter-button-left",disabled:!s.value&&!o.isContinuous,onClick:c},[yi(cb,{size:32})],8,hb)):_i("v-if",!0),(si(!0),pi(ti,null,So(e.carouselItems,((e,t)=>(si(),pi("div",{key:t,class:ae(["carousel-counter-item",{active:t===r.value}])},[bi("img",{class:"carousel-counter-image",srcset:`${e.originalUrl}500x500 1x, ${e.originalUrl}1000x1000 2x`,"data-id":e.pictureId,alt:"Profile picture"},null,8,gb)],2)))),128)),e.carouselItems.length>1?(si(),pi("button",{key:1,type:"button",class:"carousel-counter-button carousel-counter-button-right",disabled:!a.value&&!o.isContinuous,onClick:l},[yi(mb,{size:32})],8,vb)):_i("v-if",!0),e.displayCounter?(si(),pi("div",bb,me(`${r.value+1} of ${e.carouselItems.length}`),1)):_i("v-if",!0)],32)):_i("v-if",!0)}},wb=["width","height","aria-hidden"],$b=[bi("path",{fill:"currentColor",d:"M11 13v8h2v-8h8v-2h-8V3h-2v8H3v2z"},null,-1)],kb={__name:"plus",props:{size:{type:Number,required:!0}},setup:e=>(t,n)=>(si(),pi("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none","aria-hidden":t.$attrs["aria-label"]||t.$attrs["aria-labelledby"]?null:"true"},$b,8,wb))},Sb=Object.freeze(Object.defineProperty({__proto__:null,default:kb},Symbol.toStringTag,{value:"Module"})),_b=["width","height","aria-hidden"],Pb=[bi("path",{fill:"currentColor",d:"M11 8a2 2 0 1 1-4 0 2 2 0 0 1 4 0"},null,-1),bi("path",{fill:"currentColor",d:"M2 6a4 4 0 0 1 4-4h12a4 4 0 0 1 4 4v12a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4zm18 0a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v6.7l4.32 2.2 7.05-5.68a1 1 0 0 1 1.19-.05L20 11.5zM4 18c0 1.1.9 2 2 2h12a2 2 0 0 0 2-2v-4.1l-3.95-2.66-6.98 5.63a1 1 0 0 1-1.08.11L4 14.95z"},null,-1)],Mb={__name:"image",props:{size:{type:Number,required:!0}},setup:e=>(t,n)=>(si(),pi("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none","aria-hidden":t.$attrs["aria-label"]||t.$attrs["aria-labelledby"]?null:"true"},Pb,8,_b))},Tb=Object.freeze(Object.defineProperty({__proto__:null,default:Mb},Symbol.toStringTag,{value:"Module"})),Cb=["width","height","aria-hidden"],Eb=[bi("path",{fill:"currentColor","fill-rule":"evenodd",d:"M12.93 1.63a1 1 0 0 0-1.86 0L8.51 8l-6.85.46a1 1 0 0 0-.57 1.77l5.27 4.4-1.68 6.66a1 1 0 0 0 1.5 1.1L12 18.72l5.82 3.65a1 1 0 0 0 1.5-1.09l-1.68-6.66 5.27-4.4a1 1 0 0 0-.57-1.77L15.49 8zm-2.8 7.7L12 4.68l1.87 4.65a1 1 0 0 0 .86.62l4.99.34-3.84 3.21a1 1 0 0 0-.33 1.01l1.22 4.86-4.24-2.66a1 1 0 0 0-1.06 0l-4.24 2.66 1.22-4.86a1 1 0 0 0-.33-1l-3.84-3.22 5-.34a1 1 0 0 0 .85-.62","clip-rule":"evenodd"},null,-1)],Ib={__name:"star-favorite",props:{size:{type:Number,required:!0}},setup:e=>(t,n)=>(si(),pi("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none","aria-hidden":t.$attrs["aria-label"]||t.$attrs["aria-labelledby"]?null:"true"},Eb,8,Cb))},Rb=Object.freeze(Object.defineProperty({__proto__:null,default:Ib},Symbol.toStringTag,{value:"Module"})),Ab=["width","height","aria-hidden"],xb=[bi("path",{fill:"currentColor",d:"M12.93 1.63a1 1 0 0 0-1.86 0L8.51 8l-6.85.46a1 1 0 0 0-.57 1.77l5.27 4.4-1.68 6.66a1 1 0 0 0 1.5 1.1L12 18.72l5.82 3.65a1 1 0 0 0 1.5-1.09l-1.68-6.66 5.27-4.4a1 1 0 0 0-.57-1.77L15.49 8z"},null,-1)],Lb={__name:"star-favorite-filled",props:{size:{type:Number,required:!0}},setup:e=>(t,n)=>(si(),pi("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none","aria-hidden":t.$attrs["aria-label"]||t.$attrs["aria-labelledby"]?null:"true"},xb,8,Ab))},Ob=Object.freeze(Object.defineProperty({__proto__:null,default:Lb},Symbol.toStringTag,{value:"Module"})),jb=["width","height","aria-hidden"],Db=[bi("path",{fill:"currentColor",d:"M20 4h-7V2h-2v2H4v2h16zM5.45 20.07 5 8h2l.45 12h9.07L17 8h2l-.48 12.07a2 2 0 0 1-2 1.93H7.45a2 2 0 0 1-2-1.93"},null,-1),bi("path",{fill:"currentColor",d:"M9 17V8h2v9zm4-9v9h2V8z"},null,-1)],Nb={__name:"trash",props:{size:{type:Number,required:!0}},setup:e=>(t,n)=>(si(),pi("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none","aria-hidden":t.$attrs["aria-label"]||t.$attrs["aria-labelledby"]?null:"true"},Db,8,jb))},Ub=Object.freeze(Object.defineProperty({__proto__:null,default:Nb},Symbol.toStringTag,{value:"Module"})),Fb={components:{Button:Dd,IconImage:Mb,IconPlus:kb,IconStar:Ib,IconStarFilled:Lb,IconTrash:Nb,ModalCloseButton:ib,UserCounterCarousel:yb},props:{user:{type:Object,required:!0},isOwnProfile:{type:Boolean,default:!1,required:!0},triggeredFrom:{type:String,required:!0}},emits:["closeModal"],setup(e,t){let{emit:n}=t;const o=zn((()=>import("./chunk-dc8b6311.js"))),r=Zo("$injector"),i=r.get("$rootScope"),a=r.get("AppNotifications"),s=r.get("Me"),l=r.get("Modal"),c=r.get("User"),u=Vt(null),d=Vt(!0),p=Vt(null),m=Vt([]),f=Gi((()=>p.value&&"Free"!==p.value.plan)),h=Gi((()=>u.value===m.value[0].pictureId)),g=i.$on("$user:changed",(function(e,t){let{action:n}=t;"profilePicture"===n&&v()}));function v(){return d.value=!0,c.getProfilePictures({userId:e.user.id}).$promise.then((e=>{m.value=e,u.value=m.value[0].pictureId,d.value=!1}))}function b(){c.deleteProfilePicture({userId:e.user.id,pictureId:u.value}).$promise.then((()=>{i.$broadcast("profilePictureModal:updated"),v()}))}function y(){new l({id:"pictureUploadSuccess",templateUrl:"https://www.bandlab.com/web-app/account/settings/partials/_picture-upload-4824490a.html",contentScope:{hasMembership:f.value,me:s,multipleProfilePicsEnabled:!0,profilePictures:m.value,replacePictureId:u.value,triggeredFrom:e.triggeredFrom}}).show()}function w(){new l({id:"paywallModal",templateUrl:"https://www.bandlab.com/web-app/membership/partials/_paywall-modal-ee6789e7.html",contentScope:{productAttribution:"profile_picture",productAttributionGroup:"misc"}}).show()}return ao((()=>{Gg(e.user.id,{useCache:!0}).then((function(e){p.value=e})).then((()=>{v()})).then((()=>{d.value=!1,m.value.length>0&&(u.value=m.value[0].pictureId)}))})),uo((()=>{g()})),{closeModal:function(){n("closeModal"),i.$broadcast("profilePictureModal:closed")},deleteProfilePicture:b,getUserProfilePictures:v,handleAddPictureButtonClick:function(){Xv(e.triggeredFrom),f.value?y():w()},makeMainPicture:function(){d.value=!0,c.setProfilePictureAsMain({userId:e.user.id,pictureId:u.value}).$promise.then((()=>{i.$broadcast("profilePictureModal:updated"),v(),a.addNotification({title:"Set As Main",classList:"success",autoclose:5e3})}))},openDeleteModal:function(){_g(o,{userId:e.user.id,pictureId:u.value,deleteProfilePicture:b})},openUploadPictureModal:y,showPaywallModal:w,activeImageId:u,hasMembership:f,isFirstPictureActive:h,loadingCarousel:d,Me:s,profilePictures:m}}},Bb={style:{height:"500px"}},Wb={key:0,class:"loader-spinner user-profile-pictures-modal-loader"},Vb={key:0,class:"ds-modal-footer user-profile-pictures-modal-footer"},qb={key:0},zb={key:1,class:"tooltip-opener"},Hb={key:0,class:"tooltip align-left below",style:{top:"50px",width:"160px"}},Gb={class:"tooltip-text",style:{"text-align":"center","white-space":"normal"}},Kb={key:2,class:"tooltip-opener"},Yb={key:1,class:"tooltip align-left below",style:{top:"50px",width:"160px"}},Jb={class:"tooltip-text",style:{"text-align":"center","white-space":"normal"}},Xb=ld(Fb,[["render",function(e,t,n,o,r,i){const a=vo("ModalCloseButton"),s=vo("UserCounterCarousel"),l=vo("IconTrash"),c=vo("Button"),u=vo("IconStarFilled"),d=vo("IconStar"),p=vo("IconImage"),m=vo("IconPlus");return si(),pi("div",{class:"ds-modal user-profile-pictures-modal",style:te({"padding-bottom":n.isOwnProfile?"":"0"})},[yi(a,{color:"overlay",onClick:t[0]||(t[0]=e=>o.closeModal())}),bi("div",Bb,[o.loadingCarousel?(si(),pi("div",Wb)):_i("v-if",!0),o.loadingCarousel?_i("v-if",!0):(si(),mi(s,{key:1,"carousel-items":o.profilePictures,class:ae({"user-own-profile-carousel":n.isOwnProfile}),"onUpdate:activeImageId":t[1]||(t[1]=e=>o.activeImageId=e)},null,8,["carousel-items","class"]))]),n.isOwnProfile?(si(),pi("footer",Vb,[o.hasMembership?(si(),pi("div",qb,[o.profilePictures.length>1?(si(),mi(c,{key:0,type:"button",size:"medium",color:"red-secondary",padding:"default",style:{"margin-right":"8px"},"is-disabled":o.loadingCarousel,onClick:t[2]||(t[2]=e=>o.openDeleteModal())},{"leading-icon":Tn((e=>{let{class:t}=e;return[yi(l,{size:20,class:ae(t)},null,8,["class"])]})),_:1},8,["is-disabled"])):_i("v-if",!0),o.profilePictures.length>1?(si(),mi(c,{key:1,type:"button",size:"medium",color:"secondary",padding:"default","is-disabled":o.isFirstPictureActive||o.loadingCarousel,onClick:t[3]||(t[3]=e=>o.makeMainPicture())},{"leading-icon":Tn((e=>{let{class:t}=e;return[o.isFirstPictureActive?(si(),mi(u,{key:0,size:20,class:ae(t)},null,8,["class"])):(si(),mi(d,{key:1,size:20,class:ae(t)},null,8,["class"]))]})),_:1},8,["is-disabled"])):_i("v-if",!0)])):_i("v-if",!0),!o.hasMembership||o.hasMembership&&5===o.profilePictures.length?(si(),pi("div",zb,[yi(c,{type:"button",size:"medium",color:"secondary",padding:"default","is-disabled":o.loadingCarousel,onClick:t[4]||(t[4]=e=>o.openUploadPictureModal())},{"leading-icon":Tn((e=>{let{class:t}=e;return[yi(p,{size:16,class:ae(t)},null,8,["class"])]})),default:Tn((()=>[ki(" "+me("Replace"),1)])),_:1},8,["is-disabled"]),o.hasMembership&&5===o.profilePictures.length?(si(),pi("div",Hb,[bi("span",Gb,me("You have reached the limit. Replace or Delete and upload a new photo."),1)])):_i("v-if",!0)])):_i("v-if",!0),!o.hasMembership||o.hasMembership&&o.profilePictures.length<5?(si(),pi("div",Kb,[o.profilePictures.length<5?(si(),mi(c,{key:0,type:"button",size:"medium",color:"primary",padding:"default",disabled:o.loadingCarousel,onClick:t[5]||(t[5]=e=>o.handleAddPictureButtonClick())},{"leading-icon":Tn((e=>{let{class:t}=e;return[yi(m,{size:16,class:ae(t)},null,8,["class"])]})),default:Tn((()=>[ki(" "+me(5-o.profilePictures.length+" more"),1)])),_:1},8,["disabled"])):_i("v-if",!0),o.hasMembership?_i("v-if",!0):(si(),pi("div",Yb,[bi("span",Jb,me("Add multiple profile photos with BandLab Membership"),1)]))])):_i("v-if",!0)])):_i("v-if",!0)],4)}]]);function Zb(e){document.querySelector('meta[name="twitter:title"]').setAttribute("content",e),document.querySelector('meta[property="og:title"]').setAttribute("content",e),document.title=e}function Qb(e){document.querySelector('meta[name="description"]').setAttribute("content",e),document.querySelector('meta[name="twitter:description"]').setAttribute("content",e),document.querySelector('meta[property="og:description"]').setAttribute("content",e)}function ey(e,t,n,o,r){document.querySelector('meta[name="twitter:image"]').setAttribute("content",e),document.querySelector('meta[property="og:image"]').setAttribute("content",e),document.querySelector('meta[property="og:image:width"]').setAttribute("content",t),document.querySelector('meta[property="og:image:height"]').setAttribute("content",n),document.querySelector('meta[property="og:image:type"]').setAttribute("content",o),document.querySelector('meta[property="og:type"]').setAttribute("content",r)}function ty(e){document.querySelector('meta[name="twitter:card"]').setAttribute("content",e)}angular.module("bandlab.account.settings").controller("ProfileEditCtrl",["$rootScope","$scope","$state","AppNotifications","authService","Identity","Me","Modal","Tag","User",function(e,t,n,o,r,i,a,s,c,u){t.changeSuccess=!1,t.changeError=!1,t.user=new i,t.user.name=a.name,t.user.gender=a.gender,t.user.birthday=a.birthday,t.user.about=a.about,t.user.place=a.place,t.user.links={...a.links},t.maxBirthday=(new Date).toDateString(),t.instagram=`https://api.instagram.com/oauth/authorize?client_id=429753317964981&redirect_uri=https://accounts.bandlab.com/oauth/instagram&response_type=code&scope=user_profile&state=${btoa(JSON.stringify({nonce:m(),url:"https://www.bandlab.com/auth/instagram/callback"}))}`,t.user.inspiredBy=[...a.inspiredBy],t.disconnectProfile=function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];n.forEach((e=>{delete t.user.links[e]})),new i({links:t.user.links}).$update().then((function(e){r.setMe(e)}))},t.displayProfilePictures=function(){_g(Xb,{user:a,isOwnProfile:!0,triggeredFrom:"settings"})},Mp(a,"soundcloud-social-link").then((e=>{t.hasSoundcloud="true"===e})),Mp(a,"tiktok-social-link").then((e=>{t.hasTiktok="true"===e})),Mp(a,"le_multiple_profile_pics_enabled").then((e=>{t.multipleProfilePicsEnabled="true"===e})),Kg(a.id).then((e=>{t.hasMembership=e.isActive})),p(),async function(){const{codeVerifier:e,codeChallenge:n}=await bg(),o=btoa(m());l.set("airbitState",o),l.set("airbitCodeVerifier",e),t.airbit=`https://accounts.airbit.com/oauth/authorize?client_id=bandlab&response_type=code&code_challenge_method=S256&redirect_uri=https://www.bandlab.com/auth/airbit/callback&code_challenge=${n}&state=${o}`}();const d=e.$on("$user:changed",(function(e,n){let{action:o}=n;"profilePicture"===o&&(p(),t.me.picture.isDefault=!1)}));function p(){u.getProfilePictures({userId:a.id}).$promise.then((e=>{t.profilePictures=e}))}t.connectSoundcloud=async function(){const{token:e}=await $g(),t=n.href("oauthSoundcloudCallback",{},{absolute:!0});window.location.href=`https://accounts.bandlab.com/oauth/soundcloud/connect?token=${e}&clientUrl=${t}`},t.connectTiktok=async function(){const{token:e}=await $g(),t=n.href("oauthTiktokCallback",{},{absolute:!0});window.location.href=`https://accounts.bandlab.com/oauth/tiktok/connect?token=${e}&clientUrl=${t}`},this.uiCanExit=function(e){return t.profileForm.$dirty?new Promise((function(t){const n=new s({toFocusConfirm:!0,contentScope:{leave:function(){n.destroy(),t(e)}},onCancel:function(){n.destroy(),t(!1)},templateUrl:"https://www.bandlab.com/web-app/account/settings/partials/_profile-leave-confirm-fc21fe6e.html"});n.show()})):e},c.getSkills().then((function(e){t.skills=_.map(e,(function(e){return e.isSelected=_.some(a.skills,{id:e.id}),e}))})),c.getGenres().then((function(e){t.genres=_.map(e,(function(e){return e.isSelected=_.some(a.genres,{id:e.id}),e}))})),t.$watch("user.inspiredBy",(function(e,n){gf(e.map((e=>e.id)),n.map((e=>e.id)))||t.profileForm.$setDirty()}),!0),t.editMe=function(){t.changeError=!1,t.user.genres=_.filter(t.genres,{isSelected:!0}),t.user.skills=_.filter(t.skills,{isSelected:!0}),t.user.links=Object.keys(t.user.links).reduce((function(e,n){var o;return"website"===n?e[n]=t.user.links[n]:t.user.links[n]&&(e[n]=function(e){if(e.includes("https://www.instagram.com/")||e.includes("https://www.airbit.com/"))return e;e.startsWith("http://")||e.startsWith("https://")||(e=`https://${e}`);let{origin:t,pathname:n}=new URL(e);if(n=decodeURI(n),e=t,t.includes("youtube")||t.includes("spotify")){const[t,o,r,i]=n.split("/");e+=[t,o,r,...i?[i]:[]].join("/").replace(/\/$/,"")}if(t.includes("soundcloud")){const[t,o]=n.split("/");e+=[t,o].join("/")}if(t.includes("tiktok")){const[t,o,r="",i="",a=""]=n.split("/");e+=""===r?[t,o].join("/"):[t,o,r,i,a].join("/").replace(/\/$/,"")}return e.replace("http://","https://").replace("//youtube.com/","//www.youtube.com/").replace("//www.soundcloud.com/","//soundcloud.com/").replace("//m.soundcloud.com/","//soundcloud.com/")}(t.user.links[n])),e[n]&&t.profileForm[n]?.$dirty&&(o=n,Promise.resolve().then((()=>rb)).then((function(e){let{logSocialLinkAdd:t}=e;t(o)}))),e}),{});const e=Object.keys(t.user).filter((function(e){return["genres","skills","inspiredBy"].includes(e)?(n=a[e],o=t.user[e],!(n.length===o.length&&n.every((e=>o.some((t=>e.id===t.id)))))):!angular.equals(t.user[e],a[e]);var n,o})).reduce((function(e,n){return e[n]=t.user[n],e}),{});return i.update(e).$promise.then((function(e){let{...a}=e;r.setMe(a).then((function(){r.identifyUserForTrackers(a)})),t.changeSuccess=!0,!a.ftue.setInspiredBy&&a.inspiredBy.length&&i.setInspiredBy(),o.addNotification({title:"Profile updated",action:`<a class="button-scd button-height-32 button-padding-16 button-rounded" href="${n.href("user.feed",{username:a.username})}"><i class="icon-arrow-right"></i></a>`,classList:"success",autoclose:8e3}),t.profileForm.$setPristine()})).catch((function(e){t.profileForm.$setPristine(),t.changeError=e||!0}))},t.trimLink=function(e,n){e.srcElement.value=t.user.links[n]??e.srcElement.value},t.removeInspireByArtist=function(e){Gf(t.user.inspiredBy,e)},t.$on("$destroy",(function(){d()}))}]),angular.module("bandlab.user").component("completeProfileCard",{templateUrl:"https://www.bandlab.com/web-app/account/settings/partials/_complete-profile-card-9bc9b24f.html",controller:["$rootScope","$scope","$element","authService","Identity","Me",function(e,t,n,o,r,i){var a=this;a.STEPS_TO_COMPLETE=4,t.user=new r;const s=[...i.inspiredBy];function l(){r.setInspiredBy().$promise.then((function(){a.me.ftue.setInspiredBy=!0,a.achievementsCount=c(a.me),o.setMe(a.me),e.$broadcast("$user:relationChanged",{user:a.me})}))}function c(e){return e.ftue.confirmedEmail+e.ftue.setCustomUsername+e.ftue.setPicture+a.filledInspiredBy}t.user.inspiredBy=[...i.inspiredBy],a.achievementsCount=0,a.me=i,a.filledInspiredBy=a.me.ftue.setInspiredBy||!!i.inspiredBy?.length,a.achievementsCount=c(a.me),a.achievementsCount===a.STEPS_TO_COMPLETE?n.remove():(a.me.ftue.confirmedEmail||(a.resendEmailConfirmation=function(){r.resendEmailConfirmation().$promise.then((function(){a.emailConfirmationRequestSent=!0}))}),a.logAddArtistsClicked=function(){Promise.resolve().then((()=>rb)).then((function(e){let{logInspiredByOpen:t}=e;t("user_profile")}))},a.submitInspiredBy=function(){const n=t.user.inspiredBy.filter((e=>!s.find((t=>t.id===e.id))));n.length&&new r({inspiredBy:t.user.inspiredBy}).$update().then((function(t){r.setInspiredBy().$promise.then((function(){e.$broadcast("$user:relationChanged",{user:t})})),a.filledInspiredBy=a.me.ftue.setInspiredBy||!!i.inspiredBy?.length,a.achievementsCount=c(t),o.setMe(t),Promise.resolve().then((()=>rb)).then((function(e){let{logInspiredByArtistAdd:t}=e;t(n,"user_profile")}))})),l()},e.$on("$inspiredBy:update",(()=>{l()})))}],controllerAs:"vm"}),angular.module("bandlab.account.settings").component("authorizedAppTile",{bindings:{app:"=",revoke:"&"},templateUrl:"https://www.bandlab.com/web-app/account/settings/partials/_authorized-app-tile-b60ec7b4.html",controllerAs:"vm"}),angular.module("bandlab.account.settings").directive("settingsProfileLinkCell",["$injector",function(e){return{restrict:"E",replace:!0,scope:{type:"@",connect:"&?",connectUrl:"<?",link:"<?",unverifiedLink:"<?",disconnect:"&"},link:function(t,n){const o=Mt({type:t.type,connect:t.connect,connectUrl:t.connectUrl,link:t.link,unverifiedLink:t.unverifiedLink,disconnect:t.disconnect});t.$watch((function(e){const{link:t,unverifiedLink:n}=e;o.link=t,o.unverifiedLink=n}),!0);const r=import("./chunk-8585ef6c.js").then((r=>{let{mount:i}=r;return i(n[0],{$injector:e,scope:t},o)}));t.$on("$destroy",(async function(){(await r).unmount()}))}}}]),angular.module("bandlab.account.settings.routes",["ui.router"]).config(["$stateProvider",function(e){e.state("settings",{url:"/settings",redirectTo:"settings.profile",templateUrl:"https://www.bandlab.com/web-app/account/settings/views/settings-layout-51e54820.html",controller:["$scope","Me",function(e,t){e.me=t,e.logCreatorConnectSettingsOpen=_v}]}).state("settings.deactivate",{url:"/account/delete",templateUrl:"https://www.bandlab.com/web-app/account/settings/views/account-delete-74e2486c.html"}).state("settings.account",{url:"/account",templateUrl:"https://www.bandlab.com/web-app/account/settings/views/account-edit-c5586881.html",controller:"AccountEditCtrl",resolve:{templates:["$templateCache","$templateRequest","$q",function(e,t,n){return n.all([t("https://www.bandlab.com/web-app/account/settings/partials/_email-change-ca7aaf93.html"),t("https://www.bandlab.com/web-app/account/settings/partials/_password-change-02415242.html")]).then((function(t){t.forEach(e.put)})).catch((function(){}))}]}}).state("settings.security",{url:"/security/:modal",params:{modal:{value:null,dynamic:!0,squash:!0}},resolve:{twoFactorMethods:["Me",async function(e){const{getTwoFactorMethods:t}=await import("./chunk-7b8afd53.js");return t(e.id)}]},template:'<div id="settingsSecurityVue"></div>',controller:["AppNotifications","Me","Modal","twoFactorMethods","$rootScope","$scope","$state","$stateParams",function(e,t,n,o,r,i,a,s){function l(){return new Promise((e=>{new n({id:"setupEmailPasswordModal",templateUrl:"https://www.bandlab.com/web-app/account/settings/partials/_setup-email-password-form-e168d189.html",contentScope:{me:t},onDestroy:e}).show()}))}import("./chunk-a6e48af6.js").then((function(n){let{mountSettingsSecurity:c}=n;const u=c(document.querySelector("#settingsSecurityVue"),{AppNotifications:e,Me:t,$rootScope:r,$scope:i,$state:a,$stateParams:s,setupEmailPassword:l,twoFactorMethods:o});i.$on("$destroy",(function(){u.unmount()}))}))}]}).state("settings.privacy",{url:"/privacy",resolve:{chatPrivacy:["Settings",function(e){return e.getPrivacySettings({service:"chat"}).$promise.then((function(e){let{allowMessagesFrom:t}=e;return t}))}],commentsPrivacy:["Settings",function(e){return e.getPrivacySettings({service:"comments"}).$promise.then((function(e){let{allowCommentsFrom:t}=e;return t}))}],invitesPrivacy:["Settings",function(e){return e.getPrivacySettings({service:"invites"}).$promise.then((function(e){let{allowInvitesFrom:t}=e;return t}))}]},templateUrl:"https://www.bandlab.com/web-app/account/settings/views/privacy-edit-47a9c719.html",controller:"PrivacyCtrl"}).state("settings.linkedAccounts",{url:"/linked-accounts",templateUrl:"https://www.bandlab.com/web-app/account/settings/views/linked-accounts-edit-722cdfdf.html",controller:"LinkedAccountsEditCtrl"}).state("settings.profile",{url:"/profile?focus",templateUrl:"https://www.bandlab.com/web-app/account/settings/views/profile-edit-6ebf1dfd.html",controller:"ProfileEditCtrl"}).state("settings.links`",{url:"/social-links/:sns",resolve:{redirect:["$stateParams",function(e){return new Promise((function(){switch(e.sns){case"instagram":window.location.href=`https://api.instagram.com/oauth/authorize?client_id=429753317964981&redirect_uri=https://accounts.bandlab.com/oauth/instagram&response_type=code&scope=user_profile&state=${btoa(JSON.stringify({nonce:m(),url:"https://www.bandlab.com/auth/instagram/callback"}))}`;break;case"airbit":!async function(){const{codeVerifier:e,codeChallenge:t}=await bg(),n=btoa(m());l.set("airbitState",n),l.set("airbitCodeVerifier",e),window.location.href=`https://accounts.airbit.com/oauth/authorize?client_id=bandlab&response_type=code&code_challenge_method=S256&redirect_uri=https://www.bandlab.com/auth/airbit/callback&code_challenge=${t}&state=${n}${p()?"&gl=0":""}`}()}}))}]}}).state("settings.creatorConnect",{url:"/creator-connect",templateUrl:"https://www.bandlab.com/web-app/account/settings/views/creator-connect-edit-409f51cb.html",controller:"CreatorConnectEditCtrl"}).state("passwordReset",{url:"/reset-password",templateUrl:"https://www.bandlab.com/web-app/account/settings/views/password-reset-1a2a503e.html",controller:"PasswordResetCtrl"}).state("passwordRenew",{url:"/renew-password?userid&code",templateUrl:"https://www.bandlab.com/web-app/account/settings/views/password-renew-bcb27d73.html",controller:"PasswordRenewCtrl"}).state("settings.apps",{url:"/apps",templateUrl:"https://www.bandlab.com/web-app/account/settings/views/apps-permissions-12b204b8.html",controller:"AppsPermissionsCtrl"}).state("settings.notifications",{url:"/notifications",template:"<div></div>",controller:["$element","$scope","AppNotifications",function(e,t,n){import("./chunk-a6e48af6.js").then((function(o){let{mountSettingsNotifications:r}=o;const i=r(e[0],{AppNotifications:n});t.$on("$destroy",(function(){i.unmount()}))}))}]}).state("settings.tipJar",{url:"/tip-jar",redirectTo:"settings.payments"}).state("settings.membership",{url:"/membership",template:"<div></div>",controller:["$element","$injector","$scope","Modal",function(e,t,n,o){function r(){new o({id:"paywallModal",templateUrl:"https://www.bandlab.com/web-app/membership/partials/_paywall-modal-ee6789e7.html",contentScope:{product:"membership",productAttribution:"user_settings",productAttributionGroup:"misc"}}).show()}import("./chunk-a6e48af6.js").then((function(o){let{mountSettingsMembership:i}=o;const a=i(e[0],{$injector:t,openPaywallModal:r});n.$on("$destroy",(function(){a.unmount()}))}))}]}).state("settings.payments",{url:"/payments?success",templateUrl:"https://www.bandlab.com/web-app/account/settings/views/payments-edit-f3da8f12.html",resolve:{Payments:function(){return Promise.resolve().then((()=>tv))},thePayer:["Payments","Me",function(e,t){return e.getPayerDetails(t.id)}],Wallets:["Payments","Me",function(e,t){return e.getWallets(t.id)}]},controller:["$scope","$state","Me","thePayer","Wallets",function(e,t,n,o,r){e.closeTwoFactorBanner=function(){e.shouldShowTwoFactorBanner=!1,l.set("bannerTwoFactorSeen",!0)},e.isWebview=p(),e.stripeCard=o.stripeCard,e.stripeAccount=r.find((e=>"Stripe"===e.gateway)),e.tipaltiAccount=r.find((e=>"Tipalti"===e.gateway)),e.shouldShowTwoFactorBanner=!1,e.tipaltiAccount&&!l.get("bannerTwoFactorSeen")&&import("./chunk-7b8afd53.js").then((function(e){let{getTwoFactorMethods:t}=e;return t(n.id)})).then((function(t){let{isEnabled:n}=t;e.shouldShowTwoFactorBanner=!n}));const i=t.params["#"];i&&setTimeout((function(){document.getElementById(i).scrollIntoView({behavior:"smooth"})}),1e3)}]}).state("settings.requestVerifiedBadge",{url:"/request-verified-badge",templateUrl:"https://www.bandlab.com/web-app/account/settings/views/request-verified-badge-15f8c9ae.html",controller:["$http","$scope","Me",function(e,t,n){t.user={username:n.username,fullName:"",artistName:n.name,details:""},t.isVerified=n.isVerified,t.onSubmit=function(o){o.$submitted=!0;const r=new FormData;r.append("access_token",d()),r.append("artistName",t.user.artistName),r.append("fullName",t.user.fullName),r.append("username",t.user.username),r.append("category",t.user.category),r.append("videoFile",t.introVideo[0]),r.append("details",t.user.details),r.append("followers",n.counters.followers),e.post("https://verificator.bandlab.io/v1/add",r,{transformRequest:angular.identity,headers:{"Content-Type":void 0}}).then((function(e){return t.submitSuccess=!0,e})).catch((function(e){throw t.submitSuccess=!1,t.errorStatus=e.status,e})).finally((function(){o.$submitted=!1}))}}]}).state("settings.deletedProjects",{url:"/deleted-projects",redirectTo:{state:"library.projects.songs",params:{category:"deleted"}}}).state("settings.language",{url:"/language",templateUrl:"https://www.bandlab.com/web-app/account/settings/views/language-edit-00b9a958.html",controller:["$scope",function(e){e.language=l.get("language"),e.updateLanguage=function(){l.set("language",e.language,{expires:365,domain:"bandlab.com"}),location.reload()}}]})}]),angular.module("bandlab.account.signUp",["bandlab.account"]),angular.module("bandlab.account.signUp").controller("FormSignUpCtrl",["$rootScope","$scope","$stateParams","$timeout","authService","Me",function(e,t,n,o,r,i){t.credentials={birthday:null,email:n.email||"",name:n.name||"",password:"",provider:"password",referral:n.referral,rememberMe:!0},t.birthdayFormLink="https://help.bandlab.com/hc/en-us/articles/30748072567321-Why-does-BandLab-ask-you-for-your-date-of-birth",Mp(i,"age_restriction_enabled").then((e=>{t.ageRestrictionEnabled="true"===e,t.ageRestrictionEnabled&&(t.credentials.birthdayRequired=!0,l.set("birthdayRequired",!0,{expires:10/1440,domain:"bandlab.com"}),t.$applyAsync())})),t.maxBirthday=(new Date).toDateString(),t.signUp=function(n){return t.$emit("auth:start"),t.error="",o((function(){t.$emit("auth:error"),n.$setPristine(),n.$setDirty()}),5e3),import("./chunk-33d5c541.js").then((function(e){let{solveInvisibleCaptcha:t}=e;return t()})).then((function(e){let{xCaptchaResponse:o}=e;return t.$emit("auth:start"),n.$submitted=!0,t.credentials.birthday&&(t.credentials.birthday=t.credentials.birthday.toISOString().split("T")[0]),r.signUp(t.credentials,o)})).then((function(){r.redirectAfterSignUp()})).catch((async function(o){if(t.$emit("auth:error"),n.$setPristine(),n.$setDirty(),[400,401].includes(o?.response?.status)){const{errorCode:n,message:r}=await o.response.json();t.error=400===n?"other":188===n?"age":"credentials","age"===t.error&&(l.set("ageRestricted",!0),e.$broadcast("ageRestrictedError")),t.message=r}else"Cancel"!==o?.message&&alert("Something went wrong, please try again later")}))}}]),angular.module("bandlab.account.signUp.routes",["ui.router"]).config(["$stateProvider",function(e){e.state("signUp",{url:"/sign-up?invitation&email&name&redirect&sender-id",templateUrl:"https://www.bandlab.com/web-app/account/signUp/views/sign-up-37ed8594.html",controller:["$scope",function(e){e.title="Create an Account","true"===l.get("ageRestricted")&&(e.title="Sorry, but it looks like youre not eligible to use BandLab.")}],reloadOnChange:!1,resolve:{redirect:["$stateParams","authService",function(e,t){window.location.pathname.includes("/sounds/")?t.setAfterAuthState({toState:"sounds"}):e.redirect&&t.setAfterAuthState({toUrl:e.redirect})}]},onEnter:["$cookies","$state","$stateParams","AppNotifications",function(e,t,n,o){if(n.invitation)return n.invitation.match(/[a-zA-Z0-9-_]+/)?e.put("invitationKey",n.invitation):o.addNotification({title:"Invalid Invitation",classList:"alert",autoclose:5e3}),t.target("signUp",{},{inherit:!1})}]})}]),function(e){function t(e){var t=e.slice(9);return null!=t&&t.length>0?t.substring(0,1).toLowerCase()+t.substring(1):t}e.module("angulartics",[]).provider("$analytics",(function(){var t=this,n={},o={},r={},i={$get:["$injector",function(e){return a(e)}],api:r};var a=function(t){return e.extend(r,{$inject:t.invoke})};!function(a){for(var s in e.forEach(["pageTrack","eventTrack","setUsername","setUserProperties"],(function(t){var a="register"+t.replace(/^./,(function(e){return e.toUpperCase()}));i[a]=function(i,a){!function(t,i,a){r[t]=function(t,r,i){return n[t]||(n[t]=[]),n[t].push(r),o[r]=i,function(){var r=Array.prototype.slice.apply(arguments);return this.$inject(["$q",e.bind(this,(function(i){return i.all(n[t].map((function(t){if((o[t]||{}).async){var n=i.defer(),a=e.copy(r);return a.unshift(n.resolve),t.apply(this,a),n.promise}return i.when(t.apply(this,r))}),this))}))])}}(t,i,a)}(t,i,a)}})),a)t[s]=a[s]}(i)})).directive("analyticsOn",["$analytics",function(n){return{restrict:"A",link:function(o,r,i){var a=i.analyticsOn||"click",s={};e.forEach(i.$attr,(function(e,n){(function(e){return"analytics"===e.substr(0,9)&&-1===["On","Event","If","Properties","EventType"].indexOf(e.substr(9))})(n)&&(s[t(n)]=i[n],i.$observe(n,(function(e){s[t(n)]=e})))})),e.element(r[0]).on(a,(function(t){var r=i.analyticsEvent;s.eventType=t.type,i.analyticsIf&&!o.$eval(i.analyticsIf)||(i.analyticsProperties&&e.extend(s,o.$eval(i.analyticsProperties)),n.eventTrack(r,s))}))}}}])}(angular);const ny=function(){return Gl.Date.now()};var oy="Expected a function",ry=Math.max,iy=Math.min;function ay(e,t,n){var o,r,i,a,s,l,c=0,u=!1,d=!1,p=!0;if("function"!=typeof e)throw new TypeError(oy);function m(t){var n=o,i=r;return o=r=void 0,c=t,a=e.apply(i,n)}function f(e){var n=e-l;return void 0===l||n>=t||n<0||d&&e-c>=i}function h(){var e=ny();if(f(e))return g(e);s=setTimeout(h,function(e){var n=t-(e-l);return d?iy(n,i-(e-c)):n}(e))}function g(e){return s=void 0,p&&o?m(e):(o=r=void 0,a)}function v(){var e=ny(),n=f(e);if(o=arguments,r=this,l=e,n){if(void 0===s)return function(e){return c=e,s=setTimeout(h,t),u?m(e):a}(l);if(d)return clearTimeout(s),s=setTimeout(h,t),m(l)}return void 0===s&&(s=setTimeout(h,t)),a}return t=Qu(t)||0,rc(n)&&(u=!!n.leading,i=(d="maxWait"in n)?ry(Qu(n.maxWait)||0,t):i,p="trailing"in n?!!n.trailing:p),v.cancel=function(){void 0!==s&&clearTimeout(s),c=0,o=l=r=s=void 0},v.flush=function(){return void 0===s?a:g(ny())},v}var sy="Expected a function";function ly(e,t,n){var o=!0,r=!0;if("function"!=typeof e)throw new TypeError(sy);return rc(n)&&(o="leading"in n?!!n.leading:o,r="trailing"in n?!!n.trailing:r),ay(e,t,{leading:o,maxWait:t,trailing:r})}function cy(e,t,n,o,r,i,a,s){const{signup_source:c=l.get("signupSource")}=t.search();c&&l.set("signupSource",c);{const e=Math.ceil(11*Math.random());document.querySelector("main").classList.add(`main-landing-${e}`)}n.state=o,(u()||p())&&(document.body.classList.add("webview"),localStorage.privacyConsent=JSON.stringify({essential:!0,functionality:!0,analytics:!0,marketing:!0}));const m=ly((function(){document.body.classList.toggle("scrolled",window.scrollY>0),document.body.classList.contains("scrolled")&&document.body.classList.remove("was-scrolled")}),250,{leading:!1,trailing:!0});window.addEventListener("scroll",m,{passive:!0}),"IE"!==nh.browser.name&&"Safari"!==nh.browser.name&&"iOS"!==nh.os.name&&window.addEventListener("storage",(function(e){"membershipRefreshing"===e.key&&Qg(s.id)})),r.onSuccess({},(function(e){const t=e.from(),n=e.to();s.isAnonymous()?document.body.classList.add("user-anonymous"):document.body.classList.remove("user-anonymous"),t.name.endsWith(".shout")||t.name.includes("opportunities")&&n.name.endsWith("list")||t.name.startsWith("library")&&n.name.startsWith("library")&&n.params?.search||t.name.includes("tree")&&n.name.includes("Song")||t.name.includes("Song")&&n.name.includes("tree")||(document.body.scrollTop=document.documentElement.scrollTop=0)}));const f=r.onBefore({},(function(e){return f(),(window.fromAPI?.me?a.initSession(window.fromAPI.me):d()?a.refreshMe().then(a.initSession):(s.id=id,Ep(s),Promise.resolve())).then((()=>e))}));r.onStart({},(function(e){const t=e.to(),n={...e.params()},r=i.checkStateCompatibility(t);if(r)return o.target(r,{url:encodeURIComponent(o.href(t.name,n,{absolute:!0}))});const c=new Map([["joinProject","join_project"],["mastering","mastering"],["products.cakewalk","cakewalk"],["sounds","bl_sounds"],["splitter","splitter"],["songStarter","songstarter"],["distribution","distro"]]);c.has(t.name)&&l.set("signupSource",c.get(t.name));const u=new Set(["passwordRenew","passwordReset","0","403","404","500","useChrome","updateBrowser","projectFull","unavailable"]),p=e.from();if("login"===t.name&&p.name&&!u.has(p.name)){const t=e.params("from");a.setAfterAuthState({toState:p.name,toParams:t})}else if("logout"===t.name&&"sounds"===p.name){const t="redeem"!==e.params("from").path?e.params("from"):{};localStorage.setItem("redirectAfterLogout",o.href("sounds",t,{inherit:!1}))}return d()?Dc.has(t.name)?o.target(Oc,{username:s.username}):s.isOnboarded||u.has(t.name)||t.name===jc?void 0:(a.setAfterAuthState({toState:t.name,toParams:n}),o.target(jc)):Nc.has(t.name.split(".")[0])?(a.setAfterAuthState({toState:t.name,toParams:n}),o.target("login")):void 0})),r.onSuccess({},(function(n){const o=n.options(),r=n.params();if(o.notify)if(r.rewriteTracking){const n=r.rewriteTracking(t.url());e.pageTrack(n)}else e.pageTrack(t.url())})),o.defaultErrorHandler((function(e){if(!/supersed/.test(_.get(e,"message"))){switch(_.get(e,"detail.status")){case 404:return o.go("404",{},{location:"replace",custom:e.detail.data});case 403:case 500:return o.go(`${e.detail.status}`)}return o.go("0")}}))}cy.$inject=["$analytics","$location","$rootScope","$state","$transitions","appActions","authService","Me"],angular.module("bandlab.web",["ui.router","ngAnimate","ngResource","ngSanitize","monospaced.elastic","angulartics","bandlab.config","bandlab.account","bandlab.account.login","bandlab.account.settings","bandlab.account.signUp","bandlab.album","bandlab.audio","bandlab.band","bandlab.banner","bandlab.chat","bandlab.collection","bandlab.comment","bandlab.common","bandlab.common.notification","bandlab.community","bandlab.distribution","bandlab.editor","bandlab.explore","bandlab.fanreach","bandlab.global","bandlab.library","bandlab.membership","bandlab.notification","bandlab.opportunities","bandlab.playbackhistory","bandlab.player","bandlab.post","bandlab.project","bandlab.profeedback","bandlab.promote","bandlab.search","bandlab.song","bandlab.shout","bandlab.track","bandlab.payment","bandlab.user","bandlab.global.redirects","bandlab.account.login.routes","bandlab.account.settings.routes","bandlab.account.signUp.routes","bandlab.show.routes","bandlab.audio.routes","bandlab.chat.routes","bandlab.collection.routes","bandlab.connect.routes","bandlab.editor.routes","bandlab.error.routes","bandlab.explore.routes","bandlab.global.routes","bandlab.payment.routes","bandlab.playbackhistory.routes","bandlab.product.routes","bandlab.library.routes","bandlab.opportunities.routes","bandlab.post.routes","bandlab.report.routes","bandlab.fanreach.routes","bandlab.search.routes","bandlab.user.routes","bandlab.band.routes","bandlab.community.routes","bandlab.song.routes","bandlab.album.routes","bandlab.beats.routes"]).factory("$cookies",(function(){return l})).run((function(){l.get("auid")||l.set("auid",ad(),{expires:365})})).run(cy),angular.module("bandlab.config",[]).config(Su),angular.element((function(){angular.bootstrap(document,["bandlab.web"])})),angular.module("bandlab.album",[]),angular.module("bandlab.album.routes",["ui.router"]).config(["$stateProvider",function(e){e.state("album",{url:"/album",redirectTo:"album.new"}).state("album.new",{url:"/new",resolve:{theAlbum:function(){return Promise.resolve()},theGenres:["Tag",function(e){return e.getGenres().catch((()=>[]))}]},controller:"AlbumInfoEditCtrl",templateUrl:"https://www.bandlab.com/web-app/album/views/album-info-817f1f38.html"}).state("album.create",{url:"/{albumId:[a-zA-Z0-9-_]+}",redirectTo:"album.create.info",resolve:{theAlbum:["$stateParams","Album",function(e,t){return e.albumId?t.get({id:e.albumId}).$promise:Promise.resolve()}],canEdit:["$q","theAlbum","Me",function(e,t,n){return t.creator.id===n.id?e.resolve(!0):e.reject({status:403})}],theGenres:["Tag",function(e){return e.getGenres().catch((()=>[]))}]},controller:["$scope",function(e){e.$on("Album:saving",(function(){e.saving=!0,e.saved=!1})),e.$on("Album:saveCompleted",(function(){e.saving=!1,e.saved=!0})),e.$on("Album:saveFailed",(function(){e.saving=!1,e.saved=!0}))}]}).state("album.create.info",{url:"/info",controller:"AlbumInfoEditCtrl",templateUrl:"https://www.bandlab.com/web-app/album/views/album-info-817f1f38.html"}).state("album.create.tracks",{url:"/tracks",controller:"AlbumTracksEditCtrl",templateUrl:"https://www.bandlab.com/web-app/album/views/album-tracks-b8dcf4e0.html"}).state("album.create.price",{url:"/price?tip&feedback",resolve:{Wallets:["Me",function(e){return Promise.resolve().then((()=>tv)).then((function(t){let{getWallets:n}=t;return n(e.id)}))}]},controller:"AlbumPriceEditCtrl",templateUrl:"https://www.bandlab.com/web-app/album/views/album-price-7ae83de1.html"}).state("album.edit",{url:"/{albumId:[a-zA-Z0-9-_]+}/edit",templateUrl:"https://www.bandlab.com/web-app/album/views/manage/album-manage-layout-2343cc2e.html",redirectTo:"album.edit.info",resolve:{theAlbum:["$stateParams","Album",function(e,t){return t.get({id:e.albumId}).$promise}],canEdit:["$q","theAlbum","Me",function(e,t,n){return t.creator.id===n.id?e.resolve(!0):e.reject({status:403})}],theGenres:["Tag",function(e){return e.getGenres().catch((()=>[]))}]},controller:["$scope","theAlbum",function(e,t){e.album=t,e.$on("$album:changed",(function(t,n){n.album.id===e.album.id&&"update"===n.action&&(e.album=n.album)}))}]}).state("album.edit.info",{url:"/info",templateUrl:"https://www.bandlab.com/web-app/album/views/manage/album-info-0f4f7a14.html",controller:"AlbumInfoEditCtrl"}).state("album.edit.tracks",{url:"/tracks",templateUrl:"https://www.bandlab.com/web-app/album/views/manage/album-tracks-67cd0474.html",controller:"AlbumTracksEditCtrl"}).state("album.edit.bonus",{url:"/bonus",templateUrl:"https://www.bandlab.com/web-app/album/views/manage/album-bonus-51db7767.html",resolve:{theAlbumAttachments:["Album","theAlbum",function(e,t){return e.attachments({id:t.id}).$promise}]},controller:"AlbumBonusEditCtrl"}).state("album.edit.price",{url:"/price?tip&feedback",resolve:{Wallets:["Me",function(e){return Promise.resolve().then((()=>tv)).then((function(t){let{getWallets:n}=t;return n(e.id)}))}]},templateUrl:"https://www.bandlab.com/web-app/album/views/manage/album-price-4cef42ea.html",controller:"AlbumPriceEditCtrl"}).state("albumId",{url:"/albums/{id:[a-zA-Z0-9-_]+}?commentId&replyId",redirectTo:function(e){const t=e.injector().get("$state");return e.injector().get("Album").get({id:e.params().id}).$promise.then((function(n){return t.target("userAlbum",{username:n.creator.username,id:n.id,commentId:e.params().commentId,replyId:e.params().replyId},{album:n})}))}}).state("userAlbum",{url:"/{username:[a-zA-Z0-9-_]+}/albums/{id:[a-zA-Z0-9-_]+}?commentId&replyId",params:{new:!1,commentId:{dynamic:!0,inherit:!1},replyId:{dynamic:!0,inherit:!1},rewriteTracking:function(){return()=>"/album/page"}},templateUrl:"https://www.bandlab.com/web-app/album/views/album-layout-68697680.html",resolve:{theAlbum:["$stateParams","$transition$","Album",function(e,t,n){const o=t.options();return o.album?o.album:n.get({id:e.id}).$promise}],theGenres:["Tag",function(e){return e.getGenres().catch((()=>[]))}],theUser:["$q","$stateParams","theAlbum",function(e,t,n){return n.creator.username!==t.username?e.reject({status:404}):n.artist}],Themes:["Album",function(e){return e.themes().$promise}]},onEnter:["Page","theAlbum",function(e,t){e.setMetadata({title:`${t.name} by ${t.creator.name} | BandLab`,description:(t.description?`${t.description} | `:"")+"Unlimited free listening on BandLab.",image:`${t.picture.url}360x360`,imageHeight:"360",imageWidth:"360"})}],onExit:["Page",function(e){e.clearMetadata()}],controller:"AlbumPageCtrl"}).state("albumTip",{url:"/{username:[a-zA-Z0-9-_]+}/albums/{id:[a-zA-Z0-9-_]+}/tipjar",redirectTo:function(e){return{state:"userTip",id:e.params().username}}}).state("albumTracks",{url:"/{username:[a-zA-Z0-9-_]+}/albums/{id:[a-zA-Z0-9-_]+}/tracks/{trackId:[a-zA-Z0-9-_]+}",redirectTo:function(e){return{state:"track",params:{id:e.params().trackId}}}})}]);const uy=[{name:"Album",id:"Album"},{name:"LP",id:"LP"},{name:"EP",id:"EP"},{name:"Single",id:"Single"},{name:"Mixtape",id:"Mixtape"}],dy=[{name:"JPG",mime:"image/jpeg",extension:".jpg",hasPreview:!0},{name:"PNG",mime:"image/png",extension:".png",hasPreview:!0},{name:"GIF",mime:"image/gif",extension:".gif",hasPreview:!0},{name:"MP3",mime:"audio/mpeg",extension:".mp3",hasPreview:!0},{name:"M4A",mime:"audio/m4a",extension:".m4a",hasPreview:!0},{name:"WAV",mime:"audio/wav",extension:".wav",hasPreview:!0},{name:"AAC",mime:"audio/aac",extension:".aac",hasPreview:!0},{name:"OGG",mime:"audio/ogg",extension:".ogg",hasPreview:!0},{name:"MP4",mime:"video/mp4",extension:".mp4",hasPreview:!0},{name:"AVI",mime:"video/x-msvideo",extension:".avi",hasPreview:!1},{name:"MOV",mime:"video/quicktime",extension:".mov",hasPreview:!0},{name:"FLV",mime:"video/x-flv",extension:".flv",hasPreview:!1},{name:"PDF",mime:"application/pdf",extension:".pdf",hasPreview:!1}];function py(e){let{rgb:t,hex:n,ratio:o}=e;return(t||_y(n)).map((e=>Math.max(0,Math.min(255,e+Math.round(255*o)))))}function my(e){let{rgb:t,hex:n,ratio:o}=e;return(t||_y(n)).map((e=>Math.max(0,Math.min(255,e+Math.round(o*e)))))}function fy(e){let[t,n,o]=e;return.299*t+.587*n+.114*o}function hy(e,t){let[n,o,r]=e,[i,a,s]=t;return Math.max(n,i)-Math.min(n,i)+(Math.max(o,a)-Math.min(o,a))+(Math.max(r,s)-Math.min(r,s))}async function gy(e){try{const[t,{default:n}]=await Promise.all([My(e),import("./chunk-7d5c09a7.js")]),o=new n;return[o.getColor(t),...o.getPalette(t)]}catch{return[1,2,3,4,5].map((()=>[255,255,255]))}}async function vy(e){return $y((await gy(e))[0])}function by(e){const t=Cy(e);return{name:"Monochrome",colors:Sy(Py({rgb:t[0]})?t.map(((e,t)=>py({rgb:e,ratio:-.15*t}))):t.map(((e,n)=>py({rgb:e,ratio:.15*(t.length-1-n)}))))}}function yy(e){return{name:"Bright",colors:Sy(Cy(e))}}function wy(e){return e.map(((t,n)=>({name:`Palette ${n+1}`,colors:Sy(Ey(t,e))})))}function $y(e){return{name:"Monochrome",colors:Sy(ky(e))}}function ky(e){const t=fy(e)>127.5?-1:1;return[py({rgb:e,ratio:.03*t}),py({rgb:e,ratio:.1*t}),py({rgb:e,ratio:.2*t}),py({rgb:e,ratio:.5*t}),py({rgb:e,ratio:.7*t})]}function Sy(e){const t=e.map((e=>Ty(e)));return{body:t[0],button:t[1],background:t[t.length-3],secondary:t[t.length-2],text:t[t.length-1]}}function _y(e){const t=e.replace(/#/g,"");return[parseInt(t.substring(0,2),16),parseInt(t.substring(2,4),16),parseInt(t.substring(4,6),16)]}function Py(e){let{rgb:t,hex:n}=e;return t?fy(t)>127:!!n&&fy(_y(n))>127}function My(e){const t=new Image;return t.src=e,t.crossOrigin="Anonymous",new Promise((function(e){if(t.complete)return e(t);t.addEventListener("load",(function(){return e(t)}),{once:!0})}))}function Ty(e){let[t,n,o]=e;const r=[t,n,o].map((e=>{const t=e.toString(16);return 1===t.length?`0${t}`:t})).join("");return`#${r}`}function Cy(e){return[...e].sort(((e,t)=>fy(t)-fy(e)))}function Ey(e,t){return[...t].sort(((t,n)=>hy(e,t)-hy(e,n)))}function Iy(e,t){const n=e.replace(/#/g,"");return`rgba(${parseInt(n.substring(0,2),16)}, ${parseInt(n.substring(2,4),16)}, ${parseInt(n.substring(4,6),16)}, ${t})`}angular.module("bandlab.album").controller("AlbumBonusEditCtrl",["$rootScope","$scope","$state","Album","Me","theAlbum","theAlbumAttachments",function(e,t,n,o,r,i,a){t.album=new o(i),t.me=r,t.deleteAttachment=function(n,r){n.stopPropagation(),e.$broadcast("Album:saving"),r.isDeleting=!0,o.deleteAttachment({id:t.album.id,attachmentId:r.attachmentId}).$promise.then((function(){e.$broadcast("Album:saveCompleted"),r.attachmentId?t.attachments=t.attachments.filter((e=>e.attachmentId!==r.attachmentId)):t.attachments=[]})).catch((function(t){e.$broadcast("Album:saveFailed")}))},t.downloadAttachment=function(e,n){e.stopPropagation(),o.downloadAttachment({id:t.album.id,attachmentId:n}).$promise.then((function(e){let{url:t}=e;angular.element(`<a href="${t}" target="_self"></a>`)[0].click()}))},t.toTracks=function(){n.go("album.create.tracks",{albumId:t.album.id})},t.toPrice=function(){n.go("album.create.price",{albumId:t.album.id})},t.toLibrary=function(){n.go("library.albums")},t.updateAttachmentOrder=function(e,n){o.updateAttachmentOrder({id:t.album.id,attachmentId:e,order:n})},t.getFileType=function(e){return dy.find((t=>t.mime===e))||{name:"zip",mime:"application/zip",extension:".zip",hasPreview:!1}},t.attachments=a,t.$on("Album:saving",(function(){t.saving=!0})),t.$on("Album:saveCompleted",(function(){t.saving=!1})),t.$on("Album:saveFailed",(function(){t.saving=!1})),t.$on("$albumAttachment:added",(function(e,n){t.attachments.push(n)}))}]),angular.module("bandlab.album").controller("AlbumCommentsCtrl",["$scope",function(e){e.commentFirstLoaded=!1,e.album.counters.comments<1&&(e.commentFirstLoaded=!0),e.updateCommentCounter=function(t){e.album.counters.comments=t(e.album.counters.comments)},e.$on("$comments:firstLoaded",(function(t,n){n===e.album.id&&(e.commentFirstLoaded=!0)}))}]),angular.module("bandlab.album").controller("AlbumDownloadCtrl",["$analytics","$http","$scope","$timeout","AppNotifications",function(e,t,n,o,r){n.selected={},n.isLoading=!1,n.isDone=!1,t.get(`https://www.bandlab.com/api/v1.3/albums/${n.album.id}/download-options`).then((function(e){let{data:t}=e;!function(e){[Zh,Jh,Xh].forEach((function(t){const n=e.find((e=>e.id===t.id));n&&Object.assign(n,t)}))}(t),n.options=t})),n.downloadAlbum=function(i){if(i.url)return angular.element(`<a href="${i.url}" target="_self"></a>`)[0].click(),n.isDone=!0,void o((function(){n.isDone=!1}),3e3);n.isLoading=!0,t.post(`https://www.bandlab.com/api/v1.3/albums/${n.album.id}/download-options/${i.id}`).then((function(){e.eventTrack("Download",{category:"Album",label:"Music Album"}),n.confirm(),r.addNotification({title:"Youre all set! We will email you the download link once its ready.",classList:"success",autoclose:8e3}),n.isLoading=!1,n.isDone=!0}))}}]),angular.module("bandlab.album").controller("AlbumEditCtrl",["$analytics","$rootScope","$scope","$state","$timeout","Album","AppNotifications","ConfirmModal","Modal",function(e,t,n,o,r,i,a,s,l){n.downloadAlbum=function(e){new l({templateUrl:"https://www.bandlab.com/web-app/album/partials/_album-download-40cb1d3a.html",contentScope:{album:e}}).show()},n.deleteAlbum=function(e){return new s({confirmLabel:"Delete",contentScope:{title:"Delete this album?",message:"<p>You wont be able to undo this action.</p>"},onConfirm:function(){t.$broadcast("$album:changed",{action:"mark-deleted",album:e}),(e=new i(e)).$delete().then((function(){t.$broadcast("$album:changed",{action:"deleted",album:e}),o.includes("userAlbum")&&r((()=>{o.go("library.albums")}),500)})).catch((n=>{t.$broadcast("$album:changed",{action:"unmark-deleted",album:e}),a.addNotification({title:"Cannot delete album",content:_.get(n,"data.message")||_.get(n,"message","Unknown error"),autoclose:5e3,classList:"alert"})}))}}).show()},n.publishAlbum=async function(n){if(!n.counters.posts)return a.addNotification({title:"Unable to publish album",content:"Albums must contain at least one track.",classList:"alert",autoclose:8e3});if(e.eventTrack("Publish Album",{category:"Album"}),n.isReleaseScheduled){const e=await function(e){return new Promise((function(t){new l({contentScope:{album:e},templateUrl:"https://www.bandlab.com/web-app/album/partials/_album-publish-scheduled-modal-b534bd9c.html",onConfirm:()=>t(!0),onCancel:()=>t(!1)}).show()}))}(n);if(!e)return}i.publish({id:n.id,state:"Released"}).$promise.then((function(){n.state="Released";const e=new Date;!n.isReleaseScheduled&&n.releaseDate||(n.releaseDate=`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}`),n.isReleaseScheduled=!1,n.isCommentingAllowed=!0,t.$broadcast("$album:changed",{action:"update",album:n}),Promise.all([Promise.resolve().then((()=>Ap)),Promise.resolve().then((()=>lv)),Promise.resolve().then((()=>fv))]).then((e=>{let[{logEvent:t},{logCustomEvent:o},{logEvent:r}]=e;t("album_publish",{album_id:n.id}),o("album_publish",{album_id:n.id}),r("album_publish",{album_id:n.id})}))}))},n.unpublishAlbum=function(e){i.publish({id:e.id,state:"Draft"}).$promise.then((function(){e.state="Draft",t.$broadcast("$album:changed",{action:"update",album:e})}))},n.deleteTrack=function(e){i.removePost({id:e.albumId,postId:e.id}).$promise.then((function(){o.go("userAlbum",{username:e.creator.username,id:e.albumId})}))}}]),angular.module("bandlab.album").controller("AlbumInfoEditCtrl",["$analytics","$rootScope","$scope","$state","$timeout","Album","AppNotifications","ConfirmModal","Me","Modal","theAlbum","theGenres",function(e,t,n,o,r,i,a,s,c,u,d,p){n.updateForm=async function(){let i,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;"library"!==s||n.album.name?(await new Promise((e=>{if(!f(n.album.releaseDate)||l.get("modalScheduledAlbumSeen"))return e();new u({templateUrl:"https://www.bandlab.com/web-app/album/partials/_album-scheduled-modal-3665a1cb.html",onConfirm:function(){l.set("modalScheduledAlbumSeen",!0)},onDestroy:e}).show()})),n.album.id?n.albumForm.$dirty?(i=n.album.$update(),n.albumForm.$setPristine()):i=Promise.resolve(n.album):i=n.album.$save().then((function(t){let{id:n}=t;return e.eventTrack("Create Album",{category:"Album"}),Promise.all([Promise.resolve().then((()=>Ap)),Promise.resolve().then((()=>lv)),Promise.resolve().then((()=>fv))]).then((e=>{let[{logEvent:t},{logCustomEvent:o},{logEvent:r}]=e;t("album_create",{album_id:n}),o("album_create",{album_id:n}),r("album_create",{album_id:n})})),gtag("event","conversion",{send_to:"AW-876226372/AXjmCPr_9NgBEMTO6KED"}),r((()=>{}),1e3)})),"album.create.info"!==o.current.name&&"album.new"!==o.current.name||!n.album.pictureId||(i=i.then(h)),i.then((function(e){"tracks"===s?o.go("album.create.tracks",{albumId:n.album.id},{reload:!0}):"library"===s?o.go("library.albums"):(t.$broadcast("$album:changed",{action:"update",album:e}),a.addNotification({title:"Album updated",action:`<a class="button-scd button-height-32 button-padding-16 button-rounded" href="${o.href("albumId",{username:c.username,id:e.id||n.album.id})}"><icon-svg name="arrow-right" size="16"></icon-svg></a>`,classList:"success",autoclose:8e3}))})).catch((function(e){n.albumForm.$setPristine(),a.addNotification({title:"Unable to create playlist",content:e.data.message,classList:"alert"})}))):o.go("library.albums")},n.deleteAlbum=function(){return new s({confirmLabel:"Delete",contentScope:{title:"Delete this album?",message:"<p>You wont be able to undo this action.</p>"},onConfirm:function(){t.$broadcast("$album:changed",{action:"mark-deleted",album:n.album}),n.album.$delete().then((function(){t.$broadcast("$album:changed",{action:"delete",album:n.album}),r((()=>{o.go("library.albums")}),500)})).catch((e=>{t.$broadcast("$album:changed",{action:"unmark-deleted",album:n.album}),a.addNotification({title:"Unable to delete album",content:_.get(e,"data.message")||_.get(e,"message","Unknown error"),autoclose:5e3,classList:"alert"})}))}}).show()},n.unpublishAlbum=function(e){n.isAlbumUpdating=!0,i.publish({id:e.id,state:"Draft"}).$promise.then((function(){n.isAlbumUpdating=!1,e.state="Draft",t.$broadcast("$album:changed",{action:"update",album:e})})).catch((function(){n.isAlbumUpdating=!1}))},n.genres=p,n.albumTypes=uy,n.isToday=function(e){const t=new Date(e);return m.getFullYear()===t.getUTCFullYear()&&m.getMonth()===t.getUTCMonth()&&m.getDate()===t.getUTCDate()},n.isFutureRelease=f,n.setReleaseToday=function(){n.album.releaseDate=`${m.getFullYear()}-${(m.getMonth()+1).toString().padStart(2,"0")}-${m.getDate().toString().padStart(2,"0")}`,n.albumForm.$setDirty()},n.isAlbumUpdating=!1;const m=new Date;function f(e){return new Date(e)>m}function h(){return n.album.themeId=null,Promise.all([n.album.$update(),vy(n.album.picture.url).then((function(e){return localStorage.setItem("customThemeType",n.customThemeType),i.updateTheme({id:n.album.id,colors:e.colors,current:{background:"Color"}})}))]).then((function(e){let[t]=e;return t}))}n.maxReleaseDate=`${m.getFullYear()+1}-${(m.getMonth()+1).toString().padStart(2,"0")}-${m.getDate().toString().padStart(2,"0")}`,n.album=new i(d||{state:"Draft",type:"Album",genreId:"other",isAutoRepostEnabled:!0}),n.$on("$file:uploadSuccess",(function(e,t){n.album.pictureId=t.id,n.album.picture=t,n.album.id&&i.picture({id:n.album.id,pictureId:t.id})}))}]),angular.module("bandlab.album").controller("AlbumLibraryCtrl",["$rootScope","$scope","Album","AppNotifications","Loader","Me","Post","ProjectUploader",function(e,t,n,o,r,i,a,s){const l=r.create(a.getTracksFromUser,{userId:i.id,limit:10});t.infiniteScrollEnded=!1,t.selectedProject=null,t.isMaximum=t.tracks.length+s.queue.length>=50,t.loadMore=function(){return l.get().then((function(e){return t.infiniteScrollEnded=e.length<10,t.projects=t.projects||[],t.projects=t.projects.concat(e),e}))},t.loadMore(),t.addToAlbum=function(r){t.isMaximum?o.addNotification({title:"Track couldnt be added",content:"This album has reached its limit of tracks (50).",classList:"alert",autoclose:8e3}):(e.$broadcast("Album:saving"),n.addPost({albumId:t.albumId,postId:r.id}).$promise.then((function(){t.isMaximum=t.tracks.length+s.queue.length+1>=50,r.isAdded=!0,t.$applyAsync(),e.$broadcast("$albumTrack:added",{post:r}),e.$broadcast("Album:saveCompleted")})).catch((function(t){e.$broadcast("Album:saveFailed"),t.data&&t.data.message?o.addNotification({title:t.data.message,classList:"alert",autoclose:8e3}):o.addNotification({title:"Track couldnt be added",classList:"alert",autoclose:8e3})})))},t.removeFromAlbum=function(o){return e.$broadcast("Album:saving"),n.removePost({id:t.albumId,postId:o.id}).$promise.then((function(){t.isMaximum=t.tracks.length+s.queue.length-1>=50,o.isAdded=!1,t.$applyAsync(),e.$broadcast("$albumTrack:deleted",o),e.$broadcast("Album:saveCompleted")})).catch((function(){e.$broadcast("Album:saveFailed")}))}}]),angular.module("bandlab.album").controller("AlbumPageCtrl",["$http","$injector","$rootScope","$scope","$state","$timeout","Album","appActions","AppNotifications","Me","Modal","theAlbum","theGenres","Themes","theUser","User",function(e,t,n,o,r,i,a,s,l,c,u,d,p,m,f,h){function g(e){return dy.find((t=>t.mime===e))||{name:"zip",mime:"application/zip",extension:".zip",hasPreview:!1}}function v(){let{commentId:e,replyId:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};new u({id:"albumCommentsModal",class:"album-comments-modal",templateUrl:"https://www.bandlab.com/web-app/album/partials/_album-comments-8f5152b8.html",contentScope:{album:o.album,commentId:e,replyId:t},onCancel:()=>{r.go("userAlbum",{username:d.creator.username,id:d.id},{notify:!1})},escapeClose:!1,overlayClose:!1}).show()}o.album=new a(d),o.editingPalette=!1,o.isFree="Free"===o.album.policy.pricingType,o.me=c,o.theUser=f,o.themes=m,o.closeThemePalette=function(){o.editingPalette=!1,document.body.classList.remove("album-palette-visible")},o.configureTipJar=function(){return new u({templateUrl:"https://www.bandlab.com/web-app/payment/partials/_see-tip-jar-modal-2d9c9a04.html"}).show()},o.downloadAlbum=function(){s.checkAllowed("download")&&o.album.permissions.download&&new u({templateUrl:"https://www.bandlab.com/web-app/album/partials/_album-download-40cb1d3a.html",contentScope:{album:o.album}}).show()},o.getFileType=g,o.getGenre=function(e){return p.find((t=>t.id===e))},o.getPostShareObject=function(e){return{...e,post:{...a.albumToPost(e),attachment:{object:e,type:"Album"}}}},o.getType=function(e){return uy.find((t=>t.id===e)).name},o.getLikers=function(e){return Object.assign(e,{entity:"albums",entityId:o.album.id}),h.likersWithCursor(e).$promise},o.hideHeader=function(){o.album.theme.isHeaderHidden=!0,a.updateTheme({id:o.album.id,...o.album.theme}),n.$broadcast("$album:changed",{action:"update",album:o.album})},o.openComments=v,o.openThemePalette=function(){o.editingPalette=!0,o.showCustomizeNotification=!1,localStorage.setItem("albumCustomizeClosed",!0),document.body.classList.add("album-palette-visible"),l.clearAll()},o.previewAttachment=function(e,t){if(!s.checkAllowed("download"))return;const r={attachment:e,index:t,type:g(e.type)};function i(e){switch(e.keyCode){case 37:l(r.index-1);break;case 39:l(r.index+1);break;case 27:n.$broadcast("previewAttachmentModal","close")}}function l(e){e>=0&&e<o.attachments.length&&(r.index=e,r.attachment=o.attachments[r.index],r.type=g(r.attachment.type),o.$applyAsync())}new u({id:"previewAttachmentModal",class:"album-attachment-modal",templateUrl:"https://www.bandlab.com/web-app/album/partials/_album-attachment-preview-e6dedc4b.html",contentScope:{album:o.album,preview:r,navigate:l,download:function(){var e;e=r.attachment.attachmentId,a.downloadAttachment({id:o.album.id,attachmentId:e}).$promise.then((function(e){let{url:t}=e;angular.element(`<a href="${t}" target="_self"></a>`)[0].click()}))},hasNext:function(){return r.index<o.attachments.length-1},hasPrev:function(){return r.index>0},getExtension:function(){return r.type.mime.split("/")[0]}},onCreate:function(){document.addEventListener("keydown",i)},onDestroy:function(){document.removeEventListener("keydown",i)}}).show()},o.supportArtist=function(){if(s.checkAllowed("tip"))return Promise.resolve().then((()=>Ap)).then((function(e){let{logEvent:t}=e;t("tipjar_send_tip_start")})),o.album.permissions.purchase?new u({id:"tipSetModal",template:'<tip-user-form user="user" album-id="albumId"></tip-user-form>',contentScope:{user:f,albumId:o.album.id}}).show():new u({id:"tipSetModal",template:'<tip-user-form user="user"></tip-user-form>',contentScope:{user:f}}).show()},function(){const n=o.album.permissions.edit&&!localStorage.getItem("albumCustomizeClosed");i((()=>{o.showCustomizeNotification=n}),1e3);const s=!n&&o.album.permissions.edit&&o.isFree&&!localStorage.getItem("albumPaymentsClosed");s&&i((()=>{l.addNotification({title:"Make Money on BandLab",content:"Connect Stripe to earn money.",image:"https://www.bandlab.com/web-app/images/payments/money-614a271916.svg",action:'<a class="button-scd button-height-32 button-padding-16 button-rounded" ui-sref="settings.payments" ng-click="$parent.innerScope.close()"><icon-svg name="arrow-right" size="16"></icon-svg></a>',onDismiss:function(){localStorage.setItem("albumPaymentsClosed",!0)}})}),1e3),a.attachments({id:d.id}).$promise.then((function(e){o.attachments=e,n||s||!o.album.permissions.edit||e.length||localStorage.getItem("albumBonusClosed")||l.addNotification({title:"Add Bonus Materials",content:"Spice up your album with some exclusive content",image:"https://www.bandlab.com/web-app/images/album/page-gift-07eccc726e.svg",action:`<a class="button-scd button-height-32 button-padding-16 button-rounded" ui-sref="album.edit.bonus({ albumId: '${d.id}' })" ng-click="$parent.innerScope.close()"><icon-svg name="arrow-right" size="16"></icon-svg></a>`,onDismiss:function(){localStorage.setItem("albumBonusClosed",!0)}})})),(r.params.commentId||r.params.replyId)&&v({commentId:r.params.commentId,replyId:r.params.replyId}),e.get("https://www.bandlab.com/api/v1.3/explore/recommended-albums",{cache:!0,params:{genres:o.album.genreId,limit:4}}).then((e=>e.data)).catch((()=>[])).then((function(e){o.recommendedAlbums=e.filter((e=>e.id!==o.album.id)).slice(0,3),o.hasMoreRecommendations=e.length>3})),Promise.resolve().then((()=>tv)).then((function(e){let{trackActionsAndPromptTip:n}=e;n(t,o,{user:d.creator,entityId:d.id})}))}(),this.uiOnParamsChanged=function(){(r.params.commentId||r.params.replyId)&&v({commentId:r.params.commentId,replyId:r.params.replyId})},o.$on("Album:supportSuccess",(()=>{o.album.$get(),a.attachments({id:d.id}).$promise.then((function(e){o.attachments=e}))})),o.$on("$album:changed",((e,t)=>{let{action:n,album:r}=t;"update"===n&&(o.album=r)})),o.$on("$albumTrack:changed",(function(e,t){!function(e){const t=o.album.posts.find((t=>t.revision.id===e.id));t.caption=e.caption,t.track=e.track,t.revision.track=e.track,t.isExplicit=e.isExplicit,t.state=e.state,t.revision.song.name=e.track.name,o.$applyAsync(),n.$broadcast("Album:saveCompleted")}(t)})),o.$on("$albumTrack:deleted",(function(e,t){o.album.posts=o.album.posts.filter((e=>e.id!==t.id))})),o.$on("$destroy",(()=>{o.album.permissions.edit&&l.clearAll()}))}]),angular.module("bandlab.album").controller("AlbumPaletteCtrl",["$analytics","$scope","Album",function(e,t,n){t.$on("$albumPicture:changed",(function(e,n){let{data:r}=n;r.property?(t.album.theme.images[r.property]=r.picture.url,"header"===r.property&&(t.album.theme.isHeaderHidden=!1),l()):(t.album.picture=r.picture,s(),t.customThemeType&&(t.loading=!0,vy(t.album.picture.url).then((e=>{t.customThemeType=e.name,t.album.theme.colors=e.colors,t.loading=!1,l(),o()}))))})),t.$on("$album:changed",(function(){l()})),t.$on("$destroy",(function(){document.body.removeEventListener("mousedown",r),document.body.removeEventListener("keydown",a)})),t.$watch("editingPalette",(function(){l(),t.editingPalette&&(document.body.addEventListener("mousedown",r),document.body.addEventListener("keydown",a))})),t.closeCustomPalette=i,t.deleteBackground=function(){t.album.theme.images.background=null,l(),o()},t.deleteCover=function(){n.picture({id:t.album.id,picture:null}).$promise.then((e=>{let{picture:n}=e;t.album.picture=n}))},t.deleteHeader=function(){t.album.theme.images.header=null,l(),o()},t.openCustomPalette=function(){t.editingCustom=!0,s(),t.album.themeId&&(t.album.themeId=null,n.update({id:t.album.id,themeId:null}).then((()=>t.album.$get())).then((()=>{l()})))},t.resetTheme=function(){t.generatedThemeIndex=0,t.customThemeType=null,n.deleteTheme({id:t.album.id}).$promise.then((()=>t.album.$get())).then((()=>l()))},t.selectBackgroundType=function(e){t.album.theme.current.background=e,l(),o()},t.selectTheme=function(o){e.eventTrack("Select Theme",{category:"Album",label:o.id}),t.album.themeId=o.id,n.update({id:t.album.id,themeId:o.id}),l()},t.toggleGeneratedTheme=function(e){t.customThemeType?t.generatedThemeIndex=e<0?t.generatedThemes.length-1:e%t.generatedThemes.length:t.generatedThemeIndex=0;const n=t.generatedThemes[t.generatedThemeIndex];n&&(t.customThemeType=n.name,t.album.theme.colors=n.colors,l(),o())},t.toggleHeader=function(){t.album.theme.isHeaderHidden=!t.album.theme.isHeaderHidden,l(),o()},t.updateColors=function(){Object.keys(t.album.theme.colors).forEach((e=>{var n;t.album.theme.colors[e]=("#"===(n=t.album.theme.colors[e])[0]?n:`#${n}`).toUpperCase()})),t.generatedThemeIndex=0,t.customThemeType=null,l(),o()};const o=ay((()=>{n.updateTheme({id:t.album.id,...t.album.theme})}),400);function r(e){e.target.closest(".album-palette")||e.target.closest(".button-default")||e.target.closest(".modal-overlay")||(t.closeThemePalette(),i(),t.$applyAsync(),document.body.removeEventListener("mousedown",r))}function i(){t.editingCustom=!1}function a(e){27===e.keyCode&&(t.closeThemePalette(),i(),t.$applyAsync(),document.body.removeEventListener("keydown",a))}async function s(){t.generatedThemes=[];const e=await async function(e){const t=await gy(e),n=Cy(t);return hy(n[0],n[n.length-1])<300?[by(n),...(o=ky(t[0]),o.map(((e,t)=>({name:`Palette ${t+1}`,colors:Sy(Ey(e,o))}))))]:[$y(t[0]),yy(n),...wy(t)];var o}(t.album.picture.url);var n,o;t.customThemeType=(n=t.album.theme.colors,o=e,o.find((function(e){return Object.keys(e.colors).every((function(t){return e.colors[t]===n[t]}))})))?.name,t.generatedThemes=e,t.generatedThemeIndex=e.findIndex((e=>e.name===t.customThemeType)),t.$applyAsync()}function l(){const e=document.querySelector(".album-background"),n=e.style,o=t.album.themeId?t.themes.find((e=>e.id===t.album.themeId)):t.album.theme;function r(e,t){return`rgb(${(Py({hex:e})?py({hex:e,ratio:-1*t}):py({hex:e,ratio:t})).join(",")})`}"Image"===o.current.background&&o.images.background?n.setProperty("--album-background-image",`url(${o.images.background})`):n.setProperty("--album-background-image",""),o.isHeaderHidden||"Released"===t.album.state&&!t.editingPalette&&!o.images.header?e.classList.add("hide-header"):(e.classList.remove("hide-header"),o.images.header?(n.setProperty("--album-header-color","transparent"),n.setProperty("--album-header-image",`url(${o.images.header})`)):(n.setProperty("--album-header-color",o.colors.button),n.setProperty("--album-header-image",""))),n.setProperty("--album-background-color",o.colors.background),n.setProperty("--album-body-color",o.colors.body),n.setProperty("--album-separator-color",r(o.colors.body,.1)),n.setProperty("--album-button-color",o.colors.button),n.setProperty("--album-button-border-color",r(o.colors.button,.1)),n.setProperty("--album-button-hover-color",r(o.colors.button,.05)),n.setProperty("--album-button-icon-scd",function(e){if(e)return Py({hex:e})?"#000000":"#FFFFFF"}(o.colors.button)),n.setProperty("--album-text-color",o.colors.text),n.setProperty("--album-secondary-color",o.colors.secondary)}}]),angular.module("bandlab.album").controller("AlbumPriceEditCtrl",["$scope","$state","Album","AppNotifications","Me","theAlbum","Wallets",function(e,t,n,o,r,i,a){e.saving=!1,e.album=new n(i),e.selectPrice=function(t){e.album.policy.pricingType!==t&&e.albumPriceForm.$setDirty(),e.album.policy.pricingType=t},e.updatePrice=function(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=Promise.resolve();e.albumPriceForm.$dirty&&e.albumPriceForm.$valid&&(a=a.then((()=>n.updatePolicy({id:e.album.id,...e.album.policy}).$promise))),a.then((function(){e.albumPriceForm.$setPristine(),"library"===i?t.go("library.albums"):"page"===i?t.go("userAlbum",{username:r.username,id:e.album.id,new:!0}):"tracks"===i?t.go("album.create.tracks",{albumId:e.album.id}):(o.addNotification({title:"Album updated",action:`<a class="button-scd button-height-32 button-padding-16 button-rounded" href="${t.href("albumId",{username:r.username,id:e.album.id})}"><icon-svg name="arrow-right" size="16"></icon-svg></a>`,classList:"success",autoclose:8e3}),t.go(".",{tip:null}))}))},e.hasWallet=a.find((e=>"Tipalti"===e.gateway)),async function(){e.hasWallet||"Free"===e.album.policy.pricingType||(e.album.policy.pricingType="Free",e.albumPriceForm.$setDirty())}()}]),angular.module("bandlab.album").controller("AlbumTracksEditCtrl",["$rootScope","$scope","$state","Album","PlayerHistory","ProjectUploader","RevisionSocket","theAlbum",function(e,t,n,o,r,i,a,s){t.album=new o(s),t.toInfo=function(){n.go("album.create.info",{albumId:t.album.id})},t.toPrice=function(){n.go("album.create.price",{albumId:t.album.id})},t.toLibrary=function(){n.go("library.albums")},t.saving=!1,t.$on("Album:saving",(function(){t.saving=!0})),t.$on("Album:saveCompleted",(function(){t.saving=!1})),t.$on("Album:saveFailed",(function(){t.saving=!1})),t.$on("$revision:changed",(function(e,n){const o=n.revision;o.mixdown&&"Ready"!==o.mixdown.status&&a.join({revisionId:o.id}),t.album.posts.push(o.post)})),t.$on("$albumTrack:changed",(function(n,o){!function(n){const o=t.album.posts.find((e=>e.revision.id===n.id));o.caption=n.caption,o.track=n.track,o.revision.track=n.track,o.isExplicit=n.isExplicit,o.state=n.state,o.revision.song.name=n.track.name,t.$applyAsync(),e.$broadcast("Album:saveCompleted")}(o)})),t.$on("$albumTrack:added",(function(e,n){t.album.posts.push(n.post)})),t.$on("$albumTrack:deleted",(function(e,n){t.album.posts=t.album.posts.filter((e=>e.id!==n.id))})),t.$on("$destroy",a.disconnect),t.$on("$mixdown:changed",(function(e,n){const o=t.album.posts.find((function(e){return e.revision.mixdown.id===n.mixdown.id}));o&&(o.revision.mixdown=n.mixdown,t.$applyAsync())})),t.$watch("album.posts",(function(){r.forcePushQueueSongs(t.album.posts,r.getStack()[r.getIndex()],{contentSource:"album",id:t.album.id})}),!0),t.isUploading=function(){return i.queue.some((function(e){return!e.complete}))}}]),angular.module("bandlab.album").controller("AlbumTrackFormCtrl",["$rootScope","$scope","Album","Post","Tag",function(e,t,n,o,r){t.post=new o({...t.post,track:{...t.post.track}}),r.getGenres().catch((()=>[])).then((e=>{t.genres=e})),t.$on("$trackPicture:changed",(function(n,o){let{data:r}=o;t.post.track.picture=r.picture,e.$broadcast("$albumTrack:changed",t.post)})),t.closeModal=function(){e.$broadcast("editTrackModal","close")},t.editTrack=function(){n.updatePost({id:t.post.id,caption:t.post.caption,isExplicit:t.post.isExplicit,state:t.post.state,track:{name:t.post.track.name,genreId:t.post.track.genreId}}).$promise.then((function(){e.$broadcast("$albumTrack:changed",t.post),e.$broadcast("editTrackModal","close")})).catch((function(e){t.errorMessage=e.message}))}}]),angular.module("bandlab.album").component("albumAttachmentPlayer",{templateUrl:"https://www.bandlab.com/web-app/album/partials/_album-attachment-player-690286e6.html",bindings:{attachment:"="},controller:["$scope","Player",function(e,t){const n=this;var o;function r(){n.audio.pause(),n.audio.src=n.attachment.contentUrl,n.audio.currentTime=0}function i(){n.progress=n.audio.currentTime/n.audio.duration*100,e.$applyAsync()}n.audio=new Audio,n.$onInit=function(){r(),n.audio.onended=function(){n.audio.pause()},n.audio.ontimeupdate=function(){i()},n.audio.onwaiting=function(){n.ready=!1,e.$applyAsync()},n.audio.oncanplaythrough=function(){n.audio.readyState>=4&&(n.ready=!0,e.$applyAsync())},n.audio.volume=Number(localStorage.getItem("albumAttachmentPlayerVolume"))||1},n.$onDestroy=function(){n.audio.pause(),n.audio.src=null,n.audio.onended=null,n.audio.ontimeupdate=null,n.audio.onwaiting=null,n.audio.oncanplaythrough=null},e.$watch("vm.attachment",(function(){r()})),n.isPlaying=function(){return!n.audio.paused},n.setProgressTime=function(e){if(n.audio.seekable.start(0)!==n.audio.seekable.end(0)){if(n.audio.readyState>=4)return n.audio.currentTime=Math.min(e*n.audio.duration,n.audio.duration-.1),void i();n.audio.addEventListener("canplaythrough",(function t(){n.audio.removeEventListener("canplaythrough",t),n.audio.currentTime=Math.min(e*n.audio.duration,n.audio.duration-.1),i()}))}},n.togglePlay=function(){n.audio.paused?(t.pause(),n.audio.play()):n.audio.pause()},n.mute=function(){n.isMuted?(n.audio.volume=o,n.isMuted=!1):(o=n.audio.volume,n.audio.volume=0,n.isMuted=!0)},n.storeVolume=function(e){o=n.audio.volume,n.setVolume(e),localStorage.setItem("albumAttachmentPlayerVolume",n.audio.volume)},n.setVolume=function(e){n.audio.volume=Math.max(Math.min(1,e),0),n.isMuted=0===n.audio.volume}}],controllerAs:"vm"}),angular.module("bandlab.album").component("albumCreateHeader",{bindings:{albumId:"=",save:"&",notSaved:"="},templateUrl:"https://www.bandlab.com/web-app/album/partials/_album-create-header-95639d1e.html",controller:["$scope",function(e){const t=this;e.$on("Album:saving",(function(){e.saving=!0,e.saved=!1})),e.$on("Album:saveCompleted",(function(){e.saving=!1,e.saved=!0})),e.$on("Album:saveFailed",(function(){e.saving=!1,e.saved=!0})),e.save=function(){t.save()}}],controllerAs:"vm"}),angular.module("bandlab.album").component("albumBonusDropzone",{templateUrl:"https://www.bandlab.com/web-app/album/partials/_album-bonus-dropzone-98897668.html",bindings:{attachments:"=",album:"="},controller:["appActions","AppNotifications","ProjectUploader","$element","$http","$q","$rootScope","$scope","$window",function(e,t,n,o,r,i,a,s,l){var c=this;function u(e){_.chain(e).get("dataTransfer.items",[]).some((e=>dy.find((t=>t.mime===e.type)))).value()&&(s.isDragging=!0,s.$applyAsync())}function d(){s.isDragging=!1,s.$applyAsync()}function p(o){if((c.attachments?c.attachments.length:0)+o.length>10)return void t.addNotification({title:"Unable to add bonus material",content:"Bonus materials have reached its limits of file (10)",classList:"alert"});o.map((function(o){return function(o){if(!o||!e.checkAllowed("upload"))return;if(o.size/1e6>10)return void t.addNotification({title:"Unable to import file. Please check that your file is not corrupted.",content:"<i>Maximum file size: 10 MB</i>",classList:"alert",autoclose:8e3});a.$broadcast("Album:saving");const s=new FormData;s.append("file",o);const l={createdAt:performance.now(),name:o.name,file:o,progress:0,loaded:0,complete:!1,cancel:function(){Gf(n.queue,l),l.upload.cancel()},upload:u(),retry:function(){l.upload=u(),l.failed=!1},index:n.queue.length,previousTask:n.queue.length?n.queue[n.queue.length-1]:null};function u(){const e=i.defer();return Object.assign(r({method:"POST",url:`https://www.bandlab.com/api/v1.3/albums/${c.album.id}/attachments`,data:s,headers:{"Content-Type":void 0},uploadEventHandlers:{progress:function(e){l.total=e.total,l.loaded=e.loaded,l.progress=e.loaded/e.total}},timeout:e.promise}).then((function(t){let{data:n}=t,a=i.resolve();var s;return n.type.startsWith("video")&&(s=n.type,dy.find((e=>e.mime===s))||{name:"zip",mime:"application/zip",extension:".zip",hasPreview:!1}).hasPreview?a=Th(o):n.type.startsWith("image")&&(a=i.resolve(new Blob([o],{type:o.type}))),a.then((function(t){return t?r({method:"PUT",url:n.previewUploadUrl,data:t,headers:{"Content-Type":void 0,"x-ms-blob-type":"BlockBlob"},responseType:"arraybuffer",uploadEventHandlers:{progress:function(e){l.total=e.total,l.loaded=e.loaded,l.progress=e.loaded/e.total}},timeout:e.promise}):i.resolve()})).then((()=>n))})).then((function(e){l.complete=!0,a.$broadcast("Album:saveCompleted"),a.$broadcast("$albumAttachment:added",e)})).catch((function(e){"abort"!==e.xhrStatus&&(l.failed=!0,a.$broadcast("Album:saveFailed"),t.addNotification({content:e.message||"Unable to import file. Please check that your file is not corrupted.",classList:"alert",autoclose:8e3}))})),{progress:{},cancel:()=>e.resolve()})}n.queue.push(l)}(o)}))}s.uploadFromComputer=function(){e.checkAllowed("upload")&&o[0].querySelector("input#bonusMaterials").click()},s.bonusMaterialMaxSize=10,s.supportedTypes=dy.map((e=>e.name)).join(", "),s.acceptedTypes=dy.map((e=>e.extension)).join(","),(l=angular.element(l)).on("dragover",u),l.on("dragleave",d),s.$on("$destroy",(function(){l.off("dragover",u),l.off("dragleave",d)})),s.$watch("importedFile",(function(e){e&&e.length>0&&p(e)})),o.on("drop",(function(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer.files&&p(Array.from(e.dataTransfer.files)),s.isDragging=!1,s.$applyAsync()})),o.on("dragover",(function(e){e.preventDefault(),e.stopPropagation(),s.isDragging=!0,e.dataTransfer.dropEffect="copy",s.$applyAsync()}))}],controllerAs:"vm"}),angular.module("bandlab.album").component("albumDropzone",{templateUrl:"https://www.bandlab.com/web-app/album/partials/_album-dropzone-bb4f35e1.html",bindings:{size:"@",album:"="},controller:["$element","$filter","$http","$q","$rootScope","$scope","$timeout","$window","appActions","Album","AppNotifications","Post","ProjectUploader","RevisionImporter",function(e,t,n,o,r,i,a,s,l,c,u,d,p,m){var f=this;function h(e){_.chain(e).get("dataTransfer.items",[]).some((e=>e.type.includes("audio"))).value()&&(i.isDragging=!0,i.$applyAsync())}function g(){i.isDragging=!1,i.$applyAsync()}function v(e){const a=p.queue.reduce((function(e,t){return!1===t.failed||t.progress>=1?e:e+1}),0);return f.album.posts.length+e.length+a>50?(u.addNotification({title:"Track couldnt be added",content:"This album has reached its limit of tracks (50).",classList:"alert",autoclose:8e3}),void(i.isDragging=!1)):o.all(Array.from(e).map(y)).then((function(e){const[i,a]=_.partition(e,(function(e){let[,t]=e;return t}));a.length&&u.addNotification({title:"Unable to import file. Please check that your file is not corrupted.",content:`${a.map((e=>{let[t,,n]=e;return`<div style="margin: 4px 0">${t.name}<br>${n.message}<div>`})).join("")}`,classList:"alert"}),i.map((function(e){let[i,a]=e;return function(e,i){const a={createdAt:performance.now(),name:t("limitTo")(e.name.replace(/\.[^/.]+$/,""),100),file:e,progress:0,loaded:0,complete:!1,cancel:function(){Gf(p.queue,a),a.upload.cancel()},upload:s(),retry:function(){a.upload=s(),a.failed=!1},index:p.queue.length,previousTask:p.queue.length?p.queue[p.queue.length-1]:null};function s(){const s=o.defer();return Object.assign(Hh(e).then((function(e){const n=c.createPost({id:f.album.id,track:{name:t("limitTo")(e.name.replace(/\.[^/.]+$/,""),100),genreId:f.album.genreId,sample:{audioFormat:Ih(e.type),duration:i}}});return s.promise.then((()=>n.$cancelRequest())),Promise.all([n.$promise,e])})).then((function(e){let[t,o]=e;const{"Content-Type":r}=Object.fromEntries(new URLSearchParams(t.track.sample.uploadUrl));return a.post=t,n({method:"PUT",url:t.track.sample.uploadUrl,data:o,headers:{"Content-Type":r},uploadEventHandlers:{progress:function(e){a.total=e.total,a.loaded=e.loaded,a.progress=e.loaded/e.total}},timeout:s.promise})})).then((function(){a.complete=!0,r.$broadcast("$albumTrack:added",{post:a.post}),b(a.post.id)})).catch((e=>{a.failed=!0})),{progress:{},cancel:function(){s.resolve(),a.post&&c.removePost({id:f.album.id,postId:a.post.id})}})}p.queue.push(a)}(i,a)}))}))}function b(e){a((function(){d.get({id:e}).$promise.then((function(t){"Empty"===t.track.sample.status?b(e):r.$broadcast("$albumTrack:changed",t)}))}),5e3)}function y(e){return m.isAudioFileValid(e,{loader:!1}).then((function(e){let[t,n]=e;return[t,n]})).catch((t=>[e,null,t]))}f.maxTracks=50,s=angular.element(s),i.uploadFromComputer=function(){l.checkAllowed("upload")&&e[0].querySelector("input#tracks").click()},i.$watch("importedAudio",(function(e){e&&v(e)})),s.on("dragover",h),s.on("dragleave",g),i.$on("$destroy",(function(){s.off("dragover",h),s.off("dragleave",g)})),e.on("drop",(function(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer.files&&v(e.dataTransfer.files),i.isDragging=!1,i.$applyAsync()})),e.on("dragover",(function(e){e.preventDefault(),e.stopPropagation(),i.isDragging=!0,e.dataTransfer.dropEffect="copy",i.$applyAsync()})),e.on("dragleave",(function(){i.isDragging=!1,i.$applyAsync()}))}],controllerAs:"vm"}),angular.module("bandlab.album").component("albumStepper",{bindings:{step:"=",back:"=",next:"=",nextFn:"&",backFn:"&",uploading:"="},templateUrl:"https://www.bandlab.com/web-app/album/partials/_album-stepper-5ebe84dc.html",controller:["$scope",function(e){const t=this;t.$onInit=function(){t.step&&t.step>0?e.currentStep=t.step:e.currentStep=1},e.steps=[{step:1,name:"Info"},{step:2,name:"Tracks"},{step:3,name:"Price"}],e.back=function(){t.backFn()},e.next=function(){t.nextFn()}}],controllerAs:"vm"}),angular.module("bandlab.album").component("albumTile",{bindings:{album:"<",triggeredFrom:"<"},transclude:{actions:"?albumTileActions"},templateUrl:"https://www.bandlab.com/web-app/album/partials/_album-tile-343b7a85.html",controller:["$scope","$stateParams","Me",function(e,t,n){const o=this;o.me=n,e.getType=function(e){return uy.find((t=>t.id===e)).name},o.$onInit=function(){o.futureRelease=new Date(o.album.releaseDate)>new Date},e.$on("$album:changed",(function(e,t){t.album.id===o.album.id&&"update"===t.action&&(o.album=t.album)})),o.viewOnly=p()&&t.purchased,o.isPurchases=t.purchased}],controllerAs:"vm"}).component("albumPreview",{bindings:{album:"<"},templateUrl:"https://www.bandlab.com/web-app/album/partials/_album-preview-00d5bc71.html",controller:["$scope","Me","Tag",function(e,t,n){const o=this;o.me=t,e.getType=function(e){return uy.find((t=>t.id===e)).name},e.getGenre=function(t){return e.genres.find((e=>e.id===t))?.name},e.genres=[],e.maxTracksShown=3,o.$onInit=function(){n.getGenres().then((t=>{e.genres=t}))},e.$on("$album:changed",(function(e,t){t.album.id===o.album.id&&"update"===t.action&&(o.album=t.album)}))}],controllerAs:"vm"}),angular.module("bandlab.album").component("albumTrackTile",{bindings:{album:"=",editable:"=",index:"=",post:"="},templateUrl:"https://www.bandlab.com/web-app/album/partials/_album-track-tile-364608ef.html",controller:["$rootScope","$scope","Album","ConfirmModal","Player","Me",function(e,t,n,o,r,i){const a=this;function s(){e.$broadcast("Album:saving"),a.post.isDeleting=!0,t.$applyAsync(),n.removePost({id:a.album.id,postId:a.post.id}).$promise.then((function(){e.$broadcast("$albumTrack:deleted",{id:a.post.id}),r.removeRevisionFromQueue(a.post.revId,a.post.id),e.$broadcast("Album:saveCompleted")})).catch((function(){e.$broadcast("Album:saveFailed")}))}a.me=i,t.confirmDeleteTrack=function(){new o({confirmLabel:"Delete",toFocusConfirm:!0,contentScope:{title:"Remove Track From Album"},onConfirm:s}).show()},t.updateTrackOrder=function(e,t){n.updatePostOrder({id:a.album.id,postId:e,order:t})}}],controllerAs:"vm"}),angular.module("bandlab.album").factory("Album",["$http","$resource","$timeout",function(e,t,n){var o="https://www.bandlab.com/api/v1.3/albums";const r=t(o,{},{addPost:{method:"POST",params:{albumId:"@albumId",postId:"@postId"},url:`${o}/:albumId/posts/:postId`,transformResponse:[...e.defaults.transformResponse,i]},createPost:{method:"POST",params:{id:"@id"},url:`${o}/:id/posts`,cancellable:!0,transformResponse:[...e.defaults.transformResponse,i]},delete:{method:"DELETE",params:{id:"@id"},url:`${o}/:id`},deleteAttachment:{method:"DELETE",params:{id:"@id",attachmentId:"@attachmentId"},url:`${o}/:id/attachments/:attachmentId`},deleteTheme:{method:"DELETE",params:{id:"@id"},url:`${o}/:id/theme`},downloadAttachment:{method:"GET",params:{id:"@id",attachmentId:"@attachmentId"},url:`${o}/:id/attachments/:attachmentId/file`},fromUser:{method:"GET",params:{userId:"@userId"},url:"https://www.bandlab.com/api/v1.3/users/:userId/albums",preservePagination:!0},get:{method:"GET",params:{id:"@id"},url:`${o}/:id`,transformResponse:[...e.defaults.transformResponse,function(e,t,n){return 200===n&&(e.creator=e.artist),e},function(e,t,n){return 200===n&&(e.posts=e.posts.map((t=>a(t,e)))),e}]},attachments:{method:"GET",isArray:!0,params:{id:"@id"},url:`${o}/:id/attachments`},liked:{method:"GET",params:{userId:"@userId"},url:"https://www.bandlab.com/api/v1.3/users/:userId/likes/albums",preservePagination:!0},picture:{method:"PUT",params:{id:"@id"},url:`${o}/:id/picture`},pictureTrack:{method:"PUT",params:{postId:"@id"},url:"https://www.bandlab.com/api/v1.3/posts/:postId/track/picture"},publish:{method:"PUT",params:{id:"@id"},url:`${o}/:id/state`},purchase:{method:"POST",params:{userId:"@userId",albumId:"@albumId"},url:"https://www.bandlab.com/api/v1.3/users/:userId/purchases/albums/:albumId",transformRequest:[function(e){return{tipId:e.tipId}},angular.toJson]},purchased:{method:"GET",params:{userId:"@userId"},url:"https://www.bandlab.com/api/v1.3/users/:userId/purchases/albums",preservePagination:!0},purchaseInfo:{method:"GET",params:{userId:"@userId",albumId:"@albumId"},url:"https://www.bandlab.com/api/v1.3/users/:userId/purchases/albums/:albumId"},removePost:{method:"DELETE",params:{id:"@id",postId:"@postId"},url:`${o}/:id/posts/:postId`},save:{method:"POST",url:o},themes:{method:"GET",isArray:!0,url:`${o}/themes`},update:{method:"PATCH",params:{id:"@id"},url:`${o}/:id`,transformRequest:[function(e){const t=["description","genreId","isAutoRepostEnabled","name","releaseDate","themeId","type"].reduce(((t,n)=>(t[n]=e[n],t)),{});return t.releaseDate&&angular.isObject(t.releaseDate)&&(t.releaseDate=`${t.releaseDate.getUTCFullYear()}-${(t.releaseDate.getUTCMonth()+1).toString().padStart(2,"0")}-${t.releaseDate.getUTCDate().toString().padStart(2,"0")}`),t},angular.toJson]},updateAttachment:{method:"PATCH",params:{id:"@id",attachmentId:"@attachmentId"},url:`${o}/:id/attachments/:attachmentId`},updateAttachmentOrder:{method:"PUT",params:{id:"@id",attachmentId:"@attachmentId",order:"@order"},url:`${o}/:id/attachments/:attachmentId/:order`},updatePolicy:{method:"PUT",params:{id:"@id"},url:`${o}/:id/policy`},updatePost:{method:"PATCH",params:{postId:"@id"},url:"https://www.bandlab.com/api/v1.3/posts/:postId",transformRequest:[function(e){return delete e.id,e},angular.toJson]},updatePostOrder:{method:"PUT",params:{id:"@id",postId:"@postId"},url:`${o}/:id/posts/:postId/order`},updateTheme:{method:"PUT",params:{id:"@id"},url:`${o}/:id/theme`}});return Object.assign(r,{purchaseWithRetry:function e(t){return n(1e3).then((()=>r.purchase(t).$promise)).catch((n=>{if(409!==n.status)throw 403===n.status&&(n.message=n.data.message),500===n.status&&(n.message="Something went wrong, please try again later"),n;e(t)}))},trackPostToPost:a,albumToPost:function(e){return{id:e.id,caption:e.description,counters:e.counters,createdOn:e.releaseDate,creator:e.creator,state:e.state,type:"Album"}}});function i(e,t,n){return 201===n?a(e):e}function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={albumId:e.albumId,counters:{},creator:e.creator||t.creator,id:e.id,isLiked:e.isLiked,isPublic:"Released"===t.state,mixdown:{duration:e.track.sample.duration,status:e.track.sample.status},postId:e.id,genres:[{id:e.track.genreId}],song:{albumId:e.albumId,author:{type:"User",username:(e.creator||t.creator).username},name:e.track.name,picture:e.track.picture||t.picture},state:e.state,track:e.track,type:"Track"};return{...e,revision:{revision:n,...n}}}}]),angular.module("bandlab.audio",[]);const Ry="undefined"!=typeof document,Ay=Object.assign;function xy(e,t){const n={};for(const o in t){const r=t[o];n[o]=Oy(r)?r.map(e):e(r)}return n}const Ly=()=>{},Oy=Array.isArray,jy=/#/g,Dy=/&/g,Ny=/\//g,Uy=/=/g,Fy=/\?/g,By=/\+/g,Wy=/%5B/g,Vy=/%5D/g,qy=/%5E/g,zy=/%60/g,Hy=/%7B/g,Gy=/%7C/g,Ky=/%7D/g,Yy=/%20/g;function Jy(e){return encodeURI(""+e).replace(Gy,"|").replace(Wy,"[").replace(Vy,"]")}function Xy(e){return Jy(e).replace(By,"%2B").replace(Yy,"+").replace(jy,"%23").replace(Dy,"%26").replace(zy,"`").replace(Hy,"{").replace(Ky,"}").replace(qy,"^")}function Zy(e){return null==e?"":function(e){return Jy(e).replace(jy,"%23").replace(Fy,"%3F")}(e).replace(Ny,"%2F")}function Qy(e){try{return decodeURIComponent(""+e)}catch(e){}return""+e}const ew=/\/$/;function tw(e,t){let n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",r={},i="",a="";const s=t.indexOf("#");let l=t.indexOf("?");return s<l&&s>=0&&(l=-1),l>-1&&(n=t.slice(0,l),i=t.slice(l+1,s>-1?s:t.length),r=e(i)),s>-1&&(n=n||t.slice(0,s),a=t.slice(s,t.length)),n=function(e,t){if(e.startsWith("/"))return e;if(!e)return t;const n=t.split("/"),o=e.split("/"),r=o[o.length-1];".."!==r&&"."!==r||o.push("");let i,a,s=n.length-1;for(i=0;i<o.length;i++)if(a=o[i],"."!==a){if(".."!==a)break;s>1&&s--}return n.slice(0,s).join("/")+"/"+o.slice(i).join("/")}(null!=n?n:t,o),{fullPath:n+(i&&"?")+i+a,path:n,query:r,hash:Qy(a)}}function nw(e,t){return t&&e.toLowerCase().startsWith(t.toLowerCase())?e.slice(t.length)||"/":e}function ow(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function rw(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(!iw(e[n],t[n]))return!1;return!0}function iw(e,t){return Oy(e)?aw(e,t):Oy(t)?aw(t,e):e===t}function aw(e,t){return Oy(t)?e.length===t.length&&e.every(((e,n)=>e===t[n])):1===e.length&&e[0]===t}const sw={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var lw,cw;!function(e){e.pop="pop",e.push="push"}(lw||(lw={})),function(e){e.back="back",e.forward="forward",e.unknown=""}(cw||(cw={}));const uw=/^[^#]+#/;function dw(e,t){return e.replace(uw,"#")+t}const pw=()=>({left:window.scrollX,top:window.scrollY});function mw(e,t){return(history.state?history.state.position-t:-1)+e}const fw=new Map;let hw=()=>location.protocol+"//"+location.host;function gw(e,t){const{pathname:n,search:o,hash:r}=t,i=e.indexOf("#");if(i>-1){let t=r.includes(e.slice(i))?e.slice(i).length:1,n=r.slice(t);return"/"!==n[0]&&(n="/"+n),nw(n,"")}return nw(n,e)+o+r}function vw(e,t,n){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return{back:e,current:t,forward:n,replaced:arguments.length>3&&void 0!==arguments[3]&&arguments[3],position:window.history.length,scroll:o?pw():null}}function bw(e){const t=function(e){const{history:t,location:n}=window,o={value:gw(e,n)},r={value:t.state};function i(o,i,a){const s=e.indexOf("#"),l=s>-1?(n.host&&document.querySelector("base")?e:e.slice(s))+o:hw()+e+o;try{t[a?"replaceState":"pushState"](i,"",l),r.value=i}catch(e){n[a?"replace":"assign"](l)}}return r.value||i(o.value,{back:null,current:o.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0),{location:o,state:r,push:function(e,n){const a=Ay({},r.value,t.state,{forward:e,scroll:pw()});i(a.current,a,!0),i(e,Ay({},vw(o.value,e,null),{position:a.position+1},n),!1),o.value=e},replace:function(e,n){i(e,Ay({},t.state,vw(r.value.back,e,r.value.forward,!0),n,{position:r.value.position}),!0),o.value=e}}}(e=function(e){if(!e)if(Ry){const t=document.querySelector("base");e=(e=t&&t.getAttribute("href")||"/").replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return"/"!==e[0]&&"#"!==e[0]&&(e="/"+e),e.replace(ew,"")}(e)),n=function(e,t,n,o){let r=[],i=[],a=null;const s=i=>{let{state:s}=i;const l=gw(e,location),c=n.value,u=t.value;let d=0;if(s){if(n.value=l,t.value=s,a&&a===c)return void(a=null);d=u?s.position-u.position:0}else o(l);r.forEach((e=>{e(n.value,c,{delta:d,type:lw.pop,direction:d?d>0?cw.forward:cw.back:cw.unknown})}))};function l(){const{history:e}=window;e.state&&e.replaceState(Ay({},e.state,{scroll:pw()}),"")}return window.addEventListener("popstate",s),window.addEventListener("beforeunload",l,{passive:!0}),{pauseListeners:function(){a=n.value},listen:function(e){r.push(e);const t=()=>{const t=r.indexOf(e);t>-1&&r.splice(t,1)};return i.push(t),t},destroy:function(){for(const e of i)e();i=[],window.removeEventListener("popstate",s),window.removeEventListener("beforeunload",l)}}}(e,t.state,t.location,t.replace),o=Ay({location:"",base:e,go:function(e){!(arguments.length>1&&void 0!==arguments[1])||arguments[1]||n.pauseListeners(),history.go(e)},createHref:dw.bind(null,e)},t,n);return Object.defineProperty(o,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(o,"state",{enumerable:!0,get:()=>t.state.value}),o}function yw(e){return"string"==typeof e||"symbol"==typeof e}const ww=Symbol("");var $w;function kw(e,t){return Ay(new Error,{type:e,[ww]:!0},t)}function Sw(e,t){return e instanceof Error&&ww in e&&(null==t||!!(e.type&t))}!function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"}($w||($w={}));const _w="[^/]+?",Pw={sensitive:!1,strict:!1,start:!0,end:!0},Mw=/[.+*?^${}()[\]/\\]/g;function Tw(e,t){let n=0;for(;n<e.length&&n<t.length;){const o=t[n]-e[n];if(o)return o;n++}return e.length<t.length?1===e.length&&80===e[0]?-1:1:e.length>t.length?1===t.length&&80===t[0]?1:-1:0}function Cw(e,t){let n=0;const o=e.score,r=t.score;for(;n<o.length&&n<r.length;){const e=Tw(o[n],r[n]);if(e)return e;n++}if(1===Math.abs(r.length-o.length)){if(Ew(o))return 1;if(Ew(r))return-1}return r.length-o.length}function Ew(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const Iw={type:0,value:""},Rw=/[a-zA-Z0-9_]/;function Aw(e,t,n){const o=function(e,t){const n=Ay({},Pw,t),o=[];let r=n.start?"^":"";const i=[];for(const t of e){const e=t.length?[]:[90];n.strict&&!t.length&&(r+="/");for(let o=0;o<t.length;o++){const a=t[o];let s=40+(n.sensitive?.25:0);if(0===a.type)o||(r+="/"),r+=a.value.replace(Mw,"\\$&"),s+=40;else if(1===a.type){const{value:e,repeatable:n,optional:l,regexp:c}=a;i.push({name:e,repeatable:n,optional:l});const u=c||_w;if(u!==_w){s+=10;try{new RegExp(`(${u})`)}catch(t){throw new Error(`Invalid custom RegExp for param "${e}" (${u}): `+t.message)}}let d=n?`((?:${u})(?:/(?:${u}))*)`:`(${u})`;o||(d=l&&t.length<2?`(?:/${d})`:"/"+d),l&&(d+="?"),r+=d,s+=20,l&&(s+=-8),n&&(s+=-20),".*"===u&&(s+=-50)}e.push(s)}o.push(e)}if(n.strict&&n.end){const e=o.length-1;o[e][o[e].length-1]+=.7000000000000001}n.strict||(r+="/?"),n.end?r+="$":n.strict&&(r+="(?:/|$)");const a=new RegExp(r,n.sensitive?"":"i");return{re:a,score:o,keys:i,parse:function(e){const t=e.match(a),n={};if(!t)return null;for(let e=1;e<t.length;e++){const o=t[e]||"",r=i[e-1];n[r.name]=o&&r.repeatable?o.split("/"):o}return n},stringify:function(t){let n="",o=!1;for(const r of e){o&&n.endsWith("/")||(n+="/"),o=!1;for(const e of r)if(0===e.type)n+=e.value;else if(1===e.type){const{value:i,repeatable:a,optional:s}=e,l=i in t?t[i]:"";if(Oy(l)&&!a)throw new Error(`Provided param "${i}" is an array but it is not repeatable (* or + modifiers)`);const c=Oy(l)?l.join("/"):l;if(!c){if(!s)throw new Error(`Missing required param "${i}"`);r.length<2&&(n.endsWith("/")?n=n.slice(0,-1):o=!0)}n+=c}}return n||"/"}}}(function(e){if(!e)return[[]];if("/"===e)return[[Iw]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(e){throw new Error(`ERR (${n})/"${c}": ${e}`)}let n=0,o=n;const r=[];let i;function a(){i&&r.push(i),i=[]}let s,l=0,c="",u="";function d(){c&&(0===n?i.push({type:0,value:c}):1===n||2===n||3===n?(i.length>1&&("*"===s||"+"===s)&&t(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:c,regexp:u,repeatable:"*"===s||"+"===s,optional:"*"===s||"?"===s})):t("Invalid state to consume buffer"),c="")}function p(){c+=s}for(;l<e.length;)if(s=e[l++],"\\"!==s||2===n)switch(n){case 0:"/"===s?(c&&d(),a()):":"===s?(d(),n=1):p();break;case 4:p(),n=o;break;case 1:"("===s?n=2:Rw.test(s)?p():(d(),n=0,"*"!==s&&"?"!==s&&"+"!==s&&l--);break;case 2:")"===s?"\\"==u[u.length-1]?u=u.slice(0,-1)+s:n=3:u+=s;break;case 3:d(),n=0,"*"!==s&&"?"!==s&&"+"!==s&&l--,u="";break;default:t("Unknown state")}else o=n,n=4;return 2===n&&t(`Unfinished custom RegExp for param "${c}"`),d(),a(),r}(e.path),n),r=Ay(o,{record:e,parent:t,children:[],alias:[]});return t&&!r.record.aliasOf==!t.record.aliasOf&&t.children.push(r),r}function xw(e,t){const n={};for(const o of t)o in e&&(n[o]=e[o]);return n}function Lw(e){const t={},n=e.props||!1;if("component"in e)t.default=n;else for(const o in e.components)t[o]="object"==typeof n?n[o]:n;return t}function Ow(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function jw(e){return e.reduce(((e,t)=>Ay(e,t.meta)),{})}function Dw(e,t){const n={};for(const o in e)n[o]=o in t?t[o]:e[o];return n}function Nw(e){let{record:t}=e;return!!(t.name||t.components&&Object.keys(t.components).length||t.redirect)}function Uw(e){const t={};if(""===e||"?"===e)return t;const n=("?"===e[0]?e.slice(1):e).split("&");for(let e=0;e<n.length;++e){const o=n[e].replace(By," "),r=o.indexOf("="),i=Qy(r<0?o:o.slice(0,r)),a=r<0?null:Qy(o.slice(r+1));if(i in t){let e=t[i];Oy(e)||(e=t[i]=[e]),e.push(a)}else t[i]=a}return t}function Fw(e){let t="";for(let n in e){const o=e[n];(n=Xy(n).replace(Uy,"%3D"),null!=o)?(Oy(o)?o.map((e=>e&&Xy(e))):[o&&Xy(o)]).forEach((e=>{void 0!==e&&(t+=(t.length?"&":"")+n,null!=e&&(t+="="+e))})):void 0!==o&&(t+=(t.length?"&":"")+n)}return t}function Bw(e){const t={};for(const n in e){const o=e[n];void 0!==o&&(t[n]=Oy(o)?o.map((e=>null==e?null:""+e)):null==o?o:""+o)}return t}const Ww=Symbol(""),Vw=Symbol(""),qw=Symbol(""),zw=Symbol(""),Hw=Symbol("");function Gw(){let e=[];return{add:function(t){return e.push(t),()=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)}},list:()=>e.slice(),reset:function(){e=[]}}}function Kw(e,t,n,o,r){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e=>e();const a=o&&(o.enterCallbacks[r]=o.enterCallbacks[r]||[]);return()=>new Promise(((s,l)=>{const c=e=>{var i;!1===e?l(kw(4,{from:n,to:t})):e instanceof Error?l(e):"string"==typeof(i=e)||i&&"object"==typeof i?l(kw(2,{from:t,to:e})):(a&&o.enterCallbacks[r]===a&&"function"==typeof e&&a.push(e),s())},u=i((()=>e.call(o&&o.instances[r],t,n,c)));let d=Promise.resolve(u);e.length<3&&(d=d.then(c)),d.catch((e=>l(e)))}))}function Yw(e,t,n,o){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e=>e();const i=[];for(const s of e)for(const e in s.components){let l=s.components[e];if("beforeRouteEnter"===t||s.instances[e])if("object"==typeof(a=l)||"displayName"in a||"props"in a||"__vccOpts"in a){const a=(l.__vccOpts||l)[t];a&&i.push(Kw(a,n,o,s,e,r))}else{let a=l();i.push((()=>a.then((i=>{if(!i)return Promise.reject(new Error(`Couldn't resolve component "${e}" at "${s.path}"`));const a=(l=i).__esModule||"Module"===l[Symbol.toStringTag]?i.default:i;var l;s.components[e]=a;const c=(a.__vccOpts||a)[t];return c&&Kw(c,n,o,s,e,r)()}))))}}var a;return i}function Jw(e){const t=Zo(qw),n=Zo(zw),o=Gi((()=>{const n=Gt(e.to);return t.resolve(n)})),r=Gi((()=>{const{matched:e}=o.value,{length:t}=e,r=e[t-1],i=n.matched;if(!r||!i.length)return-1;const a=i.findIndex(ow.bind(null,r));if(a>-1)return a;const s=Zw(e[t-2]);return t>1&&Zw(r)===s&&i[i.length-1].path!==s?i.findIndex(ow.bind(null,e[t-2])):a})),i=Gi((()=>r.value>-1&&function(e,t){for(const n in t){const o=t[n],r=e[n];if("string"==typeof o){if(o!==r)return!1}else if(!Oy(r)||r.length!==o.length||o.some(((e,t)=>e!==r[t])))return!1}return!0}(n.params,o.value.params))),a=Gi((()=>r.value>-1&&r.value===n.matched.length-1&&rw(n.params,o.value.params)));return{route:o,href:Gi((()=>o.value.href)),isActive:i,isExactActive:a,navigate:function(){return function(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey||e.defaultPrevented||void 0!==e.button&&0!==e.button)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})?t[Gt(e.replace)?"replace":"push"](Gt(e.to)).catch(Ly):Promise.resolve()}}}const Xw=Vn({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Jw,setup(e,t){let{slots:n}=t;const o=Mt(Jw(e)),{options:r}=Zo(qw),i=Gi((()=>({[Qw(e.activeClass,r.linkActiveClass,"router-link-active")]:o.isActive,[Qw(e.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:o.isExactActive})));return()=>{const t=n.default&&n.default(o);return e.custom?t:Ki("a",{"aria-current":o.isExactActive?e.ariaCurrentValue:null,href:o.href,onClick:o.navigate,class:i.value},t)}}});function Zw(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Qw=(e,t,n)=>null!=e?e:null!=t?t:n,e$=Vn({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,t){let{attrs:n,slots:o}=t;const r=Zo(Hw),i=Gi((()=>e.route||r.value)),a=Zo(Vw,0),s=Gi((()=>{let e=Gt(a);const{matched:t}=i.value;let n;for(;(n=t[e])&&!n.components;)e++;return e})),l=Gi((()=>i.value.matched[s.value]));Xo(Vw,Gi((()=>s.value+1))),Xo(Ww,l),Xo(Hw,i);const c=Vt();return Lr((()=>[c.value,l.value,e.name]),((e,t)=>{let[n,o,r]=e,[i,a,s]=t;o&&(o.instances[r]=n,a&&a!==o&&n&&n===i&&(o.leaveGuards.size||(o.leaveGuards=a.leaveGuards),o.updateGuards.size||(o.updateGuards=a.updateGuards))),!n||!o||a&&ow(o,a)&&i||(o.enterCallbacks[r]||[]).forEach((e=>e(n)))}),{flush:"post"}),()=>{const t=i.value,r=e.name,a=l.value,s=a&&a.components[r];if(!s)return t$(o.default,{Component:s,route:t});const u=a.props[r],d=u?!0===u?t.params:"function"==typeof u?u(t):u:null,p=Ki(s,Ay({},d,n,{onVnodeUnmounted:e=>{e.component.isUnmounted&&(a.instances[r]=null)},ref:c}));return t$(o.default,{Component:p,route:t})||p}}});function t$(e,t){if(!e)return null;const n=e(t);return 1===n.length?n[0]:n}const n$=e$;function o$(e){const t=function(e,t){const n=[],o=new Map;function r(e,n,o){const s=!o,l=function(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:Lw(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}}}(e);l.aliasOf=o&&o.record;const c=Dw(t,e),u=[l];if("alias"in e){const t="string"==typeof e.alias?[e.alias]:e.alias;for(const e of t)u.push(Ay({},l,{components:o?o.record.components:l.components,path:e,aliasOf:o?o.record:l}))}let d,p;for(const t of u){const{path:u}=t;if(n&&"/"!==u[0]){const e=n.record.path,o="/"===e[e.length-1]?"":"/";t.path=n.record.path+(u&&o+u)}if(d=Aw(t,n,c),o?o.alias.push(d):(p=p||d,p!==d&&p.alias.push(d),s&&e.name&&!Ow(d)&&i(e.name)),Nw(d)&&a(d),l.children){const e=l.children;for(let t=0;t<e.length;t++)r(e[t],d,o&&o.children[t])}o=o||d}return p?()=>{i(p)}:Ly}function i(e){if(yw(e)){const t=o.get(e);t&&(o.delete(e),n.splice(n.indexOf(t),1),t.children.forEach(i),t.alias.forEach(i))}else{const t=n.indexOf(e);t>-1&&(n.splice(t,1),e.record.name&&o.delete(e.record.name),e.children.forEach(i),e.alias.forEach(i))}}function a(e){const t=function(e,t){let n=0,o=t.length;for(;n!==o;){const r=n+o>>1;Cw(e,t[r])<0?o=r:n=r+1}const r=function(e){let t=e;for(;t=t.parent;)if(Nw(t)&&0===Cw(e,t))return t}(e);return r&&(o=t.lastIndexOf(r,o-1)),o}(e,n);n.splice(t,0,e),e.record.name&&!Ow(e)&&o.set(e.record.name,e)}return t=Dw({strict:!1,end:!0,sensitive:!1},t),e.forEach((e=>r(e))),{addRoute:r,resolve:function(e,t){let r,i,a,s={};if("name"in e&&e.name){if(r=o.get(e.name),!r)throw kw(1,{location:e});a=r.record.name,s=Ay(xw(t.params,r.keys.filter((e=>!e.optional)).concat(r.parent?r.parent.keys.filter((e=>e.optional)):[]).map((e=>e.name))),e.params&&xw(e.params,r.keys.map((e=>e.name)))),i=r.stringify(s)}else if(null!=e.path)i=e.path,r=n.find((e=>e.re.test(i))),r&&(s=r.parse(i),a=r.record.name);else{if(r=t.name?o.get(t.name):n.find((e=>e.re.test(t.path))),!r)throw kw(1,{location:e,currentLocation:t});a=r.record.name,s=Ay({},t.params,e.params),i=r.stringify(s)}const l=[];let c=r;for(;c;)l.unshift(c.record),c=c.parent;return{name:a,path:i,params:s,matched:l,meta:jw(l)}},removeRoute:i,clearRoutes:function(){n.length=0,o.clear()},getRoutes:function(){return n},getRecordMatcher:function(e){return o.get(e)}}}(e.routes,e),n=e.parseQuery||Uw,o=e.stringifyQuery||Fw,r=e.history,i=Gw(),a=Gw(),s=Gw(),l=qt(sw);let c=sw;Ry&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=xy.bind(null,(e=>""+e)),d=xy.bind(null,Zy),p=xy.bind(null,Qy);function m(e,i){if(i=Ay({},i||l.value),"string"==typeof e){const o=tw(n,e,i.path),a=t.resolve({path:o.path},i),s=r.createHref(o.fullPath);return Ay(o,a,{params:p(a.params),hash:Qy(o.hash),redirectedFrom:void 0,href:s})}let a;if(null!=e.path)a=Ay({},e,{path:tw(n,e.path,i.path).path});else{const t=Ay({},e.params);for(const e in t)null==t[e]&&delete t[e];a=Ay({},e,{params:d(t)}),i.params=d(i.params)}const s=t.resolve(a,i),c=e.hash||"";s.params=u(p(s.params));const m=function(e,t){const n=t.query?e(t.query):"";return t.path+(n&&"?")+n+(t.hash||"")}(o,Ay({},e,{hash:(f=c,Jy(f).replace(Hy,"{").replace(Ky,"}").replace(qy,"^")),path:s.path}));var f;const h=r.createHref(m);return Ay({fullPath:m,hash:c,query:o===Fw?Bw(e.query):e.query||{}},s,{redirectedFrom:void 0,href:h})}function f(e){return"string"==typeof e?tw(n,e,l.value.path):Ay({},e)}function h(e,t){if(c!==e)return kw(8,{from:t,to:e})}function g(e){return b(e)}function v(e){const t=e.matched[e.matched.length-1];if(t&&t.redirect){const{redirect:n}=t;let o="function"==typeof n?n(e):n;return"string"==typeof o&&(o=o.includes("?")||o.includes("#")?o=f(o):{path:o},o.params={}),Ay({query:e.query,hash:e.hash,params:null!=o.path?{}:e.params},o)}}function b(e,t){const n=c=m(e),r=l.value,i=e.state,a=e.force,s=!0===e.replace,u=v(n);if(u)return b(Ay(f(u),{state:"object"==typeof u?Ay({},i,u.state):i,force:a,replace:s}),t||n);const d=n;let p;return d.redirectedFrom=t,!a&&function(e,t,n){const o=t.matched.length-1,r=n.matched.length-1;return o>-1&&o===r&&ow(t.matched[o],n.matched[r])&&rw(t.params,n.params)&&e(t.query)===e(n.query)&&t.hash===n.hash}(o,r,n)&&(p=kw(16,{to:d,from:r}),I(r,r,!0,!1)),(p?Promise.resolve(p):$(d,r)).catch((e=>Sw(e)?Sw(e,2)?e:E(e):C(e,d,r))).then((e=>{if(e){if(Sw(e,2))return b(Ay({replace:s},f(e.to),{state:"object"==typeof e.to?Ay({},i,e.to.state):i,force:a}),t||d)}else e=S(d,r,!0,s,i);return k(d,r,e),e}))}function y(e,t){const n=h(e,t);return n?Promise.reject(n):Promise.resolve()}function w(e){const t=x.values().next().value;return t&&"function"==typeof t.runWithContext?t.runWithContext(e):e()}function $(e,t){let n;const[o,r,s]=function(e,t){const n=[],o=[],r=[],i=Math.max(t.matched.length,e.matched.length);for(let a=0;a<i;a++){const i=t.matched[a];i&&(e.matched.find((e=>ow(e,i)))?o.push(i):n.push(i));const s=e.matched[a];s&&(t.matched.find((e=>ow(e,s)))||r.push(s))}return[n,o,r]}(e,t);n=Yw(o.reverse(),"beforeRouteLeave",e,t);for(const r of o)r.leaveGuards.forEach((o=>{n.push(Kw(o,e,t))}));const l=y.bind(null,e,t);return n.push(l),O(n).then((()=>{n=[];for(const o of i.list())n.push(Kw(o,e,t));return n.push(l),O(n)})).then((()=>{n=Yw(r,"beforeRouteUpdate",e,t);for(const o of r)o.updateGuards.forEach((o=>{n.push(Kw(o,e,t))}));return n.push(l),O(n)})).then((()=>{n=[];for(const o of s)if(o.beforeEnter)if(Oy(o.beforeEnter))for(const r of o.beforeEnter)n.push(Kw(r,e,t));else n.push(Kw(o.beforeEnter,e,t));return n.push(l),O(n)})).then((()=>(e.matched.forEach((e=>e.enterCallbacks={})),n=Yw(s,"beforeRouteEnter",e,t,w),n.push(l),O(n)))).then((()=>{n=[];for(const o of a.list())n.push(Kw(o,e,t));return n.push(l),O(n)})).catch((e=>Sw(e,8)?e:Promise.reject(e)))}function k(e,t,n){s.list().forEach((o=>w((()=>o(e,t,n)))))}function S(e,t,n,o,i){const a=h(e,t);if(a)return a;const s=t===sw,c=Ry?history.state:{};n&&(o||s?r.replace(e.fullPath,Ay({scroll:s&&c&&c.scroll},i)):r.push(e.fullPath,i)),l.value=e,I(e,t,n,s),E()}let _;let P,M=Gw(),T=Gw();function C(e,t,n){E(e);const o=T.list();return o.length&&o.forEach((o=>o(e,t,n))),Promise.reject(e)}function E(e){return P||(P=!e,_||(_=r.listen(((e,t,n)=>{if(!L.listening)return;const o=m(e),i=v(o);if(i)return void b(Ay(i,{replace:!0}),o).catch(Ly);c=o;const a=l.value;var s,u;Ry&&(s=mw(a.fullPath,n.delta),u=pw(),fw.set(s,u)),$(o,a).catch((e=>Sw(e,12)?e:Sw(e,2)?(b(e.to,o).then((e=>{Sw(e,20)&&!n.delta&&n.type===lw.pop&&r.go(-1,!1)})).catch(Ly),Promise.reject()):(n.delta&&r.go(-n.delta,!1),C(e,o,a)))).then((e=>{(e=e||S(o,a,!1))&&(n.delta&&!Sw(e,8)?r.go(-n.delta,!1):n.type===lw.pop&&Sw(e,20)&&r.go(-1,!1)),k(o,a,e)})).catch(Ly)}))),M.list().forEach((t=>{let[n,o]=t;return e?o(e):n()})),M.reset()),e}function I(t,n,o,r){const{scrollBehavior:i}=e;if(!Ry||!i)return Promise.resolve();const a=!o&&function(e){const t=fw.get(e);return fw.delete(e),t}(mw(t.fullPath,0))||(r||!o)&&history.state&&history.state.scroll||null;return hn().then((()=>i(t,n,a))).then((e=>e&&function(e){let t;if("el"in e){const n=e.el,o="string"==typeof n&&n.startsWith("#"),r="string"==typeof n?o?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!r)return;t=function(e,t){const n=document.documentElement.getBoundingClientRect(),o=e.getBoundingClientRect();return{behavior:t.behavior,left:o.left-n.left-(t.left||0),top:o.top-n.top-(t.top||0)}}(r,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(null!=t.left?t.left:window.scrollX,null!=t.top?t.top:window.scrollY)}(e))).catch((e=>C(e,t,n)))}const R=e=>r.go(e);let A;const x=new Set,L={currentRoute:l,listening:!0,addRoute:function(e,n){let o,r;return yw(e)?(o=t.getRecordMatcher(e),r=n):r=e,t.addRoute(r,o)},removeRoute:function(e){const n=t.getRecordMatcher(e);n&&t.removeRoute(n)},clearRoutes:t.clearRoutes,hasRoute:function(e){return!!t.getRecordMatcher(e)},getRoutes:function(){return t.getRoutes().map((e=>e.record))},resolve:m,options:e,push:g,replace:function(e){return g(Ay(f(e),{replace:!0}))},go:R,back:()=>R(-1),forward:()=>R(1),beforeEach:i.add,beforeResolve:a.add,afterEach:s.add,onError:T.add,isReady:function(){return P&&l.value!==sw?Promise.resolve():new Promise(((e,t)=>{M.add([e,t])}))},install(e){e.component("RouterLink",Xw),e.component("RouterView",n$),e.config.globalProperties.$router=this,Object.defineProperty(e.config.globalProperties,"$route",{enumerable:!0,get:()=>Gt(l)}),Ry&&!A&&l.value===sw&&(A=!0,g(r.location).catch((e=>{})));const t={};for(const e in sw)Object.defineProperty(t,e,{get:()=>l.value[e],enumerable:!0});e.provide(qw,this),e.provide(zw,Tt(t)),e.provide(Hw,l);const n=e.unmount;x.add(e),e.unmount=function(){x.delete(e),x.size<1&&(c=sw,_&&_(),_=null,l.value=sw,A=!1,P=!1),n()}}};function O(e){return e.reduce(((e,t)=>e.then((()=>w(t)))),Promise.resolve())}return L}function r$(){return Zo(qw)}function i$(e){return Zo(zw)}const a$={openerElement:null,element:null,isVueDropdownVisible:null};function s$(){return document.body.classList.contains("player-visible")?document.body.querySelector(".global-player").getBoundingClientRect().height:0}function l$(){return document.body.classList.contains("nav-bar-visible")&&"none"!==getComputedStyle(document.body.querySelector("site-nav-bar")).display?document.body.querySelector(".nav-bar").getBoundingClientRect().height:0}function c$(){return"none"!==getComputedStyle(document.body.querySelector(".title-bar")).display?document.body.querySelector(".title-bar").getBoundingClientRect().height:0}function u$(e,t,n){let{...o}=n;const r=s$(),i=l$(),a=c$(),s=d$(e),l=s.scrollHeight-r-i,c=e.getBoundingClientRect(),u=t.getBoundingClientRect(),d=window.scrollY,p="parent"===o.dropdownMenuContainer?{left:0,top:"calc(100% + 4px)"}:{left:`${Math.min(c.left,s.scrollWidth-u.width-8)}px`,top:`${c.bottom+d+4}px`},m=function(){try{return t.querySelector(":scope > .selected")}catch(e){return}}()||t.firstElementChild;!o.dropdownDirection&&c.bottom+u.height+d>l&&(o.dropdownDirection="parent"===o.dropdownMenuContainer?"up":"auto"),"parent"===o.dropdownMenuContainer?"right"===o.dropdownMenuAlign?(p.left="auto",p.right=0):"center"===o.dropdownMenuAlign&&(p.left=`-${(u.width-c.width)/2}px`):"center"===o.dropdownMenuAlign?p.left=c.left+c.width/2-u.width/2+"px":"right"===o.dropdownMenuAlign&&(p.left=c.right-u.width+"px");const f=c.top-u.height+d-4-a>0;if("up-down"===o.dropdownDirection&&t.classList.add(f?"dropdown-direction-up":"dropdown-direction-down"),"up"===o.dropdownDirection||"up-down"===o.dropdownDirection&&f)if("parent"===o.dropdownMenuContainer)p.bottom="calc(100% + 4px)",p.top="auto";else{const e=c.top-u.height+d-4;if(o.dropdownMenuScrollable&&e<0){const t=8;p.top=`${t}px`,p["--dropdown-menu-item-list-max-height"]=u.height+e-t+"px"}else p.top=`${e}px`}else if("center"===o.dropdownDirection)"parent"===o.dropdownMenuContainer?p.top=(c.height-u.height)/2+"px":p.top=c.top-(u.height-c.height)/2+"px";else if("right"===o.dropdownDirection)p.left=`${c.right+4}px`,c.top+u.height>l?p.top=l-u.height+"px":p.top=`${c.top}px`;else if("auto"===o.dropdownDirection&&m){const e=m.getBoundingClientRect();p.top=`${c.top-(e.top-u.top)+d}px`,p.maxHeight=`${u.height}px`,parseInt(p.top)+parseInt(p.maxHeight)>l?(p.maxHeight=`${Math.min(u.height,l-4)}px`,p.top=`${Math.max(l-u.height-4,0)}px`):parseInt(p.top)<0&&(p.maxHeight=`${Math.min(u.height,l-4)}px`,p.top=0),p.minWidth=`${c.width}px`,u.height>l&&(p.overflow="auto")}const h="up"===o.dropdownDirection||"up-down"===o.dropdownDirection&&f?"bottom":"top";p.transformOrigin=`${o.dropdownMenuAlign||"left"} ${h}`;for(const[e,n]of Object.entries(p))e.includes("--")?t.style.setProperty(e,n):t.style[e]=n}function d$(e){return e.closest(".modal-overlay")||e.closest(".view-overlay")||document.body}function p$(e){[...e].forEach((function(e){var t=e.parentElement.getBoundingClientRect();const n=e.style.transition;e.style.transition="none",e.scrollWidth+t.right>window.innerWidth?e.style.right="100%":e.style.left="100%",e.offsetHeight+t.top>window.innerHeight&&(e.style.top=`${Math.max(window.innerHeight-e.offsetHeight-t.top,-t.top)}px`,e.clientHeight>window.innerHeight&&(e.style.maxHeight=`${window.innerHeight}px`,e.style.overflow="auto")),p$(e.querySelectorAll(".dropdown-cascading-item > ul")),e.style.transition=n,e.style.visibility="hidden"}))}function m$(e,t,n){const o=n?n.getBoundingClientRect():{width:0,height:0},r=t.getBoundingClientRect(),i=parseInt(getComputedStyle(t).maxHeight),a=e.getBoundingClientRect(),s=d$(e);let l=r.height;const c=Math.max(Math.min(a.left+a.width/2-r.width/2,s.scrollWidth-r.width),20),u={height:"auto",left:`${c}px`,transformOrigin:"left top",minWidth:`${a.width}px`};i&&(l=Math.min(i,a.top-o.height-4+window.scrollY),u.height=`${l}px`),a.top-o.height-l<0?(u.top=`${a.bottom+o.height+4}px`,n.classList.add("mix-editor-flyout-caret-top")):u.bottom=`${window.innerHeight-a.top+o.height+4}px`;for(const[e,n]of Object.entries(u))t.style[e]=n;n&&(n.style.left=a.left-c+(a.width-o.width)/2+"px")}function f$(){return au.get("https://bandlab-sounds.firebaseio.com/browse/collections.json").json().then((e=>Promise.all(Object.entries(e).map((e=>{let[t,n]=e;return h$({collectionId:t}).then((e=>({...e.data,browseDetails:n})))})))))}function h$(e){let{collectionId:t}=e;return Uu.get(`${N$()}/collections/${t}`).json()}const g$=new Map;function v$(){let{after:e,packs:t=[],collectionId:n,query:o,limit:r=24,genres:i=[],characters:a=[],ids:l=[],features:c="loop",sort:u="recent",signal:d,isLibraryView:p,userId:m}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e&&g$.get(e)!==o)return Promise.reject(new DOMException("Mismatch cursor","AbortError"));const f=p?`${N$()}/users/${m}/packs`:`${N$()}/packs`;return Uu.get(f,{searchParams:{...e?{after:e}:{},...a.length?{characters:a.sort(((e,t)=>e.localeCompare(t))).join(",")}:{},...n?{collectionId:n}:{},features:c,...i.length?{genres:i.sort(((e,t)=>e.localeCompare(t))).join(",")}:{},...l.length?{ids:l.join(",")}:{},limit:r,...o?{query:o}:{},..."recent"===u?{sort:p?"recentAdd":"recentRelease"}:{sort:u}},signal:d,kyCache:!p&&"random"!==u}).then((e=>e.json())).then((function(e){const n=e.data,r=e.availableFilters||[],i=e.paging?.cursors?.after,a=e.paging?.totalCount;return 0!==n.length||1!==l.length||s.get("sessionKey")?(g$.set(i,o),{after:i,totalCount:a,packs:t.concat(n),availableLoopsPerCharacter:k$(r,"characters"),availableLoopsPerGenre:k$(r,"genres"),availableLoopsPerInstrument:k$(r,"instruments")}):y$({packId:l[0]}).then((function(e){let{data:t}=e;return{packs:t}}))}))}function b$(){let{after:e,characters:t=[],direction:n,genres:o=[],instruments:r=[],loops:i=[],packId:a,packIds:l=[],query:c,limit:u=50,features:d="loop,oneShot",bpm:p,keys:m,signal:f,sort:h="recent",isLibraryView:g,isUploads:v,collectionId:b,userId:y,ids:w=""}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e&&g$.get(e)!==c)return Promise.reject(new DOMException("Mismatch cursor","AbortError"));const $=g?b?`${N$()}/users/${y}/collections/${b}`:`${N$()}/users/${y}/samples`:v?`${N$()}/users/${y}/uploads/samples`:`${N$()}/samples`;return Uu.get($,{searchParams:{...e?{after:e}:{},...p?{bpm:p}:{},...t.length?{characters:t.sort(((e,t)=>e.localeCompare(t))).join(",")}:{},...n?{direction:n}:{},...d?{features:d}:{},...o.length?{genres:o.sort(((e,t)=>e.localeCompare(t))).join(",")}:{},...r.length?{instruments:r.sort(((e,t)=>e.localeCompare(t))).join(",")}:{},limit:u,...m?{keys:m}:{},...a?{packId:a}:{},...l.length?{packIds:l.sort(((e,t)=>e.localeCompare(t))).join(",")}:{},...c?{query:c}:{},..."recent"!==h||v?{sort:h}:{sort:g?"recentAdd":"recentRelease"},...w?{ids:w}:{}},signal:f}).then((e=>e.json())).then((function(e){const t=e.data,n=e.availableFilters||[],o=e.paging?.cursors?.after,r=e.paging?.totalCount;return 0===t.length&&a&&!s.get("sessionKey")?y$({packId:a}).then((function(e){let{data:t}=e;return{loops:t[0].samples}})):(g$.set(o,c),{after:o,totalCount:r,loops:i.concat(t),availableLoopsPerCharacter:k$(n,"characters"),availableLoopsPerGenre:k$(n,"genres"),availableLoopsPerInstrument:k$(n,"instruments")})}))}function y$(e){let{packId:t}=e;return Uu.get(`https://www.bandlab.com/api/v3.0/sounds-public/packs/${t}/preview`).json()}function w$(){let{signal:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Uu.get(`${N$()}/packs/filters`,{signal:e,kyCache:!0}).json().then((function(e){return{characters:e.find((e=>"characters"===e.id))?.subfilters,instruments:e.find((e=>"instruments"===e.id))?.subfilters,genres:e.find((e=>"genres"===e.id))?.subfilters,keys:e.find((e=>"keys"===e.id))?.subfilters}}))}function $$(){let{signal:e,features:t="loop,oneShot"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Uu.get(`${N$()}/samples/filters`,{searchParams:{features:t},signal:e,kyCache:!0}).json().then((function(e){return{characters:e.find((e=>"characters"===e.id)).subfilters,instruments:e.find((e=>"instruments"===e.id)).subfilters,genres:e.find((e=>"genres"===e.id)).subfilters}}))}function k$(e,t){return e.find((e=>e.id===t))?.subfilters.reduce((function(e,t){return e[t.id]=t.count,e}),{})}function S$(e){return Uu.get(e.audioUrlWav||e.audioUrlOriginal).arrayBuffer()}function _$(){let{releaseDateStart:e,releaseDateEnd:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Uu.get("https://www.bandlab.com/api/v3.0/sounds-public/premium/packs",{searchParams:{...e?{releaseDateStart:e}:{},...t?{releaseDateEnd:t}:{}}}).json().then((function(e){let{data:t,availableFilters:n=[],paging:{cursors:{after:o}={},totalCount:r}={}}=e;return{after:o,totalCount:r,packs:t,availableLoopsPerCharacter:k$(n,"characters"),availableLoopsPerGenre:k$(n,"genres"),availableLoopsPerInstrument:k$(n,"instruments")}}))}function P$(e){let{userId:t}=e;return Uu.get(`https://www.bandlab.com/api/v3.0/sounds/users/${t}/packs/redeemed`).json().then((function(e){let{data:t}=e;return{packs:t}}))}function M$(e){return Uu.get(`${N$()}/premium/packs/${e}/redeem`).json().then((e=>e.data))}function T$(e){return Uu.get(`${N$()}/redeem/${e}`).json().then((function(e){return e.data})).catch((function(e){const t={404:"This redemption code does not exist or has expired",400:"This redemption code format is incorrect",409:"Uh oh! This redemption code has already been used"};if(t[e.response.status])throw t[e.response.status];e.response.json().then((function(e){throw e.message}))}))}function C$(e){let{userId:t,objectId:n}=e;return Uu.put(`https://www.bandlab.com/api/v3.0/sounds/users/${t}/samples/${n}`).json().catch((function(e){return D$(e)}))}function E$(e){let{userId:t}=e;return Uu.get(`https://www.bandlab.com/api/v3.0/sounds/users/${t}/libraries/samples`).then((e=>e.json())).then((function(e){return{ids:e.data.ids,idsCount:e.data.idsCount}}))}function I$(e){let{userId:t}=e;return Uu.get(`https://www.bandlab.com/api/v3.0/sounds/users/${t}/libraries/packs`).then((e=>e.json())).then((function(e){return{ids:e.data.ids,idsCount:e.data.idsCount}}))}function R$(e){let{userId:t,objectId:n}=e;return Uu.put(`https://www.bandlab.com/api/v3.0/sounds/users/${t}/packs/${n}`).json().catch((function(e){return D$(e)}))}function A$(e){let{userId:t,sort:n="recent"}=e;return Uu.get(`https://www.bandlab.com/api/v3.0/sounds/users/${t}/collections`,{searchParams:{sort:n}}).then((e=>e.json())).then((function(e){return e.data}))}function x$(e){let{userId:t}=e;return Uu.get(`https://www.bandlab.com/api/v3.0/sounds/users/${t}/uploads`).json().then((function(e){return e})).catch((function(e){return D$(e)}))}function L$(e){let{userId:t,fileObject:n}=e;return Uu.post(`https://www.bandlab.com/api/v3.0/sounds/users/${t}/uploads/samples`,{json:n}).json().catch((function(e){return D$(e)}))}function O$(e){let{userId:t,sampleId:n}=e;return Uu.delete(`https://www.bandlab.com/api/v3.0/sounds/users/${t}/uploads/samples/${n}`,{keepalive:!0}).json().catch((function(e){return D$(e)}))}function j$(e){return Uu.get("https://www.bandlab.com/api/v3.0/sounds/suggestions",{searchParams:{...""===e?{}:{query:e}},kyCache:!0}).json().catch((function(e){return D$(e)}))}function D$(e){if(!e.response)throw new Error;return e.response.json().then((function(e){throw e}))}function N$(){return s.get("sessionKey")?"https://www.bandlab.com/api/v3.0/sounds":"https://www.bandlab.com/api/v3.0/sounds-public"}var U$="[object Map]",F$="[object Set]",B$=Object.prototype.hasOwnProperty;function W$(e){if(null==e)return!0;if(Wm(e)&&(im(e)||"string"==typeof e||"function"==typeof e.splice||wm(e)||xm(e)||gm(e)))return!e.length;var t=cf(e);if(t==U$||t==F$)return!e.size;if(Dm(e))return!Bm(e).length;for(var n in e)if(B$.call(e,n))return!1;return!0}const V$=Tt(new Set),q$=Tt(new Set);function z$(e,t){let{onDismiss:n=()=>{},onEscapeKeyDown:o=()=>{},onPointerDownOutside:r=()=>{}}=t;const i=V$.size>0,a=Gi((function(){return Array.from(V$)})),s=Gi((function(){return a.value.indexOf(e)})),l=Gi((function(){return[...q$].slice(-1)[0]})),c=Gi((function(){const e=a.value.indexOf(l.value);return s.value>=e})),u=Ar((function(){i&&(0===q$.size&&(document.body.style.pointerEvents="none"),q$.add(e)),V$.add(e),e.style.pointerEvents=q$.size>0?c.value?"auto":"none":""})),d=setTimeout((function(){document.addEventListener("keydown",f),document.addEventListener("pointerdown",p)}));return function(){clearTimeout(d),u(),document.removeEventListener("click",m),document.removeEventListener("keydown",f),document.removeEventListener("pointerdown",p),1===q$.size&&(document.body.style.pointerEvents=""),q$.delete(e),V$.delete(e)};function p(t){c.value&&!e.contains(t.target)&&("touch"===t.pointerType?(document.removeEventListener("click",m),document.addEventListener("click",m,{once:!0})):m(t))}function m(e){r(e),e.defaultPrevented||n()}function f(e){"Escape"===e.key&&s.value===V$.size-1&&(o(e),e.defaultPrevented||(e.preventDefault(),n()))}}function H$(){const e=Vt(!1),t=Vt(null),n=Vt((()=>{})),o=Vt(null);return Lr(e,(async function(){e.value?(await hn(),n.value=z$(t.value,{onDismiss:r}),o.value.addEventListener("pointerdown",i),a$.isVueDropdownVisible=e):(n.value(),o.value?.removeEventListener("pointerdown",i))})),uo((function(){n.value()})),{isDropdownMenuVisible:e,dropdownMenuElement:t,open:function(){e.value=!e.value},triggerElement:o};function r(){e.value=!1}function i(e){o.value.contains(e.target)&&e.stopPropagation()}}const G$=["width","height","aria-hidden"],K$=[bi("path",{fill:"currentColor","fill-rule":"evenodd",d:"M10 1a9 9 0 1 0 0 18 9 9 0 0 0 0-18m-7 9a7 7 0 1 1 14 0 7 7 0 0 1-14 0","clip-rule":"evenodd"},null,-1),bi("path",{fill:"currentColor",d:"m22.7 21.3-4-4-1.4 1.4 4 4z"},null,-1)],Y$={__name:"search",props:{size:{type:Number,required:!0}},setup:e=>(t,n)=>(si(),pi("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none","aria-hidden":t.$attrs["aria-label"]||t.$attrs["aria-labelledby"]?null:"true"},K$,8,G$))},J$=Object.freeze(Object.defineProperty({__proto__:null,default:Y$},Symbol.toStringTag,{value:"Module"})),X$={class:"search-form-input-container"},Z$=["aria-label"],Q$={class:"search-form-submit"},ek=["aria-label"],tk=Vn({inheritAttrs:!1,__name:"AdvancedSearchInput",props:{modelValue:{},size:{default:32},debounceDelay:{default:0},isShowClearAll:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1}},emits:["submit","update:modelValue","clearAll"],setup(e,t){let{emit:n}=t;const o=e,r=n,i=Ao(),a=Vt(null),s=Vt(null),l=ay((function(e){r("update:modelValue",e)}),o.debounceDelay),c=Gi({get:()=>o.modelValue,set(e){l(e)}});let u;function d(){c.value="",a.value?.focus(),""===c.value&&s.value&&s.value.scrollTo({left:0}),r("clearAll")}return ao((function(){s.value&&(u=new MutationObserver((()=>{s.value&&s.value.scrollTo({left:s.value.scrollWidth-s.value.clientWidth,behavior:"smooth"})})),u.observe(s.value,{childList:!0,subtree:!0}))})),uo((()=>{u.disconnect()})),Lr(c,(()=>{const e=i.maxlength;if(e&&c.value.length>e&&(c.value=c.value.slice(0,e)),a.value){const e=Math.max(100,7*c.value.length);a.value.style.minWidth=`${e}px`}})),(e,t)=>(si(),pi("form",{class:ae(["search-form search-form-max-width",`search-form-${o.size}`]),role:"search",onSubmit:t[1]||(t[1]=ss((e=>r("submit",e)),["prevent"]))},[bi("div",X$,[Po(e.$slots,"fixed"),bi("span",{ref_key:"searchInputScrollableRef",ref:s,class:"search-form-input-scrollable"},[Po(e.$slots,"scrollable"),Cn(bi("input",Ci({ref_key:"inputRef",ref:a,"onUpdate:modelValue":t[0]||(t[0]=e=>c.value=e),class:"search-form-text",type:"search","aria-label":"Search"},e.$attrs),null,16,Z$),[[Ya,c.value,void 0,{trim:!0}]])],512),bi("span",Q$,[yi(Y$,{size:16})]),!c.value&&!e.isShowClearAll||e.isLoading?_i("v-if",!0):(si(),pi("button",{key:0,class:"search-form-clear",type:"button","aria-label":"Clear",onClick:d},[yi(Bd,{size:16})],8,ek)),e.isLoading?(si(),mi(Ld,{key:1,size:16,class:"search-form-loader",style:{animation:"rotate-clockwise 1s linear infinite"}})):_i("v-if",!0)]),Po(e.$slots,"suggestions")],34))}}),nk={key:1,class:"inline-tag-text"},ok=["aria-label"],rk={__name:"InlineTag",props:{size:{required:!0,validator:e=>["default","compact"].includes(e)},shape:{required:!0,validator:e=>["rounded","squared"].includes(e)}},emits:["remove"],setup(e,t){let{emit:n}=t;const o=e,r=n;return(e,t)=>(si(),pi("span",{class:ae(["inline-tag",[`inline-tag-size-${o.size}`,`inline-tag-${o.shape}`]])},[e.$slots["left-detail"]?Po(e.$slots,"left-detail",{key:0}):_i("v-if",!0),e.$slots.default?(si(),pi("span",nk,[Po(e.$slots,"default")])):_i("v-if",!0),bi("button",{type:"button",class:"inline-tag-remove-button","aria-label":"Remove",onClick:t[0]||(t[0]=e=>r("remove"))},[yi(Bd,{size:24})],8,ok)],2))}},ik=["width","height","aria-hidden"],ak=[bi("path",{fill:"currentColor",d:"M4 4h16V2H4z"},null,-1),bi("path",{fill:"currentColor","fill-rule":"evenodd",d:"M2 6h7v2H4v10c0 1.1.9 2 2 2h12a2 2 0 0 0 2-2V8h-5v7a3 3 0 1 1-2-2.83V6h9v12a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4zm10 8a1 1 0 1 1 0 2 1 1 0 0 1 0-2","clip-rule":"evenodd"},null,-1)],sk={__name:"sounds-packs",props:{size:{type:Number,required:!0}},setup:e=>(t,n)=>(si(),pi("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none","aria-hidden":t.$attrs["aria-label"]||t.$attrs["aria-labelledby"]?null:"true"},ak,8,ik))},lk=Object.freeze(Object.defineProperty({__proto__:null,default:sk},Symbol.toStringTag,{value:"Module"})),ck=["width","height","aria-hidden"],uk=[bi("path",{fill:"currentColor","fill-rule":"evenodd",d:"M17.7 9.7 11 16.42l-4.7-4.7 1.4-1.42 3.3 3.3 5.3-5.3z","clip-rule":"evenodd"},null,-1)],dk={__name:"checkmark-checkbox",props:{size:{type:Number,required:!0}},setup:e=>(t,n)=>(si(),pi("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none","aria-hidden":t.$attrs["aria-label"]||t.$attrs["aria-labelledby"]?null:"true"},uk,8,ck))},pk=Object.freeze(Object.defineProperty({__proto__:null,default:dk},Symbol.toStringTag,{value:"Module"})),mk=["width","height","aria-hidden"],fk=[bi("path",{fill:"currentColor",d:"M19 13v-2H5v2z"},null,-1)],hk={__name:"dash",props:{size:{type:Number,required:!0}},setup:e=>(t,n)=>(si(),pi("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none","aria-hidden":t.$attrs["aria-label"]||t.$attrs["aria-labelledby"]?null:"true"},fk,8,mk))},gk=Object.freeze(Object.defineProperty({__proto__:null,default:hk},Symbol.toStringTag,{value:"Module"})),vk={components:{CheckmarkCheckbox:dk,Dash:hk},props:{modelValue:{type:[Boolean,String,Array],required:!0},checkboxId:{type:String,required:!0}},emits:["update:modelValue"],setup(e,t){let{attrs:n,emit:o}=t;const r=Gi({get:()=>Array.isArray(e.modelValue)?e.modelValue.includes(n.value):e.modelValue,set(e){o("update:modelValue",e)}});return{attrs:n,isChecked:r,onClick:function(){if(!n.disabled)if(Array.isArray(e.modelValue))if(r.value){const t=e.modelValue.slice();t.splice(e.modelValue.indexOf(n.value),1),r.value=t}else r.value=e.modelValue.concat([n.value]);else"mixed"===r.value?r.value=!0:r.value=!r.value}}}},bk=["checked","disabled"],yk=["id","aria-checked"],wk=ld(vk,[["render",function(e,t,n,o,r,i){const a=vo("Dash"),s=vo("CheckmarkCheckbox");return si(),pi(ti,null,[bi("input",{type:"checkbox",class:"visually-hidden checkbox-input",tabindex:"-1","aria-hidden":"true",checked:o.isChecked,disabled:o.attrs.disabled},null,8,bk),bi("button",Ci({id:n.checkboxId,type:"button",role:"checkbox",class:"checkbox-box","aria-checked":o.isChecked},o.attrs,{onClick:t[0]||(t[0]=function(){return o.onClick&&o.onClick(...arguments)}),onKeydown:t[1]||(t[1]=cs(ss((()=>{}),["prevent"]),["enter"]))}),["mixed"===o.isChecked?(si(),mi(a,{key:0,size:16,class:"checkbox-box-svg"})):!0===o.isChecked?(si(),mi(s,{key:1,size:16,class:"checkbox-box-svg"})):_i("v-if",!0)],16,yk)],64)}]]),$k={key:0,class:"search-form-fixed typography-footnote-regular"},kk={key:1,class:"search-form-fixed typography-footnote-regular"},Sk={key:0,class:"search-form-tags typography-footnote-regular"},_k={class:"search-form-tag-secondary"},Pk=["aria-selected","aria-checked"],Mk={for:"searchInPackCheckboxId",class:"sounds-search-find-in-option-checkbox-label"},Tk=["aria-selected","aria-checked"],Ck={for:"searchInCollectionCheckboxId",class:"sounds-search-find-in-option-checkbox-label"},Ek=["aria-selected"],Ik=["id","aria-selected","onClick","onMousemove"],Rk={key:0,class:"typography-footnote-regular sounds-search-results-tag-header"},Ak={class:"sounds-search-results-p"},xk={class:"sounds-search-results-tags"},Lk={class:"search-form-tag-secondary"},Ok=Vn({__name:"SoundsSearch",props:{inputSize:{default:32},isTagsInInput:{type:Boolean,default:!0},placeholder:{default:"Search"}},setup(e){const t=e,n=Zo("Me"),o=i$(),r=r$(),i=Vt(""),a={character:{displayName:"Character",queryType:"characters"},genre:{displayName:"Genre",queryType:"genres"},instrument:{displayName:"Instrument",queryType:"instruments"},bpm:{displayName:"BPM",queryType:"bpm"},key:{displayName:"Key",queryType:"keys"},feature:{displayName:"Type",queryType:"features"},pack:{displayName:"Pack",queryType:"packId"},collection:{displayName:"Collection",queryType:"mySoundsCollectionId"}};let s=!1;const l=Vt({}),c=Vt([]);async function u(){if(0===Object.values(l.value).length||s||"sounds.searchResults"!==o.name)return void(c.value=[]);let e=[];for(const t in o.query)if(Object.prototype.hasOwnProperty.call(o.query,t)&&"query"!==t&&"sort"!==t&&"direction"!==t){if(!(t in _S))continue;const r=o.query[t];if(Array.isArray(r)||!r)continue;if("packId"===t){const{packs:t}=await v$({ids:[r]}),n={slug:r,keyword:t[0].name,type:"pack"};e=[...e,n]}else if("mySoundsCollectionId"===t){if(0===hS.value.length&&await A$({userId:n.id}),hS.value.length>0){const t=hS.value.find((e=>e.collectionId===o.query.mySoundsCollectionId));if(!t)return;const n={slug:r,keyword:t.displayName,type:"collection"};e=[...e,n]}}else if("keys"===t){const t=r.split(",").map((e=>({slug:e,keyword:Qk(e).join(" / "),type:"key"})));e=[...e,...t]}else if("bpm"===t&&o.query.bpm){const t=r.split("-"),n=t[0]===t[1]?t[0]:`${t[0]} - ${t[1]}`,i={slug:o.query.bpm,keyword:n,type:"bpm"};e=[...e,i]}else{const n=r.split(",");e=[...e,...n.map((e=>l.value[`${e}_${t}`]))]}}const t=e.filter((e=>!c.value.some((t=>t.slug===e.slug))));c.value=[...c.value.filter((t=>e.some((e=>e.slug===t.slug)))),...t]}const d=Vt([]),p=Vt(!1),m=Vt(null),f=Gi((()=>m.value?document.getElementById(m.value):null)),{isDropdownMenuVisible:h,dropdownMenuElement:g,open:v,triggerElement:b}=H$(),y=Gi((()=>b.value?b.value.querySelector("input"):null)),w=Gi((()=>"sounds.pack"===o.name||"sounds.mySounds.collection"===o.name)),$=Vt("sounds.pack"===o.name),k=Vt("sounds.mySounds.collection"===o.name);function S(){if(""===i.value)return d.value=[],h.value&&!w.value&&v(),void(p.value=!1);y.value&&document.activeElement===y.value&&(p.value=!0),_(i.value)}ao((()=>{i.value=o.query.query||"",s=!0,w$().then((function(e){return P(e),$$()})).then((function(e){P(e),function(){for(const[e,t]of Object.entries(Hk))l.value={...l.value,[t]:{slug:t,type:"key",keyword:e}}}(),l.value={...l.value,loop_features:{slug:"loop",type:"feature",keyword:"Loop"},oneShot_features:{slug:"oneShot",type:"feature",keyword:"One Shot"}}})).finally((()=>{s=!1,u()})),S(),u()})),Lr((()=>o.name),(()=>{$.value="sounds.pack"===o.name,k.value="sounds.mySounds.collection"===o.name})),Lr((()=>o.query),(()=>{i.value=o.query.query||"",S(),u()})),Lr(i,(()=>{T(),S()})),Lr(h,(()=>{m.value=null}));const _=ay((e=>j$(e).then((t=>{e===i.value&&(d.value=[],t.forEach((e=>{if("bpm"===e.type||"key"===e.type)return;if("sounds.searchResults"!==o.name)return void d.value.push(e);const t=a[e.type].queryType;-1===((o.query[t]||"").split(",")||[]).indexOf(e.slug)&&d.value.push(e)})),p.value=!1,y.value&&document.activeElement!==y.value||!h.value&&i.value&&v())})).catch((()=>{d.value=[],p.value=!1})).finally((()=>{f.value||(m.value=null)}))),500);function P(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&e[t].forEach((e=>{l.value={...l.value,[`${e.id}_${t}`]:{slug:e.id,type:_S[t],keyword:e.name}}}))}function M(){const e=Yk({..."sounds.searchResults"===o.name?o.query:{},...$.value?{packId:o.params.id}:{},...k.value?{mySoundsCollectionId:o.params.id}:{},query:i.value});r.push({name:"sounds.searchResults",params:{tab:o.params.tab??""},query:e}),y.value?.blur()}function T(){m.value=null}function C(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=a[e.type].queryType,i=(o.query[n]||"").split(","),s=i.indexOf(e.slug);i&&i.length>0&&-1!==s&&i.splice(s,1);const l=Yk({...o.query,[n]:i?.join(","),...t?{query:""}:{}});W$(l)?r.push({name:"sounds.browse"}):r.push({name:o.name,params:o.params,query:l}),y.value?.focus()}function E(e){switch(e.key){case"Backspace":case"Delete":t.isTagsInInput&&(""===i.value||!i.value)&&c.value.length>0&&C(c.value[c.value.length-1],!0);break;case"ArrowDown":if(e.preventDefault(),!g.value)return;f.value?m.value=f.value.nextElementSibling?.id??null:m.value=g.value.firstElementChild?.id??null;break;case"ArrowUp":if(e.preventDefault(),!g.value)return;f.value?m.value=f.value.previousElementSibling?.id??null:m.value=g.value.lastElementChild?.id??null}}function I(){if(f.value)return void f.value.click();if(""===i.value&&"sounds.searchResults"!==o.name)return;const e={..."sounds.searchResults"===o.name?o.query:{},...$.value?{packId:o.params.id}:{},...k.value?{mySoundsCollectionId:o.params.id}:{},query:i.value};""===i.value&&delete e.query,W$(e)?r.push({name:"sounds.browse"}):r.push({name:"sounds.searchResults",params:{tab:o.params.tab??""},query:e}),h.value&&v(),y.value?.blur()}function R(){if(c.value.length>0&&!t.isTagsInInput)return i.value="",void M();"sounds.searchResults"!==o.name?"sounds.pack"!==o.name?"sounds.mySounds.collection"===o.name&&(k.value=!1):$.value=!1:r.push({name:"sounds.browse"})}return(e,t)=>(si(),pi("section",null,[yi(tk,{ref:e=>{const t=e;t&&(b.value=t.$el)},modelValue:i.value,"onUpdate:modelValue":t[12]||(t[12]=e=>i.value=e),name:"search",type:"search",enterkeyhint:"send",placeholder:e.placeholder,size:e.inputSize,maxlength:"50",autofocus:"",autocomplete:"off","is-show-clear-all":c.value&&c.value.length>0&&e.isTagsInInput||$.value||k.value,"is-loading":p.value,role:"combobox","aria-haspopup":"listbox","aria-autocomplete":""!==i.value?"list":"none","aria-expanded":Gt(h),"aria-controls":"searchSuggestionsDropdown","aria-activedescendant":m.value,onClick:t[13]||(t[13]=e=>{T(),!Gt(h)&&(""!==i.value||w.value)&&Gt(v)()}),onClearAll:R,onKeydown:ss(E,["stop"]),onSubmit:I},{fixed:Tn((()=>["sounds.pack"===Gt(o).name&&$.value?(si(),pi("span",$k,me("in this pack:"),1)):_i("v-if",!0),"sounds.mySounds.collection"===Gt(o).name&&k.value?(si(),pi("span",kk,me("in this collection:"),1)):_i("v-if",!0)])),scrollable:Tn((()=>[e.isTagsInInput&&c.value&&c.value.length>0?(si(),pi("div",Sk,[(si(!0),pi(ti,null,So(c.value,(e=>(si(),mi(rk,{key:e.slug,shape:"rounded",size:"compact",onRemove:t=>C(e)},{default:Tn((()=>[ki(me(e.keyword)+" ",1),bi("span",_k,me(a[e.type].displayName),1)])),_:2},1032,["onRemove"])))),128))])):_i("v-if",!0)])),suggestions:Tn((()=>[yi(na,{name:"dropdown-transition"},{default:Tn((()=>[Gt(h)?(si(),pi("ul",{key:0,id:"searchSuggestionsDropdown",ref_key:"dropdownMenuElement",ref:g,role:"listbox","aria-label":"Search Suggestions",class:"sounds-search-dropdown"},["sounds.pack"===Gt(o).name?(si(),pi("li",{key:0,id:"findInPackOption",role:"option","aria-selected":"findInPackOption"===m.value,"aria-checked":$.value,class:"sounds-search-suggestion-option sounds-search-suggestion-checkbox-container",onMousemove:t[2]||(t[2]=e=>m.value="findInPackOption"),onMouseleave:T,onPointerdown:t[3]||(t[3]=ss((()=>{}),["prevent"])),onClick:t[4]||(t[4]=e=>$.value=!$.value)},[bi("label",Mk,[yi(sk,{size:16}),ki(" "+me("Find in this pack"),1)]),yi(wk,{modelValue:$.value,"onUpdate:modelValue":t[0]||(t[0]=e=>$.value=e),tabindex:"-1","checkbox-id":"searchInPackCheckboxId",onClick:t[1]||(t[1]=ss((()=>{}),["stop"]))},null,8,["modelValue"])],40,Pk)):_i("v-if",!0),"sounds.mySounds.collection"===Gt(o).name?(si(),pi("li",{key:1,id:"findInCollectionOption",role:"option","aria-selected":"findInCollectionOption"===m.value,"aria-checked":k.value,class:"sounds-search-suggestion-option sounds-search-suggestion-checkbox-container",onMousemove:t[7]||(t[7]=e=>m.value="findInCollectionOption"),onMouseleave:T,onPointerdown:t[8]||(t[8]=ss((()=>{}),["prevent"])),onClick:t[9]||(t[9]=e=>k.value=!k.value)},[bi("label",Ck,[yi(sk,{size:16}),ki(" "+me("Find in this collection"),1)]),yi(wk,{modelValue:k.value,"onUpdate:modelValue":t[5]||(t[5]=e=>k.value=e),tabindex:"-1","checkbox-id":"searchInCollectionCheckboxId",onClick:t[6]||(t[6]=ss((()=>{}),["stop"]))},null,8,["modelValue"])],40,Tk)):_i("v-if",!0),""!==i.value?(si(),pi("li",{key:2,id:"rawQueryOption",role:"option","aria-selected":"rawQueryOption"===m.value,class:"sounds-search-suggestion-option",onClick:t[10]||(t[10]=ss((e=>{M(),Gt(v)()}),["stop"])),onMousemove:t[11]||(t[11]=e=>m.value="rawQueryOption"),onMouseleave:T},me(i.value),41,Ek)):_i("v-if",!0),(si(!0),pi(ti,null,So(d.value,(e=>(si(),pi("li",{id:e.slug,key:e.slug,role:"option","aria-selected":m.value===e.slug,class:"sounds-search-suggestion-option",onClick:ss((t=>{!function(e){const t=a[e.type].queryType,n=o.query[t]?.split(",")||[];n.push(e.slug),r.push({name:"sounds.searchResults",..."sounds.searchResults"===o.name?{params:o.params}:{},query:Yk({..."sounds.searchResults"===o.name?o.query:{},...$.value?{packId:o.params.id}:{},...k.value?{mySoundsCollectionId:o.params.id}:{},[t]:"sounds.searchResults"===o.name?n?.join(","):e.slug,query:""})}),y.value?.focus()}(e),Gt(v)()}),["stop"]),onMousemove:t=>m.value=e.slug,onMouseleave:T},me(e.keyword),41,Ik)))),128))],512)):_i("v-if",!0)])),_:1})])),_:1},8,["modelValue","placeholder","size","is-show-clear-all","is-loading","aria-autocomplete","aria-expanded","aria-activedescendant"]),!e.isTagsInInput&&"sounds.searchResults"===Gt(o).name&&c.value&&c.value.length>0?(si(),pi("div",Rk,[bi("p",Ak,me("Results for:"),1),bi("div",xk,[(si(!0),pi(ti,null,So(c.value,(e=>(si(),mi(rk,{key:e.slug,shape:"rounded",size:"compact",onRemove:t=>C(e)},{default:Tn((()=>[ki(me(e.keyword)+" ",1),bi("span",Lk,me(a[e.type].displayName),1)])),_:2},1032,["onRemove"])))),128))])])):_i("v-if",!0)]))}}),jk={class:"dark",style:{"min-height":"100vh"}},Dk=Vn({__name:"Sounds",setup(e){const t=Zo("Me"),n=i$(),o=Vt(!1),r=Vt(null);let i=null,a=null;function s(){r.value||("sounds.searchResults"===n.name&&l("soundsSearchOnSearchPage"),"sounds.browse"===n.name&&l("soundsSearchOnBrowsePage"))}function l(e){i=new MutationObserver((()=>{r.value=document.getElementById(e),r.value&&(i?.disconnect(),a=new IntersectionObserver(u,{rootMargin:"-64px 0px 0px 0px",threshold:[0,.25,.5,.75,1]}),a.observe(r.value))})),i.observe(document.body,{childList:!0,subtree:!0})}function c(){a?.disconnect(),i?.disconnect(),r.value=null,o.value=!1}function u(e){o.value=e[0].intersectionRatio>.5}return Lr((()=>n.name),((e,t)=>{"sounds.browse"!==t&&"sounds.searchResults"!==t||!r.value||c(),s()})),ao((()=>{s()})),co((()=>{c()})),(e,i)=>{const a=vo("RouterView");return si(),pi("section",jk,[yi(a),Gt(t).isAnonymous()?_i("v-if",!0):(si(),mi(wr,{key:0,to:"#soundsSearchFormTopBar"},[yi(Ok,{class:ae(["sounds-search-bar-animated",{visible:!o.value}])},null,8,["class"])])),Gt(t).isAnonymous()?_i("v-if",!0):(si(),mi(wr,{key:1,to:"#soundsSearchFormTabBar"},[yi(Ok,{class:ae({visible:!o.value})},null,8,["class"])])),!Gt(t).isAnonymous()&&"sounds.searchResults"===Gt(n).name&&r.value?(si(),mi(wr,{key:2,to:"#soundsSearchOnSearchPage"},[yi(Ok,{"input-size":40,"is-tags-in-input":!1,placeholder:"Add more",class:"sounds-search-bar-on-page"},null,8,["placeholder"])])):_i("v-if",!0),!Gt(t).isAnonymous()&&"sounds.browse"===Gt(n).name&&r.value?(si(),mi(wr,{key:3,to:"#soundsSearchOnBrowsePage"},[yi(Ok,{"input-size":40,"is-tags-in-input":!1,placeholder:"Search instruments, genres, keywords",class:"sounds-search-bar-on-page"},null,8,["placeholder"])])):_i("v-if",!0)])}}});function Nk(e){switch(e){case"sounds.pack":return"pack";case"sounds.packs":return"packs";case"sounds.loops":case"sounds.oneShots":return"samples";case"sounds.mySounds.collections":return"collections";case"sounds.collection":case"sounds.mySounds.collection":return"collection";case"sounds.mySounds.favorites":return"favorites";case"sounds.mySounds.favorites.packs":return"favorite_packs";case"sounds.mySounds.favorites.samples":return"favorite_samples";case"sounds.mySounds.uploads":return"uploads";case"sounds.searchResults":return"search";case"sounds.browse":return"browse";case"sounds.explore":return"explore";default:return"all"}}function Uk(e){switch(e){case"features":case"featureType":return"type";case"bpm":return"bpm";case"keys":return"key";case"instruments":return"instrument";case"characters":return"character";case"genres":return"genre";default:return null}}function Fk(){return{Major:"major_key",Minor:"minor_key",C:"c_key",D:"d_key",E:"e_key",F:"f_key",G:"g_key",A:"a_key",B:"b_key","C":"c_sharp_key","D":"d_sharp_key","F":"f_sharp_key","G":"g_sharp_key","A":"a_sharp_key"}[arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]]}function Bk(){return{loop:"loop",oneShot:"one_shot"}[arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]]}const Wk=Object.freeze(Object.defineProperty({__proto__:null,getAnalyticsFilterKey:Fk,getAnalyticsFilterType:Uk,getAnalyticsFiltersType:Bk,getContentType:Nk,mountSounds:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{$analytics:n,$rootScope:o,Page:r}=t,i=o$({history:bw(),stringifyQuery:function(e){return decodeURIComponent(new URLSearchParams(e).toString()).replaceAll("+","%20")},routes:[{name:"sounds.home",path:"/sounds/home",component:()=>import("./chunk-827f8cbb.js"),beforeEnter:(e,n,o)=>{t.Me.isAnonymous()||o({name:"sounds.browse"}),t.Page.setMetadata({title:"BandLab Sounds: Royalty-Free Music, Loops & Samples",description:"Create your next hit with 100,000+ royaltyfree music samples including free vocal samples, dynamic drum samples, guitar loops, free drum kits, and more.",image:"https://www.bandlab.com/web-app/images/open-graph-sounds-7dd55ad81a.png",imageHeight:600,imageWidth:1260,imageType:"image/png",type:"website",twitterCard:"summary_large_image"}),o()}},{path:"/sounds",component:()=>import("./chunk-8bb47435.js"),meta:{previousRouteName:null,scrollPosition:{top:0,left:0}},children:[{name:"sounds.explore",path:"/sounds/explore",redirect:{name:"sounds.browse"}},{name:"sounds.browse",path:"/sounds/browse",component:()=>import("./chunk-28f79a2a.js"),beforeEnter:(e,n,o)=>{t.Me.isAnonymous()&&o({name:"sounds.home"}),t.Page.setMetadata({title:"BandLab Sounds: Royalty-Free Music, Loops & Samples",description:"Create your next hit with 100,000+ royaltyfree music samples including free vocal samples, dynamic drum samples, guitar loops, free drum kits, and more.",image:"https://www.bandlab.com/web-app/images/open-graph-sounds-7dd55ad81a.png",imageHeight:600,imageWidth:1260,imageType:"image/png",type:"website",twitterCard:"summary_large_image"}),o()}},{name:"sounds.loops",path:"/sounds/loops",component:()=>import("./chunk-7d622517.js"),props:{key:"loops"},beforeEnter:(e,n,o)=>{if(e.query?.packId){const{packId:t,...n}=e.query;o({name:"sounds.pack",params:{id:t},query:n})}t.Page.setMetadata({title:"Free Loops  Synths, Bass, Beats Etc | BandLab Sounds",description:"Explore a vast collection of over 100,000 royaltyfree loops and oneshots. Download free drum loops, drum samples, free vocal samples, guitar loops, and more. ",image:"https://www.bandlab.com/web-app/images/open-graph-sounds-7dd55ad81a.png",imageHeight:600,imageWidth:1260,imageType:"image/png",type:"website",twitterCard:"summary_large_image"}),o()}},{name:"sounds.oneShots",path:"/sounds/one-shots",component:()=>import("./chunk-7d622517.js"),props:{key:"oneShots"},beforeEnter:(e,n,o)=>{t.Page.setMetadata({title:"Free One-Shots  Drums, Pads, Effects Etc | BandLab Sounds",description:"Build your next sound kit from our free One-Shot collection. Choose from a massive list of kicks, snares, hats, foley, and more.",image:"https://www.bandlab.com/web-app/images/open-graph-sounds-7dd55ad81a.png",imageHeight:600,imageWidth:1260,imageType:"image/png",type:"website",twitterCard:"summary_large_image"}),o()}},{name:"sounds.packs",path:"/sounds/packs",component:()=>import("./chunk-afb3ebd3.js"),beforeEnter:(e,n,o)=>{t.Page.setMetadata({title:"Free Sound Packs  Samples, Drum Kits Etc | BandLab Sounds",description:"Royaltyfree sample packs and drum kits by artists and professional sound designers. Discover free trap beats, hip hop beats, and beyond.\n",image:"https://www.bandlab.com/web-app/images/open-graph-sounds-7dd55ad81a.png",imageHeight:600,imageWidth:1260,imageType:"image/png",type:"website",twitterCard:"summary_large_image"}),o()},meta:{cachePacks:null}},{name:"sounds.pack",path:"/sounds/pack/:id",component:()=>import("./chunk-741cd66d.js"),beforeEnter:(e,n,o)=>{t.Page.setMetadata({title:"Free Sound Packs  Samples, Drum Kits Etc | BandLab Sounds",description:"Royaltyfree sample packs and drum kits by artists and professional sound designers. Discover free trap beats, hip hop beats, and beyond.\n",image:"https://www.bandlab.com/web-app/images/open-graph-sounds-7dd55ad81a.png",imageHeight:600,imageWidth:1260,imageType:"image/png",type:"website",twitterCard:"summary_large_image"}),o()}},{name:"sounds.packNotFound",path:"/sounds/pack-not-found",component:()=>import("./chunk-dcfd8875.js")},{name:"sounds.collection",path:"/sounds/collection/:id",component:()=>import("./chunk-e1f8e075.js"),beforeEnter:(e,n,o)=>{t.Page.setMetadata({title:"Free Loops  Synths, Bass, Beats Etc | BandLab Sounds",description:"Explore a vast collection of over 100,000 royaltyfree loops and oneshots. Download free drum loops, drum samples, free vocal samples, guitar loops, and more. ",image:"https://www.bandlab.com/web-app/images/open-graph-sounds-7dd55ad81a.png",imageHeight:600,imageWidth:1260,imageType:"image/png",type:"website",twitterCard:"summary_large_image"}),o()}},{name:"sounds.mySounds",path:"/sounds/my-sounds",beforeEnter:(e,n,o)=>{const{Me:r}=t;r.isAnonymous()&&o({name:"sounds.home"}),o({name:"sounds.mySounds.favorites.packs"})}},{name:"sounds.mySounds.favorites",path:"/sounds/my-sounds/favorites",component:()=>import("./chunk-745eccdb.js"),beforeEnter:(e,n,o)=>{const{Me:r}=t;r.isAnonymous()&&o({name:"sounds.home"}),o({name:"sounds.mySounds.favorites.packs"})}},{name:"sounds.mySounds.favorites.packs",path:"/sounds/my-sounds/favorites/packs",component:()=>import("./chunk-745eccdb.js"),beforeEnter:(e,n,o)=>{const{Me:r}=t;r.isAnonymous()&&o({name:"sounds.home"}),t.Page.setMetadata({title:"My Sounds Favorite Packs | BandLab",description:"View and manage all of your favorite packs on BandLab.",image:"https://www.bandlab.com/web-app/images/open-graph-sounds-7dd55ad81a.png",imageHeight:600,imageWidth:1260,imageType:"image/png",type:"website",twitterCard:"summary_large_image"}),o()},meta:{cachePacks:null}},{name:"sounds.mySounds.favorites.samples",path:"/sounds/my-sounds/favorites/samples",component:()=>import("./chunk-745eccdb.js"),beforeEnter:(e,n,o)=>{const{Me:r}=t;r.isAnonymous()&&o({name:"sounds.home"}),t.Page.setMetadata({title:"My Sounds Favorite Samples | BandLab",description:"View and manage all of your favorite samples on BandLab.",image:"https://www.bandlab.com/web-app/images/open-graph-sounds-7dd55ad81a.png",imageHeight:600,imageWidth:1260,imageType:"image/png",type:"website",twitterCard:"summary_large_image"}),o()}},{name:"sounds.mySounds.collections",path:"/sounds/my-sounds/collections",component:()=>import("./chunk-912db715.js"),beforeEnter:(e,n,o)=>{const{Me:r}=t;r.isAnonymous()&&o({name:"sounds.home"}),t.Page.setMetadata({title:"My Sounds Collections | BandLab",description:"Create and manage your own collections of samples on BandLab.",image:"https://www.bandlab.com/web-app/images/open-graph-sounds-7dd55ad81a.png",imageHeight:600,imageWidth:1260,imageType:"image/png",type:"website",twitterCard:"summary_large_image"}),o()}},{name:"sounds.mySounds.collection",path:"/sounds/my-sounds/collection/:id",component:()=>import("./chunk-82132903.js"),beforeEnter:(e,n,o)=>{const{Me:r}=t;r.isAnonymous()&&o({name:"sounds.home"}),t.Page.setMetadata({title:"My Sounds | BandLab",description:"Preview and download samples from the %s collection on BandLab.",image:"https://www.bandlab.com/web-app/images/open-graph-sounds-7dd55ad81a.png",imageHeight:600,imageWidth:1260,imageType:"image/png",type:"website",twitterCard:"summary_large_image"}),o()}},{name:"sounds.mySounds.uploads",path:"/sounds/my-sounds/uploads",component:()=>import("./chunk-f386d4dc.js"),beforeEnter:(e,n,o)=>{const{Me:r}=t;r.isAnonymous()&&o({name:"sounds.home"}),t.Page.setMetadata({title:"My Sounds Uploads | BandLab",description:"Upload your own samples to BandLab and store them in the cloud.",image:"https://www.bandlab.com/web-app/images/open-graph-sounds-7dd55ad81a.png",imageHeight:600,imageWidth:1260,imageType:"image/png",type:"website",twitterCard:"summary_large_image"}),o()}},{name:"sounds.searchResults",path:"/sounds/search/:tab?",component:()=>import("./chunk-7a415de7.js"),beforeEnter:(e,n,o)=>{t.Me.isAnonymous()&&o({name:"sounds.home"}),t.Page.setMetadata({title:"BandLab Sounds: Royalty-Free Music, Loops & Samples",description:"Create your next hit with 100,000+ royaltyfree music samples including free vocal samples, dynamic drum samples, guitar loops, free drum kits, and more.",image:"https://www.bandlab.com/web-app/images/open-graph-sounds-7dd55ad81a.png",imageHeight:600,imageWidth:1260,imageType:"image/png",type:"website",twitterCard:"summary_large_image"}),o()}}]},{name:"sounds.redeem",path:"/sounds/redeem",component:()=>import("./chunk-624b7705.js"),beforeEnter:(e,n,o)=>{t.Me.isAnonymous()||!e.query.code?o({name:"sounds.home",query:e.query}):o()}},{name:"sounds.premium",path:"/sounds/premium/:id",component:()=>import("./chunk-624b7705.js"),beforeEnter:(e,n,o)=>{t.Me.isAnonymous()||!e.params.id?o({name:"sounds.home",query:e.query}):o()}},{name:"sounds.drops",path:"/sounds/drops",component:()=>import("./chunk-a7a7eedc.js"),beforeEnter:(e,n,o)=>{const{Me:r}=t;!function(e,t){lS(e).then((e=>{let{value:n}=e;"true"===n?t():t({name:"sounds.home"})}))}(r,o)}},{name:"sounds.login",path:"/sounds/login",beforeEnter:function(){t.authService.setAfterAuthState({toState:"sounds"}),window.location.href="/login"}},{name:"sounds.signUp",path:"/sounds/sign-up",beforeEnter:function(){t.authService.setAfterAuthState({toState:"sounds"}),window.location.href="/sign-up"}},{name:"sounds.user",path:"/sounds/:username",beforeEnter:function(e){window.location.href=`/${e.params.username}`}},{name:"sounds.assistant",path:"/sounds/assistant",beforeEnter:function(){window.location.href="/products/desktop/assistant"}},{name:"others",path:"/:pathMatch(.*)*",beforeEnter:function(){t.$urlRouter.sync()}}],scrollBehavior:function(e,t,n){if(e.fullPath!==t.fullPath)return n||(e.meta.scrollPosition?e.meta.scrollPosition:{el:document.body,x:0,y:0})}});i.afterEach((function(e,i){const a="sounds";if(i.name&&e.name!==i.name&&(e.meta=i.meta,e.meta.previousRouteName=i.name),!e.meta.scrollPosition||e.name!==i.name||e.query.sort===i.query.sort&&e.query.direction===i.query.direction?e.meta.scrollPosition={top:0,left:0}:e.meta.scrollPosition.top=window.scrollY,i.name&&document.body.classList.remove(i.name.replace(/\./g,"-")),e.name&&"others"!==e.name&&document.body.classList.add(e.name.replace(/\./g,"-")),i.path!==e.path&&(n.pageTrack(e.path),r.update()),i.name&&e.name&&i.name!==e.name&&!e.params.id&&n.eventTrack("blsounds_interaction",{platform:"firebase",params:{category:"sounds",interaction_id:Nk(e.redirectedFrom?.name||e.name),triggered_from:Nk(i.name)}}),e.query.sort&&(i.query.sort!==e.query.sort||i.query.direction!==e.query.direction)){const t="recent"===e.query.sort||"popularity"===e.query.sort,o="alphanumeric"===e.query.sort?"name":"recent"===e.query.sort?"newest":e.query.sort;n.eventTrack("blsounds_sort",{platform:"firebase",params:{category:"sounds",triggered_from:Nk(i.name||e.name),sorting_option:o,arrangement:"desc"===e.query.direction?"descending":t?null:"ascending"}})}function s(t){const o="bpm"!==t?function(e,t){return t.filter((t=>!e.includes(t)))}((i.query[t]??"").split(","),e.query[t].split(",")):[e.query[t]];o.forEach((o=>{n.eventTrack("s_content_filter",{platform:"firebase",params:{category:a,triggered_from:Nk(i.name||e.name),filter:Uk(t),..."bpm"===t?{}:{filter_value:"keys"===t?Fk(o):"features"===t?Bk(o):o},..."bpm"===t?{filter_value_min:e.query[t].split("-")[0],filter_value_max:e.query[t].split("-")[1]}:{}}})}))}if(i.query.features!==e.query.features&&e.query.features&&s("features"),i.query.bpm!==e.query.bpm&&e.query.bpm&&s("bpm"),i.query.keys!==e.query.keys&&e.query.keys&&s("keys"),i.query.instruments!==e.query.instruments&&e.query.instruments&&s("instruments"),i.query.characters!==e.query.characters&&e.query.characters&&s("characters"),i.query.genres!==e.query.genres&&e.query.genres&&s("genres"),i.query.query!==e.query.query&&e.query.query&&n.eventTrack("s_content_filter",{platform:"firebase",params:{category:a,triggered_from:Nk(i.name||e.name),query:e.query.query}}),!t.Me.isAnonymous()&&ql.getItem("soundsSampleToFavorite")){const o=JSON.parse(ql.getItem("soundsSampleToFavorite"));pS.value.includes(o.sampleId)||(C$({objectId:o.sampleId,userId:t.Me.id}).then((()=>{pS.value.push(o.sampleId);const t=e.path.split("/")[2];n.eventTrack("Add Sample To Favorites",{category:"Sounds",extra:{...o,target:t,triggeredFrom:Nk(e.name)}})})),ql.removeItem("soundsSampleToFavorite"))}else if(!t.Me.isAnonymous()&&ql.getItem("soundsPackToFavorite")){const o=JSON.parse(ql.getItem("soundsPackToFavorite"));mS.value.includes(o.packId)||(R$({objectId:o.packId,userId:t.Me.id}).then((()=>{mS.value.push(o.packId);const t=e.path.split("/")[2];n.eventTrack("Add Pack To Favorites",{category:"Sounds",extra:{...o,target:t,triggeredFrom:Nk(e.name)}})})),ql.removeItem("soundsPackToFavorite"))}o.$broadcast("backToTop")}));const a=ps({provide:t,render:()=>Ki(Dk)});return a.use(i),a.mount(e),a}},Symbol.toStringTag,{value:"Module"}));function Vk(){const e=Zo("$analytics"),t=Zo("appActions"),n=Zo("Me"),o=Zo("Player"),{counter:r,history:i}=Zk(),a=i$(),s=o.getAudio(),l=Mt({src:"",currentTime:0,paused:!0,ready:!1});return ao((function(){s.addEventListener("ended",c),s.addEventListener("pause",c),s.addEventListener("play",c),s.addEventListener("timeupdate",c),s.addEventListener("canplaythrough",c),c()})),uo((function(){s.removeEventListener("ended",c),s.removeEventListener("pause",c),s.removeEventListener("play",c),s.removeEventListener("timeupdate",c),s.removeEventListener("canplaythrough",c)})),{downloadLoop:u,downloadPack:function(o){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Nk(a.name);const i=a.name;if(n.isAnonymous())return t.checkAllowed("download",{toState:"sounds",toParams:{path:i?.split(".").pop(),subpath:a.params.id,...a.query}},{title:`Sign up to download ${o.name}`});e.eventTrack("Download Pack",{category:"Sounds",label:o.name,extra:o}),e.eventTrack("blsounds_action",{platform:"firebase",params:{action:"download",content_type:"pack",category:"sounds",content_id:o.id,triggered_from:r}});const s=document.createElement("a");s.href=o.features?.loop?.archiveUrl??o.archiveUrl,s.target="_self",s.click()},isCurrentLoop:function(e){return l.src===e.audioUrl},isLoopReady:function(e){return l.ready&&l.src===e.audioUrl},isPlayingLoop:p,isPlayingPack:d,previewLoop:function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Nk(a.name);const i=a.name;p(n)?o.pause():(o.playLoop(t,a.path,n,(e=>u(e,"player"))),e.eventTrack("blsounds_action",{platform:"firebase",params:{action:"preview",content_type:"sample",category:"sounds",content_id:n.id,pack_slug:n.packSlug,...i?.includes("collection")?{collection_id:a.params.id}:{},is_user_content:i?.includes("sounds.mySounds.uploads"),triggered_from:r}}))},previewPack:function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Nk(a.name);d(t)?o.pause():(o.playLoopPack(t,(()=>function(t){return function(e){return Uu.get(e.audioUrl.replace(".mp3",".m4a")).blob()}(t).then((n=>{Kh(n,`${[t.name.split(" ").join("_"),"PREVIEW","BANDLAB"].join("_")}.m4a`),e.eventTrack("Download Pack Preview",{category:"Sounds",label:t.name})}))}(t))),e.eventTrack("blsounds_action",{platform:"firebase",params:{action:"preview",content_type:"pack",category:"sounds",content_id:t.id,..."sounds.collection"===a?.name?{collection_id:a.params.id}:{},triggered_from:n}}))},populateSamplesInQueue:function(e){o.populateSamplesInQueue(e,a.path,(e=>u(e)))},getLoopCurrentTime:function(e){return l.src===e.audioUrl&&l.currentTime}};function c(){l.src=s.src,l.paused=s.paused,l.currentTime=s.currentTime,l.ready=4===s.readyState}function u(o){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Nk(a.name);const l=a.name;return n.isAnonymous()&&r.value>=3?t.checkAllowed("download",{toState:"sounds",toParams:{path:l?.split(".").pop(),...a.query}},{title:"Darn, you hit your download limit ",description:"Dont worry, log in or sign up to get unlimited sounds for free!"}):(o.readyState=XMLHttpRequest.LOADING,function(e){return Uu.get(e.audioUrlWav||e.audioUrlOriginal).blob()}(o).then((t=>{Kh(t,`${o.isUserUploaded?o.name:[o.name.split(" ").join("_"),o.instrumentId?.split(" ").join("_"),...o.features?.loop?.tempo?[`${o.features?.loop?.tempo}BPM`]:[],...o.features?.loop?.key?[o.features?.loop?.key.split(" ").join("")]:[],"BANDLAB"].join("_")}.${o.format||"wav"}`),o.readyState=XMLHttpRequest.DONE,i.value[o.id]=!0,e.eventTrack("Download Loop",{category:"Sounds",label:o.name,extra:o}),e.eventTrack("blsounds_action",{platform:"firebase",params:{action:"download",content_type:"sample",category:"sounds",content_id:o.id,pack_slug:o.packSlug,...l?.includes("collection")?{collection_id:a.params.id}:{},is_user_content:l?.includes("sounds.mySounds.uploads"),triggered_from:s}})})))}function d(e){return!l.paused&&l.src===e.audioUrl}function p(e){return!l.paused&&l.src===e.audioUrl}}function qk(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"loops",{preselectFeature:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Vt({}),o=Vt({}),r=Vt({}),i=Vt([{id:"loop",name:"Loop"},{id:"oneShot",name:"One Shot"}]),a=Vt([]),s=Vt([]),l=Vt([]),c=i$(),u=r$(),d=Vt(),p=$S(c.query),m=Vt(p.query||""),f=Vt((p.bpm??"0-240").split("-").map((e=>+e))),h=Vt((p.keys?.split(",")??[]).reduce((function(e,t){return e[t]=!0,e}),{})),g=Vt(p.sort),v=Vt(p.direction),b=new AbortController,{signal:y}=b;Lr((()=>c.query),(()=>{W$(c.query)?F():L()})),ao((function(){L()})),uo((function(){b.abort()}));const w=Gi((()=>zk(a.value))),$=Gi((()=>zk(s.value))),k=Gi((()=>zk(l.value))),S=Gi((function(){return a.value.filter((e=>e.isSelected))})),_=Gi((function(){return s.value.filter((e=>e.isSelected))})),P=Gi((function(){return i.value.filter((e=>e.isSelected))})),M=Gi((function(){return l.value.filter((e=>e.isSelected))})),T=Gi((function(){return S.value.length})),C=Gi((function(){return _.value.length})),E=Gi((function(){return P.value.length})),I=Gi((function(){return M.value.length})),R=Gi((function(){return rS(f.value)})),A=Gi((function(){return iS(h.value)})),x=Gi((function(){return Object.keys(h.value).filter((function(e){return h.value[e]})).map((function(e){return{key:e,readable:Qk(e).join(" / ")}}))}));return{availableLoopsPerCharacter:n,availableLoopsPerGenre:o,availableLoopsPerInstrument:r,bpm:f,characters:a,clearFilterSelection:D,features:i,genres:s,hashCharacters:w,hashGenres:$,hashInstruments:k,instruments:l,keys:h,onBpmClear:U,onBpmSelection:function(e){f.value=e,j()},onCharactersClear:function(){S.value.forEach((function(e){e.isSelected=!1})),j()},onClearAll:F,onFeaturesClear:function(){i.value.forEach((function(e){e.isSelected=!1})),j()},onFilterSelection:function(e){e.isSelected=!e.isSelected,j()},onGenresClear:function(){_.value.forEach((function(e){e.isSelected=!1})),j()},onInstrumentsClear:function(){M.value.forEach((function(e){e.isSelected=!1})),j()},onKeysClear:N,onKeySelection:function(e){h.value[e]=!h.value[e],j()},onSortSelection:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];g.value===e&&t?"desc"===v.value?(g.value=null,v.value=null):v.value="desc":(g.value=e,v.value=null),j()},query:m,route:c,search:function(e){g.value=null,v.value=null;const t=Yk({...c.query,query:e,sort:g.value,direction:v.value});u.replace({name:c.name??void 0,query:t})},selectedBpmCounter:R,selectedCharacters:S,selectedCharactersCounter:T,selectedFeatures:P,selectedFeaturesCounter:E,selectedGenres:_,selectedGenresCounter:C,selectedInstruments:M,selectedInstrumentsCounter:I,selectedKeys:x,selectedKeysCounter:A,sort:g,sortDirection:v,totalCount:d};function L(){"loops"===e?(t=t||"loop,oneShot",function(){const e=$S(c.query);m.value=e.query||"",f.value=(e.bpm??"0-240").split("-").map((e=>+e)),h.value=(e.keys?.split(",")??[]).reduce((function(e,t){return e[t]=!0,e}),{}),g.value=e.sort,v.value=e.direction,$$({signal:y,features:t}).then((function(e){a.value=e.characters,s.value=e.genres,l.value=e.instruments,O()})).catch((function(e){if("AbortError"!==e.name)return Promise.reject(e)}))}()):"packs"===e&&w$({signal:y}).then((function(e){a.value=e.characters,s.value=e.genres,l.value=e.instruments,O()})).catch((function(e){if("AbortError"!==e.name)return Promise.reject(e)}))}function O(){const e=$S(c.query).characters,t=e?.split(",")??[];a.value.forEach((function(e){e.isSelected=t.includes(e.id)}));const n=$S(c.query).instruments,o=n?.split(",")??[];l.value.forEach((function(e){e.isSelected=o.includes(e.id)}));const r=$S(c.query).genres,u=r?.split(",")??[];s.value.forEach((function(e){e.isSelected=u.includes(e.id)}));const d=$S(c.query).features,p=d?.split(",")??[];i.value.forEach((function(e){e.isSelected=p.includes(e.id)}))}function j(){u.replace({name:c.name??void 0,params:c.params,query:Yk({...c.query,bpm:R.value?f.value.join("-"):"",characters:S.value.map((e=>e.id)).join(","),features:P.value.map((e=>e.id)).join(","),genres:_.value.map((e=>e.id)).join(","),instruments:M.value.map((e=>e.id)).join(","),keys:Object.keys(h.value).filter((e=>h.value[e])).join(","),sort:g.value,direction:v.value})})}function D(){S.value.concat(_.value).concat(M.value).concat(P.value).forEach((function(e){e.isSelected=!1})),j()}function N(){h.value={},j()}function U(){f.value=[0,240],j()}function F(){m.value="",g.value=null,v.value=null,D(),U(),N()}}function zk(e){return e.reduce((function(e,t){return e[t.id]=t.name,e}),{})}const Hk={"C major":"cb_key","C major":"c_key","C major":"c_sharp_key","D major":"db_key","D major":"d_key","E major":"eb_key","E major":"e_key","F major":"f_key","F major":"f_sharp_key","G major":"gb_key","G major":"g_key","A major":"ab_key","A major":"a_key","B major":"bb_key","B major":"b_key","C minor":"cm_key","C minor":"cm_sharp_key","D minor":"dm_key","D minor":"dm_sharp_key","E minor":"em_key","E minor":"em_flat_key","F minor":"fm_key","F minor":"fm_sharp_key","G minor":"gm_key","G minor":"gm_sharp_key","A minor":"am_flat_key","A minor":"am_key","A minor":"am_sharp_key","B minor":"bm_flat_key","B minor":"bm_key",Major:"major_key",Minor:"minor_key"};function Gk(e,t){const n=Object.keys(Hk),o=[["C"],["C","D"],["D"],["D","E"],["E"],["F"],["F","G"],["G"],["G","A"],["A"],["A","B"],["B"]],r=(o.findIndex((t=>t.includes(e.split(" ")[0])))+t+12)%12,i=`${o[r][0]} ${e.split(" ")[1]}`;return n.includes(i)?i:`${o[r][1]} ${e.split(" ")[1]}`}function Kk(e){return 1!==e.length||"Major"!==e[0]&&"Minor"!==e[0]?e.filter((function(e){return!["Major","Minor"].includes(e)})).flatMap(Qk).flatMap((function(t){const n=!e.includes("Major")&&!e.includes("Minor");return[...e.includes("Major")||n?[`${t} major`]:[],...e.includes("Minor")||n?[`${t} minor`]:[]]})).map((function(e){return Hk[e]})).filter(Boolean).join(","):Hk[e[0]]}function Yk(e){return Object.keys(e).forEach((t=>(void 0===e[t]||""===e[t]||null===e[t])&&delete e[t])),e}const Jk=Vt({}),Xk=Gi((function(){return Object.keys(Jk.value).length}));function Zk(){try{Jk.value=JSON.parse(ql.loops)}catch(e){Jk.value={}}return Ar((function(){ql.loops=JSON.stringify(Jk.value)})),{counter:Xk,history:Jk}}function Qk(e){switch(e){case"C":return["C","D"];case"D":return["D","E"];case"F":return["F","G"];case"G":return["G","A"];case"A":return["A","B"];default:return[e]}}function eS(){const e=Zo("hasAvif");return{collections:Vt([{name:"Dark",image:e?"https://www.bandlab.com/web-app/images/sounds/dark-4cc53eca76.avif":"https://www.bandlab.com/web-app/images/sounds/dark-bf6f1eebd0.jpg",route:{toState:"sounds",toParams:{path:"packs",characters:"dark"}},vueRoute:{name:"sounds.packs",query:{characters:"dark"}}},{name:"Moody",image:e?"https://www.bandlab.com/web-app/images/sounds/moody-7984de8e14.avif":"https://www.bandlab.com/web-app/images/sounds/moody-34c84a0c9a.jpg",route:{toState:"sounds",toParams:{path:"packs",characters:"moody"}},vueRoute:{name:"sounds.packs",query:{characters:"moody"}}},{name:"Intense",image:e?"https://www.bandlab.com/web-app/images/sounds/intense-57c31791fa.avif":"https://www.bandlab.com/web-app/images/sounds/intense-8a38f3f7d4.jpg",route:{toState:"sounds",toParams:{path:"packs",characters:"intense"}},vueRoute:{name:"sounds.packs",query:{characters:"intense"}}},{name:"Retro",image:e?"https://www.bandlab.com/web-app/images/sounds/retro-1decab850e.avif":"https://www.bandlab.com/web-app/images/sounds/retro-6a1eb0b13c.jpg",route:{toState:"sounds",toParams:{path:"packs",characters:"retro"}},vueRoute:{name:"sounds.packs",query:{characters:"retro"}}},{name:"Electronic",image:e?"https://www.bandlab.com/web-app/images/sounds/electronic-a5f6d37081.avif":"https://www.bandlab.com/web-app/images/sounds/electronic-5d4ed3b47d.jpg",route:{toState:"sounds",toParams:{path:"packs",genres:"electronic"}},vueRoute:{name:"sounds.packs",query:{genres:"electronic"}}},{name:"Hip Hop",image:e?"https://www.bandlab.com/web-app/images/sounds/hip-hop-e5b992d893.avif":"https://www.bandlab.com/web-app/images/sounds/hip-hop-8e15c59102.jpg",route:{toState:"sounds",toParams:{path:"packs",genres:"hip-hop"}},vueRoute:{name:"sounds.packs",query:{genres:"hip-hop"}}},{name:"Pop",image:e?"https://www.bandlab.com/web-app/images/sounds/pop-8773b1ba96.avif":"https://www.bandlab.com/web-app/images/sounds/pop-f2853d8550.jpg",route:{toState:"sounds",toParams:{path:"packs",genres:"pop"}},vueRoute:{name:"sounds.packs",query:{genres:"pop"}}},{name:"Rock",image:e?"https://www.bandlab.com/web-app/images/sounds/rock-7ca528ab9f.avif":"https://www.bandlab.com/web-app/images/sounds/rock-1a588c462f.jpg",route:{toState:"sounds",toParams:{path:"packs",genres:"rock-or-metal"}},vueRoute:{name:"sounds.packs",query:{genres:"rock-or-metal"}}}])}}function tS(e,t,n,o){const r="--visible-columns",i="--visible-rows",a=Vt(null),s={root:e.value,rootMargin:"0px",threshold:[0,.25,.5,.75,1]},l=Vt(new Map),c=Tt(new Map),u=Tt(new Map),d=Vt(new Map),p=ay((function(e){R(e,"auto")}),500),m=new IntersectionObserver((function(e){for(const t of e){const e=d.value.get(t.target);c.set(e,t.intersectionRect.width/t.boundingClientRect.width>.75),c.get(e)&&-1===y.value&&(t.target.animate({opacity:0},{delay:300,iterations:1}),p.cancel(),p(w.value))}}),s);Lr([t,a],(function(){if(n.value&&o?.value){const e=t.value.querySelectorAll(".carousel-item"),n=getComputedStyle(t.value),i=parseInt(n.getPropertyValue(r));e.forEach(((e,t)=>{const n=e;o.value.parentElement&&"none"===getComputedStyle(o.value.parentElement).display?n.style.scrollSnapAlign="start":i>1?C(t)?n.style.scrollSnapAlign="start":n.style.scrollSnapAlign="none":n.style.scrollSnapAlign="center"}))}})),Ar((function(){if(e.value){m.disconnect();for(const e of[...d.value.keys()])e&&m.observe(e)}}));const f=new IntersectionObserver((function(e){for(const t of e){const e=l.value.get(t.target);u.set(e,t.intersectionRect.width/t.boundingClientRect.width>.75)}}),s);Ar((function(){if(e.value){f.disconnect();for(const e of[...l.value.keys()])e&&f.observe(e)}})),uo((function(){p.cancel(),f.disconnect()}));const h=Vt(null),g=Vt(null),v=Vt(null),b=Vt(null),y=Gi((function(){if(!t.value)return 0;const e=getComputedStyle(t.value),o=parseInt(e.getPropertyValue(i));a.value=parseInt(e.getPropertyValue(r));const s=Gt(n),l=s.filter((e=>u.get(e))),d=s.filter((e=>c.get(e)));if(!l.length||d.includes(s[s.length-1]))return g.value=-1,-1;const p=s.indexOf(l[0]);return g.value=h.value,h.value=Math.floor(p/o),h.value})),w=Gi((function(){if(!t.value)return 0;const e=getComputedStyle(t.value),o=parseInt(e.getPropertyValue(i)),r=Gt(n),a=r.filter((e=>u.get(e)||c.get(e))),s=r.filter((e=>c.get(e))),l=r.indexOf(a[0]);if(a.every(((e,t)=>e===r[l+t]))){const e=Math.floor(l/o);return-1!==e&&(e!==v.value&&(b.value=v.value),v.value=e),e}const d=r.indexOf(s[0]);return Math.floor(d/o)})),$=Gi((function(){if(!t.value)return 0;const e=Gt(n).filter((e=>u.get(e))),o=Gt(n).filter((e=>!u.get(e))),a=getComputedStyle(t.value),s=parseInt(a.getPropertyValue(r)),l=parseInt(a.getPropertyValue(i));return 1+Math.ceil((e.length+o.length-s*l)/l)})),k=Gi((function(){if(!t.value)return[];const e=Gt(n).filter((e=>u.get(e))),o=Gt(n).filter((e=>!u.get(e))),r=getComputedStyle(t.value),a=parseInt(r.getPropertyValue(i)),s=Math.ceil((e.length+o.length)/a);return Array.from({length:s},((e,t)=>t===Math.max(y.value,w.value))).filter(((e,t)=>C(t)))})),S=Gi((function(){return Array.from({length:$.value},((e,t)=>t===w.value))})),_=Gi((function(){return y.value>0})),P=Gi((function(){return y.value<$.value-1})),M=Vt(7e3),T=Vt(null);return{autoscroll:E,autoscrollStop:function(){T.value&&(clearInterval(T.value),T.value=null)},arrayModel:S,arrayModelFull:k,fakeIndex:w,go:R,hasNext:P,hasPrevious:_,index:y,map:l,previousIndex:g,previousFakeIndex:b,next:A,nextSlide:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(-1===y.value)return;const o=getComputedStyle(t.value),r=parseInt(o.getPropertyValue("--visible-columns")),i=Gt(n).length;if(y.value+r>=i&&e)return void R(i);R(Math.min(y.value+r,i-r))},previous:function(){-1!==y.value&&R(y.value-1)},previousSlide:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(-1===y.value)return;const n=getComputedStyle(t.value),o=parseInt(n.getPropertyValue("--visible-columns"));if(0===y.value&&e)return void R(-1*o);R(Math.max(0,y.value-o))},slideTo:function(e){const o=[...l.value.keys()],i=getComputedStyle(t.value),a=parseInt(i.getPropertyValue(r));(e*a>Gt(n).length-a?o[e*a-1]:o[e*a]).scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}),I()},total:$,fakeMap:d};function C(e){const o=getComputedStyle(t.value),i=parseInt(o.getPropertyValue(r));if(1===i)return!0;const a=Gt(n).length;return!(e%a%i!=0&&e%a!=a-i||e%a>a-i)}function E(t){e.value&&(M.value=t,T.value=setInterval((function(){"paused"!==getComputedStyle(e.value).getPropertyValue("animation-play-state")&&A()}),t))}function I(){T.value&&(clearInterval(T.value),E(M.value))}function R(n){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"smooth";const r=getComputedStyle(t.value),a=parseInt(r.getPropertyValue(i)),s=[...l.value.keys()],c=n>s.length-1?[...d.value.keys()][s.length]:n<0?[...d.value.keys()][s.length+n]:s[Math.min(n*a,s.length-1)];if(!c)return;const u=getComputedStyle(c).getPropertyValue("scroll-snap-align"),p={"center center":c.offsetLeft-(e.value.clientWidth-c.clientWidth)/2}[u]??c.offsetLeft;e.value.scrollTo({left:p,behavior:o}),I()}function A(){-1!==y.value&&R(y.value+1)}}function nS(){const e=Vt(!1),t=Vt(null);let n;return Lr(e,(function(){document.removeEventListener("click",o,!0),document.removeEventListener("keydown",r),document.removeEventListener("touchend",o,!0)})),co((function(){document.removeEventListener("click",o,!0),document.removeEventListener("keydown",r),document.removeEventListener("touchend",o,!0)})),{isDropdownMenuVisible:e,dropdownMenuElement:t,open:function(){e.value=!e.value,clearTimeout(n),e.value&&(n=setTimeout((function(){document.addEventListener("click",o,!0),document.addEventListener("keydown",r),document.addEventListener("touchend",o,!0),t.value.addEventListener("mousedown",(function(){document.removeEventListener("click",o,!0),document.addEventListener("mouseup",(function(){setTimeout((function(){e.value&&document.addEventListener("click",o,!0)}))}),{once:!0})})),t.value.addEventListener("touchstart",(function(){document.removeEventListener("touchend",o,!0),document.addEventListener("touchend",(function(){setTimeout((function(){e.value&&document.addEventListener("touchend",o,!0)}))}),{once:!0})})),a$.isVueDropdownVisible=e})))}};function o(n){t.value.contains(n.target)||(setTimeout((function(){e.value=!1})),Array.from(n.composedPath()).some((e=>e.matches?.(".modal-overlay")))&&n.stopPropagation())}function r(t){27===t.which&&(e.value=!1)}}function oS(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:()=>{},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:()=>{},i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:n;function a(e){e.preventDefault(),e.stopPropagation()}Lr(e,(function(){if(e.value){const s=function(){let a,s,l,c=!1;return e.value.addEventListener("dblclick",(function(e){Math.abs(s-e.pageX)<3&&Math.abs(l-e.pageY)<3&&r(e)})),function(n){if(n.button>0)return;e.value.style.touchAction="none",e.value.addEventListener("pointermove",u),window.addEventListener("pointerup",d),l=n.pageY,s=n.pageX,a=e.value.getBoundingClientRect();const o=a.width,r=(n.pageX-a.left)/o,i=a.height,c=(a.bottom+window.scrollY-n.pageY)/i;t({event:n,height:i,originX:s,originY:l,ratioX:r,ratioY:c,width:o}),document.addEventListener("mouseup",(function(e){e.stopPropagation()}),{capture:!0,once:!0})};function u(t){t.preventDefault(),c!==t.shiftKey&&i!==n&&(l=t.pageY,s=t.pageX),c=t.shiftKey;const o=t.pageX-s,r=t.pageY-l,u=(t.pageX-a.left)/a.width,d=(a.bottom+window.scrollY-t.pageY)/a.height;t.shiftKey?i({event:t,deltaX:o,deltaY:r,ratioX:u,ratioY:d}):n({event:t,deltaX:o,deltaY:r,ratioX:u,ratioY:d}),e.value.setPointerCapture(t.pointerId)}function d(t){e.value.style.touchAction="",e.value.removeEventListener("pointermove",u),window.removeEventListener("pointerup",d);const n=t.pageX-s,r=t.pageY-l,i=(t.pageX-a.left)/a.width,c=(a.bottom+window.scrollY-t.pageY)/a.height;o({event:t,deltaX:n,deltaY:r,ratioX:i,ratioY:c})}}();e.value.addEventListener("pointerdown",s),e.value.draggable=!0,e.value.addEventListener("dragstart",a)}}))}function rS(e){return 0!=+e[0]||240!=+e[1]?1:0}function iS(e){const{Major:t=!1,Minor:n=!1,...o}=e,r=Object.keys(o).filter((function(t){return e[t]})).length;return((t?1:0)+(n?1:0))*Math.max(1,r)||r}const aS=[{quote:"I can find any sample for free in BandLab Sounds. For me, BandLab is the BEST!",user:{username:"@rizz#2873"}},{quote:"BandLab is a GIFT. Ive recorded over 76 original songs using BandLab. The Sounds library is deep and full of possibilities. I love BandLab",user:{username:"@steve_smith"}},{quote:"Yo, these packs are lit ",user:{username:"@kruugaofficial"}},{quote:"YES. These work so perfectly for my new tracks!",user:{username:"@rpg_records"}},{quote:"The BandLab Sound packs are fantastic. Keep it going.",user:{username:"@risingstar2k"}}],sS=[{isCallToAction:!0},{quote:"There are so many amazing Sound packs. So many options to choose for my projects.",user:{username:"@kirpal_singh_fatani"}},{quote:"These packs are so dope. A lot of cool sounds to make great songs with. Thank you for adding new sound packs all the time. ",user:{username:"@boonesborough_beach_boy"}},{isCallToAction:!0},{quote:"My favorite part is the loop packs, they really help elevate the music and add a good background",user:{username:"@blooberry07"}},{quote:"So many different types of sounds and loads of different genres, Ive made two full albums using loads of samples from BandLab! What I love most is that they keep bringing out new packs. Bloody great!",user:{username:"@zcharlton_prsn"}},{isCallToAction:!0},{quote:"I love the sounds and the samples that you can easily use in other DAWs.",user:{username:"@josejose_are_uthere"}}],lS=rd((function(e){return Promise.resolve().then((()=>Ap)).then((function(t){let{getAmplitudeFeatureVariant:n}=t;return n(e,"sounds_drops_enabled")}))})),cS=rd((function(e){return Promise.resolve().then((()=>Ap)).then((function(t){let{getAmplitudeFeatureFlag:n}=t;return n(e,"blsounds_popular_sorting")}))})),uS=rd((function(e){return Promise.resolve().then((()=>Ap)).then((function(t){let{getAmplitudeFeatureFlag:n}=t;return n(e,"blsounds_random_sorting")}))})),dS=Vt(!1),pS=Vt([]),mS=Vt([]);Vt(null);const fS=Vt(!1),hS=Vt([]),gS=Vt(null),vS=Vt(null);function bS(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:80;if(!e)return e;const o=e.split(".").pop();return`${e.replace(new RegExp(`\\.${o}$`),"")}_${t}_${n}.${o}`}const yS="216x216",wS="640x640";function $S(e){const t={};for(const[n,o]of Object.entries(e))t[n]=Array.isArray(o)?o[0]:o;return t}function kS(e){return!("sampleId"in e)}function SS(e){return"sampleId"in e}const _S={characters:"character",genres:"genre",instruments:"instrument",bpm:"bpm",keys:"key",features:"feature",packId:"pack",mySoundsCollectionId:"collection"};function PS(e){return"https%3A//www.bandlab.com"+encodeURIComponent(e).replace(/%(2F)/g,unescape)}function MS(e){const{pathname:t}=new URL(e),n=t.split("/")[1];return`https://get-bandlab.app.link/uOhKQrxh2kb?$canonical_url=${PS(t)}&~channel=${n}`}function TS(){return"https://get-bandlab.app.link/QfMj2NsJ9xb"}function CS(e){let{id:t,midiId:n,revisionId:o,fileName:r,lyric:i,bpm:a,key:s,source:l,effect:c,preset:u,sampleId:d,samplePack:p,userSoundsSampleId:m,utmCampaign:f}=e;const h=new URLSearchParams(Yk({id:t,midiId:n,revisionId:o,fileName:r,lyric:i,bpm:a,key:s,source:l,effect:c,preset:u,sampleId:d,samplePack:p,userSoundsSampleId:m,"~campaign":f,"~channel":Zf||Qf?"mobile-web":"desktop-web","~feature":"web-browser"}));return d&&h.append("~tags",d),p&&h.append("~tags",p),`https://get-bandlab.app.link/studio/?${h.toString()}`}function ES(e){return/songstarter/.test(e)?"https://get-bandlab.app.link/songstarter-mobile":/splitter/.test(e)?"https://get-bandlab.app.link/QfMj2NsJ9xb":"https://get-bandlab.app.link/h9NaP1Jlfob"}angular.module("bandlab.audio.routes",["ui.router"]).config(["$stateProvider",function(e){e.state("mastering",{url:"/mastering",templateUrl:"https://www.bandlab.com/web-app/audio/views/mastering-layout-59a6acf6.html",controller:["$injector","$element","$scope","authService","Me","Modal",function(e,t,n,o,r,i){function a(e){const t=new i({id:"downloadModal",templateUrl:"https://www.bandlab.com/web-app/mastering/partials/_download-modal-c3576f90.html",contentScope:{saveOnBandLab:()=>{t.destroy(),e()}}});t.show()}function s(e){let{attribution:t,onCheckoutSuccess:n}=e;new i({id:"paywallModal",templateUrl:"https://www.bandlab.com/web-app/membership/partials/_paywall-modal-ee6789e7.html",contentScope:{useCheckoutModal:!0,product:"membership",productAttribution:t,productAttributionGroup:"mastering",checkoutSuccess:n}}).show()}import("./chunk-87bae259.js").then((function(i){let{mountMastering:l}=i;const c=l(t[0].querySelector("#vue"),{$injector:e,authService:o,Me:r},{openDownloadDialog:a,openPaywall:s});n.$on("$destroy",(function(){c.unmount()}))}))}]}).state("upload",{url:"/upload?force",templateUrl:"https://www.bandlab.com/web-app/audio/views/upload-layout-a631a1f4.html",redirectTo:function(e){if(Zf&&!e.params().force)return"quickUpload"},controller:["$scope",function(e){e.state={step:0}}]}).state("quickUpload",{url:"/quick-upload?remote",params:{remote:{dynamic:!0}},templateUrl:"https://www.bandlab.com/web-app/audio/views/quick-upload-layout-79bc3407.html",resolve:{templates:["$templateCache","$templateRequest","$q",function(e,t,n){return n.all([t("https://www.bandlab.com/web-app/audio/partials/_quick-upload-cover-78eaed48.html")]).then((function(t){t.forEach(e.put)})).catch((function(){}))}]},controller:["$scope","QuickUpload",function(e,t){t.state={step:0,isForkable:!0},e.state=t.state,e.isMobile=Zf,e.isTablet=Qf,e.downloadUrl=ES(window.location.href)}]}).state("quickUpload2",{url:"/quick-upload/2",templateUrl:"https://www.bandlab.com/web-app/audio/views/quick-upload-layout-79bc3407.html",redirectTo:function(e){if(!e.injector().get("QuickUpload").state.audioFile)return"quickUpload"},controller:["$analytics","$q","$scope","AppNotifications","EditorLoader","EditorModel","FileHelper","QuickUpload","Revision","Sample",function(e,t,n,o,r,i,a,s,l,c){function u(){if(!n.state.imageFile)return;const e=Math.min(n.state.imageWidth,n.state.imageHeight),t=(n.state.imageWidth-e)/2,o=(n.state.imageHeight-e)/2;return a.upload(n.state.imageFile,"https://storage.bandlab.com/v1.3/images",{params:{x:t,y:o,width:e,height:e}}).then((function(e){let{data:t}=e;n.state.pictureId=t.id}))}n.isMobile=Zf,n.state=s.state,n.state.revision=null,n.submit=function(a){const d=r.pushTask("uploadMeta");return a.$setSubmitted(),t.all([u(),c.upload({blob:n.state.audioFile,sampleId:n.state.sampleId,sampleType:"samples"})]).then((function(){const e=function(e){let{audioFile:t,duration:n,genres:o,description:r,name:a,pictureId:s,sampleId:l,isForkable:c}=e;const u=i.createTrack({name:t.name}),d=i.createRegion({endPosition:n,name:t.name,sampleId:l,trackId:u.id});return u.regions=[d],i.createRevision({description:r,genres:o,mastering:null,post:{state:"Public"},song:{isForkable:c,name:a||"New Project",pictureId:s},tracks:[u]})}(n.state);return l.save({revision:e}).$promise})).then((function(t){n.state.audioFile=null,n.state.revision=t,s.state.step=2,e.eventTrack("Create Project",{category:"Quick Upload",label:n.state.pictureId?"Upload cover image":"Ignore cover image"})})).catch((function(e){a.$setPristine(),r.flushQueue(),202!==e?.data.errorCode&&o.addNotification({title:bh,content:mh,classList:"alert"})})).finally((function(){r.finishTask(d)}))}}]}).state("song-starter",{url:"/song-starter",redirectTo:"songStarter"}).state("songStarter",{url:"/songstarter?character",isCompatible:()=>oh(!0),template:'<div id="vue"></div>',controller:["$analytics","$element","$injector","$rootScope","$scope","$state","appActions","authService","AppNotifications","EditorHelper","SongStarter","Me","RevisionImporter",function(e,t,n,o,r,i,a,s,l,c,u,d,p){Promise.all([import("./chunk-e24d3235.js").then((e=>{let{mountSongStarter:t}=e;return t})),import("./chunk-62514720.js").then((e=>{let{detectAvif:t}=e;return t()}))]).then((function(a){let[m,f]=a;const h=m(t[0].querySelector("#vue"),{$analytics:e,$injector:n,authService:s,AppNotifications:l,Me:d,hasAvif:f,EditorHelper:c,RevisionImporter:p,scope:r,SongStarter:u,state:i,$rootScope:o});r.$on("$destroy",(function(){h.unmount()}))})),r.createProject=function(e,t,n){p.createRevisionFromSongStarter(e,t,n)},r.openSignUpDialog=function(e,t,n){a.checkAllowed("useSongStarter",{toState:e?"mixEditor":"songStarter",...e?{toParams:e}:{}},{description:"Sign up for free to get unlimited downloads. No limits, no paywalls.",onCancel:t,redirectState:n})}}]}).state("effectPresetSharedKey",{url:"/effect-presets/:linkToken",resolve:{thePreset:["$transition$","EffectsPreset",function(e,t){const{linkToken:n}=e.params();return t.getSharedPreset(n)}]},redirectTo:function(e){if(!e.params().linkToken)return{state:"404"}},template:'<div id="vue"></div>',controller:["$injector","$scope","$state","$element","appActions","thePreset",function(e,t,n,o,r,i){Promise.all([import("./chunk-8c083ca9.js").then((e=>{let{mount:t}=e;return t}))]).then((function(a){let[s]=a;const l=s(o[0].querySelector("#vue"),{$injector:e,$state:n,appActions:r},{preset:i});t.$on("$destroy",(function(){l.unmount()}))})).catch((e=>{}))}]})}]);const IS="trackInstrumentCache",RS=[{label:"Chromatic",type:"scale",tonal:"chromatic"},{label:"Major Scale",type:"scale",tonal:"major"},{label:"Minor Scale",type:"scale",tonal:"minor"},{label:"Major pentatonic",type:"scale",tonal:"major pentatonic"},{label:"Minor pentatonic",type:"scale",tonal:"minor pentatonic"}],AS=[{label:"C"},{label:"C",tonal:"C#"},{label:"D",tonal:"Db"},{label:"D"},{label:"D",tonal:"D#"},{label:"E",tonal:"Eb"},{label:"E"},{label:"F"},{label:"F",tonal:"F#"},{label:"G",tonal:"Gb"},{label:"G"},{label:"A",tonal:"Ab"},{label:"A"},{label:"B",tonal:"Bb"},{label:"B"}],xS="keyboard",LS="smart-keys",OS=Vt(""),jS=Vt(""),DS=Vt(xS),NS=Vt([]),US=Gi((()=>{if(!OS.value)return{key:AS[0],view:RS[0]};const e=OS.value.split(" "),t=e[0],n=e[1];return{key:{label:t,tonal:t.includes("")||t.includes("")?t.replace(//g,"#").replace(//g,"b"):null},view:RS.find((e=>e.label.toLowerCase().includes(n)))||RS[0]}})),FS=Vt(function(){const e=ql.getItem(IS);return new Map(e?Array.from(JSON.parse(e)):[])}());Lr(FS,(()=>{const e=Array.from(FS.value).slice(0,100);ql.setItem(IS,JSON.stringify(e))}));const BS=Gi({get:()=>FS.value.has(jS.value)?FS.value.get(jS.value)[0]||AS[0]:US.value.key,set:e=>VS([e,WS.value])}),WS=Gi({get:()=>FS.value.has(jS.value)?FS.value.get(jS.value)[1]||RS[0]:US.value.view,set:e=>VS([BS.value,e])});function VS(e){const t=new Map(FS.value);t.delete(jS.value),t.set(jS.value,e),FS.value=t}const qS=Mt({showPitch:!1,octave:2}),zS={value:null},HS={value:{}},GS=new Map,KS={audioNode:{},loop:{}},YS=new Audio,JS={COUNT_IN_DURATION:1,FOLLOW_PLAYHEAD:!0,IS_LEGACY_KEYBOARD:!1,OVERDUBBING:!0,QUANTIZATION:!1,SONG_DURATION_MAX:360,TRACKS_LIMIT:16,PREFER_SHARPS:!1},XS={position:{x:0,y:0}},ZS={},QS={},e_=new Map,t_={value:"0.0"},n_=Object.freeze(Object.defineProperty({__proto__:null,AutoPitchVersion:t_,EditorClipboard:zS,EditorCollaboratorCursors:ZS,EditorCursor:XS,EditorDraggedItem:HS,EditorLoops:KS,EditorMovingRegions:GS,EditorSampleFiles:e_,EditorSettings:JS,EditorUploadedSampleIds:QS,PreviewPlayer:YS},Symbol.toStringTag,{value:"Module"})),o_=[{slug:"kick",name:"Kick",midi:36,icon:"kick"},{slug:"snareStick",name:"Snare Edge",midi:37,icon:"rim"},{slug:"snare",name:"Snare",midi:38,icon:"snare"},{slug:"clap",name:"Clap",midi:39,icon:"clap"},{slug:"electricSnare",name:"Electric Snare",midi:40,icon:"snare-electric"},{slug:"tomFloor",name:"Floor Tom",midi:41,icon:"low-tom-3"},{slug:"tomFloor",name:"Floor Tom",midi:43,icon:"low-tom-4"},{slug:"tomMid",name:"Mid Tom",midi:45,icon:"mid-tom-3"},{slug:"tomMid",name:"Mid Tom",midi:47,icon:"mid-tom-4"},{slug:"tomHigh",name:"High Tom",midi:48,icon:"hi-tom-4"},{slug:"tomHigh",name:"High Tom",midi:50,icon:"hi-tom-3"},{slug:"hhClosed",name:"Closed Hi-Hat",midi:42,icon:"hi-hat-closed"},{slug:"hhSemi",name:"Pedal Hi-Hat",midi:44,icon:"hi-hat-semi-opened"},{slug:"hhOpen",name:"Open Hi-Hat",midi:46,icon:"hi-hat-open"},{slug:"crash",name:"Crash Cymbal",midi:49,icon:"cymbal-crash"},{slug:"rideCymbal",name:"Ride Cymbal",midi:51,icon:"cymbal-ride"},{slug:"rideBell",name:"Ride Bell",midi:53,icon:"cymbal-ride-bell"},{slug:"cowbell",name:"Cowbell",midi:56,icon:"cowbell"}],r_=["KeyA","KeyW","KeyS","KeyE","KeyD","KeyF","KeyT","KeyG","KeyY","KeyH","KeyU","KeyJ","KeyK","KeyO","KeyL","KeyP","Semicolon","Quote"],i_=["KeyZ","KeyS","KeyX","KeyD","KeyC","KeyV","KeyG","KeyB","KeyH","KeyN","KeyJ","KeyM","Comma","KeyL","Period","Digit1","KeyQ","KeyW","Digit3","KeyE","Digit4","KeyR","Digit5","KeyT","KeyY","Digit7","KeyU","Digit8","KeyI","KeyO","Digit0","KeyP"],a_=200,s_={ShiftRight:"sustain",ShiftLeft:"sustain"},l_={KeyX:a_,KeyZ:300,...s_},c_={Plus:a_,Equal:a_,Minus:300,...s_},u_=["KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote"],d_=[{midi:48,shortcut:"4",code:"Digit4"},{midi:49,shortcut:"5",code:"Digit5"},{midi:50,shortcut:"6",code:"Digit6"},{midi:51,shortcut:"7",code:"Digit7"},{midi:44,shortcut:"R",code:"KeyR"},{midi:45,shortcut:"T",code:"KeyT"},{midi:46,shortcut:"Y",code:"KeyY"},{midi:47,shortcut:"U",code:"KeyU"},{midi:40,shortcut:"F",code:"KeyF"},{midi:41,shortcut:"G",code:"KeyG"},{midi:42,shortcut:"H",code:"KeyH"},{midi:43,shortcut:"J",code:"KeyJ"},{midi:36,shortcut:"V",code:"KeyV"},{midi:37,shortcut:"B",code:"KeyB"},{midi:38,shortcut:"N",code:"KeyN"},{midi:39,shortcut:"M",code:"KeyM"}],p_=d_.slice().sort((function(e,t){return e.midi-t.midi})),m_="drums",f_="pads",h_="piano";function g_(){return o_.reduce(((e,t)=>(e[t.midi]=t,e)),{})}const v_=[{slug:"tomHigh",midi:50,code:"KeyQ"},{slug:"tomHigh",midi:48,code:"KeyW"},{slug:"tomMid",midi:47,code:"KeyE"},{slug:"tomMid",midi:45,code:"KeyR"},{slug:"tomFloor",midi:43,code:"KeyU"},{slug:"tomFloor",midi:41,code:"KeyI"},{slug:"crash",midi:49,code:"KeyO"},{slug:"rideBell",midi:53,code:"KeyP"},{slug:"hhClosed",midi:42,code:"KeyJ"},{slug:"hhSemi",midi:44,code:"KeyK"},{slug:"hhOpen",midi:46,code:"KeyL"},{slug:"rideCymbal",midi:51,code:"Semicolon"},{slug:"kick",midi:36,code:"KeyA"},{slug:"snareStick",midi:37,code:"KeyS"},{slug:"cowbell",midi:56,code:"KeyD"},{slug:"snare",midi:38,code:"KeyF"}],b_=[{midi:40,slug:"electricSnare",code:"KeyW"},{midi:48,slug:"tomHigh",code:"KeyE"},{midi:45,slug:"tomMid",code:"KeyI"},{midi:41,slug:"tomFloor",code:"KeyO"},{midi:42,slug:"hhClosed",code:"KeyJ"},{midi:46,slug:"hhOpen",code:"KeyK"},{midi:49,slug:"crash",code:"KeyL"},{midi:56,slug:"cowbell",code:"Semicolon"},{midi:36,slug:"kick",code:"KeyA"},{midi:37,slug:"snareStick",code:"KeyS"},{midi:39,slug:"clap",code:"KeyD"},{midi:38,slug:"snare",code:"KeyF"}],y_=[50,47,43];function w_(){const e=g_();return v_.map((t=>({...e[t.midi],code:t.code,shortcut:M_(t.code)})))}function $_(){return o_.reduce((function(e,t){return e[t.midi]=t,e}),{})}function k_(e){const t=g_();return P_(e).reduce(((e,n)=>(e[n.midi]={code:n.code,shortcut:M_(n.code),...t[n.midi]},e)),{})}function S_(){const e=g_();return b_.map((t=>({...e[t.midi],code:t.code,shortcut:M_(t.code)})))}function __(e){return P_(e).reduce(((e,t)=>(e[t.code]=t.midi,e)),{})}function P_(e){return("drum-kit"===e?v_:b_).filter((e=>!y_.includes(e.midi)))}function M_(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return{Comma:",",Period:".",Semicolon:";",Slash:"/",Quote:"'"}[e]||e.replace(/Key|Digit/,"")}function T_(){return DS.value===LS?u_:JS.IS_LEGACY_KEYBOARD?i_:r_}var C_=Math.log(2),E_=Math.log(440);function I_(e){const t=12*(Math.log(e)-E_)/C_+69;return Math.round(100*t)/100}var R_="C C# D D# E F F# G G# A A# B".split(" "),A_="C Db D Eb E F Gb G Ab A Bb B".split(" ");function x_(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(isNaN(e)||e===-1/0||e===1/0)return"";e=Math.round(e);const n=(!0===t.sharps?R_:A_)[e%12];return t.pitchClass?n:n+(Math.floor(e/12)-1)}function L_(e){return null!==e&&"object"==typeof e&&"name"in e&&"string"==typeof e.name}function O_(e){return null!==e&&"object"==typeof e&&"step"in e&&"number"==typeof e.step&&"alt"in e&&"number"==typeof e.alt&&!isNaN(e.step)&&!isNaN(e.alt)}var j_=[0,2,4,-1,1,3,5],D_=j_.map((e=>Math.floor(7*e/12)));function N_(e){const{step:t,alt:n,oct:o,dir:r=1}=e,i=j_[t]+7*n;return void 0===o?[r*i]:[r*i,r*(o-D_[t]-4*n)]}var U_=[3,0,4,1,5,2,6];function F_(e){const[t,n,o]=e,r=U_[function(e){const t=(e+1)%7;return t<0?7+t:t}(t)],i=Math.floor((t+1)/7);return void 0===n?{step:r,alt:i,dir:o}:{step:r,alt:i,oct:n+4*i+D_[r],dir:o}}var B_=(e,t)=>Array(Math.abs(t)+1).join(e),W_=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),V_=new RegExp("^([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})|(AA|A|P|M|m|d|dd)([-+]?\\d+)$"),q_={};function z_(e){return"string"==typeof e?q_[e]||(q_[e]=function(e){const t=function(e){const t=V_.exec(`${e}`);return null===t?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}(e);if(""===t[0])return W_;const n=+t[0],o=t[1],r=(Math.abs(n)-1)%7,i=G_[r];if("M"===i&&"P"===o)return W_;const a="M"===i?"majorable":"perfectable",s=""+n+o,l=n<0?-1:1,c=8===n||-8===n?n:l*(r+1),u=function(e,t){return"M"===t&&"majorable"===e||"P"===t&&"perfectable"===e?0:"m"===t&&"majorable"===e?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*("perfectable"===e?t.length:t.length+1):0}(a,o),d=Math.floor((Math.abs(n)-1)/7);return{empty:!1,name:s,num:n,q:o,step:r,alt:u,dir:l,type:a,simple:c,semitones:l*(H_[r]+u+12*d),chroma:(l*(H_[r]+u)%12+12)%12,coord:N_({step:r,alt:u,oct:d,dir:l}),oct:d}}(e)):O_(e)?z_(function(e){const{step:t,alt:n,oct:o=0,dir:r}=e;if(!r)return"";const i=t+1+7*o,a=(r<0?"-":"")+(0===i?t+1:i)+function(e,t){return 0===t?"majorable"===e?"M":"P":-1===t&&"majorable"===e?"m":t>0?B_("A",t):B_("d","perfectable"===e?t:t+1)}("M"===G_[t]?"majorable":"perfectable",n);return a}(e)):L_(e)?z_(e.name):W_}var H_=[0,2,4,5,7,9,11],G_="PMMPPMM",K_=(e,t)=>Array(Math.abs(t)+1).join(e),Y_=Object.freeze({empty:!0,name:"",letter:"",acc:"",pc:"",step:NaN,alt:NaN,chroma:NaN,height:NaN,coord:[],midi:null,freq:null}),J_=new Map,X_=e=>"CDEFGAB".charAt(e),Z_=e=>e<0?K_("b",-e):K_("#",e),Q_=e=>"b"===e[0]?-e.length:e.length;function eP(e){const t=JSON.stringify(e),n=J_.get(t);if(n)return n;const o="string"==typeof e?function(e){const t=function(e){const t=tP.exec(e);return t?[t[1].toUpperCase(),t[2].replace(/x/g,"##"),t[3],t[4]]:["","","",""]}(e);if(""===t[0]||""!==t[3])return Y_;const n=t[0],o=t[1],r=t[2],i=(n.charCodeAt(0)+3)%7,a=Q_(o),s=r.length?+r:void 0,l=N_({step:i,alt:a,oct:s}),c=n+o+r,u=n+o,d=(oP[i]+a+120)%12,p=void 0===s?nP(oP[i]+a,12)-1188:oP[i]+a+12*(s+1),m=p>=0&&p<=127?p:null;return{empty:!1,acc:o,alt:a,chroma:d,coord:l,freq:void 0===s?null:440*Math.pow(2,(p-69)/12),height:p,letter:n,midi:m,name:c,oct:s,pc:u,step:i}}(e):O_(e)?eP(function(e){const{step:t,alt:n,oct:o}=e,r=X_(t);if(!r)return"";const i=r+Z_(n);return o||0===o?i+o:i}(e)):L_(e)?eP(e.name):Y_;return J_.set(t,o),o}var tP=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/,nP=(e,t)=>(e%t+t)%t,oP=[0,2,4,5,7,9,11];function rP(e,t){const n=eP(e),o=Array.isArray(t)?t:z_(t).coord;if(n.empty||!o||o.length<2)return"";const r=n.coord;return function(e){return eP(F_(e))}(1===r.length?[r[0]+o[0]]:[r[0]+o[0],r[1]+o[1]]).name}var iP=["C","D","E","F","G","A","B"],aP=e=>e.name,sP=e=>e.map(eP).filter((e=>!e.empty));function lP(e){return void 0===e?iP.slice():Array.isArray(e)?sP(e).map(aP):[]}var cP=eP,uP=e=>cP(e).name,dP=e=>cP(e).pc,pP=e=>cP(e).acc,mP=e=>cP(e).oct,fP=e=>cP(e).midi,hP=e=>cP(e).freq,gP=e=>cP(e).chroma;function vP(e){return x_(e)}function bP(e){return x_(I_(e))}function yP(e){return x_(I_(e),{sharps:!0})}function wP(e){return x_(e,{sharps:!0})}var $P=function(e,t){const n=eP(e),o=eP(t);if(n.empty||o.empty)return"";const r=n.coord,i=o.coord,a=i[0]-r[0];return function(e,t){const[n,o=0]=e;return z_(F_(t||7*n+12*o<0?[-n,-o,-1]:[n,o,1]))}([a,2===r.length&&2===i.length?i[1]-r[1]:-Math.floor(7*a/12)],o.height===n.height&&null!==o.midi&&n.oct===o.oct&&n.step>o.step).name},kP=rP,SP=rP,_P=e=>t=>kP(t,e),PP=_P,MP=e=>t=>kP(e,t),TP=MP;function CP(e,t){return kP(e,[t,0])}var EP=CP;function IP(e,t){return kP(e,[0,t])}var RP=(e,t)=>e.height-t.height,AP=(e,t)=>t.height-e.height;function xP(e,t){return t=t||RP,sP(e).sort(t).map(aP)}function LP(e){return xP(e,RP).filter(((e,t,n)=>0===t||e!==n[t-1]))}var OP=e=>{const t=cP(e);return t.empty?"":x_(t.midi||t.chroma,{sharps:t.alt>0,pitchClass:null===t.midi})};function jP(e,t){const n=cP(e);if(n.empty)return"";const o=cP(t||x_(n.midi||n.chroma,{sharps:n.alt<0,pitchClass:!0}));if(o.empty||o.chroma!==n.chroma)return"";if(void 0===n.oct)return o.pc;const r=n.chroma-n.alt,i=o.chroma-o.alt,a=r>11||i<0?-1:r<0||i>11?1:0,s=n.oct+a;return o.pc+s}var DP={names:lP,get:cP,name:uP,pitchClass:dP,accidentals:pP,octave:mP,midi:fP,ascending:RP,descending:AP,distance:$P,sortedNames:xP,sortedUniqNames:LP,fromMidi:vP,fromMidiSharps:wP,freq:hP,fromFreq:bP,fromFreqSharps:yP,chroma:gP,transpose:kP,tr:SP,transposeBy:_P,trBy:PP,transposeFrom:MP,trFrom:TP,transposeFifths:CP,transposeOctaves:IP,trFifths:EP,simplify:OP,enharmonic:jP};const NP=Object.freeze(Object.defineProperty({__proto__:null,accidentals:pP,ascending:RP,chroma:gP,default:DP,descending:AP,distance:$P,enharmonic:jP,freq:hP,fromFreq:bP,fromFreqSharps:yP,fromMidi:vP,fromMidiSharps:wP,get:cP,midi:fP,name:uP,names:lP,octave:mP,pitchClass:dP,simplify:OP,sortedNames:xP,sortedUniqNames:LP,tr:SP,trBy:PP,trFifths:EP,trFrom:TP,transpose:kP,transposeBy:_P,transposeFifths:CP,transposeFrom:MP,transposeOctaves:IP},Symbol.toStringTag,{value:"Module"}));function UP(e,t){const n=t.length,o=(e%n+n)%n;return t.slice(o,n).concat(t.slice(0,o))}function FP(e){return null!==e&&"object"==typeof e&&"name"in e&&"string"==typeof e.name}function BP(e){return null!==e&&"object"==typeof e&&"step"in e&&"number"==typeof e.step&&"alt"in e&&"number"==typeof e.alt&&!isNaN(e.step)&&!isNaN(e.alt)}var WP=[0,2,4,-1,1,3,5],VP=WP.map((e=>Math.floor(7*e/12)));function qP(e){const{step:t,alt:n,oct:o,dir:r=1}=e,i=WP[t]+7*n;return void 0===o?[r*i]:[r*i,r*(o-VP[t]-4*n)]}var zP=(e,t)=>Array(Math.abs(t)+1).join(e),HP=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),GP=new RegExp("^([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})|(AA|A|P|M|m|d|dd)([-+]?\\d+)$"),KP={};function YP(e){return"string"==typeof e?KP[e]||(KP[e]=function(e){const t=function(e){const t=GP.exec(`${e}`);return null===t?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}(e);if(""===t[0])return HP;const n=+t[0],o=t[1],r=(Math.abs(n)-1)%7,i=XP[r];if("M"===i&&"P"===o)return HP;const a="M"===i?"majorable":"perfectable",s=""+n+o,l=n<0?-1:1,c=8===n||-8===n?n:l*(r+1),u=function(e,t){return"M"===t&&"majorable"===e||"P"===t&&"perfectable"===e?0:"m"===t&&"majorable"===e?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*("perfectable"===e?t.length:t.length+1):0}(a,o),d=Math.floor((Math.abs(n)-1)/7);return{empty:!1,name:s,num:n,q:o,step:r,alt:u,dir:l,type:a,simple:c,semitones:l*(JP[r]+u+12*d),chroma:(l*(JP[r]+u)%12+12)%12,coord:qP({step:r,alt:u,oct:d,dir:l}),oct:d}}(e)):BP(e)?YP(function(e){const{step:t,alt:n,oct:o=0,dir:r}=e;if(!r)return"";const i=t+1+7*o,a=(r<0?"-":"")+(0===i?t+1:i)+function(e,t){return 0===t?"majorable"===e?"M":"P":-1===t&&"majorable"===e?"m":t>0?zP("A",t):zP("d","perfectable"===e?t:t+1)}("M"===XP[t]?"majorable":"perfectable",n);return a}(e)):FP(e)?YP(e.name):HP}var JP=[0,2,4,5,7,9,11],XP="PMMPPMM",ZP=(e,t)=>Array(Math.abs(t)+1).join(e),QP=Object.freeze({empty:!0,name:"",letter:"",acc:"",pc:"",step:NaN,alt:NaN,chroma:NaN,height:NaN,coord:[],midi:null,freq:null}),eM=new Map,tM=e=>"CDEFGAB".charAt(e),nM=e=>e<0?ZP("b",-e):ZP("#",e),oM=e=>"b"===e[0]?-e.length:e.length;function rM(e){const t=JSON.stringify(e),n=eM.get(t);if(n)return n;const o="string"==typeof e?function(e){const t=function(e){const t=iM.exec(e);return t?[t[1].toUpperCase(),t[2].replace(/x/g,"##"),t[3],t[4]]:["","","",""]}(e);if(""===t[0]||""!==t[3])return QP;const n=t[0],o=t[1],r=t[2],i=(n.charCodeAt(0)+3)%7,a=oM(o),s=r.length?+r:void 0,l=qP({step:i,alt:a,oct:s}),c=n+o+r,u=n+o,d=(sM[i]+a+120)%12,p=void 0===s?aM(sM[i]+a,12)-1188:sM[i]+a+12*(s+1),m=p>=0&&p<=127?p:null;return{empty:!1,acc:o,alt:a,chroma:d,coord:l,freq:void 0===s?null:440*Math.pow(2,(p-69)/12),height:p,letter:n,midi:m,name:c,oct:s,pc:u,step:i}}(e):BP(e)?rM(function(e){const{step:t,alt:n,oct:o}=e,r=tM(t);if(!r)return"";const i=r+nM(n);return o||0===o?i+o:i}(e)):FP(e)?rM(e.name):QP;return eM.set(t,o),o}var iM=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/,aM=(e,t)=>(e%t+t)%t,sM=[0,2,4,5,7,9,11],lM={empty:!0,name:"",setNum:0,chroma:"000000000000",normalized:"000000000000",intervals:[]},cM=e=>Number(e).toString(2).padStart(12,"0"),uM=e=>parseInt(e,2),dM=/^[01]{12}$/;function pM(e){return dM.test(e)}var mM=e=>"number"==typeof e&&e>=0&&e<=4095,fM=e=>e&&pM(e.chroma),hM={[lM.chroma]:lM};function gM(e){const t=pM(e)?e:mM(e)?cM(e):Array.isArray(e)?function(e){if(0===e.length)return lM.chroma;let t;const n=[0,0,0,0,0,0,0,0,0,0,0,0];for(let o=0;o<e.length;o++)t=rM(e[o]),t.empty&&(t=YP(e[o])),t.empty||(n[t.chroma]=1);return n.join("")}(e):fM(e)?e.chroma:lM.chroma;return hM[t]=hM[t]||function(e){const t=uM(e),n=function(e){const t=e.split("");return t.map(((e,n)=>UP(n,t).join("")))}(e).map(uM).filter((e=>e>=2048)).sort()[0],o=cM(n),r=function(e){const t=[];for(let n=0;n<12;n++)"1"===e.charAt(n)&&t.push(vM[n]);return t}(e);return{empty:!1,name:"",setNum:t,chroma:e,normalized:o,intervals:r}}(t)}var vM=["1P","2m","2M","3m","3M","4P","5d","5P","6m","6M","7m","7M"];function bM(e){const t=gM(e).setNum;return e=>{const n=gM(e).setNum;return t&&t!==n&&(n&t)===n}}var yM=[],wM={};function $M(e){return null!==e&&"object"==typeof e&&"name"in e&&"string"==typeof e.name}function kM(e){return null!==e&&"object"==typeof e&&"step"in e&&"number"==typeof e.step&&"alt"in e&&"number"==typeof e.alt&&!isNaN(e.step)&&!isNaN(e.alt)}[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7  ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 #4 #11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -7 m -^7 -maj7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim  o"],["1P 3m 5d 7d","diminished seventh","dim7 7 o7"],["1P 3m 5d 7m","half-diminished","m7b5  -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]].forEach((e=>{let[t,n,o]=e;return function(e,t,n){const o=function(e){const t=t=>-1!==e.indexOf(t);return t("5A")?"Augmented":t("3M")?"Major":t("5d")?"Diminished":t("3m")?"Minor":"Unknown"}(e),r={...gM(e),name:n||"",quality:o,intervals:e,aliases:t};yM.push(r),r.name&&(wM[r.name]=r),wM[r.setNum]=r,wM[r.chroma]=r,r.aliases.forEach((e=>function(e,t){wM[t]=e}(r,e)))}(t.split(" "),o.split(" "),n)})),yM.sort(((e,t)=>e.setNum-t.setNum));var SM=[0,2,4,-1,1,3,5],_M=SM.map((e=>Math.floor(7*e/12)));function PM(e){const{step:t,alt:n,oct:o,dir:r=1}=e,i=SM[t]+7*n;return void 0===o?[r*i]:[r*i,r*(o-_M[t]-4*n)]}var MM=[3,0,4,1,5,2,6],TM=(e,t)=>Array(Math.abs(t)+1).join(e),CM=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),EM=new RegExp("^([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})|(AA|A|P|M|m|d|dd)([-+]?\\d+)$"),IM={};function RM(e){return"string"==typeof e?IM[e]||(IM[e]=function(e){const t=function(e){const t=EM.exec(`${e}`);return null===t?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}(e);if(""===t[0])return CM;const n=+t[0],o=t[1],r=(Math.abs(n)-1)%7,i=xM[r];if("M"===i&&"P"===o)return CM;const a="M"===i?"majorable":"perfectable",s=""+n+o,l=n<0?-1:1,c=8===n||-8===n?n:l*(r+1),u=function(e,t){return"M"===t&&"majorable"===e||"P"===t&&"perfectable"===e?0:"m"===t&&"majorable"===e?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*("perfectable"===e?t.length:t.length+1):0}(a,o),d=Math.floor((Math.abs(n)-1)/7);return{empty:!1,name:s,num:n,q:o,step:r,alt:u,dir:l,type:a,simple:c,semitones:l*(AM[r]+u+12*d),chroma:(l*(AM[r]+u)%12+12)%12,coord:PM({step:r,alt:u,oct:d,dir:l}),oct:d}}(e)):kM(e)?RM(function(e){const{step:t,alt:n,oct:o=0,dir:r}=e;if(!r)return"";const i=t+1+7*o,a=(r<0?"-":"")+(0===i?t+1:i)+function(e,t){return 0===t?"majorable"===e?"M":"P":-1===t&&"majorable"===e?"m":t>0?TM("A",t):TM("d","perfectable"===e?t:t+1)}("M"===xM[t]?"majorable":"perfectable",n);return a}(e)):$M(e)?RM(e.name):CM}var AM=[0,2,4,5,7,9,11],xM="PMMPPMM",LM=(e,t)=>Array(Math.abs(t)+1).join(e),OM=Object.freeze({empty:!0,name:"",letter:"",acc:"",pc:"",step:NaN,alt:NaN,chroma:NaN,height:NaN,coord:[],midi:null,freq:null}),jM=new Map,DM=e=>"CDEFGAB".charAt(e),NM=e=>e<0?LM("b",-e):LM("#",e),UM=e=>"b"===e[0]?-e.length:e.length;function FM(e){const t=JSON.stringify(e),n=jM.get(t);if(n)return n;const o="string"==typeof e?function(e){const t=function(e){const t=BM.exec(e);return t?[t[1].toUpperCase(),t[2].replace(/x/g,"##"),t[3],t[4]]:["","","",""]}(e);if(""===t[0]||""!==t[3])return OM;const n=t[0],o=t[1],r=t[2],i=(n.charCodeAt(0)+3)%7,a=UM(o),s=r.length?+r:void 0,l=PM({step:i,alt:a,oct:s}),c=n+o+r,u=n+o,d=(VM[i]+a+120)%12,p=void 0===s?WM(VM[i]+a,12)-1188:VM[i]+a+12*(s+1),m=p>=0&&p<=127?p:null;return{empty:!1,acc:o,alt:a,chroma:d,coord:l,freq:void 0===s?null:440*Math.pow(2,(p-69)/12),height:p,letter:n,midi:m,name:c,oct:s,pc:u,step:i}}(e):kM(e)?FM(function(e){const{step:t,alt:n,oct:o}=e,r=DM(t);if(!r)return"";const i=r+NM(n);return o||0===o?i+o:i}(e)):$M(e)?FM(e.name):OM;return jM.set(t,o),o}var BM=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;var WM=(e,t)=>(e%t+t)%t,VM=[0,2,4,5,7,9,11];function qM(e,t){const n=FM(e),o=Array.isArray(t)?t:RM(t).coord;if(n.empty||!o||o.length<2)return"";const r=n.coord;return function(e){return FM(function(e){const[t,n,o]=e,r=MM[function(e){const t=(e+1)%7;return t<0?7+t:t}(t)],i=Math.floor((t+1)/7);return void 0===n?{step:r,alt:i,dir:o}:{step:r,alt:i,oct:n+4*i+_M[r],dir:o}}(e))}(1===r.length?[r[0]+o[0]]:[r[0]+o[0],r[1]+o[1]]).name}function zM(e,t){const n=e.length;return o=>{if(!t)return"";const r=o<0?(n- -o%n)%n:o%n,i=Math.floor(o/n),a=qM(t,[0,i]);return qM(a,e[r])}}var HM={...lM,intervals:[],aliases:[]},GM=[],KM={};function YM(){return GM.slice()}[["1P 2M 3M 5P 6M","major pentatonic","pentatonic"],["1P 2M 3M 4P 5P 6M 7M","major","ionian"],["1P 2M 3m 4P 5P 6m 7m","minor","aeolian"],["1P 2M 3m 3M 5P 6M","major blues"],["1P 3m 4P 5d 5P 7m","minor blues","blues"],["1P 2M 3m 4P 5P 6M 7M","melodic minor"],["1P 2M 3m 4P 5P 6m 7M","harmonic minor"],["1P 2M 3M 4P 5P 6M 7m 7M","bebop"],["1P 2M 3m 4P 5d 6m 6M 7M","diminished","whole-half diminished"],["1P 2M 3m 4P 5P 6M 7m","dorian"],["1P 2M 3M 4A 5P 6M 7M","lydian"],["1P 2M 3M 4P 5P 6M 7m","mixolydian","dominant"],["1P 2m 3m 4P 5P 6m 7m","phrygian"],["1P 2m 3m 4P 5d 6m 7m","locrian"],["1P 3M 4P 5P 7M","ionian pentatonic"],["1P 3M 4P 5P 7m","mixolydian pentatonic","indian"],["1P 2M 4P 5P 6M","ritusen"],["1P 2M 4P 5P 7m","egyptian"],["1P 3M 4P 5d 7m","neopolitan major pentatonic"],["1P 3m 4P 5P 6m","vietnamese 1"],["1P 2m 3m 5P 6m","pelog"],["1P 2m 4P 5P 6m","kumoijoshi"],["1P 2M 3m 5P 6m","hirajoshi"],["1P 2m 4P 5d 7m","iwato"],["1P 2m 4P 5P 7m","in-sen"],["1P 3M 4A 5P 7M","lydian pentatonic","chinese"],["1P 3m 4P 6m 7m","malkos raga"],["1P 3m 4P 5d 7m","locrian pentatonic","minor seven flat five pentatonic"],["1P 3m 4P 5P 7m","minor pentatonic","vietnamese 2"],["1P 3m 4P 5P 6M","minor six pentatonic"],["1P 2M 3m 5P 6M","flat three pentatonic","kumoi"],["1P 2M 3M 5P 6m","flat six pentatonic"],["1P 2m 3M 5P 6M","scriabin"],["1P 3M 5d 6m 7m","whole tone pentatonic"],["1P 3M 4A 5A 7M","lydian #5P pentatonic"],["1P 3M 4A 5P 7m","lydian dominant pentatonic"],["1P 3m 4P 5P 7M","minor #7M pentatonic"],["1P 3m 4d 5d 7m","super locrian pentatonic"],["1P 2M 3m 4P 5P 7M","minor hexatonic"],["1P 2A 3M 5P 5A 7M","augmented"],["1P 2M 4P 5P 6M 7m","piongio"],["1P 2m 3M 4A 6M 7m","prometheus neopolitan"],["1P 2M 3M 4A 6M 7m","prometheus"],["1P 2m 3M 5d 6m 7m","mystery #1"],["1P 2m 3M 4P 5A 6M","six tone symmetric"],["1P 2M 3M 4A 5A 6A","whole tone","messiaen's mode #1"],["1P 2m 4P 4A 5P 7M","messiaen's mode #5"],["1P 2M 3M 4P 5d 6m 7m","locrian major","arabian"],["1P 2m 3M 4A 5P 6m 7M","double harmonic lydian"],["1P 2m 2A 3M 4A 6m 7m","altered","super locrian","diminished whole tone","pomeroy"],["1P 2M 3m 4P 5d 6m 7m","locrian #2","half-diminished","aeolian b5"],["1P 2M 3M 4P 5P 6m 7m","mixolydian b6","melodic minor fifth mode","hindu"],["1P 2M 3M 4A 5P 6M 7m","lydian dominant","lydian b7","overtone"],["1P 2M 3M 4A 5A 6M 7M","lydian augmented"],["1P 2m 3m 4P 5P 6M 7m","dorian b2","phrygian #6","melodic minor second mode"],["1P 2m 3m 4d 5d 6m 7d","ultralocrian","superlocrian bb7","superlocrian diminished"],["1P 2m 3m 4P 5d 6M 7m","locrian 6","locrian natural 6","locrian sharp 6"],["1P 2A 3M 4P 5P 5A 7M","augmented heptatonic"],["1P 2M 3m 4A 5P 6M 7m","dorian #4","ukrainian dorian","romanian minor","altered dorian"],["1P 2M 3m 4A 5P 6M 7M","lydian diminished"],["1P 2M 3M 4A 5A 7m 7M","leading whole tone"],["1P 2M 3M 4A 5P 6m 7m","lydian minor"],["1P 2m 3M 4P 5P 6m 7m","phrygian dominant","spanish","phrygian major"],["1P 2m 3m 4P 5P 6m 7M","balinese"],["1P 2m 3m 4P 5P 6M 7M","neopolitan major"],["1P 2M 3M 4P 5P 6m 7M","harmonic major"],["1P 2m 3M 4P 5P 6m 7M","double harmonic major","gypsy"],["1P 2M 3m 4A 5P 6m 7M","hungarian minor"],["1P 2A 3M 4A 5P 6M 7m","hungarian major"],["1P 2m 3M 4P 5d 6M 7m","oriental"],["1P 2m 3m 3M 4A 5P 7m","flamenco"],["1P 2m 3m 4A 5P 6m 7M","todi raga"],["1P 2m 3M 4P 5d 6m 7M","persian"],["1P 2m 3M 5d 6m 7m 7M","enigmatic"],["1P 2M 3M 4P 5A 6M 7M","major augmented","major #5","ionian augmented","ionian #5"],["1P 2A 3M 4A 5P 6M 7M","lydian #9"],["1P 2m 2M 4P 4A 5P 6m 7M","messiaen's mode #4"],["1P 2m 3M 4P 4A 5P 6m 7M","purvi raga"],["1P 2m 3m 3M 4P 5P 6m 7m","spanish heptatonic"],["1P 2M 3m 3M 4P 5P 6M 7m","bebop minor"],["1P 2M 3M 4P 5P 5A 6M 7M","bebop major"],["1P 2m 3m 4P 5d 5P 6m 7m","bebop locrian"],["1P 2M 3m 4P 5P 6m 7m 7M","minor bebop"],["1P 2M 3M 4P 5d 5P 6M 7M","ichikosucho"],["1P 2M 3m 4P 5P 6m 6M 7M","minor six diminished"],["1P 2m 3m 3M 4A 5P 6M 7m","half-whole diminished","dominant diminished","messiaen's mode #2"],["1P 3m 3M 4P 5P 6M 7m 7M","kafi raga"],["1P 2M 3M 4P 4A 5A 6A 7M","messiaen's mode #6"],["1P 2M 3m 3M 4P 5d 5P 6M 7m","composite blues"],["1P 2M 3m 3M 4A 5P 6m 7m 7M","messiaen's mode #3"],["1P 2m 2M 3m 4P 4A 5P 6m 6M 7M","messiaen's mode #7"],["1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M","chromatic"]].forEach((e=>{let[t,n,...o]=e;return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const o={...gM(e),name:t,intervals:e,aliases:n};return GM.push(o),KM[o.name]=o,KM[o.setNum]=o,KM[o.chroma]=o,o.aliases.forEach((e=>function(e,t){KM[t]=e}(o,e))),o}(t.split(" "),n,o)}));var JM={empty:!0,name:"",type:"",tonic:null,setNum:NaN,chroma:"",normalized:"",aliases:[],notes:[],intervals:[]};function XM(e){if("string"!=typeof e)return["",""];const t=e.indexOf(" "),n=FM(e.substring(0,t));if(n.empty){const t=FM(e);return t.empty?["",e]:[t.name,""]}const o=e.substring(n.name.length+1).toLowerCase();return[n.name,o.length?o:""]}var ZM=function(){return GM.map((e=>e.name))};function QM(e){const t=Array.isArray(e)?e:XM(e),n=FM(t[0]).name,o=function(e){return KM[e]||HM}(t[1]);if(o.empty)return JM;const r=o.name,i=n?o.intervals.map((e=>qM(n,e))):[],a=n?n+" "+r:r;return{...o,name:a,type:r,tonic:n,notes:i}}var eT=QM;function tT(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=(e=>gM(e).chroma)(e),o=FM(t.tonic??e[0]??""),r=o.chroma;if(void 0===r)return[];const i=n.split("");i[r]="1";const a=UP(r,i).join(""),s=YM().find((e=>e.chroma===a)),l=[];return s&&l.push(o.name+" "+s.name),"exact"===t.match||oT(a).forEach((e=>{l.push(o.name+" "+e)})),l}function nT(e){const t=bM(QM(e).chroma);return yM.slice().filter((e=>t(e.chroma))).map((e=>e.aliases[0]))}function oT(e){const t=function(e){const t=gM(e).setNum;return e=>{const n=gM(e).setNum;return t&&t!==n&&(n|t)===n}}(pM(e)?e:QM(e).chroma);return YM().filter((e=>t(e.chroma))).map((e=>e.name))}function rT(e){const t=bM(QM(e).chroma);return YM().filter((e=>t(e.chroma))).map((e=>e.name))}function iT(e){const t=e.map((e=>FM(e).pc)).filter((e=>e)),n=t[0],o=LP(t);return UP(o.indexOf(n),o)}function aT(e){const t=QM(e);if(t.empty)return[];const n=t.tonic?t.notes:t.intervals;return function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=gM(e).chroma.split("");return n.map(((e,o)=>{const r=UP(o,n);return t&&"0"===r[0]?null:r.join("")})).filter((e=>0===e||e))}(t.chroma).map(((e,t)=>{const o=QM(e).name;return o?[n[t],o]:["",""]})).filter((e=>e[0]))}function sT(e){const t=function(e){const t=Array.isArray(e)?iT(e):QM(e).notes,n=t.map((e=>FM(e).chroma));return e=>{const o=FM("number"==typeof e?vP(e):e),r=o.height;if(void 0===r)return;const i=r%12,a=n.indexOf(i);return-1!==a?jP(o.name,t[a]):void 0}}(e);return(e,n)=>{const o=FM(e).height,r=FM(n).height;return void 0===o||void 0===r?[]:function(e,t){return e<t?function(e,t){const n=[];for(;t--;n[t]=t+e);return n}(e,t-e+1):function(e,t){const n=[];for(;t--;n[t]=e-t);return n}(e,e-t+1)}(o,r).map(t).filter((e=>e))}}function lT(e){const{intervals:t,tonic:n}=QM(e),o=zM(t,n);return e=>e?o(e>0?e-1:e):""}function cT(e){const{intervals:t,tonic:n}=QM(e);return zM(t,n)}var uT={degrees:lT,detect:tT,extended:oT,get:QM,modeNames:aT,names:ZM,rangeOf:sT,reduced:rT,scaleChords:nT,scaleNotes:iT,steps:cT,tokenize:XM,scale:eT};const dT=Object.freeze(Object.defineProperty({__proto__:null,default:uT,degrees:lT,detect:tT,extended:oT,get:QM,modeNames:aT,names:ZM,rangeOf:sT,reduced:rT,scale:eT,scaleChords:nT,scaleNotes:iT,steps:cT,tokenize:XM},Symbol.toStringTag,{value:"Module"})),pT={M:"1P 3M 5P",m:"1P 3m 5P",o:"1P 3m 5d",M7:"1P 3M 5P 7M",m7:"1P 3m 5P 7m",7:"1P 3M 5P 7m",o7:"1P 3m 5d 7m",M9:"1P 3M 5P 7M 9M","M9#11":"1P 3M 5P 7M 9M 11A",m9:"1P 3m 5P 7m 9M",m7b9:"1P 3m 5P 7m 9m",o7b9:"1P 3m 5d 7m 9m",9:"1P 3M 5P 7m 9M",M11:"1P 3M 5P 7M 9M 11P",M11b9:"1P 3M 5P 7M 9m 11P",m11:"1P 3m 5P 7m 9M 11P",m11b9:"1P 3m 5P 7m 9m 11P",o11b9:"1P 3m 5d 7m 9m 11P",11:"1P 5P 7m 9M 11P",M13:"1P 3M 5P 7M 9M 11P 13M","M13#11":"1P 3M 5P 7M 9M 11A 13M",m13:"1P 3m 5P 7m 9M 11P 13M",m11b13:"1P 3m 5P 7m 9M 11P 13m",m11b9b13:"1P 3m 5P 7m 9m 11P 13m",o13b9:"1P 3m 5d 7m 9m 11P 13m",13:"1P 3M 5P 7m 9M 11P 13M"},mT="Audio:effectParameterChanged",fT="Audio:effectChainBypassChanged",hT="Audio:effectsChanged",gT="Audio:audioInputChanged",vT="Audio:audioInputDisconnected",bT="Audio:midiDeviceChanged",yT="MidiEditor:copyNotes",wT="MidiEditor:cutNotes",$T="MidiEditor:deleteNotes",kT="MidiEditor:moveDown",ST="MidiEditor:moveDownOctave",_T="MidiEditor:moveLeft",PT="MidiEditor:moveRight",MT="MidiEditor:moveUp",TT="MidiEditor:moveUpOctave",CT="MidiEditor:pasteNotes",ET="MidiEditor:quantizeNotes",IT="MidiEditor:selectAllNotes",RT="MidiEditor:selectNotes",AT="MixEditor:pausePlaying",xT="MixEditor:startPlay",LT="MixEditor:startRecord",OT="Recorder:start",jT="Recorder:stop",DT="MixEditor:movedPlayheadPosition";function NT(e){return null!=e}const UT=.52,FT=["default","7","9","11"],BT=["major","minor"];function WT(e){return BT.includes(e)}const VT=Vt(null),qT=Vt(null),zT=[],HT={default:{major:"M",minor:"m",diminished:"o"},7:{major:"M7",minor:"m7",dominant:"7",diminished:"o7"},9:{major:"M9",minor:"m9",mediant:"m7b9",dominant:"9",diminished:"o7b9"},11:{major:"M11",minor:"m11",mediant:"m11b9",subdominant:"M9#11",dominant:"11",diminished:"o11b9"}},GT="smartChordsTrackSettingsKey",KT=Gi({get(){const e=localStorage.getItem(GT)||"{}";return new Map(Object.entries(JSON.parse(e)))},set:ay((e=>{localStorage.setItem(GT,JSON.stringify(Object.fromEntries(e.entries())??{}))}),300)}),YT=Vt(KT.value),JT=Gi({get(){const e=YT.value.get(jS.value)??{};return{enabled:e.enabled??!1,strum:e.strum??0,engaged:e.engaged??!0,spread:e.spread??0,complexity:e.complexity??0,minimised:e.minimised??!1}},set(e){const t=new Map(YT.value);t.delete(jS.value),t.set(jS.value,e),YT.value=t,KT.value=t}});function XT(e){return!["drum-kit","drum-pads","special-effects","drum-machine","creators-kit","looper","guitar-electric","guitar-bass","sampler"].includes(e.slug)&&JT.value.enabled}function ZT(e,t,n,o){const r=function(e){const t=BS.value.tonal||BS.value.label,n=WS.value.tonal;if(!WT(n))throw new Error("not a valid smart chords key");const{complexity:o,spread:r}=JT.value;return function(e,t,n,o,r){let i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];const a=uT.get([t,n]).notes,s=DP.fromMidi(e),l=DP.pitchClass(s);let c,u=a.find((e=>e===l||e===DP.enharmonic(l)));u?c=function(e,t,n){let o=e;"minor"===t&&(o=(e+5)%7);const r=3===o,i=4===o,a=5===o,s=6===o;if(2===o)return HT[n].supertonic??HT[n].minor;if(r)return HT[n].mediant??HT[n].minor;if(i)return HT[n].subdominant??HT[n].major;if(a)return HT[n].dominant??HT[n].major;if(s)return HT[n].submediant??HT[n].minor;const l=[1,4,5].includes(o)?"major":[2,3,6].includes(o)?"minor":"diminished";return HT[n][l]}(a.indexOf(u)+1,n,FT[Math.round(o*(FT.length-1))]):(c="o7",u=l);let d=[];d=pT[c].split(" ");const p=d.map((e=>DP.transpose(s,e))).map((e=>DP.midi(e))).filter(NT),m=p.length-1;let f=Math.round((1-r)*m);if(i){const[e,t]=[4,7],n=Math.round((1-r)*m)/m,o=Math.round((t-e)*(1-n)+e);p.splice(0,Math.max(p.length-o,0))}for(;f>0;)p.unshift(p.pop()-12),f--;const h=[e,...p.map((e=>e+12))];return h.sort(),{root:e,notes:h,chordType:c,name:eC(u+c),timeouts:[]}}(e,t,n,o,r)}(e);VT.value&&VT.value.root!==e&&QT(VT.value.root,o),0===JT.value.strum?n(r.notes):zT.push(...function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=Fs(JT.value.strum,2)*UT,r=Math.abs(o),i=e.slice();if(n){const e=i.shift();e&&t(e)}o<0&&i.reverse();const a=i.map(((e,n)=>{const o=1e3*(a=n/(i.length-1),(1-Math.pow(1-a,2))*r);var a;return setTimeout((()=>{t(e)}),o)}));return a}(r.notes,t)),VT.value=r,qT.value=r,tC.smartChordPlayed()}function QT(e,t){if(!VT.value)return;if(e!==VT.value.root)return;const{notes:n}=VT.value;t(n),zT.forEach(clearTimeout),zT.length=0,VT.value=null}function eC(e){let t=e;return t=t.replace(/([Mmo][0-9]*)([#b].*)/g,"$1($2)"),t=t.replace("M","maj"),t=t.replace("o","dim"),t=t.replaceAll("#",""),t=t.replaceAll("b",""),t}const tC=function(){let e=0;return{subscribe:function(e){const o=e.$on(OT,n),r=e.$on(jT,t);return()=>{o(),r()}},onSmartChordsEnabled:function(){$p("studio_smart_chords_enabled")},smartChordPlayed:function(){e++}};function t(){e&&$p("smart_chords_recording_finished",{num_smart_chords:e})}function n(){e=0}}(),nC={smartChords:"Smart Chords",spread:"Spread",complexity:"Complexity",tooltip:"Smart Chords plays an entire chord from just one note.\n\nIn the XY pad, the horizontal axis controls the ranges of notes, while the vertical axis controls the amount of notes in each chord. Click to lock the cursor's position.\n\nStrum offsets to the playback of each note to give a human feel.",clickToEngage:"Click to engage",strum:"Strum:",invaliKeyNotification:"Smart Chords needs a Major/Minor key. Setting key to be Major"};function oC(e){return e*window.devicePixelRatio}function rC(e){e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,e.canvas.width,e.canvas.height)}function iC(e,t){return!e||e.width!==oC(t.parentElement.clientWidth)||e.height!==oC(t.parentElement.clientHeight)}function aC(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return{colorProgressSoFar:e=function(e){let{rgb:t,hex:n}=e;const[o,r,i]=t||_y(n);return(Math.max(o,r,i)+Math.min(o,r,i))/2}({hex:e})<.8||n?e:Ty(my({hex:e,ratio:-.4})),colorProgressBackward:Iy(e,o?.4:.6),colorProgressForward:Iy(e,o?.7:.2),colorNotPlayedYet:n?t:Iy(e,.4)}}function sC(e,t,n,o,r){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"#282C32",a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"bottom",l=arguments.length>8?arguments[8]:void 0,c=arguments.length>9?arguments[9]:void 0,u=arguments.length>10?arguments[10]:void 0;const{colorProgressSoFar:d,colorProgressBackward:p,colorProgressForward:m,colorNotPlayedYet:f}=aC(i,l,c,u);lC(e,t,n,o,r,a,s,d,p,m,f)}function lC(e,t,n,o,r,i,a,s,l,c,u){const d=Math.min(n,o),p=Math.max(n,o),m=Math.round((e.canvas.width+i)/(r+i)),f=fs(t),h=f&&e.canvas.height/f;function g(t,n){const o=-Math.max(h*n,1),s={bottom:e.canvas.height,center:(e.canvas.height-o)/2}[a];e.fillRect(t*(r+i),s,r,o)}requestAnimationFrame((function(){var r;for(rC(e),e.imageSmoothingEnabled=!1,e.fillStyle=s,r=0;r<Math.floor(m*d);r++)g(r,t[r]);for(e.fillStyle=null===o?s:o<n?l:c,r=Math.floor(m*d);r<Math.floor(m*p);r++)g(r,t[r]);for(e.fillStyle=u,r=Math.floor(m*p);r<m;r++)g(r,t[r])}))}function cC(e){const t=new Array(e.length).fill(0),n=e.numberOfChannels;for(let o=0;o<n;o++){const r=e.getChannelData(o);for(let e=0;e<r.length;e++)t[e]=t[e]+r[e]/n}return t}function uC(e,t){const n=new Array(t).fill(0),o=e.getChannelData(0),r=Math.floor(o.length/t);for(let e=0;e<t;e++){const t=r*e;let i=0;for(let e=0;e<r;e++)i+=Math.abs(o[t+e]);n[e]=i/r}return n}function dC(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const o=oC(e.parentElement.clientWidth),r=oC(e.parentElement.clientHeight),i=new Path2D,a=new Path2D,s=Math.round(r/2),l=Math.ceil(t.length/o),c=n??fs(t);i.moveTo(0,s),a.moveTo(0,s);for(let e=0;e<o;e++){let n=-.005,o=.005;const r=Math.min(l,t.length-l*e);for(let i=0;i<r;i++){const r=t[e*l+i];r<0?n=Math.min(n,r):o=Math.max(o,r)}n=n/c*s,o=o/c*s,i.lineTo(e,s-o),a.lineTo(e,s-n)}return i.lineTo(o,s),a.lineTo(o,s),e.width=o,e.height=r,{canvas:e,height:r,width:o,positiveCurve:i,negativeCurve:a}}angular.module("bandlab.audio").controller("VirtualInstrumentCtrl",["$scope","EditorState","MidiKeyboardHandler","SharedMidiSynth",function(e,t,n,o){t.isAudioInputActive&&n.enable(),o.setInput(e.current);const r=Lr([BS,WS],(()=>{n.releaseAll()}));let i=angular.noop;e.$on("$destroy",(function(){r(),i()})),e.press=function(e){n.press(e)},e.release=function(e){n.release(e)},e.isActive=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.some((function(e){return!!o.current[e]&&o.isNoteMapped(e)}))},e.isMapped=function(e){return o.isNoteMapped(e)},e.isLegacyKeyboard=JS.IS_LEGACY_KEYBOARD,e.keyboardMode=DS,import("./chunk-39e5e61e.js").then((function(t){let{note:o}=t;e.getMidiFromNote=function(e){return o(e).midi},Promise.all([Promise.resolve().then((()=>dT)),Promise.resolve().then((()=>NP))]).then((function(t){let[r,a]=t;function s(){let t,n;return DS.value===xS&&(t=8,n=u(AS[0],RS[0])),DS.value===LS&&(t=1,n=e.current.notes),n=n.concat(c(n,1)),n=n.concat(c(n,2).slice(0,t)),l(n),n}function l(){const t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((e=>o(e).midi));e.pianoShortcutMap=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t={},n=T_();for(let o=0;o<n.length;o++){const r=e[o],i=n[o];t[r]=M_(i)}return t}(t),n.updatePianoKeyMap(t)}function c(e,t){return e.map((e=>o(e).pc+(o(e).oct+t)))}function u(e,t){const n=(e.tonal||e.label)+qS.octave,o=t.tonal||t.label;return r.get([n,o]).notes}e.keyboardKeys=s(),e.$watch((()=>JS.IS_LEGACY_KEYBOARD),(()=>{e.isLegacyKeyboard=JS.IS_LEGACY_KEYBOARD,l(e.current.notes),e.$applyAsync()})),e.shouldShowInKeyLabel=function(t){if("chromatic"===WS.value.tonal)return;const n=e.current.notes.map((e=>a.simplify(o(e).pc))),r=o(t).pc;return n.includes(r)||n.includes(a.enharmonic(r))},e.isSmartChordNonRoot=function(e){return JT.value.enabled&&VT.value&&VT.value.notes.includes(e)&&VT.value.root!==e},e.getPitchClassColor=function(e){return o(e).acc?"black":"white"},e.$applyAsync(),i=Lr((()=>qS.octave),(()=>{e.current.notes=u(BS.value,WS.value),e.$applyAsync()})),e.$watch((()=>{e.current.notes=u(BS.value,WS.value),e.keyboardKeys=s()}))}))}))}]);const pC=36,mC={0:"blue",1:"orange",2:"purple",3:"green"};function fC(e){return e-36}function hC(e,t){const n=new Path2D,o=e/2;for(let e=0;e<t.length;e+=2){const r=t[e],i=t[e+1],a=e/2;n.moveTo(a,o-o*Math.max(r,.001)),n.lineTo(a,o-o*Math.min(i,-.001))}return n}function gC(e,t,n,o){let{src:r,id:i,original:a,triggeredFrom:s}=t;return QS[i]=!0,n.loading=!0,fetch(r).then((function(e){return e.blob()})).then((function(e){return $C(e,o)})).then((function(t){return n.pending=yC(e,i,t),n.pending})).then((function(){n.pad=e,n.pad.launchMode=a.features.oneShot?"OneShot":"Gate"})).then((function(){zC("me_sampler_pad_actions",{action:"import_from_sounds"}),o.get("$analytics").eventTrack("Import sample from Loops API",{category:"Mix Editor",extra:{...a,target:"Sampler",triggeredFrom:s,importTarget:"sampler_pad"}})})).finally((function(){n.loading=!1}))}function vC(e,t,n){return e.get("SharedMidiSynth").stopNotes(),Fh({accept:"audio/*",multiple:null}).then((function(o){let[r]=o;return bC(e,t,r,n)}))}function bC(e,t,n,o){const r=e.get("AppNotifications"),i=e.get("RevisionImporter");return o.loading=!0,o.pending=i.isAudioFileValid(n,{loader:!1}).then((function(t){let[n]=t;return $C(n,e)})).then((function(e){return yC(t,ad(),e)})).then((function(){zC("me_sampler_pad_actions",{action:"import_from_device"})})).catch((function(e){r.addNotification({title:fh,content:e.message,classList:"alert",autoclose:8e3})})).finally((function(){o.loading=!1})),o.pending}function yC(e,t,n){return e.remove().then((function(){return e.loadSample(t,n)}))}function wC(e,t,n,o){const r=e.get("EditorMixdown"),i=n.id;return o.loading=!0,o.pending=r.makeMixdown(null,[{...n}]).then((function(e){let{blob:t}=e;return t.arrayBuffer()})).then((function(e){return yC(t,i,e)})).finally((function(){o.loading=!1})),o.pending}function $C(e,t){return e.arrayBuffer().then((function(e){return ch(e)})).then((function(e){if(e.duration>60.1){t.get("AppNotifications").addNotification({title:"Your file is too long. Only the first minute has been imported",autoclose:5e3});const n=60*lh().sampleRate,o=lh().createBuffer(2,n,lh().sampleRate),r=new Float32Array(n);return e.copyFromChannel(r,0,0),o.copyToChannel(r,0,0),e.copyFromChannel(r,1,0),o.copyToChannel(r,1,0),Sh(o)}return Sh(e)})).then((function(e){return e.arrayBuffer()}))}async function kC(e,t,n){const o=e.get("EditorPlayer"),r=await o.current.getMultipadSamplerForTrack(t);return r.getKit().then((function(e){return e?Promise.all(e.sampleIds.filter((function(e){return!QS[e]||n})).map((function(e){return o.current.readSample(e).then((function(t){return{blob:new Blob([t],{type:"audio/wav"}),id:e}}))}))).then((function(t){return{samplerKit:e,samples:t}})):null})).finally((function(){r.delete()}))}function SC(e,t){const n=oC(660),o=oC(162);return t.getWaveform(n,!1).then((function(r){const i=hC(o,r),a=e.getContext("2d");var s;a&&(e.width=n,e.height=o,rC(a),a.strokeStyle=(s=mC[t.color],window.getComputedStyle(document.body).getPropertyValue(`--ds-color-tint-${s}-base`)),a.translate(.5,.5),a.stroke(i))})).catch((()=>{}))}const _C="https://www.bandlab.com/api/v1.3".replace("v1.3","v2.0");let PC,MC=[],TC=[];function CC(e,t){const n=e.get("$http"),o=e.get("EditorState"),r=e.get("Me"),i=e.get("$analytics");return new Promise((function(e){const n=zn((()=>import("./chunk-b1f77df0.js")));o.isInBackground=!0,_g(n,{title:`Delete ${t.samplerKit.displayName||""}?`,subtitle:"You wont be able to undo this action. But it wont affect other projects where you used this kit.",size:"small",actions:[{label:"Cancel",color:"secondary",onClick:()=>e()},{label:"Delete",color:"destructive",onClick:()=>e(!0)}]},{onClose:()=>{o.isInBackground=!1,e()}})})).then((function(e){if(e)return n({method:"delete",url:`${_C}/users/${r.id}/sampler-kits/${t.samplerKit.originalSamplerKitId}`}).then((function(e){return i.eventTrack("blsounds_action",{platform:"firebase",params:{action:"remove",content_type:"pack",category:"studio",content_id:t.samplerKit.id,is_user_content:!0,target:"sampler_my_kits",triggered_from:"sampler_settings"}}),t.samplerKit.originalSamplerKitId&&Gf(TC,{id:t.samplerKit.originalSamplerKitId}),t.samplerKit.originalSamplerKitId=null,t.samplerKit.displayName=null,t.samplerKit.id=ad(),e}))}))}function EC(){return MC}function IC(e){const t=e.get("$http"),n=e.get("Me");return t({method:"GET",url:`${_C}/users/${n.id}/sampler-kits`}).then((function(e){return TC=e.data,e}))}function RC(){return TC}function AC(e,t,n){const o=e.get("EditorRevision"),r=e.get("EditorState"),i=e.get("Modal"),a=e.get("$analytics"),s={displayName:n.samplerKit.displayName,onSubmit:function(r,i){return o.current.tracks.filter((e=>e.samplerKit?.id===n.samplerKit.id)).forEach((function(e){e.samplerKit.displayName=i})),Promise.all([NC(e,n),t.setKitName(i)]).then((function(){l.destroy(),zC("me_sampler_kit_actions",{action:"rename"}),a.eventTrack("blsounds_action",{platform:"firebase",params:{action:"edit",content_type:"pack",category:"studio",content_id:n.samplerKit.id,is_user_content:!0,triggered_from:"sampler_settings"}})}))},presetNames:TC.filter((e=>e.displayName!==n.samplerKit.displayName)).map((e=>e.displayName))},l=new i({templateUrl:"https://www.bandlab.com/web-app/audio/partials/_user-sampler-kit-rename-4de1b0f9.html",contentScope:s,onCreate:function(){r.isInBackground=!0},onDestroy:function(){r.isInBackground=!1}});l.show()}function xC(e,t,n){const o=e.get("$analytics"),r=e.get("$filter"),i=e.get("$http"),a=e.get("EditorState"),s=e.get("Me"),l=e.get("Modal"),c=e.get("SharedMidiSynth");return new Promise((function(e,t){const i=r("presetName")(n),s={displayName:"Custom"===i?"My Preset":i,onSubmit:function(t,r){const{samplerKit:i}=n;return o.eventTrack("Save User Sampler Kit",{category:"Mix Editor"}),n.samplerKit.displayName=r,c.destroy(),e({...i,displayName:r})},presetNames:TC.map((e=>e.displayName))},c=new l({templateUrl:"https://www.bandlab.com/web-app/audio/partials/_user-sampler-kit-save-bf432bcb.html",contentScope:s,onCreate:function(){a.isInBackground=!0},onDestroy:function(){a.isInBackground=!1,t()}});c.show()})).then((function(o){return Promise.all([o.displayName,LC(e,n),t.setKitName(o.displayName)])})).then((function(e){let[t]=e;return i({method:"post",url:`${_C}/users/${s.id}/sampler-kits`,data:{...n.samplerKit,displayName:t,audioUrl:void 0,color:void 0,createdOn:void 0,id:void 0,imageUrl:void 0,modifiedOn:void 0,originalSamplerKitId:void 0,samples:void 0}}).then((function(e){return TC=TC.concat(e.data),n.samplerKit.id=e.data.id,n.samplerKit.originalSamplerKitId=e.data.id,n.samplerKit.displayName=e.data.displayName,c.getSampler().bindMultipadSampler(),zC("me_sampler_kit_actions",{action:"save_as"}),e}))}))}function LC(e,t){const n=e.get("Sample");return kC(e,t,!1).then((function(e){if(!e)return;const{samples:t}=e;return Promise.all(t.map((function(e){let{blob:t,id:o}=e;return n.upload({blob:t,sampleId:o,sampleType:"samples"}).then((function(){QS[o]=!0}))})))}))}const OC=new WeakMap;function jC(e,t,n){if(OC.has(n))return OC.get(n);const o=e.get("$timeout"),r=e.get("EditorCollaboratorsState"),i=o((function(){return LC(e,n).finally((function(){OC.delete(n)}))}),Object.keys({...r.writers,...r.writers}).length?0:3e4);return OC.set(n,i),i}function DC(e,t,n){const o=e.get("$rootScope");return t.originalSamplerKitId=t.id,n.loadSamplerKit(t).then((function(){o.$applyAsync(),zC("me_sampler_kit_select",{source:t.modifiedOn?"user":"sounds"})}))}function NC(e,t){const n=e.get("$http"),o=e.get("Me"),r=e.get("SharedMidiSynth");return LC(e,t).then((function(){return n({method:"put",url:`${_C}/users/${o.id}/sampler-kits/${t.samplerKit.originalSamplerKitId}`,data:{...t.samplerKit,audioUrl:void 0,imageUrl:void 0,color:void 0,createdOn:void 0,modifiedOn:void 0,samples:void 0}})})).then((function(e){return Gf(TC,{id:e.data.id}),TC=TC.concat(e.data),t.samplerKit.id=e.data.id,t.samplerKit.id=e.data.originalSamplerKitId,r.getSampler().bindMultipadSampler(),e}))}function UC(e,t){return t.originalSamplerKitId&&t.originalSamplerKitId!==t.id}function FC(e,t,n){const o=t.samplerKit.originalSamplerKitId,r=TC.find((e=>e.id===o)),i=MC.find((e=>e.features.multipadSampler.id===o)),a=r||i?.features.multipadSampler;if(!a)throw new Error("Sampler kit not found");DC(e,a,n)}function BC(e,t){return TC.some((e=>e.id===t.originalSamplerKitId||e.id===t.id))}function WC(e){return{...e,kit:{...e.kit,...e.kit.layers?{layers:e.kit.layers.map((function(e){let{...t}=e;return t})).sort(((e,t)=>e.id.localeCompare(t.id)))}:{}},sampleIds:[...e.sampleIds].sort(((e,t)=>e.localeCompare(t)))}}function VC(e,t,n){const o=e.get("EditorPlayer");return t.getKit().then((function(e){if(!e)return null;const t=qC(e).kit.layers.find((e=>e.pitch===n));return t?o.current.readSample(t.sampleId).then((function(e){return new Blob([e],{type:"audio/wav"})})):null}))}function qC(e){const t={...e,kit:JSON.parse(e.kit)};return t.kit.layers=t.kit.layers||[],t}function zC(e,t){return Promise.resolve().then((()=>fv)).then((function(n){let{logEvent:o}=n;return o(e,t)}))}function HC(e){return Array.isArray?Array.isArray(e):"[object Array]"===ZC(e)}function GC(e){return"string"==typeof e}function KC(e){return"number"==typeof e}function YC(e){return"object"==typeof e}function JC(e){return null!=e}function XC(e){return!e.trim().length}function ZC(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const QC=e=>`Missing ${e} property in key`,eE=e=>`Property 'weight' in key '${e}' must be a positive integer`,tE=Object.prototype.hasOwnProperty;class nE{constructor(e){this._keys=[],this._keyMap={};let t=0;e.forEach((e=>{let n=oE(e);this._keys.push(n),this._keyMap[n.id]=n,t+=n.weight})),this._keys.forEach((e=>{e.weight/=t}))}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function oE(e){let t=null,n=null,o=null,r=1,i=null;if(GC(e)||HC(e))o=e,t=rE(e),n=iE(e);else{if(!tE.call(e,"name"))throw new Error(QC("name"));const a=e.name;if(o=a,tE.call(e,"weight")&&(r=e.weight,r<=0))throw new Error(eE(a));t=rE(a),n=iE(a),i=e.getFn}return{path:t,id:n,weight:r,src:o,getFn:i}}function rE(e){return HC(e)?e:e.split(".")}function iE(e){return HC(e)?e.join("."):e}const aE={useExtendedSearch:!1,getFn:function(e,t){let n=[],o=!1;const r=(e,t,i)=>{if(JC(e))if(t[i]){const a=e[t[i]];if(!JC(a))return;if(i===t.length-1&&(GC(a)||KC(a)||function(e){return!0===e||!1===e||function(e){return YC(e)&&null!==e}(e)&&"[object Boolean]"==ZC(e)}(a)))n.push(function(e){return null==e?"":function(e){if("string"==typeof e)return e;let t=e+"";return"0"==t&&1/e==-1/0?"-0":t}(e)}(a));else if(HC(a)){o=!0;for(let e=0,n=a.length;e<n;e+=1)r(a[e],t,i+1)}else t.length&&r(a,t,i+1)}else n.push(e)};return r(e,GC(t)?t.split("."):t,0),o?n:n[0]},ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var sE={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(e,t)=>e.score===t.score?e.idx<t.idx?-1:1:e.score<t.score?-1:1,includeMatches:!1,findAllMatches:!1,minMatchCharLength:1,location:0,threshold:.6,distance:100,...aE};const lE=/[^ ]+/g;class cE{constructor(){let{getFn:e=sE.getFn,fieldNormWeight:t=sE.fieldNormWeight}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.norm=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;const n=new Map,o=Math.pow(10,t);return{get(t){const r=t.match(lE).length;if(n.has(r))return n.get(r);const i=1/Math.pow(r,.5*e),a=parseFloat(Math.round(i*o)/o);return n.set(r,a),a},clear(){n.clear()}}}(t,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.docs=e}setIndexRecords(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.records=e}setKeys(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.keys=e,this._keysMap={},e.forEach(((e,t)=>{this._keysMap[e.id]=t}))}create(){!this.isCreated&&this.docs.length&&(this.isCreated=!0,GC(this.docs[0])?this.docs.forEach(((e,t)=>{this._addString(e,t)})):this.docs.forEach(((e,t)=>{this._addObject(e,t)})),this.norm.clear())}add(e){const t=this.size();GC(e)?this._addString(e,t):this._addObject(e,t)}removeAt(e){this.records.splice(e,1);for(let t=e,n=this.size();t<n;t+=1)this.records[t].i-=1}getValueForItemAtKeyId(e,t){return e[this._keysMap[t]]}size(){return this.records.length}_addString(e,t){if(!JC(e)||XC(e))return;let n={v:e,i:t,n:this.norm.get(e)};this.records.push(n)}_addObject(e,t){let n={i:t,$:{}};this.keys.forEach(((t,o)=>{let r=t.getFn?t.getFn(e):this.getFn(e,t.path);if(JC(r))if(HC(r)){let e=[];const t=[{nestedArrIndex:-1,value:r}];for(;t.length;){const{nestedArrIndex:n,value:o}=t.pop();if(JC(o))if(GC(o)&&!XC(o)){let t={v:o,i:n,n:this.norm.get(o)};e.push(t)}else HC(o)&&o.forEach(((e,n)=>{t.push({nestedArrIndex:n,value:e})}))}n.$[o]=e}else if(GC(r)&&!XC(r)){let e={v:r,n:this.norm.get(r)};n.$[o]=e}})),this.records.push(n)}toJSON(){return{keys:this.keys,records:this.records}}}function uE(e,t){let{getFn:n=sE.getFn,fieldNormWeight:o=sE.fieldNormWeight}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new cE({getFn:n,fieldNormWeight:o});return r.setKeys(e.map(oE)),r.setSources(t),r.create(),r}function dE(e){let{errors:t=0,currentLocation:n=0,expectedLocation:o=0,distance:r=sE.distance,ignoreLocation:i=sE.ignoreLocation}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=t/e.length;if(i)return a;const s=Math.abs(o-n);return r?a+s/r:s?1:a}const pE=32;function mE(e){let t={};for(let n=0,o=e.length;n<o;n+=1){const r=e.charAt(n);t[r]=(t[r]||0)|1<<o-n-1}return t}class fE{constructor(e){let{location:t=sE.location,threshold:n=sE.threshold,distance:o=sE.distance,includeMatches:r=sE.includeMatches,findAllMatches:i=sE.findAllMatches,minMatchCharLength:a=sE.minMatchCharLength,isCaseSensitive:s=sE.isCaseSensitive,ignoreLocation:l=sE.ignoreLocation}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.options={location:t,threshold:n,distance:o,includeMatches:r,findAllMatches:i,minMatchCharLength:a,isCaseSensitive:s,ignoreLocation:l},this.pattern=s?e:e.toLowerCase(),this.chunks=[],!this.pattern.length)return;const c=(e,t)=>{this.chunks.push({pattern:e,alphabet:mE(e),startIndex:t})},u=this.pattern.length;if(u>pE){let e=0;const t=u%pE,n=u-t;for(;e<n;)c(this.pattern.substr(e,pE),e),e+=pE;if(t){const e=u-pE;c(this.pattern.substr(e),e)}}else c(this.pattern,0)}searchIn(e){const{isCaseSensitive:t,includeMatches:n}=this.options;if(t||(e=e.toLowerCase()),this.pattern===e){let t={isMatch:!0,score:0};return n&&(t.indices=[[0,e.length-1]]),t}const{location:o,distance:r,threshold:i,findAllMatches:a,minMatchCharLength:s,ignoreLocation:l}=this.options;let c=[],u=0,d=!1;this.chunks.forEach((t=>{let{pattern:p,alphabet:m,startIndex:f}=t;const{isMatch:h,score:g,indices:v}=function(e,t,n){let{location:o=sE.location,distance:r=sE.distance,threshold:i=sE.threshold,findAllMatches:a=sE.findAllMatches,minMatchCharLength:s=sE.minMatchCharLength,includeMatches:l=sE.includeMatches,ignoreLocation:c=sE.ignoreLocation}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(t.length>pE)throw new Error("Pattern length exceeds max of 32.");const u=t.length,d=e.length,p=Math.max(0,Math.min(o,d));let m=i,f=p;const h=s>1||l,g=h?Array(d):[];let v;for(;(v=e.indexOf(t,f))>-1;){let e=dE(t,{currentLocation:v,expectedLocation:p,distance:r,ignoreLocation:c});if(m=Math.min(e,m),f=v+u,h){let e=0;for(;e<u;)g[v+e]=1,e+=1}}f=-1;let b=[],y=1,w=u+d;const $=1<<u-1;for(let o=0;o<u;o+=1){let i=0,s=w;for(;i<s;)dE(t,{errors:o,currentLocation:p+s,expectedLocation:p,distance:r,ignoreLocation:c})<=m?i=s:w=s,s=Math.floor((w-i)/2+i);w=s;let l=Math.max(1,p-s+1),v=a?d:Math.min(p+s,d)+u,k=Array(v+2);k[v+1]=(1<<o)-1;for(let i=v;i>=l;i-=1){let a=i-1,s=n[e.charAt(a)];if(h&&(g[a]=+!!s),k[i]=(k[i+1]<<1|1)&s,o&&(k[i]|=(b[i+1]|b[i])<<1|1|b[i+1]),k[i]&$&&(y=dE(t,{errors:o,currentLocation:a,expectedLocation:p,distance:r,ignoreLocation:c}),y<=m)){if(m=y,f=a,f<=p)break;l=Math.max(1,2*p-f)}}if(dE(t,{errors:o+1,currentLocation:p,expectedLocation:p,distance:r,ignoreLocation:c})>m)break;b=k}const k={isMatch:f>=0,score:Math.max(.001,y)};if(h){const e=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:sE.minMatchCharLength,n=[],o=-1,r=-1,i=0;for(let a=e.length;i<a;i+=1){let a=e[i];a&&-1===o?o=i:a||-1===o||(r=i-1,r-o+1>=t&&n.push([o,r]),o=-1)}return e[i-1]&&i-o>=t&&n.push([o,i-1]),n}(g,s);e.length?l&&(k.indices=e):k.isMatch=!1}return k}(e,p,m,{location:o+f,distance:r,threshold:i,findAllMatches:a,minMatchCharLength:s,includeMatches:n,ignoreLocation:l});h&&(d=!0),u+=g,h&&v&&(c=[...c,...v])}));let p={isMatch:d,score:d?u/this.chunks.length:1};return d&&n&&(p.indices=c),p}}class hE{constructor(e){this.pattern=e}static isMultiMatch(e){return gE(e,this.multiRegex)}static isSingleMatch(e){return gE(e,this.singleRegex)}search(){}}function gE(e,t){const n=e.match(t);return n?n[1]:null}class vE extends hE{constructor(e){let{location:t=sE.location,threshold:n=sE.threshold,distance:o=sE.distance,includeMatches:r=sE.includeMatches,findAllMatches:i=sE.findAllMatches,minMatchCharLength:a=sE.minMatchCharLength,isCaseSensitive:s=sE.isCaseSensitive,ignoreLocation:l=sE.ignoreLocation}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e),this._bitapSearch=new fE(e,{location:t,threshold:n,distance:o,includeMatches:r,findAllMatches:i,minMatchCharLength:a,isCaseSensitive:s,ignoreLocation:l})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}}class bE extends hE{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let t,n=0;const o=[],r=this.pattern.length;for(;(t=e.indexOf(this.pattern,n))>-1;)n=t+r,o.push([t,n-1]);const i=!!o.length;return{isMatch:i,score:i?0:1,indices:o}}}const yE=[class extends hE{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){const t=e===this.pattern;return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}},bE,class extends hE{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){const t=e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}},class extends hE{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){const t=!e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}},class extends hE{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){const t=!e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}},class extends hE{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){const t=e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[e.length-this.pattern.length,e.length-1]}}},class extends hE{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){const t=-1===e.indexOf(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}},vE],wE=yE.length,$E=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,kE=new Set([vE.type,bE.type]);const SE=[];function _E(e,t){for(let n=0,o=SE.length;n<o;n+=1){let o=SE[n];if(o.condition(e,t))return new o(e,t)}return new fE(e,t)}const PE="$and",ME="$path",TE=e=>!(!e[PE]&&!e.$or),CE=e=>({[PE]:Object.keys(e).map((t=>({[t]:e[t]})))});function EE(e,t){let{auto:n=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=e=>{let r=Object.keys(e);const i=(e=>!!e[ME])(e);if(!i&&r.length>1&&!TE(e))return o(CE(e));if((e=>!HC(e)&&YC(e)&&!TE(e))(e)){const o=i?e[ME]:r[0],a=i?e.$val:e[o];if(!GC(a))throw new Error((e=>`Invalid value for key ${e}`)(o));const s={keyId:iE(o),pattern:a};return n&&(s.searcher=_E(a,t)),s}let a={children:[],operator:r[0]};return r.forEach((t=>{const n=e[t];HC(n)&&n.forEach((e=>{a.children.push(o(e))}))})),a};return TE(e)||(e=CE(e)),o(e)}function IE(e,t){const n=e.matches;t.matches=[],JC(n)&&n.forEach((e=>{if(!JC(e.indices)||!e.indices.length)return;const{indices:n,value:o}=e;let r={indices:n,value:o};e.key&&(r.key=e.key.src),e.idx>-1&&(r.refIndex=e.idx),t.matches.push(r)}))}function RE(e,t){t.score=e.score}class AE{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;this.options={...sE,...t},this.options.useExtendedSearch,this._keyStore=new nE(this.options.keys),this.setCollection(e,n)}setCollection(e,t){if(this._docs=e,t&&!(t instanceof cE))throw new Error("Incorrect 'index' type");this._myIndex=t||uE(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){JC(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>!1;const t=[];for(let n=0,o=this._docs.length;n<o;n+=1){const r=this._docs[n];e(r,n)&&(this.removeAt(n),n-=1,o-=1,t.push(r))}return t}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e){let{limit:t=-1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{includeMatches:n,includeScore:o,shouldSort:r,sortFn:i,ignoreFieldNorm:a}=this.options;let s=GC(e)?GC(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return function(e,t){let{ignoreFieldNorm:n=sE.ignoreFieldNorm}=t;e.forEach((e=>{let t=1;e.matches.forEach((e=>{let{key:o,norm:r,score:i}=e;const a=o?o.weight:null;t*=Math.pow(0===i&&a?Number.EPSILON:i,(a||1)*(n?1:r))})),e.score=t}))}(s,{ignoreFieldNorm:a}),r&&s.sort(i),KC(t)&&t>-1&&(s=s.slice(0,t)),function(e,t){let{includeMatches:n=sE.includeMatches,includeScore:o=sE.includeScore}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=[];return n&&r.push(IE),o&&r.push(RE),e.map((e=>{const{idx:n}=e,o={item:t[n],refIndex:n};return r.length&&r.forEach((t=>{t(e,o)})),o}))}(s,this._docs,{includeMatches:n,includeScore:o})}_searchStringList(e){const t=_E(e,this.options),{records:n}=this._myIndex,o=[];return n.forEach((e=>{let{v:n,i:r,n:i}=e;if(!JC(n))return;const{isMatch:a,score:s,indices:l}=t.searchIn(n);a&&o.push({item:n,idx:r,matches:[{score:s,value:n,norm:i,indices:l}]})})),o}_searchLogical(e){const t=EE(e,this.options),n=(e,t,o)=>{if(!e.children){const{keyId:n,searcher:r}=e,i=this._findMatches({key:this._keyStore.get(n),value:this._myIndex.getValueForItemAtKeyId(t,n),searcher:r});return i&&i.length?[{idx:o,item:t,matches:i}]:[]}const r=[];for(let i=0,a=e.children.length;i<a;i+=1){const a=e.children[i],s=n(a,t,o);if(s.length)r.push(...s);else if(e.operator===PE)return[]}return r},o=this._myIndex.records,r={},i=[];return o.forEach((e=>{let{$:o,i:a}=e;if(JC(o)){let e=n(t,o,a);e.length&&(r[a]||(r[a]={idx:a,item:o,matches:[]},i.push(r[a])),e.forEach((e=>{let{matches:t}=e;r[a].matches.push(...t)})))}})),i}_searchObjectList(e){const t=_E(e,this.options),{keys:n,records:o}=this._myIndex,r=[];return o.forEach((e=>{let{$:o,i:i}=e;if(!JC(o))return;let a=[];n.forEach(((e,n)=>{a.push(...this._findMatches({key:e,value:o[n],searcher:t}))})),a.length&&r.push({idx:i,item:o,matches:a})})),r}_findMatches(e){let{key:t,value:n,searcher:o}=e;if(!JC(n))return[];let r=[];if(HC(n))n.forEach((e=>{let{v:n,i:i,n:a}=e;if(!JC(n))return;const{isMatch:s,score:l,indices:c}=o.searchIn(n);s&&r.push({score:l,key:t,value:n,idx:i,norm:a,indices:c})}));else{const{v:e,n:i}=n,{isMatch:a,score:s,indices:l}=o.searchIn(e);a&&r.push({score:s,key:t,value:e,norm:i,indices:l})}return r}}var xE;AE.version="7.0.0",AE.createIndex=uE,AE.parseIndex=function(e){let{getFn:t=sE.getFn,fieldNormWeight:n=sE.fieldNormWeight}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{keys:o,records:r}=e,i=new cE({getFn:t,fieldNormWeight:n});return i.setKeys(o),i.setIndexRecords(r),i},AE.config=sE,AE.parseQuery=EE,function(){SE.push(...arguments)}(class{constructor(e){let{isCaseSensitive:t=sE.isCaseSensitive,includeMatches:n=sE.includeMatches,minMatchCharLength:o=sE.minMatchCharLength,ignoreLocation:r=sE.ignoreLocation,findAllMatches:i=sE.findAllMatches,location:a=sE.location,threshold:s=sE.threshold,distance:l=sE.distance}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.query=null,this.options={isCaseSensitive:t,includeMatches:n,minMatchCharLength:o,findAllMatches:i,ignoreLocation:r,location:a,threshold:s,distance:l},this.pattern=t?e:e.toLowerCase(),this.query=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.split("|").map((e=>{let n=e.trim().split($E).filter((e=>e&&!!e.trim())),o=[];for(let e=0,r=n.length;e<r;e+=1){const r=n[e];let i=!1,a=-1;for(;!i&&++a<wE;){const e=yE[a];let n=e.isMultiMatch(r);n&&(o.push(new e(n,t)),i=!0)}if(!i)for(a=-1;++a<wE;){const e=yE[a];let n=e.isSingleMatch(r);if(n){o.push(new e(n,t));break}}}return o}))}(this.pattern,this.options)}static condition(e,t){return t.useExtendedSearch}searchIn(e){const t=this.query;if(!t)return{isMatch:!1,score:1};const{includeMatches:n,isCaseSensitive:o}=this.options;e=o?e:e.toLowerCase();let r=0,i=[],a=0;for(let o=0,s=t.length;o<s;o+=1){const s=t[o];i.length=0,r=0;for(let t=0,o=s.length;t<o;t+=1){const o=s[t],{isMatch:l,indices:c,score:u}=o.search(e);if(!l){a=0,r=0,i.length=0;break}if(r+=1,a+=u,n){const e=o.constructor.type;kE.has(e)?i=[...i,...c]:i.push(c)}}if(r){let e={isMatch:!0,score:a/r};return n&&(e.indices=i),e}}return{isMatch:!1,score:1}}});const LE=(xE={"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"},function(e){return null==xE?void 0:xE[e]});var OE=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,jE=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g"),DE=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,NE=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,UE="\\ud800-\\udfff",FE="\\u2700-\\u27bf",BE="a-z\\xdf-\\xf6\\xf8-\\xff",WE="A-Z\\xc0-\\xd6\\xd8-\\xde",VE="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",qE="["+VE+"]",HE="\\d+",GE="["+FE+"]",KE="["+BE+"]",YE="[^"+UE+VE+HE+FE+BE+WE+"]",JE="(?:\\ud83c[\\udde6-\\uddff]){2}",XE="[\\ud800-\\udbff][\\udc00-\\udfff]",ZE="["+WE+"]",QE="(?:"+KE+"|"+YE+")",eI="(?:"+ZE+"|"+YE+")",tI="(?:['](?:d|ll|m|re|s|t|ve))?",nI="(?:['](?:D|LL|M|RE|S|T|VE))?",oI="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",rI="[\\ufe0e\\ufe0f]?",iI=rI+oI+"(?:\\u200d(?:"+["[^"+UE+"]",JE,XE].join("|")+")"+rI+oI+")*",aI="(?:"+[GE,JE,XE].join("|")+")"+iI,sI=RegExp([ZE+"?"+KE+"+"+tI+"(?="+[qE,ZE,"$"].join("|")+")",eI+"+"+nI+"(?="+[qE,ZE+QE,"$"].join("|")+")",ZE+"?"+QE+"+"+tI,ZE+"+"+nI,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",HE,aI].join("|"),"g");var lI=RegExp("[']","g");function cI(e){return function(t){return function(e,t,n){for(var o=-1,r=null==e?0:e.length;++o<r;)n=t(n,e[o],o,e);return n}(function(e,t,n){return e=xf(e),void 0===(t=n?void 0:t)?function(e){return NE.test(e)}(e)?function(e){return e.match(sI)||[]}(e):function(e){return e.match(DE)||[]}(e):e.match(t)||[]}(function(e){return(e=xf(e))&&e.replace(OE,LE).replace(jE,"")}(t).replace(lI,"")),e,"")}}var uI=cI((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()}));const dI=uI,pI=Vt({}),mI=Vt({}),fI=["c4009e2e-aa48-4ae7-aa2d-5dd37ba3c41e","d3c0bd21-4d19-437f-96b9-0189d905c885","987ad7d5-2d46-42e3-9986-f8553cc7cb40","c87653d6-3b56-4769-ab3c-377376c9e335"];function hI(e,t){let{automation:n={},params:o,...r}=t;const i=e.get("EditorAutomation"),a=e.get("Katnip");return r.params=Object.keys(o).reduce((function(e,t){return e[t]=i.getMomentValue(a.metadata[r.slug].params[t],n[t],o[t]),e}),{}),delete r.id,delete r.uniqueId,delete r.$$hashKey,r}function gI(e){return[{id:ad(),bypass:!1,params:Object.entries(e.params).reduce((function(e,t){let[n,{default:o}]=t;return e[n]=o,e}),{}),slug:e.slug,automation:_.reduce(e.params,(function(e,t,n){return e[n]=[],e}),{})}]}function vI(e){return{autoPan:"<pedal-auto-pan></pedal-auto-pan>",autoWah:"<pedal-auto-wah></pedal-auto-wah>",backCompr:"<pedal-back-compr></pedal-back-compr>",beatSyncDelay2:"<pedal-beat-sync-delay2></pedal-beat-sync-delay2>",bossCE5:"<pedal-boss-ce5></pedal-boss-ce5>",cabinet:"<pedal-cabinet></pedal-cabinet>",chorus:"<pedal-chorus></pedal-chorus>",compressor:"<pedal-compressor></pedal-compressor>",compander:"<pedal-compander></pedal-compander>",ddelay:"<pedal-ddelay></pedal-ddelay>",ddelayPlus:"<pedal-ddelay-plus></pedal-ddelay-plus>",reverser:"<pedal-reverser></pedal-reverser>",pumper:"<pedal-pumper></pedal-pumper>",delay:"<pedal-delay></pedal-delay>",threeBandEq:"<pedal-equalizer></pedal-equalizer>",exciter:"<pedal-exciter></pedal-exciter>",expGate:"<pedal-exp-gate></pedal-exp-gate>",filter:"<pedal-filter></pedal-filter>",gain:"<pedal-gain></pedal-gain>",genericAmp:"<pedal-generic-amp></pedal-generic-amp>",guitarAmp:"<pedal-guitar-amp></pedal-guitar-amp>",guitarCab:"<pedal-guitar-cab></pedal-guitar-cab>",octaver:"<pedal-octaver></pedal-octaver>",rossCompr:"<pedal-ross-compressor></pedal-ross-compressor>",la2aCompr:"<pedal-la2a-compressor></pedal-la2a-compressor>",compr1176:"<pedal-compressor-1176></pedal-compressor-1176>",overdrive:"<pedal-overdrive></pedal-overdrive>",bigMuffPi:"<pedal-big-muff-pi></pedal-big-muff-pi>",bossMT2:"<pedal-boss-mt2></pedal-boss-mt2>",proCoRat:"<pedal-pro-co-rat></pedal-pro-co-rat>",mxrDistortion:"<pedal-mxr-distortion></pedal-mxr-distortion>",fuzzFace:"<pedal-fuzz-face></pedal-fuzz-face>",bossBD2:"<pedal-boss-bd2></pedal-boss-bd2>",tapeSimulator:"<pedal-tape-simulator></pedal-tape-simulator>",tubeScreamer2:"<pedal-tube-screamer2></pedal-tube-screamer2>",phaser:"<pedal-phaser></pedal-phaser>",deEsser:"<pedal-de-esser></pedal-de-esser>",reverbHybrid:"<pedal-reverb-hybrid></pedal-reverb-hybrid>",springReverb2:"<pedal-spring-reverb2></pedal-spring-reverb2>",simpleStudioReverb:"<pedal-simple-studio-reverb></pedal-simple-studio-reverb>",tremolo:"<pedal-tremolo></pedal-tremolo>",tubeScreamer:"<pedal-tube-screamer></pedal-tube-screamer>",univerb:"<pedal-univerb></pedal-univerb>",dimensionD:"<pedal-dimension-d></pedal-dimension-d>",mxrPhase90:"<pedal-mxr-phase-90></pedal-mxr-phase-90>",ehSmallStone:"<pedal-eh-small-stone></pedal-eh-small-stone>",bossVB2:"<pedal-boss-vb2></pedal-boss-vb2>",bossGE7:"<pedal-boss-ge7></pedal-boss-ge7>",antiSqueal:"<pedal-anti-squeal></pedal-anti-squeal>",stereoSpreader:"<pedal-stereo-spreader></pedal-stereo-spreader>",lofi:"<pedal-lofi></pedal-lofi>",threeBandEq2:"<pedal-three-band-eq2></pedal-three-band-eq2>",masteringLimiter:"<pedal-mastering-limiter></pedal-mastering-limiter>",multiShifter:'<pedal-multi-shifter"></pedal-multi-shifter>',pitchShifter:"<pedal-pitch-shifter></pedal-pitch-shifter>",vocalDoubler:"<pedal-vocal-doubler></pedal-vocal-doubler>",pingpongDelay:"<pedal-pingpong-delay></pedal-pingpong-delay>",enhancer:"<pedal-enhancer></pedal-enhancer>",visualEq:"<pedal-visual-eq></pedal-visual-eq>"}[e]}function bI(){const e=Vt({}),t=Vt(new Map),n=Vt(null);let o;return Ar((function(){if(!n.value)return void t.value.clear();const r=getComputedStyle(n.value).paddingTop;o=new IntersectionObserver((function(n){const o=n.filter((e=>e.isIntersecting))[0];if(o){const n=t.value.get(o.target);e.value=n??{}}}),{root:n.value,rootMargin:`-${r} 1px -100% 0px`,threshold:[0,1]}),o.disconnect();for(const e of[...t.value.keys()])e&&o.observe(e)})),{activeGroup:e,groupsMap:t,jumpToGroupByIndex:function(e){const o=[...t.value.keys()],r=o[e],i=o[0].offsetTop;n.value.scrollTo({top:r.offsetTop-i,behavior:"smooth"})},jumpToGroupByKeyValue:function(e,o){const[r]=[...t.value.entries()].find((t=>t[1][e]===o)),i=[...t.value.keys()][0].offsetTop;n.value.scrollTo({top:r.offsetTop-i,behavior:"smooth"})},scrollContainer:n,getGroupIndexByName:function(e){const n=dI(e),o=[...t.value.values()];for(let e=0;e<o.length;e++)if(dI(o[e].name)===n)return e;return-1}}}function yI(e,t){const n=e.get("AppNotifications"),o=e.get("EffectsPreset"),r=e.get("Me"),i=e.get("$state"),a=e.get("appActions"),s=Vt(0),l=Gi((()=>{const e=t.value.attributors[t.value.attributors.length-1];return r.username===e.username})),c=Gi((()=>(t.value.link||"").split("effect-presets/")[1]));let u;return{buttonState:s,linkToken:c,isMySharedPreset:l,saveToLibrary:d,saveAndOpenInEditor:function(){if(a.checkAllowed("savePreset"))return l.value?p(t.value.id):2===s.value?p(u):d("open_in_mix_editor").then((function(e){return p(e.id)}))}};function d(e){if(a.checkAllowed("savePreset"))return s.value=1,o.saveSharedPreset(c.value).then((function(t){return Promise.resolve().then((()=>rb)).then((function(n){let{logEffectsPresetLinkOpen:o}=n;o(t,e)})),s.value=2,u=t.id,n.addNotification({title:"Added to library",classList:"success",autoclose:5e3}),t})).catch((function(e){s.value=0,n.addNotification({title:"Something went wrong while saving",content:e.data?.message||"Something went wrong, please try again later",classList:"alert",autoclose:5e3})}))}function p(e){if(!Yf&&!Jf)return i.go("mixEditor",{preset:e});{const t=i.href("mixEditor",{preset:e},{absolute:!0});window.open(t,"_blank")}}}async function wI(e,t,n){let{attributors:o,description:r,displayName:i,effects:a,id:s,originalPresetId:l,pictureFile:c,pictureId:u}=n;const d=e.get("$analytics"),p=e.get("EffectsPreset"),m=e.get("Me");s="create"===(t="create"===t?t:"update")?ad():s;const f="create"===t?{originalPresetId:l}:{};try{c&&(u=await function(t){const n=new Image;return n.src=URL.createObjectURL(t),new Promise((function(e){n.onload=function(){const t=Math.min(n.height,n.width),o=(n.width-t)/2,r=(n.height-t)/2;e({x:o,y:r,height:t,width:t})}})).then((function(n){return e.get("FileHelper").upload(t,"https://storage.bandlab.com/v1.3/images/effect-presets",{params:n})})).then((e=>{let{data:t}=e;return t.id}))}(c));const n=await p[{create:"saveUserPreset",update:"updateUserPreset"}[t]]({id:s,displayName:i,description:r,effects:a.map((t=>hI(e,t))),...f,pictureId:u,userId:m.id});d.eventTrack({create:"Save User Preset",update:"Update User Preset"}[t],{category:"Mix Editor",label:a.length});const h=(o||[{}]).slice(-1)[0];if("create"===t||h.userId!==m.id){const e={effects_used:a.filter((e=>!e.bypass)).map((e=>e.slug)),author_user_id:n.attributors[0].userId,parent_preset_id:l||"None"};n.attributors.length>1&&(e.last_editor_user_id=n.attributors.slice(-1)[0].userId),Promise.resolve().then((()=>rb)).then((function(t){let{logEffectsPresetCreate:n}=t;n(e)}))}return n}catch(t){throw e.get("AppNotifications").addNotification({title:"Something went wrong while saving",content:t.data?.message}),t}}const $I={class:"ds-zerocase-illustration","aria-hidden":"true"},kI={width:"96",height:"96",viewBox:"0 0 96 96",fill:"currentColor",class:"ds-zerocase-illustration-shape"},SI={key:0,d:"m0 8 96 8-8 72H8L0 8Z"},_I={key:1,d:"M8 68 0 96l64-8 32 8-8-56 8-40-48 16L0 8l8 60Z"},PI={key:2,d:"m68 80 28 8V8l-68 8L0 8l8 48-8 32 68-8Z"},MI={key:3,d:"M8 56 0 24 28 8l68 8-8 24 8 48-28-8-68 8 8-32Z"},TI={key:4,d:"M8 48 0 24 72 0l24 48-16 32 8 16-88-8 8-40Z"},CI={key:5,d:"m68 80 28 8V16L0 8l8 80 60-8Z"},EI={key:0,class:"ds-zerocase-text-content"},II={key:0,class:"ds-zerocase-title"},RI={key:1,class:"ds-zerocase-message"},AI={key:1,class:"ds-zerocase-cta"},xI={__name:"ZeroCase",props:{as:{type:String,default:"section"},illustrationShape:{type:Number,default:()=>Math.floor(6*Math.random()+1)},verticalAlignment:{default:"center",validator:e=>["center","top"].includes(e)}},setup:e=>(t,n)=>(si(),mi(yo(e.as),{class:ae(["ds-zerocase","center"===e.verticalAlignment?"":"ds-zerocase-with-extra-margin-block"])},{default:Tn((()=>[bi("div",$I,[(si(),pi("svg",kI,[1===e.illustrationShape?(si(),pi("path",SI)):2===e.illustrationShape?(si(),pi("path",_I)):3===e.illustrationShape?(si(),pi("path",PI)):4===e.illustrationShape?(si(),pi("path",MI)):5===e.illustrationShape?(si(),pi("path",TI)):6===e.illustrationShape?(si(),pi("path",CI)):_i("v-if",!0)])),Po(t.$slots,"illustration-icon",{class:"ds-zerocase-illustration-icon"})]),t.$slots.title||t.$slots.message?(si(),pi("div",EI,[t.$slots.title?(si(),pi("strong",II,[Po(t.$slots,"title")])):_i("v-if",!0),t.$slots.message?(si(),pi("p",RI,[Po(t.$slots,"message")])):_i("v-if",!0)])):_i("v-if",!0),t.$slots.cta?(si(),pi("div",AI,[Po(t.$slots,"cta")])):_i("v-if",!0)])),_:3},8,["class"]))},LI=Object.freeze(Object.defineProperty({__proto__:null,default:xI},Symbol.toStringTag,{value:"Module"})),OI=["width","height","aria-hidden"],jI=[bi("path",{fill:"currentColor","fill-rule":"evenodd",d:"M16 30a14 14 0 1 1 0-28 14 14 0 0 1 0 28M5 16a11 11 0 1 0 22 0 11 11 0 0 0-22 0","clip-rule":"evenodd"},null,-1),bi("path",{fill:"currentColor",d:"m34.94 37.06-7.76-7.76 2.12-2.12 7.76 7.76z"},null,-1)],DI={__name:"zerocase-search",props:{size:{type:Number,required:!0}},setup:e=>(t,n)=>(si(),pi("svg",{width:e.size,height:e.size,viewBox:"0 0 40 40",fill:"none","aria-hidden":t.$attrs["aria-label"]||t.$attrs["aria-labelledby"]?null:"true"},jI,8,OI))},NI=Object.freeze(Object.defineProperty({__proto__:null,default:DI},Symbol.toStringTag,{value:"Module"}));var UI=function(){try{var e=wc(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();const FI=UI;function BI(e,t,n){"__proto__"==t&&FI?FI(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function WI(e,t,n,o){for(var r=-1,i=null==e?0:e.length;++r<i;){var a=e[r];t(o,a,n(a),e)}return o}const VI=function(e,t,n){for(var o=-1,r=Object(e),i=n(e),a=i.length;a--;){var s=i[++o];if(!1===t(r[s],s,r))break}return e};var qI=function(e,t){if(null==e)return e;if(!Wm(e))return function(e,t){return e&&VI(e,t,Vm)}(e,t);for(var n=e.length,o=-1,r=Object(e);++o<n&&!1!==t(r[o],o,r););return e};const zI=qI;function HI(e,t,n,o){return zI(e,(function(e,r,i){t(o,e,n(e),i)})),o}var GI,KI=Object.prototype.hasOwnProperty;const YI=(GI=function(e,t,n){KI.call(e,n)?e[n].push(t):BI(e,n,[t])},function(e,t){var n={};return(im(e)?WI:HI)(e,GI,Vf(t),n)}),JI=["aria-expanded"],XI={key:0},ZI={id:"sampler-flyout",class:"mix-editor-flyout sampler-kit-flyout"},QI={class:"mix-editor-flyout-header"},eR={class:"semibold-18"},tR={class:"mix-editor-flyout-search"},nR={key:1,class:"mix-editor-flyout-2-col"},oR={class:"mix-editor-flyout-scrollable row-gap-8"},rR=["onClick"],iR={class:"mix-editor-flyout-scrollable-sticky-title semibold-16"},aR=["onClick"],sR=["onClick"],lR={style:{flex:"1","min-width":"0"}},cR={class:"regular-14/20 text-truncate"},uR={key:0,class:"sampler-kit-metadata"},dR=Vn({__name:"SamplerKitFlyout",props:{track:{},isSamplerKitsLoaded:{type:Boolean},hasSamplerKitChanged:{type:Boolean},allowAction:{type:Boolean},setIsInBackground:{type:Function},samplerKits:{},selectSamplerKit:{type:Function}},setup(e){const t=zn((()=>Promise.resolve().then((()=>xW)))),n=zn((()=>import("./chunk-05085d69.js"))),o=zn((()=>Promise.resolve().then((()=>JW)))),r=zn((()=>Promise.resolve().then((()=>aU)))),i=zn((()=>Promise.resolve().then((()=>zj)))),a=e,s=Vt(null),l=Vt(null),c=Vt(new Map),u=Vt(""),d=Vt(!1),p=Vt(null),m={threshold:.3,ignoreLocation:!0},f=Gi((()=>new AE(a.samplerKits,{...m,keys:[{name:"displayName",weight:4},{name:"name",weight:4},{name:"groupTitle",weight:2},{name:"features.multipadSampler.key",weight:2},{name:"genres",weight:1.5},{name:"characters",weight:1},{name:"instruments",weight:.5}]}))),{activeGroup:h,groupsMap:g,jumpToGroupByIndex:v,scrollContainer:b}=bI(),y=[{id:"my_kits",name:"My Kits"},{id:"curated_kits",name:"Curated Kits"}];h.value=y[0];const w=Gi((()=>{g.value.clear();const e=u.value?f.value.search(u.value).map((e=>e.item)):a.samplerKits;return YI(e,"groupId")})),$=Gi((()=>Object.keys(w.value).map((e=>y.find((t=>t.id===e))))));YS.onended=function(){YS.pause(),p.value=null},Lr(d,(()=>{d.value?(a.setIsInBackground(!0),requestAnimationFrame((()=>{if(!a.track.samplerKit)return;const e=c.value.get(a.track.samplerKit?.originalSamplerKitId);if(e){const t=c.value.values().next().value,n=e.offsetTop-t.offsetTop;b.value?.scrollTo({top:n-30}),b.value?.scrollTo({top:n,behavior:"smooth"})}}))):(a.setIsInBackground(!1),0===$.value.length&&(u.value=""),YS.pause(),p.value=null,c.value.clear())}));const k=Vt({});function S(e){return"my_kits"===e.groupId?e.id:e.features.multipadSampler?.id}function _(e){return a.track.samplerKit?.originalSamplerKitId===S(e)}function P(e){const t=[];return["instruments","genres","characters"].forEach((n=>{if(!e[n].length)return;const o=e[n].map((e=>{const t=k.value[n]?.[e];return t?.name}));t.push(o.filter((e=>!!e)).join(", "))})),e.features.multipadSampler.key&&t.push(e.features.multipadSampler.key),e.features.multipadSampler.tempo&&t.push(`${e.features.multipadSampler.tempo}bpm`),t}return ao((async()=>{const e=await w$();["instruments","characters","genres"].forEach((t=>{k.value[t]=e[t]?.reduce(((e,t)=>(e[t.id]=t,e)),{})}))})),co((function(){YS.pause(),YS.onended=null})),(e,a)=>(si(),pi(ti,null,[bi("div",{id:"audio-input-select-preset",ref_key:"flyoutOpenerElement",ref:l,role:"button",class:ae(["audio-input-select",{disabled:!e.allowAction,loading:!e.isSamplerKitsLoaded}]),"aria-haspopup":"menu","aria-controls":"sampler-flyout","aria-expanded":d.value,onClick:a[0]||(a[0]=e=>d.value=!d.value)},[bi("span",null,[ki(me(e.track.samplerKit?.displayName||"Custom")+" ",1),e.hasSamplerKitChanged?(si(),pi("em",XI,"(edited)")):_i("v-if",!0)])],10,JI),yi(Gt(n),{ref_key:"flyoutElement",ref:s,visible:d.value,"onUpdate:visible":a[2]||(a[2]=e=>d.value=e),"max-height":"576px",opener:l.value},{default:Tn((()=>[bi("div",ZI,[bi("div",QI,[bi("div",eR,me("Sampler Kits"),1),bi("div",tR,[yi(Gt(i),{modelValue:u.value,"onUpdate:modelValue":a[1]||(a[1]=e=>u.value=e),placeholder:"Search",as:"div",autofocus:""},null,8,["modelValue","placeholder"])])]),0===$.value.length?(si(),mi(xI,{key:0},{"illustration-icon":Tn((e=>[yi(DI,{class:ae(e.class),size:40},null,8,["class"])])),title:Tn((()=>[ki(me("No Sampler Kits found"),1)])),message:Tn((()=>[ki(me("Try a different search term or filter from our list."),1)])),_:1})):_i("v-if",!0),$.value.length>0?(si(),pi("div",nR,[bi("div",oR,[(si(!0),pi(ti,null,So($.value,((e,t)=>(si(),pi("a",{key:t,class:ae([{active:Gt(h)?.id===e.id},"typography-body-default-regular undecorated-anchor mix-editor-flyout-nav"]),onClick:e=>Gt(v)(t)},me(e.name),11,rR)))),128))]),bi("div",{ref_key:"scrollContainer",ref:b,class:"mix-editor-flyout-scrollable row-gap-16"},[(si(!0),pi(ti,null,So($.value,((n,i)=>(si(),pi("div",{key:i,ref_for:!0,ref:e=>{const t=e;Gt(g).set(t,n)},class:"row-gap-8"},[bi("span",iR,me(n.name),1),(si(!0),pi(ti,null,So(w.value[n.id],(n=>(si(),pi("div",{key:n.id,ref_for:!0,ref:e=>c.value.set(S(n),e),class:ae([{selected:_(n)},"sampler-kit-list-item"]),onClick:t=>e.selectSamplerKit(n)},[bi("div",{class:"sampler-kit-list-item-preview-button",onClick:ss((e=>function(e){p.value=e;var t=e.audioUrl;t!==YS.src||YS.paused?(YS.src=t,YS.play().catch((()=>{}))):(p.value=null,YS.pause())}(n)),["stop"])},[p.value&&S(n)===S(p.value)?(si(),mi(Gt(o),{key:0,size:16})):(si(),mi(Gt(r),{key:1,size:16}))],8,sR),bi("div",lR,[bi("div",cR,me("my_kits"===n.groupId?n.displayName:n.name),1),"curated_kits"===n.groupId?(si(),pi("div",uR,[(si(!0),pi(ti,null,So(P(n),(e=>(si(),pi("span",{key:e},me(e),1)))),128))])):_i("v-if",!0)]),_(n)?(si(),mi(Gt(t),{key:0,class:"sampler-kit-list-item-selected",size:24})):_i("v-if",!0)],10,aR)))),128))])))),128))],512)])):_i("v-if",!0)])])),_:1},8,["visible","opener"])],64))}});function pR(e,t,n,o,r,i,a,s,l){return{replace:!0,restrict:"E",template:'<div style="min-width: 0; flex: 1;"></div>',link:async function(c,u){const d=Mt({track:c.getTrack(),allowAction:n.isAllowed("editTrack"),hasSamplerKitChanged:!1,isSamplerKitsLoaded:!1,samplerKits:[],setIsInBackground:e=>a.setIsInBackground=e,selectSamplerKit:n=>{if("my_kits"===n.groupId)return DC(t,Ot(c=n),l.getSampler()),e.eventTrack("Load sampler kit",{category:"Mix Editor",extra:c}),void e.eventTrack("blsounds_action",{platform:"firebase",params:{action:"select",content_type:"pack",category:"studio",content_id:c.id,is_user_content:!0,triggered_from:"sampler_my_kits"}});var c;!async function(n){const c=n.features.multipadSampler;if(!c)throw new Error(`${n.name} does not have multipad sampler features`);o.pushUndo(i.current),DC(t,Ot(c),l.getSampler());const u=!(!c.key||i.current.key),d=!(!c.tempo||!i.current.metronome.pristine||a.songDuration);await async function(e,t){if(!t)return void(e&&await r.askKeyUpdateConfirmation(c.key)&&(i.current.key=c.key,s.transposeKeys(c.key,i.current.key??c.key)));const{createModal:n}=await Promise.resolve().then((()=>Tg));return new Promise((o=>{const r=zn((()=>import("./chunk-b1f77df0.js"))),l={size:"small",subtitle:"",title:"Recommended",actions:[{label:"No Thanks",color:"secondary",onClick:()=>o()}]};a.isInBackground=!0,l.subtitle=e&&t?`Recommended settings for this audio pack are ${c.tempo} BPM and ${c.key}.`:`Recommended setting for this audio pack is ${c.tempo} BPM`,l.actions.push({label:e&&t?"Set tempo and key":"Set Tempo",color:"primary",onClick:()=>{i.current.metronome.bpm=c.tempo,i.current.metronome.pristine=!1,e&&(i.current.key=c.key,s.transposeKeys(c.key,i.current.key??c.key)),o()}}),n(r,l,{onClose:()=>{a.isInBackground=!1,o()}})}))}(u,d),e.eventTrack("Load sampler kit",{category:"Mix Editor",extra:n}),e.eventTrack("blsounds_action",{platform:"firebase",params:{action:"select",content_type:"pack",category:"studio",content_id:n.id,is_user_content:!1,triggered_from:"sampler_curated"}})}(n)}});c.$watch((()=>{const e=RC(),t=EC(),o=e.map((e=>({...e,groupId:"my_kits"}))),r=t.map((e=>({...e,groupId:"curated_kits"}))),i=[...o,...r];d.samplerKits=i;const a=c.getTrack();d.hasSamplerKitChanged=Boolean(UC(0,a.samplerKit||{}));const s=a.samplerKit?.originalSamplerKitId,l=o.find((e=>s===e.id)),u=t.find((e=>s===e.features.multipadSampler.id)),p=!(l||u);a.samplerKit&&p&&(a.samplerKit.originalSamplerKitId=null,a.samplerKit.displayName=null),d.allowAction=n.isAllowed("editTrack"),d.track={...a}})),PC?.then((()=>{d.isSamplerKitsLoaded=!0}));const p=function(e){let t=arguments.length>2?arguments[2]:void 0;const n=ps({provide:arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},render:()=>Ki(dR,t)});return n.mount(e),n}(u[0],{},d);c.$on("$destroy",p.unmount)}}}pR.$inject=["$analytics","$injector","EditorAllowActions","EditorHistory","EditorImporter","EditorRevision","EditorState","MidiEditor","SharedMidiSynth"],angular.module("bandlab.audio").directive("instrumentExpandedViewDropdown",["EditorHelper","EditorState","MidiDevice","SharedMidiSynth",function(e,t,n,o){return{replace:!0,restrict:"E",template:"<div></div>",link:async function(r,i){import("./chunk-66966c44.js").then((function(a){let{mount:s}=a;const l=s(i[0],{scope:r,EditorHelper:e,EditorState:t,MidiDevice:n,SharedMidiSynth:o});r.$on("$destroy",(function(){l.unmount()}))}))}}}]).directive("mixEditorInputVolumeMonitoring",["$analytics","EditorPlayer","EditorRevision","InputDevice",function(e,t,n,o){return{replace:!0,restrict:"E",template:'<div class="mix-editor-input-volume-monitoring"></div>',link:async function(r,i){import("./chunk-0977bc43.js").then((function(a){let{mount:s}=a;const l=s(i[0],{$analytics:e,scope:r,EditorPlayer:t,EditorRevision:n,InputDevice:o});r.$on("$destroy",(function(){l.unmount()}))}))}}}]).directive("samplerKitToolsMenu",["$injector",function(e){return{replace:!0,restrict:"E",template:"<div></div>",link:async function(t,n){import("./chunk-44123599.js").then((function(o){let{mount:r}=o;const i=r(n[0],{$injector:e,scope:t});t.$on("$destroy",(function(){i.unmount()}))}))}}}]).directive("audioInput",["$injector","ConfirmModal","EditorHelper","EditorRevision","EditorState","EditorTrack","EffectsPreset","SharedMidiSynth","Soundbank",function(e,t,n,o,r,i,a,s,l){return{restrict:"E",templateUrl:"https://www.bandlab.com/web-app/audio/partials/_audio-input-99df960e.html",replace:!0,scope:{canChangeInput:"=",getTrack:"=",hidePanel:"=",toggleAutomationView:"="},controller:["$rootScope","$scope","Me",function(c,u,d){function p(){return l.getPropertyValue(u.getTrack().soundbank,"instrumentSlug")}u.current=l.getCurrent(),u.getCategories=l.getCategories,u.state=r,u.user=d,u.shouldHidePanel=function(){return!o.current.tracks.length||!u.getTrack().id||!r.isPresetSettingsVisible&&!r.isAudioInputVisible&&!r.isAutoPitchVisible},u.hasKeyMappings=function(){return(n.isBandLabInstrumentTrack(u.getTrack())||u.getTrack().type===Ks)&&!r.isPresetSettingsVisible},u.notifyInputChanged=function(){setTimeout((function(){c.$broadcast(gT)}))},u.isDrumMachine=function(){return u.getTrack().type===Ks},u.isExpandedView=function(){return(r.isAudioInputVisible||r.isAutoPitchVisible)&&"audioinput"!==u.current.input.kind&&"sampler"!==u.current.input.kind},u.isKeyboardView=function(){return u.isExpandedView()&&"drum-pads"!==p()&&"drum-kit"!==p()&&!u.isDrumMachine()},u.isSustaining=function(){return s.isSustaining()},u.$on("MidiMessage:noteEvent",(function(){u.$digest()})),u.deleteUserPreset=function(e){new t({contentScope:{title:"Delete this preset?"},onConfirm:function(){const t=_.get(u.getTrack(),"effectsData.originalPresetId");return a.deleteUserPreset({id:e||t}).then((function(){e&&e!==t||i.selectPreset(Vs,{shouldAskConfirmation:!1})}))}}).show()},u.resetUserPreset=function(){const e=_.get(u.getTrack(),"effectsData.originalPresetId",u.getTrack().preset),t=[...a.getPresetsSync().all,...a.getUserPresetsSync(),...a.trendingPresets.value].find((t=>t.id===e||t.slug===e));i.selectPreset(t)},u.exportSamplerKitForCurator=()=>function(e,t){return Promise.all([import("./chunk-51f87187.js").then((e=>e.j)),kC(e,t,!0)]).then((function(e){let[{default:t},n]=e;if(!n)return;const{samplerKit:o,samples:r}=n,i=new t;o.kit=JSON.parse(o.kit),i.file("kit.json",JSON.stringify(o,null,2));for(const e of r)i.file(`samples/${e.id}.wav`,e.blob);return i.generateAsync({type:"blob"})})).then((function(e){Kh(e)}))}(e,u.getTrack()),u.octave=qS.octave,u.minOctave=Math.max(-1,u.current.soundbank.minOctave),u.maxOctave=Math.min(8,u.current.soundbank.maxOctave);const m=Lr((()=>qS.octave),(e=>{u.octave=e}));u.$on("$destroy",(()=>{m()})),l.getList().then((function(){u.$watch("current.soundbank",(function(e){e&&e.slug&&l.getBank(e).then((function(e){u.minOctave=Math.max(-1,e.minOctave),u.maxOctave=Math.min(8,e.maxOctave),qS.octave=As(qS.octave,e.minFullOctave,e.maxFullOctave),s.setSoundbank(e),s.stopNotes()}))}))}))}]}}]).directive("mixEditorFocusInstrument",["$document","EditorState",function(e,t){return{restrict:"A",link:function(n,o){const r=[".select-menu",".instrument-expanded-view-dropdown",".mix-editor-audio-input",".mix-editor-context-menu",".mix-editor-flyout",".mix-editor-track-header",".mix-editor-footer",".mix-editor-toolbar",".modal"],i=n.$watch((()=>t.isAudioInputVisible),(t=>{if(t)return o.on("mousedown touchstart",a),void e.on("mousedown touchstart",s);o.off("mousedown touchstart",a),e.off("mousedown touchstart",s)}));function a(){t.isAudioInputActive=!0,n.$applyAsync()}function s(e){e.target===o[0]||o[0].contains(e.target)||r.some((t=>e.target.closest(t)))||(t.isAudioInputActive=!1,n.$applyAsync())}n.$on("$destroy",(()=>{i(),e.off("mousedown touchstart",s)}))}}}]).directive("midiDeviceSelect",["EditorState","MidiDevice",function(e,t){return{replace:!0,restrict:"E",template:"<div></div>",link:async function(n,o){import("./chunk-920db565.js").then((function(r){let{mount:i}=r;const a=i(o[0],{scope:n,EditorState:e,MidiDevice:t});n.$on("$destroy",(function(){a.unmount()}))}))}}}]).directive("virtualInstrumentPanelHeader",["$analytics","$rootScope","DrumMachine","DrumMachineState","editorEvents","EditorHistory","EditorRevision","EditorState","MidiEditor","MidiEditorState","Soundbank",function(e,t,n,o,r,i,a,s,l,c,u){return{replace:!0,restrict:"E",template:'<div class="virtual-instrument-panel-header"></div>',link:async function(d,p){const{EditorDraggedItem:m}=await Promise.resolve().then((()=>n_)),f=Mt({isKeyboardView:d.isKeyboardView(),isDrumMachine:d.isDrumMachine(),armPushUndo:()=>rd((()=>{i.pushUndo(a.current),d.$applyAsync()})),currentInput:d.current.input,currentSoundbank:d.current.soundbank,getSoundbankCategories:u.getCategories,logSelectSoundbank:(t,n,o)=>{e.eventTrack("Select Sound Bank",{category:"Mix Editor",label:`${t.subTitle} - ${t.name}`,extra:{soundbank:t}}),e.eventTrack("blsounds_action",{platform:"firebase",params:{action:"select",content_type:"instrument",category:"studio",content_id:t.slug,collection_id:n,triggered_from:o}})},notifyInputChanged:()=>{d.notifyInputChanged(),d.$applyAsync()},setIsInBackground:e=>s.setIsInBackground=e,setCurrentInput:e=>d.current.input=e,setCurrentSoundbank:e=>d.current.soundbank=e,isGlobalPlaybackActive:s.isPlaying,selectedPatternIndex:o.selectedPatternIndex,selectPatternByIndex:function(e){if(n.selectPatternByIndex(e),o.patterns[e]){const t=o.patterns[e];a.selectedRegions=new Set(a.current.tracks.map((e=>e.regions)).flat().filter((e=>e.sampleId===t.sampleId)))}},togglePlayback:()=>{o.isLive=!1,n.toggle(),d.$applyAsync()},isPlaying:!1,isLiveMode:!1,insertPatternAtPlayhead:function(){t.$broadcast(r.importFile,{time:s.crTime,type:Ks})},setDraggedPattern:function(){m.value={trackId:a.selectedTrack.id,type:Ks,duration:n.getPatternDurationInSeconds(o.selectedPatternIndex)}},unsetDraggedPattern:function(){m.value={}},swingAmount:o.swingAmount,setSwingAmount:e=>{i.pushUndo(a.current),n.setSwingAmount(e)},patternLengthInBars:o.patternLengthInBars,setSelectedPatternLengthInBars:e=>{i.pushUndo(a.current),n.setSelectedPatternLengthInBars(e)},velocityMode:o.velocityMode,setVelocityMode:n.setVelocityMode});d.$watchGroup([d.isKeyboardView,"current.soundbank","current.input"],(()=>{f.isKeyboardView=d.isKeyboardView(),f.isDrumMachine=d.isDrumMachine(),f.currentSoundbank=d.current.soundbank,f.currentInput=d.current.input}));let h=angular.noop;d.$watch("isDrumMachine",(e=>{h(),h=e?d.$watchGroup(["state.isPlaying",()=>o.isLive,n.isActive,()=>o.patternLengthInBars,()=>o.selectedPatternIndex,()=>o.swingAmount,()=>o.velocityMode],(()=>{f.isGlobalPlaybackActive=s.isPlaying,f.selectedPatternIndex=o.selectedPatternIndex,f.isPlaying=!!n.isActive(),f.isLiveMode=o.isLive,f.patternLengthInBars=o.patternLengthInBars,f.swingAmount=o.swingAmount,f.velocityMode=o.velocityMode})):angular.noop})),import("./chunk-136d3dfe.js").then((t=>{let{mount:n}=t;const o=n(p[0],{$analytics:e,scope:d,MidiEditor:l,MidiEditorState:c},f);d.$on("$destroy",o.unmount)}))}}}]).directive("samplerKitFlyout",pR),angular.module("bandlab.audio").directive("audioInputEffectsChainSelector",["$compile","$injector","$rootScope",function(e,t,n){return{restrict:"E",replace:!0,template:"<div></div>",link:function(o,r){import("./chunk-e24e1ada.js").then((function(i){let{mountEffectsSelectorChain:a}=i;const s=a(r[0],{$compile:e,$injector:t,$rootScope:n,scope:o});o.$on("$destroy",(function(){s.unmount()}))}))}}}]).directive("audioInputEffectsSelector",["$compile","$injector","$rootScope",function(e,t,n){return{restrict:"E",replace:!0,template:"<div></div>",link:function(o,r){import("./chunk-e24e1ada.js").then((function(i){let{mountEffectsSelector:a}=i;const s=a(r[0],{$compile:e,$injector:t,$rootScope:n,scope:o});o.$on("$destroy",(function(){s.unmount()}))}))}}}]).directive("audioInputPresetsSelector",["$analytics","$compile","$filter","$injector","$rootScope","$state","$stateParams","Me",function(e,t,n,o,r,i,a,s){return{restrict:"E",replace:!0,link:function(l,c){function u(e){const n=angular.element('\n            <textarea\n              class="no-validate"\n              name="caption"\n              msd-elastic\n              autofocus\n              ng-model="post.caption"\n              ng-model-options="{ allowInvalid: true }"\n              ng-trim="false"\n              placeholder="Whats new?"\n              spellcheck="true"\n              aria-multiline="true"\n              aria-label="Whats new?"\n              search-suggestions\n              bl-choose-suggestion-callback="completeMention(suggestion)"\n              bl-history="false"\n              bl-suggestions="suggestions"\n              bl-template="https://www.bandlab.com/web-app/search/partials/_search-suggestions-97848614.html"\n              gramm_editor="false"\n              text-post-input>\n            </textarea>\n          ');return t(n)(e),n}import("./chunk-dd2e4e3a.js").then((function(d){let{mountPresetsSelector:p}=d;const m=p(c[0],{compileTextarea:u,scope:l,$analytics:e,$compile:t,$filter:n,$injector:o,$rootScope:r,$state:i,Me:s,$stateParams:a});l.$on("$destroy",(function(){m.unmount()}))}))}}}]),angular.module("bandlab.audio").directive("audioInputPresetSettings",["$analytics","$rootScope","EditorHistory","EditorRevision","Katnip","MidiMapping",function(e,t,n,o,r,i){return{replace:!0,restrict:"E",scope:{preset:"="},templateUrl:"https://www.bandlab.com/web-app/audio/partials/_audio-input-preset-settings-fc0dd951.html",controller:["$scope",function(a){function s(e,n){t.$broadcast(hT,{effects:e,preset:n})}a.katnipEffects=r.metadata,a.effectsUI=r.effectsJson.effectsUI,a.$on("$pedal:selected",(function(e,t){a.lastSelectedEffectSlug=t})),a.$watch((()=>o.selectedTrack),(function(){a.lastSelectedEffectSlug=null})),a.toggleEffectBypass=function(e){a.stopPushUndo(),e.bypass=!e.bypass,t.$broadcast(mT,{effectOrder:a.preset.effects.indexOf(e),effectSlug:e.slug,paramSlug:"bypass",value:e.bypass}),a.resumePushUndo()},a.addEffect=function(t,n){const o=gI(t),r=n??a.preset.effects.length,i=a.preset.effects.slice(0,r),l=a.preset.effects.slice(r),c=i.concat(o,l);s(c,null),e.eventTrack("Add Effect",{category:"Mix Editor",label:t.slug,value:c.length})},a.removeEffect=function(e){s(_.filter(a.preset.effects,(t=>t!==e)),null),i.pruneMappings(),i.updateMappings()},a.stopPushUndo=function(){n.pushUndo(o.current),n.startToIgnorePushUndo()},a.resumePushUndo=function(){n.stopToIgnorePushUndo()},a.updateParams=function(e){t.$broadcast(mT,{effectOrder:a.preset.effects.indexOf(e.effect),effectSlug:e.effect.slug,paramSlug:e.property,value:e.effect.params[e.property]})}}]}}]),angular.module("bandlab.audio").directive("audioInputSharedReverb",["$injector",function(e){return{restrict:"E",replace:!0,template:"<div></div>",link:function(t,n){import("./chunk-28b0e1bb.js").then((function(o){let{mountSharedReverb:r}=o;const i=r(n[0],{$injector:e,scope:t});t.$on("$destroy",(function(){i.unmount()}))}))}}}]),angular.module("bandlab.audio").directive("autoPitch",["$injector",function(e){return{replace:!0,restrict:"E",template:'<div class="auto-pitch-container"></div>',link:async function(t,n){import("./chunk-1a1851f7.js").then((function(o){let{mountAutoPitch:r}=o;const i=r(n[0],{$injector:e,scope:t});t.$on("$destroy",(function(){i.unmount()}))})),Promise.resolve().then((()=>rb)).then((async function(e){let{logMeAutoPitchOpen:t}=e;t()}))}}}]),angular.module("bandlab.audio").directive("creatorsKit",["MidiKeyboardHandler",function(e){return{replace:!0,restrict:"E",templateUrl:"https://www.bandlab.com/web-app/audio/partials/_creators-kit-1a7a48ae.html",compile:function(t){const n=angular.element(t[0].querySelector(".creators-kit")),o=d_.map((function(e){return`\n            <div class="creators-kit-pad"\n                data-midi-code="${e.midi}"\n                ng-class="{ active: isActive(${e.midi}), 'not-mapped': !isMapped(${e.midi}) }">\n              <span class="sampler-pad-shortcut">${e.shortcut}</span>\n              <mix-editor-mappable data-mappable-target="INSTRUMENT" data-mappable-note-number="${e.midi}"></mix-editor-mappable>\n            </div>\n          `})).join("");return n.append(o),{post:function(){e.changeKeymap("creators-kit")}}},controller:"VirtualInstrumentCtrl"}}]),angular.module("bandlab.audio").directive("demoMasteringPreview",["Player",function(e){return{restrict:"A",replace:!0,template:"<div></div>",link:function(t,n){import("./chunk-157f624e.js").then((function(o){let{mountMasteringPreview:r}=o;const i=r(n[0],{scope:t,Player:e});t.$on("$destroy",(function(){i.unmount()}))}))}}}]);const mR={},fR={},hR={},gR={add:function(e,t){mR[e]=mR[e]||[],-1===mR[e].indexOf(t)&&mR[e].push(t)},remove:function(e,t){mR[e]=mR[e]||[];var n=mR[e].indexOf(t);-1!==n&&mR[e].splice(n,1)},reset:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];for(var t=0;t<e.length;t++)mR[e[t]]=[]},start:function(e,t,n,o){let r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(fR[e]&&!o)return;const i=1e3/22;var a=mR[e]||[];function s(o){for(var r=0;r<a.length;r++)a[r](n,o);fR[e]=!1,t&&hR[e]&&(hR[e]=requestAnimationFrame(s))}fR[e]=!0,r?hR[e]="playing"===e||"monitoring"===e?requestAnimationFrame((function o(){for(var r=0;r<a.length;r++)a[r](n);fR[e]=!1,t&&hR[e]&&(hR[e]=setTimeout(o,i))})):requestAnimationFrame(s):s()},stop:function(e){cancelAnimationFrame(hR[e]),clearTimeout(hR[e]),hR[e]=null,fR[e]=null}};angular.module("bandlab.audio").directive("drumMachine",["$document","DrumMachine","DrumMachineState","EditorState","Soundbank",function(e,t,n,o,r){return{replace:!0,restrict:"E",templateUrl:"https://www.bandlab.com/web-app/audio/partials/_drum-machine-1b7f8da4.html",link:function(i,a){i.isPressed={};const s=a[0].querySelector("#drum-machine-ruler");function l(e){const s=r.getPropertyValue(i.getTrack().soundbank,"instrumentSlug");var l=__(s),c=k_(s),u=l[e.code];if(o.isAudioInputActive&&!o.isInBackground&&"INPUT"!==e.target.nodeName){if("Space"===e.code)return e.preventDefault(),n.isLive=!1,void t.toggle();if(e.shiftKey&&"KeyL"===e.code)return n.isLive=!n.isLive,n.isLive&&n.velocityMode&&t.setVelocityMode(!1),t.isActive()||t.toggle(),void i.$digest();if("SELECT"===e.target.nodeName&&e.preventDefault(),u&&_.find(t.getCurrentKit(),{midi:u})){if(t.previewNote(c[u]),i.isPressed[c[u].slug]=!0,n.isLive){const e=n.selectedPattern.notes.indexOf(u);t.set(e,a[0].getAttribute("drum-machine-beat"),1)}i.$digest()}}}function c(e){const t=r.getPropertyValue(i.getTrack().soundbank,"instrumentSlug");var n=__(t),o=k_(t),a=n[e.code];a&&(i.isPressed[o[a].slug]=!1,i.$digest())}i.$watch("drumMachineState.patternLengthInBars",(function(){let e="";for(let t=0;t<4*n.patternLengthInBars;t++){const n=t%4+1;e+=`<span ${1===n?'class="bar"':""}>${Math.floor(t/4)+1}.${n}</span>`}s.innerHTML=e})),e.on("keydown",l),e.on("keyup",c),i.getDrumShortcut=function(e){const t=k_(r.getPropertyValue(i.getTrack().soundbank,"instrumentSlug"))[e.midi];return t?t.shortcut:""},i.isRowMapped=function(e){if(!n.selectedPattern.notes)return!1;const t=n.selectedPattern.notes[e],o=$_()[t];return i.getDrumShortcut(o)},a[0].setAttribute("drum-machine-note-value",4),i.$on("DrumMachine:beat",(function(e,t){a[0].setAttribute("drum-machine-beat",t)})),i.$on("$destroy",(function(){e.off("keydown",l),e.off("keyup",c)}))},controller:"DrumMachineCtrl"}}]).controller("DrumMachineCtrl",["$rootScope","$scope","DrumMachine","DrumMachineState","EditorHistory","EditorRevision","EditorState","MetronomeState",function(e,t,n,o,r,i,a,s){var l=!1;function c(){var r,l=_.find(i.selectedTrack.regions,(function(e){return a.crTime>e.startPosition&&a.crTime<e.endPosition})),c=l&&_.find(i.selectedTrack.patterns,{sampleId:l.sampleId}),u=$s({bpm:s.settings.bpm,signature:{notesCount:4,noteValue:4}});l&&a.isPlaying?(r=(a.crTime-l.startPosition)%(l.loopLength||u*o.patternLengthInBars)+l.sampleOffset,r=Math.floor(r/u*16),e.$broadcast("DrumMachine:beat",r)):e.$broadcast("DrumMachine:beat",-1),c&&c!==o.selectedPattern&&(n.selectPattern(c),t.$applyAsync())}t.drumMachineState=o,t.getCurrentKit=n.getCurrentKit,t.isActive=n.isActive,t.state=a,t.swapDrum=n.swapDrum,t.availableKit={},t.supportedNotes={},t.previewNote=function(e){n.isActive()||n.previewNote(e)},t.isKitMenuOpen=function(e){return parseInt(a$.element?.[0].getAttribute("index"))===e},t.getAvailableKit=function(e){t.isKitMenuOpen(e)||Promise.all([n.getAvailableKit(e),n.getSupportedNotes()]).then((function(n){let[o,r]=n;t.availableKit[e]=o,t.supportedNotes[e]=r.map((e=>({available:o.find((t=>t.midi===e.midi)),...e})))}))},t.clearPattern=function(){r.pushUndo(i.current),n.clearPattern()},t.copyMatrixValues=function(){n.copyPattern()},t.hasMatrixValuesInClipboard=function(){return zS.value&&zS.value.pattern},t.pasteMatrixValues=function(){r.pushUndo(i.current),n.pastePattern()},t.toggleNote=function(e,t,o){l=o,n.set(e,t,o)},t.setNote=function(e,t){n.set(e,t,l)},t.$on(xT,(()=>{o.isLive=!1,n.stop()})),t.$on(AT,(()=>{e.$broadcast("DrumMachine:beat",-1)})),t.$on("$destroy",(function(){gR.remove("playing",c),n.stop()})),gR.add("playing",c)}]).directive("drumMachineNote",["EditorHistory","EditorRevision",function(e,t){return{restrict:"A",link:function(n,o){o.on("mousedown",(function(o){if(a$.element||3===o.which)return;e.pushUndo(t.current);const r=n.velocity>0?0:1;n.toggleNote(n.rowIndex,n.$index,r)})),o.on("mouseenter",(function(e){e.buttons<1||1!==e.which||n.setNote(n.rowIndex,n.$index)}))}}}]),angular.module("bandlab.audio").directive("knob",(function(){return{restrict:"E",replace:!0,scope:{automation:"=",bypass:"=",disabled:"=",trackId:"=",effectId:"=",effectIndex:"=",metadata:"=",onChange:"&",onChangeEnd:"&",onChangeStart:"&",onChangeSelect:"&",params:"=",preset:"=",property:"@",selectMetadata:"=",selectProperty:"@"},templateUrl:"https://www.bandlab.com/web-app/audio/partials/_knob-d409ed13.html",compile:function(e,t){return t.automation=t.automation||`effect.automation['${t.property}']`,t.bypass=t.bypass||"effect.bypass",t.effectId="effect.id",t.effectIndex=t.effectIndex||"$index",t.effectSlug=t.effectIndex||"effect.slug",t.onChange=t.onChange||`updateParams({ effect: effect, property: '${t.property}' })`,t.onChangeSelect=t.onChangeSelect||`updateParams({ effect: effect, property: '${t.selectProperty}' })`,t.onChangeStart=t.onChangeStart||"stopPushUndo()",t.onChangeEnd=t.onChangeEnd||"resumePushUndo()",t.preset=t.trackId||"preset",function(e,t,n){e.knobLarge=n.knobLarge,e.knobXLarge=n.knobXLarge,e.knobOrigin=n.knobOrigin,e.knobSignedTicks=n.knobSignedTicks,e.knobPointer=n.knobPointer,e.knobTicks=n.knobTicks}}}})).directive("knobLabel",(function(){return{restrict:"E",replace:!0,scope:{metadata:"="},template:""}})).directive("pedalKnob",["$injector",function(e){return{replace:!0,restrict:"E",template:"<div></div>",link:async function(t,n){import("./chunk-e3610d98.js").then((function(o){let{mount:r}=o;const i=r(n[0],{$injector:e,scope:t});t.$on("$destroy",(function(){i.unmount()}))}))}}}]),angular.module("bandlab.audio").directive("latencyTest",["$interval","InputDevice",function(e,t){return{replace:!0,restrict:"E",templateUrl:"https://www.bandlab.com/web-app/audio/partials/_latency-test-b8441e70.html",link:async function(n,o){const{getFullTestDuration:r,startTest:i,resetTest:a}=await import("./chunk-207e4165.js"),s=o[0].querySelectorAll("rect"),l=s[0].style.getPropertyValue("fill"),c=s.length;function u(e){var t=0===e?angular.element(document.querySelector(".latency-test-animation .icon-volume-on")):angular.element(document.querySelector(".latency-test-animation .icon-micro"));t.toggleClass("active"),setTimeout((function(){t.toggleClass("active")}),100)}function d(e){s.forEach((function(t,n){t.style.fill=n<=e?"#dc3710":l}))}d(-1),n.status="",n.state="default",n.startTest=function(){var o,s=0,l=r();n.state="default",n.isLatencyTestRunning=!0,o=e((function(){d(s++),s===c&&e.cancel(o)}),l/c),i(u,t).then((function(e){n.status=e,n.state="success",ql.recordingLatency=e/1e3})).catch((function(e){n.status=e,n.state="fail"})).finally((function(){n.isLatencyTestRunning=!1,a(),n.$applyAsync()}))},n.$on("$destroy",(function(){a()}))}}}]),angular.module("bandlab.audio").component("masteringPreviewModal",{bindings:{props:"="},restrict:"E",templateUrl:"https://www.bandlab.com/web-app/audio/partials/_mastering-preview-59a6acf6.html",controller:["$injector","$scope","$element","Player",function(e,t,n,o){const r=this;r.$onInit=function(){o.pause(),import("./chunk-4ff34e27.js").then((function(o){let{mountMasteringModal:i}=o;const a=i(n[0].querySelector("#vue"),{$injector:e,$scope:t},r.props);t.$on("$destroy",(function(){a.unmount()}))}))}}]}),angular.module("bandlab.audio").directive("midiCode",(function(){return{restrict:"A",link:function(e,t,n){const o="mouseup mouseout touchend touchleave touchcancel";t.on("mousedown mouseenter touchstart",(function(r){if("true"!==t[0].getAttribute("draggable")&&r.preventDefault(),"touchstart"!==r.type&&(r.buttons<1||1!==r.which))return;const i=parseInt(n.midiCode);e.press(i),t.on(o,(function n(r){r.preventDefault(),e.release(i),t.off(o,n)}))}))}}})),angular.module("bandlab.audio").directive("draggablePedal",["$rootScope","MidiMapping",function(e,t){var n=[];return{restrict:"A",link:function(o,r){function i(e){e.preventDefault()}r[0].draggable=!0,r.on("dragstart",(function(e){e.stopPropagation(),n=[o.effect],pI.value=o.effect,r[0].parentElement.addEventListener("dragover",i)})),r.on("dragend",(function(t){n=[],pI.value={},document.elementFromPoint(t.x,t.y).closest(".mix-editor-track-header")||e.$broadcast(hT,{effects:o.preset.effects}),o.$applyAsync(),r[0].parentElement.removeEventListener("dragover",i)})),r.on("dragenter",(function(e){if(!n.includes(o.effect)&&0!==n.length){var r=o.preset.effects.indexOf(n[0]),i=o.preset.effects.indexOf(o.effect);(r<i&&e.offsetX>this.clientWidth/2||r>i&&e.offsetX<this.clientWidth/2)&&(o.preset.effects.splice(r,n.length),o.preset.effects.splice(i,0,...n),t.pruneMappings(),t.updateMappings(),o.$applyAsync())}})),o.$on("$pedal:dragging",(function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(n.length>0)return;n=gI(pI.value),o.preset.effects.splice(r,0,...n),e.$broadcast(hT,{effects:o.preset.effects}),o.$applyAsync();const i=Lr(pI,(()=>{pI.value.slug||(n=[],i(),o.$applyAsync())}))})),o.$on("$pedal:dragleave",(function(){const t=o.preset.effects.indexOf(n[0]);t<0||(o.preset.effects.splice(t,n.length),e.$broadcast(hT,{effects:o.preset.effects}),n=[])})),o.$on("$destroy",(function(){n=[]})),o.isDragged=function(){return n.includes(o.effect)}}}}]).directive("pedalHeader",(function(){return{replace:!0,scope:{effect:"=",effectId:"=",effectIndex:"=",effectsUI:"=",trackId:"=",preset:"=",toggleEffectBypass:"&",removeEffect:"&",showClose:"=",showBypass:"="},templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-header-23c967b8.html",compile:function(e,t){t.effect="effect",t.effectId="effect.id",t.effectIndex="$index",t.effectsUI="effectsUI",t.preset=t.trackId||"preset",t.removeEffect="removeEffect(effect)",t.toggleEffectBypass="toggleEffectBypass(effect)",t.showClose=t.showClose||"true",t.showBypass=t.showBypass||"true"}}})).directive("pedalBypass",["$injector",function(e){return{replace:!0,restrict:"E",template:'<div class="pedal-bypass"></div>',link:async function(t,n,o){import("./chunk-8c3cc2a8.js").then((function(r){let{mount:i}=r;const a=i(n[0],{$injector:e,scope:t,pedalTitle:o.pedalTitle});t.$on("$destroy",(function(){a.unmount()}))}))}}}]).directive("pedalAutoFilter",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-auto-filter-645bcdc4.html"}})).directive("pedalAutoPan",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-auto-pan-5d6212aa.html"}})).directive("pedalAutoWah",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-auto-wah-e419099e.html"}})).directive("pedalBackCompr",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-back-compr-6a47b95c.html"}})).directive("pedalBeatSyncDelay2",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-beat-sync-delay2-8c49fc3b.html"}})).directive("pedalVisualBeatSyncDelay",["$injector",function(e){return{replace:!0,template:"<div></div>",scope:{automation:"=",params:"="},link:function(t,n){import("./chunk-e529732b.js").then((function(o){let{mountPedalVisualBeatSyncDelay:r}=o;const i=r(n[0],{$injector:e,scope:t});t.$on("$destroy",(function(){i.unmount()}))}))}}}]).directive("pedalBossCe5",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-boss-ce5-fa4e46db.html"}})).directive("pedalCabinet",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-cabinet-870ce6a7.html"}})).directive("pedalChorus",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-chorus-57944d3d.html"}})).directive("pedalCompander",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-compander-f6408b0b.html"}})).directive("pedalVisualChorus",["$injector",function(e){return{replace:!0,template:"<div></div>",scope:{automation:"=",params:"="},link:function(t,n){import("./chunk-e529732b.js").then((function(o){let{mountPedalVisualChorus:r}=o;const i=r(n[0],{$injector:e,scope:t});t.$on("$destroy",(function(){i.unmount()}))}))}}}]).directive("pedalCompressor",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-compressor-51c9dbe6.html"}})).directive("pedalDdelay",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-ddelay-9610922f.html"}})).directive("pedalDdelayPlus",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-ddelay-plus-c211ada2.html"}})).directive("pedalVisualDdelayPlus",["$injector",function(e){return{replace:!0,template:"<div></div>",scope:{automation:"=",params:"="},link:function(t,n){import("./chunk-e529732b.js").then((function(o){let{mountPedalVisualDdelayPlus:r}=o;const i=r(n[0],{$injector:e,scope:t});t.$on("$destroy",(function(){i.unmount()}))}))}}}]).directive("pedalReverser",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-reverser-287a688f.html"}})).directive("pedalDelay",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-delay-ae6d187d.html"}})).directive("pedalEqualizer",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-equalizer-8e7ad30d.html"}})).directive("pedalExciter",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-exciter-5240ec9a.html"}})).directive("pedalExpGate",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-exp-gate-1f13a268.html"}})).directive("pedalVisualExpGate",["$injector",function(e){return{replace:!0,template:"<div></div>",scope:{automation:"=",params:"="},link:function(t,n){import("./chunk-e529732b.js").then((function(o){let{mountPedalVisualExpGate:r}=o;const i=r(n[0],{$injector:e,scope:t});t.$on("$destroy",(function(){i.unmount()}))}))}}}]).directive("pedalFilter",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-filter-c269989c.html"}})).directive("pedalGain",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-gain-42c99735.html"}})).directive("pedalGenericAmp",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-generic-amp-02363e38.html"}})).directive("pedalGuitarAmp",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-guitar-amp-48479ba0.html"}})).directive("pedalGuitarCab",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-guitar-cab-f59a9dee.html"}})).directive("pedalOctaver",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-octaver-d955337c.html"}})).directive("pedalOverdrive",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-overdrive-8c43f3b5.html"}})).directive("pedalVisualOverdrive",["$injector",function(e){return{replace:!0,template:"<div></div>",scope:{automation:"=",params:"="},link:function(t,n){import("./chunk-e529732b.js").then((function(o){let{mountPedalVisualOverdrive:r}=o;const i=r(n[0],{$injector:e,scope:t});t.$on("$destroy",(function(){i.unmount()}))}))}}}]).directive("pedalBossGe7",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-boss-ge7-9cc91e6a.html"}})).directive("pedalRossCompressor",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-ross-compressor-4cd6dc96.html"}})).directive("pedalLa2aCompressor",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-la2a-compressor-3acfe807.html"}})).directive("pedalCompressor1176",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-compressor-1176-31330726.html"}})).directive("pedalMxrPhase90",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-mxr-phase-90-bad35e3b.html"}})).directive("pedalDimensionD",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-dimension-d-68542d13.html"}})).directive("pedalEhSmallStone",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-eh-small-stone-48df60cb.html"}})).directive("pedalBossVb2",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-boss-vb2-c760dbf5.html"}})).directive("pedalBigMuffPi",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-big-muff-pi-5279d93d.html"}})).directive("pedalBossMt2",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-boss-mt2-d804d602.html"}})).directive("pedalProCoRat",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-pro-co-rat-3aca7b72.html"}})).directive("pedalMxrDistortion",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-mxr-distortion-f907d1a6.html"}})).directive("pedalFuzzFace",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-fuzz-face-f38dad55.html"}})).directive("pedalBossBd2",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-boss-bd2-023e3bc5.html"}})).directive("pedalTubeScreamer2",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-tube-screamer2-ec22066d.html"}})).directive("pedalPhaser",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-phaser-4158119f.html"}})).directive("pedalPingpongDelay",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-pingpong-delay-346698a9.html"}})).directive("pedalVisualPingpongDelay",["$injector",function(e){return{replace:!0,template:"<div></div>",scope:{automation:"=",params:"="},link:function(t,n){import("./chunk-e529732b.js").then((function(o){let{mountPedalVisualPingpongDelay:r}=o;const i=r(n[0],{$injector:e,scope:t});t.$on("$destroy",(function(){i.unmount()}))}))}}}]).directive("pedalPumper",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-pumper-8747b141.html"}})).directive("pedalReverbHybrid",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-reverb-hybrid-1633c087.html"}})).directive("pedalDeEsser",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-de-esser-be8471a0.html"}})).directive("pedalVisualDeEsser",["$injector",function(e){return{replace:!0,template:"<div></div>",scope:{automation:"=",params:"="},link:function(t,n){import("./chunk-e529732b.js").then((function(o){let{mountPedalVisualDeEsser:r}=o;const i=r(n[0],{$injector:e,scope:t});t.$on("$destroy",(function(){i.unmount()}))}))}}}]).directive("pedalSpringReverb2",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-spring-reverb2-c0c1b597.html"}})).directive("pedalVisualSpringReverb2",["$injector",function(e){return{replace:!0,template:"<div></div>",scope:{automation:"=",params:"="},link:function(t,n){import("./chunk-e529732b.js").then((function(o){let{mountPedalVisualSpringReverb2:r}=o;const i=r(n[0],{$injector:e,scope:t});t.$on("$destroy",(function(){i.unmount()}))}))}}}]).directive("pedalSimpleStudioReverb",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-simple-studio-reverb-3b56b823.html"}})).directive("pedalVisualSimpleStudioReverb",["$injector",function(e){return{replace:!0,template:"<div></div>",scope:{automation:"=",params:"="},link:function(t,n){import("./chunk-e529732b.js").then((function(o){let{mountPedalVisualSimpleStudioReverb:r}=o;const i=r(n[0],{$injector:e,scope:t});t.$on("$destroy",(function(){i.unmount()}))}))}}}]).directive("pedalTapeSimulator",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-tape-simulator-b3a1a55e.html"}})).directive("pedalTubeScreamer",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-tube-screamer-05457679.html"}})).directive("pedalVocalDoubler",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-vocal-doubler-f7ddb1a6.html"}})).directive("pedalAntiSqueal",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-anti-squeal-ffe02dbf.html"}})).directive("pedalTremolo",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-tremolo-541ccd5b.html"}})).directive("pedalVisualTremolo",["$injector",function(e){return{replace:!0,template:"<div></div>",scope:{automation:"=",params:"="},link:function(t,n){import("./chunk-e529732b.js").then((function(o){let{mountPedalVisualTremolo:r}=o;const i=r(n[0],{$injector:e,scope:t});t.$on("$destroy",(function(){i.unmount()}))}))}}}]).directive("pedalStereoSpreader",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-stereo-spreader-74f3752f.html"}})).directive("pedalLofi",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-lofi-e2ab9ac3.html"}})).directive("pedalVisualLofi",["$injector",function(e){return{replace:!0,template:"<div></div>",scope:{automation:"=",bypass:"=",params:"="},link:function(t,n){import("./chunk-e529732b.js").then((function(o){let{mountPedalVisualLofi:r}=o;const i=r(n[0],{$injector:e,scope:t});t.$on("$destroy",(function(){i.unmount()}))}))}}}]).directive("pedalThreeBandEq2",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-three-band-eq2-052a1f3e.html"}})).directive("pedalUniverb",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-univerb-06d2c806.html"}})).directive("pedalMasteringLimiter",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-mastering-limiter-1ba1d4a7.html"}})).directive("pedalMultiShifter",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-multi-shifter-0eb725d2.html"}})).directive("pedalPitchShifter",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-pitch-shifter-cad89410.html"}})).directive("pedalEnhancer",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-enhancer-ebc1916e.html"}})).directive("pedalVisualEq",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-visual-eq-8dbbc9f9.html"}})).directive("pedalVisualEqControls",["$injector",function(e){return{replace:!0,template:"<div></div>",link:function(t,n){import("./chunk-e8641223.js").then((function(o){let{mountPedalVisualEqControls:r}=o;const i=r(n[0],{$injector:e,scope:t});t.$on("$destroy",(function(){i.unmount()}))}))}}}]).directive("pedalDefault",["$compile",function(e){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_pedal-default-fff57d4b.html",link:async function(t,n){const o=t.katnipEffects[t.effect.slug],r=t.effectsUI.effects[t.effect.slug].paramList.map((function(e){return[e,o.params[e]]})).map((function(e){let[n,o]=e;return"bool"===o.type?`<pedal-toggle-boolean metadata="katnipEffects.${t.effect.slug}.params.${r=n}" params="effect.params" property="${r}"></pedal-toggle-boolean>`:"enum"===o.type?function(e,t){return`<slide-switch metadata="katnipEffects.${e}.params.${t}" params="effect.params" property="${t}"></slide-switch>`}(t.effect.slug,n):"float"===o.type?function(e,t){return`<knob metadata="katnipEffects.${e}.params.${t}" params="effect.params" property="${t}"></knob>`}(t.effect.slug,n):void 0;var r})),i=e(r.join(""))(t);angular.element(n[0].querySelector(".pedal-settings")).append(i)}}}]),angular.module("bandlab.audio").directive("presetAttachment",["$injector","$rootScope","$state","Me",function(e,t,n,o){return{restrict:"E",replace:!0,scope:{post:"="},template:"<div></div>",link:function(r,i){import("./chunk-bdb289cf.js").then((function(a){let{mount:s}=a;const l=s(i[0],{$injector:e,$rootScope:t,$state:n,Me:o},{post:r.post});r.$on("$destroy",(function(){l.unmount()}))}))}}}]).directive("presetAddForm",["$injector","$rootScope","$state",function(e,t,n){return{restrict:"E",replace:!0,template:"<div></div>",scope:{preset:"<"},link:function(o,r){import("./chunk-8c083ca9.js").then((function(i){let{mount:a}=i;const s=a(r[0],{$injector:e,$rootScope:t,$state:n},{preset:o.preset});o.$on("$destroy",(function(){s.unmount()}))}))}}}]),angular.module("bandlab.audio").directive("projectDropzone",["$state","$timeout","appActions","RevisionImporter",function(e,t,n,o){return{replace:!0,restrict:"E",templateUrl:"https://www.bandlab.com/web-app/audio/partials/_project-dropzone-0a06c096.html",link:function(r,i){function a(r){if(r&&n.checkAllowed("upload"))return o.createRevisionFromFile(r).then((n=>t((()=>e.go("track",{id:n.postId})),1e3)))}i.on("click",(function(){n.checkAllowed("upload")&&i[0].querySelector("input").click()})),i.on("drop",(function(e){e.preventDefault(),e.stopPropagation(),i.removeClass("dropping"),a(_.get(e,"dataTransfer.files[0]",!1)),_.get(e,"dataTransfer.files.length",0)>1&&o.displayMultipleFilesWarning()})),i.on("dragover",(function(e){e.preventDefault(),e.stopPropagation(),i.addClass("dropping")})),i.on("dragleave",(function(){i.removeClass("dropping")})),r.$watch("masterFile",(function(e){a(_.get(e,"[0]",!1))})),setTimeout((function(){i.addClass("animate")}))}}}]),angular.module("bandlab.audio").constant("QuickUpload",{state:{}}).directive("quickUploadDropzone",["$state","$stateParams","$timeout","appActions","AppNotifications","EditorLoader","RevisionImporter",function(e,t,n,o,r,i,a){return{replace:!0,restrict:"A",link:function(s,l){if(l.on("click",(function(){o.checkAllowed("upload")&&Fh({accept:Uh}).then((function(e){let[t]=e;c(t)}))})),l.on("drop",(function(e){e.preventDefault(),e.stopPropagation(),l.removeClass("dropping"),c(_.get(e,"dataTransfer.files[0]",!1))})),l.on("dragover",(function(e){e.preventDefault(),e.stopPropagation(),l.addClass("dropping")})),l.on("dragleave",(function(){l.removeClass("dropping")})),setTimeout((function(){l.addClass("animate")})),t.remote){const n=t.remote;e.go(".",{remote:null}),au.get(t.remote).blob().then((function(e){return e.name=n.split("/").pop(),e})).then(c)}function c(t){t&&o.checkAllowed("upload")&&Oh(t).then((function(e){return Promise.all([a.isAudioFileValid(e),a.getMetadataFromFile(e)])})).then((function(t){let[[o,r],{coverArt:i,title:a}={}]=t;s.state.audioFile=o,s.state.description="",s.state.duration=r,s.state.genres=[],s.state.imageFileFromMetadata=i,s.state.isForkable=!0,s.state.name=a||o.name,s.state.sampleId=ad(),n((function(){s.state.step=1,e.go("quickUpload2")}))})).catch((function(e){i.flushQueue(),r.addNotification({title:fh,content:e.message,classList:"alert",autoclose:8e3})}))}}}}]).directive("quickUploadCover",["AppNotifications",function(e){return{replace:!0,restrict:"E",templateUrl:"https://www.bandlab.com/web-app/audio/partials/_quick-upload-cover-78eaed48.html",link:function(t,n){function o(n){if(n)return Nh(n).then((function(e){return Mh(e)})).then((function(e){let{file:n,image:o}=e;t.state.imageFile=n,t.state.revisionCover=o.src,t.state.imageWidth=o.width,t.state.imageHeight=o.height})).catch((function(t){e.addNotification({title:fh,content:t.message,classList:"alert",autoclose:8e3})})).finally((function(){t.$applyAsync()}))}t.state.imageFile=null,t.state.revisionCover=null,t.state.imageWidth=null,t.state.imageHeight=null,t.state.pictureId=null,t.state.imageFileFromMetadata&&o(t.state.imageFileFromMetadata),n.on("click",(function(){Fh({accept:"image/*"}).then((function(e){let[t]=e;o(t)}))})),n.on("drop",(function(e){e.preventDefault(),e.stopPropagation(),n.removeClass("dropping"),o(_.get(e,"dataTransfer.files[0]",!1))})),n.on("dragover",(function(e){e.preventDefault(),e.stopPropagation(),n.addClass("dropping")})),n.on("dragleave",(function(){n.removeClass("dropping")})),setTimeout((function(){n.addClass("animate")}))}}}]),angular.module("bandlab.audio").directive("sampler",(function(){return{replace:!0,restrict:"E",templateUrl:"https://www.bandlab.com/web-app/audio/partials/_sampler-3324cf17.html",controller:["$injector","$scope","EditorHistory","EditorRevision","EditorState","MidiKeyboardHandler","SharedMidiSynth","Soundbank",function(e,t,n,o,r,i,a,s){r.isAudioInputActive&&i.enable(),i.changeKeymap("creators-kit"),s.setSampler(o.selectedTrack);const l=a.getSampler(),c=Lr([l.recordingPad],(function(){t.$applyAsync()})),u=Lr((()=>[...l.pads]),(function(){if(t.$applyAsync(),!l.multipadSampler)return;const n=l.track;return l.multipadSampler.getKit().then((function(t){t.kit=JSON.parse(t.kit),t.kit.layers=t.kit.layers||[],Object.assign(n.samplerKit,WC(t)),jC(e,0,n)}))}),{deep:!0});async function d(){t.isPlayingMap=await l.getIsPlayingMap(),t.$digest()}t.pads=d_,t.$on("MidiMessage:noteEvent",(function(e,n){n>=36&&n<52&&(l.pad=l.pads[n-36]),t.$digest()})),t.$on("$destroy",(function(){gR.remove("playing",d),i.disable(),l.stopRecording().then((function(){u(),c()}))})),t.$on("Sampler:deletePad",(function(){const e=l.pads.indexOf(l.pad);e>=0&&l.pads[e].id&&t.delete(e+36)})),t.press=function(e){i.press(e);const t=fC(s.getNoteWithOctave(e));l.pad=l.pads[t]||{}},t.release=function(e){i.release(e)},t.isPlayingMap=new Map,gR.add("playing",d),t.isActive=function(e){const n=s.getNoteWithOctave(e),o=fC(n);return!!a.current[n]||t.isPlayingMap.get(o)},t.isLoading=function(){return l.loading},t.isRecordingPad=function(e){const t=fC(s.getNoteWithOctave(e));return l.recordingPad===l.pads[t]},t.isSelected=function(e){const t=fC(s.getNoteWithOctave(e));return l.pads[t]===l.pad},t.isMapped=function(e){const t=fC(s.getNoteWithOctave(e));return l.pads[t]?.id},t.getColor=function(e){const t=fC(s.getNoteWithOctave(e));return mC[l.pads[t]?.color]},t.delete=function(e){n.pushUndo(o.current);const t=fC(s.getNoteWithOctave(e));return l.pads[t].remove()},t.paste=function(e){n.pushUndo(o.current);const t=fC(s.getNoteWithOctave(e));return l.pads[t].copy()},t.copy=function(e){const t=fC(s.getNoteWithOctave(e));return l.pads[t].copy()}}]}})).directive("samplerPad",["$injector","$q","$timeout","EditorHistory","EditorRevision","InputDevice","SharedMidiSynth","Soundbank",function(e,t,n,o,r,i,a,s){return{restrict:"C",link:function(l,c){const u=a.getSampler(),d=fC(s.getNoteWithOctave(l.pad.midi)),p=Lr((()=>u.pads[d]?.waveform),(function(){const e=c[0].querySelector("canvas");u.pads[d]?.waveform?(l.$applyAsync(),function(e,t){const n=e.getContext("2d");n&&(n.canvas.width=oC(55),n.canvas.height=oC(55),n.strokeStyle="#fff",t?(n.translate(.5,.5),n.stroke(t)):rC(n))}(e,u.pads[d].waveform)):rC(e.getContext("2d"))}),{immediate:!0});l.$on("$destroy",(function(){p()})),c[0].addEventListener("pointerdown",(function(e){if(u.pad=u.pads[d]||{},e.button>0||u.pad.id)return;const a=n((()=>{}),200);e.target.setPointerCapture(e.pointerId),e.target.style.touchAction="none",t.all([a]).then((function(){return u.startRecording(i.connect,d,r.selectedTrack)})).then((function(){o.pushUndo(r.current);const e=Lr((()=>u.pad),t);function t(){return e(),c[0].removeEventListener("pointerup",n),u.stopRecording()}function n(){return t().then((function(){u.pad=u.pads[d]}))}c[0].addEventListener("pointerup",n)})).catch((e=>{})),c[0].addEventListener("pointerup",(function(){n.cancel(a),e.target.style.touchAction=""}),{once:!0})})),c[0].addEventListener("mouseover",(function(){HS.value.trackId&&(c[0].classList.add("dropping"),c[0].classList.add("copying"))})),c[0].addEventListener("mouseleave",(function(){HS.value.trackId&&(c[0].classList.remove("dropping"),c[0].classList.remove("copying"))})),c[0].addEventListener("mouseup",(function(){if(!HS.value.trackId)return;const t=GS.get(HS.value);wC(e,u.pads[d],t,u),c[0].classList.remove("dropping"),c[0].classList.remove("copying")})),c[0].addEventListener("dragstart",(function(e){HS.altKey=e.altKey,HS.value=l.pad,l.release(l.pad.midi),HS.altKey||(e.dataTransfer.effectAllowed="move")})),c[0].addEventListener("dragenter",(function(e){e.preventDefault(),e.stopPropagation(),l.pad!==HS.value&&u.recordingPad!==u.pads[d]&&(c[0].classList.add("dropping"),c[0].classList.toggle("copying",HS.altKey||HS.value?.src))})),c[0].addEventListener("dragover",(function(e){e.preventDefault(),e.stopPropagation()})),c[0].addEventListener("dragleave",(function(e){e.preventDefault(),e.stopPropagation(),c[0].classList.remove("dropping"),c[0].classList.remove("copying")})),c[0].addEventListener("drop",(function(t){if(t.preventDefault(),t.stopPropagation(),l.pad===HS.value||u.recordingPad===u.pads[d])return;c[0].classList.remove("dropping"),c[0].classList.remove("copying");const n=[...t.dataTransfer.files];if(1===n.length){o.pushUndo(r.current);const t=fC(c[0].getAttribute("data-midi-code")),i=a.getSampler();return bC(e,i.pads[t],n[0],i)}if(n.length>1){o.pushUndo(r.current);const t=a.getSampler();n.reduce((function(n,o){return n.then((function(){const n=t.getEmptyPad();return n<0?Promise.resolve():bC(e,t.pads[n],o,t)}))}),Promise.resolve())}if(HS.value?.src)return o.pushUndo(r.current),gC(u.pads[d],HS.value,u,e);if(HS.value!==l.pad&&HS.value?.midi){o.pushUndo(r.current);const e=a.getSampler(),t=fC(HS.value.midi),n=fC(c[0].getAttribute("data-midi-code"));return HS.altKey?e.duplicatePad(t,n):e.pads[n].id?e.swapPads(t,n):e.movePad(t,n)}}))}}}]).directive("vueSampler",["$injector","EditorHistory","EditorRevision","InputDevice","SharedMidiSynth",function(e,t,n,o,r){return{restrict:"A",controller:["$compile","$scope","$element",function(i,a,s){const l=r.getSampler(),c=Lr((()=>l.pad),(function(){a.pad=[...d_].sort(((e,t)=>e.midi-t.midi))[l.pads.indexOf(l.pad)],a.$applyAsync()})),u=i('<div ng-controller="SamplerMenuCtrl"><a  ng-if="isSet(pad.midi)" class="mix-editor-simple-button" dropdown-menu="https://www.bandlab.com/web-app/audio/partials/_sampler-choke-menu-c1436c08.html">Group: <span>&nbsp;{{ getGroup(pad.midi) || "none" }}</span><a ng-if="isSet(pad.midi)" class="mix-editor-simple-button" dropdown-menu="https://www.bandlab.com/web-app/audio/partials/_sampler-color-menu-1b9887d8.html">Color:&nbsp;<span class="sampler-editor-button-color {{ getColor(pad.midi) }}"></span></a></div>')(a)[0],d=import("./chunk-ee39eb0c.js").then((function(i){let{mountSamplerEditor:l}=i;return l(s[0],{$injector:e,EditorHistory:t,EditorRevision:n,InputDevice:o,menus:u,scope:a,SharedMidiSynth:r})}));a.$on("$destroy",(async function(){(await d).unmount(),c()}))}]}}]).controller("SamplerMenuCtrl",["$injector","$scope","EditorHistory","EditorRevision","SharedMidiSynth","Soundbank",function(e,t,n,o,r,i){const a=r.getSampler();t.canPaste=function(){return angular.isDefined(a.clipboard)&&!t.isRecording()},t.import=function(t){const n=fC(i.getNoteWithOctave(t));vC(e,a.pads[n],a)},t.isRecording=function(){return a.recordingPad?.midi},t.isSet=function(e){const t=fC(i.getNoteWithOctave(e));return a.pads[t]?.id},t.getColor=function(e){const t=fC(i.getNoteWithOctave(e));return mC[a.pads[t]?.color]},t.setColor=function(e,t){const n=fC(i.getNoteWithOctave(e));a.pads[n].color=t,zC("me_sampler_sample_editor_actions",{action:"color"})},t.getGroup=function(e){const t=fC(i.getNoteWithOctave(e));return a.pads[t].mutexGroup},t.setGroup=function(e,t){const n=fC(i.getNoteWithOctave(e));a.pads[n].mutexGroup=t,zC("me_sampler_sample_editor_actions",{action:"group"})},t.normalize=function(e){n.pushUndo(o.current);const t=fC(i.getNoteWithOctave(e));a.pads[t].normalize()},t.crop=function(e){n.pushUndo(o.current);const t=fC(i.getNoteWithOctave(e));a.pads[t].crop()},t.reverse=function(e){n.pushUndo(o.current);const t=fC(i.getNoteWithOctave(e));a.pads[t].reverse()},t.delete=function(e){n.pushUndo(o.current);const t=fC(i.getNoteWithOctave(e));a.pads[t].remove()},t.paste=function(e){n.pushUndo(o.current);const t=fC(i.getNoteWithOctave(e));a.pads[t].paste()},t.copy=function(e){const t=fC(i.getNoteWithOctave(e));a.pads[t].copy()}}]),angular.module("bandlab.audio").directive("selectAudioDevice",["AppNotifications","InputDevice",function(e,t){return{restrict:"E",replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_select-audio-device-c08efafd.html",controller:["$scope",function(n){function o(o){t.switchTo(o).then((()=>{n.notifyInputChanged()})).catch((t=>{e.addNotification({title:`Cannot connect ${o&&o.name||"undefined device"}`,content:t.message,autoclose:5e3})}))}return n.selectedAudioDevice=t.getCurrent(),n.getAudioDevices=function(){return t.getAudioDevices().then((e=>(n.audioDevices=e,n.$applyAsync(),e)))},n.selectAudioDevice=o,n.$on(vT,(function(){n.getAudioDevices().then((e=>o(e[0])))})),n.getAudioDevices()}]}}]),angular.module("bandlab.audio").directive("selectDeviceChannel",(function(){return{restrict:"E",replace:!0,templateUrl:"https://www.bandlab.com/web-app/audio/partials/_select-device-channel-3bb4b7bc.html",controller:["$scope","EditorPlayer",function(e,t){e.selectDeviceChannel=function(n){const o=e.getTrack();o.channel=n,t.current.setTrackInputSelection(o)}}]}})),angular.module("bandlab.audio").directive("slider",(function(){return{restrict:"E",replace:!0,scope:{automation:"=",bypass:"=",disabled:"=",trackId:"=",effectId:"=",effectIndex:"=",metadata:"=",onChange:"&",onChangeEnd:"&",onChangeSelect:"&",onChangeStart:"&",params:"=",preset:"=",property:"@",selectMetadata:"=",selectProperty:"@"},templateUrl:"https://www.bandlab.com/web-app/audio/partials/_slider-04e40bf0.html",compile:function(e,t){return t.automation=t.automation||`effect.automation['${t.property}']`,t.bypass=t.bypass||"effect.bypass",t.effectId="effect.id",t.effectIndex=t.effectIndex||"$index",t.effectSlug=t.effectIndex||"effect.slug",t.onChange=t.onChange||`updateParams({ effect: effect, property: '${t.property}' })`,t.onChangeSelect=t.onChangeSelect||`updateParams({ effect: effect, property: '${t.selectProperty}' })`,t.onChangeStart=t.onChangeStart||"stopPushUndo()",t.onChangeEnd=t.onChangeEnd||"resumePushUndo()",t.preset=t.trackId||"preset",function(e,t,n){e.sliderInput=n.sliderInput,e.sliderOrigin=n.sliderOrigin,e.sliderPro=n.sliderPro}}}})).directive("pedalSlider",["$injector",function(e){return{replace:!0,restrict:"E",template:'<div class="slider"></div>',link:async function(t,n){import("./chunk-a564bc4d.js").then((function(o){let{mount:r}=o;const i=r(n[0],{$injector:e,scope:t});t.$on("$destroy",(function(){i.unmount()}))}))}}}]).directive("sliderButton",(function(){return{restrict:"E",replace:!0,scope:{automation:"=",bypass:"=",disabled:"=",trackId:"=",effectId:"=",effectIndex:"=",metadata:"=",onChange:"&",onChangeEnd:"&",onChangeStart:"&",params:"=",preset:"=",property:"@"},template:"<div><pedal-slider-button></pedal-slider-button></div>",compile:function(e,t){t.automation=t.automation||`effect.automation['${t.property}']`,t.bypass=t.bypass||"effect.bypass",t.effectId="effect.id",t.effectIndex=t.effectIndex||"$index",t.effectSlug=t.effectIndex||"effect.slug",t.onChange=t.onChange||`updateParams({ effect: effect, property: '${t.property}' })`,t.onChangeStart=t.onChangeStart||"stopPushUndo()",t.onChangeEnd=t.onChangeEnd||"resumePushUndo()",t.preset=t.trackId||"preset"}}})).directive("pedalSliderButton",["$injector",function(e){return{replace:!0,restrict:"E",template:"<div></div>",link:async function(t,n){import("./chunk-4f96dbe0.js").then((function(o){let{mount:r}=o;const i=r(n[0],{$injector:e,scope:t});t.$on("$destroy",(function(){i.unmount()}))}))}}}]),angular.module("bandlab.audio").directive("slideSwitch",(function(){return{restrict:"E",replace:!0,scope:{bypass:"=",disabled:"=",metadata:"=",onChange:"&",onChangeEnd:"&",onChangeStart:"&",params:"=",property:"@",toggle:"="},templateUrl:"https://www.bandlab.com/web-app/audio/partials/_slide-switch-718eab3b.html",compile:function(e,t){t.bypass=t.bypass||"effect.bypass",t.onChange=t.onChange||`updateParams({ effect: effect, property: '${t.property}' })`,t.onChangeStart=t.onChangeStart||"stopPushUndo()",t.onChangeEnd=t.onChangeEnd||"resumePushUndo()"}}})).directive("pedalSelect",["$injector",function(e){return{replace:!0,restrict:"E",template:"<div></div>",link:async function(t,n){import("./chunk-725af592.js").then((function(o){let{mount:r}=o;const i=r(n[0],{$injector:e,scope:t});t.$on("$destroy",(function(){i.unmount()}))}))}}}]).directive("pedalToggle",["$injector",function(e){return{replace:!0,restrict:"E",template:"<div></div>",link:async function(t,n){import("./chunk-7d485e33.js").then((function(o){let{mount:r}=o;const i=r(n[0],{$injector:e,scope:t});t.$on("$destroy",(function(){i.unmount()}))}))}}}]).directive("pedalToggleBoolean",["$injector",function(e){return{replace:!0,restrict:"E",scope:{bypass:"=",disabled:"=",metadata:"=",onChange:"&",onChangeEnd:"&",onChangeStart:"&",params:"=",property:"@",toggle:"="},template:"<div></div>",compile:function(t,n){return n.bypass=n.bypass||"effect.bypass",n.onChange=n.onChange||`updateParams({ effect: effect, property: '${n.property}' })`,n.onChangeStart=n.onChangeStart||"stopPushUndo()",n.onChangeEnd=n.onChangeEnd||"resumePushUndo()",async function(t,n){import("./chunk-0b9603de.js").then((function(o){let{mount:r}=o;const i=r(n[0],{$injector:e,scope:t});t.$on("$destroy",(function(){i.unmount()}))}))}}}}]),angular.module("bandlab.audio").component("songstarterModal",{bindings:{close:"&",state:"="},restrict:"E",template:'<div id="vue"></div>',controller:["$analytics","$element","$scope","$q","$rootScope","$state","AppNotifications","EditorHelper","Me","Player","RevisionImporter","SongStarter",function(e,t,n,o,r,i,a,s,l,c,u,d){const p=this;p.$onInit=function(){c.pause(),import("./chunk-924caaf7.js").then((function(c){let{mountSongStarterModal:m}=c;const f=m(t[0].querySelector("#vue"),{vm:p,$analytics:e,$q:o,$rootScope:r,AppNotifications:a,EditorHelper:s,Me:l,scope:n,SongStarter:d,state:i});n.$on("$destroy",(function(){f.unmount()})),n.createProject=function(e,t,n){u.createRevisionFromSongStarter(e,t,n)}}))}}]});class vR extends AudioWorkletNode{constructor(e){super(e,"audioengine-worklet-processor",{channelCount:2,channelCountMode:"clamped-max",outputChannelCount:[2]}),this.port.onmessage=e=>{}}_staticMethodWithReturn(e,t,n){return new Promise((o=>{const r=crypto.randomUUID(),i=e=>{e.data.id===r&&(this.port.removeEventListener("message",i),o(e.data.result),e.stopPropagation())};this.port.addEventListener("message",i),this.port.postMessage({className:e,method:t,args:n,id:r})}))}_staticMethodWithoutReturn(e,t,n){this.port.postMessage({className:e,method:t,args:n})}_commandWithReturn(e,t){return new Promise((n=>{const o=crypto.randomUUID(),r=e=>{e.data.id===o&&(this.port.removeEventListener("message",r),n(e.data.result),e.stopPropagation())};this.port.addEventListener("message",r),this.port.postMessage({command:e,args:t,id:o})}))}_commandWithoutReturn(e,t){this.port.postMessage({command:e,args:t})}destroy(){this._commandWithoutReturn("destroy",{})}FS={init:e=>this._commandWithReturn("FSinit",{workDirs:e}),loadResources:(e,t)=>this._commandWithReturn("FSloadResources",{metadata:e,data:t}),mkdir:e=>this._commandWithReturn("FSmkdir",{path:e}),rmdir:e=>this._commandWithReturn("FSrmdir",{path:e}),writeFile:(e,t)=>this._commandWithReturn("FSwriteFile",{filePath:e,buffer:t}),deleteFile:e=>this._commandWithReturn("FSdeleteFile",{filePath:e}),readFile:e=>this._commandWithReturn("FSreadFile",{filePath:e}),exists:e=>this._commandWithReturn("FSexists",{path:e})};AudioSource={connect:e=>{this._commandWithoutReturn("AudioSourceConnect",{addr:e._addr})},disconnect:e=>{this._commandWithoutReturn("AudioSourceDisconnect",{addr:e._addr})},disconnectAll:()=>{this._commandWithoutReturn("AudioSourceDisconnectAll",{})}};AudioSink={_addr:"audioSink",disconnectAll:()=>{this._commandWithoutReturn("AudioSinkDisconnectAll",{})}};ClockSource={_addr:"clockSource"};MIDISource={onEvent:(e,t)=>{this._commandWithoutReturn("MIDISourceOnEvent",{msg:e,offset:t||0})},onEventStream:(e,t)=>{this._commandWithoutReturn("MIDISourceOnEventStream",{msg:e,offset:t||0})},connect:e=>{this._commandWithoutReturn("MIDISourceConnect",{addr:e._addr})},disconnect:e=>{this._commandWithoutReturn("MIDISourceDisconnect",{addr:e._addr})},disconnectAll:()=>{this._commandWithoutReturn("MIDISourceDisconnectAll",{})}};ErrorReporting={setErrorListener:e=>{e&&e.init(this.port),this._staticMethodWithoutReturn("ErrorReporting","setErrorListener",{listener:e?e._addr:null,listener_id:e?e._id:null})},signalError:e=>this._staticMethodWithoutReturn("ErrorReporting","signalError",{msg:e}),signalAssert:e=>this._staticMethodWithoutReturn("ErrorReporting","signalAssert",{msg:e})};Resampler={create:async()=>{const e=await this._staticMethodWithReturn("Resampler","create",{});return e?new SR(e,this.port):null},resampleFile:(e,t,n,o)=>this._staticMethodWithReturn("Resampler","resampleFile",{srcWavPath:e,dstWavPath:t,dstSampleRate:n,quality:o})};WaveformGenerator={create:async()=>{const e=await this._staticMethodWithReturn("WaveformGenerator","create",{});return e?new _R(e,this.port):null}};TestWavGenerator={generateSineWave:(e,t,n,o)=>this._staticMethodWithReturn("TestWavGenerator","generateSineWave",{path:e,sr:t,lenSec:n,chans:o})};DebugErrors={triggerAssert:()=>this._staticMethodWithoutReturn("DebugErrors","triggerAssert",{}),triggerWeakAssert:()=>this._staticMethodWithoutReturn("DebugErrors","triggerWeakAssert",{}),triggerFatalAssert:()=>this._staticMethodWithoutReturn("DebugErrors","triggerFatalAssert",{}),triggerSegfault:()=>this._staticMethodWithoutReturn("DebugErrors","triggerSegfault",{}),triggerNativeException:()=>this._staticMethodWithoutReturn("DebugErrors","triggerNativeException",{}),triggerMemoryCorruption:()=>this._staticMethodWithoutReturn("DebugErrors","triggerMemoryCorruption",{}),checkExceptionHandling:e=>this._staticMethodWithReturn("DebugErrors","checkExceptionHandling",{inside:e})};AudioStretchEngine={create:async()=>{const e=await this._staticMethodWithReturn("AudioStretchEngine","create",{});return e?new PR(e,this.port):null},getAudioModeName:e=>this._staticMethodWithReturn("AudioStretchEngine","getAudioModeName",{mode:e}),timeToString:(e,t)=>this._staticMethodWithReturn("AudioStretchEngine","timeToString",{secs:e,precision:t})};MixdownCreator={renderMixToWav:(e,t,n,o,r,i,a,s,l,c)=>(s&&s.init(this.port),this._staticMethodWithReturn("MixdownCreator","renderMixToWav",{mixData:e,workDirs:t,metadataManager:n?n._addr:null,wavPath:o,sampleRate:r,bitsPerSample:i,maxSongLengthSecs:a,listener:s?s._addr:null,listener_id:s?s._id:null,allowNormDown:l,allowNormUp:c})),renderTrackToWav:(e,t,n,o,r,i,a,s,l,c,u)=>(l&&l.init(this.port),this._staticMethodWithReturn("MixdownCreator","renderTrackToWav",{mixData:e,trackId:t,workDirs:n,metadataManager:o?o._addr:null,wavPath:r,sampleRate:i,bitsPerSample:a,maxSongLengthSecs:s,listener:l?l._addr:null,listener_id:l?l._id:null,allowNormDown:c,allowNormUp:u})),renderTrackStemToWav:(e,t,n,o,r,i,a,s,l,c,u,d,p,m,f)=>(l&&l.init(this.port),this._staticMethodWithReturn("MixdownCreator","renderTrackStemToWav",{mixData:e,trackId:t,workDirs:n,metadataManager:o?o._addr:null,wavPath:r,sampleRate:i,bitsPerSample:a,maxSongLengthSecs:s,listener:l?l._addr:null,listener_id:l?l._id:null,allowNormDown:c,allowNormUp:u,includeMasterVol:d,includeTrackVol:p,includeTrackPan:m,includeAuxSend:f})),renderRegionToWav:(e,t,n,o,r,i,a,s,l,c,u)=>(l&&l.init(this.port),this._staticMethodWithReturn("MixdownCreator","renderRegionToWav",{mixData:e,regionId:t,workDirs:n,metadataManager:o?o._addr:null,wavPath:r,sampleRate:i,bitsPerSample:a,maxSongLengthSecs:s,listener:l?l._addr:null,listener_id:l?l._id:null,allowNormDown:c,allowNormUp:u})),renderMixToMidi:(e,t,n,o)=>this._staticMethodWithReturn("MixdownCreator","renderMixToMidi",{mixData:e,sampleDir:t,soundbanksJson:n,midiPath:o}),renderTrackToMidi:(e,t,n,o,r)=>this._staticMethodWithReturn("MixdownCreator","renderTrackToMidi",{mixData:e,trackId:t,sampleDir:n,soundbanksJson:o,midiPath:r}),renderRegionToMidi:(e,t,n,o,r)=>this._staticMethodWithReturn("MixdownCreator","renderRegionToMidi",{mixData:e,regionId:t,sampleDir:n,soundbanksJson:o,midiPath:r}),getSafeTrackExportFileNames:e=>this._staticMethodWithReturn("MixdownCreator","getSafeTrackExportFileNames",{trackNames:e})};Looper={create:async()=>{const e=await this._staticMethodWithReturn("Looper","create",{});return e?new MR(e,this.port):null}};PatternEditor={getBeatStarterTemplateInfo:()=>this._staticMethodWithReturn("PatternEditor","getBeatStarterTemplateInfo",{}),checkTrackVersionCompatibility:(e,t,n)=>this._staticMethodWithReturn("PatternEditor","checkTrackVersionCompatibility",{trackData:e,sampleDir:t,featureSetVersion:n}),setClientFeatureSetVersion:e=>this._staticMethodWithoutReturn("PatternEditor","setClientFeatureSetVersion",{featureSetVersion:e})};EffectMetadataManager={create:async()=>{const e=await this._staticMethodWithReturn("EffectMetadataManager","create",{});return e?new IR(e,this.port):null},createWithOptions:async e=>{const t=await this._staticMethodWithReturn("EffectMetadataManager","createWithOptions",{useTest:e});return t?new IR(t,this.port):null},jsonToEffectData:e=>this._staticMethodWithReturn("EffectMetadataManager","jsonToEffectData",{json:e}),effectDataToJson:e=>this._staticMethodWithReturn("EffectMetadataManager","effectDataToJson",{effectChain:e})};LiveEffect={setEffectMetadataManager:e=>this._staticMethodWithReturn("LiveEffect","setEffectMetadataManager",{manager:e?e._addr:null}),getEffectMetadataManager:async()=>{const e=await this._staticMethodWithReturn("LiveEffect","getEffectMetadataManager",{});return e?new IR(e,this.port):null},runSelfTest:e=>this._staticMethodWithReturn("LiveEffect","runSelfTest",{sampleRate:e}),setDeglitchIfAnyParamUpdated:e=>this._staticMethodWithoutReturn("LiveEffect","setDeglitchIfAnyParamUpdated",{deglitch:e})};LiveEffectChain={create:async()=>{const e=await this._staticMethodWithReturn("LiveEffectChain","create",{});return e?new OR(e,this.port):null}};MixHandler={create:async(e,t,n)=>{const o=await this._staticMethodWithReturn("MixHandler","create",{transport:e?e._addr:null,workDirs:t,metadataManager:n?n._addr:null});return o?new jR(o,this.port):null},updateAutoPitchDataDeprecated:(e,t)=>this._staticMethodWithReturn("MixHandler","updateAutoPitchDataDeprecated",{originalAutoPitchData:e,keySig:t}),getSupportedAutoPitchSlugsDeprecated:()=>this._staticMethodWithReturn("MixHandler","getSupportedAutoPitchSlugsDeprecated",{}),getAutoPitchPresetGroupsAndPresetsDeprecated:()=>this._staticMethodWithReturn("MixHandler","getAutoPitchPresetGroupsAndPresetsDeprecated",{}),getAutoPitchPresetMetadataDeprecated:e=>this._staticMethodWithReturn("MixHandler","getAutoPitchPresetMetadataDeprecated",{presetSlug:e}),createMixDataFromRevision:e=>this._staticMethodWithReturn("MixHandler","createMixDataFromRevision",{jsonRevision:e}),createRevisionFromMixData:(e,t)=>this._staticMethodWithReturn("MixHandler","createRevisionFromMixData",{mixData:e,mixdownId:t}),createMixDataFromMidiImportResult:(e,t)=>this._staticMethodWithReturn("MixHandler","createMixDataFromMidiImportResult",{midiImportResult:e,options:t}),createMixDataFromMidiImportResultAndTemplate:(e,t)=>this._staticMethodWithReturn("MixHandler","createMixDataFromMidiImportResultAndTemplate",{midiImportResult:e,templateMixData:t}),getTrackType:(e,t,n,o)=>this._staticMethodWithReturn("MixHandler","getTrackType",{type:e,soundbank:t,loopPack:n,samplerKit:o}),getMixDataChangeSet:(e,t)=>this._staticMethodWithReturn("MixHandler","getMixDataChangeSet",{fromMix:e,toMix:t}),getDuplicateTrackIds:e=>this._staticMethodWithReturn("MixHandler","getDuplicateTrackIds",{mixData:e}),getDuplicateRegionIds:e=>this._staticMethodWithReturn("MixHandler","getDuplicateRegionIds",{mixData:e}),cleanupMix:(e,t)=>this._staticMethodWithReturn("MixHandler","cleanupMix",{mix:e,metadataManager:t?t._addr:null}),removeTempFiles:e=>this._staticMethodWithoutReturn("MixHandler","removeTempFiles",{directory:e}),getMixRequirements:e=>this._staticMethodWithReturn("MixHandler","getMixRequirements",{mix:e}),detectDuplicateSamples:(e,t,n)=>(n&&n.init(this.port),this._staticMethodWithReturn("MixHandler","detectDuplicateSamples",{mix:e,samplesDir:t,listener:n?n._addr:null,listener_id:n?n._id:null})),validateRevision:e=>this._staticMethodWithReturn("MixHandler","validateRevision",{jsonRevision:e})};AutoPitch={getMaxSupportedVersion:()=>this._staticMethodWithReturn("AutoPitch","getMaxSupportedVersion",{}),isSupported:e=>this._staticMethodWithReturn("AutoPitch","isSupported",{ap:e}),migrateAutomatically:(e,t)=>this._staticMethodWithReturn("AutoPitch","migrateAutomatically",{ap:e,upToVersion:t}),migrateManually:(e,t)=>this._staticMethodWithReturn("AutoPitch","migrateManually",{ap:e,toVersion:t}),createData:(e,t)=>this._staticMethodWithReturn("AutoPitch","createData",{desiredVersion:e,keySig:t}),sanitizeData:(e,t)=>this._staticMethodWithReturn("AutoPitch","sanitizeData",{input:e,keySig:t}),getSupportedSlugs:e=>this._staticMethodWithReturn("AutoPitch","getSupportedSlugs",{version:e}),getPresetGroupsAndPresets:e=>this._staticMethodWithReturn("AutoPitch","getPresetGroupsAndPresets",{version:e}),getPresetMetadata:(e,t)=>this._staticMethodWithReturn("AutoPitch","getPresetMetadata",{presetSlug:e,version:t})};Transport={create:async e=>{const t=await this._staticMethodWithReturn("Transport","create",{clockSource:e?e._addr:null});return t?new DR(t,this.port):null}};Tuner={create:async(e,t,n)=>{const o=await this._staticMethodWithReturn("Tuner","create",{minPitchMidi:e,maxPitchMidi:t,useThread:n});return o?new NR(o,this.port):null}};Metronome={create:async()=>{const e=await this._staticMethodWithReturn("Metronome","create",{});return e?new UR(e,this.port):null}};RotationTracker={create:async()=>{const e=await this._staticMethodWithReturn("RotationTracker","create",{});return e?new FR(e,this.port):null},selfTest:()=>this._staticMethodWithReturn("RotationTracker","selfTest",{})};WavReader={create:async()=>{const e=await this._staticMethodWithReturn("WavReader","create",{});return e?new BR(e,this.port):null}};WavWriter={create:async()=>{const e=await this._staticMethodWithReturn("WavWriter","create",{});return e?new WR(e,this.port):null}};AutoDrummer={create:async()=>{const e=await this._staticMethodWithReturn("AutoDrummer","create",{});return e?new VR(e,this.port):null},getDrummerDataFromJSON:e=>this._staticMethodWithReturn("AutoDrummer","getDrummerDataFromJSON",{jsonPath:e}),getComponentIDFromString:e=>this._staticMethodWithReturn("AutoDrummer","getComponentIDFromString",{name:e})};Arpeggiator={create:async()=>{const e=await this._staticMethodWithReturn("Arpeggiator","create",{});return e?new qR(e,this.port):null}};MidiReader={open:async e=>{const t=await this._staticMethodWithReturn("MidiReader","open",{path:e});return t?new zR(t,this.port):null},createTestFile:(e,t,n,o,r)=>this._staticMethodWithReturn("MidiReader","createTestFile",{path:e,notes:t,noteLen:n,bpm:o,ticksPerQ:r}),midiFileIsValid:e=>this._staticMethodWithReturn("MidiReader","midiFileIsValid",{midiFilePath:e}),getPianoRoll:e=>this._staticMethodWithReturn("MidiReader","getPianoRoll",{midiFilePath:e}),prepareMidiFileForImport:(e,t,n,o)=>this._staticMethodWithReturn("MidiReader","prepareMidiFileForImport",{midiFilePath:e,mergeTracks:t,outputPath:n,soundbankMeta:o}),mapNotesAndVelocities:(e,t,n,o,r)=>this._staticMethodWithReturn("MidiReader","mapNotesAndVelocities",{inPath:e,outPath:t,noteMap:n,velMap:o,mapPercussion:r}),hasNotes:e=>this._staticMethodWithReturn("MidiReader","hasNotes",{midiFilePath:e}),dumpMidiFileToString:e=>this._staticMethodWithReturn("MidiReader","dumpMidiFileToString",{midiFilePath:e}),getMidiExcerpt:(e,t,n,o,r)=>this._staticMethodWithReturn("MidiReader","getMidiExcerpt",{inMidiPath:e,outMidiPath:t,fromTicks:n,toTicks:o,trackName:r})};MasteringService={create:async()=>{const e=await this._staticMethodWithReturn("MasteringService","create",{});return e?new HR(e,this.port):null},applyMasteringToWav:(e,t,n,o,r,i,a)=>(a&&a.init(this.port),this._staticMethodWithReturn("MasteringService","applyMasteringToWav",{srcWavPath:e,workDirs:t,metadataManager:n?n._addr:null,presetSlug:o,dstWavPath:r,bitsPerSample:i,listener:a?a._addr:null,listener_id:a?a._id:null}))};VASynth={create:async()=>{const e=await this._staticMethodWithReturn("VASynth","create",{});return e?new GR(e,this.port):null}};FMSynth={create:async()=>{const e=await this._staticMethodWithReturn("FMSynth","create",{});return e?new KR(e,this.port):null}};SamplerKits={fromFile:e=>this._staticMethodWithReturn("SamplerKits","fromFile",{path:e}),fromJson:e=>this._staticMethodWithReturn("SamplerKits","fromJson",{str:e}),toJson:e=>this._staticMethodWithReturn("SamplerKits","toJson",{kit:e}),toFile:(e,t)=>this._staticMethodWithReturn("SamplerKits","toFile",{kit:e,dest:t}),validateSamplerKit:(e,t)=>this._staticMethodWithReturn("SamplerKits","validateSamplerKit",{kit:e,samplesDir:t})};MultipadSampler={create:async(e,t)=>{const n=await this._staticMethodWithReturn("MultipadSampler","create",{numPads:e,slotZeroMIDINote:t});return n?new JR(n,this.port):null}};Soundbank={verify:(e,t,n,o,r)=>this._staticMethodWithReturn("Soundbank","verify",{soundbankSlug:e,soundbankDir:t,sampleRate:n,version:o,deployed:r}),getSoundbankInfo:(e,t)=>this._staticMethodWithReturn("Soundbank","getSoundbankInfo",{soundbankSlug:e,soundbankDir:t})};MIDISoundbankPool={initialize:(e,t,n)=>this._staticMethodWithReturn("MIDISoundbankPool","initialize",{sampleRate:e,numChannels:t,soundbankDir:n}),getSoundbank:async e=>{const t=await this._staticMethodWithReturn("MIDISoundbankPool","getSoundbank",{soundbankName:e});return t?new XR(t,this.port):null}};MIDISampleSynth={create:async()=>{const e=await this._staticMethodWithReturn("MIDISampleSynth","create",{});return e?new ZR(e,this.port):null}};MusicUtils={midiToFreq:e=>this._staticMethodWithReturn("MusicUtils","midiToFreq",{midi:e}),freqToMidi:e=>this._staticMethodWithReturn("MusicUtils","freqToMidi",{freq:e}),semitonesToRatio:e=>this._staticMethodWithReturn("MusicUtils","semitonesToRatio",{st:e}),ratioToSemitones:e=>this._staticMethodWithReturn("MusicUtils","ratioToSemitones",{freqRatio:e}),dBToLinearGain:e=>this._staticMethodWithReturn("MusicUtils","dBToLinearGain",{dBGain:e}),linearGainTodB:e=>this._staticMethodWithReturn("MusicUtils","linearGainTodB",{linearGain:e}),normGainToGain:e=>this._staticMethodWithReturn("MusicUtils","normGainToGain",{normGain:e}),gainToNormGain:e=>this._staticMethodWithReturn("MusicUtils","gainToNormGain",{linearGain:e}),normToGain:(e,t,n)=>this._staticMethodWithReturn("MusicUtils","normToGain",{normGain:e,normAt0dB:t,dBMax:n}),gainToNorm:(e,t,n)=>this._staticMethodWithReturn("MusicUtils","gainToNorm",{linearGain:e,normAt0dB:t,dBMax:n}),volumeToDisplayValue:e=>this._staticMethodWithReturn("MusicUtils","volumeToDisplayValue",{volume:e}),panToDisplayValue:e=>this._staticMethodWithReturn("MusicUtils","panToDisplayValue",{pan:e}),keySigStringIsFormattedCorrectly:e=>this._staticMethodWithReturn("MusicUtils","keySigStringIsFormattedCorrectly",{keyStr:e}),parseKeySig:e=>this._staticMethodWithReturn("MusicUtils","parseKeySig",{keyStr:e}),keySigToString:e=>this._staticMethodWithReturn("MusicUtils","keySigToString",{keySig:e}),keySigIsUndefined:e=>this._staticMethodWithReturn("MusicUtils","keySigIsUndefined",{keySig:e}),timeSigIsUndefined:e=>this._staticMethodWithReturn("MusicUtils","timeSigIsUndefined",{timeSig:e}),midiToString:(e,t,n)=>this._staticMethodWithReturn("MusicUtils","midiToString",{midi:e,withOctave:t,preferSharps:n}),isKeyBlack:e=>this._staticMethodWithReturn("MusicUtils","isKeyBlack",{midi:e}),isTonic:(e,t)=>this._staticMethodWithReturn("MusicUtils","isTonic",{tonic:e,midi:t}),getScalePitches:(e,t,n,o,r)=>this._staticMethodWithReturn("MusicUtils","getScalePitches",{scale:e,tonic:t,octave:n,offset:o,numNotes:r}),getKeySignatureFromScaleAndTonic:(e,t)=>this._staticMethodWithReturn("MusicUtils","getKeySignatureFromScaleAndTonic",{scale:e,tonic:t}),getTonicFromKeySignature:e=>this._staticMethodWithReturn("MusicUtils","getTonicFromKeySignature",{keySig:e}),getScaleFromKeySignature:e=>this._staticMethodWithReturn("MusicUtils","getScaleFromKeySignature",{keySig:e}),slugToTonic:e=>this._staticMethodWithReturn("MusicUtils","slugToTonic",{tonicSlug:e}),tonicToSlug:e=>this._staticMethodWithReturn("MusicUtils","tonicToSlug",{tonic:e}),tonicToString:(e,t,n)=>this._staticMethodWithReturn("MusicUtils","tonicToString",{tonic:e,scale:t,keySig:n}),slugToScale:e=>this._staticMethodWithReturn("MusicUtils","slugToScale",{scaleSlug:e}),scaleToSlug:e=>this._staticMethodWithReturn("MusicUtils","scaleToSlug",{scale:e}),getTransposition:(e,t)=>this._staticMethodWithReturn("MusicUtils","getTransposition",{fromKey:e,toKey:t}),transposeKey:(e,t)=>this._staticMethodWithReturn("MusicUtils","transposeKey",{keySig:e,pitchShift:t}),limitTransposition:e=>this._staticMethodWithReturn("MusicUtils","limitTransposition",{pitchShift:e}),ticksToSecs:(e,t,n)=>this._staticMethodWithReturn("MusicUtils","ticksToSecs",{ticks:e,ticksPerQ:t,tempoBPM:n}),secsToTicks:(e,t,n)=>this._staticMethodWithReturn("MusicUtils","secsToTicks",{secs:e,ticksPerQ:t,tempoBPM:n}),ticksToSamples:(e,t,n,o)=>this._staticMethodWithReturn("MusicUtils","ticksToSamples",{ticks:e,ticksPerQ:t,tempoBPM:n,sampleRate:o}),samplesToTicks:(e,t,n,o)=>this._staticMethodWithReturn("MusicUtils","samplesToTicks",{samples:e,ticksPerQ:t,tempoBPM:n,sampleRate:o}),quantizeTimeTicks:(e,t,n,o)=>this._staticMethodWithReturn("MusicUtils","quantizeTimeTicks",{timeTicks:e,snap:t,ticksPerQ:n,timeSig:o}),getKeySignatureMenuList:()=>this._staticMethodWithReturn("MusicUtils","getKeySignatureMenuList",{}),getKeySignatureMenuIndexForKey:e=>this._staticMethodWithReturn("MusicUtils","getKeySignatureMenuIndexForKey",{keySig:e}),getKeySignatureMenuKeyForIndex:e=>this._staticMethodWithReturn("MusicUtils","getKeySignatureMenuKeyForIndex",{menuIndex:e}),getSimplestEnharmonicKeySignature:e=>this._staticMethodWithReturn("MusicUtils","getSimplestEnharmonicKeySignature",{keySig:e})};WavUtils={convertToWav:(e,t,n,o)=>(o&&o.init(this.port),this._staticMethodWithReturn("WavUtils","convertToWav",{srcPath:e,wavPath:t,sampleRate:n,listener:o?o._addr:null,listener_id:o?o._id:null})),convertToM4a:(e,t,n,o)=>(o&&o.init(this.port),this._staticMethodWithReturn("WavUtils","convertToM4a",{wavPath:e,m4aPath:t,sampleRate:n,listener:o?o._addr:null,listener_id:o?o._id:null})),batchConvertM4aToWav:(e,t,n,o,r)=>this._staticMethodWithReturn("WavUtils","batchConvertM4aToWav",{m4aDir:e,wavDir:t,sampleRate:n,fileNames:o,skipIfExists:r}),batchConvertWavToM4a:(e,t,n,o,r)=>this._staticMethodWithReturn("WavUtils","batchConvertWavToM4a",{wavDir:e,m4aDir:t,sampleRate:n,fileNames:o,skipIfExists:r}),wavIsValid:(e,t)=>this._staticMethodWithReturn("WavUtils","wavIsValid",{wavPath:e,expectedSampleRate:t}),m4aIsValid:e=>this._staticMethodWithReturn("WavUtils","m4aIsValid",{m4aPath:e}),denoise:(e,t,n)=>(n&&n.init(this.port),this._staticMethodWithReturn("WavUtils","denoise",{srcWavPath:e,dstWavPath:t,listener:n?n._addr:null,listener_id:n?n._id:null}))};SineToneGenerator={create:async()=>{const e=await this._staticMethodWithReturn("SineToneGenerator","create",{});return e?new QR(e,this.port):null}};MusicAnalysis={getProjectSettingsForAudioTrackImport:e=>this._staticMethodWithReturn("MusicAnalysis","getProjectSettingsForAudioTrackImport",{wavPath:e}),convertWavToMidi:(e,t,n)=>this._staticMethodWithReturn("MusicAnalysis","convertWavToMidi",{wavPath:e,midiPath:t,tempoBPM:n})};AudioRecordPlayer={create:async(e,t)=>{const n=await this._staticMethodWithReturn("AudioRecordPlayer","create",{id:e,transport:t?t._addr:null});return n?new eA(n,this.port):null}};MIDIRecordPlayer={create:async(e,t)=>{const n=await this._staticMethodWithReturn("MIDIRecordPlayer","create",{id:e,transport:t?t._addr:null});return n?new tA(n,this.port):null}};AudioLatencyDetector={create:async()=>{const e=await this._staticMethodWithReturn("AudioLatencyDetector","create",{});return e?new nA(e,this.port):null}};AudioEngineCommon={numChannels:()=>this._staticMethodWithReturn("AudioEngineCommon","numChannels",{}),ticksPerQuarter:()=>this._staticMethodWithReturn("AudioEngineCommon","ticksPerQuarter",{}),offlineChunkLength:()=>this._staticMethodWithReturn("AudioEngineCommon","offlineChunkLength",{}),minRegionDurSnap:()=>this._staticMethodWithReturn("AudioEngineCommon","minRegionDurSnap",{}),minRegionDurTicks:()=>this._staticMethodWithReturn("AudioEngineCommon","minRegionDurTicks",{}),minBpm:()=>this._staticMethodWithReturn("AudioEngineCommon","minBpm",{}),maxBpm:()=>this._staticMethodWithReturn("AudioEngineCommon","maxBpm",{})};Localisation={setLocale:e=>this._staticMethodWithoutReturn("Localisation","setLocale",{locale:e}),getLocale:()=>this._staticMethodWithReturn("Localisation","getLocale",{})};SelfTest={runEngineSelfTest:(e,t,n)=>this._staticMethodWithReturn("SelfTest","runEngineSelfTest",{metadataManager:e?e._addr:null,workDirs:t,sampleRate:n})};VisualEq={getVisualEq:async e=>{const t=await this._staticMethodWithReturn("VisualEq","getVisualEq",{effect:e?e._addr:null});return t?new oA(t,this.port):null}}}class bR{constructor(e,t,n){this._addr=e,this._port=t,this._methodWithReturn=(o,r)=>new Promise((i=>{const a=crypto.randomUUID(),s=e=>{e.data.id===a&&(t.removeEventListener("message",s),i(e.data.result),e.stopPropagation())};t.addEventListener("message",s),t.postMessage({addr:e,className:n,method:o,args:r,id:a})})),this._methodWithoutReturn=(o,r)=>{t.postMessage({addr:e,className:n,method:o,args:r})}}delete(){this._methodWithoutReturn("delete")}}class yR extends bR{constructor(e,t){super(e,t,"AudioOutput")}connect(e){this._methodWithoutReturn("connect",{nodeInput:e?e._addr:null})}disconnect(e){this._methodWithoutReturn("disconnect",{nodeInput:e?e._addr:null})}disconnectAll(){this._methodWithoutReturn("disconnectAll",{})}}class wR extends bR{constructor(e,t){super(e,t,"AudioInput")}disconnectAll(){this._methodWithoutReturn("disconnectAll",{})}}class $R extends bR{constructor(e,t){super(e,t,"MIDIOutput")}connect(e){this._methodWithoutReturn("connect",{nodeInput:e?e._addr:null})}disconnect(e){this._methodWithoutReturn("disconnect",{nodeInput:e?e._addr:null})}disconnectAll(){this._methodWithoutReturn("disconnectAll",{})}}class kR extends bR{constructor(e,t){super(e,t,"MIDIInput")}disconnectAll(){this._methodWithoutReturn("disconnectAll",{})}}class SR extends bR{constructor(e,t){super(e,t,"Resampler")}init(e,t,n){this._methodWithoutReturn("init",{srcSr:e,dstSr:t,order:n})}process(e,t){return this._methodWithReturn("process",{input:e,numChannels:t})}reset(){this._methodWithoutReturn("reset",{})}}class _R extends bR{constructor(e,t){super(e,t,"WaveformGenerator")}startGenerating(e,t){return this._methodWithReturn("startGenerating",{wavFilePath:e,ptsPerSec:t})}startGeneration(e,t){return this._methodWithReturn("startGeneration",{wavFilePath:e,ptsPerSec:t})}getWaveformData(e){return this._methodWithReturn("getWaveformData",{numFramesToProcess:e})}isGenerating(){return this._methodWithReturn("isGenerating",{})}stopGenerating(){this._methodWithoutReturn("stopGenerating",{})}}class PR extends bR{constructor(e,t){super(e,t,"AudioStretchEngine")}initialize(e,t,n){t&&t.init(this._port),this._methodWithoutReturn("initialize",{sampleRate:e,listener:t?t._addr:null,listener_id:t?t._id:null,framesPerCallback:n})}async audioOutput(){const e=await this._methodWithReturn("audioOutput",{});return e?new yR(e,this._port):null}setEventListener(e){e&&e.init(this._port),this._methodWithoutReturn("setEventListener",{listener:e?e._addr:null,listener_id:e?e._id:null})}startAudioOutput(){this._methodWithoutReturn("startAudioOutput",{})}stopAudioOutput(){this._methodWithoutReturn("stopAudioOutput",{})}setLiteMode(e){this._methodWithoutReturn("setLiteMode",{liteMode:e})}load(e){return this._methodWithReturn("load",{wavFilePath:e})}unload(){this._methodWithoutReturn("unload",{})}getDuration(){return this._methodWithReturn("getDuration",{})}getCurrentTime(){return this._methodWithReturn("getCurrentTime",{})}setCurrentTime(e){this._methodWithoutReturn("setCurrentTime",{timeSecs:e})}getEndLimit(){return this._methodWithReturn("getEndLimit",{})}play(){this._methodWithoutReturn("play",{})}pause(){this._methodWithoutReturn("pause",{})}isPaused(){return this._methodWithReturn("isPaused",{})}beginSeekForward(){this._methodWithoutReturn("beginSeekForward",{})}beginSeekBackward(){this._methodWithoutReturn("beginSeekBackward",{})}endSeek(){this._methodWithoutReturn("endSeek",{})}jumpBack(){this._methodWithoutReturn("jumpBack",{})}jumpForward(){this._methodWithoutReturn("jumpForward",{})}setLimitFwdBackJump(e){this._methodWithoutReturn("setLimitFwdBackJump",{limit:e})}getLimitFwdBackJump(){return this._methodWithReturn("getLimitFwdBackJump",{})}setScrubTargetTime(e){this._methodWithoutReturn("setScrubTargetTime",{targetTime:e})}endScrubbing(){this._methodWithoutReturn("endScrubbing",{})}setPlaybackRate(e){this._methodWithoutReturn("setPlaybackRate",{rate:e})}getPlaybackRate(){return this._methodWithReturn("getPlaybackRate",{})}getMaxPlaybackRate(){return this._methodWithReturn("getMaxPlaybackRate",{})}setPitchShift(e){this._methodWithoutReturn("setPitchShift",{shift:e})}getPitchShift(){return this._methodWithReturn("getPitchShift",{})}getMaxPitchShift(){return this._methodWithReturn("getMaxPitchShift",{})}setLoop(e){this._methodWithoutReturn("setLoop",{enable:e})}getLoop(){return this._methodWithReturn("getLoop",{})}setLoopStartToCurrentTime(){this._methodWithoutReturn("setLoopStartToCurrentTime",{})}setLoopStart(e){this._methodWithoutReturn("setLoopStart",{time:e})}getLoopStart(){return this._methodWithReturn("getLoopStart",{})}setLoopEndToCurrentTime(){this._methodWithoutReturn("setLoopEndToCurrentTime",{})}setLoopEnd(e){this._methodWithoutReturn("setLoopEnd",{time:e})}getLoopEnd(){return this._methodWithReturn("getLoopEnd",{})}createLoopFromSnapPoints(){this._methodWithoutReturn("createLoopFromSnapPoints",{})}setMarker(){this._methodWithoutReturn("setMarker",{})}setAllMarkers(e){this._methodWithoutReturn("setAllMarkers",{markers:e})}getAllMarkers(){return this._methodWithReturn("getAllMarkers",{})}clearAllMarkers(){this._methodWithoutReturn("clearAllMarkers",{})}setAudioMode(e){this._methodWithoutReturn("setAudioMode",{mode:e})}getAudioMode(){return this._methodWithReturn("getAudioMode",{})}playNote(e){this._methodWithoutReturn("playNote",{note:e})}setAutoPlayOnKeyPress(e){this._methodWithoutReturn("setAutoPlayOnKeyPress",{autoPlay:e})}startExport(){return this._methodWithReturn("startExport",{})}getExportedFrames(e){return this._methodWithReturn("getExportedFrames",{numFramesToGet:e})}isExporting(){return this._methodWithReturn("isExporting",{})}endExport(){this._methodWithoutReturn("endExport",{})}setAllowAudioDeviceAutoStop(e){this._methodWithoutReturn("setAllowAudioDeviceAutoStop",{allowAutoStop:e})}getExportFileName(e){return this._methodWithReturn("getExportFileName",{title:e})}getSpectrum(){return this._methodWithReturn("getSpectrum",{})}}class MR extends bR{constructor(e,t){super(e,t,"Looper")}init(e){this._methodWithoutReturn("init",{sampleDir:e})}verifyClips(e){return this._methodWithReturn("verifyClips",{clipDataList:e})}setClips(e){return this._methodWithReturn("setClips",{clipDataList:e})}getClipStatus(e){return this._methodWithReturn("getClipStatus",{clipIndex:e})}getClipPhase(e){return this._methodWithReturn("getClipPhase",{clipIndex:e})}getBeatPos(){return this._methodWithReturn("getBeatPos",{})}setTempo(e){this._methodWithoutReturn("setTempo",{bpm:e})}getTempo(){return this._methodWithReturn("getTempo",{})}setKey(e){this._methodWithoutReturn("setKey",{key:e})}getKey(){return this._methodWithReturn("getKey",{})}pause(){this._methodWithoutReturn("pause",{})}resume(){this._methodWithoutReturn("resume",{})}getPauseState(){return this._methodWithReturn("getPauseState",{})}stop(){this._methodWithoutReturn("stop",{})}setClipQuantization(e,t){this._methodWithoutReturn("setClipQuantization",{clipIndex:e,snap:t})}getClipQuantization(e){return this._methodWithReturn("getClipQuantization",{clipIndex:e})}setClipLaunchMode(e,t){this._methodWithoutReturn("setClipLaunchMode",{clipIndex:e,launchMode:t})}getClipLaunchMode(e){return this._methodWithReturn("getClipLaunchMode",{clipIndex:e})}setClipLoopMode(e,t){this._methodWithoutReturn("setClipLoopMode",{clipIndex:e,isLoop:t})}getClipLoopMode(e){return this._methodWithReturn("getClipLoopMode",{clipIndex:e})}setFilterBypass(e){this._methodWithoutReturn("setFilterBypass",{bypass:e})}getFilterBypass(){return this._methodWithReturn("getFilterBypass",{})}setFilterCutoff(e){this._methodWithoutReturn("setFilterCutoff",{cutoff:e})}getFilterCutoff(){return this._methodWithReturn("getFilterCutoff",{})}setFilterResonance(e){this._methodWithoutReturn("setFilterResonance",{resonance:e})}getFilterResonance(){return this._methodWithReturn("getFilterResonance",{})}setStutterBypass(e){this._methodWithoutReturn("setStutterBypass",{bypass:e})}getStutterBypass(){return this._methodWithReturn("getStutterBypass",{})}setStutterRate(e){this._methodWithoutReturn("setStutterRate",{rate:e})}getStutterRate(){return this._methodWithReturn("getStutterRate",{})}setGaterBypass(e){this._methodWithoutReturn("setGaterBypass",{bypass:e})}getGaterBypass(){return this._methodWithReturn("getGaterBypass",{})}setGaterRate(e){this._methodWithoutReturn("setGaterRate",{rate:e})}getGaterRate(){return this._methodWithReturn("getGaterRate",{})}setGaterDepth(e){this._methodWithoutReturn("setGaterDepth",{depth:e})}getGaterDepth(){return this._methodWithReturn("getGaterDepth",{})}setStopperBypass(e){this._methodWithoutReturn("setStopperBypass",{bypass:e})}getStopperBypass(){return this._methodWithReturn("getStopperBypass",{})}setStopperDuration(e){this._methodWithoutReturn("setStopperDuration",{duration:e})}getStopperDuration(){return this._methodWithReturn("getStopperDuration",{})}async midiInput(){const e=await this._methodWithReturn("midiInput",{});return e?new kR(e,this._port):null}async audioOutput(){const e=await this._methodWithReturn("audioOutput",{});return e?new yR(e,this._port):null}setTransport(e){this._methodWithoutReturn("setTransport",{transport:e?e._addr:null})}}class TR extends bR{constructor(e,t){super(e,t,"MidiEditor")}randomizeSelectionVelocity(){return this._methodWithReturn("randomizeSelectionVelocity",{})}setRegionListener(e){e&&e.init(this._port),this._methodWithoutReturn("setRegionListener",{regionListener:e?e._addr:null,regionListener_id:e?e._id:null})}setNoteListener(e,t){e&&e.init(this._port),this._methodWithoutReturn("setNoteListener",{noteListener:e?e._addr:null,noteListener_id:e?e._id:null,regionID:t})}addRegion(e){return this._methodWithReturn("addRegion",{regionToAdd:e})}changeRegion(e){return this._methodWithReturn("changeRegion",{regionToChange:e})}deleteRegion(e){return this._methodWithReturn("deleteRegion",{regionID:e})}quantizeRegion(e,t){return this._methodWithReturn("quantizeRegion",{regionID:e,snap:t})}addNote(e,t){return this._methodWithReturn("addNote",{pitchRow:e,time:t})}changeNote(e){return this._methodWithReturn("changeNote",{noteToChange:e})}getSelectionVelocity(){return this._methodWithReturn("getSelectionVelocity",{})}setSelectionVelocity(e,t){return this._methodWithReturn("setSelectionVelocity",{velocity:e,makeSame:t})}applyChanges(){return this._methodWithReturn("applyChanges",{})}cancelChanges(){return this._methodWithReturn("cancelChanges",{})}deleteSelection(){return this._methodWithReturn("deleteSelection",{})}quantizeSelection(e){return this._methodWithReturn("quantizeSelection",{snap:e})}humanizeSelection(){return this._methodWithReturn("humanizeSelection",{})}deleteNote(e){return this._methodWithReturn("deleteNote",{noteID:e})}setQuantization(e){this._methodWithoutReturn("setQuantization",{snap:e})}setMinNoteDuration(e){this._methodWithoutReturn("setMinNoteDuration",{minNoteDur:e})}canUndo(){return this._methodWithReturn("canUndo",{})}undo(){return this._methodWithReturn("undo",{})}canRedo(){return this._methodWithReturn("canRedo",{})}redo(){return this._methodWithReturn("redo",{})}getRegions(){return this._methodWithReturn("getRegions",{})}getNotesForRegion(e){return this._methodWithReturn("getNotesForRegion",{regionID:e})}syncMixData(){return this._methodWithReturn("syncMixData",{})}getNotesInRange(e,t,n,o){return this._methodWithReturn("getNotesInRange",{fromTime:e,toTime:t,fromPitch:n,toPitch:o})}getRegionsInRange(e,t){return this._methodWithReturn("getRegionsInRange",{fromTime:e,toTime:t})}getMedianNotePitch(){return this._methodWithReturn("getMedianNotePitch",{})}setSelection(e){return this._methodWithReturn("setSelection",{noteIDs:e})}getSelection(){return this._methodWithReturn("getSelection",{})}clearSelection(){this._methodWithoutReturn("clearSelection",{})}selectionEmpty(){return this._methodWithReturn("selectionEmpty",{})}selectNote(e){return this._methodWithReturn("selectNote",{noteID:e})}deselectNote(e){return this._methodWithReturn("deselectNote",{noteID:e})}setSelectionState(e,t){return this._methodWithReturn("setSelectionState",{noteID:e,state:t})}noteIsSelected(e){return this._methodWithReturn("noteIsSelected",{noteID:e})}selectAll(){this._methodWithoutReturn("selectAll",{})}selectAllNotesInRegion(e){return this._methodWithReturn("selectAllNotesInRegion",{regionID:e})}selectNotesInRange(e,t,n,o){this._methodWithoutReturn("selectNotesInRange",{fromTime:e,toTime:t,fromRow:n,toRow:o})}copySelectionToClipboard(){this._methodWithoutReturn("copySelectionToClipboard",{})}clipboardEmpty(){return this._methodWithReturn("clipboardEmpty",{})}paste(e,t){return this._methodWithReturn("paste",{atTime:e,atRow:t})}playSelection(){return this._methodWithReturn("playSelection",{})}startNoteAtRow(e){return this._methodWithReturn("startNoteAtRow",{pitchRow:e})}startNoteAtRowWithVelocity(e,t){return this._methodWithReturn("startNoteAtRowWithVelocity",{pitchRow:e,velocity:t})}stopNoteAtRow(e){return this._methodWithReturn("stopNoteAtRow",{pitchRow:e})}stopAllNotes(){return this._methodWithReturn("stopAllNotes",{})}legatoSelection(){return this._methodWithReturn("legatoSelection",{})}}class CR extends bR{constructor(e,t){super(e,t,"PatternEditor")}PATTERN_CHANGED=1;FAILED_NO_EDIT_IN_PROGRESS=2;FAILED_EDIT_ALREADY_IN_PROGRESS=4;getNumPatterns(){return this._methodWithReturn("getNumPatterns",{})}getAllPatterns(){return this._methodWithReturn("getAllPatterns",{})}getSelectedPattern(){return this._methodWithReturn("getSelectedPattern",{})}getSelectedPatternIndex(){return this._methodWithReturn("getSelectedPatternIndex",{})}selectPatternByIndex(e){return this._methodWithReturn("selectPatternByIndex",{index:e})}setBeatStarterTemplate(e){return this._methodWithReturn("setBeatStarterTemplate",{templateIndex:e})}touchDown(e,t){return this._methodWithReturn("touchDown",{row:e,time:t})}touchMove(e,t){return this._methodWithReturn("touchMove",{row:e,time:t})}touchUp(e,t){return this._methodWithReturn("touchUp",{row:e,time:t})}touchCancel(){return this._methodWithReturn("touchCancel",{})}setVelocityMode(e){this._methodWithoutReturn("setVelocityMode",{velocityMode:e})}getVelocityMode(){return this._methodWithReturn("getVelocityMode",{})}setSelectedPatternLengthInBars(e){return this._methodWithReturn("setSelectedPatternLengthInBars",{bars:e})}clearSelectedPattern(){return this._methodWithReturn("clearSelectedPattern",{})}isSelectedPatternEmpty(){return this._methodWithReturn("isSelectedPatternEmpty",{})}getEmptyStatusForAllPatterns(){return this._methodWithReturn("getEmptyStatusForAllPatterns",{})}isPatternEmpty(e){return this._methodWithReturn("isPatternEmpty",{patternIndex:e})}copySelectedPattern(){return this._methodWithReturn("copySelectedPattern",{})}isClipboardEmpty(){return this._methodWithReturn("isClipboardEmpty",{})}pasteIntoSelectedPattern(){return this._methodWithReturn("pasteIntoSelectedPattern",{})}getAvailableNotesForRow(e){return this._methodWithReturn("getAvailableNotesForRow",{row:e})}getSupportedNotes(){return this._methodWithReturn("getSupportedNotes",{})}setNoteForRow(e,t){return this._methodWithReturn("setNoteForRow",{row:e,midiNoteNumber:t})}getNoteForRow(e){return this._methodWithReturn("getNoteForRow",{row:e})}setSwingAmount(e){return this._methodWithReturn("setSwingAmount",{swingAmount:e})}getSwingAmount(){return this._methodWithReturn("getSwingAmount",{})}isPlaying(){return this._methodWithReturn("isPlaying",{})}start(){return this._methodWithReturn("start",{})}stop(){return this._methodWithReturn("stop",{})}toggle(){return this._methodWithReturn("toggle",{})}patternPlayheadPosTick(){return this._methodWithReturn("patternPlayheadPosTick",{})}getPatternIndexAtPlayhead(){return this._methodWithReturn("getPatternIndexAtPlayhead",{})}previewNote(e){return this._methodWithReturn("previewNote",{row:e})}previewMidi(e){return this._methodWithReturn("previewMidi",{midiNote:e})}canUndo(){return this._methodWithReturn("canUndo",{})}undo(){return this._methodWithReturn("undo",{})}canRedo(){return this._methodWithReturn("canRedo",{})}redo(){return this._methodWithReturn("redo",{})}}class ER extends bR{constructor(e,t){super(e,t,"AutomationEditor")}getTrackAutomationParams(){return this._methodWithReturn("getTrackAutomationParams",{})}getEffectNameAndIconUrl(e){return this._methodWithReturn("getEffectNameAndIconUrl",{effectId:e})}setSelectedAutomationParam(e,t,n){this._methodWithoutReturn("setSelectedAutomationParam",{type:e,effectId:t,paramSlug:n})}getSelectedAutomationParam(){return this._methodWithReturn("getSelectedAutomationParam",{})}addAutomationPoint(e){this._methodWithoutReturn("addAutomationPoint",{point:e})}selectAutomationPoint(e){this._methodWithoutReturn("selectAutomationPoint",{point:e})}unselectAutomationPoint(e){this._methodWithoutReturn("unselectAutomationPoint",{point:e})}getSelectedPoints(){return this._methodWithReturn("getSelectedPoints",{})}unselectAllPoints(){this._methodWithoutReturn("unselectAllPoints",{})}deleteSelectedPoints(){return this._methodWithReturn("deleteSelectedPoints",{})}moveSelectedPoints(e,t){return this._methodWithReturn("moveSelectedPoints",{deltaTicks:e,deltaNormVal:t})}completeMovePoints(e){this._methodWithoutReturn("completeMovePoints",{confirmApply:e})}ticksToSecsCurve(e){return this._methodWithReturn("ticksToSecsCurve",{ticksCurve:e})}secsToTicksCurve(e){return this._methodWithReturn("secsToTicksCurve",{secsCurve:e})}normToDisplayCurve(e){return this._methodWithReturn("normToDisplayCurve",{normCurve:e})}displayToNormCurve(e){return this._methodWithReturn("displayToNormCurve",{displayCurve:e})}toDisplayString(e){return this._methodWithReturn("toDisplayString",{normVal:e})}}class IR extends bR{constructor(e,t){super(e,t,"EffectMetadataManager")}resetToDefaultMetadata(){return this._methodWithReturn("resetToDefaultMetadata",{})}initializeFromString(e){return this._methodWithReturn("initializeFromString",{metadataString:e})}initializeFromPath(e){return this._methodWithReturn("initializeFromPath",{metadataPath:e})}setEffectGroups(e){return this._methodWithReturn("setEffectGroups",{groupsJson:e})}addMetadataForOneEffect(e){return this._methodWithReturn("addMetadataForOneEffect",{metadataString:e})}getVersion(){return this._methodWithReturn("getVersion",{})}getMaxEffectsPerChain(){return this._methodWithReturn("getMaxEffectsPerChain",{})}getAvailableEffects(){return this._methodWithReturn("getAvailableEffects",{})}getNumEffects(){return this._methodWithReturn("getNumEffects",{})}getEffectGroups(){return this._methodWithReturn("getEffectGroups",{})}exposeInvisibleEffects(e){this._methodWithoutReturn("exposeInvisibleEffects",{expose:e})}getMetadataForEffect(e){return this._methodWithReturn("getMetadataForEffect",{effectSlug:e})}getAvailablePresets(){return this._methodWithReturn("getAvailablePresets",{})}getNumPresets(){return this._methodWithReturn("getNumPresets",{})}getPresetGroups(){return this._methodWithReturn("getPresetGroups",{})}getRecommendedPresetsForTrackType(e){return this._methodWithReturn("getRecommendedPresetsForTrackType",{trackType:e})}getMetadataForPreset(e){return this._methodWithReturn("getMetadataForPreset",{presetSlug:e})}isPresetAvailable(e){return this._methodWithReturn("isPresetAvailable",{presetSlug:e})}isPresetDeprecated(e){return this._methodWithReturn("isPresetDeprecated",{presetSlug:e})}isEffectAvailable(e){return this._methodWithReturn("isEffectAvailable",{effectSlug:e})}isEffectDeprecated(e){return this._methodWithReturn("isEffectDeprecated",{effectSlug:e})}isEffectChainSupported(e){return this._methodWithReturn("isEffectChainSupported",{effectChain:e})}effectChainsEqual(e,t){return this._methodWithReturn("effectChainsEqual",{effectChainA:e,effectChainB:t})}}class RR extends bR{constructor(e,t){super(e,t,"FloatParam")}slug(){return this._methodWithReturn("slug",{})}name(){return this._methodWithReturn("name",{})}description(){return this._methodWithReturn("description",{})}isActive(){return this._methodWithReturn("isActive",{})}isAutomated(){return this._methodWithReturn("isAutomated",{})}setValueString(e){return this._methodWithReturn("setValueString",{stringValue:e})}getValueString(){return this._methodWithReturn("getValueString",{})}getDisplayUnit(){return this._methodWithReturn("getDisplayUnit",{})}useDecimalPoint(){return this._methodWithReturn("useDecimalPoint",{})}setAutomationCurve(e){this._methodWithoutReturn("setAutomationCurve",{curve:e})}getAutomationCurve(){return this._methodWithReturn("getAutomationCurve",{})}setNorm(e){return this._methodWithReturn("setNorm",{normValue:e})}getNorm(){return this._methodWithReturn("getNorm",{})}resetToDefault(){this._methodWithoutReturn("resetToDefault",{})}getDisplayValue(){return this._methodWithReturn("getDisplayValue",{})}getMetadata(){return this._methodWithReturn("getMetadata",{})}set(e){return this._methodWithReturn("set",{value:e})}get(){return this._methodWithReturn("get",{})}}class AR extends bR{constructor(e,t){super(e,t,"EnumParam")}slug(){return this._methodWithReturn("slug",{})}name(){return this._methodWithReturn("name",{})}description(){return this._methodWithReturn("description",{})}isActive(){return this._methodWithReturn("isActive",{})}isAutomated(){return this._methodWithReturn("isAutomated",{})}getEnumType(){return this._methodWithReturn("getEnumType",{})}getChoices(){return this._methodWithReturn("getChoices",{})}set(e){return this._methodWithReturn("set",{value:e})}get(){return this._methodWithReturn("get",{})}setNorm(e){return this._methodWithReturn("setNorm",{normValue:e})}getNorm(){return this._methodWithReturn("getNorm",{})}resetToDefault(){this._methodWithoutReturn("resetToDefault",{})}getDisplayValue(){return this._methodWithReturn("getDisplayValue",{})}getMetadata(){return this._methodWithReturn("getMetadata",{})}}class xR extends bR{constructor(e,t){super(e,t,"BoolParam")}slug(){return this._methodWithReturn("slug",{})}name(){return this._methodWithReturn("name",{})}description(){return this._methodWithReturn("description",{})}isActive(){return this._methodWithReturn("isActive",{})}isAutomated(){return this._methodWithReturn("isAutomated",{})}set(e){return this._methodWithReturn("set",{value:e})}get(){return this._methodWithReturn("get",{})}resetToDefault(){this._methodWithoutReturn("resetToDefault",{})}getMetadata(){return this._methodWithReturn("getMetadata",{})}}class LR extends bR{constructor(e,t){super(e,t,"LiveEffect")}getSlug(){return this._methodWithReturn("getSlug",{})}getName(){return this._methodWithReturn("getName",{})}getSubtitle(){return this._methodWithReturn("getSubtitle",{})}getDescription(){return this._methodWithReturn("getDescription",{})}setBypass(e){this._methodWithoutReturn("setBypass",{bypass:e})}isBypassed(){return this._methodWithReturn("isBypassed",{})}getParamList(){return this._methodWithReturn("getParamList",{})}async getFloatParams(){return e=await this._methodWithReturn("getFloatParams",{}),t=this._port,e.map((e=>new RR(e,t)));var e,t}async getEnumParams(){return e=await this._methodWithReturn("getEnumParams",{}),t=this._port,e.map((e=>new AR(e,t)));var e,t}async getBoolParams(){return e=await this._methodWithReturn("getBoolParams",{}),t=this._port,e.map((e=>new xR(e,t)));var e,t}resetAllParams(){this._methodWithoutReturn("resetAllParams",{})}getState(){return this._methodWithReturn("getState",{})}setState(e){this._methodWithoutReturn("setState",{state:e})}getUniqueId(){return this._methodWithReturn("getUniqueId",{})}isImplemented(){return this._methodWithReturn("isImplemented",{})}hasAutomation(){return this._methodWithReturn("hasAutomation",{})}}class OR extends bR{constructor(e,t){super(e,t,"LiveEffectChain")}getNumEffects(){return this._methodWithReturn("getNumEffects",{})}isEmpty(){return this._methodWithReturn("isEmpty",{})}async getEffectAt(e){const t=await this._methodWithReturn("getEffectAt",{pos:e});return t?new LR(t,this._port):null}moveEffectTo(e,t){return this._methodWithReturn("moveEffectTo",{effect:e?e._addr:null,pos:t})}async addEffect(e,t){const n=await this._methodWithReturn("addEffect",{slug:e,pos:t});return n?new LR(n,this._port):null}removeEffect(e){return this._methodWithReturn("removeEffect",{effect:e?e._addr:null})}async replaceEffect(e,t){const n=await this._methodWithReturn("replaceEffect",{slug:e,pos:t});return n?new LR(n,this._port):null}setState(e){return this._methodWithReturn("setState",{state:e})}getState(){return this._methodWithReturn("getState",{})}setPreset(e){return this._methodWithReturn("setPreset",{slug:e})}getPreset(){return this._methodWithReturn("getPreset",{})}async audioInput(){const e=await this._methodWithReturn("audioInput",{});return e?new wR(e,this._port):null}async audioOutput(){const e=await this._methodWithReturn("audioOutput",{});return e?new yR(e,this._port):null}hasAutomation(){return this._methodWithReturn("hasAutomation",{})}setAllBypass(e){this._methodWithoutReturn("setAllBypass",{bypass:e})}getNumBypassed(){return this._methodWithReturn("getNumBypassed",{})}noneBypassed(){return this._methodWithReturn("noneBypassed",{})}someBypassed(){return this._methodWithReturn("someBypassed",{})}allBypassed(){return this._methodWithReturn("allBypassed",{})}setTransport(e){this._methodWithoutReturn("setTransport",{transport:e?e._addr:null})}}class jR extends bR{constructor(e,t){super(e,t,"MixHandler")}ERR_NON_CRITICAL=-1;ERR_CRITICAL=-2;SET_MIX_FAILED_EFFECT_METADATA=1;SET_MIX_FAILED_WORK_DIRS=2;SET_MIX_FAILED_CLEAN_UP_MIX=4;SET_MIX_FAILED_CLEAN_UP_TRACKS=8;SET_MIX_FAILED_AUDIO_SAMPLES=16;SET_MIX_FAILED_MIDI_SAMPLES=32;SET_MIX_FAILED_EFFECTS=64;SET_MIX_FAILED_SOUNDBANKS=128;SET_MIX_FAILED_TRACK_IDS=256;SET_MIX_FAILED_REGION_IDS=512;MIX_DATA_NOT_CHANGED=32768;REGION_NOT_FOUND=65536;FREEZE_TRACK_CREATED_NEW_STEM=1;async audioInput(){const e=await this._methodWithReturn("audioInput",{});return e?new wR(e,this._port):null}async audioOutput(){const e=await this._methodWithReturn("audioOutput",{});return e?new yR(e,this._port):null}async midiInput(){const e=await this._methodWithReturn("midiInput",{});return e?new kR(e,this._port):null}async getMetronome(){const e=await this._methodWithReturn("getMetronome",{});return e?new UR(e,this._port):null}setMix(e){return this._methodWithReturn("setMix",{mix:e})}getCurrentMix(){return this._methodWithReturn("getCurrentMix",{})}getMixDuration(){return this._methodWithReturn("getMixDuration",{})}setKey(e){return this._methodWithReturn("setKey",{key:e})}getKey(){return this._methodWithReturn("getKey",{})}setPitchShift(e){return this._methodWithReturn("setPitchShift",{shift:e})}setLatencyFix(e){return this._methodWithReturn("setLatencyFix",{latencySamples:e})}selectTrack(e){return this._methodWithReturn("selectTrack",{trackID:e})}setMasterVolume(e){return this._methodWithReturn("setMasterVolume",{value:e})}getMasterVolumeDisplayValue(){return this._methodWithReturn("getMasterVolumeDisplayValue",{})}setTrackVolume(e,t){return this._methodWithReturn("setTrackVolume",{trackID:e,value:t})}setTrackVolumeAutomation(e,t){return this._methodWithReturn("setTrackVolumeAutomation",{trackID:e,curve:t})}getTrackVolumeDisplayValue(e){return this._methodWithReturn("getTrackVolumeDisplayValue",{trackID:e})}setTrackPan(e,t){return this._methodWithReturn("setTrackPan",{trackID:e,value:t})}setTrackPanAutomation(e,t){return this._methodWithReturn("setTrackPanAutomation",{trackID:e,curve:t})}getTrackPanDisplayValue(e){return this._methodWithReturn("getTrackPanDisplayValue",{trackID:e})}setMaxNumArmed(e){return this._methodWithReturn("setMaxNumArmed",{maxArmed:e})}setTrackArm(e,t){return this._methodWithReturn("setTrackArm",{trackId:e,arm:t})}getTrackArm(e){return this._methodWithReturn("getTrackArm",{trackId:e})}disarmAllTracks(){this._methodWithoutReturn("disarmAllTracks",{})}setTrackMonitoring(e,t){return this._methodWithReturn("setTrackMonitoring",{trackId:e,enable:t})}getTrackMonitoring(e){return this._methodWithReturn("getTrackMonitoring",{trackId:e})}disableMonitoringForAllTracks(){this._methodWithoutReturn("disableMonitoringForAllTracks",{})}setTrackMuted(e,t){return this._methodWithReturn("setTrackMuted",{trackID:e,value:t})}setTrackSolo(e,t){return this._methodWithReturn("setTrackSolo",{trackID:e,value:t})}toggleTrackMute(e,t){return this._methodWithReturn("toggleTrackMute",{trackId:e,unmuteOthers:t})}toggleTrackSolo(e,t){return this._methodWithReturn("toggleTrackSolo",{trackId:e,isExclusive:t})}getTrackMute(e){return this._methodWithReturn("getTrackMute",{trackId:e})}getTrackSolo(e){return this._methodWithReturn("getTrackSolo",{trackId:e})}anyTrackMute(){return this._methodWithReturn("anyTrackMute",{})}anyTrackSolo(){return this._methodWithReturn("anyTrackSolo",{})}setTrackEffects(e,t,n){return this._methodWithReturn("setTrackEffects",{trackID:e,preset:t,effectChain:n})}setTrackAutoPitch(e,t){return this._methodWithReturn("setTrackAutoPitch",{trackID:e,autoPitch:t})}getAutoPitchDataForNewTrackDeprecated(){return this._methodWithReturn("getAutoPitchDataForNewTrackDeprecated",{})}getTrackAutoPitchTargetMidi(e){return this._methodWithReturn("getTrackAutoPitchTargetMidi",{trackId:e})}setTrackAux(e,t){return this._methodWithReturn("setTrackAux",{trackID:e,aux:t})}setTrackInputSelection(e,t){return this._methodWithReturn("setTrackInputSelection",{trackID:e,selection:t})}getTrackInputSelection(e){return this._methodWithReturn("getTrackInputSelection",{trackID:e})}async getEffectChainForTrack(e){const t=await this._methodWithReturn("getEffectChainForTrack",{trackID:e});return t?new OR(t,this._port):null}async getLooperForTrack(e){const t=await this._methodWithReturn("getLooperForTrack",{trackID:e});return t?new MR(t,this._port):null}async getMultipadSamplerForTrack(e){const t=await this._methodWithReturn("getMultipadSamplerForTrack",{trackID:e});return t?new JR(t,this._port):null}async getArpeggiatorForTrack(e){const t=await this._methodWithReturn("getArpeggiatorForTrack",{trackID:e});return t?new qR(t,this._port):null}async getEffectMetadataManager(){const e=await this._methodWithReturn("getEffectMetadataManager",{});return e?new IR(e,this._port):null}setEffectMetadataManager(e){this._methodWithoutReturn("setEffectMetadataManager",{manager:e?e._addr:null})}setMonitoring(e){this._methodWithoutReturn("setMonitoring",{on:e})}setOutputNoisy(e){this._methodWithoutReturn("setOutputNoisy",{isNoisy:e})}isMonitoringEnabled(){return this._methodWithReturn("isMonitoringEnabled",{})}setPlayDuringCountIn(e){this._methodWithoutReturn("setPlayDuringCountIn",{enabled:e})}getPlayDuringCountIn(){return this._methodWithReturn("getPlayDuringCountIn",{})}async getMidiEditor(e,t){const n=await this._methodWithReturn("getMidiEditor",{trackID:e,rowMidiNotes:t});return n?new TR(n,this._port):null}async getPatternEditor(e){const t=await this._methodWithReturn("getPatternEditor",{trackID:e});return t?new CR(t,this._port):null}async getAutomationEditor(e){const t=await this._methodWithReturn("getAutomationEditor",{trackID:e});return t?new ER(t,this._port):null}setSelectionMovesAutomationFlag(e){this._methodWithoutReturn("setSelectionMovesAutomationFlag",{flag:e})}getSelectionMovesAutomationFlag(){return this._methodWithReturn("getSelectionMovesAutomationFlag",{})}addSequencerTrackDeprecated(e,t,n){return this._methodWithReturn("addSequencerTrackDeprecated",{trackName:e,soundbank:t,addDefaultRegions:n})}addSequencerRegionDeprecated(e,t,n){return this._methodWithReturn("addSequencerRegionDeprecated",{trackId:e,patternIndex:t,startPosition:n})}addDrumMachineTrack(e,t){return this._methodWithReturn("addDrumMachineTrack",{trackName:e,soundbank:t})}addDrumMachineRegion(e,t,n,o){return this._methodWithReturn("addDrumMachineRegion",{trackId:e,patternIndex:t,startPosition:n,endPosition:o})}canSetPattern(){return this._methodWithReturn("canSetPattern",{})}setPatternForSelection(e){return this._methodWithReturn("setPatternForSelection",{patternIndex:e})}setMidiRecordQuantization(e,t){this._methodWithoutReturn("setMidiRecordQuantization",{startQuant:e,durQuant:t})}setMidiQuantization(e){this._methodWithoutReturn("setMidiQuantization",{quantization:e})}setMidiMergeRecordings(e){this._methodWithoutReturn("setMidiMergeRecordings",{enabled:e})}getMidiMergeRecordings(){return this._methodWithReturn("getMidiMergeRecordings",{})}setRecordPlayerListener(e){e&&e.init(this._port),this._methodWithoutReturn("setRecordPlayerListener",{listener:e?e._addr:null,listener_id:e?e._id:null})}setWaveformSampleRate(e){this._methodWithoutReturn("setWaveformSampleRate",{ptsPerSec:e})}getWaveformForCurrentRecording(){return this._methodWithReturn("getWaveformForCurrentRecording",{})}getWaveformForSample(e,t,n){return n&&n.init(this._port),this._methodWithReturn("getWaveformForSample",{sampleId:e,ptsPerSec:t,listener:n?n._addr:null,listener_id:n?n._id:null})}getKeyDownState(e){return this._methodWithReturn("getKeyDownState",{trackID:e})}getInputMeterLevels(){return this._methodWithReturn("getInputMeterLevels",{})}resetInputMeterPeak(){this._methodWithoutReturn("resetInputMeterPeak",{})}getMasterMeterLevels(){return this._methodWithReturn("getMasterMeterLevels",{})}resetMasterMeterPeak(){this._methodWithoutReturn("resetMasterMeterPeak",{})}removeDuplicateSamples(e){return e&&e.init(this._port),this._methodWithReturn("removeDuplicateSamples",{listener:e?e._addr:null,listener_id:e?e._id:null})}setRegionFadeIn(e,t){return this._methodWithReturn("setRegionFadeIn",{regionId:e,fadeInDur:t})}getRegionFadeIn(e){return this._methodWithReturn("getRegionFadeIn",{regionId:e})}setRegionFadeOut(e,t){return this._methodWithReturn("setRegionFadeOut",{regionId:e,fadeOutDur:t})}getRegionFadeOut(e){return this._methodWithReturn("getRegionFadeOut",{regionId:e})}setRegionGain(e,t){return this._methodWithReturn("setRegionGain",{regionId:e,gain:t})}getRegionGain(e){return this._methodWithReturn("getRegionGain",{regionId:e})}setSelection(e){return this._methodWithReturn("setSelection",{regionIds:e})}getSelection(){return this._methodWithReturn("getSelection",{})}setRegionSelectionState(e,t){return this._methodWithReturn("setRegionSelectionState",{regionId:e,selected:t})}getRegionSelectionState(e){return this._methodWithReturn("getRegionSelectionState",{regionId:e})}selectRegionAt(e,t){return this._methodWithReturn("selectRegionAt",{trackId:e,time:t})}getRegionAt(e,t){return this._methodWithReturn("getRegionAt",{trackId:e,time:t})}selectRegionsInRange(e){return this._methodWithReturn("selectRegionsInRange",{selectionRange:e})}toggleRegionAt(e,t){return this._methodWithReturn("toggleRegionAt",{trackId:e,time:t})}isSelectionEmpty(){return this._methodWithReturn("isSelectionEmpty",{})}getSelectionSize(){return this._methodWithReturn("getSelectionSize",{})}getAudioSelectionSize(){return this._methodWithReturn("getAudioSelectionSize",{})}getMidiSelectionSize(){return this._methodWithReturn("getMidiSelectionSize",{})}getSelectionRange(){return this._methodWithReturn("getSelectionRange",{})}clearSelection(){return this._methodWithReturn("clearSelection",{})}selectAllRegions(){return this._methodWithReturn("selectAllRegions",{})}copySelectionToClipboard(){return this._methodWithReturn("copySelectionToClipboard",{})}isClipboardEmpty(){return this._methodWithReturn("isClipboardEmpty",{})}canPaste(e,t){return this._methodWithReturn("canPaste",{atTime:e,atTrackId:t})}pasteFromClipboard(e,t){return this._methodWithReturn("pasteFromClipboard",{atTime:e,atTrackId:t})}canMerge(){return this._methodWithReturn("canMerge",{})}mergeSelection(){return this._methodWithReturn("mergeSelection",{})}canSlice(){return this._methodWithReturn("canSlice",{})}sliceSelection(){return this._methodWithReturn("sliceSelection",{})}canDenoise(){return this._methodWithReturn("canDenoise",{})}denoiseSelection(){return this._methodWithReturn("denoiseSelection",{})}deleteSelection(){return this._methodWithReturn("deleteSelection",{})}getMoveLimits(){return this._methodWithReturn("getMoveLimits",{})}moveSelection(e,t){return this._methodWithReturn("moveSelection",{deltaTime:e,deltaTrackPos:t})}loopSelection(e){return this._methodWithReturn("loopSelection",{numLoops:e})}getSelectionResizeLimitsLeft(){return this._methodWithReturn("getSelectionResizeLimitsLeft",{})}getSelectionResizeLimitsRight(){return this._methodWithReturn("getSelectionResizeLimitsRight",{})}resizeSelectionLeft(e){return this._methodWithReturn("resizeSelectionLeft",{deltaTime:e})}resizeSelectionRight(e){return this._methodWithReturn("resizeSelectionRight",{deltaTime:e})}startEditingSession(){return this._methodWithReturn("startEditingSession",{})}finishEditingSession(){return this._methodWithReturn("finishEditingSession",{})}cancelEditingSession(){return this._methodWithReturn("cancelEditingSession",{})}timeStretchSelection(e){return this._methodWithReturn("timeStretchSelection",{deltaTime:e})}stretchSelection(e,t){return this._methodWithReturn("stretchSelection",{deltaTime:e,preservePitch:t})}setSelectionPlaybackRate(e){return this._methodWithReturn("setSelectionPlaybackRate",{rate:e})}getSelectionPlaybackRate(){return this._methodWithReturn("getSelectionPlaybackRate",{})}getSelectionPlaybackRateLimits(){return this._methodWithReturn("getSelectionPlaybackRateLimits",{})}setSelectionPitchShift(e){return this._methodWithReturn("setSelectionPitchShift",{shift:e})}getSelectionPitchShift(){return this._methodWithReturn("getSelectionPitchShift",{})}setSelectionGain(e){return this._methodWithReturn("setSelectionGain",{gain:e})}canReverse(){return this._methodWithReturn("canReverse",{})}reverseSelectionPlaybackDirection(){return this._methodWithReturn("reverseSelectionPlaybackDirection",{})}addRegion(e){return this._methodWithReturn("addRegion",{region:e})}rememberCurrentState(e){return this._methodWithReturn("rememberCurrentState",{stateName:e})}forgetState(e){return this._methodWithReturn("forgetState",{stateName:e})}getRememberedState(e){return this._methodWithReturn("getRememberedState",{stateName:e})}getChangeSet(e){return this._methodWithReturn("getChangeSet",{stateName:e})}freezeTrack(e,t){return t&&t.init(this._port),this._methodWithReturn("freezeTrack",{trackId:e,listener:t?t._addr:null,listener_id:t?t._id:null})}unfreezeTrack(e){return this._methodWithReturn("unfreezeTrack",{trackId:e})}setStickyFreeze(e){this._methodWithoutReturn("setStickyFreeze",{sticky:e})}cleanupCache(){this._methodWithoutReturn("cleanupCache",{})}estimateKey(e,t){return t&&t.init(this._port),this._methodWithReturn("estimateKey",{trackOrRegionId:e,listener:t?t._addr:null,listener_id:t?t._id:null})}exportAsWav(e,t,n,o){return o&&o.init(this._port),this._methodWithReturn("exportAsWav",{wavPath:e,trackOrRegionId:t,maxExportDurSecs:n,listener:o?o._addr:null,listener_id:o?o._id:null})}exportAsMidi(e,t,n){return this._methodWithReturn("exportAsMidi",{midiPath:e,trackOrRegionId:t,soundbanksJson:n})}}class DR extends bR{constructor(e,t){super(e,t,"Transport")}play(){this._methodWithoutReturn("play",{})}stop(){this._methodWithoutReturn("stop",{})}back(){this._methodWithoutReturn("back",{})}setTempo(e){return this._methodWithReturn("setTempo",{newTempo:e})}getTempo(){return this._methodWithReturn("getTempo",{})}getTicksPerQ(){return this._methodWithReturn("getTicksPerQ",{})}setTimeSignature(e){return this._methodWithReturn("setTimeSignature",{s:e})}getTimeSignature(){return this._methodWithReturn("getTimeSignature",{})}setKeySignature(e){return this._methodWithReturn("setKeySignature",{s:e})}getKeySignature(){return this._methodWithReturn("getKeySignature",{})}setSnapToGrid(e){this._methodWithoutReturn("setSnapToGrid",{snap:e})}getSnapToGrid(){return this._methodWithReturn("getSnapToGrid",{})}getQuantizedPosition(e){return this._methodWithReturn("getQuantizedPosition",{pos:e})}setNumCountInBars(e){this._methodWithoutReturn("setNumCountInBars",{numBars:e})}getNumCountInBars(){return this._methodWithReturn("getNumCountInBars",{})}getCountInPosition(){return this._methodWithReturn("getCountInPosition",{})}getCountInProgress(){return this._methodWithReturn("getCountInProgress",{})}startRecording(e){return this._methodWithReturn("startRecording",{startTimeTicks:e})}stopRecording(){this._methodWithoutReturn("stopRecording",{})}isRecording(){return this._methodWithReturn("isRecording",{})}isPlaying(){return this._methodWithReturn("isPlaying",{})}setPlayPositionTicks(e){this._methodWithoutReturn("setPlayPositionTicks",{ticks:e})}getPlayPositionTicks(){return this._methodWithReturn("getPlayPositionTicks",{})}setMaxSongDuration(e){this._methodWithoutReturn("setMaxSongDuration",{maxSeconds:e})}setListener(e){e&&e.init(this._port),this._methodWithoutReturn("setListener",{listener:e?e._addr:null,listener_id:e?e._id:null})}clearListener(){this._methodWithoutReturn("clearListener",{})}setCycleState(e){this._methodWithoutReturn("setCycleState",{enable:e})}getCycleState(){return this._methodWithReturn("getCycleState",{})}setCycleStartTime(e){this._methodWithoutReturn("setCycleStartTime",{cycleStartTicks:e})}getCycleStartTime(){return this._methodWithReturn("getCycleStartTime",{})}setCycleEndTime(e){this._methodWithoutReturn("setCycleEndTime",{cycleEndTicks:e})}getCycleEndTime(){return this._methodWithReturn("getCycleEndTime",{})}secsToTicks(e){return this._methodWithReturn("secsToTicks",{secs:e})}ticksToSecs(e){return this._methodWithReturn("ticksToSecs",{ticks:e})}}class NR extends bR{constructor(e,t){super(e,t,"Tuner")}NO_STRING=-1;NO_PITCH=-1;setBypass(e){this._methodWithoutReturn("setBypass",{bypass:e})}async audioInput(){const e=await this._methodWithReturn("audioInput",{});return e?new wR(e,this._port):null}async audioOutput(){const e=await this._methodWithReturn("audioOutput",{});return e?new yR(e,this._port):null}reset(){this._methodWithoutReturn("reset",{})}clearEstimate(){this._methodWithoutReturn("clearEstimate",{})}setTuning(e){this._methodWithoutReturn("setTuning",{tuning:e})}getTuning(){return this._methodWithReturn("getTuning",{})}setTargetString(e,t){this._methodWithoutReturn("setTargetString",{stringIndex:e,playNote:t})}getTargetString(){return this._methodWithReturn("getTargetString",{})}setNoteDuration(e){this._methodWithoutReturn("setNoteDuration",{noteDurSecs:e})}getNoteDuration(){return this._methodWithReturn("getNoteDuration",{})}getDetectedNote(){return this._methodWithReturn("getDetectedNote",{})}setEnabled(e){this._methodWithoutReturn("setEnabled",{enable:e})}isEnabled(){return this._methodWithReturn("isEnabled",{})}getListOfTunings(){return this._methodWithReturn("getListOfTunings",{})}getListOfInstrumentNames(){return this._methodWithReturn("getListOfInstrumentNames",{})}getListOfTuningsForInstrument(e){return this._methodWithReturn("getListOfTuningsForInstrument",{instrumentName:e})}setInTuneSoundEnabled(e){this._methodWithoutReturn("setInTuneSoundEnabled",{enabled:e})}getSmoothPitchMidi(){return this._methodWithReturn("getSmoothPitchMidi",{})}isTracking(){return this._methodWithReturn("isTracking",{})}}class UR extends bR{constructor(e,t){super(e,t,"Metronome")}BEAT_STATE_DISABLED=0;BEAT_STATE_UNACCENTED=1;BEAT_STATE_ACCENTED=2;play(){this._methodWithoutReturn("play",{})}stop(){this._methodWithoutReturn("stop",{})}isPlaying(){return this._methodWithReturn("isPlaying",{})}getPosition(){return this._methodWithReturn("getPosition",{})}setVolume(e){this._methodWithoutReturn("setVolume",{vol:e})}getVolume(){return this._methodWithReturn("getVolume",{})}setTimeSignature(e){return this._methodWithReturn("setTimeSignature",{timeSig:e})}getTimeSignature(){return this._methodWithReturn("getTimeSignature",{})}setStartingBeat(e){return this._methodWithReturn("setStartingBeat",{startingBeat:e})}getStartingBeat(){return this._methodWithReturn("getStartingBeat",{})}setBeatState(e,t){return this._methodWithReturn("setBeatState",{beatIndex:e,beatState:t})}changeBeatState(e){return this._methodWithReturn("changeBeatState",{beatIndex:e})}getBeatState(e){return this._methodWithReturn("getBeatState",{beatIndex:e})}setSubdivsPerBeat(e){return this._methodWithReturn("setSubdivsPerBeat",{subdivsPerBeat:e})}getSubdivsPerBeat(){return this._methodWithReturn("getSubdivsPerBeat",{})}setBeatSubdivStates(e){return this._methodWithReturn("setBeatSubdivStates",{subdivStates:e})}getBeatSubdivStates(){return this._methodWithReturn("getBeatSubdivStates",{})}getBeatSubdivState(e){return this._methodWithReturn("getBeatSubdivState",{subdivIndex:e})}toggleBeatSubdivState(e){return this._methodWithReturn("toggleBeatSubdivState",{subdiv:e})}setBpm(e){return this._methodWithReturn("setBpm",{bpm:e})}getBpm(){return this._methodWithReturn("getBpm",{})}onTempoTouch(e){this._methodWithoutReturn("onTempoTouch",{increment:e})}onTempoRelease(){this._methodWithoutReturn("onTempoRelease",{})}getTempoName(){return this._methodWithReturn("getTempoName",{})}setUseBeatUnitForBpm(e){this._methodWithoutReturn("setUseBeatUnitForBpm",{useBeatUnit:e})}getUseBeatUnitForBpm(){return this._methodWithReturn("getUseBeatUnitForBpm",{})}tapTempo(e){return this._methodWithReturn("tapTempo",{timestamp:e})}getTapCount(){return this._methodWithReturn("getTapCount",{})}setTapTempoAutoPlay(e){this._methodWithoutReturn("setTapTempoAutoPlay",{autoPlay:e})}getTapTempoAutoPlay(){return this._methodWithReturn("getTapTempoAutoPlay",{})}setTapTempoMakeSound(e){this._methodWithoutReturn("setTapTempoMakeSound",{makeSound:e})}getTapTempoMakeSound(){return this._methodWithReturn("getTapTempoMakeSound",{})}setMetronomeOnDuringCountIn(e){this._methodWithoutReturn("setMetronomeOnDuringCountIn",{enable:e})}loadCustomSounds(e,t,n,o){return this._methodWithReturn("loadCustomSounds",{baseFileNames:e,directory:t,fileNameSuffixes:n,displayNames:o})}getNumSounds(){return this._methodWithReturn("getNumSounds",{})}getSoundIndex(){return this._methodWithReturn("getSoundIndex",{})}setSoundIndex(e){return this._methodWithReturn("setSoundIndex",{soundIndex:e})}changeSound(){this._methodWithoutReturn("changeSound",{})}getSoundDisplayName(){return this._methodWithReturn("getSoundDisplayName",{})}getState(){return this._methodWithReturn("getState",{})}setState(e){return this._methodWithReturn("setState",{jsonStr:e})}async audioOutput(){const e=await this._methodWithReturn("audioOutput",{});return e?new yR(e,this._port):null}setTransport(e){this._methodWithoutReturn("setTransport",{transport:e?e._addr:null})}}class FR extends bR{constructor(e,t){super(e,t,"RotationTracker")}start(e,t){this._methodWithoutReturn("start",{startX:e,startY:t})}update(e,t){return this._methodWithReturn("update",{currentX:e,currentY:t})}setCurrentAngle(e){this._methodWithoutReturn("setCurrentAngle",{angle:e})}getCurrentAngle(){return this._methodWithReturn("getCurrentAngle",{})}setPivotPoint(e,t){this._methodWithoutReturn("setPivotPoint",{x:e,y:t})}setAngleLimits(e,t){this._methodWithoutReturn("setAngleLimits",{minAngle:e,maxAngle:t})}setGearing(e){this._methodWithoutReturn("setGearing",{gearing:e})}setUseDegrees(e){this._methodWithoutReturn("setUseDegrees",{useDegreesForAngles:e})}setMinTrackingRadius(e){this._methodWithoutReturn("setMinTrackingRadius",{minTrackingRadius:e})}getDistanceToPivot(e,t){return this._methodWithReturn("getDistanceToPivot",{x:e,y:t})}}class BR extends bR{constructor(e,t){super(e,t,"WavReader")}open(e){return this._methodWithReturn("open",{wavPath:e})}openFile(e){return this._methodWithReturn("openFile",{wavPath:e})}close(){this._methodWithoutReturn("close",{})}getSampleRate(){return this._methodWithReturn("getSampleRate",{})}getNumChannels(){return this._methodWithReturn("getNumChannels",{})}getNumBits(){return this._methodWithReturn("getNumBits",{})}getNumFrames(){return this._methodWithReturn("getNumFrames",{})}getDuration(){return this._methodWithReturn("getDuration",{})}getAudio(e,t){return this._methodWithReturn("getAudio",{fromFrame:e,numFrames:t})}read(e,t,n,o,r){r&&r.init(this._port),this._methodWithoutReturn("read",{from:e,length:t,fade:n,chunkSizeFrames:o,listener:r?r._addr:null,listener_id:r?r._id:null})}}class WR extends bR{constructor(e,t){super(e,t,"WavWriter")}open(e,t,n){return this._methodWithReturn("open",{path:e,sr:t,numChan:n})}openWithFormat(e,t,n,o,r){return this._methodWithReturn("openWithFormat",{path:e,sr:t,numChan:n,bitsPerSample:o,useFloat:r})}writeAudio(e){return this._methodWithReturn("writeAudio",{frames:e})}writeBytes(e){return this._methodWithReturn("writeBytes",{chunk:e})}close(){this._methodWithoutReturn("close",{})}}class VR extends bR{constructor(e,t){super(e,t,"AutoDrummer")}loadDrummer(e){this._methodWithoutReturn("loadDrummer",{drummerData:e})}setComplexity(e,t){this._methodWithoutReturn("setComplexity",{componentID:e,value:t})}setLoudness(e,t){this._methodWithoutReturn("setLoudness",{componentID:e,value:t})}setEnabled(e,t){this._methodWithoutReturn("setEnabled",{componentID:e,value:t})}playFill(e){return this._methodWithReturn("playFill",{fillName:e})}isFillPlaying(){return this._methodWithReturn("isFillPlaying",{})}setSwing(e){this._methodWithoutReturn("setSwing",{swing:e})}getSwing(){return this._methodWithReturn("getSwing",{})}setTempo(e){this._methodWithoutReturn("setTempo",{tempo:e})}async midiOutput(){const e=await this._methodWithReturn("midiOutput",{});return e?new $R(e,this._port):null}}let qR=class extends bR{constructor(e,t){super(e,t,"Arpeggiator")}setBypass(e){this._methodWithoutReturn("setBypass",{bypass:e})}async midiInput(){const e=await this._methodWithReturn("midiInput",{});return e?new kR(e,this._port):null}async midiOutput(){const e=await this._methodWithReturn("midiOutput",{});return e?new $R(e,this._port):null}setStyle(e){this._methodWithoutReturn("setStyle",{style:e})}setSync(e){this._methodWithoutReturn("setSync",{sync:e})}setSnapToGrid(e){this._methodWithoutReturn("setSnapToGrid",{snapToGrid:e})}setRateInSec(e){this._methodWithoutReturn("setRateInSec",{rate:e})}setRateInBeatTime(e){this._methodWithoutReturn("setRateInBeatTime",{rate:e})}setGate(e){this._methodWithoutReturn("setGate",{gate:e})}setRetrigger(e){this._methodWithoutReturn("setRetrigger",{retrigger:e})}setRetriggerInterval(e){this._methodWithoutReturn("setRetriggerInterval",{interval:e})}setSwing(e){this._methodWithoutReturn("setSwing",{swing:e})}setHold(e){this._methodWithoutReturn("setHold",{hold:e})}setOffset(e){this._methodWithoutReturn("setOffset",{offset:e})}setRepeats(e){this._methodWithoutReturn("setRepeats",{repeats:e})}setScale(e){this._methodWithoutReturn("setScale",{scale:e})}setKey(e){this._methodWithoutReturn("setKey",{key:e})}setTempo(e){this._methodWithoutReturn("setTempo",{tempo:e})}setTransposeSteps(e){this._methodWithoutReturn("setTransposeSteps",{steps:e})}setTransposeDistance(e){this._methodWithoutReturn("setTransposeDistance",{distance:e})}};class zR extends bR{constructor(e,t){super(e,t,"MidiReader")}close(){this._methodWithoutReturn("close",{})}isValid(){return this._methodWithReturn("isValid",{})}getPath(){return this._methodWithReturn("getPath",{})}getTicksPerQuarter(){return this._methodWithReturn("getTicksPerQuarter",{})}getPianorollScore(){return this._methodWithReturn("getPianorollScore",{})}quantize(e,t,n,o){return this._methodWithReturn("quantize",{resultPath:e,snapTo:t,bpm:n,startPositionSec:o})}}class HR extends bR{constructor(e,t){super(e,t,"MasteringService")}async audioOutput(){const e=await this._methodWithReturn("audioOutput",{});return e?new yR(e,this._port):null}initialize(e,t,n){return this._methodWithReturn("initialize",{sr:e,workDirs:t,metadataManager:n?n._addr:null})}load(e){return this._methodWithReturn("load",{audioFilePath:e})}unload(){this._methodWithoutReturn("unload",{})}setPreset(e){return this._methodWithReturn("setPreset",{presetSlug:e})}setBypass(e){this._methodWithoutReturn("setBypass",{bypass:e})}getDuration(){return this._methodWithReturn("getDuration",{})}getCurrentTime(){return this._methodWithReturn("getCurrentTime",{})}setCurrentTime(e){this._methodWithoutReturn("setCurrentTime",{timeSecs:e})}play(){return this._methodWithReturn("play",{})}pause(){this._methodWithoutReturn("pause",{})}isPaused(){return this._methodWithReturn("isPaused",{})}setCycleState(e){this._methodWithoutReturn("setCycleState",{enable:e})}getCycleState(){return this._methodWithReturn("getCycleState",{})}setCycleStartTime(e){this._methodWithoutReturn("setCycleStartTime",{cycleStartSecs:e})}getCycleStartTime(){return this._methodWithReturn("getCycleStartTime",{})}setCycleEndTime(e){this._methodWithoutReturn("setCycleEndTime",{cycleEndSecs:e})}getCycleEndTime(){return this._methodWithReturn("getCycleEndTime",{})}}class GR extends bR{constructor(e,t){super(e,t,"VASynth")}loadPreset(e){return this._methodWithReturn("loadPreset",{fileName:e})}async midiInput(){const e=await this._methodWithReturn("midiInput",{});return e?new kR(e,this._port):null}async audioOutput(){const e=await this._methodWithReturn("audioOutput",{});return e?new yR(e,this._port):null}}class KR extends bR{constructor(e,t){super(e,t,"FMSynth")}loadPreset(e){return this._methodWithReturn("loadPreset",{fileName:e})}async midiInput(){const e=await this._methodWithReturn("midiInput",{});return e?new kR(e,this._port):null}async audioOutput(){const e=await this._methodWithReturn("audioOutput",{});return e?new yR(e,this._port):null}}class YR extends bR{constructor(e,t){super(e,t,"SamplerPad")}getId(){return this._methodWithReturn("getId",{})}setVolume(e,t){this._methodWithoutReturn("setVolume",{volume:e,createUndoPoint:t})}resetVolume(){this._methodWithoutReturn("resetVolume",{})}getVolume(){return this._methodWithReturn("getVolume",{})}getVolumeDisplayValue(){return this._methodWithReturn("getVolumeDisplayValue",{})}setPan(e,t){this._methodWithoutReturn("setPan",{pan:e,createUndoPoint:t})}resetPan(){this._methodWithoutReturn("resetPan",{})}getPan(){return this._methodWithReturn("getPan",{})}getPanDisplayValue(){return this._methodWithReturn("getPanDisplayValue",{})}setTone(e,t){this._methodWithoutReturn("setTone",{tone:e,createUndoPoint:t})}resetTone(){this._methodWithoutReturn("resetTone",{})}getTone(){return this._methodWithReturn("getTone",{})}getToneDisplayValue(){return this._methodWithReturn("getToneDisplayValue",{})}setPitchShift(e,t){this._methodWithoutReturn("setPitchShift",{shift:e,createUndoPoint:t})}resetPitchShift(){this._methodWithoutReturn("resetPitchShift",{})}getPitchShift(){return this._methodWithReturn("getPitchShift",{})}getPitchShiftDisplayValue(){return this._methodWithReturn("getPitchShiftDisplayValue",{})}setLaunchMode(e){this._methodWithoutReturn("setLaunchMode",{mode:e})}getLaunchMode(){return this._methodWithReturn("getLaunchMode",{})}setMutexGroup(e){this._methodWithoutReturn("setMutexGroup",{groupID:e})}getMutexGroup(){return this._methodWithReturn("getMutexGroup",{})}setColor(e){this._methodWithoutReturn("setColor",{color:e})}getColor(){return this._methodWithReturn("getColor",{})}getSampleLength(){return this._methodWithReturn("getSampleLength",{})}setStartTime(e,t){this._methodWithoutReturn("setStartTime",{startTime:e,createUndoPoint:t})}getStartTime(){return this._methodWithReturn("getStartTime",{})}setEndTime(e,t){this._methodWithoutReturn("setEndTime",{endTime:e,createUndoPoint:t})}getEndTime(){return this._methodWithReturn("getEndTime",{})}setAttackTime(e,t){this._methodWithoutReturn("setAttackTime",{time:e,createUndoPoint:t})}resetAttackTime(){this._methodWithoutReturn("resetAttackTime",{})}getAttackTime(){return this._methodWithReturn("getAttackTime",{})}getAttackTimeDisplayValue(){return this._methodWithReturn("getAttackTimeDisplayValue",{})}setReleaseTime(e,t){this._methodWithoutReturn("setReleaseTime",{time:e,createUndoPoint:t})}resetReleaseTime(){this._methodWithoutReturn("resetReleaseTime",{})}getReleaseTime(){return this._methodWithReturn("getReleaseTime",{})}getReleaseTimeDisplayValue(){return this._methodWithReturn("getReleaseTimeDisplayValue",{})}crop(){return this._methodWithReturn("crop",{})}normalize(){return this._methodWithReturn("normalize",{})}reverse(){return this._methodWithReturn("reverse",{})}getWaveform(e,t){return this._methodWithReturn("getWaveform",{numPoints:e,cropped:t})}getWaveformId(e,t){return this._methodWithReturn("getWaveformId",{numPoints:e,cropped:t})}play(){this._methodWithoutReturn("play",{})}stop(){this._methodWithoutReturn("stop",{})}forceStop(){this._methodWithoutReturn("forceStop",{})}isPlaying(){return this._methodWithReturn("isPlaying",{})}getPlayPos(){return this._methodWithReturn("getPlayPos",{})}canUndo(){return this._methodWithReturn("canUndo",{})}canRedo(){return this._methodWithReturn("canRedo",{})}undo(){return this._methodWithReturn("undo",{})}redo(){return this._methodWithReturn("redo",{})}clearUndoStack(){this._methodWithoutReturn("clearUndoStack",{})}playStartedSinceLastCheck(){return this._methodWithReturn("playStartedSinceLastCheck",{})}getSlices(e){return this._methodWithReturn("getSlices",{maxNumSlices:e})}}class JR extends bR{constructor(e,t){super(e,t,"MultipadSampler")}setListener(e){e&&e.init(this._port),this._methodWithoutReturn("setListener",{listener:e?e._addr:null,listener_id:e?e._id:null})}setSampleDurationLimit(e){this._methodWithoutReturn("setSampleDurationLimit",{limit:e})}loadSample(e,t){return this._methodWithReturn("loadSample",{sampleId:e,slot:t})}startRecording(e){return this._methodWithReturn("startRecording",{slot:e})}stopRecording(){this._methodWithoutReturn("stopRecording",{})}isRecording(){return this._methodWithReturn("isRecording",{})}forceStopAllPads(){this._methodWithoutReturn("forceStopAllPads",{})}setAutoOnsetDetection(e){this._methodWithoutReturn("setAutoOnsetDetection",{enabled:e})}getAutoOnsetDetection(){return this._methodWithReturn("getAutoOnsetDetection",{})}setDenoiseAfterRecording(e){this._methodWithoutReturn("setDenoiseAfterRecording",{enabled:e})}getDenoiseAfterRecording(){return this._methodWithReturn("getDenoiseAfterRecording",{})}setKitName(e){this._methodWithoutReturn("setKitName",{name:e})}getKitName(){return this._methodWithReturn("getKitName",{})}getKit(){return this._methodWithReturn("getKit",{})}loadKit(e){return this._methodWithReturn("loadKit",{kit:e})}removePadFrom(e){return this._methodWithReturn("removePadFrom",{slot:e})}async getPadAt(e){const t=await this._methodWithReturn("getPadAt",{slot:e});return t?new YR(t,this._port):null}async getAllPads(){return e=await this._methodWithReturn("getAllPads",{}),t=this._port,e.forEach(((e,n,o)=>{o.set(n,new YR(e,t))})),e;var e,t}copyPad(e,t){return this._methodWithReturn("copyPad",{from:e,to:t})}renderPadToWav(e,t){return this._methodWithReturn("renderPadToWav",{slot:e,path:t})}initialize(e){this._methodWithoutReturn("initialize",{sampleStorage:e})}async midiInput(){const e=await this._methodWithReturn("midiInput",{});return e?new kR(e,this._port):null}async audioInput(){const e=await this._methodWithReturn("audioInput",{});return e?new wR(e,this._port):null}async audioOutput(){const e=await this._methodWithReturn("audioOutput",{});return e?new yR(e,this._port):null}}class XR extends bR{constructor(e,t){super(e,t,"Soundbank")}}class ZR extends bR{constructor(e,t){super(e,t,"MIDISampleSynth")}setSoundbank(e){this._methodWithoutReturn("setSoundbank",{soundbank:e?e._addr:null})}async midiInput(){const e=await this._methodWithReturn("midiInput",{});return e?new kR(e,this._port):null}async audioOutput(){const e=await this._methodWithReturn("audioOutput",{});return e?new yR(e,this._port):null}}class QR extends bR{constructor(e,t){super(e,t,"SineToneGenerator")}async audioOutput(){const e=await this._methodWithReturn("audioOutput",{});return e?new yR(e,this._port):null}}class eA extends bR{constructor(e,t){super(e,t,"AudioRecordPlayer")}async audioInput(){const e=await this._methodWithReturn("audioInput",{});return e?new wR(e,this._port):null}async audioOutput(){const e=await this._methodWithReturn("audioOutput",{});return e?new yR(e,this._port):null}initialize(e){this._methodWithoutReturn("initialize",{sampleDir:e})}setMonitoring(e){this._methodWithoutReturn("setMonitoring",{monitoring:e})}setArmed(e){this._methodWithoutReturn("setArmed",{armed:e})}addRegion(e,t){return this._methodWithReturn("addRegion",{region:e,tempo:t})}changeRegion(e,t){return this._methodWithReturn("changeRegion",{region:e,tempo:t})}deleteRegion(e){return this._methodWithReturn("deleteRegion",{id:e})}deleteAllRegions(){this._methodWithoutReturn("deleteAllRegions",{})}setRecordPlayerListener(e){e&&e.init(this._port),this._methodWithoutReturn("setRecordPlayerListener",{listener:e?e._addr:null,listener_id:e?e._id:null})}setLatencyFix(e){this._methodWithoutReturn("setLatencyFix",{latencySamples:e})}}class tA extends bR{constructor(e,t){super(e,t,"MIDIRecordPlayer")}async midiInput(){const e=await this._methodWithReturn("midiInput",{});return e?new kR(e,this._port):null}async midiOutput(){const e=await this._methodWithReturn("midiOutput",{});return e?new $R(e,this._port):null}initialize(e){this._methodWithoutReturn("initialize",{sampleDir:e})}setMonitoring(e){this._methodWithoutReturn("setMonitoring",{monitoring:e})}setArmed(e){this._methodWithoutReturn("setArmed",{armed:e})}addRegion(e,t){return this._methodWithReturn("addRegion",{region:e,tempo:t})}changeRegion(e,t){return this._methodWithReturn("changeRegion",{region:e,tempo:t})}deleteRegion(e){return this._methodWithReturn("deleteRegion",{id:e})}deleteAllRegions(){this._methodWithoutReturn("deleteAllRegions",{})}setRecordPlayerListener(e){e&&e.init(this._port),this._methodWithoutReturn("setRecordPlayerListener",{listener:e?e._addr:null,listener_id:e?e._id:null})}setQuantization(e){this._methodWithoutReturn("setQuantization",{quantization:e})}setRecordQuantization(e,t){this._methodWithoutReturn("setRecordQuantization",{startQuant:e,durQuant:t})}}class nA extends bR{constructor(e,t){super(e,t,"AudioLatencyDetector")}async audioInput(){const e=await this._methodWithReturn("audioInput",{});return e?new wR(e,this._port):null}async audioOutput(){const e=await this._methodWithReturn("audioOutput",{});return e?new yR(e,this._port):null}run(e,t){return this._methodWithReturn("run",{gain:e,delay:t})}runMultipleMeasurements(e,t,n){return n&&n.init(this._port),this._methodWithReturn("runMultipleMeasurements",{numMeasurements:e,gain:t,listener:n?n._addr:null,listener_id:n?n._id:null})}}class oA extends bR{constructor(e,t){super(e,t,"VisualEq")}setFftSize(e){this._methodWithoutReturn("setFftSize",{n:e})}getNumDisplayPoints(){return this._methodWithReturn("getNumDisplayPoints",{})}getFrequencyResponseAmplitude(e){return this._methodWithReturn("getFrequencyResponseAmplitude",{numPoints:e})}getAmplitudeSpectrumLogFreq(){return this._methodWithReturn("getAmplitudeSpectrumLogFreq",{})}getLogSpacedFreqsNorm(){return this._methodWithReturn("getLogSpacedFreqsNorm",{})}getFrequencyGridLocsNorm(e){return this._methodWithReturn("getFrequencyGridLocsNorm",{freqs:e})}getAmplitudeGridLocsNorm(e){return this._methodWithReturn("getAmplitudeGridLocsNorm",{amps:e})}getNumFilters(){return this._methodWithReturn("getNumFilters",{})}getFilterState(e){return this._methodWithReturn("getFilterState",{index:e})}setFilterState(e,t){return this._methodWithReturn("setFilterState",{index:e,state:t})}}const rA={Unspecified:"Unspecified",OpenSL:"OpenSL",AAudio:"AAudio"};Object.freeze(rA);const iA={Started:"Started",Stopped:"Stopped",Format:"Format"};Object.freeze(iA);const aA={Interrupted:"Interrupted"};Object.freeze(aA);const sA={Stereo:"Stereo",MonoLeft:"MonoLeft",MonoRight:"MonoRight",LeftMinusRight:"LeftMinusRight",Mono:"Mono"};Object.freeze(sA);const lA={LiteLimitSpeed:"LiteLimitSpeed",LiteLimitPitchShift:"LiteLimitPitchShift",LiteLimitDuration:"LiteLimitDuration"};Object.freeze(lA);const cA={Audio:"Audio",Midi:"Midi",Looper:"Looper",Aux:"Aux"};Object.freeze(cA);const uA={MultipadSampler:"MultipadSampler",Unknown:"Unknown"};Object.freeze(uA);const dA={ToNone:"ToNone",To8Bar:"To8Bar",To4Bar:"To4Bar",To2Bar:"To2Bar",To1Bar:"To1Bar",To2nd:"To2nd",To4thD:"To4thD",To2ndT:"To2ndT",To4th:"To4th",To8thD:"To8thD",To4thT:"To4thT",To8th:"To8th",To16thD:"To16thD",To8thT:"To8thT",To16th:"To16th",To32ndD:"To32ndD",To16thT:"To16thT",To32nd:"To32nd",To64thD:"To64thD",To32ndT:"To32ndT",To64th:"To64th",To128thD:"To128thD",To64thT:"To64thT",To128th:"To128th"};Object.freeze(dA);const pA={Trigger:"Trigger",Gate:"Gate",Toggle:"Toggle"};Object.freeze(pA);const mA={Starting:"Starting",Stopping:"Stopping",Playing:"Playing",Stopped:"Stopped"};Object.freeze(mA);const fA={LEFT:"LEFT",RIGHT:"RIGHT",STEREO:"STEREO",UNSPECIFIED:"UNSPECIFIED"};Object.freeze(fA);const hA={VOLUME:"VOLUME",PAN:"PAN",FLOAT:"FLOAT",ENUM:"ENUM",BOOL:"BOOL"};Object.freeze(hA);const gA={Kick:"Kick",Snare:"Snare",Claps:"Claps",Hihats:"Hihats",Cymbals:"Cymbals",Toms:"Toms",Tambourine:"Tambourine",Bells:"Bells",Bongos:"Bongos",Shakers:"Shakers",Unknown:"Unknown"};Object.freeze(gA);const vA={Up:"Up",Down:"Down",UpDown:"UpDown",DownUp:"DownUp",UpAndDown:"UpAndDown",DownAndUp:"DownAndUp",Converge:"Converge",Diverge:"Diverge",ConAndDiverge:"ConAndDiverge",PinkyUp:"PinkyUp",PinkyUpDown:"PinkyUpDown",ThumbUp:"ThumbUp",ThumbUpDown:"ThumbUpDown",Ordered:"Ordered",Repeat:"Repeat",Random:"Random",RandomOther:"RandomOther",RandomOnce:"RandomOnce"};Object.freeze(vA);const bA={Off:"Off",Note:"Note",Beat:"Beat"};Object.freeze(bA);const yA={Major:"Major",Minor:"Minor",MajorPentatonic:"MajorPentatonic",MinorPentatonic:"MinorPentatonic",Chromatic:"Chromatic",MajorBlues:"MajorBlues",MinorBlues:"MinorBlues",HarmonicMajor:"HarmonicMajor",HarmonicMinor:"HarmonicMinor",Undefined:"Undefined"};Object.freeze(yA);const wA={C:"C",CsDb:"CsDb",D:"D",DsEb:"DsEb",E:"E",F:"F",FsGb:"FsGb",G:"G",GsAb:"GsAb",A:"A",AsBb:"AsBb",BCb:"BCb",Undefined:"Undefined"};Object.freeze(wA);const $A={FileDoesNotExist:"FileDoesNotExist",CannotDecodeFile:"CannotDecodeFile",AudioLengthIsZero:"AudioLengthIsZero",AudioIsSilent:"AudioIsSilent"};Object.freeze($A);const kA={Gate:"Gate",OneShot:"OneShot",Loop:"Loop"};Object.freeze(kA);const SA=Object.freeze(Object.defineProperty({__proto__:null,ADComponentID:gA,ArpeggiatorRetrigger:bA,ArpeggiatorStyle:vA,AudioApi:rA,AudioEngineWorkletNode:vR,AudioIoError:aA,AudioIoStateChange:iA,AudioMode:sA,AutomationType:hA,ClipStatus:mA,InputSelection:fA,LaunchMode:pA,ListenerBase:class{constructor(){this._addr=void 0,this._port=void 0,this._id=crypto.randomUUID(),this.fn=e=>{e.data.id===this._id&&(e.stopPropagation(),"addr"in e.data?this._addr=e.data.addr:"method"in e.data&&this[e.data.method](...Object.values(e.data.args??{})))}}init(e){this._port=e,this._port.addEventListener("message",this.fn)}delete(){this._port&&(this._port.removeEventListener("message",this.fn),this._port.postMessage({command:"deleteAddr",args:{addr:this._addr}}),this._addr=void 0,this._port=void 0)}},LiteLimitType:lA,MasteringServiceLoadError:$A,PadLaunchMode:kA,SamplerType:uA,Scale:yA,Snap:dA,Tonic:wA,TrackType:cA},Symbol.toStringTag,{value:"Module"})),_A="arpeggiatorTrackSettingsKey",PA=Gi({get(){const e=localStorage.getItem(_A)||"{}";return new Map(Object.entries(JSON.parse(e)))},set:ay((e=>{const t=Array.from(e.entries()).slice(-1e3);localStorage.setItem(_A,JSON.stringify(Object.fromEntries(t)??{}))}),300)}),MA=Vt(PA.value),TA={enabled:!1,swing:0,engaged:!0,rate:dA.To16th,noteLength:.5,style:vA.Up,minimised:!0};function CA(e){const t=MA.value.get(e)??{};return{enabled:t.enabled??TA.enabled,swing:t.swing??TA.swing,engaged:t.engaged??TA.engaged,rate:t.rate??TA.rate,noteLength:t.noteLength??TA.noteLength,style:t.style??TA.style,minimised:t.minimised??TA.minimised}}const EA=Gi({get:()=>CA(jS.value),set(e){const t=new Map(MA.value);t.delete(jS.value),t.set(jS.value,e),MA.value=t,PA.value=t}}),IA=function(){return{subscribe:function(t){const n=t.$on(jT,e);return()=>{n()}},onArpeggiatorEnabled:function(){$p("studio_arpeggiator_enabled")}};function e(){EA.value.enabled&&$p("arpeggiator_recording_finished")}}(),RA={arpeggiator:"Arpeggiator",rate:"Rate",noteLength:"Note Length",tooltip:"Arpeggiator plays incoming notes back in a sequence, based on the selected style. Rate controls how fast the notes are played, note length adjusts the duration of each note. Add groove to the sequence with the swing slider.",swing:"Swing"},AA=Object.freeze(Object.defineProperty({__proto__:null,arpeggiatorAnalytics:IA,arpeggiatorContent:RA,arpeggiatorSettings:EA,getArpeggiatorSettings:CA,trackHasArpeggiator:function(e){return CA(e.id).enabled}},Symbol.toStringTag,{value:"Module"}));function xA(){let e="en";for(const t of navigator.languages)if(t.startsWith("en")){e=t;break}return e}function LA(e){if(void 0!==e)return e<1e3?e:e<1e6?`${OA(e/1e3)}K`:e<1e9?`${OA(e/1e6)}M`:`${OA(e/1e9)}B`}function OA(e){return+e.toString().substring(0,4)}function jA(e){if(void 0===e)return;const t=1024;return e<t?`${e}B`:(e/=t)<=t?`${OA(e)}KB`:(e/=t)<=t?`${OA(e)}MB`:`${OA(e/=t)}GB`}function DA(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"USD",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Intl.NumberFormat("en-US",{style:"currency",currency:t,...n}).format(e)}function NA(e){const t=(new Date).setHours(0,0,0,0),n=new Date(e).setHours(0,0,0,0),o=Math.abs(new Date-new Date(e));if(isNaN(o))return" ";const r=Math.floor(o/36e5);if(0===r){const e=Math.floor(o/6e4);return e<1?"Just now":{one:`${i=e}m ago`,other:`${i}m ago`}[new Intl.PluralRules("en").select(i)]}var i;if(r<24)return(e=>({one:`${e}h ago`,other:`${e}h ago`}[new Intl.PluralRules("en").select(e)]))(r);const a=Math.round((t-n)/864e5);return a>6?new Date(e).toLocaleDateString(xA(),{year:"numeric",month:"short",day:"2-digit"}):(e=>({one:`${e}d ago`,other:`${e}d ago`}[new Intl.PluralRules("en").select(e)]))(a)}function UA(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e=>e,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e=>e;const r=new Date(e),i=new Date;if(i.getFullYear()===r.getFullYear()){if(i.getMonth()===r.getMonth()){if(i.getDate()===r.getDate())return n("Today");if(i.getDate()===r.getDate()+1)return n("Yesterday")}return o(r.toLocaleString(xA(),{day:"2-digit",month:"short",timeZone:t}))}return o(r.toLocaleString(xA(),{day:"2-digit",month:"short",year:"numeric",timeZone:t}))}function FA(e){let{timeZone:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Date(e).toLocaleString(xA(),{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit",timeZone:t})}function BA(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e=>e,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e=>e;const r=new Date(e),i=new Date;if(i.getFullYear()===r.getFullYear()){if(i.getMonth()===r.getMonth()){if(i.getDate()===r.getDate())return n("Today");if(i.getDate()===r.getDate()+1)return n("Yesterday")}return o(r.toLocaleString(xA(),{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit",timeZone:t}))}return o(r.toLocaleString(xA(),{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",timeZone:t}))}function WA(e,t){const n=new Date(e),o=new Date;return o.getFullYear()===n.getFullYear()?o.getMonth()===n.getMonth()&&o.getDate()===n.getDate()?new Date(e).toLocaleString(xA(),{hour:"2-digit",minute:"2-digit",timeZone:t}):n.toLocaleString(xA(),{day:"2-digit",month:"short",timeZone:t}):n.toLocaleString(xA(),{day:"2-digit",month:"short",year:"numeric",timeZone:t})}function VA(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=new Date(e),r=new Date;if(r.getFullYear()===o.getFullYear()&&r.getMonth()===o.getMonth()){if(r.getDate()===o.getDate()&&!n)return"Today";if(r.getDate()===o.getDate()+1&&!n)return"Yesterday"}const i={day:"2-digit",month:"short",year:"numeric"};return t&&(i.timeZone=t),o.toLocaleString(xA(),i)}function qA(e){return new Date(e).toLocaleString(xA(),{day:"numeric",month:"long"})}function zA(e){return new Date(e).toLocaleString(xA(),{month:"short",year:"numeric"})}function HA(e){return new Date(e).toLocaleString(xA(),{hour:"2-digit",minute:"2-digit"})}function GA(e){if(e)return e.name?e.name:`${e.city?`${e.city}, `:""} ${e.country?`${e.country}`:""}`}function KA(e,t){function n(e){return e<10?`0${e}`:e}var o,r,i,a,s=e>=0;return e=Math.abs(e),o=Math.round(e%1*10),r=Math.floor(e%60),i=Math.floor(e/60),10===o&&(r++,o=0),60===r&&(i++,r=0),a=`${n(i)}:${n(r)}`,a=t?`${a}.${o}`:a,s?a:`-${a}`}angular.module("bandlab.audio").directive("virtualDrumPads",["$rootScope","MidiKeyboardHandler",function(e,t){return{replace:!0,restrict:"E",templateUrl:"https://www.bandlab.com/web-app/audio/partials/_virtual-drum-pads-837e4753.html",link:function(n){const o=IA.subscribe(e);n.$on("$destroy",(()=>{o()})),n.$watch("current.input.slug",(e=>{switch(e){case"drum-kit":t.changeKeymap(m_),n.drums=w_();break;case"drum-pads":case"special-effects":t.changeKeymap(f_),n.drums=S_()}}))},controller:"VirtualInstrumentCtrl"}}]),angular.module("bandlab.audio").directive("virtualPiano",["$rootScope","MidiKeyboardHandler",function(e,t){return{replace:!0,restrict:"E",templateUrl:"https://www.bandlab.com/web-app/audio/partials/_virtual-piano-3c9f7d21.html",compile:function(){return{post:function(n){t.changeKeymap("piano");const o=tC.subscribe(e),r=IA.subscribe(e);n.$on("$destroy",(()=>{o(),r()}))}}},controller:"VirtualInstrumentCtrl"}}]).directive("virtualPianoOctaveControls",["MidiKeyboardHandler",function(e){return{replace:!0,restrict:"E",template:'<div class="mix-editor-button-group" style="--mix-editor-button-group-gap: 0">\n        <div\n          class="mix-editor-button-piano octave-down-button"\n          ng-click="octaveDown($event)"\n          ng-disabled="octave <= minOctave"\n          title="Octave Down {{ isLegacyKeyboard ? \'(-)\' : \'(Z)\' }}"\n        >\n          <icon size="16" name="minus"></icon>\n        </div>\n        <mix-editor-mappable data-mappable-target="OCTAVE_DOWN"></mix-editor-mappable>\n        <div class="mix-editor-button-piano-octave-label">Octave</div>\n        <div class="mix-editor-button-piano-octave-value">{{ octave }}</div>\n        <mix-editor-mappable data-mappable-target="OCTAVE_UP"></mix-editor-mappable>\n        <div\n          class="mix-editor-button-piano octave-up-button"\n          ng-click="octaveUp($event)"\n          ng-disabled="octave >= maxOctave"\n          title="Octave Up {{ isLegacyKeyboard ? \'(+)\' : \'(X)\' }}"\n        >\n          <icon size="16" name="plus"></icon>\n        </div>\n      </div>',controller:["$scope",function(t){t.octaveUp=function(t){t.stopPropagation(),e.octaveUp()},t.octaveDown=function(t){t.stopPropagation(),e.octaveDown()},t.$on("MidiMapping:OCTAVE_DOWN",(function(t,n){let{toggle:o,value:r}=n;(o||r)&&e.octaveDown()})),t.$on("MidiMapping:OCTAVE_UP",(function(t,n){let{toggle:o,value:r}=n;(o||r)&&e.octaveUp()}))}]}}]).directive("virtualPianoKeyLabel",(function(){return{replace:!0,restrict:"E",template:'<div class="virtual-piano-label"></div>',link:async function(e,t,n){const o=n.note,r="true"===n.showEnharmonic;import("./chunk-62126de0.js").then((function(n){let{mount:i}=n;const a=i(t[0],{scope:e,note:o,showEnharmonic:r});e.$on("$destroy",(function(){a.unmount()}))}))}}})),angular.module("bandlab.audio").directive("voiceMicrophone",["EditorHelper","EditorPlayer","EditorRevision","InputDevice",function(e,t,n,o){return{replace:!0,restrict:"E",template:'<div class="audio-input-audio"></div>',link:async function(r,i){import("./chunk-6b2049df.js").then((function(a){let{mount:s}=a;const l=s(i[0],{EditorHelper:e,EditorPlayer:t,EditorRevision:n,InputDevice:o,scope:r});r.$on("$destroy",(function(){l.unmount()}))}))}}}]),angular.module("bandlab.audio").filter("displayUnit",(function(){return Ts})),angular.module("bandlab.audio").filter("formatKey",(function(){return function(e,t){if(!e)return"";var n=e.replace(/(|)/,"$1");return"short"===t?n=n.replace(" major","").replace("minor","min"):"semi"===t&&(n=n.replace("or","")),n}})),angular.module("bandlab.audio").filter("formatQuantization",(function(){return function(e){return{1:"1/1",2:"1/2",4:"1/4",8:"1/8",16:"1/16",32:"1/32",3:"1/2T",6:"1/4T",12:"1/8T",24:"1/16T",48:"1/32T"}[e]||e}})),angular.module("bandlab.audio").filter("presetName",["EffectsPreset",function(e){return function(t){if(!t.preset)return"";const n=_.get(t,"effectsData.displayName");if(n&&e.getUserPresetsSync().some((e=>e.id===t.effectsData.originalPresetId)))return n;const o=e.getBySlug(_.get(t,"effectsData.originalPresetId"));return"custom"===t.preset&&o?`${o.name}`:{custom:"Custom",none:"None"}[t.preset]||e.getBySlug(t.preset).name}}]),angular.module("bandlab.audio").filter("soundTime",(function(){return KA})),angular.module("bandlab.audio").factory("AudioReset",["EditorPlayer","InputDevice","Soundbank",function(e,t,n){return{reset:function(){e.reset(),t.reset(),n.reset()}}}]),angular.module("bandlab.audio").factory("EffectsPreset",["$http","$injector","Me",function(e,t,n){const o=Vt([]),r=rd((function(){const e=t.get("Katnip");return e.then((function(){return s={...e.effectsJson.recommended,all:Object.values(e.effectsJson.presets)},a=e.effectsJson.presetsUI.group,Promise.resolve(s)}))})),i=Vt(JSON.parse(ql.newUserPresets||"[]"));let a=[],s=[];const l=Vt([]),c=Vt([]),u=Vt([]),d=Vt([]);let p,m=[];return Lr((()=>i.value.length),(function(){ql.newUserPresets=JSON.stringify(i.value)})),{addFavoritePreset:function(t){return(!p||0!==p.$$state.status)&&(p=e.post(`https://www.bandlab.com/api/v1.3/users/${n.id}/favorite-effect-presets-ids/${t}`),o.value=[t].concat(o.value),!0)},addPresetsFromRevision:function(e){const t=e.tracks.filter((e=>e.effectsData?.originalPresetId)).filter((e=>!c.value.find((t=>t.id===e.effectsData.originalPresetId)))).map((function(e){return{displayName:e.effectsData.displayName,effects:e.effects.map((e=>{let{params:t,...n}=e;return{params:{...t},...n}})),id:e.effectsData.originalPresetId,link:e.effectsData.link}}));m=m.concat(t)},addUnsavedUserPresetsFromRevisionPresets:function(e){(function(e){const t=e.map((e=>g(e)));return Promise.allSettled(t).then((e=>e.filter((e=>"fulfilled"===e.status)).map((e=>e.value)))).catch((()=>[]))})(e.filter((e=>e.link)).map((e=>e.link.split("effect-presets/")[1]))).then((function(e){l.value=e}))},artistPresets:d,computeSelectedPreset:function(e){const t=e.effectsData?.originalPresetId,n="custom"===e.preset,o=c.value.find((e=>e.id===t))||u.value.find((e=>e.id===t))||l.value.find((e=>e.id===t))||d.value.find((e=>e.id===t))||f(t)||{};return{...o,description:o.description||"",displayName:o.displayName||o.name||(n?"Custom":"None"),picture:o.picture?.url||o.picture}},deleteUserPreset:function(t){return e({method:"delete",url:`https://www.bandlab.com/api/v1.3/users/${n.id}/effect-presets/${t.id}`}).then((function(e){return Gf(c.value,{id:t.id}),h(t.id,u.value),h(t.id,d.value),e}))},deleteFavoritePreset:function(t){return(!p||0!==p.$$state.status)&&(p=e.delete(`https://www.bandlab.com/api/v1.3/users/${n.id}/favorite-effect-presets-ids/${t}`),o.value=o.value.filter((e=>e!==t)),!0)},getArtistPresets:function(){return e({url:`https://www.bandlab.com/api/v1.3/users/${n.id}/artists-effect-presets`}).then((function(e){return d.value=e.data,d.value})).catch((()=>[]))},getByInput:function(e){let{slug:t}=e;return s[t]||[]},getBySlug:f,getPresets:r,getPresetsSync:function(){return s},getPresetGroupsSync:function(){return a},getRevisionPresets:function(){return m},getSharedPreset:g,getFavoritePresetIdsRef:function(){return o},getFavoritePresetIds:function(){return e.get(`https://www.bandlab.com/api/v1.3/users/${n.id}/favorite-effect-presets-ids`).then((function(e){return o.value=e.data,e.data})).catch((()=>[]))},getTrendingPresets:v,getUserTrendingPresets:b,getPublicTrendingPresets:y,getUserPresets:function t(o){return e({url:`https://www.bandlab.com/api/v1.3/users/${n.id}/effect-presets`,params:{after:o,limit:100},preservePagination:!0}).then((function(e){return c.value=o?c.value.concat(e.data.data):e.data.data,e.data.paging.cursors.after?t(e.data.paging.cursors.after):e}))},getUserPresetsRef:function(){return c},getUserPresetsSync:function(){return c.value},isNewerPreset:function(e,t){return`${e}_v2`===t},newUserPresets:i,regenerateUserPresetLink:function(t){return e({method:"delete",url:`https://www.bandlab.com/api/v1.3/users/${n.id}/effect-presets/${t}/link`}).then((function(e){return e.data}))},saveUserPreset:function(t){return e({method:"post",url:`https://www.bandlab.com/api/v1.3/users/${n.id}/effect-presets`,data:{...t,effects:t.effects.map((function(e){let{automation:t,...n}=e;return n}))}}).then((function(e){return c.value=[e.data].concat(c.value),e.data}))},saveSharedPreset:function(t){return e({method:"post",url:`https://www.bandlab.com/api/v1.3/users/${n.id}/effect-presets/${t}`}).then((function(e){c.value=[e.data].concat(c.value),i.value.push(e.data.id);const n=u.value.findIndex((e=>e.link?.endsWith(t)));return-1!==n&&u.value.splice(n,1,{...u.value[n],savedPresetId:e.data.id}),e.data}))},trendingPresets:u,updateUserPreset:function(t){return e({method:"patch",url:`https://www.bandlab.com/api/v1.3/users/${n.id}/effect-presets/${t.id}`,data:{...t,effects:t.effects.map((function(e){let{automation:t,...n}=e;return n}))}}).then((function(e){const n=c.value.findIndex((e=>e.id===t.id));return c.value.splice(n,1,e.data),u.value.find((e=>e.savedPresetId===t.id))&&v(),e.data}))}};function f(e){return e===Vs.slug?Vs:t.get("Katnip").effectsJson.presets[e]}function h(e,t){const n=t.findIndex((t=>t.savedPresetId===e));-1!==n&&t.splice(n,1,{...t[n],savedPresetId:null})}function g(t){return e({method:"get",url:`https://www.bandlab.com/api/v1.3/effect-presets/${t}`}).then((function(e){return e.data}))}async function v(){return n.isAnonymous()?y():b()}function b(){return e({url:`https://www.bandlab.com/api/v1.3/users/${n.id}/trending-effect-presets`,params:{limit:100},preservePagination:!0}).then((function(e){return u.value=e.data.data,u.value})).catch((()=>[]))}function y(){return e({url:"https://www.bandlab.com/api/v1.3/trending-effect-presets",params:{limit:100},preservePagination:!0}).then((function(e){return u.value=e.data.data,u.value})).catch((()=>[]))}}]);const YA=Vt(null),JA=Vt(-1),XA=Mt({currentStep:Gi((()=>YA.value?YA.value.steps[JA.value]:null)),progress:{value:Gi((()=>YA.value?(JA.value+1)/YA.value.steps.length:-1)),readable:Gi((()=>YA.value?{numerator:JA.value+1,denominator:YA.value.steps.length}:null))},canForward:Vt(!0)});var ZA=Kl?Kl.isConcatSpreadable:void 0;function QA(e){return im(e)||gm(e)||!!(ZA&&e&&e[ZA])}function ex(e,t,n,o,r){var i=-1,a=e.length;for(n||(n=QA),r||(r=[]);++i<a;){var s=e[i];t>0&&n(s)?t>1?ex(s,t-1,n,o,r):rm(r,s):o||(r[r.length]=s)}return r}function tx(e,t){if(e!==t){var n=void 0!==e,o=null===e,r=e==e,i=Gu(e),a=void 0!==t,s=null===t,l=t==t,c=Gu(t);if(!s&&!c&&!i&&e>t||i&&a&&l&&!s&&!c||o&&a&&l||!n&&l||!r)return 1;if(!o&&!i&&!c&&e<t||c&&n&&r&&!o&&!i||s&&n&&r||!a&&r||!l)return-1}return 0}function nx(e,t,n){t=t.length?Cf(t,(function(e){return im(e)?function(t){return Df(t,1===e.length?e[0]:e)}:e})):[Wf];var o=-1;t=Cf(t,Tm(Vf));var r=function(e,t){var n=-1,o=Wm(e)?Array(e.length):[];return zI(e,(function(e,r,i){o[++n]=t(e)})),o}(e,(function(e,n,r){return{criteria:Cf(t,(function(t){return t(e)})),index:++o,value:e}}));return function(e){var t=e.length;for(e.sort((function(e,t){return function(e,t,n){for(var o=-1,r=e.criteria,i=t.criteria,a=r.length,s=n.length;++o<a;){var l=tx(r[o],i[o]);if(l)return o>=s?l:l*("desc"==n[o]?-1:1)}return e.index-t.index}(e,t,n)}));t--;)e[t]=e[t].value;return e}(r)}var ox=Math.max,rx=FI?function(e,t){return FI(e,"toString",{configurable:!0,enumerable:!1,value:(n=t,function(){return n}),writable:!0});var n}:Wf;const ix=rx;var ax,sx,lx,cx=Date.now;const ux=(ax=ix,sx=0,lx=0,function(){var e=cx(),t=16-(e-lx);if(lx=e,t>0){if(++sx>=800)return arguments[0]}else sx=0;return ax.apply(void 0,arguments)});function dx(e,t,n){if(!rc(n))return!1;var o=typeof t;return!!("number"==o?Wm(n)&&Sm(t,n.length):"string"==o&&t in n)&&Pc(n[t],e)}var px=function(e){return ux(function(e,t,n){return t=ox(void 0===t?e.length-1:t,0),function(){for(var o=arguments,r=-1,i=ox(o.length-t,0),a=Array(i);++r<i;)a[r]=o[t+r];r=-1;for(var s=Array(t+1);++r<t;)s[r]=o[r];return s[t]=n(a),function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}(e,this,s)}}(e,void 0,Wf),e+"")}((function(e,t){if(null==e)return[];var n=t.length;return n>1&&dx(e,t[0],t[1])?t=[]:n>2&&dx(t[0],t[1],t[2])&&(t=[t[0]]),nx(e,ex(t,1),[])}));const mx=px;function fx(e,t,n){return t.setState(n.map((function(t){return gx(e,t)})))}async function hx(e,t){return e.setAllBypass(t)}function gx(e,t){return Object.keys(t.params).reduce((function(n,o){return e.metadata[t.slug].params[o]?("float"===e.metadata[t.slug].params[o].type?n.floatParams.push({slug:o,value:t.params[o],automationCurve:[]}):"enum"===e.metadata[t.slug].params[o].type?n.enumParams.push({slug:o,value:t.params[o]}):n.boolParams.push({slug:o,value:t.params[o]}),n):n}),{boolParams:[],bypass:t.bypass??!1,enumParams:[],floatParams:[],slug:t.slug,uniqueId:m()})}angular.module("bandlab.audio").factory("InputDevice",["$analytics","$q","$rootScope","AppNotifications",function(e,t,n,o){const r={label:"no device",name:"No Device",kind:"none"},i={audio:{latency:0,echoCancellation:!1,autoGainControl:!1,noiseSuppression:!1,googHighpassFilter:!1}},a={device:navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices?r:{deviceId:-1,name:"Unsupported",kind:"none"}},s=lh().createGain(),l=Ac((function(){return"requestMIDIAccess"in navigator?navigator.requestMIDIAccess().then((function(e){return e.onstatechange=g,e})):t.reject(new Error("This browser does not support Web MIDI."))})),c=rd((()=>{_g(zn((()=>import("./chunk-ebb06b2d.js"))),{},{escapeClose:!0,overlayClose:!0})})),u=Ac((function(t){e.eventTrack("Add Audio Input",{category:"Mix Editor",label:t})}));let d=Promise.resolve();var p,m;return w(),{connect:function(e){return s.connect(e),()=>f(e)},disconnect:f,getAudioDevices:h,getCurrent:function(){return a},getMidiDevices:v,reset:w,switchTo:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.device;return u(e&&e.name||"undefined device"),a.device=e,d=function(e){return"none"===e.kind?t.resolve(lh().createGain()):e.kind===Hs?h().then((function(r){return _.find(r,{deviceId:e.deviceId})?function(e){return(r=e,i.audio.deviceId=r.deviceId,i.audio.sampleRate=lh().sampleRate,"Safari"!==nh.browser.name&&y(),navigator.mediaDevices.getUserMedia(i).then((function(e){return p=e,e.oninactive=function(){e.normalStop||(o.addNotification({title:"Active audio device disconnected",content:`${e.getAudioTracks()[0].label} has been disconnected. Please reconnect it or choose a different input device.`,autoclose:5e3}),n.$broadcast(vT))},t.resolve(e)})).catch((function(e){return t.reject(vh)}))).then((function(e){return lh().createMediaStreamSource(e)}));var r}(e):t.reject("Audio device not connected")})):(y(),t.resolve())}(e).then((function(e){m&&m.disconnect(),(m=e).connect(s)})).catch((function(e){if(e===vh){if(YA.value)return;c()}a.device=r,n.$applyAsync()})),d},waitUntilInitialization:()=>d};function f(e){s.disconnect(e)}function h(){return navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices?navigator.mediaDevices.enumerateDevices().then((function(e){const t=e.filter((e=>e.kind===Hs)).map((function(e,t){return Object.assign(e,{id:e.deviceId,name:"Default"===e.label?"Default":e.label||`Audio Device #${t+1}`})}));return mx(t,(t=>"Default"===t.name?1:e.indexOf(t)+e.length))})):t.reject(new Error("This browser does not support WebRTC"))}function g(e){e.port.constructor!==window.MIDIOutput&&(o.addNotification({title:`${e.port.name} (${e.port.manufacturer})`,content:`Status: ${e.port.state}`,autoclose:5e3}),v().then((function(e){n.$broadcast(bT,e)})))}function v(){return l().then(b)}function b(e){let{inputs:t=[]}=e;const n=[];return t.forEach((function(e){n.push(Object.assign(e,{kind:"midi"}))})),n}function y(){p&&p.active&&(p.getTracks().forEach((function(e){e.stop()})),p.normalStop=!0)}function w(){y(),p={},m=null}}]);const vx=Ac((async function(e,t){const n=await e.getBoolParams(),o=await e.getEnumParams(),r=await e.getFloatParams();return[ay((function(){vx.cache.delete(t),Mx(e),Mx(...n),Mx(...o),Mx(...r)}),1e3),[].concat(n,o,r)]}),(function(e,t){return t})),bx=Ac((async function(e){return[await e.slug(),ay((function(){bx.cache.delete(e)}),1e3)]}));async function yx(e,t){return{targetMidiPitch:await e.getTrackAutoPitchTargetMidi(t.id)}}async function wx(e,t,n){const{MixHandler:o,MusicUtils:r}=e,[i,a]=await Promise.all([r.slugToScale(t||"scale_undefined"),r.slugToTonic(n||"tonic_undefined")]),s=await r.getKeySignatureFromScaleAndTonic(i,a),{targetNotes:l}=await o.updateAutoPitchDataDeprecated({responseTime:0,slug:"",targetNotes:[],scale:i,tonic:a,version:t_.value},s);return l}async function $x(e,t){const{MusicUtils:n}=e,o=await n.parseKeySig(t),[r,i]=await Promise.all([n.getScaleFromKeySignature(o),n.getTonicFromKeySignature(o)]);return{scale:await n.scaleToSlug(r),tonic:await n.tonicToSlug(i)}}async function kx(e,t,n,o){const r=await e.getEffectAt(t),[i,a]=await vx(r,o),s=await _x(a,n),l=await(s?.isActive());return i(),l}async function Sx(e,t,n,o,r){const i=await e.getEffectAt(t);if("bypass"===n){if("boolean"!=typeof o)throw new TypeError("Bypass value must be a boolean");await i.setBypass(o),Mx(i)}else{const[e,t]=await vx(i,r),a=await _x(t,n);a?.set(o),e()}}async function _x(e,t){for(const n of e){const[e,o]=await bx(n);if(o(),e===t)return n}}async function Px(e,t,n,o,r,i,a){const s=await t.getEffectAt(n),l=await s.getSlug();if("bypass"===o||"autoPitch"===l||!e.metadata[l].params[o].automatable)return void Mx(s);const[c,u]=await vx(s,a),d=await _x(u,o),p=[];for(const e of r)p.push({position:await i.secsToTicks(e.position),value:e.value});await d.setAutomationCurve(p),c()}function Mx(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((function(e){e.delete()}))}async function Tx(e){const t=await e.FS.init(),n=await e.EffectMetadataManager.createWithOptions(!1);return await e.LiveEffect.setEffectMetadataManager(n),Promise.resolve([t,n])}function Cx(e){const t=JSON.parse(JSON.stringify(e));return t.tracks.forEach((function(e){e.loopPack??=null,e.regions.forEach((function(e){e.loopLength??=0})),e.regions=e.regions.filter((function(e){return!1!==e.isPlayable}))})),t}async function Ex(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Rx("audio/wav",...t)}async function Ix(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Rx("audio/midi",...t)}async function Rx(e,t,n,o){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],i=arguments.length>5?arguments[5]:void 0;r.length>=1&&(n=function(e,t){const n=t.reduce((function(e,t){return Math.min(t.startPosition,e)}),1/0);return{...e,volume:1,tracks:e.tracks.map((function(e){return{...e,automation:{},auxSends:[],effects:[],volume:1,pan:0,regions:t.filter((function(t){return t.trackId===e.id})).map((function(e){return{...e,startPosition:e.startPosition-n,endPosition:e.endPosition-n}}))}}))}}(n,r));const a=lh(),[{AudioEngineWorkletNode:s,ListenerBase:l}]=await uh(a),c=new s(a),[u,d]=await Tx(c);await Promise.all([Kx(c.FS,u.samples,Jx(n,o,r)),zx(c.FS,u.samples,Xx(n,o,r),t),zx(c.FS,u.samples,qx(n,o,r),t),Vx(c.FS,u.soundbanks,Ux(n,o,r))]);const p=Cx(n),f=m(),h=`${u.samples}/${f}.wav`;try{const t=await c.MixHandler.createMixDataFromRevision(JSON.stringify(p)),n=await{"audio/midi":async function(e){if(1===r.length)return{res:await c.MixdownCreator.renderRegionToMidi(e.mix,r[0].id,`${u.samples}/`,await oL(),h)};if(o)return{res:await c.MixdownCreator.renderTrackToMidi(e.mix,o.id,`${u.samples}/`,await oL(),h)};return{res:await c.MixdownCreator.renderMixToMidi(e.mix,`${u.samples}/`,await oL(),h)}},"audio/wav":function(e){return 1===r.length?c.MixdownCreator.renderRegionToWav(e.mix,r[0].id,u,d,h,a.sampleRate,16,0,Bx(l),!1,!1):o?c.MixdownCreator.renderTrackToWav(e.mix,o.id,u,d,h,a.sampleRate,16,0,Bx(l),!1,!1):c.MixdownCreator.renderMixToWav(e.mix,u,d,h,a.sampleRate,16,0,Bx(l),!1,!1)}}[e](t);if(!n.res.ok)return Promise.reject(n);const i=await c.FS.readFile(h);return{id:f,arrayBuffer:i.buffer,blob:new Blob([i],{type:e})}}finally{await c.destroy(),i||await c.FS.deleteFile(h)}}async function Ax(e){let{audioContext:t,midiImportResult:n,templateMixData:o}=e;const[{AudioEngineWorkletNode:r}]=await uh(t),i=new r(t),[a]=await Tx(i);try{const e=await i.MixHandler.createMixDataFromMidiImportResultAndTemplate(n,o),t={...e,mix:{...e.mix,id:m(),keySignature:await i.MusicUtils.keySigToString(e.mix.keySig)}},r=await i.MixHandler.getMixRequirements(e.mix);return Sentry.onLoad((()=>{Sentry.addBreadcrumb({message:"Get SongStarter Ideas: start awaiting placing into virtual FS",type:"debug",data:{soundbanks:r.soundbanks.toString().substring(0,200)}})})),await Promise.all([r.soundbanks.length>0&&await Vx(i.FS,a.soundbanks,r.soundbanks),r.audioSamples.length>0&&await Hx(i.FS,a.samples,r.audioSamples)]),Sentry.onLoad((()=>{Sentry.addBreadcrumb({message:"Get SongStarter Ideas: finish awaiting placing into virtual FS",type:"debug",data:{soundbanks:r.soundbanks.toString().substring(0,200)}})})),t}finally{await i.destroy()}}async function xx(e,t,n){const[{AudioEngineWorkletNode:o}]=await uh(e),r=new o(e);try{const o=await Lx(e,n),i=await Ox(e,t);return await r.MixHandler.createMixDataFromMidiImportResultAndTemplate(i,o)}finally{await r.destroy()}}async function Lx(e,t){const[{AudioEngineWorkletNode:n}]=await uh(e),o=new n(e);try{const e=Cx(t),{result:n,mix:r}=await o.MixHandler.createMixDataFromRevision(JSON.stringify(e));return n.ok?r:Promise.reject(n)}finally{await o.destroy()}}async function Ox(e,t){const[{AudioEngineWorkletNode:n}]=await uh(e),o=new n(e),[r]=await Tx(o);try{const e=`/midi/${t.split("/midi/")[1].replace("/","-")}.mid`;await async function(e,t,n){await lL(e,"/midi");const o=await fetch(n,{credentials:"include",headers:{Authorization:`Bearer ${s.get("sessionKey")}`}}),r=await o.arrayBuffer();return sL(e,t,r)}(o.FS,e,t);const n=await oL(),i=await o.MidiReader.prepareMidiFileForImport(e,!1,r.samples,n);return i.res.ok?{...i,keySignature:await o.MusicUtils.keySigToString(i.keySig)}:Promise.reject(i)}finally{await o.destroy()}}async function jx(e){const t=lh(),[{AudioEngineWorkletNode:n}]=await uh(t),o=new n(t),[r]=await Tx(o);return await Promise.all(e.filter((e=>"Midi"===e.type)).flatMap((e=>e.regions)).flatMap((e=>e.sampleId)).map((async e=>({id:e,blob:new Blob([await o.FS.readFile(`${r.samples}/${e}.mid`)],{type:"audio/midi"})}))))}async function Dx(e){const t=lh(),[{AudioEngineWorkletNode:n}]=await uh(t),o=new n(t),r=`${(await o.FS.init()).samples}/${e}.mid`;if(!await o.FS.exists(r))return null;try{const e=await o.FS.readFile(r);return new Blob([e],{type:"audio/midi"})}catch(e){return null}finally{o.destroy()}}async function Nx(e,t){const n=lh(),[{AudioEngineWorkletNode:o}]=await uh(n),r=new o(n);try{const n=await r.MixHandler.createRevisionFromMixData(e,t);return JSON.parse(n)}finally{await r.destroy()}}function Ux(e,t,n){const o=Fx(e,t,n).flatMap((function(e){return e.soundbank||[]}));return new Set(o)}function Fx(e,t,n){return n.length>1?e.tracks.filter((function(e){return e.regions.some((function(e){return n.some((function(t){return t.id===e.id}))}))})):t?[t]:e.tracks}function Bx(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:console.log;return new class extends e{constructor(){super()}onProgress(e){return t(e),Promise.resolve(!0)}}}async function Wx(e,t){const n=lh(),[{AudioEngineWorkletNode:o}]=await uh(n),r=new o(n),i=`${(await r.FS.init()).samples}/${e}.mid`;try{const e=await t.arrayBuffer();await sL(r.FS,i,e)}catch(e){}finally{r.destroy()}}function Vx(e,t,n){return Promise.all([...n].map((n=>cL(e,`${t}/${n}`,n))))}function qx(e,t,n){const o=function(e,t,n){return n.length?n:t?t.regions:e.tracks.flatMap((function(e){return e.regions}))}(e,t,n).flatMap((function(e){return e.sampleId}));return new Set(o)}function zx(e,t,n,o){return Promise.all([...n].map((n=>Gx(e,t,n,o))))}async function Hx(e,t,n){return Promise.all([...n].map((n=>pL(e,`${t}/${n}.wav`,n))))}async function Gx(e,t,n,o){return o.get("EditorMidiSamples").has(n)?dL(e,`${t}/${n}.mid`,n,o):uL(e,`${t}/${n}.wav`,n,o)}async function Kx(e,t,n){return Promise.all([...n].map((n=>async function(e,t,n){return Promise.all((n.sampleIds??[]).map((function(n){return pL(e,`${t}/${n}.wav`,n)})))}(e,t,n))))}async function Yx(e,t,n){return Promise.all(n.map((function(n){return mL(e,`${t}/${n.name}.wav`,n.urls.wav)})))}function Jx(e,t,n){return Fx(e,t,n).flatMap((function(e){return e.samplerKit??[]}))}function Xx(e,t,n){const o=Fx(e,t,n).flatMap((function(e){return e.patterns??[]})).map((function(e){return e.sampleId}));return new Set(o)}async function Zx(e,t){const n=lh(),[{AudioEngineWorkletNode:o,ListenerBase:r}]=await uh(n),i=new o(n),a=await i.FS.init(),s=`${a.samples}/${e}.wav`,l=`${a.samples}/${e}-denoised.wav`;try{await Gx(i.FS,a.samples,e,t);const n=await i.WavUtils.denoise(s,l,Bx(r));if(!n.ok)return Promise.reject(n);const o=await i.FS.readFile(l);return{arrayBuffer:o.buffer,blob:new Blob([o],{type:"audio/wav"})}}finally{await i.FS.deleteFile(l),await i.destroy()}}async function Qx(e){const t=lh(),[{AudioEngineWorkletNode:n}]=await uh(t),o=new n(t),r=`${(await o.FS.init()).samples}/${m()}.wav`;try{const t=await e.arrayBuffer();await sL(o.FS,r,t);const n=await o.MusicAnalysis.getProjectSettingsForAudioTrackImport(r);return n[0]?{...n[0],keySignature:await o.MusicUtils.keySigToString(n[0].keySig)}:Promise.reject(n)}finally{await o.FS.deleteFile(r),await o.destroy()}}async function eL(e,t,n){let{slug:o}=e;const r=lh(),[{AudioEngineWorkletNode:i,ListenerBase:a}]=await uh(r),s=new i(r),[l,c]=await Tx(s),u=`${l.samples}/${m()}.wav`,d=`${l.samples}/${m()}-denoised.wav`;try{const e=await Sh(t),r=await e.arrayBuffer();await sL(s.FS,u,r);const i=await s.MasteringService.applyMasteringToWav(u,l,c,o,d,16,Bx(a,n));return i.ok?{arrayBuffer:(await s.FS.readFile(d)).buffer}:Promise.reject(i)}finally{await s.FS.deleteFile(u),await s.FS.deleteFile(d),await s.destroy()}}const tL=rd((function(){return fetch("https://www.bandlab.com/api/v4.1/soundbanks")})),nL=rd((function(){return tL().then((e=>e.clone().json()))})),oL=rd((function(){return tL().then((e=>e.clone().text()))}));async function rL(e,t,n,o){const r=lh(),[{AudioEngineWorkletNode:i}]=await uh(r),a=new i(r),s=await a.FS.init(),l=`${s.samples}/${m()}.mid`,c=`${s.samples}/${t}.mid`;try{const t=await e.arrayBuffer();await sL(a.FS,l,t),await a.MidiReader.getMidiExcerpt(l,c,n,o);const r=await a.FS.readFile(c);return new Blob([r],{type:"audio/midi"})}finally{await a.FS.deleteFile(l),await a.destroy()}}async function iL(e){const t=lh(),[{AudioEngineWorkletNode:n}]=await uh(t),o=new n(t),[r]=await Tx(o),i=`${r.samples}/${m()}.mid`;try{const t=await e.arrayBuffer();await sL(o.FS,i,t);const n=await oL(),a=await o.MidiReader.prepareMidiFileForImport(i,!1,r.samples,n);if(!a.res.ok&&"No non-empty tracks found"!==a.res.msg)return Promise.reject(a);const s=await Promise.all(a.tracks.map((async function(e){const t=`${r.samples}/${e.midiSampleId}.mid`;try{const e=await o.FS.readFile(t);return new Blob([e],{type:"audio/midi"})}finally{await o.FS.deleteFile(t)}})));return[a,s,await o.MusicUtils.keySigToString(a.keySig)]}finally{await o.FS.deleteFile(i),await o.destroy()}}function aL(e){const t={};return function(n,o){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];const s=Promise.resolve(t[o]).then((function(){return n.exists(o)})).then((function(t){return t?Promise.resolve():e(n,o,...i)()})).finally((function(){t[o]===s&&delete t[o]}));return t[o]=s,t[o]}}const sL=aL((function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return()=>e.writeFile(...n)})),lL=aL((function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return()=>e.mkdir(...n)})),cL=aL((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return()=>function(e,t,n){const o=[];return Promise.all([nL().then((e=>{const t=e.soundbanks.find((e=>e.slug===n));if(!t)throw new Error(`Soundbank with slug "${n}" not found`);return t.archive.m4a})).then((e=>fetch(e))).then((e=>e.blob())),import("./chunk-51f87187.js").then((e=>e.j)).then((function(e){let{default:t}=e;return new t})),import("./chunk-574ac585.js").then((function(e){let{default:t}=e;return t})),lL(e,t)]).then((function(r){let[i,a,s]=r;const l=s(3);return a.loadAsync(i).then((function(r){return r.forEach(((r,i)=>{r.includes(".json")?o.push(i.async("arraybuffer").then((function(o){return sL(e,`${t}/${n}.json`,o)}))):o.push(l((()=>i.async("arraybuffer").then((function(e){return Wh(e)})).then((function(e){return e.arrayBuffer()})).then((function(n){return sL(e,`${t}/${Lh(r)}.wav`,n)})))))})),Promise.all(o)}))}))}(...t)})),uL=aL((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return()=>async function(e,t,n,o){const r=o.get("EditorRevision"),i=r.current.samples?.find((function(e){return e.id===n}));if(!i?.buffer)return;const a=await Sh(i.buffer),s=await a.arrayBuffer();return sL(e,t,s)}(...t)})),dL=aL((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return()=>async function(e,t,n,o){const r=o.get("EditorMidiScore"),i=await r.exportScoreToMid(n),a=await i.arrayBuffer();return sL(e,t,a)}(...t)})),pL=aL((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return()=>async function(e,t,n){QS[n]=!0;const o=`https://static.bandlab.com/samples-formatted/${n}/${n}.m4a`,r=await fetch(o),i=await r.arrayBuffer(),a=await Wh(i),s=await a.arrayBuffer();return sL(e,t,s)}(...t)})),mL=aL((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return()=>async function(e,t,n){const o=await fetch(n),r=await o.arrayBuffer(),i=await Wh(r),a=await i.arrayBuffer();return sL(e,t,a)}(...t)}));async function fL(e){const[{AudioEngineWorkletNode:t,ListenerBase:n}]=await uh(e),o=new t(e);"running"===e.state?o.connect(e.destination):e.addEventListener("statechange",(function(){o.connect(e.destination)}),{once:!0});const[r,i]=await Tx(o),a=await o.Transport.create(o.ClockSource),s=await o.MixHandler.create(a,r,i);await s.setMaxNumArmed(2),await a.setSnapToGrid("ToNone");const l=await s.audioOutput();l.connect(o.AudioSink),l.delete();const c=await s.getMetronome();return Promise.resolve([o,s,a,r,n,c,function(e){return o.MixHandler.cleanupMix(e,i)}])}async function hL(e,t,n,o){let r;const i=[];await Promise.all([Kx(e.FS,t.samples,Jx(n,r,i)),zx(e.FS,t.samples,Xx(n,r,i),o),zx(e.FS,t.samples,qx(n,r,i),o),Vx(e.FS,t.soundbanks,Ux(n,r,i))])}function gL(e){const t=new Map,n=[];function o(e){n.push(e),1===n.length&&r()}async function r(){n.length>0&&(await n[0](),n.shift(),r())}return{queue:n,enqueue:o,useInstance:function(r,i){o((async function(){const o=await function(){if(t.has(r.id))return t.get(r.id);try{const n=e(r);return t.set(r.id,n),n}catch(e){return}}();if(o)return i(o,r,n);t.delete(r.id)}))},usedInstances:t}}const vL=Object.freeze(Object.defineProperty({__proto__:null,adaptEffectToEngine:gx,analyze:Qx,createMixDataFromMidi:Ax,createMixDataFromRevision:Lx,denoise:Zx,extractSamplesFromMidi:xx,getAutoPitchScaleAndTonicFromKeySig:$x,getAutoPitchTargetNotes:wx,getAutoPitchTuning:yx,getBeatStarterTemplateInfo:async function(){const e=lh(),[{AudioEngineWorkletNode:t}]=await uh(e),n=new t(e);try{return await n.PatternEditor.getBeatStarterTemplateInfo()}finally{await n.destroy()}},getEffectParameterActive:kx,getMidiExcerptFromBlob:rL,getMidiImportResult:Ox,getMidiSamplesArrayBuffers:jx,getProgressListener:Bx,getSampleMidFileFromVirtualFileSystem:Dx,listSamples:qx,makeRevisionWithMixData:Nx,master:eL,prepareMidiFileForImport:iL,putAudioSamplesIntoVirtualFileSystem:Hx,putMetronomeSoundsintoVirtualFileSystem:Yx,putMidiBlobIntoVirtualFileSystem:Wx,putRevisionSamplesIntoVirtualFileSystem:hL,putSamplerKitsIntoVirtualFileSystem:Kx,putSoundbanksIntoVirtualFileSystem:Vx,renderMixToMidi:Ix,renderMixToWav:Ex,sanitizeRevisionForAudioEngine:Cx,setEffectAutomation:Px,setEffectChain:fx,setEffectChainBypass:hx,setEffectParameter:Sx,setUpPlayer:fL,setupEffectMedataManager:Tx,useTrackCppInstanceWrapper:gL,writeFileIfNotExists:sL},Symbol.toStringTag,{value:"Module"})),bL=[],yL=[0,1,2,3,4,5,6,7,8,9,10,11];async function wL(e,t){const n=t.get("EditorPlayer"),o=await n.current.getTrackAutoPitchTuning(e);return o.targetMidiPitch>-1&&(o.targetPitchClass=o.targetMidiPitch%12),o}async function $L(e,t,n){const o=t.get("EditorPlayer");if(!e.autoPitch){const r=t.get("Katnip"),{scale:i,tonic:a}=n.key?await $x(o.current.audioEngineNode,n.key):{scale:"scale_undefined",tonic:"tonic_undefined"};e.autoPitch={bypass:!0,slug:"classic",responseTime:r.metadata.autoPitch.params.responseTime.default,targetNotes:[],scale:i,tonic:a,version:t_.value}}const r=await o.current.setTrackAutoPitch(e);return gf(e.autoPitch,r)||(e.autoPitch=r),e.autoPitch}async function kL(e,t,n,o){const r=o.get("EditorPlayer");n.autoPitch.scale=e,n.autoPitch.tonic=t;const{targetNotes:i}=await r.current.setTrackAutoPitch(n);n.autoPitch.targetNotes=i}function SL(e,t,n){const o=n.get("EditorPlayer");t.autoPitch.responseTime=e,o.current.setTrackAutoPitch(t)}function _L(e,t,n){const o=n.get("EditorPlayer");t.autoPitch.slug=e,o.current.setTrackAutoPitch(t)}function PL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=e.get("Katnip"),{min:o,max:r}=n.metadata.autoPitch.params.responseTime;return t>r||t<o?0:+t}function ML(e){try{const t=new Set(yL),n=e.split(",").map((e=>parseInt(e))).filter((e=>t.has(e)));return n}catch{return yL}}function TL(e,t,n,o){const r=n.get("$q"),i=n.get("EditorPlayer"),a=n.get("EditorState"),l=n.get("EditorRevision"),c=r.defer(),u=Symbol(),d=l.current;s.set("hasUsedAutoKey",!0,{expires:365}),a.isEstimatingKey=!0,l.autokeyUsedCount++;const p=Gi((()=>Math.min(m.value,f.value))),m=Vt(0),f=Vt(.99);setTimeout((function(){f.value=1}),2e3);const h=Mt({onConfirm:e=>c.resolve(e),onCancel:()=>{c.reject(u),Promise.resolve().then((()=>rb)).then((function(e){let{logStudioAutokeyCancel:t}=e;t()}))},progress:p,string:""});Promise.resolve().then((()=>rb)).then((function(n){let{logStudioAutokeyStart:o}=n;o(!t.regions.length,t.id===e?"autopitch":"region_action_menu")}));const g=zn((()=>import("./chunk-48114cc2.js")));return _g(g,h,{overlayClose:!1}),Promise.all([i.current.estimateKey(e,(function(e){m.value=e})).then((function(e){let{scale:o,tonic:r,string:i}=e;return Promise.resolve().then((()=>rb)).then((function(e){let{logStudioAutokeyComplete:t}=e;t("scale_undefined"!==o&&"tonic_undefined"!==r)})),"scale_undefined"===o||"tonic_undefined"===r?(c.reject(u),n.get("AppNotifications").addNotification({id:"estimateKey",title:"AutoDetect Key",content:t.regions.length?"Failed to detect":"Failed to detect: Track is empty",classList:"alert",autoclose:3e3})):(h.string=i,{scale:o,tonic:r})})),$L(t,n,d),c.promise]).then((function(e){let[{scale:o,tonic:r},,i]=e;return n.get("EditorHistory").pushUndo(l.current),kL(o,r,t,n).then((function(){t.autoPitch=Object.assign({},t.autoPitch),i&&(d.key=h.string)}))})).catch((function(e){if(e!==u)return Promise.reject(e)})).finally((function(){Pg(g),a.isEstimatingKey=!1,o.$applyAsync()}))}function CL(e,t){const n={};return t.boolParams.forEach((function(e){n[e.slug]={automatable:!1,default:e.defaultVal,description:e.desc,display:{name:e.name},name:e.name,readOnly:e.readOnly,type:"bool",unit:e.unit,visible:e.visible}})),t.enumParams.forEach((function(e){n[e.slug]={automatable:!1,default:e.defaultVal,description:e.desc,display:{name:e.name,enumType:e.enumType},name:e.name,readOnly:e.readOnly,type:"enum",unit:e.unit,values:e.choices,visible:e.visible}})),t.floatParams.forEach((function(e){n[e.slug]={automatable:e.automatable,default:e.defaultVal,description:e.desc,display:{name:e.name},displayUnit:e.displayUnit,max:e.maxVal,min:e.minVal,name:e.name,scale:e.scale,step:e.step,readOnly:e.readOnly,type:"float",unit:e.unit,visible:e.visible},e.displayMax>e.displayMin&&(n[e.slug].displayMax=e.displayMax,n[e.slug].displayMin=e.displayMin)})),{description:t.desc,isNew:t.isNew,name:t.name,params:n,slug:e,visible:t.visible}}function EL(e,t){return{name:t.name,paramList:t.paramList,previewImage:{height:t.previewImageHeight,url:t.previewImageUrl,width:t.previewImageWidth},slug:e,subTitle:t.subtitle}}function IL(e,t){const n=t.effectChain.map((function(e){const t=["boolParams","enumParams","floatParams"].reduce((function(t,n){return e[n].forEach((function(e){t[e.slug]=e.value})),t}),{});return{bypass:e.bypass,slug:e.slug,params:t}}));return{description:t.desc,effects:n,isNew:t.isNew,name:t.name,packs:t.packs,picture:t.picture,slug:t.slug}}angular.module("bandlab.audio").factory("Katnip",["Me",function(e){if(!ih())return{};const t=lh(),n=uh(t).then((async function(o){let[{AudioEngineWorkletNode:r}]=o;const i=new r(t);await i.Localisation.setLocale("en");const a=await i.EffectMetadataManager.createWithOptions(!1);ql.getItem("customEffectsJson")&&await a.initializeFromString(ql.getItem("customEffectsJson"));const s=await Mp(e,"expanded_fx_chain_enabled"),l=await a.getMaxEffectsPerChain(),c={autoPitchGroups:[],effects:{},effectsUI:{effects:{},groups:await a.getEffectGroups(),maxEffectsPerChain:"true"===s?l:l/2,maxEffectsPerChainWithoutMembership:l/2},presets:{},presetsUI:{group:[]},recommended:{}},u=await Mp(e,"visual_eq_enabled"),d=await a.getAvailableEffects();for(const e of d){const t=await a.getMetadataForEffect(e);c.effects[e]=CL(e,t),c.effectsUI.effects[e]=EL(e,t),"beatSyncDelay2"===e&&(c.effects[e].params.delayTime.automatable=!1),"visualEq"===e&&"true"!==u&&(c.effects[e].visible=!1)}c.effectsUI.groups.forEach((function(e){"true"!==u&&(e.effects=e.effects.filter((e=>"visualEq"!==e))),e.effects=e.effects.map((e=>c.effects[e]))})),await async function(e,t){let{MixHandler:n,MusicUtils:o}=e;const r=t.tonic.values.filter((e=>"Undefined"!==e.name)),i=t.scale.values.filter((e=>"Undefined"!==e.name));for(const e of r)for(const t of i)await a(bL,t,e);async function a(e,t,r){const i=await o.getKeySignatureFromScaleAndTonic(await o.slugToScale(t.slug),await o.slugToTonic(r.slug)),{targetNotes:a}=await n.updateAutoPitchDataDeprecated({tonic:await o.slugToTonic(r.slug),scale:await o.slugToScale(t.slug),slug:"",targetNotes:[],responseTime:0,version:t_.value},i);e.push({isSharp:i.sf>0,scale:t.slug,notes:a,tonic:r.slug})}}(i,c.effects.autoPitch.params);const p=await a.getAvailablePresets();for(const e of p){const t=await a.getMetadataForPreset(e);c.presets[e]=IL(0,t)}const m=await a.getPresetGroups();for(const e of m)c.presetsUI.group.push({name:e.name,presets:e.effects.map((e=>c.presets[e]))});const f=["aux-channels","experimental","mastering","synth-piano","videoMix",...yl.map((e=>e.slug))];for(const e of f){const t=await a.getRecommendedPresetsForTrackType(e);c.recommended[e]=t.map((e=>c.presets[e]))}const h=await i.MixHandler.getAutoPitchPresetGroupsAndPresetsDeprecated();for(const{name:e,effects:t,slug:n}of h){const o=[];for(const e of t){const t=await i.MixHandler.getAutoPitchPresetMetadataDeprecated(e);o.push(t)}c.autoPitchGroups.push({slug:n,name:e,presets:o})}t_.value=await i.AutoPitch.getMaxSupportedVersion(),await a.delete(),await i.destroy(),Object.assign(n,{effectsJson:c,metadata:c.effects})}));return n}]),angular.module("bandlab.audio").factory("MetronomeState",(function(){return{settings:{bpm:120,signature:{notesCount:4,noteValue:4}},sound:"Default",volume:1,justLoaded:!0}})).factory("Metronome",["$http","EditorPlayer","EditorState","MetronomeState",function(e,t,n,o){const r=Ac((function(){return e.get("https://www.bandlab.com/api/v3.0/metronome",{cache:!0}).then((function(e){return[...new Set(e.data.sounds.map((e=>e.name.replace("-Hi","").replace("-Low",""))))]}))})),i=Ac((function(){return Promise.all([r(),e.get("https://www.bandlab.com/api/v3.0/metronome",{cache:!0})]).then((function(e){let[n,o]=e;return t.current.loadMetronomeSounds(n,o.data.sounds)}))}));return{init:async function(){isNaN(ql.metronomeVolume)||await a(+ql.metronomeVolume),ql.metronomeSound&&o.sound!==ql.metronomeSound&&await s(ql.metronomeSound,!0)},getSounds:r,setSound:s,setVolume:a,update:function(){return n.isMetronomeEnabled?t.current.startMetronome?.():t.current.stopMetronome?.()}};function a(e){return ql.metronomeVolume=e,o.volume=e,t.current.setMetronomeVolume(e)}function s(e,n){return ql.metronomeSound=e,o.sound=e,Promise.all([r(),i()]).then((function(o){let[r]=o;const i=r.indexOf(e);i<0||(n?t.current.setMetronomeSoundWithoutPreview(i):t.current.setMetronomeSound(i))}))}}]),angular.module("bandlab.audio").factory("Sample",["$http","$q","Me",function(e,t,n){return{analyzeTempo:function(t){return e({url:"https://www.bandlab.com/api/v2.0/analyzer/tempo",method:"POST",data:{sampleId:t,sampleType:"analyzed"}}).then((function(e){return e.data}))},getBuffer:function(t){return e({url:t,responseType:"arraybuffer"}).then((function(e){return e.data}))},getJSON:function(t){return e({url:`https://www.bandlab.com/api/v2.0/uploads/${t}`,cache:!0,data:"",headers:{"Content-Type":"application/json"}}).then((function(e){return e.data}))},getOptions:function(){return e.get("https://www.bandlab.com/api/v2.0/options",{cache:!0}).then((function(e){return e.data.mixEditor})).catch((function(){return{maxSongDuration:JS.SONG_DURATION_MAX,maxTracks:JS.TRACKS_LIMIT}}))},upload:function o(r){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:angular.noop;var s=Ah(r.blob),l=t.defer(),c=t.resolve();return["flac","mid"].includes(s)||"analyzed"===r.sampleType||(c=Hh(r.blob).then((e=>{r.blob=e,s=Ah(r.blob)}))),Object.assign(c.then((function(){return function(t,o,r,i){return e({url:`https://www.bandlab.com/api/v2.0/uploads/${t}/${o}?format=${r}`,method:"PUT",headers:{"X-Amz-Meta-User-Id":n.id,"X-Amz-Meta-Device":"","X-Amz-Meta-Source":""},timeout:i}).then((function(e){return e.data.value}))}(r.sampleType,r.sampleId,s,l.promise)})).then((function(t){return e({url:t,method:"PUT",data:r.blob,headers:{"Content-Type":Eh[s][0]},uploadEventHandlers:{progress:a},timeout:l.promise,transformRequest:[]})})).then((()=>{QS[r.sampleId]=!0})).catch((function(e){if(409!==e.status)return 1===e.config.timeout.$$state.status?t.reject("Cancelled"):i<=3?o(r,++i):t.reject(e);QS[r.sampleId]=!0})),{cancel:()=>l.resolve()})}}}]),angular.module("bandlab.audio").factory("Soundbank",["$http",function(e){var t=[],n={},o=[];return l(),{getBank:function(e){return(e=_.find(o,{slug:e.slug})).promise?e.promise:"VASynth"===e.synth||"FMSynth"===e.synth?(e.promise=a(e).then((function(t){let n;return Object.assign(e,t),"VASynth"===e.synth&&(n={0:!0,127:!0}),"FMSynth"===e.synth&&(n={21:!0,119:!0}),Object.assign(e,r(n)),e})),e.promise):(e.promise=a(e).then((function(t){let{category:n,samples:o}=t;e.category=n;const i={};for(const e of o){const t=e.minRange??e.midiNumber,n=e.maxRange??e.midiNumber;for(let e=t;e<=n;e++)i[e]=!0}return RL[e.slug]=i,Object.assign(e,r(i)),e})),e.promise)},getBanks:i,getCategories:function(){return t},getCurrent:function(){return n},getList:Ac((function(){return e.get("https://www.bandlab.com/api/v4.1/soundbanks",{cache:!0}).then((function(e){let{data:{categories:n,soundbanks:r}}=e;return n.forEach((function(e){e.filters.forEach((function(e){e.subfilters.length||(e.soundbanks=r.filter((t=>t.filters.includes(e.slug)))),e.subfilters.forEach((function(e){e.soundbanks=r.filter((t=>t.filters.includes(e.slug)))}))}))})),n.push({title:"Drum Machine",filters:[n[0].filters.find((e=>"instrument-drum-kits"===e.slug)),n[0].filters.find((e=>"instrument-drum-pads"===e.slug))]}),o=r,t=n,r}))})),getNoteWithOctave:function(e){return n.soundbank?.userInterfaces?.includes?.("keyboard")?e+12*(qS.octave-1):e},getPropertyValue:function(e,t){var n=_.find(o,{slug:e});return n?n[t]:null},reset:l,setDrumMachine:function(e){s(e.soundbank),n.input=gl},setFromAudioType:function(e){n.input=hl.find((t=>t.slug===e)),n.soundbank=null},setSampler:function(e){n.input=vl,n.samplerKit=e.samplerKit,n.soundbank=null},setFromSoundbank:s};function r(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=Object.keys(e),n=r(t[t.length-1]),o=n-(JS.IS_LEGACY_KEYBOARD?2:1);return{minOctave:r(t[0]),maxOctave:n,minFullOctave:Math.ceil(t[0]/12)-1,maxFullOctave:o};function r(e){return Math.floor(e/12)-1}}function i(){return o}function a(t){return e.get(`https://www.bandlab.com/api/v4.1/soundbanks/${t.slug}`,{cache:!0}).then((function(e){return e.data}))}function s(e){const t=i().find((t=>t.slug===e))||{};n.input=bl.find((e=>t.filters.includes(e.filter))),n.input||(n.input=bl.find((e=>t.userInterfaces.includes(e.slug)))),!n.input&&t.userInterfaces.includes("drum-kit-16")&&(n.input=bl.find((e=>"instrument-drum-kits"===e.filter))),n.input||(n.input=bl.find((e=>"instrument-pianos"===e.filter))),n.soundbank=t}function l(){n.input={},qS.octave=2,n.soundbank={},n.samplerKit=null}}]);const RL={};function AL(e,t,n,o,r){e.band=r,e.$on("$invite:changed",(function(){e.band.$get({id:e.band.id}).then((t=>{t.conversationId||setTimeout((()=>{e.band.$get({id:e.band.id})}),2e3)}))})),e.$on("$band:changed",(function(o,r){"update"===r.action&&n.username!==e.band.username&&t.go(t.current.name,Object.assign(t.params,{username:e.band.username,changed:!0}),{reload:!0})})),e.$on("$band:left",(function(n,r){"band.edit.members"===t.current.name?t.go("user.feed",{username:o.username}):e.band===r.band&&setTimeout((()=>{t.go(".",t.params,{reload:!0})}),1e3)}))}function xL(e,t,n,o,r,i,a,s,l){var c,u=5,d=null,p=!1,m=e.url();function f(){return p?t.resolve([]):c=s.fromBand({after:d,bandId:l.id,limit:u}).$promise.then((function(e){return p=e.data.length<u,d=_.get(e,"paging.cursors.after",0),e.data.map((e=>{e.band=l})),e.data}))}function h(){return n.infiniteScrollEnded?t.resolve():c=c.then((function(e){n.infiniteScrollEnded=p,n.posts=n.posts||[];const t=e.filter((e=>!e.isPinned)),o=e.filter((e=>e.isPinned));return n.posts=n.posts.concat(t),n.pinned=n.pinned||o,a.pushQueueSongs([...o,...t],m),f()}))}n.band=l,n.loadMore=h,n.me=i,n.onPostCreate=function(e){n.posts.unshift(e)},bv({bandId:l.id,isBandMember:l.isMember}),a.setCurrentPageContext({contentSource:"band",loader:h,url:m}),n.$on("$post:delete",(function(e,t){Gf(n.posts,(function(e){return e.id===t.post.id})),n.pinned.length&&Gf(n.pinned,(function(e){return e.id===t.post.id}))})),n.$on("$user:relationChanged",(function(e,t){"block"===t.type&&Gf(n.posts,(function(e){return e.creator.id===t.user.id})),n.pinned.length&&Gf(n.pinned,(function(e){return e.creator.id===t.user.id}))})),n.$on("$post:pin",(function(e,t){let{post:i}=t;_.find(n.posts,{id:i.id})&&r((()=>o.reload("band.feed")),1e3)})),n.$on("$post:unpin",(function(e,t){let{post:i}=t;_.find(n.pinned,{id:i.id})&&r((()=>o.reload("band.feed")),1e3)})),f().then(n.loadMore)}angular.module("bandlab.band",[]).directive("bandTileSmallCard",(function(){return{scope:{band:"<"},link:function(e,t){const n=import("./chunk-c23dfad2.js").then((function(n){let{mountBandTileSmallCard:o}=n;return o(t[0],{band:e.band})}));e.$on("$destroy",(async function(){(await n).unmount()}))}}})).directive("bandProfileHeader",["$injector",function(e){return{scope:{band:"="},link:function(t,n){const o=import("./chunk-5215e661.js").then((function(o){let{mountBandProfileHeader:r}=o;return r(n[0],{$injector:e,scope:t})}));t.$on("$destroy",(async function(){(await o).unmount()}))}}}]).directive("bandMemberActions",["$injector",function(e){return{link:function(t,n){const o=import("./chunk-d453439e.js").then((e=>e.a)).then((function(o){let{mountBandMemberActions:r}=o;return r(n[0],{$injector:e,scope:t})}));t.$on("$destroy",(async function(){(await o).unmount()}))}}}]).component("bandFollowersCard",{bindings:{band:"<"},templateUrl:"https://www.bandlab.com/web-app/band/partials/_band-followers-card-4285c1ef.html",controller:["$element","$stateParams","$rootScope","$timeout","Band",function(e,t,n,o,r){const i=this;function a(){t.followers&&function(){const t=e[0].querySelector("[users-modal]");o((()=>{})).then((function(){t.click()}))}(),s({limit:10}).then((function(e){let{data:t}=e;i.users=t}))}function s(e){return r.getFollowers({id:i.band.id,...e}).$promise}i.$onInit=a,i.getFollowers=s,n.$on("$band:relationChanged",a)}],controllerAs:"vm"}),AL.$inject=["$scope","$state","$stateParams","Me","theBand"],xL.$inject=["$location","$q","$scope","$state","$timeout","Me","PlayerHistory","Post","theBand"];let LL=0;const OL=rd((()=>document.querySelector("body > main")));function jL(){if(--LL)return;const e=OL(),t=Math.abs(parseFloat(e.style.top));e.classList.remove("no-scroll"),e.style.top="",window.scrollTo(0,t),document.body.style.overscrollBehaviorY=""}function DL(){const e=rd(jL);if(LL++)return e;document.body.classList.contains("scrolled")&&document.body.classList.add("was-scrolled");const t=OL();return t.style.top=`-${window.scrollY}px`,t.classList.add("no-scroll"),document.body.style.overscrollBehaviorY="none",e}function NL(e,t,n){return 201===n&&Promise.resolve().then((()=>rb)).then((function(t){let{logBandCreate:n}=t;n({bandId:e.id})})),e}function UL(e){let{cache:t=new Map,cacheKey:n=function(){return arguments.length<=0?void 0:arguments[0]},promiseCache:o=new Map}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function(){const r=n(...arguments);if(t.has(r))return t.get(r);if(o.has(r))return o.get(r);try{const n=e(...arguments);o.set(r,n);const i=await n;return t.set(r,i),i}finally{o.delete(r)}}}function FL(e,t){e.conversationId=t.id}angular.module("bandlab.band.routes",[]).config(["$stateProvider",function(e){e.state("band",{url:"/band/{username:[a-z][0-9a-z_]{1,19}}",abstract:!0,templateUrl:"https://www.bandlab.com/web-app/band/views/band-layout-aed7bf25.html",resolve:{theBand:["$stateParams","Band",function(e,t){return t.get({id:e.username}).$promise}]},onEnter:["Page","theBand",function(e,t){e.setMetadata({title:`${t.name} (@${t.username})  BandLab - Make Music Online`,description:`${t.about?`${t.about} | `:""}Listen to music from ${t.name} and follow their creative process on BandLab.`,image:`${t.picture.url}640x360`,imageHeight:"360",imageWidth:"640"})}],onExit:["Page",function(e){e.clearMetadata()}],controller:AL}).state("band.feed",{url:"?members",views:{content:{templateUrl:"https://www.bandlab.com/web-app/band/views/band-feed-e2083fff.html",controller:xL}}}).state("band.feed.shout",{url:"/shout?postId",reloadOnSearch:!1,resolve:{thePost:["$stateParams","Post",function(e,t){return t.get({id:e.postId}).$promise}]},onEnter:DL,onExit:jL,views:{"overlay@":{templateUrl:"https://www.bandlab.com/web-app/shout/views/shout-image-view-922d75e9.html",controller:["$scope","$state","$stateParams","thePost",function(e,t,n,o){e.post=o,e.triggeredFrom="band",e.$on("$post:delete",(function(e,r){o.id===r.post.id&&t.go("band.feed",{username:n.username})})),e.$on("$user:relationChanged",(function(e,n){"block"===n.type&&o.creator.id===n.user.id&&t.go("^")})),e.updateCounter=function(t){e.post.counters.comments=t(e.post.counters.comments)}}]}}}).state("band.edit",{url:"/edit",params:{rewriteTracking:function(){return e=>e.replace(/^\/band\/[a-z][0-9a-z_]{1,19}(($|\/).*)/g,"/band$1")}},redirectTo:function(e){return{state:"band.edit.profile",params:{username:e.params().username}}},resolve:{canEdit:["$q","theBand",function(e,t){return"Admin"===t.role||"Owner"===t.role?e.resolve(!0):e.reject({status:403})}]},views:{"@":{templateUrl:"https://www.bandlab.com/web-app/band/views/manage/band-manage-layout-71639cc7.html",controller:AL}}}).state("band.edit.profile",{url:"/profile?changed",templateUrl:"https://www.bandlab.com/web-app/band/views/manage/band-edit-f3821f40.html",controller:"BandEditCtrl"}).state("band.edit.members",{url:"/members",templateUrl:"https://www.bandlab.com/web-app/band/views/manage/band-members-fd751bdf.html"}).state("band.edit.privacy",{url:"/privacy",templateUrl:"https://www.bandlab.com/web-app/band/views/manage/band-privacy-808b6e6e.html",controller:"BandEditCtrl"})}]),angular.module("bandlab.band").controller("BandCreateCtrl",["$analytics","$rootScope","$scope","$state","AppNotifications","Band",function(e,t,n,o,r,i){n.band=new i,n.$on("$file:uploadSuccess",(function(e,t){n.band.pictureId=t.id,n.band.picture=t,n.bandForm.$setDirty()})),n.addBand=function(){n.band.$save().then((function(n){t.$broadcast("createBandModal","close"),t.$broadcast("$band:changed",{action:"create",band:n}),e.eventTrack("Create Band",{category:"Band"}),r.addNotification({title:"Band created",content:"Invite new members and start making music.",image:`${n.picture.url}48x0 1x, ${n.picture.url}96x0 2x`,action:`\n              <div ng-click="hide()">\n                <a class="button-dark button-height-32 button-padding-16 button-rounded" href="${o.href("band.edit.members",{username:n.username})}"><i class="icon-persons-plus"></i></a>\n              </div>\n            `,classList:"project",autoclose:8e3})})).catch((function(e){n.bandForm.$setPristine(),202!==e?.data?.errorCode&&r.addNotification({title:"Unable to create band. Check your internet connection and try again.",content:e.data.message,classList:"alert",autoclose:8e3})}))}}]),angular.module("bandlab.band").controller("BandEditCtrl",["$analytics","$rootScope","$scope","$state","$timeout","AppNotifications","Band","Me","Tag","theBand",function(e,t,n,o,r,i,a,s,l,c){n.changeError=!1,n.band=angular.copy(c),l.getGenres().then((function(e){n.genres=_.map(e,(function(e){return e.isSelected=_.some(c.genres,{id:e.id}),e}))})),n.$on("$band:changed",(function(e,t){let{action:o,data:r}=t;"picture"===o?(Object.assign(c.picture,r.picture),Object.assign(n.band.picture,r.picture)):"role"===o&&(c.role=r.role,n.band.role=r.role)})),n.updateBand=function(){a.update({id:c.id,name:n.band.name,username:n.band.username,about:n.band.about,isOpen:n.band.isOpen,commentCreateGroup:n.band.commentCreateGroup,genres:_.filter(n.genres,{isSelected:!0}),location:n.band.location}).$promise.then((function(a){r((function(){Object.assign(c,a),t.$broadcast("$band:changed",{action:"update",band:c})}),1e3),n.bandForm.$setPristine(),i.addNotification({title:"Band profile updated",action:`<a class="button-scd button-height-32 button-padding-16 button-rounded" href="${o.href("band.feed",{username:a.username})}"><i class="icon-arrow-right"></i></a>`,classList:"success",autoclose:8e3}),e.eventTrack("Update Band",{category:"Band",label:c.id})})).catch((function(e){n.bandForm.$setPristine(),n.errorMessage=e?.data.message||"Please verify that the information is correct.",n.changeError=!0}))}}]),angular.module("bandlab.band").controller("BandFollowCtrl",["$rootScope","$scope","$state","appActions","Band","Me",function(e,t,n,o,r,i){t.toggleFollowBand=function(a){if(!o.checkAllowed("follow"))return;if(t.isFollowLoading)return;t.isFollowLoading=!0;const s="None"===a.followingState?"follow":"unfollow";"follow"===s&&yv({bandId:a.id,triggeredFrom:_p(n)}),r[s]({id:a.id,followerId:i.id}).$promise.then((()=>{a.followingState="None"===a.followingState?"Following":"None",e.$broadcast("$band:relationChanged",{band:a})})).finally((()=>{t.isFollowLoading=!1}))},t.isFollowLoading=!1}]),angular.module("bandlab.band").controller("BandInviteCtrl",["$rootScope","$scope","Band","Invite","Me","Modal",function(e,t,n,o,r,i){t.invite=new o,t.invite.userIds=[t.user.id],n.fromUser({userId:r.id,limit:40,role:"Owner,Admin"}).$promise.then((e=>(t.bands=e,e))),t.$watch("invite.bandId",(function(e){e&&(t.formInviteUser.bandId.$setValidity("forbidden",!0),t.formInviteUser.bandId.$setValidity("unavailable",!0))})),t.sendInvite=function(){delete t.inviteSent,t.invite.$save({rel:"bands",id:t.invite.bandId}).then((function(){e.$broadcast("$invite:changed",{invite:t.invite}),t.inviteSent=!0,t.band=n.get({id:t.invite.bandId}),delete t.invite})).catch((function(e){403===e.status?t.formInviteUser.bandId.$setValidity("forbidden",!1):409===e.status&&t.formInviteUser.bandId.$setValidity("unavailable",!1),t.inviteSent=!1,t.formInviteUser.$setPristine(),t.errorMessage=_.get(e,"data.message")}))},t.openModalCreateBand=function(){const e=t.$on("$band:changed",((o,r)=>{let{action:i,band:a}=r;"create"===i&&(t.bands=[a].concat(t.bands),t.invite.bandId=a.id,t.formInviteUser.$setDirty()),e(),n.destroy()})),n=new i({id:"createBandModal",templateUrl:"https://www.bandlab.com/web-app/band/partials/_band-new-cb8b2674.html"});n.show()}}]),angular.module("bandlab.band").controller("BandJoinCtrl",["$rootScope","$scope","appActions","AppNotifications","ConfirmModal","Invite","Me","Modal",function(e,t,n,o,r,i,a,s){t.sendRequestToJoinBand=function(t){n.checkAllowed("bandRequestInvite")&&new s({contentScope:{invite:t.invite,submit:function(n){new i({message:n,userIds:[a.id]}).$save({rel:"bands",id:t.id}).then((function(){e.$broadcast("$band:changed",{action:"update",band:t}),e.$broadcast("$invite:changed"),o.addNotification({autoclose:8e3,classList:"success",title:"Request sent"})})).catch((function(e){201!==e.data?.errorCode&&202!==e.data?.errorCode&&o.addNotification({autoclose:8e3,classList:"alert",title:"Unable to send request",content:_.get(e,"data.message")})})).finally((function(){e.$broadcast("bandJoinRequestModal","close")}))}},id:"bandJoinRequestModal",templateUrl:"https://www.bandlab.com/web-app/band/partials/_band-join-request-59e6ed1a.html"}).show()},t.cancelRequestToJoinBand=function(t){new r({cancelLabel:"No",confirmLabel:"Yes",contentScope:{title:"Cancel Request",message:`Are you sure you want to <strong>cancel</strong> your request to join ${t.name}?`},id:"bandCancelRequestModal",onConfirm:function(){const n=new i;n.bandId=t.id,n.$remove({id:t.invite.id}).then((function(){e.$broadcast("$band:changed",{action:"update",band:t}),e.$broadcast("$invite:changed"),o.addNotification({autoclose:8e3,classList:"success",title:"Request canceled"})})).catch((function(e){o.addNotification({autoclose:8e3,classList:"alert",title:"Unable to cancel request",content:e.data.message})})).finally((function(){e.$broadcast("bandCancelRequestModal","close")}))}}).show()}}]),angular.module("bandlab.band").controller("BandLeaveCtrl",["$analytics","$scope","$state","AppNotifications","BandActions","ConfirmModal","Me","Modal",function(e,t,n,o,r,i,a,s){function l(){let{isLeaving:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r.deleteBand(t.band,o).then((()=>{e.eventTrack("Delete Band",{category:"Band"}),n.includes("band")&&n.go("user.feed",{username:a.username})})).catch((e=>u(e,"Unable to delete the band")))}function c(){return new i({confirmLabel:"Leave",contentScope:{title:"Leave band now?",message:"<p>Band ownership has been transferred. Youre now an admin of the band.</p>"},onConfirm:function(){r.leaveBandWithoutConfirmation(t.band).then((function(){e.eventTrack("Leave Band",{category:"Band",label:t.band.id})})).catch((e=>u(e,"Unable to leave the band. Please try again.")))}}).show()}function u(e,t){"Cancelled"!==e&&o.addNotification({title:t,content:_.get(e,"data.message")||_.get(e,"message","Unknown error"),autoclose:5e3,classList:"alert"})}t.deleteBand=l,t.leaveBand=function(){return 1===t.band.counters.members?l({isLeaving:!0}):"Owner"===t.userRole?new i({confirmLabel:"Transfer",contentScope:{title:"Transfer Ownership",message:"<p>Before leaving, you need to transfer ownership to one of the members here.</p>"},onConfirm:function(){new s({id:"transferOwnershipModal",templateUrl:"https://www.bandlab.com/web-app/band/partials/_band-transfer-owner-modal-5fb91c8e.html",contentScope:{band:t.band,transferOwnershipCallback:c}}).show()}}).show():r.leaveBand(t.band).then((function(){e.eventTrack("Leave Band",{category:"Band",label:t.band.id})})).catch((e=>u(e,"Unable to leave the band. Please try again.")))},t.userRole=t.band.role,t.$on("$band:changed",(function(e,n){let{action:o,data:r}=n;"role"===o&&(t.userRole=r.role)}))}]),angular.module("bandlab.band").controller("BandManageCtrl",["$scope","Invite","User",function(e,t,n){function o(){t.query({id:e.band.id,entity:"bands",accepted:!1,limit:50}).$promise.then((function(t){e.pendingInvitedUser=[],e.pendingInvitedExternalUser=[],t.forEach((function(t){var o;t.user?((o=new n(t.user)).invite=t,e.pendingInvitedUser.push(o)):((o=new n({email:t.email})).invite=t,e.pendingInvitedExternalUser.push(o))}))}))}e.$on("$invite:changed",(function(){o()})),o()}]),angular.module("bandlab.band").controller("BandMembersCtrl",["$injector","$rootScope","$scope","AppNotifications","BandActions","Me","Role","User",function(e,t,n,o,r,i,a,s){function l(){s.fromBand({bandId:n.band.id,accepted:!0}).$promise.then((e=>{let{data:t}=e;n.members=t}))}function c(e){o.addNotification({title:e?.data?.message??"Something went wrong, please try again later",classList:"alert",autoclose:5e3})}n.me=i,n.removeMember=function(e){r.removeMember(n.band,e).then((function(){Gf(n.members,(function(t){return t.id===e.id})),n.band.counters.members-=1})).then((function(){})).catch((function(e){c(e)}))},n.updateRole=function(e,o){if("Owner"===o){const o=_.find(n.members,{role:"Owner"});return r.assignOwnership(n.band,e).then((()=>{o.role="Admin","Owner"===n.band.role&&n.setUserRole("Admin"),t.$broadcast("$band:changed",{action:"role",data:o}),n.transferOwnershipCallback&&n.transferOwnershipCallback()})).catch((e=>{c(e),l()}))}a.setUserRole({bandId:n.band.id,userId:e.id,role:o}).then((()=>{e.role=o})).catch((e=>{c(e),l()}))},n.userRole=n.band.role,n.setUserRole=function(e){n.userRole=e,n.band.role=e},n.$on("$invite:changed",l),l()}]),angular.module("bandlab.band").component("bandCard",{bindings:{band:"="},templateUrl:"https://www.bandlab.com/web-app/band/partials/_band-card-ae759a32.html",controller:["Me",function(e){const t=this;Mp(e,"follow_bands_enabled").then((e=>{t.isFollowBandsEnabled="true"===e}))}],controllerAs:"vm"}),angular.module("bandlab.band").component("bandMembersCard",{bindings:{band:"="},templateUrl:"https://www.bandlab.com/web-app/band/partials/_band-members-card-18bef77d.html",controller:["$element","$state","$rootScope","$timeout","User",function(e,t,n,o,r){const i=this;function a(){t.params.members&&function(){const t=e[0].querySelector("[users-modal]");o((()=>{})).then((function(){t.click()}))}(),s({limit:10}).then((e=>{let{data:t}=e;i.users=t}))}function s(e){return r.fromBand(Object.assign(e,{bandId:i.band.id,accepted:!0})).$promise}i.$onInit=a,i.getMembers=s,n.$on("$invite:changed",a)}],controllerAs:"vm"}),angular.module("bandlab.band").component("bandProfilePopover",{bindings:{band:"<"},template:'\n      <div class="popover-content">\n        <band-tile band="vm.band" class="collapse"></band-tile>\n      </div>\n    ',controllerAs:"vm"}),angular.module("bandlab.band").component("bandTile",{bindings:{band:"="},transclude:{actions:"?bandTileActions"},templateUrl:"https://www.bandlab.com/web-app/band/partials/_band-tile-2937e64c.html",controllerAs:"vm",controller:["$scope","User",function(e,t){const n=this;n.getMembers=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.fromBand(Object.assign({bandId:n.band.id,limit:50,accepted:!0},e)).$promise},e.$on("$band:changed",((e,t)=>{let{action:o,band:r}=t;"update"===o&&n.band&&r.id===n.band.id&&Object.assign(n.band,r)}))}]}),angular.module("bandlab.band").component("bandTileMembers",{bindings:{band:"="},templateUrl:"https://www.bandlab.com/web-app/band/partials/_band-tile-members-3811a163.html",controller:["User",function(e){const t=this;t.getMembers=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.fromBand(Object.assign({bandId:t.band.id,limit:50,accepted:!0},n)).$promise}}],controllerAs:"vm"}),angular.module("bandlab.band").factory("Band",["$http","$resource",function(e,t){const n="bands",o=`https://www.bandlab.com/api/v1.3/${n}`;return t(o,{},{delete:{method:"DELETE",params:{id:"@id"},url:`${o}/:id`},fromUser:{method:"GET",isArray:!0,params:{userId:"",limit:10,offset:0},url:`https://www.bandlab.com/api/v1.3/users/:userId/${n}`},follow:{method:"POST",params:{id:"@id",followerId:"@followerId"},url:`${o}/:id/followers/:followerId`},get:{method:"GET",params:{id:"@id"},url:`${o}/:id`},getFollowers:{method:"GET",params:{id:"@id",limit:10},preservePagination:!0,url:`${o}/:id/followers`},save:{method:"POST",url:o,transformResponse:[...e.defaults.transformResponse,NL]},saveToSchool:{method:"POST",params:{schoolId:"@schoolId"},url:"https://www.bandlab.com/api/v1.3/schools/:schoolId/classrooms"},unfollow:{method:"DELETE",params:{id:"@id",followerId:"@followerId"},url:`${o}/:id/followers/:followerId`},update:{method:"PATCH",params:{id:"@id"},url:`${o}/:id`}})}]),angular.module("bandlab.band").factory("BandActions",["$q","$rootScope","authService","ConfirmModal","Me","Role",function(e,t,n,o,r,i){return{assignOwnership:function(t,n){return e((function(e,r){return new o({confirmLabel:"Transfer",contentScope:{title:`Transfer ownership to ${n.name}?`,message:"<p>Your ownership rights will be given to the selected user.</p>"},onCancel:r,onConfirm:function(){i.setUserRole({bandId:t.id,userId:n.id,role:"Owner"}).then((function(t){n.role=t.role,e(n)})).catch(r)}}).show().catch(r)}))},deleteBand:function(r,i){return e((function(e,a){return new o({confirmLabel:"Delete",contentScope:{title:i?"Leave Band":"Delete Band",message:`\n            <div class="text-left">\n              ${i?"<p>Youre the only member of this band. If you leave, this band will be deleted.</p>":""}\n              <p>Deleting a band cannot be undone. By doing so:</p>\n              <ul>\n                <li>You will lose access to any project saved by the band.</li>\n                <li>All band members will no longer be in the band.</li>\n                <li>All band members will lose access to any existing projects owned by the band.</li>\n              </ul>\n              <p>Are you sure you want to delete <strong>${r.name}</strong>?</p>\n            </div>\n          `},onCancel:()=>a("Cancelled"),onConfirm:function(){t.$broadcast("$band:changed",{action:"mark-deleted",band:r}),r.$delete().then(n.refreshMe).then((function(){t.$broadcast("$band:changed",{action:"delete",band:r}),e(r)})).catch((e=>{t.$broadcast("$band:changed",{action:"unmark-deleted",band:r}),a(e)}))}}).show().catch(a)}))},leaveBand:function(n){return e((function(e,a){return new o({confirmLabel:"Leave",contentScope:{title:"Leave this band?"},onCancel:()=>a("Cancelled"),onConfirm:function(){t.$broadcast("$band:changed",{action:"mark-deleted",band:n}),i.removeUserRole({bandId:n.id,userId:r.id}).then((()=>{t.$broadcast("$band:left",{band:n}),e(n)})).catch((e=>{t.$broadcast("$band:changed",{action:"unmark-deleted",band:n}),a(e)}))}}).show().catch(a)}))},leaveBandWithoutConfirmation:function(e){t.$broadcast("$band:changed",{action:"mark-deleted",band:e}),i.removeUserRole({bandId:e.id,userId:r.id}).then((()=>(t.$broadcast("$band:left",{band:e}),e))).catch((n=>{throw t.$broadcast("$band:changed",{action:"unmark-deleted",band:e}),n}))},removeMember:function(t,n){return e((function(e,r){return new o({confirmLabel:"Remove",contentScope:{title:"Remove Member",message:"<p>Remove this member from your band?</p>"},onCancel:r,onConfirm:function(){i.removeUserRole({bandId:t.id,userId:n.id}).then(e).catch(r)}}).show().catch(r)}))}}}]),angular.module("bandlab.banner",[]),angular.module("bandlab.banner").directive("banner",["$analytics","$compile","$templateRequest","Me","User",function(e,t,n,o,r){const i=new Map,a=new Map,s=UL((function(e){return Promise.resolve().then((()=>Ap)).then((function(t){let{getAmplitudeFeatureFlag:n}=t;return n(o,e)}))}),{cache:i}),c=UL((function(e){return n(e)}),{cache:a});return{restrict:"E",link:async function(n,u,d){if(d.amplitudeFlag){const e=i.has(d.amplitudeFlag)?i.get(d.amplitudeFlag):await s(d.amplitudeFlag);d.bannerId=e}else if(d.bannerId)"membership-side"===d.bannerId&&await r.getMembershipStatus({userId:o.id}).$promise.then((e=>{let{plan:t}=e;return"Free"!==t}))&&u[0].remove();else{const e=await r.getMembershipStatus({userId:o.id}).$promise.then((e=>{let{plan:t}=e;return"Free"!==t})),t=["opportunities-side"];d.bannerId=(p=e?t:["membership-side",...t])[Math.floor(Math.random()*p.length)]}var p;n.closeBanner=(e,t)=>{e.stopPropagation(),e.target.closest("banner").remove();const n={songstarter:"hide_songstarter_feed_banner",splitter:"hide_splitter_feed_banner"}[t],o=parseInt(l.get(f(n))),r=o?15===o?o:2*o+1:3;l.set(f(t),!0,{expires:r,domain:"bandlab.com"}),l.set(f(n),r,{domain:"bandlab.com"})};const m={"membership-side":await s("4july_2024").then((e=>"on"===e))?"https://www.bandlab.com/web-app/banner/partials/_membership-side-promo-banner-415af30d.html":"https://www.bandlab.com/web-app/banner/partials/_membership-side-banner-d60bd286.html","mobile-apps":"https://www.bandlab.com/web-app/banner/partials/_mobile-apps-f8167976.html","crowd-review-side":"https://www.bandlab.com/web-app/banner/partials/_crowd-review-side-banner-bd54ca5b.html","opportunities-side":"https://www.bandlab.com/web-app/banner/partials/_opportunities-side-banner-c8dc1b0f.html",songstarter:"https://www.bandlab.com/web-app/banner/partials/_song-starter-feed-banner-3e0d3cef.html",splitter:"https://www.bandlab.com/web-app/banner/partials/_splitter-feed-banner-54076c42.html","payouts-side":"https://www.bandlab.com/web-app/banner/partials/_payouts-side-banner-5ee7361f.html","user-tracks-boost":"https://www.bandlab.com/web-app/banner/partials/_user-tracks-boost-banner-5b8f9485.html"}[d.bannerId];if(!m)return void u.remove();function f(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"banner";return d.cookiesKey?e.concat("_").concat(d.cookiesKey):e}const h=a.has(m)?a.get(m):await c(m);l.get(f(d.bannerId))?u.remove():u.append(t(h)(n)),n.logOpenEvent=(t,n)=>{e.eventTrack(t,{platform:"firebase",params:{open_from:n}})},n.membershipBannerTitleTemplate='Propel your creator journey with \n          <div class="banner-membership-crown-title">\n            <img src="https://www.bandlab.com/web-app/images/membership/membership-banner-crown-969da10782.svg">\n            Membership\n          </div>\n        ',n.membershipBannerOverviewTitleTemplate='Unlock exclusive benefits with \n          <div class="banner-membership-crown-title">\n            <img src="https://www.bandlab.com/web-app/images/membership/membership-banner-crown-969da10782.svg">\n            Membership\n          </div>\n        '}}}]),angular.module("bandlab.banner").directive("mobileAppBanner",(function(){return{restrict:"E",replace:!0,templateUrl:"https://www.bandlab.com/web-app/banner/partials/_mobile-app-banner-2838a68f.html",link:function(e,t){Zf&&!p()||t.remove()}}})),angular.module("bandlab.banner").directive("modalDownloadAppsSmall",["$cookies","$transitions","Modal",function(e,t,n){return{restrict:"E",link:function(o){if(!Zf)return;const r=t.onFinish({},(async function(t){const i=t.to();e.get("modalDownloadAppsSeen")||"true"===e.get("webview")||(/user\./.test(i.name)?o.downloadUrl=MS(window.location.href):["post","track"].includes(i.name)?o.downloadUrl=function(e,t){const{pathname:n,search:o}=new URL(e);return`https://get-bandlab.app.link/S3O7LORh2kb?$canonical_url=${PS(n)+o}&~channel=${t}`}(window.location.href,t.params().revId):o.downloadUrl=ES(window.location.href),new n({class:"mobile-apps-small-overlay",templateUrl:"https://www.bandlab.com/web-app/banner/partials/_mobile-apps-small-18350f17.html",onDestroy:function(){const t=new Date;t.setHours(t.getHours()+1),e.put("modalDownloadAppsSeen","true",{expires:t})}}).show(),r())}))}}}]),angular.module("bandlab.chat",[]),FL.$inject=["$scope","$stateParams"],angular.module("bandlab.chat.routes",["ui.router"]).config(["$stateProvider",function(e){e.state("chat",{url:"/chat?requests&contacts",redirectTo:function(){return Zf?"unavailable":null},params:{contacts:{dynamic:!0},requests:{dynamic:!0}},templateUrl:"https://www.bandlab.com/web-app/chat/views/chat-layout-caebc16c.html",resolve:{templates:["$templateCache","$templateRequest","$q",function(e,t,n){return n.all([t("https://www.bandlab.com/web-app/chat/partials/_conversation-085b160e.html"),t("https://www.bandlab.com/web-app/chat/partials/_conversation-input-1a7be08f.html"),t("https://www.bandlab.com/web-app/chat/partials/_conversation-new-4aa894b5.html")]).then((function(t){t.forEach(e.put)})).catch((function(){}))}],theConversationRequests:["Chat",function(e){return e.getconversationRequests()}]},controller:["$filter","$q","$scope","$state","Chat","ChatCache","ChatHelper","ConfirmModal","theConversationRequests","Me",function(e,t,n,o,r,i,a,s,l,c){let u,d=t.resolve(),p=l.data.paging.cursors.after;i.conversationsRequests=l.data.data,n.conversationRequestsDisplayed="true"===o.params.requests,n.conversationRequests=l.data.data,n.infiniteScrollRequestsEnded=l.data.paging.itemsCount<l.data.paging.limit,n.chatCache=i,n.getConversations=a.getConversations,n.declineConversationRequests=function(e){return new s({confirmLabel:"Delete",contentScope:{title:"Delete all?",message:"<p>Ensure that youre not deleting a request from someone you know.</p>"},onConfirm:function(){r.declineConversationRequests(e).then((function(){return o.go("chat",{},{reload:!0})}))}}).show()},n.showConversationRequests=function(){o.go(".",{contacts:!1}),n.conversationRequestsDisplayed=!0},n.loadMoreRequests=function(){return n.infiniteScrollRequestsEnded?t.resolve([]):(d=d.then((()=>r.getconversationRequests({after:p}))).then((e=>{p=e.data.paging.cursors.after,n.conversationRequests=n.conversationRequests.concat(e.data.data),n.infiniteScrollRequestsEnded=e.data.paging.itemsCount<e.data.paging.limit||!p})),d)},n.loadMore=function(){return n.infiniteScrollEnded?t.resolve([]):(d=d.then((()=>r.getConversations(50,u))).then((e=>{u=e.data.paging.cursors.after,n.infiniteScrollEnded=!u})),d)},n.loadMore().then((function(){"chat"===o.current.name&&(i.conversations.length?n.conversationRequestsDisplayed&&n.conversationRequests.length?o.go("chat.conversation",{id:n.conversationRequests[0].id}):(n.conversationRequestsDisplayed=!1,o.go("chat.conversation",{id:i.conversations[0].id,requests:!1})):o.go("chat.new",{contacts:!0}))})),n.$on("$conversation:leave",(function(e,t){Gf(n.conversationRequests,{id:t.id}),Gf(i.conversations,{id:t.id}),f()})),n.$on("$conversation:messagesRead",(function(e,t){const o=_.find(n.conversationRequests,{id:t.id});o&&(o.unreadMessageCount=t.unreadMessageCount)}));const m=ay((e=>{r.getOneConversation(e.conversation.id,{isChannel:"Channel"===e.conversation.type}).then((function(t){var n=_.find(i.conversations,{id:e.conversation.id});n?(n.previewMessage=angular.copy(t.previewMessage),a.updateConversationLastMessage(n,e),-1===document.location.pathname.indexOf(n.id)&&(n.unreadMessageCount=t.unreadMessageCount)):i.conversations.unshift(t)}))}),5e3,{trailing:!0,maxWait:5e3});function f(){n.conversationRequestsDisplayed=!1,i.conversations[0]?o.go("chat.conversation",{id:i.conversations[0].id},{location:"replace"}):o.go("chat.new",{contacts:!0},{location:"replace"})}n.$on("$message:new",(function(e,t){var n=_.find(i.conversations,{id:t.conversation.id});if(n){if(n.previewMessage=Object.assign({},t),n.date=t.createdOn,a.updateConversationLastMessage(n,t),t.attachments?.length>0){const e=n.previewMessage.attachments[0];n.previewMessage.attachmentType=e.type,n.previewMessage.content=e.caption,n.previewMessage.abstract=n.previewMessage.content}-1===document.location.pathname.indexOf(n.id)&&n.lastMessageSenderId!==c.id&&n.unreadMessageCount++}else m(t)})),n.$on("$band:left",(function(){f()})),n.$watch("searchConversation",(function(t){!n.infiniteScrollEnded&&t&&function t(){e("filter")(i.conversations,{keywords:n.searchConversation}).length>50||n.infiniteScrollEnded||d.then((()=>n.loadMore())).then((()=>t()))}()})),Promise.resolve().then((()=>rb)).then((function(e){let{logChatOpen:t}=e;t()}))}]}).state("chat.new",{url:"/new",redirectTo:function(){return Zf?"unavailable":null},views:{conversation:{templateUrl:"https://www.bandlab.com/web-app/chat/partials/_conversation-new-4aa894b5.html"}}}).state("chat.conversation",{url:"/{id:[a-zA-Z0-9-_]+}",redirectTo:function(){return Zf?"unavailable":null},params:{rewriteTracking:function(){return()=>"/chat/conversation"}},views:{header:{template:'<conversation-header conversation-id="conversationId"></conversation-header>',controller:FL},conversation:{template:'<conversation conversation-id="conversationId"></conversation>',controller:FL},partner:{template:'<conversation-partner conversation-id="conversationId"></conversation-partner>',controller:FL}}}).state("chat.channel",{url:"/channel/{id:[a-zA-Z0-9-_]+}",redirectTo:function(){return Zf?"unavailable":null},params:{rewriteTracking:function(){return()=>"/chat/channel"}},views:{header:{template:'<conversation-header conversation-id="conversationId"></conversation-header>',controller:FL},conversation:{template:'<conversation conversation-id="conversationId"></conversation>',controller:FL},partner:{template:'<conversation-partner conversation-id="conversationId"></conversation-partner>',controller:FL}}})}]),angular.module("bandlab.chat").controller("ConversationListCtrl",["$scope","Chat","ChatHelper",function(e,t,n){return n.getConversations().length>0&&(e.getConversations=n.getConversations),t.getConversations(15).then((()=>{e.getConversations=n.getConversations}))}]);var BL=Object.prototype.hasOwnProperty;function WL(e,t,n){var o=e[t];BL.call(e,t)&&Pc(o,n)&&(void 0!==n||t in e)||BI(e,t,n)}function VL(e,t,n,o){var r=!n;n||(n={});for(var i=-1,a=t.length;++i<a;){var s=t[i],l=o?o(n[s],e[s],s,n,e):void 0;void 0===l&&(l=e[s]),r?BI(n,s,l):WL(n,s,l)}return n}var qL=Object.prototype.hasOwnProperty;function zL(e){return Wm(e)?Om(e,!0):function(e){if(!rc(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=Dm(e),n=[];for(var o in e)("constructor"!=o||!t&&qL.call(e,o))&&n.push(o);return n}(e)}var HL="object"==typeof exports&&exports&&!exports.nodeType&&exports,GL=HL&&"object"==typeof module&&module&&!module.nodeType&&module,KL=GL&&GL.exports===HL?Gl.Buffer:void 0,YL=KL?KL.allocUnsafe:void 0;function JL(e,t){var n=-1,o=e.length;for(t||(t=Array(o));++n<o;)t[n]=e[n];return t}const XL=Nm(Object.getPrototypeOf,Object);var ZL=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)rm(t,dm(e)),e=XL(e);return t}:sm;const QL=ZL;function eO(e){return am(e,zL,QL)}var tO=Object.prototype.hasOwnProperty;function nO(e){var t=new e.constructor(e.byteLength);return new Fp(t).set(new Fp(e)),t}var oO=/\w*$/,rO=Kl?Kl.prototype:void 0,iO=rO?rO.valueOf:void 0,aO="[object Boolean]",sO="[object Date]",lO="[object Map]",cO="[object Number]",uO="[object RegExp]",dO="[object Set]",pO="[object String]",mO="[object Symbol]",fO="[object ArrayBuffer]",hO="[object DataView]",gO="[object Float32Array]",vO="[object Float64Array]",bO="[object Int8Array]",yO="[object Int16Array]",wO="[object Int32Array]",$O="[object Uint8Array]",kO="[object Uint8ClampedArray]",SO="[object Uint16Array]",_O="[object Uint32Array]";var PO=Object.create,MO=function(){function e(){}return function(t){if(!rc(t))return{};if(PO)return PO(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();const TO=MO;var CO=Rm&&Rm.isMap;const EO=CO?Tm(CO):function(e){return zu(e)&&"[object Map]"==cf(e)};var IO=Rm&&Rm.isSet;const RO=IO?Tm(IO):function(e){return zu(e)&&"[object Set]"==cf(e)};var AO=1,xO=2,LO=4,OO="[object Arguments]",jO="[object Function]",DO="[object GeneratorFunction]",NO="[object Object]",UO={};function FO(e,t,n,o,r,i){var a,s=t&AO,l=t&xO,c=t&LO;if(n&&(a=r?n(e,o,r,i):n(e)),void 0!==a)return a;if(!rc(e))return e;var u=im(e);if(u){if(a=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&tO.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!s)return JL(e,a)}else{var d=cf(e),p=d==jO||d==DO;if(wm(e))return function(e,t){if(t)return e.slice();var n=e.length,o=YL?YL(n):new e.constructor(n);return e.copy(o),o}(e,s);if(d==NO||d==OO||p&&!r){if(a=l||p?{}:function(e){return"function"!=typeof e.constructor||Dm(e)?{}:TO(XL(e))}(e),!s)return l?function(e,t){return VL(e,QL(e),t)}(e,function(e,t){return e&&VL(t,zL(t),e)}(a,e)):function(e,t){return VL(e,dm(e),t)}(e,function(e,t){return e&&VL(t,Vm(t),e)}(a,e))}else{if(!UO[d])return r?e:{};a=function(e,t,n){var o,r,i,a=e.constructor;switch(t){case fO:return nO(e);case aO:case sO:return new a(+e);case hO:return function(e,t){var n=t?nO(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case gO:case vO:case bO:case yO:case wO:case $O:case kO:case SO:case _O:return function(e,t){var n=t?nO(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}(e,n);case lO:return new a;case cO:case pO:return new a(e);case uO:return(i=new(r=e).constructor(r.source,oO.exec(r))).lastIndex=r.lastIndex,i;case dO:return new a;case mO:return o=e,iO?Object(iO.call(o)):{}}}(e,d,s)}}i||(i=new xp);var m=i.get(e);if(m)return m;i.set(e,a),RO(e)?e.forEach((function(o){a.add(FO(o,t,n,o,e,i))})):EO(e)&&e.forEach((function(o,r){a.set(r,FO(o,t,n,r,e,i))}));var f=u?void 0:(c?l?eO:qm:l?zL:Vm)(e);return function(e,t){for(var n=-1,o=null==e?0:e.length;++n<o&&!1!==t(e[n],n););}(f||e,(function(o,r){f&&(o=e[r=o]),WL(a,r,FO(o,t,n,r,e,i))})),a}UO[OO]=UO["[object Array]"]=UO["[object ArrayBuffer]"]=UO["[object DataView]"]=UO["[object Boolean]"]=UO["[object Date]"]=UO["[object Float32Array]"]=UO["[object Float64Array]"]=UO["[object Int8Array]"]=UO["[object Int16Array]"]=UO["[object Int32Array]"]=UO["[object Map]"]=UO["[object Number]"]=UO[NO]=UO["[object RegExp]"]=UO["[object Set]"]=UO["[object String]"]=UO["[object Symbol]"]=UO["[object Uint8Array]"]=UO["[object Uint8ClampedArray]"]=UO["[object Uint16Array]"]=UO["[object Uint32Array]"]=!0,UO["[object Error]"]=UO[jO]=UO["[object WeakMap]"]=!1;var BO=1,WO=4;function VO(e){return FO(e,BO|WO)}const qO={AUDIO:"Audio",IMAGE:"Image",VIDEO:"Video"},zO={ATTACHMENTS:"Attachments",GIF:"Animation",LINKS:"Links",TEXT:"Text"};function HO(e){return new Set(Object.values(qO)).has(e)}function GO(e){return e.links?.[0]?.url?.match(/bandlab\.com\/join/)}function KO(e){const t=e.attachments?.[0]?.type;return"Deleted"!==e.status&&(e.messageContentType===zO.LINKS||e.messageContentType===zO.GIF||e.messageContentType===zO.ATTACHMENTS&&(t===qO.IMAGE||t===qO.VIDEO))}function YO(e){const t=e.attachments?.[0]?.type,n="https://www.bandlab.com/web-app/images/attachment-placeholder-782a26760a.png";return t===qO.IMAGE?e.attachments[0].image.url:t===qO.VIDEO?e.attachments[0].video.previewUrl:e.messageContentType===zO.GIF?e.animation.previewUrl:e.messageContentType===zO.LINKS?e.links[0].image??n:n}function JO(e,t){return{showUploadStatus:function(n,o){let r="Uploading",i="";"success"===n?r="Upload completed":"error"===n&&(r="Unable to send message",i="alert"),t.clearAll(),t.addNotification({title:r,classList:i,content:o,autoclose:"uploading"===n?null:5e3}),e.$applyAsync()}}}function XO(e){return{reportMessage:function(t,n){new(e.get("Modal"))({id:"reportChatMessageModal",templateUrl:"https://www.bandlab.com/web-app/contact/partials/report-5c109c3e.html",contentScope:{toReport:{objectType:"ChatMessage",objectId:n,subObjectId:t.id,creator:t.sender}}}).show()}}}function ZO(){function e(e){e.preventDefault(),e.stopPropagation()}return uo((()=>{window.removeEventListener("wheel",e,{passive:!1})})),{lockScrollIfDropdownActive:function(t){t?window.addEventListener("wheel",e,{passive:!1}):window.removeEventListener("wheel",e,{passive:!1})}}}function QO(e,t){const n=e.get("$rootScope"),o=e.get("$state"),r=e.get("AppNotifications"),i=e.get("Me"),a=`https://www.bandlab.com/api/v1.3/users/${i.id}/conversations/${t.conversation.id}/messages/${t.message.id}/reactions`;return{getEmojiReactions:function(){return Uu.get(a).json()},createEmojiReaction:function(e){const{revertMessageReactions:n}=d();t.message.initiatorReaction=e,s(e);const r={reaction:e};Uu.post(a,{json:r}).json().then((()=>{c(),jv(r,o)})).catch((e=>{u(e),n()}))},updateEmojiReaction:function(e){const{currentInitiatorReaction:n,revertMessageReactions:o}=d();t.message.initiatorReaction=e,s(e),l(n),Uu.patch(a,{json:{reaction:e}}).json().then((()=>{c()})).catch((e=>{u(e),o()}))},deleteEmojiReaction:function(){const{currentInitiatorReaction:e,revertMessageReactions:n}=d();t.message.initiatorReaction=null,l(e),Uu.delete(a).then((()=>{c()})).catch((e=>{u(e),n()}))}};function s(e){t.message.reactions||(t.message.reactions=[]);const n=t.message.reactions?.findIndex((t=>t.reaction===e));-1!==n?t.message.reactions[n].count++:t.message.reactions.push({reaction:e,count:1}),t.$applyAsync()}function l(e){const n=t.message.reactions.findIndex((t=>t.reaction===e));t.message.reactions[n].count--,0===t.message.reactions[n].count&&t.message.reactions.splice(n,1),t.$applyAsync()}function c(){n.$broadcast("$message:reactionUpdated",{conversationId:t.conversation.id,initiatorReaction:t.message.initiatorReaction,memberId:i.id,messageId:t.message.id,reactions:t.message.reactions})}function u(e){let t="Something went wrong, please try again later";var n;"TypeError"===e.name?t="Check your internet connection and try again":e.response&&(t=e.response.json().message),n=t,r.addNotification({content:n,classList:"alert",autoclose:8e3})}function d(){const e=VO(t.message.reactions),n=t.message.initiatorReaction;return{currentInitiatorReaction:n,revertMessageReactions:function(){t.message.reactions=e,t.message.initiatorReaction=n,t.$applyAsync()}}}}const ej=[];function tj(e){const t=/^www\.(\S{2}[:?\d]*)\S*$/i;return e.split(/\s/).map((e=>e.replace(/[.,;!?]*$/,""))).filter((e=>nj(e)||t.test(e)))}function nj(e){try{new URL(e)}catch(e){return!1}return/https?:\/\//i.test(e)}function oj(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;const n=[rj,ij,aj,sj].reduce(((e,t)=>t(e)),[{value:e}]).filter((e=>""!==e.value));return e===t?n:function(e,t){const n=[];let o=0;for(const r of e){if(!(o+r.value.length<t.length)){const e=o+r.value.length-t.length;r.value=r.value.substring(0,r.value.length-e),n.push(r),n.push({value:""});break}n.push(r),o+=r.value.length}return n}(n,t)}function rj(e){return e.flatMap((function(e){let{value:t,...n}=e;if(Object.keys(n).length)return[{value:t,...n}];let o=0;const r=tj(t).flatMap((function(e){const n=e.includes("://")?"":"//",r=t.indexOf(e,o),i=t.substring(o,r);return o=r+e.length,[{value:i},{value:e,url:`${n}${e}`}]}));return r.push({value:t.substring(o,t.length)}),r}))}function ij(e){return e.flatMap((function(e){let{value:t,...n}=e;if(Object.keys(n).length)return[{value:t,...n}];let o=0;const r=(t.match(/(?!(\b[a-z0-9_@]+[.][a-z]+\b))(@\b[a-z0-9][a-z0-9_]{2,19}\b)/gi)??[]).flatMap((function(e){const n=/\w+/.exec(e)[0],r=t.indexOf(`@${n}`,o),i=t.substring(o,r);return o=r+n.length+1,[{value:i},{value:`@${n}`,username:n}]}));return r.push({value:t.substring(o,t.length)}),r}))}function aj(e){return e.flatMap((function(e){let{value:t,...n}=e;if(Object.keys(n).length)return[{value:t,...n}];let o=0;const r=(t.match(/(\s|^)(?!(\b[a-z0-9_@]+[.][a-z]+\b))(#\b[a-z0-9][a-z0-9_]{0,100}\b)/gi)??[]).flatMap((function(e){const n=/\w+/.exec(e)[0],r=t.indexOf(`#${n}`,o),i=t.substring(o,r);return o=r+n.length+1,[{value:i},{value:`#${n}`,hashtag:n}]}));return r.push({value:t.substring(o,t.length)}),r}))}function sj(e){return e.flatMap((function(e){let{value:t,...n}=e;if(Object.keys(n).length)return[{value:t,...n}];let o=0;const r=(t.match(/\b[0-9]{1,2}:[0-5][0-9]\b/g)??[]).flatMap((function(e){const n=t.indexOf(e,o),r=t.substring(o,n);return o=n+e.length,[{value:r},{value:e,timestamp:e}]}));return r.push({value:t.substring(o,t.length)}),r}))}angular.module("bandlab.chat").directive("chatMessage",["$injector",function(e){return{replace:!0,restrict:"E",scope:{conversation:"<",message:"="},link:async function(t,n){const o=Mt({conversation:t.conversation,message:t.message});t.$watch((function(e){const{message:t,conversation:n}=e;o.message=t,o.conversation=n}));const r=import("./chunk-8096dae6.js").then((function(r){let{mount:i}=r;return i(n[0],{$injector:e,scope:t},o)}));t.$on("$destroy",(async function(){(await r).unmount()})),ej.push(r)}}}]).directive("chatLoadingMessages",["$injector","$timeout",function(e,t){return{replace:!0,restrict:"E",scope:{conversation:"<",scrollToBottom:"&"},link:async function(n,o){const r=n.conversation;function i(){t(n.scrollToBottom,300,!1)}const a=import("./chunk-66ecfbc4.js").then((function(t){let{mount:a}=t;return a(o[0],{$injector:e,scope:n},{conversation:r,scrollToBottom:i})}));n.$on("$destroy",(async function(){(await a).unmount()})),ej.push(a)}}}]).directive("chatReadStatus",["$injector","$rootScope",function(e,t){return{replace:!0,restrict:"E",scope:{conversation:"=",message:"="},link:async function(n,o){const r=Mt({conversation:n.conversation,message:n.message});n.$watch((function(e){const{conversation:t,message:n}=e;r.conversation=t,r.message=n}),!0);const i=import("./chunk-e6eb8c2f.js").then((function(i){let{mount:a}=i;return a(o[0],{$injector:e,$rootScope:t,scope:n},r)}));n.$on("$destroy",(async function(){(await i).unmount()})),ej.push(i)}}}]).component("chatMemberJoinedMessages",{bindings:{getMembers:"&"},templateUrl:"https://www.bandlab.com/web-app/chat/partials/_member-joined-messages-3e27d924.html",controllerAs:"vm"}).directive("conversation",["$timeout",function(e){return{restrict:"E",templateUrl:"https://www.bandlab.com/web-app/chat/partials/_conversation-085b160e.html",scope:{conversationId:"=conversationId"},link:function(t,n){const o=n[0].querySelector(".conversation-body"),r=n[0].querySelector(".conversation-message-list");var i;function a(){if(t.oldestMessageReached&&o.removeEventListener("scroll",a),!t.isLoadingMoreMessages&&i>o.scrollTop&&0===o.scrollTop){const n=o.scrollHeight;t.loadOlderMessages(),e((()=>{o.scrollTo({top:o.scrollHeight-n})}),0)}i=o.scrollTop}function s(){const e=o.scrollHeight-o.offsetHeight-o.scrollTop;Math.abs(e)<20&&(o.scrollTop=o.scrollHeight)}t.isSupportedAttachment=HO,t.dismissChannelAlert=function(){ql.setItem("conversationChannelAlertClosed",!0),t.willShowChannelAlert=!1},t.willShowChannelAlert="true"!==ql.getItem("conversationChannelAlertClosed"),t.scrollToBottom=function(){o.scrollTop=o.scrollHeight},t.initBodyLayout=function(){if(o.clientHeight>r.clientHeight&&!t.oldestMessageReached)return t.loadOlderMessages().then(t.initBodyLayout);setTimeout((function(){Promise.allSettled(ej.splice(0,ej.length)).then((function(){o.style.overflowY="scroll",o.style.visibility="visible",o.scrollTop=o.scrollHeight,a(),o.addEventListener("scroll",a)}))}))},t.getUsersJoinedBetweenMessages=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!t.conversation?.members||"Band"!==t.conversation.type&&"Song"!==t.conversation.type)return[];const o=t.conversation?.members;return e||n?e?n?o.filter((t=>t.createdOn>e.createdOn&&t.createdOn<=n.createdOn)):o.filter((t=>t.createdOn>e.createdOn)):o.filter((e=>e.createdOn<=n.createdOn)):t.oldestDate?o.filter((e=>e.createdOn<t.oldestDate.toISOString())):[]},t.$on("elastic:resize",(function(){setTimeout(s,32)}))},controller:["$q","$scope","$state","$timeout","Chat","ChatCache","ChatHelper","FloatingChat","Me","User",function(e,t,n,o,r,i,a,s,l,c){var u,d,p=20;function m(){return d?e.resolve([]):u=r.getMessages(t.conversation,p).then((function(e){return d=!t.conversation.after,e}))}function f(){return t.oldestMessageReached?e.resolve():(t.isLoadingMoreMessages=!0,u=u.then((function(e){if(t.oldestMessageReached=d,t.messages=t.messages||[],t.messages=t.messages.concat(e),d){const e=new Date,n=t.messages.length?new Date(t.messages[t.messages.length-1].createdOn):e;t.oldestDate=n,e.getDate()===n.getDate()&&e.getMonth()===n.getMonth()&&e.getFullYear()===n.getFullYear()&&(t.chatStartedToday=!0)}return m()})).finally((function(){t.isLoadingMoreMessages=!1})))}function h(e){if(e.conversationId!==t.conversation.id)return;const n=t.messages.findIndex((t=>t.id===e.messageId));n>=0&&(t.messages[n].reactions=e.reactions,e.memberId===l.id&&(t.messages[n].initiatorReaction=e.initiatorReaction))}t.oldestMessageReached=!1,t.state=n,t.conversation=i.conversations.concat(i.conversationsRequests).find((e=>e.id===t.conversationId)),r.getOneConversation(t.conversationId,{isChannel:"Channel"===t.conversation?.type||n.is("chat.channel")}).then((function(e){return t.conversation=e,t.canMessage=e.permissions?.message||"Band"===e.type,m()})).then((function(){return f()})).then((function(){return t.initBodyLayout()})).then((function(){t.$on("$conversation:memberAdded",(function(e,n){t.conversation.id===n.conversationId&&a.updateConversationMember(t.conversation,n)})),t.$on("$message:new",(function(e,n){if(n.conversation.id===t.conversation.id&&!_.find(t.messages,{id:n.id})){if(a.addRelativeMessageData(n,t.messages[0],!0),t.messages=_.orderBy([...t.messages,n],(function(e){return new Date(e.createdOn).getTime()}),["desc"]),o(t.scrollToBottom,300,!1),n.sender.id!==l.id){if(s.activeConversations[0]&&s.activeConversations[0].isMinimized)return;r.markAsRead(n,t.conversation).then((function(){t.conversation.unreadMessageCount=0,t.$emit("$message:read",t.conversation)}))}const e=i.conversations.find((e=>e.id===t.conversation.id));a.updateConversationLastMessage(e,n)}})),t.$on("$message:delete",(function(e,n){const o=_.findIndex(t.messages,{id:n.messageId});if(o<0)return;t.messages[o].status="Deleted",t.messages[o].content="This message was deleted",function(e){const n=t.messages.findIndex((t=>t.repliedMessage?.id===e));n<0||(t.messages[n].repliedMessage.status="Deleted",t.messages[n].repliedMessage.content="This message was deleted")}(n.messageId);const r=_.find(i.conversations,{id:n.conversationId});r&&r.lastMessageId===n.messageId&&(r.previewMessage=t.messages[o],a.updateConversationLastMessage(r,t.messages[o]))})),t.$on("$chat:openFloatingChat",(function(){r.markAllAsRead(t.conversation,t.messages)})),t.$on("$message:reactionCreated",(function(e,t){h(t)})),t.$on("$message:reactionDeleted",(function(e,t){h(t)})),t.$on("$message:reactionUpdated",(function(e,t){h(t)})),r.markAllAsRead(t.conversation,t.messages)})).catch((async function(e){if(!e||404!==e.status&&400!==e.status||Gf(i.conversations,(e=>e.id===t.conversationId)),e&&403===e.status&&(t.errorCode=403,t.messages=[],l.permissions.canCreateConversations)){t.isBlocked=!0;const e=n.params.id.split("_")[1],o=await c.get({id:e}).$promise,r={id:o.conversationId,partner:o,picture:o.picture,user:o,type:"User"};i.conversations=a.tidyConversations([r,...i.conversations])}else if(n.includes("chat"))return i.conversations.length?n.go("chat.conversation",{id:i.conversations[0].id},{reload:!0}):n.go("404")})),t.loadOlderMessages=f}]}}]).directive("chatUnconfirmedAccountZeroCase",(function(){return{restrict:"E",replace:!0,template:"<div></div>",controller:["$element","$scope",function(e,t){import("./chunk-75ecb44f.js").then((function(n){let{mountChatUnconfirmedAccountZeroCase:o}=n;const r=o(e[0]);t.$on("$destroy",(function(){r.unmount()}))}))}]}})),angular.module("bandlab.chat").component("conversationAttachment",{bindings:{attachments:"<"},templateUrl:"https://www.bandlab.com/web-app/chat/partials/_conversation-attachment-50ae3ac7.html",controller:["ChatHelper",function(e){const t=this;t.$onInit=function(){t.attachment=t.attachments[0],t.attachment.title||(t.attachment.title=t.attachment.url,e.getExternalUrl(t.attachment.url).then((function(e){t.attachment=e[0].object,t.attachment.title=t.attachment.title||t.attachment.url})))}}],controllerAs:"vm"}),angular.module("bandlab.chat").directive("conversationContacts",["$state",function(e){return{restrict:"A",link:function(t,n){const o=n[0].querySelector('[type="search"]');function r(r){if(27===r.keyCode)r.target!==o?(e.go(".",{contacts:!1}),t.$apply()):o.blur();else if(38===r.keyCode)i("previous");else if(40===r.keyCode)i("next");else if(13===r.keyCode){const e=n[0].querySelector(".conversation-tile.active");e&&e.click()}}function i(e){const t=n[0].querySelector(".conversation-tile.active"),o=n[0].querySelectorAll(".conversation-tile-container");if(o.length)if(t){const n=Array.from(o).indexOf(t.parentNode);t.classList.remove("active"),"next"===e?n+1===o.length?o[0].querySelector(".conversation-tile").classList.add("active"):o[n+1].querySelector(".conversation-tile").classList.add("active"):"previous"===e&&(n-1<0?o[o.length-1].querySelector(".conversation-tile").classList.add("active"):o[n-1].querySelector(".conversation-tile").classList.add("active"))}else"next"===e?o[0].querySelector(".conversation-tile").classList.add("active"):"previous"===e&&o[o.length-1].querySelector(".conversation-tile").classList.add("active")}o.addEventListener("keydown",(function(e){[27,38,40,13].indexOf(e.keyCode)>-1&&e.preventDefault()})),t.$watch(e.params.contacts,(function(e){e?(n[0].querySelector(".conversation-contacts-list").scrollTop=0,setTimeout((function(){o.focus()}),100),window.addEventListener("keyup",r)):(setTimeout((function(){o.blur()}),100),angular.element(n[0].querySelector(".conversation-tile.active")).removeClass("active"),window.removeEventListener("keyup",r))})),t.$on("$destroy",(function(){window.removeEventListener("keyup",r)}))},controller:["$scope","$state","Chat","ChatCache",function(e,t,n,o){e.startConversation=function(e){t.go(".",{contacts:!1}),n.startConversation(e.id)},o.getContacts().then((function(t){e.contacts=t}))}]}}]);const lj=Mt(new Map),cj=Vt(null),uj=Mt({}),dj=Mt({});function pj(e,t){uj[e]||(uj[e]=[]),uj[e].push(t)}function mj(e,t){if(!uj[e])return;const n=uj[e].findIndex((e=>e.id===t));n<0||uj[e].splice(n,1)}function fj(e,t){if(!uj[e])return;const n=uj[e].findIndex((e=>e.id===t.id));n<0||(uj[e].splice(n,1,t),uj[e]=[...uj[e]])}function hj(e,t,n){null!==cj.value&&cj.value!==n&&gj(cj.value),cj.value=n,lj.set(n,{audioPlayer:t,isPlaying:!0,hasPlayed:!0}),t.value.play(),hn((()=>{e.value.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})}))}function gj(e){const t=lj.get(e);t&&(t.isPlaying=!1,lj.set(e,t),t.audioPlayer&&t.audioPlayer.pause())}function vj(){gj(cj.value)}function bj(){lj.clear(),cj.value=null}function yj(e,t){dj[e]=t}function wj(e){delete dj[e]}function $j(e,t,n){const o=n.get("AppNotifications"),r=n.get("Modal"),i=n.get("Me"),a=n.get("Loader"),s=n.get("Song"),l=n.get("Chat");let c;const u=new r({templateUrl:"https://www.bandlab.com/web-app/chat/partials/_invite-to-project-86233a04.html",contentScope:{me:i,projects:()=>c,inviteToProject:n=>{t.get(`https://www.bandlab.com/api/v1.3/songs/${n.id}/invite-link`).then((function(t){let{data:{inviteLink:o}}=t;return function(t,n){const o=[{title:n.name,description:"",url:t,image:n.picture.url}];return u.destroy(),Promise.resolve().then((()=>rb)).then((e=>{let{logChatProjectInvitationSend:t}=e;t()})),l.sendMessage({conversation:e.getConversation(),content:"",links:o}).catch((e=>{let t="Something went wrong, please try again later";throw 404===e?.status?t="Unable to load conversation.":403===e?.status?t="New message is currently not allowed due to either your Chat Privacy Settings or the Recipients.":e?.data?.message&&(t=e?.data?.message),new Error(t)}))}(o,n)})).catch((e=>{let t="Something went wrong, please try again later";-1===e?.status&&(t="Check your internet connection and try again"),o.addNotification({title:"Unable to send invite, please try again",content:e.message||t,classList:"alert",autoclose:5e3})}))},loadMore:p},onCreate:function(){p()}});u.show();const d=a.create(s.fromUserWithCursor,{id:i.id,authorId:i.id,limit:15});function p(){return d.get().then((function(e){return c=c||[],c=c.concat(e),e}))}}function kj(e){return e!=e}function Sj(e,t){return!(null==e||!e.length)&&function(e,t){return t==t?function(e,t){for(var n=-1,o=e.length;++n<o;)if(e[n]===t)return n;return-1}(e,t):function(e,t){for(var n=e.length,o=-1;++o<n;)if(t(e[o],o,e))return o;return-1}(e,kj)}(e,t)>-1}function _j(e,t,n){for(var o=-1,r=null==e?0:e.length;++o<r;)if(n(t,e[o]))return!0;return!1}angular.module("bandlab.chat").directive("attachmentPicker",["$injector",function(e){return{restrict:"E",replace:!0,template:"",link:function(t,n){const o=import("./chunk-80038a77.js").then((e=>e.A)).then((o=>{let{mount:r}=o;return r(n[0],{$injector:e,scope:t})}));t.$on("$destroy",(async function(){(await o).unmount()}))}}}]).directive("chatInputReplyPreview",["$injector",function(e){return{restrict:"E",replace:!0,link:function(t,n){const o=import("./chunk-ac9f4a24.js").then((o=>{let{mount:r}=o;return r(n[0],{$injector:e,scope:t})}));t.$on("$destroy",(async function(){(await o).unmount()}))}}}]).directive("conversationInput",["$timeout","ChatHelper",function(e,t){return{restrict:"E",templateUrl:"https://www.bandlab.com/web-app/chat/partials/_conversation-input-1a7be08f.html",link:function(n,o,r){n.disabled=r.disabled;const i=angular.element(o[0].querySelector(".conversation-input-textarea"));function a(){if(!dj[n.conversationId])if(i.val().length&&n.messageBody){const e=tj(n.messageBody);e.length?(n.loading=!0,n.messageAttachment={type:"Link",url:e[0]}):n.messageAttachment=null}else n.messageAttachment=null,n.$digest()}function s(){if(n.messageAttachment){const e=n.messageAttachment.url;t.getExternalUrl(e).then((function(t){n.messageAttachment&&(n.messageAttachment={...t[0].object,url:e},n.loading=!1)}))}}t.resetMessageAttachmentsCache(),i.on("keydown",(function(e){13===e.which&&(e.shiftKey||!n.messageForm.$valid||n.messageForm.$submitted||(e.preventDefault(),n.messageForm.$setSubmitted(),n.submitMessageForm()))})),i.on("keyup",(function(e){13===e.which&&i.prop("selectionStart")===i.val().length&&setTimeout((function(){i[0].scrollTop=1e4}),10),a()})),i.on("keyup",ay(s,1e3)),i.on("paste",(function(){setTimeout((function(){a(),s(),n.$broadcast("elastic:adjust")}))})),n.focusInput=function(){return e((function(){i[0].focus()}),100)},n.$on("$chat:fillConversationInput",((e,t)=>{n.messageBody=t.message,n.focusInput().then((()=>i[0].select()))})),n.$on("$destroy",(function(){t.resetMessageAttachmentsCache()}))},controller:["$scope","$state","AppNotifications","Chat","ChatCache",function(t,n,o,r,i){function a(i){let{content:a,links:s,animation:l,attachments:c,repliedMessageId:u}=i;return d(!0),r.sendMessage({conversation:t.conversation,content:a,links:s,animation:l,attachments:c,repliedMessageId:u}).then((function(o){return Promise.resolve().then((()=>rb)).then((function(e){let{logChatSendMessage:t}=e;t(o,n)})),t.messageBody="",d(!1),wj(t.conversationId),t.focusInput(),e((()=>{t.$broadcast("elastic:adjust")}),0),o})).catch((function(e){throw d(!1),202!==e.data.errorCode&&o.addNotification({title:"Unable to send message",content:404===_.get(e,"status")?"Unable to load conversation.":403===_.get(e,"status")?_.get(e,"data.message"):"Something went wrong, please try again later",classList:"alert",autoclose:5e3}),e}));function d(e){t.isMessageSending=e,dj[t.conversationId]&&(dj[t.conversationId].isMessageSending=e)}}function s(){t.messageAttachment.type="hide"}t.hasAttachment=function(){return t.messageAttachment&&"hide"!==t.messageAttachment.type},t.messageAttachment=null,t.removeAttachment=s,t.submitMessageForm=function(){const e=t.messageBody;let n=null;const o=dj[t.conversationId]?.id;return t.messageAttachment&&"hide"!==t.messageAttachment.type&&(n=[t.messageAttachment]),t.messageAttachment=null,t.messageForm.$setPristine(),a({content:e,links:n,repliedMessageId:o})},t.sendMessage=a,t.loading=!1,Object.defineProperty(t,"messageBody",{get:function(){return i.getDraftInput(t.conversationId)||""},set:function(e){i.saveDraftInput(t.conversationId,e)},configurable:!0}),t.$applyAsync((()=>{t.$broadcast("elastic:adjust")})),t.$on("$message:removeLinkAttachment",(()=>{t.messageAttachment&&(s(),t.$applyAsync())}))}]}}]),angular.module("bandlab.chat").directive("conversationList",["$state",function(e){return{restrict:"C",link:function(t){t.openConversation=function(t){bj(),"Channel"===t.type?e.go("chat.channel",{id:t.id}):e.go("chat.conversation",{id:t.id})},t.$on("$destroy",(function(){bj()}))}}}]),angular.module("bandlab.chat").directive("conversationPartner",(function(){return{restrict:"E",replace:!0,templateUrl:"https://www.bandlab.com/web-app/chat/partials/_conversation-partner-c8114544.html",scope:{conversationId:"=conversationId"},controller:["$scope","$http","$injector","ChatCache","Me",function(e,t,n,o,r){e.getConversation=function(){return o.conversations.find((t=>t.id===e.conversationId))||o.conversationsRequests.find((t=>t.id===e.conversationId))},e.inviteToBandCallback=function(){Promise.resolve().then((()=>rb)).then((function(e){let{logChatInviteToBand:t}=e;t()}))},e.isMe=function(){return e.getConversation()?.partner?.id===r.id},e.openInviteToProjectModal=()=>{$j(e,t,n)}}]}})).directive("conversationHeader",(function(){return{restrict:"E",replace:!0,templateUrl:"https://www.bandlab.com/web-app/chat/partials/_conversation-header-75c5ee93.html",scope:{conversationId:"=conversationId"},controller:["$scope","$http","$injector","ChatCache","Me",function(e,t,n,o,r){e.getConversation=function(){return o.conversations.find((t=>t.id===e.conversationId))||o.conversationsRequests.find((t=>t.id===e.conversationId))},e.inviteToBandCallback=function(){Promise.resolve().then((()=>rb)).then((function(e){let{logChatInviteToBand:t}=e;t()}))},e.isMe=function(){return e.getConversation()?.partner?.id===r.id},e.openInviteToProjectModal=()=>{$j(e,t,n)}}]}})),angular.module("bandlab.chat").directive("conversationRequest",(function(){return{restrict:"E",templateUrl:"https://www.bandlab.com/web-app/chat/partials/_conversation-request-29ccf8ce.html",controller:["$scope","$state","Chat","ChatCache","FloatingChat","User",function(e,t,n,o,r,i){e.acceptConversationRequest=function(i){return n.acceptConversationRequest(i).then((function(){if(!r.activeConversations[0]||r.activeConversations[0].id!==e.conversation.id)return o.conversations=[],t.go("chat.conversation",{id:i.id},{reload:!0});e.conversation.isAccepted=!0}))},e.declineConversationRequest=function(i){return n.declineConversationRequest(i).then((function(){if(r.activeConversations[0]&&r.activeConversations[0].id===e.conversation.id)return void(r.activeConversations=[]);Gf(o.conversationsRequests,(e=>e.id===i.id));const n=o.conversationsRequests.find((e=>!1===e.isAccepted));return n?t.go("chat.conversation",{id:n.id}):(o.conversations=[],t.go("chat",{requests:!1},{reload:!0}))}))},e.$watch("conversation",(function(){if(!e.conversation||!e.conversation.partner)return;const t=e.conversation.members.find((t=>t.id===e.conversation.partner.id));t.isActive?i.get({id:e.conversation.partner.id}).$promise.then((function(t){e.conversation.partner=t})):e.conversation.partner=t}),!0),e.$on("$user:relationChanged",(function(n,i){let{type:a,user:s}=i;return"block"===a&&s.id===e.conversation.partner.id?r.activeConversations[0]&&r.activeConversations[0].id===e.conversation.id?void(r.activeConversations=[]):void 0:"follow"===a&&s.id===e.conversation.partner.id?r.activeConversations[0]&&r.activeConversations[0].id===e.conversation.id?void(e.conversation.isAccepted=!0):(o.conversations=[],t.go("chat",{id:e.conversation.id},{reload:!0})):void 0}))}]}})),angular.module("bandlab.chat").directive("conversationTile",["$injector",function(e){return{replace:!0,restrict:"E",scope:{conversation:"=",onClick:"&"},link:async function(t,n){const o=Mt({conversation:t.conversation,onClick:t.onClick});t.$watch((function(e){const{conversation:t,onClick:n}=e;o.conversation=t,o.onClick=n}),!0);const r=import("./chunk-38bf907b.js").then((function(r){let{mount:i}=r;return i(n[0],{$injector:e,scope:t},o)}));t.$on("$destroy",(async function(){(await r).unmount()}))}}}]),angular.module("bandlab.chat").value("FloatingChat",{activeConversations:[]}).directive("floatingChat",["FloatingChat",function(e){return{restrict:"A",scope:!0,link:function(t,n){if(Zf)return n.remove();t.floatingChat=e,t.$on("$band:left",(function(t,n){let{band:o}=n;Gf(e.activeConversations,(e=>e.id===o.conversationId))}))}}}]).directive("floatingConversation",["$state",function(e){return{restrict:"E",replace:!0,templateUrl:"https://www.bandlab.com/web-app/chat/partials/_floating-conversation-3d675406.html",controller:["$scope","FloatingChat",function(t,n){t.openInChat=function(){vj(),bj();const n="Channel"===t.conversation.type?"chat.channel":"chat.conversation";e.go(n,{id:t.conversation.id})},t.closeConversation=function(){n.activeConversations=[],bj()},t.toggleFloatingChat=function(){t.conversation.isMinimized=!t.conversation.isMinimized,t.conversation.isMinimized?vj():t.$broadcast("$chat:openFloatingChat")}}]}}]),angular.module("bandlab.chat").component("shareAsMessage",{bindings:{suggestedUsers:"<",message:"<",attachment:"="},templateUrl:"https://www.bandlab.com/web-app/chat/partials/_share-as-message-843fa657.html",controller:["$q","$rootScope","$timeout","AppNotifications","Chat","ChatHelper","Share",function(e,t,n,o,r,i,a){const s=this;s.submitForm=function(n){const i=s.users.map((function(e){return r.getOneConversation(e.conversationId).then((function(e){return r.sendMessage({conversation:e,content:s.messageBody||"",links:s.attachments})}))}));return e.all(i).then((function(){o.addNotification({content:"Sent",autoclose:3e3}),t.$broadcast("messageModal","close")})).catch((e=>{n.$setPristine();const t=_.get(e,"data.message")||e.message,r=_.get(e,"data.code");o.addNotification({title:"Unable to send message",content:105===r?"Your email is not confirmed":t,classList:"alert",autoclose:5e3})}))},s.users=[],s.$onInit=function(){s.messageBody=s.message||"";const e=s.attachment?a.getShareUrl(s.attachment):"";(e?i.getExternalUrl(e):Promise.resolve([{}])).then((function(e){s.attachments=[e[0].object]})),n((()=>t.$broadcast("elastic:adjust")),100)}}],controllerAs:"vm"}),angular.module("bandlab.chat").directive("talkTo",["appActions","Chat",function(e,t){return{restrict:"A",link:function(n,o,r){o[0].addEventListener("click",(function(n){e.checkAllowed("talkTo")?t.startConversation(r.talkTo,r.talkToType):n.preventDefault()}))}}}]),angular.module("bandlab.chat").factory("Chat",["$http","$q","$rootScope","$state","Band","ChatCache","ChatHelper","FloatingChat","Me","User",function(e,t,n,o,r,i,a,s,l,c){return{acceptConversationRequest:function(t){return e({method:"patch",url:`https://www.bandlab.com/api/v1.3/users/${l.id}/conversations/${t.id}`,data:{isAccepted:!0}})},addBlockUser:function(t){let{conversationId:n,userId:o}=t;return e({url:`https://www.bandlab.com/api/v1.3/conversations/${n}/blocks/members/${o}`,method:"POST"})},declineConversationRequest:u,declineConversationRequests:function(e){return Promise.all(e.map(u))},deleteConversation:function(t){const o="Channel"===t.type?`https://www.bandlab.com/api/v1.3/users/${l.id}/chat/channels/${t.id}`:`https://www.bandlab.com/api/v1.3/users/${l.id}/conversations/${t.id}`;return e({method:"DELETE",url:o}).then((function(){Gf(i.conversations,{id:t.id}),n.$broadcast("$conversation:leave",t)}))},deleteMessage:function(t,o){return e({method:"DELETE",url:`https://www.bandlab.com/api/v1.3/users/${l.id}/conversations/${t.id}/messages/${o.id}`}).then((function(){o.status="Deleted",n.$broadcast("$message:delete",{messageId:o.id,conversationId:t.id})}))},getBlockedUsers:function(){let{after:t,conversationId:n,limit:o=20}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e({url:`https://www.bandlab.com/api/v1.3/conversations/${n}/blocks/members`,params:{after:t,limit:o},preservePagination:!0}).then((e=>{let{data:t}=e;return t}))},getconversationRequests:function(){let{after:t,limit:n=20}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e({url:`https://www.bandlab.com/api/v1.3/users/${l.id}/conversations`,params:{isAccepted:!1,after:t,limit:n},preservePagination:!0})},getConversations:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,n=arguments.length>1?arguments[1]:void 0;return e({url:`https://www.bandlab.com/api/v1.3/users/${l.id}/conversations`,params:{isAccepted:!0,limit:t,after:n},preservePagination:!0}).then((function(e){const t=a.tidyConversations([...e.data.data]);return a.addConversationsData(t),i.conversations=a.tidyConversations([...i.conversations,...t]),e}))},getMessages:function(t,n){const o="Channel"===t.type?`https://www.bandlab.com/api/v1.3/users/${l.id}/chat/channels/${t.id}/messages`:`https://www.bandlab.com/api/v1.3/users/${l.id}/conversations/${t.id}/messages`;return e({url:o,params:{limit:n,after:t.after},preservePagination:!0}).then((function(e){let{data:{data:n,paging:o}}=e;return t.after=o.cursors.after,_.forEach(n,(function(e){e.conversation=t})),a.addMessagesData(n),n}))},getOneConversation:d,getUnreadConversationCount:function(){return e({url:`https://www.bandlab.com/api/v1.3/users/${l.id}/conversations/count`,params:{isRead:!1}}).then((function(e){i.unreadConversationCount=e.data.count}))},markAllAsRead:function(o,r){if(!r.length)return t.resolve();const i="Channel"===o.type?`https://www.bandlab.com/api/v1.3/users/${l.id}/chat/channels/${o.id}/messages/${r[0].id}/receipts/read`:`https://www.bandlab.com/api/v1.3/users/${l.id}/conversations/${o.id}/messages/${r[0].id}/receipts/read`;return e({method:"POST",url:i}).then((function(e){return o.unreadMessageCount=0,n.$broadcast("$conversation:messagesRead",o),e}))},markAsRead:function(t,n){const o="Channel"===n.type?`https://www.bandlab.com/api/v1.3/users/${l.id}/chat/channels/${n.id}/messages/${t.id}/receipts/read`:`https://www.bandlab.com/api/v1.3/users/${l.id}/conversations/${n.id}/messages/${t.id}/receipts/read`;return e({method:"POST",url:o})},removeBlockUser:function(t){let{conversationId:n,userId:o}=t;return e({url:`https://www.bandlab.com/api/v1.3/conversations/${n}/blocks/members/${o}`,method:"DELETE"})},sendMessage:function(t){let{conversation:o,content:r,links:i,animation:s,attachments:c,repliedMessageId:u}=t;const d={content:r};return i&&(d.links=i),s&&(d.animation=s),c&&(d.attachments=c),u&&(d.repliedMessageId=u),e.post(`https://www.bandlab.com/api/v1.3/users/${l.id}/conversations/${o.id}/messages`,d).then((function(e){const t=e.data;return t.conversation=o,t.sender=l,a.addOneMessageData(t),n.$broadcast("$message:new",t),t}))},startConversation:async function(e){if("user"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user")){const t=await c.get({id:e}).$promise;return d(t.conversationId).then(p).catch((e=>{if(403===e.status&&l.permissions.canCreateConversations)return p({id:t.conversationId,partner:t,picture:t.picture,user:t,type:"User"})}))}return r.get({id:e}).$promise.then((e=>d(e.conversationId))).then(p)}};function u(t){return e({method:"delete",url:`https://www.bandlab.com/api/v1.3/users/${l.id}/conversations/${t.id}`})}function d(t){let{isChannel:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=n?`https://www.bandlab.com/api/v1.3/users/${l.id}/chat/channels/${t}`:`https://www.bandlab.com/api/v1.3/users/${l.id}/conversations/${t}?useMessagePermissionFlag=true`;return e({url:o}).then((function(o){if(n)return[[],o];const r=o.data.members?.length?o.data.members:e({url:`https://www.bandlab.com/api/v1.3/conversations/${t}/members`,cache:!0}).then((e=>{let{data:t}=e;return t}));return Promise.all([r,o])})).then((function(e){let[t,{data:n}]=e;return Object.assign(n,{members:t,messages:[]}),"Song"!==n.type&&a.addOneConversationData(n,{fetchBand:!0}),!1!==n.isAccepted&&"Show"!==n.type&&"Song"!==n.type?i.conversations=a.tidyConversations([n,...i.conversations]):!1===n.isAccepted&&(i.conversationsRequests=a.tidyConversations([n,...i.conversationsRequests])),n}))}function p(e){return Zf||o.includes("chat")?o.go("chat.conversation",{id:e.id}):(s.activeConversations=[e],e)}}]),angular.module("bandlab.chat").factory("ChatCache",["$q","Band","Me","User",function(e,t,n,o){let r=[];const i=new Map;return{conversations:[],conversationsRequests:[],getBand:Ac((function(e){return t.get({id:e}).$promise})),getContacts:function(){return r.length?e.resolve(r):function(){let e=[];return function n(o){return o().then((function(o){let{paging:r,data:i}=o;return e=e.concat(i),r.itemsCount<r.limit?e:n((()=>t(r.cursors)))}))}(t);function t(){let{after:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o.relation({id:n.id,rel:"following",limit:50,after:e}).$promise}}().then((function(e){return r=e.sort((function(e,t){return e.name.localeCompare(t.name)})),r}))},getUser:Ac((function(e){return Sentry.onLoad((()=>{Sentry.addBreadcrumb({message:"Call ChatCache.getUser()",data:{userId:e}})})),o.get({id:e}).$promise})),getDraftInput:function(e){return i.get(e)},saveDraftInput:function(e,t){i.set(e,t)},unreadConversationCount:0}}]);var Pj=Ym&&1/Wp(new Ym([,-0]))[1]==1/0?function(e){return new Ym(e)}:function(){};const Mj=Pj;var Tj=200;function Cj(e,t,n){var o=-1,r=Sj,i=e.length,a=!0,s=[],l=s;if(n)a=!1,r=_j;else if(i>=Tj){var c=t?null:Mj(e);if(c)return Wp(c);a=!1,r=jp,l=new Lp}else l=t?[]:s;e:for(;++o<i;){var u=e[o],d=t?t(u):u;if(u=n||0!==u?u:0,a&&d==d){for(var p=l.length;p--;)if(l[p]===d)continue e;t&&l.push(d),s.push(u)}else r(l,d,n)||(l!==s&&l.push(d),s.push(u))}return s}function Ej(e){return e&&e.length?Cj(e):[]}function Ij(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(!e.length)return t;const n=e.map((e=>{let{adEngagementEvent:t,adImpressionEvent:n,adCreative:o,position:r,placement:i}=e;const{isBoosted:a,post:s}=o;return{...s,position:r,placement:i,adEngagementEvent:t,adImpressionEvent:n,isBoosted:a}})),o=[...t.posts];return n.forEach((e=>{o.splice(e.position,0,e)})),{...t,posts:o}}angular.module("bandlab.chat").factory("ChatHelper",["$filter","$http","$q","$sce","Album","Band","ChatCache","Collection","Community","EffectsPreset","Me","Post","Revision","User",function(e,t,n,o,r,i,a,s,l,c,u,d,p,m){const f=Ac((function(e){return{object:r.get({id:e}).$promise.then((function(e){return e})).catch((()=>null)),type:"Album"}})),h=Ac((function(e){return i.get({id:e}).$promise.then((function(e){return{object:e,type:"Band"}})).catch((()=>{}))})),g=Ac((function(e){return s.get({id:e}).$promise.then((function(e){return{object:e,type:"Collection"}})).catch((()=>{}))})),v=Ac((function(e){return l.get({id:e}).$promise.then((function(e){return{object:e,type:"Community"}})).catch((()=>{}))})),b=Ac((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Post";return d.get({id:e}).$promise.then((function(e){return{object:e,type:t}})).catch((()=>{}))})),y=Ac((function(e){return c.getSharedPreset(e).then((function(e){return{object:e,type:"Preset"}})).catch((()=>{}))})),w=Ac((function(e){return{object:p.get({id:e}).$promise.then((function(e){return e})).catch((()=>null)),type:"Revision"}})),$=Ac((function(e){return m.get({id:e}).$promise.then((function(e){return{object:e,type:"User"}})).catch((()=>{}))})),k=Ac((function(n){return t.get(`https://www.bandlab.com/api/v1.3/preview?url=${encodeURIComponent(n)}`,{cache:!0}).then((t=>{let{data:n}=t;return n.description=e("textTruncate")({content:n.description},200,40,3),[{object:n,type:"Link"}]})).catch((()=>[{object:{url:n},type:"Link"}]))}));return{addConversationsData:function(e){e.forEach((function(e){S(e)}))},addMessagesData:function(e){_.forEach(e,(function(t,n){M(t),P(t,e[n+1],0===n)}))},addOneConversationData:S,addOneMessageData:M,addRelativeMessageData:P,getConversations:function(){return a.conversations.filter((e=>"Show"!==e.type)).filter((e=>_.get(e,"lastMessageId"))).filter((e=>!1!==_.get(e,"isAccepted")))},getExternalUrl:k,getLinkPreview:function(e){const t=tj(e).shift();return t?k(t):n.resolve([])},getMessageAttachments:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return n.all([...N(e),...x(e),...D(e),...O(e),...j(e),...L(e),...C(e),...E(e),...I(e),...R(e),...A(e)]).then((e=>e.filter((e=>e))))},getVideoUrls:N,isInternalUrl:function(e){return/https?:\/\/(?:(?:[a-z]*\.)*bandlab\.com|localhost:[0-9]{4})\/(?:[^\s\\]*albums\/)([a-zA-Z0-9-_]+)\/?(?:\s|\n|$)/g.test(e)||/https?:\/\/(?:(?:[a-z]*\.)*bandlab\.com|localhost:[0-9]{4})\/(?:[^\s\\]*albums\/)([a-zA-Z0-9-_]+)\/tracks\/([0-9a-f_]+)\/?(?:\s|\n|$)/g.test(e)||/https?:\/\/(([a-z]*\.)*bandlab\.com|localhost:[0-9]{4})\/band\/([a-z][0-9a-z_]{1,19})\/?(\s|\n|$|members)/g.test(e)||/https?:\/\/(?:(?:[a-z]*\.)*bandlab\.com|localhost:[0-9]{4})\/(?:[^\s\\]*collections\/)([a-zA-Z0-9-_]+)\/?(?:\s|\n|$)/g.test(e)||/https?:\/\/(([a-z]*\.)*bandlab\.com|localhost:[0-9]{4})\/community\/([a-z][0-9a-z_]{1,19})\/?(\s|\n|$)/g.test(e)||/https?:\/\/(?:(?:[a-z]*\.)*bandlab\.com|localhost:[0-9]{4})\/posts?\/([a-zA-Z0-9-_]+)\/?(?:\s|\n|$)/g.test(e)||/https?:\/\/(?:(?:[a-z]*\.)*bandlab\.com|localhost:[0-9]{4})\/effect-presets\/([a-zA-Z0-9-_]+)/g.test(e)||/https?:\/\/(?:(?:[a-z]*\.)*bandlab\.com|localhost:[0-9]{4})\/(?:[^\s\\]*\?revId=|revisions\/)([a-zA-Z0-9-_]+)\/?(?:\s|\n|$)/g.test(e)||/https?:\/\/(([a-z]*\.)*bandlab\.com|localhost:[0-9]{4})\/(?!band\/|song\/)([a-z0-9][a-z0-9_]{2,19})\/?(\s|\n|$|bands)/g.test(e)},resetMessageAttachmentsCache:function(){[w,b,$,h].forEach((function(e){e.cache=new Ac.Cache}))},tidyConversations:function(e){return Object.values(e.reduce((function(e,t){return e[t.id]?new Date(t.lastMessageCreatedOn)>new Date(e[t.id].lastMessageCreatedOn)&&(e[t.id].previewMessage=t.previewMessage,e[t.id].unreadMessageCount=t.unreadMessageCount,e[t.id].hasUnreadReaction=t.hasUnreadReaction,e[t.id].lastMessageCreatedOn=t.lastMessageCreatedOn,e[t.id].lastMessageId=t.lastMessageId,e[t.id].lastMessageSenderId=t.lastMessageSenderId):e[t.id]=t,e}),{})).map((function(e){return Object.assign(e,{date:e.lastMessageCreatedOn??(new Date).toISOString()}),e})).sort(((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()))},updateConversationMember:function(e,t){const n=a.conversations.findIndex((e=>e.id===t.conversationId)),o=a.conversations[n];"Band"===o?.type&&(o.band.members.push(t),o.band.counters.members++),e.members.find((e=>e.id===t.id))||(e.members.push(t),o&&(o.members=e.members))},updateConversationLastMessage:function(e,t){e.lastMessageCreatedOn=t.createdOn,e.lastMessageId=t.id,e.lastMessageSenderId=t.sender.id}};function S(e){let{fetchBand:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.keywords=_.get(e,"name"," "),e.date=e.previewMessage&&e.lastMessageCreatedOn||(new Date).toISOString(),e.previewMessage&&(e.previewMessage.abstract=e.previewMessage.content,e.keywords+=`${e.previewMessage.abstract} `),e.members=e.members||[],"Band"===e.type?(e.band=e.group,e.keywords+=`${e.name} `,e.members.forEach((function(t){e.keywords+=`${t.name} ${t.username} `})),t&&a.getBand(e.group.id).then((function(t){e.band=t}))):"Channel"===e.type?(e.isChannel=!0,e.partner=e.creator,e.user=e.creator):e.members.forEach((function(t){u.id===t.id&&1!==e.members.length||(e.partner=t,e.user&&(e.partner.isVerified=e.user.id===t.id&&e.user.isVerified)),e.keywords+=`${t.name} ${t.username} `}))}function P(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e.isNextDate=t&&new Date(e.createdOn).getDate()!==new Date(t.createdOn).getDate(),e.isNextUser=!t||e.sender.id!==t.sender.id,e.isNextPeriod=t&&!e.isNextDate&&!e.isNextUser&&new Date(e.createdOn).getTime()-new Date(t.createdOn).getTime()>9e5,t&&(t.isLastInPeriod=e.isNextDate||e.isNextUser||new Date(e.createdOn).getTime()-new Date(t.createdOn).getTime()>9e5),n&&(e.isLastInPeriod=!0),e.status||(e.status="Active")}function M(e){e.isNewDate=!1,e.isNested=!1;const t=e.conversation.members.find((t=>{let{id:n}=t;return n===e.sender.id}));t?e.sender=t:a.getUser(e.sender.id).then((function(t){e.sender=t}))}function T(e,t){const n=[];let o;for(;null!==(o=e.exec(t));)n.push(o);return n}function C(e){return Ej(T(/https?:\/\/(?:(?:[a-z]*\.)*bandlab\.com|localhost:[0-9]{4})\/posts?\/([a-zA-Z0-9-_]+)\/?(?:\s|\n|$)/g,e).map((e=>{let[,t]=e;return t}))).map((e=>b(e,"Post")))}function E(e){return Ej(T(/https?:\/\/(?:(?:[a-z]*\.)*bandlab\.com|localhost:[0-9]{4})\/track\/([a-zA-Z0-9-_]+)\/?/g,e).map((e=>{let[,t]=e;return t}))).map((e=>b(e,"Post")))}function I(e){return Ej(T(/https?:\/\/(?:(?:[a-z]*\.)*bandlab\.com|localhost:[0-9]{4})\/effect-presets\/([a-zA-Z0-9-_]+)/g,e).map((e=>{let[,t]=e;return t}))).map(y)}function R(e){return Ej(T(/https?:\/\/(?:(?:[a-z]*\.)*bandlab\.com|localhost:[0-9]{4})\/(?:[^\s\\]*\?revId=|revisions\/)([a-zA-Z0-9-_]+)\/?(?:\s|\n|$)/g,e).map((e=>{let[,t]=e;return t}))).map(w)}function A(e){return Ej(T(/https?:\/\/(([a-z]*\.)*bandlab\.com|localhost:[0-9]{4})\/(?!band\/|song\/)([a-z0-9][a-z0-9_]{2,19})\/?(\s|\n|$|bands)/g,e).map((e=>{let[,,,t]=e;return t}))).map($)}function x(e){return Ej(T(/https?:\/\/(([a-z]*\.)*bandlab\.com|localhost:[0-9]{4})\/band\/([a-z][0-9a-z_]{1,19})\/?(\s|\n|$|members)/g,e).map((e=>{let[,,,t]=e;return t}))).map(h)}function L(e){return Ej(T(/https?:\/\/(([a-z]*\.)*bandlab\.com|localhost:[0-9]{4})\/community\/([a-z][0-9a-z_]{1,19})\/?(\s|\n|$)/g,e).map((e=>{let[,,,t]=e;return t}))).map(v)}function O(e){return Ej(T(/https?:\/\/(?:(?:[a-z]*\.)*bandlab\.com|localhost:[0-9]{4})\/(?:[^\s\\]*albums\/)([a-zA-Z0-9-_]+)\/?(?:\s|\n|$)/g,e).map((e=>{let[,t]=e;return t}))).map(f)}function j(e){return Ej(T(/https?:\/\/(?:(?:[a-z]*\.)*bandlab\.com|localhost:[0-9]{4})\/(?:[^\s\\]*albums\/)([a-zA-Z0-9-_]+)\/tracks\/([0-9a-f_]+)\/?(?:\s|\n|$)/g,e).map((e=>{let[,,t]=e;return t}))).map((e=>b(e,"Track")))}function D(e){return Ej(T(/https?:\/\/(?:(?:[a-z]*\.)*bandlab\.com|localhost:[0-9]{4})\/(?:[^\s\\]*collections\/)([a-zA-Z0-9-_]+)\/?(?:\s|\n|$)/g,e).map((e=>{let[,t]=e;return t}))).map(g)}function N(e){const t=/(youtube\.com\/watch[?]v=|youtube\.com\/embed|youtu\.be)(\/)?([A-Za-z0-9._%-]+).*$/i,n=/vimeo\.com\/[a-z_/]*([0-9]{6,10})\/?/i,r=/solo\.airbit\.com\/(.+)\/?/i;return e.split(/\s/).map((e=>e.replace(/[.,;!?]*$/,""))).map((e=>{if(!nj(e))return;const i=e.match(t);if(i)return{type:"youtube",id:i[3],url:o.trustAsResourceUrl(`//www.youtube.com/embed/${i[3]}`)};const a=e.replace(/#.+/,"").replace(/\?.+/,"").match(n);if(a)return{type:"vimeo",id:a[1],url:o.trustAsResourceUrl(`//player.vimeo.com/video/${a[1]}`)};const s=e.match(r);return s?{type:"airbit",id:s[1],url:o.trustAsResourceUrl(`//solo.airbit.com/${s[1]}`)}:void 0})).filter(Boolean)}}]),angular.module("bandlab.chat").factory("ChatNotifications",["$http","$q","$rootScope","$state","$stateParams","AppNotifications","Chat","ChatCache","ChatHelper","FloatingChat","Me","User",function(e,t,n,o,r,i,a,s,l,c,u,d){var p,m=angular.noop;const f=ay((function(){a.getUnreadConversationCount()}),5e3,{leading:!0,trailing:!0,maxWait:5e3});return n.$on("$message:read",(function(e,t){"Song"!==t.type&&$()})),n.$on("$conversation:messagesRead",(function(e,t){if("Song"!==t.type){var n=_.find(s.conversations,{id:t.id});n&&(n.unreadMessageCount=t.unreadMessageCount,n.hasUnreadReaction=!1),$()}})),n.$on("$conversation:leave",(function(e,t){var n=_.findIndex(s.conversations,{id:t.id});n>=0&&s.conversations.splice(n,1),c.activeConversations[0]&&c.activeConversations[0].id===t.id&&(c.activeConversations=[]),$()})),n.$on("$band:left",(function(e,t){let{band:n}=t;Gf(s.conversations,(e=>e.id===n.conversationId)),$()})),{getWebSocket:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return p?Promise.resolve(p):h(e)},start:function(){u.permissions?.canCreateConversations&&(function(){return h().then((function(n){n.on("ConversationMemberAdded",e),n.on("MessageReceived",t),n.on("MessageDeleted",i),n.on("MessageRead",d),n.on("MessageReactionCreated",m),n.on("MessageReactionDeleted",f),n.on("MessageReactionUpdated",v),g(),n.start().catch(k),p=n}));function e(e){n.$broadcast("$conversation:memberAdded",e),n.$applyAsync()}function t(e){if("Show"===e.conversationType)return;const t=e.sender.pictureUrl;(function(e){const t=s.conversations.find((t=>t.id===e.conversationId));return t?Promise.resolve(t):a.getOneConversation(e.conversationId,{isChannel:"Channel"===e?.conversationType})})(e).then((function(i){e.conversation=i,l.addOneMessageData(e),e.sender.pictureUrl=t,async function(e){n.$broadcast("$message:new",e);const t=!(e.sender.id!==u.id&&(!r.id||r.id!==e.conversation.id)),i=b(e.conversation.id);if(t||i&&!c.activeConversations[0].isMinimized)return;if("Song"===e.conversation.type)return;if($({delay:1e3}),o.includes("mixEditor"))return;if(await y(e.sender.id))return;let a=e.content;if(e.animation&&(a="<b>GIF</b>"),e.attachments.length>0){const t=e.attachments[0];a=`<icon-svg name="${function(e){switch(e){case qO.IMAGE:return"image";case qO.VIDEO:return"video-tutorial";case qO.AUDIO:return"note"}}(t.type)}" size="12"></icon-svg>${""===t.caption?t.type:t.caption}`}GO(e)&&!e.content&&(a='<icon-svg name="link" size="12"></icon-svg> Lets create music together!'),w({title:e.sender.name,description:a,pictureUrl:e.sender.pictureUrl,conversationId:e.conversation.id,conversationType:e.conversation.type})}(e),n.$applyAsync()}))}function i(e){n.$broadcast("$message:delete",{messageId:e.id,conversationId:e.conversationId}),function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};dj[e]&&t===dj[e].id&&(dj[e]={...dj[e],...n})}(e.conversationId,e.id,{status:"Deleted"}),n.$applyAsync()}function d(e){n.$broadcast("$message:receiptRead",e),n.$applyAsync()}function m(e){n.$broadcast("$message:reactionCreated",e),async function(e){const t=r.id&&r.id===e.conversationId,n=b(e.conversationId);o.includes("mixEditor")||"Song"!==e.conversationType&&(e.messageCreatorId!==u.id&&e.reactionCreator.id!==u.id||t||n&&!c.activeConversations[0]?.isMinimized||await y(e.reactionCreator.id)||w({title:e.reactionCreator.name,description:e.description,pictureUrl:e.reactionCreator.pictureUrl,conversationId:e.conversationId,conversationType:e.conversationType}))}(e),function(e){const t=r.id&&r.id===e.conversationId,n=b(e.conversationId),o=s.conversations.findIndex((t=>t.id===e.conversationId)),i=s.conversations[o];i&&"Song"!==e.conversationType&&e.messageCreatorId===u.id&&(e.memberId!==u.id&&(i.previewMessage.previewType="Reaction",i.previewMessage.id=e.messageId,i.previewMessage.content=e.description,i.previewMessage.hasFullContent=!0),t||n&&!c.activeConversations[0]?.isMinimized?e.conversationId==e.conversationId&&a.markAsRead({id:e.messageId},i).then((function(){i.hasUnreadReaction=!1})):i.hasUnreadReaction=!0)}(e),$(),n.$applyAsync()}function f(e){n.$broadcast("$message:reactionDeleted",e),a.getOneConversation(e.conversationId),$(),n.$applyAsync()}function v(e){n.$broadcast("$message:reactionUpdated",e),a.getOneConversation(e.conversationId),n.$applyAsync()}function k(){n.$broadcast("$chat:error")}}(),f(),m=n.$on("$chat:error",v))},stop:g};function h(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t.all([e.post("https://www.bandlab.com/api/v1.3/chat/authorizations"+(n?`/conversations/${n}`:""),{}),import("./chunk-d5619741.js").then((e=>e.s))]).then((function(e){let[{data:{accessToken:t,url:n}},o]=e;return(new o.HubConnectionBuilder).withUrl(n,{accessTokenFactory:()=>t}).configureLogging(o.LogLevel.Error).build()}))}function g(){p&&p.stop(),p=null}function v(){m()}function b(e){return c.activeConversations[0]&&e===c.activeConversations[0]?.id}function y(e){return d.blockedId({meId:u.id,userId:e}).$promise.then((e=>e.isBlocked)).catch((()=>!1))}function w(e){let{title:t,description:n,pictureUrl:r,conversationId:s,conversationType:l}=e;i.addNotification({title:t,content:`<div class="text-truncate">${n}</div>`,image:`${r}48x48 1x, ${r}96x96 2x`,autoclose:6e3,classList:"user"}),setTimeout((function(){var e,t=document.querySelector(".notification.user");t&&((e=t.closest(".notification")).style.cursor="pointer",e.addEventListener("click",(function(){if(i.clearAll(),o.includes("chat")){const e="Channel"===l?"chat.channel":"chat.conversation";o.go(e,{id:s})}else b(s)?c.activeConversations[0].isMinimized=!1:a.getOneConversation(s,{isChannel:"Channel"===l}).then((function(e){c.activeConversations=[e]}))})))}),300)}function $(){let{delay:e=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};setTimeout((()=>{a.getUnreadConversationCount()}),e)}}]),angular.module("bandlab.collection",[]);const Rj={__name:"DropdownMenu",props:{align:{type:String,default:""},direction:{type:String,default:""},dismissableLayer:{type:Boolean,default:!1},teleported:{type:Boolean,default:!1},teleportedTo:{type:Object,default:()=>document.body}},emits:["menuVisibiliyChange"],setup(e,t){let{emit:n}=t;const o=e,r=n,{isDropdownMenuVisible:i,dropdownMenuElement:a,open:s,triggerElement:l=Vt(null)}=o.dismissableLayer?H$():nS();function c(e){document.body.append(e),u$(l.value,e,{dropdownDirection:o.direction,dropdownMenuAlign:o.align,dropdownMenuContainer:o.teleported?null:"parent"})}function u(e){l.value=e,l.value&&l.value.addEventListener("click",s)}function d(e){a.value=e}return Lr(i,(()=>{r("menuVisibiliyChange",i.value),o.teleported&&o.teleportedTo===document.body&&(i.value?window.addEventListener("resize",s):window.removeEventListener("resize",s))})),(t,n)=>(si(),pi(ti,null,[Po(t.$slots,"trigger",{setTriggerElement:u,isActive:Gt(i)}),e.teleportedTo?(si(),mi(wr,{key:0,to:e.teleportedTo,disabled:!e.teleported},[yi(na,{name:"dropdown-transition",onBeforeEnter:c},{default:Tn((()=>[Gt(i)?Po(t.$slots,"content",{key:0,setContentElement:d,toggleContent:Gt(s)}):_i("v-if",!0)])),_:3})],8,["to","disabled"])):_i("v-if",!0)],64))}},Aj=Object.freeze(Object.defineProperty({__proto__:null,default:Rj},Symbol.toStringTag,{value:"Module"})),xj=!Zf&&!Qf,Lj=[{name:"people",title:"Smiley & People"},{name:"animals_and_nature",title:"Nature"},{name:"food_and_drink",title:"Food & Drink"},{name:"activity",title:"Activity"},{name:"travel_and_places",title:"Travel and Places"},{name:"objects",title:"Objects"},{name:"symbols",title:"Symbols"},{name:"flags",title:"Flags"}],Oj=["width","height","aria-hidden"],jj=[bi("path",{fill:"currentColor","fill-rule":"evenodd",d:"M12 3a9 9 0 1 0 0 18 9 9 0 0 0 0-18M1 12a11 11 0 1 1 22 0 11 11 0 0 1-22 0","clip-rule":"evenodd"},null,-1),bi("path",{fill:"currentColor","fill-rule":"evenodd",d:"M10 10.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m7 0a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0m-5 4.65c1.13 0 2.16-.45 2.9-1.19l1.2 1.22a5.83 5.83 0 0 1-8.2 0l1.2-1.22a4 4 0 0 0 2.9 1.19","clip-rule":"evenodd"},null,-1)],Dj={__name:"smile",props:{size:{type:Number,required:!0}},setup:e=>(t,n)=>(si(),pi("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none","aria-hidden":t.$attrs["aria-label"]||t.$attrs["aria-labelledby"]?null:"true"},jj,8,Oj))},Nj=Object.freeze(Object.defineProperty({__proto__:null,default:Dj},Symbol.toStringTag,{value:"Module"})),Uj=["aria-disabled"],Fj={__name:"InlineButton",props:{size:{required:!0,validator:e=>["default","large","medium","compact"].includes(e)},shape:{default:"",validator:e=>["circle","pill",""].includes(e)},color:{default:"",validator:e=>["transparent","translucent",""].includes(e)},isCore11:{type:Boolean,default:!1},isDisabled:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},loadingMessage:{type:String,default:"Loading"}},emits:["click"],setup(e,t){let{emit:n}=t;const o=e,r=n,i=Gi((()=>o.isDisabled||o.isLoading));function a(e){if(i.value)return e.preventDefault(),void e.stopPropagation();r("click",e)}return(e,t)=>(si(),pi("button",{type:"button",class:ae(["ds-inline-button",[`ds-inline-button-size-${o.size}`,o.isCore11?["core-11-ds-inline-button",`ds-inline-button-shape-${o.shape}`,`ds-inline-button-color-${o.color}`]:[],{"is-loading":o.isLoading}]]),"aria-disabled":i.value||null,onClick:a},[Po(e.$slots,"default"),o.isLoading?(si(),mi(Ld,{key:0,size:24,class:"ds-button-loading-icon","aria-live":"assertive","aria-label":o.loadingMessage},null,8,["aria-label"])):_i("v-if",!0)],10,Uj))}},Bj=Object.freeze(Object.defineProperty({__proto__:null,default:Fj},Symbol.toStringTag,{value:"Module"})),Wj={key:0,class:"search-form-submit",type:"submit"},Vj={key:1,class:"search-form-submit"},qj={__name:"SearchInput",props:{as:{type:String,default:"form"},modelValue:{type:[String,Number],required:!0},size:{type:Number,default:32},debounceDelay:{type:Number,default:0}},emits:["submit","update:modelValue"],setup(e,t){let{emit:n}=t;const o=e,r=n,i=Ao(),a=Vt(null),s=ay((function(e){r("update:modelValue",e)}),o.debounceDelay),l=Gi({get:()=>o.modelValue,set(e){s(e)}});function c(){l.value="",s.cancel(),r("update:modelValue",""),a.value.focus()}return ao((function(){"autofocus"in i&&!eh&&hn((()=>{a.value.focus()}))})),(e,t)=>(si(),mi(yo(o.as),{class:ae([[{32:"search-form-32",40:"search-form-40"}[o.size]],"search-form"]),onSubmit:t[1]||(t[1]=ss((e=>r("submit",e)),["prevent"]))},{default:Tn((()=>[Cn(bi("input",Ci({ref_key:"inputRef",ref:a,"onUpdate:modelValue":t[0]||(t[0]=e=>l.value=e),class:"search-form-input",type:"search",enterkeyhint:"search"},Gt(i)),null,16),[[Ya,l.value,void 0,{trim:!0}]]),"form"===o.as?(si(),pi("button",Wj,[yi(Y$,{size:16})])):(si(),pi("span",Vj,[yi(Y$,{size:16})])),l.value?(si(),pi("button",{key:2,class:"search-form-clear",type:"button",onClick:c},[yi(Bd,{size:16})])):_i("v-if",!0)])),_:1},40,["class"]))}},zj=Object.freeze(Object.defineProperty({__proto__:null,default:qj},Symbol.toStringTag,{value:"Module"})),Hj={components:{DropdownMenu:Rj,IconSmile:Dj,InlineButton:Fj,SearchInput:qj},props:{direction:{type:String,default:null},inputRef:{type:Element,default:null},modelValue:{type:String,default:null},onEmojiSelection:{type:Function,default:()=>{}},teleported:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,t){let{emit:n}=t,o=[];const r=Vt(Lj[0]),i=Vt([]),a=Vt("");return Promise.resolve().then((()=>Bu)).then((function(e){let{ky:t}=e;return t.get("https://www.bandlab.com/web-app/emoji-772a1e8fe9.json",{$applyAsync:!0}).json()})).then((function(e){i.value=e,o=Object.values(i.value).flat()})),{activeEmojiCategory:r,categories:Lj,emojis:i,filteredEmojis:Gi((function(){return a.value?o.filter((e=>Object.values(e).some((e=>e.indexOf(a.value)>-1)))).slice(0,40):i.value[r.value.name]||o})),isActiveCategory:function(e){return e.name===r.value.name&&!a.value},panelClick:function(e){e.target.closest(".emoji-container")&&e.stopPropagation()},pick:function(t){const o=e.inputRef;if(o){const e=o.selectionStart,r=o.selectionEnd,i=`${t.char}`;o.value=o.value.substring(0,e)+i+o.value.substring(r),n("update:modelValue",o.value),o.selectionStart=e+i.length,o.selectionEnd=e+i.length,o.focus()}e.onEmojiSelection(t)},searchQuery:a,selectCategory:function(e){r.value=e,a.value=""}}}},Gj={class:"emoji-inner-container"},Kj={class:"emoji-zerocase"},Yj={key:0,class:"loader-spinner"},Jj=["title","onClick"],Xj={class:"emoji-category-symbol-container"},Zj=["title","onClick"],Qj={key:0,d:"M15.99 2A14 14 0 1 1 16 30.01 14 14 0 0 1 16 2ZM16 27.2a11.2 11.2 0 1 0 0-22.4 11.2 11.2 0 0 0 0 22.4Zm0-3.5a7.7 7.7 0 0 1-7.15-4.9h14.3A7.7 7.7 0 0 1 16 23.7Zm-4.9-9.1a2.1 2.1 0 1 1 0-4.2 2.1 2.1 0 1 1 0 4.2Zm9.8 0a2.1 2.1 0 1 1 0-4.2 2.1 2.1 0 0 1 0 4.2Z",fill:"currentColor"},eD={key:1,d:"M16.2 2 7.01 13.58h5.23L5 24.15l7.24.06V30h7.85v-5.8h7.31l-7.3-10.56h5.41L16.2 2Z",fill:"currentColor"},tD={key:2,d:"M21.33 8.8C21.33 6.7 24.32 4 28 4v24h-3.33v-9.6h-3.34V8.8Zm-6.66 3.6V4h2.66v8.4c0 2.54-2.21 4.6-5 4.76V28H9V17.16c-2.79-.15-5-2.22-5-4.76V4h2.67v8.4h2.66V4H12v8.4h2.67Z",fill:"currentColor"},nD={key:3,d:"M26.79 7.53c1.23-1.72 4.12-.07 2.87 1.66-2.41 3.35-5.8 4.63-9.37 3.54-1.12 1.9-2.18 3.85-3.2 5.8 1.5.77 3.29 2.11 4.2 2.84 1.14.9 2.6 4.47 3.48 6.26.94 1.91-2.08 3.3-3.01 1.4-.77-1.58-2.07-4.71-2.82-5.33a21.37 21.37 0 0 0-5.38-3.12 8.4 8.4 0 0 1-10.7 2.05c-2.04-1.18-.2-4.09 1.84-2.9 2.83 1.64 5.78-.46 7.11-3.09 1.33-2.62 2.28-4.47 3.36-6.33-2.1-.67-4.04-.06-5.56 2.05-1.23 1.71-4.12.07-2.87-1.66 2.94-4.08 7.32-5.1 11.7-2.51l1.2.66c2.72 1.6 5.26 1.3 7.15-1.32Zm-5.42.94a3.28 3.28 0 0 1-3.3-3.27c0-1.8 1.48-3.26 3.3-3.26 1.82 0 3.3 1.46 3.3 3.26 0 1.8-1.48 3.27-3.3 3.27Z",fill:"currentColor"},oD={key:4,d:"M9.46 27.74c.22.22.52.35.83.35a.96.96 0 0 0 .98-.88l.33-3.1c.07-.64.38-1.23.88-1.66l4.1-3.51L23.5 29a2.28 2.28 0 0 0 1.89 1 2.3 2.3 0 0 0 2.29-2.3l-3.82-13.04c-.29-.96.02-2 .78-2.65l4.24-3.63a3.73 3.73 0 1 0-5.24-5.3L20 7.35a2.55 2.55 0 0 1-2.67.78L4.95 4.42A2.29 2.29 0 0 0 2.99 8.5l10.08 6.93-3.52 4.1c-.42.5-1.01.8-1.66.87l-3.08.33a.94.94 0 0 0-.83.63c-.14.42-.03.88.29 1.19l5.2 5.19h-.01Z",fill:"currentColor"},rD={key:5,d:"M16.18 30c-2.47 0-4.47-2.12-4.47-4.74h8.93c0 2.62-2 4.74-4.46 4.74Zm4.14-7.23h-8.3C11.8 20.32 6 18.19 6 12.09 6 5.6 10.87 2.13 16.17 2c5.31.13 10.18 3.58 10.18 10.1 0 6.1-5.8 8.22-6.03 10.67Z",fill:"currentColor"},iD={key:6,d:"M24.1 4.14c.31.08.97.36 1.49.6a8.4 8.4 0 0 1 3.79 4.27c1.08 2.73.75 5.91-.96 9.21-1.86 3.6-6.02 7.48-11.28 10.55l-1.15.67-1.15-.67a37.24 37.24 0 0 1-7.51-5.66C3.77 19.57 2 16 2 12.36c0-2.5.83-4.53 2.56-6.25.78-.77 1.1-1 1.94-1.4A6.05 6.05 0 0 1 9.94 4c1.3.07 2.35.43 3.4 1.19.8.56 1.82 1.62 2.28 2.35.18.28.34.5.37.5.04 0 .2-.22.38-.5a8.72 8.72 0 0 1 3.77-3.16 4.6 4.6 0 0 1 2.1-.35c.83-.03 1.49 0 1.85.1Z",fill:"currentColor"},aD={key:7,d:"M27.16 5.58a.88.88 0 0 0-.64-.27c-.13 0-.39.1-.78.3-.4.2-.82.42-1.26.67a9.1 9.1 0 0 1-1.57.67c-.6.2-1.16.3-1.67.3-.48 0-.9-.1-1.26-.27-1.2-.56-2.24-.98-3.12-1.26a9.5 9.5 0 0 0-2.85-.4c-1.76 0-3.77.56-6 1.7-.47.23-.8.41-1.02.54L6.78 6a2.28 2.28 0 1 0-2.68.22l3.08 22.62a1.34 1.34 0 0 0 2.66-.36l-1.24-9.1c2.25-1.1 4.2-1.67 5.83-1.67.7 0 1.38.1 2.04.31.66.21 1.2.44 1.64.68.44.25.96.48 1.55.69.6.2 1.18.31 1.76.31 1.47 0 3.22-.55 5.26-1.65.27-.13.45-.27.57-.4.12-.12.18-.3.18-.54V6.22a.87.87 0 0 0-.27-.64Z",fill:"currentColor"},sD=ld(Hj,[["render",function(e,t,n,o,r,i){const a=vo("IconSmile"),s=vo("InlineButton"),l=vo("SearchInput"),c=vo("DropdownMenu");return si(),pi("div",{class:"emoji-picker",onClick:t[1]||(t[1]=e=>o.panelClick(e))},[yi(c,{align:"right",direction:n.direction,teleported:n.teleported},{trigger:Tn((e=>{let{setTriggerElement:t}=e;return[yi(s,{ref:e=>t(e?.$el),type:"button","is-core-11":!0,color:"transparent",size:"compact",shape:"circle",class:"emoji-button","aria-label":"Insert emoji"},{default:Tn((()=>[yi(a,{size:24})])),_:2},1032,["aria-label"])]})),content:Tn((e=>{let{setContentElement:n}=e;return[bi("div",{ref:n,class:"dropdown dropdown-container emoji-container"},[yi(l,{modelValue:o.searchQuery,"onUpdate:modelValue":t[0]||(t[0]=e=>o.searchQuery=e),placeholder:"Search",as:"div",autofocus:""},null,8,["modelValue","placeholder"]),bi("div",Gj,[bi("div",Kj,me("No results found"),1),o.emojis?_i("v-if",!0):(si(),pi("div",Yj)),(si(!0),pi(ti,null,So(o.filteredEmojis,(e=>(si(),pi("div",{key:e.char,class:"emoji-symbol",title:e.name,onClick:t=>o.pick(e)},me(e.char),9,Jj)))),128))]),bi("div",Xj,[(si(!0),pi(ti,null,So(o.categories,(e=>(si(),pi("svg",{key:e.name,class:ae([[o.isActiveCategory(e)?"active":""],"emoji-category-symbol"]),title:e.title,viewBox:"0 0 32 32",fill:"none",onClick:t=>o.selectCategory(e)},["people"===e.name?(si(),pi("path",Qj)):"animals_and_nature"===e.name?(si(),pi("path",eD)):"food_and_drink"===e.name?(si(),pi("path",tD)):"activity"===e.name?(si(),pi("path",nD)):"travel_and_places"===e.name?(si(),pi("path",oD)):"objects"===e.name?(si(),pi("path",rD)):"symbols"===e.name?(si(),pi("path",iD)):"flags"===e.name?(si(),pi("path",aD)):_i("v-if",!0)],10,Zj)))),128))])],512)]})),_:1},8,["direction","teleported"])])}]]),lD=Object.freeze(Object.defineProperty({__proto__:null,default:sD},Symbol.toStringTag,{value:"Module"})),cD={class:"ds-modal ds-modal-size-small chat-share-with-author-modal"},uD={class:"ds-modal-header"},dD={class:"ds-modal-title"},pD={class:"ds-modal-content"},mD={class:"form-field-default textarea-emoji-wrapper"},fD={for:"chat-share-with-author-textarea",class:"form-label"},hD=["placeholder","aria-label","disabled"],gD={class:"field-chars-remaining"},vD={key:0,class:"field-error"},bD={class:"chat-share-with-author-modal-footnote regular-12/16 text-left text-scd"},yD={class:"ds-modal-footer ds-modal-footer-two-buttons"},wD={__name:"ChatShareWithAuthorModal",props:{injector:{type:Object,required:!0},revision:{type:Object,required:!0},conversationId:{type:String,required:!0}},emits:["closeModal"],setup(e,t){let{emit:n}=t;const o=e,r=n,i=Vt(""),a=Vt(),s=Vt(!1),l=Gi((()=>i.value.trim()));async function c(){s.value=!0;const e=o.injector.get("AppNotifications"),t=o.injector.get("Chat"),n=o.injector.get("Share"),i=o.injector.get("$state"),a=await t.getOneConversation(o.conversationId),c=[{title:o.revision.song.name,description:o.revision.description,url:n.getShareUrl({object:o.revision,type:"Revision"}),image:o.revision.song.picture.url}];t.sendMessage({conversation:a,content:l.value,links:c}).then((function(e){jv(e,i,"forked_revision"),s.value=!1,r("closeModal")})).catch((function(t){s.value=!1,e.addNotification({title:"Unable to send message",content:404===t?.status?"Unable to load conversation.":403===t?.status?t?.data?.message:"Something went wrong, please try again later",classList:"alert",autoclose:8e3})}))}return(e,t)=>(si(),pi("section",cD,[bi("header",uD,[bi("h2",dD,me("Share with Author"),1)]),bi("form",{onSubmit:ss(c,["prevent"])},[bi("section",pD,[bi("div",mD,[bi("label",fD,me("Message"),1),Cn(bi("textarea",{id:"chat-share-with-author-textarea",ref_key:"textareaRef",ref:a,"onUpdate:modelValue":t[0]||(t[0]=e=>i.value=e),class:"input-text",name:"caption",autofocus:"",placeholder:"Share your appreciation or ask for feedback",spellcheck:"true",minlength:20,cols:"30",rows:"5","aria-multiline":"true","aria-label":"Share your appreciation or ask for feedback",disabled:s.value},null,8,hD),[[Ya,i.value]]),bi("div",gD,me(l.value.length||0)+"/"+me(250),1),l.value.length>0&&l.value.length<20||l.value.length>250?(si(),pi("div",vD,me("Please use between 20 and 250 characters."),1)):_i("v-if",!0),yi(sD,{modelValue:l.value,"onUpdate:modelValue":t[1]||(t[1]=e=>l.value=e),"input-ref":a.value},null,8,["modelValue","input-ref"])]),bi("p",bD,me("Your message and your forked version will be sent to the author in a private chat"),1)]),bi("footer",yD,[yi(Dd,{type:"button",size:"medium",color:"secondary",padding:"default",onClick:t[2]||(t[2]=t=>e.$emit("closeModal"))},{default:Tn((()=>[ki(me("Cancel"),1)])),_:1}),yi(Dd,{type:"submit",size:"medium",color:"primary",padding:"default","is-disabled":l.value.length<20||l.value.length>250||s.value},{default:Tn((()=>[ki(me("Send"),1)])),_:1},8,["is-disabled"])])],32),yi(ib,{onClick:t[3]||(t[3]=t=>e.$emit("closeModal"))})]))}};function $D(e){const t=e.get("Me");return{shareWithOriginalAuthor:function(t,n){Dv(e.get("$state").includes("track")?"project":"post"),_g(wD,{injector:e,revision:t,conversationId:n},{overlayClose:!1,onClose:()=>Pg(wD)})},canMessageOriginalAuthor:function(e,n){return e.song.isFork&&e.creator.id===t.id&&t.permissions.canCreateConversations&&e.isPublic&&!0!==n?.creator?.isBlocked&&!0!==n?.creator?.isBlockingMe}}}function kD(e){return e.track&&(e.revision={albumId:e.albumId,counters:e.counters,createdOn:e.createdOn,creator:e.creator,id:e.id,isLiked:e.isLiked,isPublic:"Released"===e.album?.state||"Public"===e.state,state:e.state,mixdown:e.track.sample?{duration:e.track.sample.duration,file:e.track.sample.audioUrl,status:e.track.sample.status,waveform:e.track.sample.waveformUrl}:{},postId:e.id,genres:[{id:e.track.genreId}],song:{albumId:e.albumId,author:{id:e.creator.id,type:"User",username:e.creator.username,name:e.creator.name},name:e.track.name,picture:e.track.picture},track:e.track,type:"Track"}),e}const SD={explore_channel_featured_artists:"explore_featured_artists",feed_for_you_boosted_post:"feed_for_you",feed_following_profile_card:"feed_following",feed_trending_boosted_post:"feed_trending",people_to_follow:"feed_people_to_follow"};function _D(e,t,n){const o=Date.now();return Uu.post(`https://ad.bandlab.io/v2/collect?e=${e}&s=${SD[n]||n}`).json().then((function(e){return r({action:t,duration:Date.now()-o,source:n,success:!0}),e})).catch((function(e){return e.response?.status&&r({action:t,duration:Date.now()-o,details:e.message,source:n,success:!1}),Promise.reject(e)}));function r(e){mv("log_native_ads_event",e)}}function PD(e,t){return Uu.get(`https://ad.bandlab.io/v1/check/${e}/${t}`)}function MD(e,t){return Uu.get(`https://ad.bandlab.io/v2/report/${e}/${t}`).json()}function TD(e){const t=Date.now();return Uu.get(`https://ad.bandlab.io/v2/native?placement=${e}`).json().then((function(o){return n({ads_count:o.ads?.length,duration:Date.now()-t,placement:e,success:!0}),o})).then((function(e){return e?(e.ads.forEach((function(e){"Track"===e.adCreative.post?.type&&(e.adCreative.post=kD(e.adCreative.post))})),e):{ads:[]}})).catch((function(o){return o.response?.status&&n({duration:Date.now()-t,details:o.message,placement:e,success:!1}),Promise.reject(o)}));function n(e){mv("load_native_ads",e)}}function CD(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{useCache:!1};return Uu.get(`https://ad.bandlab.io/v3/report/${e}/${t}`,{kyCache:n.useCache}).json()}function ED(e,t){Nu.delete(`https://ad.bandlab.io/v3/report/${e}/${t}`)}const ID=Object.freeze(Object.defineProperty({__proto__:null,checkCampaign:PD,cleanCampaignReportCache:ED,getAdMaterials:TD,getCampaignReportV2:MD,getCampaignReportV3:CD,logEvent:_D},Symbol.toStringTag,{value:"Module"}));function RD(e){let{target:t=document.body}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"!=typeof e)throw new TypeError(`Expected parameter \`text\` to be a \`string\`, got \`${typeof e}\`.`);const n=document.createElement("textarea"),o=document.activeElement;n.value=e,n.setAttribute("readonly",""),n.style.contain="strict",n.style.position="absolute",n.style.left="-9999px",n.style.fontSize="12pt";const r=document.getSelection(),i=r.rangeCount>0&&r.getRangeAt(0);t.append(n),n.select(),n.selectionStart=0,n.selectionEnd=e.length;let a=!1;try{a=document.execCommand("copy")}catch{}return n.remove(),i&&(r.removeAllRanges(),r.addRange(i)),o&&o.focus(),a}angular.module("bandlab.collection.routes",["ui.router"]).config(["$stateProvider",function(e){e.state("collectionId",{url:"/collections/{id:[a-zA-Z0-9-_]+}?triggeredFrom",redirectTo:function(e){const t=e.injector().get("Collection"),n=e.injector().get("$state");return t.get({id:e.params().id}).$promise.then((function(t){return n.target("collection",{id:t.id,username:t.creator.username,triggeredFrom:e.params().triggeredFrom},{collection:t})}))}}).state("collection",{url:"/{username:[a-z0-9][a-z0-9_]{2,19}}/collections/{id:[a-zA-Z0-9-_]+}?triggeredFrom",params:{rewriteTracking:["Me","$stateParams",function(e,t){return n=>n.replace(/^\/[a-z0-9][a-z0-9_]{2,19}(($|\/).*)/g,`/${t.username===e.username?"me":"user"}/collection`)}]},templateUrl:"https://www.bandlab.com/web-app/collection/views/collection-layout-de7e924d.html",resolve:{theCollection:["$stateParams","$transition$","Collection",function(e,t,n){return t.options().collection||n.get({id:e.id}).$promise}]},onEnter:["Page","theCollection",function(e,t){e.setMetadata({title:`${t.name} by ${t.creator.name} | BandLab`,description:(t.description?`${t.description} | `:"")+"Unlimited free listening on BandLab.",image:`${t.picture.url}360x360`,imageHeight:"360",imageWidth:"360"})}],onExit:["Page",function(e){e.clearMetadata()}],controller:["$injector","$scope","$state","$stateParams","Me","PlayerHistory","theCollection",function(e,t,n,o,r,i,a){t.me=r;const{posts:s,...l}=a;t.collection=l;const c=`playlist_page_${o.id}`;TD(c).then((e=>{let{ads:n}=e;t.adsList=n.map((e=>({...e,placement:c})))})).catch((()=>t.adsList=[])).finally((()=>t.$applyAsync())),t.$watch("adsList",(function(e){e&&(t.collection=Ij(t.adsList,{...t.collection,posts:s}),i.getCurrentPlayerContext().id===t.collection.id&&i.forcePushQueueSongs(t.collection.posts,i.getStack()[i.getIndex()],{contentSource:"playlist",id:t.collection.id}),t.$applyAsync())})),t.$on("$collection:changed",(function(e,o){if(o.collection.id===t.collection.id)if("update"===o.action)t.collection=o.collection;else if("add-post"===o.action){const e={...o.post,canChangePinState:!1,revision:{...o.post.revision,canEdit:!1}};t.collection.posts.unshift(e)}else"delete"===o.action&&n.go("user.collections",{username:r.username})})),Promise.resolve().then((()=>tv)).then((function(n){let{trackActionsAndPromptTip:o}=n;o(e,t,{user:a.creator,entityId:a.id})}))}]})}]),angular.module("bandlab.collection").controller("CollectionCreateCtrl",["$rootScope","$scope","$state","AppNotifications","Collection",function(e,t,n,o,r){t.collection=new r,t.collection.isPublic=!0,t.$on("$file:uploadSuccess",(function(e,n){t.collection.pictureId=n.id,t.collection.picture=n,t.collectionForm.$setDirty()})),t.addCollection=function(){t.collection.$save().then((function(r){e.$broadcast("createCollectionModal","close"),e.$broadcast("$collection:changed",{action:"create",collection:r}),Promise.resolve().then((()=>rb)).then((function(e){let{logPlaylistCreate:o}=e;o(r.isPublic,t.triggeredFrom??_p(n))})),"user.collections"!==n.current.name&&o.addNotification({title:"Playlist created",content:"Start searching for tracks and playlists to add here!",image:`${r.picture.url}48x48 1x, ${r.picture.url}96x96 2x`,action:`\n              <div ng-click="hide()">\n                <a class="button-dark button-height-32 button-padding-16 button-rounded" href="${n.href("explore.home")}">Explore</a>\n              </div>\n            `,classList:"project",autoclose:8e3})})).catch((function(e){t.collectionForm.$setPristine(),202!==e?.data?.errorCode&&o.addNotification({title:"Unable to create playlist",content:e.data.message,classList:"alert",autoclose:8e3})}))}}]),angular.module("bandlab.collection").controller("CollectionEditCtrl",["$analytics","$rootScope","$scope","AppNotifications","Collection","ConfirmModal",function(e,t,n,o,r,i){n.deleteCollection=function(n){return new i({confirmLabel:"Delete",contentScope:{title:"Delete this playlist?",message:"<p>Youll lose everything thats saved inside.</p>"},onConfirm:function(){t.$broadcast("$collection:changed",{action:"mark-deleted",collection:n}),(n=new r(n)).$delete().then((function(){t.$broadcast("$collection:changed",{action:"delete",collection:n}),e.eventTrack("Delete Collection",{category:"Collection"})})).catch((e=>{t.$broadcast("$collection:changed",{action:"unmark-deleted",collection:n}),o.addNotification({title:"Cannot delete collection",content:_.get(e,"data.message")||_.get(e,"message","Unknown error"),autoclose:5e3,classList:"alert"})}))}}).show()},n.unpublishCollection=function(e){e.isPublic=!1,(e=new r(e)).$update().then((function(e){t.$broadcast("$collection:changed",{action:"update",collection:e})}))},n.publishCollection=function(e){e.isPublic=!0,(e=new r(e)).$update().then((function(e){t.$broadcast("$collection:changed",{action:"update",collection:e})}))}}]),angular.module("bandlab.collection").controller("CollectionFormCtrl",["$analytics","$rootScope","$scope","Collection",function(e,t,n,o){const r=n.$parent.collection;n.editCollection=function(){n.createError=!1,n.collection.$update().then((function(n){Object.assign(r,n),t.$broadcast("editCollectionModal","close"),t.$broadcast("$collection:changed",{action:"update",collection:n}),e.eventTrack("Edit Collection",{category:"Collection"})}))},n.collection=new o({id:r.id,name:r.name,description:r.description,isPublic:r.isPublic,picture:angular.copy(r.picture)}),n.$on("$file:uploadSuccess",(function(e,t){n.collection.pictureId=t.id,n.collection.picture=t,n.collectionForm.$setDirty()}))}]),angular.module("bandlab.collection").controller("CollectionsManageCtrl",["$analytics","$controller","$rootScope","$scope","$state","AppNotifications","Collection","Me","Player",function(e,t,n,o,r,i,a,s,l){angular.extend(this,t("UserCollectionsCtrl",{$scope:o,theUser:s})),o.addedPosts=[],o.addToCollection=function(t,s){a.addPost({id:t.id,postId:s}).$promise.then((function(a){t.counters.items+=1;const s=r.href("collection",{username:t.creator.username,id:t.id});o.addedPosts[t.id]=!0,a.revision&&i.addNotification({autoclose:8e3,classList:"project",title:a.revision.song.name,content:`Added to <strong><a href="${s}">${t.name}</a></strong>`,image:`${a.revision.song.picture.url}48x48 1x, ${a.revision.song.picture.url}96x96 2x`}),e.eventTrack("Add to Collection",{category:"Post",label:a.type}),n.$broadcast("$collection:changed",{action:"add-post",collection:t,post:a})})).catch((function(e){if(409===e.status){const n=_.get(e,"data.errorCode");i.addNotification({autoclose:8e3,title:"Unable to add to playlist",content:_.get(e,"data.message"),classList:"alert"}),81===n&&(o.addedPosts[t.id]=!0)}}))},o.addRevisionToCollection=function(t,s){a.addRevision({id:t.id,revId:s}).$promise.then((function(a){t.counters.items+=1;const s=r.href("collection",{username:t.creator.username,id:t.id});o.addedPosts[t.id]=!0,a.revision&&i.addNotification({autoclose:8e3,classList:"project",title:a.revision.song.name,content:`Added to <strong><a href="${s}">${t.name}</a></strong>`,image:`${a.revision.song.picture.url}48x48 1x, ${a.revision.song.picture.url}96x96 2x`}),e.eventTrack("Add to Collection",{category:"Post",label:a.type}),n.$broadcast("$collection:changed",{action:"update",collection:t})})).catch((function(e){if(409===e.status){const n=_.get(e,"data.errorCode");i.addNotification({autoclose:8e3,title:"Unable to add to playlist",content:_.get(e,"data.message"),classList:"alert"}),81===n&&(o.addedPosts[t.id]=!0)}}))},o.removeFromCollection=function(e,t){a.removePost({id:e.id,postId:t}).$promise.then((function(){const o=Gf(e.posts,(e=>e.id===t));e.counters.items-=1,n.$broadcast("$collection:changed",{action:"update",collection:e}),l.removeRevisionFromQueue(o[0].revision.id)}))}}]),angular.module("bandlab.collection").component("collectionCard",{bindings:{collection:"="},transclude:{date:"?collectionCardDate"},templateUrl:"https://www.bandlab.com/web-app/collection/partials/_collection-card-444149a8.html",controller:["$element","$state","$stateParams","User",function(e,t,n,o){const r=this;r.$onInit=function(){r.currentView="list"===n.view?"list":"feed"},r.getLikers=function(e){return Object.assign(e,{entity:"collections",entityId:r.collection.id}),o.likersWithCursor(e).$promise},r.getOrigin=()=>_p(t,e),r.sendInsights=function(e,t,n){Promise.resolve().then((()=>rb)).then((function(o){let{logPlaylistShare:r}=o;r(e,t,n)}))}}],controllerAs:"vm"}),angular.module("bandlab.collection").component("collectionTile",{bindings:{collection:"<",triggeredFrom:"<"},transclude:{actions:"?collectionTileActions"},templateUrl:"https://www.bandlab.com/web-app/collection/partials/_collection-tile-f0f69586.html",controllerAs:"vm"}),angular.module("bandlab.collection").component("collectionTileEmpty",{templateUrl:"https://www.bandlab.com/web-app/collection/partials/_collection-tile-empty-1d4c2d0d.html",controllerAs:"vm"}),angular.module("bandlab.collection").component("revisionListItem",{bindings:{collection:"=",engagementEvent:"=",impressionEvent:"=",navigatingHistory:"<",order:"<",post:"="},transclude:{actions:"?postTileActions",headerMeta:"?revisionTileHeaderMeta"},templateUrl:"https://www.bandlab.com/web-app/collection/partials/_revision-list-item-34911ef7.html",controller:"PostCtrl",controllerAs:"vm"}),angular.module("bandlab.collection").factory("Collection",["$http","$resource",function(e,t){var n="https://www.bandlab.com/api/v1.3/collections";return t(n,{},{addPost:{method:"POST",params:{id:"@id",postId:"@postId"},url:`${n}/:id/posts/:postId`},addRevision:{method:"POST",params:{id:"@id",revId:"@revId"},url:`${n}/:id/revisions/:revId`},delete:{method:"DELETE",params:{id:"@id"},url:`${n}/:id`},fromUser:{method:"GET",params:{userId:"@userId",type:"playlist"},url:"https://www.bandlab.com/api/v1.3/users/:userId/collections",preservePagination:!0},get:{method:"GET",params:{id:"@id"},url:`${n}/:id`,transformResponse:[...e.defaults.transformResponse,o]},liked:{method:"GET",params:{id:"@userId"},url:"https://www.bandlab.com/api/v1.3/users/:userId/likes/collections",preservePagination:!0},removePost:{method:"DELETE",params:{id:"@id",postId:"@postId"},url:`${n}/:id/posts/:postId`},save:{method:"POST",url:n,transformRequest:[angular.toJson]},update:{method:"PATCH",params:{id:"@id"},url:`${n}/:id`,transformRequest:[function(e){let{...t}=e;return delete t.picture,t},angular.toJson],transformResponse:[...e.defaults.transformResponse,o]},updatePostOrder:{method:"PATCH",params:{id:"@id",postId:"@postId"},url:`${n}/:id/posts/:postId`}});function o(e,t,n){return 200===n&&e.posts.forEach((function(e){e.revision&&(e.revision.postId=e.id)})),e}}]),angular.module("bandlab.comment",[]).factory("Comment",["$http","$resource",function(e,t){var n="https://www.bandlab.com/api/v1.3/";return t(n,{},{delete:{url:`${n}:entity/:entityId/comments/:id`,method:"DELETE"},query:{url:`${n}:entity/:id/comments`,method:"GET",preservePagination:!0},save:{url:`${n}:entity/:id/comments`,method:"POST",transformResponse:[...e.defaults.transformResponse,function(e,t,n){return 403===n&&201===e?.errorCode&&(e.action="comment"),e}]},likersWithCursor:{url:`${n}:entity/:entityId/comments/:id/likes/users`,method:"GET",params:{entityId:"",entity:"revisions",limit:10},preservePagination:!0}})}]),angular.module("bandlab.comment").component("comment",{bindings:{canEdit:"<",comment:"<",commentId:"<",entity:"<",entityId:"<",entityPrefix:"<",onDelete:"&",onReplyTo:"&",post:"<",replyId:"<",revision:"<",readonly:"<"},require:"^comments",templateUrl:"https://www.bandlab.com/web-app/comment/partials/_comment-c3a438ee.html",controllerAs:"vm",controller:["$analytics","$element","$scope","Comment","Player","Me",function(e,t,n,o,r,i){const a=this;a.me=i,a.goToTimeAndPlay=function(t){r.goToTimeAndPlay(a.revision,t),e.eventTrack("Time Marker Click",{category:"Revision",label:"Comment Timestamp Link"})},a.getLikers=function(e){return Object.assign(e,{entity:a.entity,entityId:a.entityId,id:a.comment.id}),o.likersWithCursor(e).$promise},a.logCommentLike=function(){Promise.resolve().then((()=>fv)).then((e=>{let{logEvent:t}=e;t("comment_actions",{action:"like"})}))},a.$onInit=function(){const e=a.comment.id===(a.replyId||a.commentId);n.$applyAsync(),a.comment.id!==a.replyId&&a.comment.id!==a.commentId||setTimeout((function(){t[0].scrollIntoView({block:"center",behavior:"smooth"})})),e&&(a.highlighted=!0,setTimeout((function(){n.$applyAsync((function(){a.highlighted=!1}))}),2e3))},n.$on("$comment:highlight",(function(e,o){a.comment.id===o&&(setTimeout((function(){t[0].scrollIntoView({block:"center",behavior:"smooth"})})),a.highlighted=!0,setTimeout((function(){n.$applyAsync((function(){a.highlighted=!1}))}),2e3))})),n.$on("$comment:scrollIntoView",(function(e,n){n.id===a.comment.id&&t[0].scrollIntoView({block:"center",behavior:"smooth"})}))}]}),angular.module("bandlab.comment").directive("commentArea",["appActions",function(e){return{require:["ngModel","^form","^commentInput"],link:function(t,n,o,r){var i=r[0],a=r[1],s=r[2];n.on("focus",(function(t){e.checkAllowed("comment")||(t.preventDefault(),n[0].blur())})),n.bind("keydown",(function(e){13!==e.which||e.shiftKey||(!i.$valid||a.$submitted||t.suggestions?.["0users"].length||t.suggestions?.["1tags"].length||(a.$setSubmitted(),s.postComment(a)),e.preventDefault())}))}}}]),angular.module("bandlab.comment").component("commentInput",{bindings:{entity:"<",entityId:"<",onCommentEvent:"&",parentComment:"<",revision:"<",updateCounter:"&",disabled:"<"},require:"^comments",templateUrl:"https://www.bandlab.com/web-app/comment/partials/_comment-input-b8a745ca.html",controller:["$analytics","$element","$rootScope","$scope","AppNotifications","Comment","Me","Player",function(e,t,n,o,r,i,a,s){const l=this;let c=null;function u(){n.$broadcast("$timeMarker:removeTempTimeMarkers")}l.checkPlayerSong=function(){c=l.revision&&s.isCurrentSong(l.revision.id)&&s.getCurrentTime(),function(e){l.revision&&(u(),n.$broadcast("$timeMarker:addTempTimeMarker",{revisionId:l.revision.id,comment:{isTemporary:!0,createdOn:(new Date).toISOString(),creator:a,timestamp:e}}))}(c)},l.me=a,l.postComment=async function(t){if(angular.isFunction(l.onCommentEvent)&&l.onCommentEvent(),""===l.newComment.content.trim())return void t.$setPristine();const a=new i(l.newComment);return c&&(a.timestamp=c),a.$save({entity:l.entity,id:l.entityId}).then((function(t){l.newComment.content="",t.parentId=t.parentId||l.parentComment?.id,setTimeout((()=>o.$broadcast("elastic:adjust"))),n.$broadcast("$comment:changed",{action:"create",comment:t,entityId:l.entityId}),a.timestamp&&e.eventTrack("Add Comment with Timestamp",{category:"Revision"}),angular.isFunction(l.updateCounter)&&l.updateCounter({fn:e=>e+1})})).catch((e=>{if(201===e?.data?.errorCode||202===e?.data?.errorCode)return;const t=_.get(e,"data.message");r.addNotification({title:"Unable to post comment",content:t,classList:"alert",autoclose:5e3})})).finally((function(){t.$setPristine()}))},l.removeTempTimeMarkers=u,l.$onInit=function(){l.entity=l.entity||"posts",l.newComment={parentId:l.parentComment?.id},o.$on("replyComment",(function(e,n){const o=n.parentId||n.id;o&&o===l.parentComment?.id&&function(e){l.newComment.content=`@${e.creator.username} `,setTimeout((()=>{const e=t[0].querySelector("textarea.comment-textarea");e.focus(),e.setSelectionRange(l.newComment.content.length,l.newComment.content.length)}))}(n)}))}}],controllerAs:"vm"}),angular.module("bandlab.comment").component("commentPopover",{bindings:{comment:"<",revision:"<"},template:'<div class="popover-content">\n        <comment comment="vm.comment" revision="vm.revision" readonly="true" entity-id="vm.revision.postId" entity="\'posts\'"></comment>\n      </div>',controllerAs:"vm"}),angular.module("bandlab.comment").component("commentReplies",{bindings:{canEdit:"<",commentId:"<",deleteComment:"=",entity:"<",entityId:"<",entityPrefix:"<",parentComment:"<",readonly:"<",replyId:"<",replyTo:"=",revision:"<"},require:"^comments",templateUrl:"https://www.bandlab.com/web-app/comment/partials/_comment-replies-3510b64c.html",controller:["$element","$q","$rootScope","$scope","AppNotifications","Comment",function(e,t,n,o,r,i){const a=this;let s,l=t.resolve(),c=null,u=!1;function d(){if(!u)return u=!0,l=l.then((()=>i.query({after:c,entity:a.entity,id:a.entityId,limit:50,repliesTo:a.parentComment.id}).$promise)).then((function(t){let{paging:n,data:i}=t;a.newComments=a.newComments.filter((e=>!i.find((t=>t.id===e.id)))),a.comments=a.comments&&a.comments.concat(i)||i,a.hasMore=!!n.cursors.after,c=n.cursors.after,u=!1,function(t){if(!s)return;(t||[]).find((e=>e.id===a.replyId))?s=!1:a.hasMore?(a.highlightViewMore=!0,setTimeout((function(){e[0].querySelector(".comment-more-link").scrollIntoView({block:"center",behavior:"smooth"})})),setTimeout((function(){o.$applyAsync((function(){a.highlightViewMore=!1}))}),2e3)):(s=!1,r.addNotification({content:"Content not found or has been deleted",classList:"alert",autoclose:8e3}))}(i)})).catch((function(e){a.comments=a.comments??[],a.hasMore=!1,u=!1})),l}a.entity=a.entity||"posts",a.getMoreComments=d,a.hideComments=function(){a.comments=[],a.newComments=[],a.hasMore=!!a.parentComment.counters.replies,c=null,u=!1,n.$broadcast("$comment:scrollIntoView",a.parentComment)},a.newComments=[],a.onDelete=function(e){a.deleteComment({...e,parentId:a.parentComment?.id})},a.onReplyTo=function(e){a.replyTo({...e,parentId:a.parentComment?.id})},a.$onInit=function(){a.hasMore=!!a.parentComment.counters.replies,a.replyId&&a.parentComment.id===a.commentId&&(s=!0,d())},o.$on("$comment:changed",(function(e,t){let{action:n,comment:o,entityId:r}=t;if(r===a.entityId&&o.parentId===a.parentComment.id)if("create"===n){if(a.comments&&a.comments[0]&&a.comments[0].id===o.id)return;a.parentComment.counters.replies++,a.newComments?a.newComments.unshift(o):a.newComments=[o]}else if("delete"===n){const e=a.comments?.findIndex((e=>e.id===o.id));e>-1?(a.comments.splice(e,1),a.parentComment.counters.replies--):a.newComments.splice(a.newComments.findIndex((e=>e.id===o.id)),1)}}))}],controllerAs:"vm"}),angular.module("bandlab.comment").component("comments",{bindings:{canEdit:"<",counter:"<",commentId:"<",onCommentEvent:"&",entity:"<",entityId:"<",entityObj:"<",entityPrefix:"<",isMainInputShown:"<",loadedComments:"<",post:"<",replyId:"<",revision:"<",readonly:"<",scrollable:"<",updateCounter:"&",hideComments:"<"},templateUrl:"https://www.bandlab.com/web-app/comment/partials/_comments-e66484fc.html",controller:["$analytics","$q","$rootScope","$scope","$state","AppNotifications","Comment","ConfirmModal","Me",function(e,t,n,o,r,i,a,s,l){const c=this;let u,d=t.resolve();c.$onInit=function(){c.me=l,c.counter=c.counter||0,c.entity=c.entity||"posts",c.entityPrefix=c.entityPrefix||"post",c.entityObj=c.entityObj||c.post,c.isMainInputShown??=!0,u=c.scrollable?null:c.post?.afterForComments;const e=c.commentId&&!(c.loadedComments||[]).find((e=>e.id===c.commentId));c.loadedComments&&!e?(c.comments=c.hideComments?[]:c.loadedComments.map((function(e){return new a(e)})),c.hasMore=c.counter>c.comments.length+c.comments.reduce(((e,t)=>e+(t.counters?.replies||0)),0)):"posts"!==c.entity||c.entityObj.isCommentingAllowed?(c.comments=null,c.getMoreComments(!0).then((function(e){!function(e){if(!c.commentId)return;(e||[]).find((e=>e.id===c.commentId))||c.hasMore||i.addNotification({content:"Content not found or has been deleted",classList:"alert",autoclose:8e3})}(e),n.$broadcast("$comments:firstLoaded",c.entityId)}))):c.comments=[],p()},c.deleteComment=function(t){new s({confirmLabel:"Delete",contentScope:{title:"Delete this comment?",message:"<p>You wont be able to undo this action.</p>"},onConfirm:function(){return new a(t).$delete({entity:c.entity,entityId:c.entityId,id:t.id}).then((function(){t.parentId?n.$broadcast("$comment:changed",{action:"delete",comment:t,entityId:c.entityId}):c.comments.splice(c.comments.indexOf(t),1),c.counter--;const o="albums"===c.entity?"Album":"Post";if(e.eventTrack("Delete Comment",{category:o,value:c.counter}),p(),angular.isFunction(c.updateCounter)){const e=t.counters.replies;c.updateCounter({fn:t=>t-(1+e)})}}))}}).show()},c.getMoreComments=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return d=d.then((()=>a.query(u?{entity:c.entity,id:c.entityId,limit:10,after:u}:{entity:c.entity,id:c.entityId,limit:50}).$promise)).then((function(t){let{paging:n,data:o}=t;return c.loadedComments&&c.loadedComments[0]?.id===o[0]?.id?c.comments=o:((!c.comments||c.loadedComments&&c.comments.length<c.loadedComments.length)&&(c.comments=c.loadedComments?c.loadedComments.map((function(e){return new a(e)})):[]),c.comments=c.comments&&c.comments.concat(o)||o),u=n.cursors.after,c.hasMore=u,p(),e&&c.comments[0]&&setTimeout((()=>{const e=document.getElementById(c.comments[0].id);e&&e.scrollIntoView()})),o})).catch((function(){c.comments=c.comments??[],c.hasMore=!1})),d},c.replyTo=function(e){c.replyCommentId=e.parentId||e.id,e.entityId=c.entityId,n.$broadcast("replyComment",e),Promise.resolve().then((()=>fv)).then((e=>{let{logEvent:t}=e;t("comment_actions",{action:"reply"})}))};const p=ay((()=>{c.revision&&n.$broadcast("$comments:loaded",{revision:c.revision,comments:c.comments})}),1e3);o.$on("$comment:changed",(function(t,n){let{action:o,comment:i,entityId:a}=n;if("create"===o){if(a!==c.entityId||c.comments&&c.comments[0]&&c.comments[0].id===i.id)return;!function(t){t.parentId||c.comments.unshift(t);const n=!!c.replyCommentId;c.counter++,c.replyCommentId=null;const o="albums"===c.entity?"Album":"Post",i=c.entityObj.creator.id;e.eventTrack("Create Comment",{category:o,value:c.counter,entityId:c.entityId,entityCreatorId:i,isReply:n,extra:{post_type:c.post?.type.toLowerCase(),post_visibility:c.post?.state.toLowerCase(),triggered_from:_p(r),trending_post_type:c.post?.trendingPostType}}),p(),setTimeout((()=>{const e=document.getElementById(`comment-${t.id}`);e&&e.scrollIntoView({block:"nearest",behavior:"smooth"})}))}(i),angular.isFunction(c.updateCounter)&&c.updateCounter({fn:e=>e+1})}}))}],controllerAs:"vm"}),angular.module("bandlab.common",[]).directive("walkthrough",["$injector",function(e){return{scope:{steps:"<",onEnded:"&"},link:function(t,n){const o=import("./chunk-f99982a5.js").then((function(o){let{mountWalkthrough:r}=o;return r(n[0],{$injector:e},{scope:t,walkthroughId:n[0].id,steps:t.steps,onEnded:t.onEnded})}));t.$on("$destroy",(async function(){(await o).unmount(),n.remove()}))}}}]),angular.module("bandlab.common").directive("a",(function(){return{restrict:"E",compile:function(e,t){return angular.isUndefined(t.ngDisabled)?null:function(e,t,n){t.on("click",(function(e){!0===n.disabled&&e.preventDefault()}))}}}})),angular.module("bandlab.common").directive("searchLocation",["$filter","$parse","Place",function(e,t,n){const o=e("location");return{require:["^form","ngModel"],link:function(e,r,i,a){const s=a[1];let l=[];s.$viewChangeListeners.push((function(){const t=s.$viewValue;n.query({query:t}).$promise.then((function(t){l=t,e.placeSuggestions={places:t}}))})),s.$formatters.push((function(e){return o(e)})),s.$overrideModelOptions({allowInvalid:!0}),s.$parsers.push((function(e){var t=e;for(let n=0;n<l.length;n++)if(l[n].name===e){t=l[n];break}return t})),s.$validators.validPlace=function(e){return!e||e&&e.name},e.completeLocation=function(n){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.ngModel;(0,t(o).assign)(e,n),s.$processModelValue(),e.placeSuggestions={}}}}}]),angular.module("bandlab.common").directive("asyncModal",["$parse","appActions","Modal",function(e,t,n){return{restrict:"A",link:function(o,r,i){var a;r.on("click",(function(r){r.preventDefault(),i.asyncModalAction&&!t.checkAllowed(i.asyncModalAction)||function(){if(!a){var t={class:i.asyncModalClass,id:i.asyncModalId||ad(),templateUrl:i.asyncModal,onDestroy:function(){a=null}};"false"===i.asyncModalOverlayClose&&(t.overlayClose=!1),"true"===i.asyncModalEscapeClose&&(t.escapeClose=!0),i.asyncModalParse&&(t.contentScope=e(i.asyncModalParse)(o)),(a=new n(t)).show()}}()}))}}}]),angular.module("bandlab.common").directive("asyncValid",["$q","$timeout","Validation",function(e,t,n){return{require:"ngModel",restrict:"A",scope:{asyncValid:"="},priority:100,link:function(o,r,i,a){if(!a)return;let s,l,c,u={};const d=a.$render;function p(r,i){if(u.$$timeoutId&&t.cancel(u),a.$setValidity("available",!0),a.$setValidity("valid",!0),angular.isString(s)&&l===s)return e.resolve();if(""===r&&a.$untouched)return e.resolve();if(c&&0===c.$$state.status&&!i)return c;const d=o.asyncValid.testStrength?e=>e():e=>t(e,500);return u=d((function(){return c=n.validate(o.asyncValid.entity,o.asyncValid.key,r).then((function(e){if(r!==l)return p(l,!0);o.asyncValid.testAvailability&&a.$setValidity("available",e.data.isAvailable),o.asyncValid.testValidity&&a.$setValidity("valid",e.data.isValid),o.asyncValid.testStrength&&a.$setValidity("strong",!e.data.includes(r)&&!o.asyncValid.disallowed.includes(r)),e.data.errorMessage?a.errorMessage=e.data.errorMessage:a.errorMessage=null})).catch((function(){o.asyncValid.bypassCatch||(a.$setValidity("valid",!1),a.errorMessage=null)})),c})),u}a.$render=function(){angular.isString(a.$modelValue)&&angular.isUndefined(s)&&(s=a.$viewValue),d()},a.$asyncValidators.asyncValid=function(e){return l=e??"",p(l)},r.one("blur",(function(){a.$validate()}))}}}]),angular.module("bandlab.common").directive("autofocus",["$stateParams",function(e){return{restrict:"A",link:function(t,n){if(!Zf&&!Qf)return e.focus&&e.focus===n.attr("name")?setTimeout((function(){n[0].focus()}),100):void 0;n[0].removeAttribute("autofocus")}}}]),angular.module("bandlab.common").directive("backToTop",["$analytics","$transitions",function(e,t){return{restrict:"E",replace:!0,templateUrl:"https://www.bandlab.com/web-app/common/partials/_back-to-top-5bf56e25.html",link:function(n,o){const r=document.scrollingElement||document.body,i=t.onExit({},s);let a=0;function s(){o.removeClass("up").removeClass("down"),a=0}function l(){0===r.scrollTop&&0===a?o.removeClass("up").removeClass("down"):0===r.scrollTop&&a>0?o.removeClass("up").addClass("down"):r.scrollTop>0&&(a=0,o.removeClass("down").addClass("up"))}window.addEventListener("scroll",l,{passive:!0}),n.$on("backToTop",s),o.on("click",(function(){a=r.scrollTop||a,r.scrollTop=0===r.scrollTop?a:0,r.scrollTop>0&&(a=0),o.removeClass("up").removeClass("down"),e.eventTrack(r.scrollTop?"Back to bottom":"Back to top",{category:"Navigation",value:r.scrollTop})})),n.$on("$destroy",(function(){window.removeEventListener("scroll",l,{passive:!0}),i()}))}}}]),angular.module("bandlab.common").directive("createPost",["$analytics","$injector","$rootScope","Modal",function(e,t,n,o){return{restrict:"EA",replace:!0,scope:{caption:"<",entityType:"<",entity:"<",image:"<",me:"<",onPostCreate:"<",text:"<"},link:function(r,i){const a=import("./chunk-554ed3f9.js").then((function(e){let{mountCreatePost:o}=e;return o(i[0],{$rootScope:n,$injector:t},{text:r.text,entity:r.entity,entityType:r.entityType,injectedCaption:r.caption,injectedImage:r.image,onPostCreate:r.onPostCreate,onLiveStreamButtonClick:s})}));function s(){e.eventTrack("Open BandLab Live",{category:"Content Creation",label:"Post Creation"}),new o({id:"createShowModal",templateUrl:"https://www.bandlab.com/web-app/show/partials/_go-live-a95c8927.html"}).show()}r.$on("$destroy",(async function(){(await a).unmount()}))}}}]),angular.module("bandlab.common").directive("clipboard",(function(){return{restrict:"A",link:function(e,t,n){t.on("click",(()=>{RD(e.$eval(n.text))}))}}})),angular.module("bandlab.common").directive("contextMenu",["$compile","$templateRequest",function(e,t){return{replace:!0,restrict:"E",link:function(n,o,r){var i,a,s=angular.element(document.querySelector("main"));o.parent().on("contextmenu",(function(l){function c(){a$.element&&(a$.element[0].style.display="none",a$.openerElement.removeClass("active")),a$.element=null,s.off("click",c),s.off("keydown",u),i&&(i.remove(),a.$destroy(),i=null,a=null)}function u(e){13!==e.which&&9!==e.which&&27!==e.which||c()}r.disabled||(l.preventDefault(),l.stopPropagation(),t(r.template).then((t=>{setTimeout((function(){c(),function(t,r){a=n.$new(),(i=e(r)(a))[0].style.display="inline-block",a.$digest(),s.append(i),a$.element=i,a$.openerElement=o;var l=i[0].clientWidth+t.clientX,d=i[0].clientHeight+t.clientY,p=t.clientX,m=t.clientY,f=i[0].querySelectorAll(".dropdown-cascading-item ul");l>window.innerWidth&&(p-=l-window.innerWidth),d>window.innerHeight&&(m-=d-window.innerHeight),i.css({left:`${p}px`,top:`${m}px`,visibility:"hidden"}),p$(f),i.css({visibility:null}),s.on("click",c),s.on("keydown",u)}(l,t)}))})))}))}}}]),angular.module("bandlab.common").directive("datePicker",["$compile",function(e){function t(e,t){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e=>e;const o=[];if("DESC"===(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ASC"))for(let r=t;r>=e;r--)o.push(`<option value="${r}">${n(r)}</option>`);else for(let r=e;r<=t;r++)o.push(`<option value="${r}">${n(r)}</option>`);return o}return{restrict:"C",require:"ngModel",scope:{dateDirection:"@",dateMin:"@",dateMax:"@",dateType:"@",dateDisabled:"="},link:function(n,o,r,i){if(!i)return;const a=n.dateMin?new Date(n.dateMin):new Date((new Date).getUTCFullYear()-100,0,1,0,0),s=n.dateMax?new Date(n.dateMax):new Date((new Date).getUTCFullYear()+100,0,1,23,59),l="ASC"===n.dateDirection?"ASC":"DESC",c="date"===n.dateType||"time"===n.dateType?n.dateType:"datetime",u=`<select ng-model="pickDate.year"><option value="0" selected>Year</option>${t(a.getUTCFullYear(),s.getUTCFullYear(),l)}</select>`,d=`<select ng-model="pickDate.month"><option value="0" selected>Month</option>${t(1,12,"ASC")}</select>`,p=`<select ng-model="pickDate.day"><option value="0" selected>Day</option>${t(1,31,"ASC")}</select>`,m=`<select ng-model="pickDate.hour"><option value="null" selected>Hour</option>${t(0,23,"ASC",(e=>`0${e}`.slice(-2)))}</select>`,f=`<select ng-model="pickDate.minute"><option value="null" selected>Minute</option>${t(0,59,"ASC",(e=>`0${e}`.slice(-2)))}</select>`;let h=`<div class="select-date-picker select-height-40">${p}${d}${u}${m}${f}</div>`;"date"===c?h=`<div class="select-date-picker select-height-40" ng-class="{ 'disabled': dateDisabled }">${p}${d}${u}</div>`:"time"===c&&(h=`<div class="select-date-picker select-time-picker select-height-40">${m}${f}</div>`);const g=angular.element(h);o.attr("type","hidden"),o.parent().append(g),e(g)(n),n.pickDate={year:"0",month:"0",day:"0",hour:"null",minute:"null"},i.$render=function(){if(angular.isDefined(i.$viewValue))if(null===i.$viewValue)n.pickDate={year:"0",month:"0",day:"0",hour:"null",minute:"null"};else{const e=new Date(i.$viewValue);n.pickDate={year:`${e.getUTCFullYear()}`,month:`${parseInt(e.getUTCMonth()+1)}`,day:`${e.getUTCDate()}`,hour:`${e.getUTCHours()}`,minute:`${e.getUTCMinutes()}`}}},n.$watch("pickDate",(function(e,t){e!==t&&function(){const e="null"===n.pickDate.hour||"null"===n.pickDate.minute,t="0"===n.pickDate.year||"0"===n.pickDate.month||"0"===n.pickDate.day;let o=e||t;if("time"===c?o=e:"date"===c&&(o=t),o)if(i.$setViewValue(null),i.$setValidity("range",!0),r.required)i.$setValidity("complete",!1);else{const e="null"===n.pickDate.hour&&"null"===n.pickDate.minute,t="0"===n.pickDate.year&&"0"===n.pickDate.month&&"0"===n.pickDate.day;let o=e&&t;"time"===c?o=e:"date"===c&&(o=t),i.$setValidity("complete",o)}else{n.pickDate.hour="null"===n.pickDate.hour?0:n.pickDate.hour,n.pickDate.minute="null"===n.pickDate.minute?0:n.pickDate.minute,i.$setValidity("complete",!0);const e=new Date(`${n.pickDate.year}-${`0${n.pickDate.month}`.slice(-2)}-${`0${n.pickDate.day}`.slice(-2)}`);e.setUTCHours(n.pickDate.hour),e.setUTCMinutes(n.pickDate.minute);const t=e.getUTCDate()===parseInt(n.pickDate.day);i.$setValidity("day-of-the-month",t),e>s||e<a?i.$setValidity("range",!1):i.$setValidity("range",!0),i.$setViewValue(e)}}()}),!0)}}}]),angular.module("bandlab.common").directive("draggableTile",(function(){let e=null,t=null,n=null;return{scope:{allowed:"=",entity:"=",updateOrder:"=fnUpdateOrder",tile:"=",tileId:"=",tileList:"="},link:function(o,r){const i=o.tileList,a=o.tile;let s;if(!o.allowed)return;const l=r[0].closest(".draggable-tile");function c(e){e.preventDefault()}r[0].draggable=!0,r[0].addEventListener("dragstart",(function(t){t.stopPropagation(),e=a,t.dataTransfer.setData("text/plain",""),t.dataTransfer.setDragImage&&(s=this.parentElement.cloneNode(!0),s.style.borderRadius="2px",s.style.padding="4px",s.style.transform="translateX(-500px)",s.style.width="400px",document.body.appendChild(s),t.dataTransfer.setDragImage(s,0,0)),l.addEventListener("dragover",c)})),r[0].addEventListener("dragend",(function(){s&&document.body.removeChild(s);const r=i.indexOf(e);r!==n&&null!==n&&(i.splice(r,1),i.splice(n,0,e),o.updateOrder(o.tileId,n+1)),t=null,e=null,n=null,l.classList.remove("is-dropped-above"),l.classList.remove("is-dropped-below"),l.removeEventListener("dragover",c),o.$applyAsync()})),l.addEventListener("dragover",(function(r){if(r.target.contains(this)||null===e||e===a)return;const s=function(e,t){const n=e.getBoundingClientRect();return n.top+n.height-t.y>n.height/2}(l,r),c=i.indexOf(e)<i.indexOf(a),u=i.indexOf(a);t=a,n=s||c?s&&c?u-1:u:u+1,function(e,o){return t===a&&(n<e||!o&&n===e)}(u,c)?l.classList.add("is-dropped-above"):l.classList.remove("is-dropped-above"),function(e,o){return t===a&&(n>e||o&&n===e)}(u,c)?l.classList.add("is-dropped-below"):l.classList.remove("is-dropped-below"),o.$applyAsync()})),l.addEventListener("dragleave",(function(){l.classList.remove("is-dropped-above"),l.classList.remove("is-dropped-below"),o.$applyAsync()}))}}})),angular.module("bandlab.common").directive("dropdownMenu",["$animate","$compile","$parse","$rootScope","$templateRequest","$transitions","Me",function(e,t,n,o,r,i,a){return{restrict:"A",link:function(s,l,c){var u,d,p,m=angular.element(document.body),f="parent"===c.dropdownMenuContainer&&l[0].parentElement||l[0].closest("main")||l[0].closest(".title-bar")||l[0].closest(".view-overlay")||l[0].closest(".modal-overlay")||document.body,h=l[0].closest(".modal")||document.body,g=angular.noop;function v(r){function v(e){e.target.classList.contains("dropdown-cascading-item")||setTimeout((function(){b(),c.dropdownOnClose&&n(c.dropdownOnClose)(s)()}),0)}function b(){if(!YA.value&&(a$.element=null,g(),h.removeEventListener("click",v),document.body.removeEventListener("keydown",y),window.removeEventListener("resize",v),d)){const t=p;e.leave(d),l.removeClass("active"),o.$applyAsync((function(){t.$destroy()})),p=null,d=null}}function y(e){27===e.which&&b()}r?.stopPropagation(),a$.element&&a$.element!==d?(a$.element[0].style.display="none",a$.openerElement.removeClass("active")):a$.isVueDropdownVisible?.value&&(a$.isVueDropdownVisible.value=!1,a$.isVueDropdownVisible=null),setTimeout((function(){!function(){if(d&&"none"!==d[0].style.display)return void b();b(),(p=s.$new()).me=a,c.dropdownMenuParse&&Object.assign(p,n(c.dropdownMenuParse)(s)),c.dropdownCloseOnResize&&window.addEventListener("resize",b);const o=function(e){return[...e.querySelectorAll("[autofocus]")].filter((function(e){return e.autofocus=!1,e}))}((d=t(u)(p))[0]);m.append(d),p.$digest(),l.addClass("active"),g=i.onStart({},b),a$.element=d,a$.openerElement=l,u$(l[0],d[0],c),p$(d[0].querySelectorAll(".dropdown-cascading-item > ul")),setTimeout((function(){h.addEventListener("click",v),document.body.addEventListener("keydown",y)})),p.$on("$dropdownMenu:close",b),e.enter(d,f).then((function(){o.forEach((function(e){e.focus()}))})),p.$digest()}()}))}l[0].closest(".global-player")&&(f=l[0].parentElement,c.dropdownMenuContainer="parent"),r(c.dropdownMenu).then((function(e){u=e,l.on("click",v)}))}}}]).directive("dropdownCascadingItem",(function(){return{restrict:"C",link:function(e,t){const n=t[0].closest(".dropdown")||t[0].closest(".select-menu");function o(e){t[0].contains(e.target)||(t.removeClass("visible"),n.removeEventListener("mouseover",o))}t.on("mouseover",(function(){t.addClass("visible"),n.addEventListener("mouseover",o)}))}}})),angular.module("bandlab.common").directive("dsZeroCase",["$compile","$injector","$rootScope",function(e,t,n){return{restrict:"E",replace:!0,scope:{illustrationIcon:"@",title:"@?",message:"@?",cta:"@?",verticalAlignment:"@?"},template:"<div></div>",link:function(o,r){import("./chunk-78e65df2.js").then((function(i){let{mountZeroCase:a}=i;const s=a(r[0],{$compile:e,$injector:t,$rootScope:n,scope:o,illustrationIcon:o.illustrationIcon,title:o.title,message:o.message,cta:o.cta,verticalAlignment:o.verticalAlignment});o.$on("$destroy",(function(){s.unmount()}))}))}}}]),angular.module("bandlab.common").directive("segmentedControl",(function(){return{restrict:"C",link:function(e,t){const n="--segmented-control-selected-label",o=t[0];let r,i=[],a=!1;const s=new ResizeObserver((function(e){e.forEach((e=>{0===e.contentRect.width&&(o.classList.remove("active"),a=!0),o.style.setProperty(`${n}-background-position-x-offset`,`${e.contentRect.x||0}px`)}))})),l=new ResizeObserver((function(e){e.forEach((e=>{o.style.setProperty(`${n}-width-for-${e.target.htmlFor}`,`${e.contentRect.width}px`),o.style.setProperty(`${n}-background-position-x-for-${e.target.htmlFor}`,`${e.target.offsetLeft}px`)}))}));function c(){a&&r&&(o.classList.add("active"),a=!1),o.style.removeProperty(`${n}-background-color`),o.style.setProperty(`${n}-width`,`var(${n}-width-for-${r.htmlFor})`),o.style.setProperty(`${n}-background-position-x`,`calc(\n              var(${n}-background-position-x-for-${r.htmlFor})\n              - var(${n}-background-position-x-offset)\n            )`),o.classList.contains("active")||requestAnimationFrame((()=>{o.classList.add("active"),a=!1}))}function u(e){r=e.target.nextElementSibling,c()}s.observe(o),e.$watch((()=>o.children.length),(function(e){e&&(l.disconnect(),i=o.querySelectorAll("input"),i.forEach((e=>{l.observe(e.nextElementSibling),e.removeEventListener("change",u),e.addEventListener("change",u),e.checked&&(r=e.nextElementSibling,c())})),r||o.style.setProperty(`${n}-background-color`,"transparent"))})),e.$watch((function(){const e=Array.from(i??[]).find((e=>e.checked));e&&e.nextElementSibling!==r&&(r=e.nextElementSibling,c())})),e.$on("$destroy",(function(){l.disconnect(),s.disconnect()}))}}}));const AD={click:{adEvent:"engagementEvent",adType:"engagement"},comment:{adEvent:"commentEvent",adType:"comment"},follow:{adEvent:"followEvent",adType:"follow"},like:{adEvent:"likeEvent",adType:"like"},play:{adEvent:"playEvent",adType:"play"},profile:{adEvent:"profileOpenEvent",adType:"profileOpen"},shareOpen:{adEvent:"shareOpenEvent",adType:"shareOpen"}};function xD(){let e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return co((()=>{e.unobserve(t)})),{setElement:function(r){t=r,e=LD(t,n,o),e.observe(t)}}}function LD(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},{duration:n=300,threshold:o=.5}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=!1;const i=new IntersectionObserver((function(a){a[0].isIntersecting&&a[0].intersectionRatio>o?(r=!0,setTimeout((function(){r&&(r=!1,i.unobserve(e),t())}),n)):r=!1}),{root:null,rootMargin:"48px 0px 0px 0px",threshold:[0,o]});return i}function OD(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{};return{setElement:function(n){e=n,e.addEventListener("click",t)}}}function jD(e,t){return`<svg width="${t.size}" height="${t.size}" viewBox="0 0 ${t.size} ${t.size}"></svg>`}function DD(e,t,n){const o="svg"===t[0].nodeName?t[0]:t[0].firstChild;let r=i();function i(){return import("./chunk-f06a5bb6.js").then((e=>{let{mount:t}=e;return t(o,{},{name:n.name,size:+n.size})}))}n.$observe("name",(async function(){await async function(){return(await r).unmount()}(),r=i()})),n.$observe("size",(function(e){o.setAttribute("width",e),o.setAttribute("height",e),o.setAttribute("viewBox",`0 0 ${e} ${e}`)}))}function ND(e){return{restrict:"A",link:function(t,n,o){var r,i="";o.zfClose&&"allowDefault"!==o.zfClose?i=o.zfClose:(r=n[0].closest("[zf-closable]"))?i=r.getAttribute("id"):n.remove(),n.on("click",(function(t){e.$broadcast(i,"close"),"allowDefault"!==o.zfClose&&t.preventDefault()}))}}}function UD(e){return{restrict:"E",templateUrl:"https://www.bandlab.com/web-app/common/modal/modal-66f0f560.html",transclude:!0,scope:!0,replace:!0,link:function(t,n,o){t.hideOverlay=function(){"overlayClose"in o&&e.$broadcast(o.id,"close")},"escapeClose"in o&&(n.attr("tabindex","0"),t.hideOverlayWithKey=t.hideOverlay)}}}function FD(e,t,n,o,r,i,a){return function(s){var l,c=s.id||ad(),u=o.$new(),d=s.templateUrl?r(s.templateUrl):s.template,p=r("https://www.bandlab.com/web-app/common/modal/modal-66f0f560.html"),m=s.noStateChangeListeners?angular.noop:a.onEnter({},g),f=s.noStateChangeListeners?angular.noop:a.onBefore({from:"useChrome"},g),h=angular.noop;return Object.assign(u,s.contentScope),u.cancel=function(){g(),angular.isFunction(s.onCancel)&&s.onCancel()},u.confirm=function(e){g(),angular.isFunction(s.onConfirm)&&s.onConfirm(e)},u.$on(c,(function(e,t){"close"===t&&u.cancel()})),{destroy:g,show:function(){return angular.isFunction(s.onBeforeCreate)&&s.onBeforeCreate(),n.all([p,d]).then((function(n){let[,o]=n;var r;l=function(e){if(!document.getElementById(c)){var t=`<zf-modal class="modal-overlay" id="${c}">${e}</zf-modal>`;return t=angular.element(t),!1!==s.overlayClose&&t.attr("overlay-close",!0),!1!==s.escapeClose&&t.attr("escape-close",!0),s.class&&s.class.split(" ").forEach((function(e){t.addClass(e)})),s.confirmLabel&&(t[0].querySelector(".modal-confirm").innerHTML=s.confirmLabel),s.cancelLabel&&(t[0].querySelector(".modal-cancel").innerHTML=s.cancelLabel),t}}(o),t(l)(u),r=function(){h=DL(),angular.isFunction(s.onCreate)&&s.onCreate(l),e.enter(l,document.body,document.body.lastChild).then((function(){angular.isFunction(s.onAfterCreate)&&s.onAfterCreate(l),l[0].focus(),s.toFocusConfirm?l[0].querySelector(".modal-confirm")?.focus():l[0].querySelector(".modal-cancel")?l[0].querySelector(".modal-cancel").focus():l[0].querySelectorAll("[autofocus]").forEach((function(e){e.focus()}))}))},setTimeout((function(){setTimeout((function(){setTimeout((function(){i(r)}))}))}))}))}};function g(){let{animation:t=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};angular.isFunction(s.onBeforeDestroy)&&s.onBeforeDestroy(),m(),f(),l&&i((function(){h(),angular.isFunction(s.onDestroy)&&s.onDestroy(),u.$destroy(),t||e.enabled(l,!1),e.leave(l)}))}}}function BD(e){return function(t){return t.templateUrl="https://www.bandlab.com/web-app/common/modal/confirm-modal-74956fc8.html",t.escapeClose=!0,new e(t)}}function WD(e){return function(t){return t.templateUrl="https://www.bandlab.com/web-app/common/modal/message-modal-7ad78c84.html",t.escapeClose=!0,new e(t)}}function VD(e){return function(t){return t.templateUrl="https://www.bandlab.com/web-app/chat/partials/_retry-modal-d476f46d.html",new e(t)}}function qD(e,t){return{restrict:"E",replace:!0,link:function(n,o){Promise.all([Promise.resolve().then((()=>Tg)),import("./chunk-b72ea659.js")]).then((function(r){let[{modals:i},{mountModalGroup:a}]=r;const s=a(o[0],{$injector:e}),l=t.onEnter({},(function(){i.value=[]}));n.$on("$destroy",(function(){s.unmount(),l()}))}))}}}function zD(e){return{restrict:"E",template:'\n      <div class="notification-container">\n        <zf-notification\n          ng-repeat="notification in vm.notifications track by notification.id"\n          autoclose="notification.autoclose"\n          class="animate notification"\n          class-list="notification.classList"\n          action="notification.action"\n          inner-scope="notification.innerScope"\n          image="notification.image"\n          on-dismiss="notification.onDismiss"\n          on-hide="notification.onHide"\n          max-visible-notifications="notification.maxVisibleNotifcations"\n          notif-id="notification.id"\n          data-title="notification.title">\n          <notification-content bind-html-compile="notification.content"></notification-content>\n          <notification-action bind-html-compile="notification.action"></notification-action>\n        </zf-notification>\n        <project-uploader></project-uploader>\n        <tip-user-prompt></tip-user-prompt>\n      </div>\n    ',replace:!0,scope:{position:"@"},controllerAs:"vm",controller:function(){const t=this;t.notifications=[],t.addNotification=function(e){e.id?t.removeNotification(e.id):e.id=ad(),t.notifications.push(e),t.notifications.length>=e.maxVisibleNotifications&&t.notifications.splice(0,t.notifications.length-e.maxVisibleNotifications)},t.removeNotification=function(n){e.$broadcast("removeNotification",{id:n}),Gf(t.notifications,{id:n})},t.clearAll=function(){t.notifications=[]}},link:function(t,n,o,r){var i=e.$on(o.id,(function(e,n){"clearall"===n?r.clearAll():(r.addNotification(n),t.$applyAsync())}));t.$on("$destroy",i)}}}function HD(e,t){return{restrict:"E",template:'\n      <div class="notification" ng-class="classList">\n        <div href="#" class="notification-close" ng-click="hide(); onDismiss(); $event.preventDefault(); $event.stopPropagation()"><i class="icon-close"></i></div>\n        <div class="notification-image" ng-if="image"><img ng-srcset="{{ image }}"/></div>\n        <svg class="notification-icon" ng-if="classList.indexOf(\'warning\') > -1" width="48" height="48" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path fill-rule="evenodd" clip-rule="evenodd" d="M36.3811 31.32L21.8123 6.61844C21.007 5.25609 18.9937 5.25609 18.1883 6.61844L3.61952 31.32C2.81421 32.6824 3.80254 34.4033 5.41317 34.4033H34.5508C36.1981 34.4033 37.1864 32.6824 36.3811 31.32Z" fill="#FFBA00"/>\n          <path fill-rule="evenodd" clip-rule="evenodd" d="M20.0186 30.603C18.9936 30.603 18.1883 29.7784 18.1883 28.7746C18.1883 27.7707 19.0302 26.9461 20.0552 26.9461C21.0801 26.9461 21.8854 27.7707 21.8854 28.8104C21.8488 29.7784 21.0069 30.603 20.0186 30.603Z" fill="white"/>\n          <path fill-rule="evenodd" clip-rule="evenodd" d="M19.5427 14.1831C20.4212 13.9679 21.2998 14.3982 21.7024 15.1869C21.8488 15.4737 21.8854 15.7964 21.8488 16.0832C21.7756 16.9795 21.739 17.8757 21.7024 18.8079C21.6292 20.2061 21.5194 21.6401 21.4462 23.0383C21.4096 23.4686 21.4096 23.8988 21.373 24.3648C21.3364 25.1177 20.7507 25.6913 19.982 25.6913C19.2499 25.6913 18.6276 25.1177 18.591 24.4007C18.4812 22.2138 18.3347 20.0268 18.2249 17.8399C18.1883 17.2663 18.1517 16.6568 18.1151 16.0832C18.1151 15.2227 18.7008 14.3982 19.5427 14.1831Z" fill="white"/>\n        </svg>\n        <svg class="notification-icon" ng-if="classList.indexOf(\'success\') > -1" width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path fill-rule="evenodd" clip-rule="evenodd" d="M44 24C44 35.0457 35.0457 44 24 44C12.9543 44 4 35.0457 4 24C4 12.9543 12.9543 4 24 4C35.0457 4 44 12.9543 44 24ZM21.9412 26.5342L30.3652 18.3527C30.9491 17.7856 31.8785 17.7876 32.4599 18.3571L33.7347 19.6059C34.337 20.1958 34.3349 21.1661 33.7301 21.7534L25.1117 30.1238L25.1291 30.1407L22.8574 32.3471C22.0988 33.0838 20.9926 32.654 20.5344 32.3471L14.2615 26.2074C13.6606 25.6193 13.6604 24.6523 14.261 24.0639L15.5342 22.8168C16.1179 22.245 17.0519 22.2456 17.6349 22.8181L21.4171 26.5327C21.5624 26.6754 21.7951 26.6761 21.9412 26.5342Z" fill="#00C37D"/>\n        </svg>\n        <svg class="notification-icon" ng-if="classList.indexOf(\'alert\') > -1" width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path fill-rule="evenodd" clip-rule="evenodd" d="M44 24C44 35.0457 35.0457 44 24 44C12.9543 44 4 35.0457 4 24C4 12.9543 12.9543 4 24 4C35.0457 4 44 12.9543 44 24ZM24 27.3333C23.0596 27.3333 22.2798 26.6978 22.2154 25.8789L21.599 18.0395L21.5014 15.7726C21.4597 14.8046 22.3475 14 23.4573 14H24.5427C25.6525 14 26.5403 14.8046 26.4986 15.7726L26.401 18.0395L25.7846 25.8789C25.7202 26.6978 24.9404 27.3333 24 27.3333ZM26.5 31.5C26.5 32.8807 25.3807 34 24 34C22.6193 34 21.5 32.8807 21.5 31.5C21.5 30.1193 22.6193 29 24 29C25.3807 29 26.5 30.1193 26.5 31.5Z" fill="#F12C18"/>\n</svg>\n        <svg class="notification-icon" ng-if="classList.indexOf(\'loading\') > -1" width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <rect width="48" height="48" rx="4" fill="#F1F4F6"/>\n          <path class="notification-icon-loading-spinner" fill-rule="evenodd" clip-rule="evenodd" d="M24 12.33c-.67 0-1.2.54-1.2 1.2 0 .68.53 1.21 1.2 1.21A9.26 9.26 0 1 1 14.74 24c0-.67-.53-1.2-1.2-1.2-.67 0-1.2.53-1.2 1.2A11.7 11.7 0 0 0 24 35.67 11.7 11.7 0 0 0 35.67 24 11.7 11.7 0 0 0 24 12.33Z" fill="#282C32"/>\n        </svg>\n        <div class="notification-content">\n          <h1 ng-bind-html="trustedTitle" ng-if="trustedTitle" class="text-truncate-2-lines"></h1>\n          <p ng-transclude="content"></p>\n        </div>\n        <div class="notification-action" ng-if="action" ng-transclude="action" ng-click="hide(); onDismiss()">\n        </div>\n      </div>\n    ',replace:!0,transclude:{action:"notificationAction",content:"notificationContent"},require:"^zfNotificationSet",scope:{action:"=?",autoclose:"=?",classList:"=?",content:"=?",image:"=?",innerScope:"=?",onDismiss:"=?",onHide:"=?",maxVisibleNotifications:"=?",notifId:"=",title:"=?"},link:function(n,o,r,i){n.hide=function(){i.removeNotification(n.notifId),n.onHide&&n.onHide()},r.title&&n.$watch("title",(function(t){t&&(n.trustedTitle=e.trustAsHtml(t))})),n.autoclose&&s(),n.$watch("autoclose",(e=>{e&&s()}));let a=!1;function s(){t((function(){a?s():n.hide()}),parseInt(n.autoclose))}o.on("mouseleave",(function(){a=!1})),o.on("mouseenter",(function(){a=!0}))}}}function GD(e,t){return function(){var n=ad(),o=angular.element("<zf-notification-set></zf-notification-set>"),r=t.$new();return o.attr("id",n),e(o)(r),angular.element(document.body).append(o),{addNotification:function(e){t.$broadcast(n,e)},clearAll:i,destroy:function(){i(),setTimeout((function(){r.$destroy(),o.remove()}))}};function i(){t.$broadcast(n,"clearall")}}}function KD(e,t,n,o,r,i,a,s,l){var c,u=5,d=null,p=!1,m=e.url();function f(){return n.infiniteScrollEnded?t.resolve():c=c.then((function(e){n.infiniteScrollEnded=p,n.posts=n.posts||[];const t=e.filter((e=>!e.isPinned)),o=e.filter((e=>e.isPinned));return n.posts=n.posts.concat(t),n.pinned=n.pinned||o,a.pushQueueSongs([...o,...t],m),h()}))}function h(){return p?t.resolve([]):c=s.fromCommunity({after:d,communityId:l.id,limit:u}).$promise.then((function(e){return p=e.paging.itemsCount<e.paging.limit,d=_.get(e,"paging.cursors.after",0),e.data}))}a.setCurrentPageContext({contentSource:"community",loader:f,url:m}),n.loadMore=f,n.me=i,n.onPostCreate=function(e){n.posts.unshift(e)},h().then(f),n.$on("$post:delete",(function(e,t){Gf(n.posts,(function(e){return e.id===t.post.id})),n.pinned.length&&Gf(n.pinned,(function(e){return e.id===t.post.id}))})),n.$on("$user:relationChanged",(function(e,t){"block"===t.type&&(Gf(n.posts,(function(e){return e.creator.id===t.user.id})),n.pinned.length&&Gf(n.pinned,(function(e){return e.creator.id===t.user.id})))})),n.$on("$destroy",(function(){r.cancel(void 0)})),n.$on("$post:pin",(function(e,t){let{post:i}=t;_.find(n.posts,{id:i.id})&&r((()=>o.reload("community.feed")),1e3)})),n.$on("$post:unpin",(function(e,t){let{post:i}=t;_.find(n.pinned,{id:i.id})&&r((()=>o.reload("community.feed")),1e3)}))}function YD(e,t,n){return 201===n&&Promise.resolve().then((()=>rb)).then((function(e){let{logCommunityCreate:t}=e;t()})),e}angular.module("bandlab.common").directive("impressionObserver",["$parse",function(e){return{restrict:"A",link:function(t,n,o){const r=e(o.impressionObserver)(t),{duration:i,threshold:a}=e(o.impressionObserverSettings)(t)||{duration:300,threshold:.5},s=LD(n[0],r,{duration:i,threshold:a});s.observe(n[0]),t.$on("$destroy",(function(){s.unobserve(n[0])}))}}}]).directive("engagementObserver",["$parse",function(e){return{restrict:"A",link:function(t,n,o){n.on("click",(function(n){(t.$parent.isBoosted||t.vm?.isBoosted)&&n.stopPropagation(),e(o.engagementObserver)(t)()}))}}}]),angular.module("bandlab.common").directive("icon",(function(){return{restrict:"E",template:function(e,t){return`<span style="display: contents;">${jD(0,t)}</span>`},replace:!0,link:DD}})).directive("iconSvg",(function(){return{restrict:"E",template:jD,replace:!0,link:DD}})),angular.module("bandlab.common").directive("infiniteScroll",["$q","$window",function(e,t){return{link:function(n,o,r){const i=100,a=n.$eval(r.infiniteScroll);let s;s="scrollableParent"in r?o[0].parentElement:"scrollableSelf"in r?o[0]:t;let l,c=e.resolve();if(!angular.isFunction(a))return;const u=new MutationObserver((function(){d()}));function d(){l||(requestAnimationFrame(p),l=!0)}function p(){let e;e="scrollableParent"in r||"scrollableSelf"in r?s.scrollHeight-(s.scrollTop+s.clientHeight):document.documentElement.scrollHeight-(document.documentElement.clientHeight+window.scrollY),(e<i&&1===c.$$state.status||0===e&&-1===c.$$state.status)&&!o[0].closest("main.no-scroll")&&(c=c.then((()=>a().catch(angular.noop).then((function(){s.dispatchEvent(new Event("scroll")),u.disconnect()}))))),l=!1}u.observe(o[0],{childList:!0}),s.addEventListener("scroll",d,{passive:!0}),n.$on("$destroy",(function(){s.removeEventListener("scroll",d,{passive:!0})}))}}}]),angular.module("bandlab.common").directive("input",(function(){return{require:["?ngModel"],restrict:"EA",priority:100,link:{pre:function(e,t,n,o){o[0]&&(t.on("focus",(function(){o[0].$focused=!0,e.$applyAsync()})),t.on("blur",(function(){o[0].$focused=!1,e.$applyAsync()})))}}}})),angular.module("bandlab.common").directive("inputNumber",(function(){return{require:"ngModel",link:function(e,t,n,o){t.on("keydown",(function(e){if("Enter"===e.code||"Space"===e.code||"Escape"===e.code)return t[0].blur();"Backspace"===e.code||"Delete"===e.code||/^\d$/.test(e.key)||/^Arrow/.test(e.key)||e.preventDefault()})),t.bind("blur",(function(){""===this.value||isNaN(this.value)?(this.value=parseInt(n.min),o.$setViewValue(this.value),o.$render()):(this.value=Math.min(this.value,n.max),this.value=Math.max(this.value,n.min))})),o.$parsers.push((function(e){return e=Math.max(e,n.min),Math.min(e,n.max)}))}}})),angular.module("bandlab.common").directive("inputNumberOptional",(function(){return{require:"ngModel",restrict:"A",link:function(e,t,n,o){o.$parsers.push((function(e){var t=e.replace(/\D/g,"");return t!==e&&(o.$setViewValue(t),o.$render()),t}))}}})),angular.module("bandlab.common").directive("like",["$analytics","$http","$rootScope","$state","appActions","Me",function(e,t,n,o,r,i){return{restrict:"E",require:"ngModel",link:function(a,s,l){var c;a.$on("like",(function(e,t){if(t.id===l.resourceId&&t.commentId===l.commentId){const e=a.$eval(l.ngModel);e.counters.likes=t.count,e.isLiked=t.isLiked,i.id===l.postCreatorId&&(e.isLikedByPostCreator=t.isLiked),e.revision&&(e.revision.isLiked=t.isLiked)}})),a.toggleLike=function(){if(!r.checkAllowed("like"))return;if(c&&0===c.$$state.status)return;const u=a.$eval(l.ngModel);var d=u.isLiked?"delete":"post",p=!u.isLiked,m=l.likeEntity,f=l.resourceId,h=l.commentId,g=i.id,v=p?u.counters.likes+1:u.counters.likes-1;c=t[d](`https://www.bandlab.com/api/v1.3/${m}s/${f}/${h?`comments/${h}/`:""}likes/users/${g}`).catch((function(){n.$broadcast("like",{creatorId:u.creator.id,count:p?v-1:v+1,id:f,isLiked:!p,commentId:h})})),n.$broadcast("like",{creatorId:u.creator.id,count:v,id:f,isLiked:p,commentId:h}),e.eventTrack(u.isLiked?"Like":"Unlike",{category:"Media",label:vg(m),entityId:f,entityCreatorId:u?.creator?.id,commentId:h,extra:{post_type:u.type?.toLowerCase()??u.post?.type?.toLowerCase()??(function(e){return"volume"in e}(u)?"revision":void 0),post_visibility:u.state?.toLowerCase()??u.post?.state.toLowerCase(),triggered_from:_p(o,s),trending_post_type:u.trendingPostType??u.post?.trendingPostType}}),p&&"album"===l.likeEntity&&(Promise.resolve().then((()=>fv)).then((e=>{let{logEvent:t}=e;return t("album_like",{album_id:l.resourceId})})),Promise.resolve().then((()=>Ap)).then((e=>{let{logEvent:t}=e;return t("album_like",{album_id:l.resourceId})})))}}}}]),angular.module("bandlab.common").directive("loaderInfiniteScroll",(function(){return{restrict:"E",replace:!0,templateNamespace:"svg",templateUrl:"https://www.bandlab.com/web-app/common/partials/_loader-no-content-c250aaf0.html"}})).directive("loaderNoContent",(function(){return{restrict:"E",replace:!0,templateNamespace:"svg",templateUrl:"https://www.bandlab.com/web-app/common/partials/_loader-no-content-c250aaf0.html"}})).directive("loaderWave",(function(){return{restrict:"E",replace:!0,template:'<div class="loader loader-wave"><div></div><div></div><div></div><div></div><div></div></div>'}})),angular.module("bandlab.common").directive("lockParentScroll",(function(){return{restrict:"A",link:function(e,t){t.on("wheel",(function(e){e.preventDefault(),t[0].scrollTop+=e.deltaY}))}}})),angular.module("bandlab.common").directive("match",(function(){return{require:"ngModel",restrict:"A",scope:{match:"="},link:function(e,t,n,o){e.$watch((function(){var t=o.$modelValue||o.$$invalidModelValue;return!t||e.match===t}),(function(e){o.$setValidity("match",e)}))}}})),angular.module("bandlab.common").directive("mobileStoreLink",["$analytics","$state",function(e,t){return{restrict:"A",scope:{eventAction:"@",eventLabel:"@"},link:function(n,o){if(!Yf&&!Jf)return o.remove();const r=encodeURIComponent(n.eventLabel.toLowerCase());function i(){e.eventTrack(n.eventAction||"External Link",{category:Yf?"Open Play Store":"Open App Store",label:n.eventLabel})}o[0].classList.contains("store-link")&&o[0].classList.add(Yf?"google-store":"apple-store"),o[0].setAttribute("rel","noopener"),o[0].setAttribute("target","noopener"),n.$watchGroup([()=>t.current.name,()=>window.location.href],(function(){o[0].setAttribute("href",function(){let e=null;const n="user.feed"===t.current.name?"user_page":t.current.name;"user_page"===n&&(e=MS(window.location.href));const o=`https://itunes.apple.com/app/apple-store/id968585775?pt=117214159&ct=promo_${n}&mt=8`,i="https://play.google.com/store/apps/details?"+["id=com.bandlab.bandlab",`referrer=${encodeURIComponent(`utm_campaign=mobille_web_promo&utm_source=${n}&utm_content=${r}`)}`].join("&");return e||(Yf?i:o)}())})),o[0].addEventListener("mousedown",i),n.$on("$destroy",(()=>{o[0].removeEventListener("mousedown",i)}))}}}]),angular.module("bandlab.common").directive("ngFile",["$parse","$timeout",function(e,t){return{restrict:"A",require:"?ngModel",link:function(n,o,r,i){var a=e(r.ngFile).assign;o.bind("change",(function(){const e=o[0].files?_.map(o[0].files,(e=>e)):[];e.length&&(n.$emit("$ngFile:fileChanged",e),n.$apply((function(){a(n,e),i&&i.$setViewValue(e)})),t((()=>{this.value=this.defaultValue})))}))}}}]),angular.module("bandlab.common").directive("ngOnload",(function(){return{restrict:"A",scope:{callback:"&ngOnload"},link:(e,t)=>{t.on("load",(t=>{e.$applyAsync((function(){e.callback({$event:t})}))}))}}})),angular.module("bandlab.common").directive("photoCropper",(function(){return{replace:!0,restrict:"E",template:'<div class="photo-cropper"><div class="photo-cropper-handle"></div></div>',link:function(e,t,n){var o,r,i,a=t.parent();function s(){var a,s;1===e.ratio?r<i?s=(a=Math.min(r,Math.ceil(t[0].getBoundingClientRect().height*o)))*e.ratio:a=(s=Math.min(i,Math.ceil(t[0].getBoundingClientRect().width*o)))*e.ratio:(a=Math.min(r,Math.ceil(t[0].getBoundingClientRect().height*o)),s=Math.min(i,Math.ceil(t[0].getBoundingClientRect().width*o))),e.$emit("photoCropperInfo",{src:n.photoSrc,x:Math.max(0,parseInt(parseInt(getComputedStyle(t[0]).left)*o)),y:Math.max(0,parseInt(parseInt(getComputedStyle(t[0]).top)*o)),height:a,width:s,zoom:o})}function l(e){return e.touches?e.touches[0]:e}n.$observe("photoSrc",(function(l){if(l){var c=new Image;c.src=l,c.onload=function(){r=c.height,i=c.width,function(){var l,c,u,d,p,m,f=Math.min(a[0].getBoundingClientRect().width,i),h=r*f/i;e.ratio=parseFloat(n.ratio),isNaN(e.ratio)&&(e.ratio=null),o=i/f,c=(l=(e.minWidth||n.minWidth)/o)/e.ratio,e.ratio<f/h?(d=h,u=h*e.ratio):e.ratio>f/h?(u=f,d=f/e.ratio):(d=Math.min(f,h),u=Math.min(f,h)),p=(f-u)/2,m=(h-d)/2,t.css("min-height",`${c}px`),t.css("min-width",`${l}px`),t.css("left",`${p}px`),t.css("top",`${m}px`),t.css("height",`${d}px`),t.css("width",`${u}px`);const g=i!==e.minWidth||r!==Math.round(e.minWidth/e.ratio);t.css("visibility",g?"":"hidden"),s()}()}}})),function(){var e,n,o,r,i,c,u,d;function p(a){const{screenX:s,screenY:p}=l(a),m=Math.min(i,Math.max(s-n,c)),f=Math.min(u,Math.max(p-e,d));t.css("left",`${o+m}px`),t.css("top",`${r+f}px`),a.preventDefault()}function m(){t.removeClass("moving"),angular.element(window).off("mousemove touchmove",p),angular.element(window).off("mouseup touchend",m),s(),jL()}t.on("mousedown touchstart",(function(s){s.stopPropagation(),function(s){DL(),t.addClass("moving");const f=a[0].getBoundingClientRect(),h=t[0].getBoundingClientRect();c=f.left-h.left,i=f.right-h.right,u=f.bottom-h.bottom,d=f.top-h.top,o=h.left-f.left,r=h.top-f.top,({screenX:n,screenY:e}=l(s)),angular.element(window).on("mousemove touchmove",p),angular.element(window).on("mouseup touchend",m)}(s)}))}(),function(){var n,o,r,i,c,u,d,p;function m(a){a.preventDefault();const{screenX:s,screenY:m}=l(a),f=s-n,h=i+(m-o),g=e.ratio?h*e.ratio:r+f;t.css("width",`${Math.max(p,Math.min(g,u))}px`),t.css("height",`${Math.max(d,Math.min(h,c))}px`)}function f(){t.removeClass("resizing"),angular.element(window).off("mousemove touchmove",m),angular.element(window).off("mouseup touchend",f),s(),jL()}angular.element(t[0].querySelector(".photo-cropper-handle")).on("mousedown touchstart",(function(s){s.stopPropagation(),function(s){DL(),({screenX:n,screenY:o}=l(s)),p=parseInt(t.css("min-width")),d=parseInt(t.css("min-height"));const h=a[0].getBoundingClientRect();c=h.height-parseInt(t.css("top")),u=h.width-parseInt(t.css("left")),1===e.ratio?(c=Math.min(c,u),u=Math.min(c,u)):(c=Math.min(c,u/e.ratio),u=Math.min(u,c*e.ratio)),t.addClass("resizing"),t.css("max-height",`${c}px`),t.css("max-width",`${u}px`);const g=t[0].getBoundingClientRect();r=g.width,i=g.height,angular.element(window).on("mousemove touchmove",m),angular.element(window).on("mouseup touchend",f)}(s)}))}()}}})),angular.module("bandlab.common").directive("pictureModal",["Modal",function(e){return{restrict:"A",scope:{picture:"=pictureModal"},link:function(t,n){n.on("click",(function(){new e({template:`<div><img src="${t.picture}" alt="" width="600"></div>`}).show()}))}}}]),angular.module("bandlab.common").directive("pictureUpload",["$injector","$rootScope","authService","FileHelper","Identity","Me",function(e,t,n,o,r,i){let a;return{restrict:"C",controller:["$scope",function(e){e.maxHeight=6e3,e.maxWidth=6e3,e.maxImageSize=10}],link:function(s,l,c){var u=window.File&&window.FileReader&&window.FileList&&window.Blob,d=angular.element(l[0].querySelector(".picture-upload-drop-area")),p=l[0].querySelector(".picture-upload-file-input");function m(e){let{rotate:t=0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s.isLoading=!0,s.error="",Nh(e).then((function(e){return Dh(e,s.maxImageSize)})).then((function(e){return Mh(e,{minWidth:s.minWidth,minHeight:s.minHeight,maxWidth:s.maxWidth,maxHeight:s.maxHeight,rotate:t%360})})).then((function(e){s.setImageSrc(e.image.src),a=e.file})).catch((function(e){s.error=e.message})).finally((function(){s.isLoading=!1,s.$applyAsync()}))}s.ratio=isNaN(c.ratio)?1:parseFloat(c.ratio),s.uploadButton=!1!==s.$eval(c.uploadButton),s.minWidth=isNaN(c.minWidth)?120:parseInt(c.minWidth),s.minHeight=s.minWidth&&s.ratio?Math.ceil(s.minWidth/s.ratio):120,s.selectFile=function(){setTimeout((function(){p.click()}),0)},s.rotateImage=function(e){m(a,{rotate:e})},s.removePicture=function(){p.value="",s.imageSrc=""},s.setImageSrc=function(e){s.imageSrc=e},s.setFile=function(e){a=e},s.getDropDimensions=function(){return 140*s.ratio>320?{height:320/s.ratio+"px",width:"320px"}:140*s.ratio<140?{height:""+140/s.ratio,width:"140px"}:{height:"140px",width:140*s.ratio+"px"}},s.$on("photoCropperInfo",(function(e,t){t.src===s.imageSrc&&(s.cropOps=t)})),s.$on("$ngFile:fileChanged",(function(e,t){m(t[0])})),s.uploadImage=function(){var l=`https://storage.bandlab.com/v1.3/images/${c.entity}`;s.isLoading=!0,o.upload(a,l,{params:{x:s.cropOps.x,y:s.cropOps.y,width:s.cropOps.width,height:s.cropOps.height}}).then((function(o){let{data:a}=o;return c.entity&&c.id?function(o,a){const s={id:o.id,pictureId:a.id};switch(o.entity){case"bands":case"classrooms":return e.get("Band").update(s).$promise.then((function(e){return t.$broadcast("$band:changed",{action:"picture",data:e})}));case"bandBackgrounds":return e.get("Band").update({id:o.id,backgroundPictureId:a.id,backgroundPictureColor:a.color}).$promise.then((function(e){return vv({bandId:o.id}),t.$broadcast("$band:changed",{action:"backgroundPicture",data:e})}));case"users":{const n=e.get("User");return"replace"===o.action?n.replaceProfilePicture({userId:s.id,pictureId:o.picture},{newPictureId:s.pictureId}).$promise.then((()=>{Zv(o.triggeredFrom,o.numPictures),t.$broadcast("$user:changed",{action:"profilePicture",data:s})})):n.postProfilePicture({userId:s.id},{pictureId:s.pictureId}).$promise.then((()=>{Zv(o.triggeredFrom,o.numPictures),t.$broadcast("$user:changed",{action:"profilePicture",data:s})}))}case"userBackgrounds":return new r({backgroundPictureId:a.id}).$update().then((function(e){return Jv(),n.setMe(e),t.$broadcast("$user:changed",{action:"backgroundPicture",data:i}),i}));case"songs":return e.get("Song").update(s).$promise.then((function(e){return t.$broadcast("$song:changed",{action:"picture",data:e})}))}switch(o.entity){case"communities":return e.get("Community").update(s).$promise.then((function(e){return t.$broadcast("$community:changed",{action:"picture",data:e})}));case"collections":return e.get("Collection").update(s).$promise;case"albums":return e.get("Album").picture(s).$promise.then((function(e){t.$broadcast("$albumPicture:changed",{data:e})}));case"themes":{const n=e.get("Album"),r=JSON.parse(o.albumTheme);return r.images[o.albumProperty]=a.url,"header"===o.albumProperty&&(r.isHeaderHidden=!1),n.updateTheme({id:o.id,...r}).$promise.then((function(){t.$broadcast("$albumPicture:changed",{data:{picture:a,property:o.albumProperty}})}))}case"tracks":return e.get("Album").pictureTrack(s).$promise.then((function(e){t.$broadcast("$trackPicture:changed",{data:e})}));case"distroReleases":return e.get("Release").picture({userId:i.id,releaseId:s.id,pictureId:s.pictureId}).$promise.then((function(){t.$broadcast("$releasePicture:changed",{data:a})}))}}(c,a):Promise.resolve()})).then((function(){s.removePicture(),t.$broadcast("pictureUploadSuccess","close")})).finally((function(){s.isLoading=!1}))},u&&(d.on("dragenter",(function(e){e.preventDefault(),e.stopPropagation(),d.addClass("drag-over")})),d.on("dragleave",(function(e){e.preventDefault(),e.stopPropagation(),d.removeClass("drag-over")})),d.on("dragover",(function(e){e.stopPropagation(),e.preventDefault(),d.addClass("drag-over")})),d.on("drop",(function(e){const t=_.get(e,"dataTransfer.files",[]);if(e.preventDefault(),e.stopPropagation(),d.removeClass("drag-over"),t.length)return m(t[0])}))),s.file&&m(s.file)},templateUrl:"https://www.bandlab.com/web-app/common/partials/_picture-upload-0d89d37b.html"}}]),angular.module("bandlab.common").directive("profilePopover",["$animate","$compile","$injector","$q","$rootScope","$templateRequest","$timeout",function(e,t,n,o,r,i,a){return{restrict:"A",scope:{profilePopoverData:"<",profilePopoverType:"@",profilePopoverCssClass:"@",profilePopoverTriggeredFrom:"@"},link:function(s,l,c){if(!Zf&&s.profilePopoverType&&!l[0].closest(".popover")){var u,d,p,m,f,h,g=s.profilePopoverType,v=function(e){switch(e){case"Band":return'<band-profile-popover band="::band"></band-profile-popover>';case"Song":return'<project-profile-popover song="::song"></project-profile-popover>';case"User":return'<user-profile-popover user="::user" triggered-from="::triggeredFrom"></user-profile-popover>';case"Comment":return'<comment-popover comment="::comment.comment" revision="::comment.revision"></comment-popover>';default:return}}(g),b=angular.noop,y=ay(M,400),w=ad();s.$on("$destroy",P),s.$on("$popover:destroy",P),d=ay((function(e){p=!1,y.cancel(),"Comment"!==g?Promise.all([k(),S(g)]).then((function(e){let[t]=e;p||$(0,t)})):$(0,s.profilePopoverData)}),400,"Comment"===g?{leading:!0,trailing:!1}:null),l.on("mouseover",d),l.on("mouseleave",_)}function $(n,o){var i;(u=document.getElementById(w))&&u.remove(),(m=r.$new())[g.toLowerCase()]=o,m.triggeredFrom=s.profilePopoverTriggeredFrom,u=angular.element(`<div class="popover popover-${g.toLowerCase()} ${s.profilePopoverCssClass||""} animate" id="${w}"><div class="popover-placeholder"></div>${v}</div>`),t(u)(m),u.on("mouseleave",_),u.on("mouseover",(function(){y.cancel()})),window.addEventListener("scroll",P),i=function(){if(!u)return;angular.element(document.body).append(u),m.$digest();const t=u[0].querySelector(".popover-content"),n=l[0].getBoundingClientRect(),o=-t.offsetHeight+n.top,r=t.offsetWidth+n.right;o>0?(u[0].classList.add("above"),u[0].style.top=n.top-t.scrollHeight+"px"):(u[0].classList.add("below"),u[0].style.top=`${n.bottom}px`),r>window.innerWidth?(u[0].classList.add("rtl"),u[0].style.left=n.right-t.scrollWidth+12+"px"):(u[0].classList.add("ltr"),u[0].style.left=n.left-12+"px"),e.enter(u,document.body,document.body.lastChild)},setTimeout((function(){setTimeout((function(){setTimeout((function(){a(i)}),0)}),0)}),0)}function k(){if(!h||f!==c.profilePopoverId){if(!c.profilePopoverId){const e=new Error("Missing ID in getResource()");Sentry.onLoad((function(){Sentry.captureException(e)}))}var e=n.get(g).get({id:c.profilePopoverId}).$promise;return e.then((function(e){f=c.profilePopoverId,h=e,"User"===g&&(b(),b=s.$on("$user:relationChanged",(function(e,t){t.user.id===c.profilePopoverId&&(h=null,b())})))})),e}return o.resolve(h)}function S(e){switch(e){case"Song":return i("https://www.bandlab.com/web-app/project/partials/_project-tile-50246f5b.html");case"User":return i("https://www.bandlab.com/web-app/user/partials/_user-tile-1ef2d0a9.html");case"Comment":return i("https://www.bandlab.com/web-app/comment/partials/_comment-c3a438ee.html");default:return Promise.resolve()}}function _(){d.cancel(),p=!0,y()}function P(){d.cancel(),p=!0,M()}function M(){window.removeEventListener("scroll",P),u&&(e.leave(u).then((function(){m.$destroy()})),u=null,m.$applyAsync())}}}}]),angular.module("bandlab.common").directive("progress",(function(){return{link:function(e,t,n){var o,r,i=e.$eval(n.progressOnStart),a=e.$eval(n.progressOnShiftMove),s=e.$eval(n.progressOnMove),l=e.$eval(n.progressOnEnd),c="vertical"!==n.progress,u={},d=[];function p(n){const r=t[0].getBoundingClientRect();u={left:r.left,width:r.width,top:r.top,height:r.height},angular.isFunction(i)&&(c?(o=d[0]-u.left,i(o/u.width,o,n)):(o=d[1]-u.top,i(1-o/u.height,o,n)),e.$applyAsync())}function m(t,n){angular.isFunction(s)&&(c?(o=Math.max(t-u.left,0),o=Math.min(o,u.width),s(o/u.width,o,d[1]-n,d[0]-t,t)):(o=Math.max(n-u.top,0),o=Math.min(o,u.height),s(1-o/u.height,d[1]-n)),e.$applyAsync())}function f(){angular.isFunction(l)&&(c?(o=Math.max(d[0]-u.left,0),o=Math.min(o,u.width),l(o/u.width,o)):l(1-o/u.height),e.$applyAsync()),d=[]}function h(t){t.preventDefault(),t.shiftKey!==d[2]&&a&&(u.left=u.left+(t.clientX-d[0]),u.top=u.top+(t.clientY-d[1]),d=[t.clientX,t.clientY,t.shiftKey]),t.shiftKey&&a?function(t,n){angular.isFunction(a)&&(a(c?t-u.left:n-u.top),e.$applyAsync())}(t.clientX,t.clientY):m(t.clientX,t.clientY)}function g(e){c&&Math.abs(e.touches[0].clientY-d[1])>22||(r>10&&e.preventDefault(),r++,m(e.touches[0].clientX,e.touches[0].clientY))}function v(e){e.stopPropagation(),document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",v,!0),f()}function b(){document.removeEventListener("touchmove",g),document.removeEventListener("touchend",b),f()}t[0].addEventListener("mousedown",(function(e){1===e.which&&(d=[e.clientX,e.clientY,e.shiftKey],p(e),document.addEventListener("mousemove",h,!1),document.addEventListener("mouseup",v,!0))}),!1),t[0].addEventListener("touchstart",(function(e){0!==e.which||e.touches.length>1||(r=0,d=[e.touches[0].clientX,e.touches[0].clientY],p(e),document.addEventListener("touchmove",g,{passive:!1}),document.addEventListener("touchend",b,!1),document.addEventListener("touchcancel",b,!1))}),!1)}}})),angular.module("bandlab.common").directive("richText",["$analytics","$state","appActions","Player",function(e,t,n,o){return{scope:{richText:"=",revision:"=",ignoreUrls:"<"},link:function(r,i,a){function s(e){return oj(e).map((function(e){const n=function(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}(e.value);return"url"in e&&!r.ignoreUrls?`<a href=${e.url} rel="noopener" target="_target">${n}</a>`:"username"in e?`<a href="${t.href("user.feed",{username:e.username})}">${n}</a>`:"hashtag"in e?`<a hashtag href="${t.href("search.results",{q:e.hashtag,filter:"posts",reveal:null})}">${n}</a>`:"timestamp"in e&&r.revision&&r.revision.id?`<time>${n}</time>`:n})).join("")}i.append(s(r.richText)),i.on("click",(function(t){if("TIME"===t.target.nodeName){var i=t.target.innerHTML.split(":"),a=60*i[0],s=parseInt(a,10)+parseInt(i[1],10);o.goToTimeAndPlay(r.revision,s),e.eventTrack("Time Marker Click",{category:"Revision",label:r.richText===r.revision.description?"Description Link":"Comment Body Link"})}else t.target.closest("[hashtag]")&&!n.checkAllowed("search")&&t.preventDefault()})),":"===a.richText.charAt(0)&&":"===a.richText.charAt(1)||r.$watch("richText",(function(){i.empty(),i.append(s(r.richText))}))}}}]),angular.module("bandlab.common").directive("scrollDivider",(function(){return{restrict:"A",link:function(e,t){const n=document.createElement("div");n.className="scroll-top-child";const o=document.createElement("div");o.className="scroll-bottom-child";const r=t[0];r.appendChild(n),r.appendChild(o);const i=new IntersectionObserver((function(e){r.classList.toggle("scroll-divider-top",!e[0].isIntersecting)}),{threshold:1}),a=new IntersectionObserver((function(e){r.classList.toggle("scroll-divider-bottom",!e[0].isIntersecting)}),{threshold:1});i.observe(n),a.observe(o),e.$on("$destroy",(function(){i.unobserve(n),a.unobserve(o)}))}}})),angular.module("bandlab.common").directive("scrollingTabNav",(function(){return{restrict:"A",transclude:!0,templateUrl:"https://www.bandlab.com/web-app/common/partials/_scrolling-tab-nav-a63b2e5e.html",link:function(e,t,n){const o=t[0],r=t[0].children[0],i=r.children,a=t[0].children[1],s=t[0].children[2];e.scrollingTabNavClass=n.scrollingTabNavClass??"tab-nav tab-nav-pill-for-small";let l=!1;e.$watch((()=>o.clientWidth),(function(){s.style.right=getComputedStyle(o).paddingRight}));const c={root:o,rootMargin:"0px",threshold:function(){const e=[];for(let t=0;t<=10;t++)e.push(t/10);return e}()},u=new Map,d=new IntersectionObserver((function(e){for(const t of e)u.get(t.target).intersectionRatio=t.intersectionRatio;1===u.get(i[0]).intersectionRatio?a.classList.remove("is-visible"):a.classList.add("is-visible"),u.get(i[i.length-1]).intersectionRatio>.9?s.classList.remove("is-visible"):s.classList.add("is-visible")}),c);function p(){u.get(this).intersectionRatio<1&&m(this)}function m(e){let t=e.offsetLeft-parseInt(getComputedStyle(o).paddingLeft);l?l=!1:t-=parseInt(getComputedStyle(a).width),r.scrollTo({left:t,behavior:"smooth"})}e.scrollLeft=function(){let e=-1,t=-1;for(const n of u.values()){if(e+=1,0===n.intersectionRatio&&t>0){e-=1;break}if(1===n.intersectionRatio)break;t=n.intersectionRatio}1===e&&(l=!0),m(i[e-1])},e.scrollRight=function(){let e=-1,t=-1;for(const n of u.values()){if(e+=1,0===n.intersectionRatio&&t>0){e-=1;break}if(1===n.intersectionRatio)break;t=n.intersectionRatio}m(i[e+1])},e.$watch((()=>i.length),(()=>{u.clear(),d.disconnect();for(const e of i)u.set(e,{intersectionRatio:-1}),d.observe(e),e.removeEventListener("click",p),e.addEventListener("click",p),e.classList.contains("active")&&m(e)}))}}})),angular.module("bandlab.common").directive("scrollSmoothly",(function(){return{link:function(e,t){t.on("click",(function(e){document.querySelector(e.currentTarget.getAttribute("href")).scrollIntoView({block:"center",behavior:"smooth"}),e.preventDefault()}))}}})),angular.module("bandlab.common").directive("sideNav",["$compile","$state","$transitions","$window",function(e,t,n,o){return{restrict:"C",link:function(r,i,a){if(""===a.noMobileSideNav)return;const s=n.onFinish({},(function(e){c.sideNavItemUrl=t.href(e.to(),e.params()),c.$applyAsync()}));let l,c;function u(e){const t=i[0].querySelector(`.side-nav-item[href="${e}"]`);t&&t.click(),setTimeout((()=>{d()}),200)}function d(){c.options=_.map(i[0].querySelectorAll(".side-nav-item"),(e=>({value:e.getAttribute("href"),label:e.innerText})))}setTimeout((function(){l&&l.length&&(c.$destroy(),l.remove()),c=r.$new(!0),c.followLink=u,c.sideNavItemUrl=o.location.pathname+o.location.search,d(),l=angular.element('<div class="side-nav-select">\n              <div class="select select-height-40">\n                <select ng-model="sideNavItemUrl" ng-change="followLink(sideNavItemUrl)">\n                  <option\n                    ng-repeat="opt in options"\n                    ng-disabled="!opt.value"\n                    value="{{opt.value}}">\n                    {{opt.label}}\n                  </option>\n                </select>\n              </div>\n            </div>'),i.parent().append(l),e(l)(c),c.$on("$destroy",(function(){s()}))}),100)}}}]),angular.module("bandlab.common").directive("slugify",(function(){return{require:"ngModel",restrict:"A",link:function(e,t,n,o){o.$parsers.push((function(e){var t=e.replace(/[^a-z0-9]+/gi,"-");return t!==e&&(o.$setViewValue(t),o.$render()),t}))}}})),angular.module("bandlab.common").component("stepsForm",{bindings:{steps:"=",stepNumber:"=",goToStep:"&",errors:"=",submitButtonDisabled:"=",isSubmitting:"=",disableNavigation:"=",hasValidationError:"=",pendingValidation:"="},transclude:{trialBanner:"?stepsFormTrialBanner",stepsContent:"?stepsFormStepContent"},templateUrl:"https://www.bandlab.com/web-app/common/partials/_steps-form-e8916f45.html",controller:["$scope",function(e){const t=this;function n(){t.stepNumber&&t.stepNumber>0?e.currentStep=t.steps[t.stepNumber-1]:e.currentStep=t.steps[0]}t.$onInit=n,e.$watch("vm.stepNumber",(function(){n()})),e.back=function(){t.goToStep()(t.stepNumber-1)},e.next=function(){t.goToStep()(t.stepNumber+1)},e.navigateTo=function(e){t.goToStep()(e)}}],controllerAs:"vm"}),angular.module("bandlab.common").directive("switch",(function(){return{restrict:"E",replace:!0,require:"ngModel",scope:{label:"@",switchOff:"<",switchOn:"<",switchDisabled:"<"},template:'\n        <span class="switch-container" ng-click="toggle()" ng-disabled="switchDisabled">\n          <div class="switch {{ isChecked ? \'on\' : \'\' }}">\n            <input type="checkbox" class="visually-hidden" ng-model="isChecked" ng-disabled="switchDisabled">\n          </div>\n          <span class="switch-label">{{ ::label }}</span>\n        </span>\n      ',link:function(e,t,n,o){o.$formatters.unshift((function(t){return t===e.switchOn?e.isChecked=!0:t===e.switchOff?e.isChecked=!1:e.isChecked=!0===t,t})),e.toggle=function(){n.disabled||(e.isChecked=!e.isChecked,e.isChecked&&e.switchOn?o.$setViewValue(e.switchOn):!e.isChecked&&e.switchOff?o.$setViewValue(e.switchOff):o.$setViewValue(e.isChecked))}}}})),angular.module("bandlab.common").directive("tooltip",["$injector",function(e){return{restrict:"E",transclude:{tooltipTrigger:"tooltipTrigger",tooltipContent:"tooltipContent"},scope:{isLabel:"=",shouldOpen:"=",open:"<",initiallyOpened:"=",shouldCloseOnClick:"=",tooltipId:"@",tooltipClass:"=",placement:"@",teleported:"=",teleportedTo:"="},link:function(t,n,o,r,i){n.attr("style","display: contents;"),t.tooltipContent=i((()=>{}),null,"tooltipContent")[0],t.tooltipTrigger=i((()=>{}),null,"tooltipTrigger").children()[0];const a=Mt({isLabel:t.isLabel,shouldOpen:t.shouldOpen,open:t.open,initiallyOpened:t.initiallyOpened,shouldCloseOnClick:t.shouldCloseOnClick,tooltipId:t.tooltipId,tooltipClass:t.tooltipClass,placement:t.placement,teleported:t.teleported,teleportedTo:t.teleportedTo,tooltipContent:t.tooltipContent,tooltipTrigger:t.tooltipTrigger}),s=import("./chunk-f8e33d05.js").then((function(t){let{mountTooltipAngularJS:o}=t;return o(n[0],{$injector:e},a)}));t.$on("$destroy",(async function(){(await s).unmount()})),Lr(a,(function(e){t.open=e.open})),t.$watch((function(e){a.isLabel=e.isLabel,a.shouldOpen=e.shouldOpen,a.open=e.open,a.initiallyOpened=e.initiallyOpened,a.shouldCloseOnClick=e.shouldCloseOnClick,a.tooltipId=e.tooltipId,a.tooltipClass=e.tooltipClass,a.placement=e.placement,a.teleported=e.teleported,a.teleportedTo=e.teleportedTo}))}}}]),angular.module("bandlab.common").directive("checkbox",(function(){return{restrict:"E",replace:!0,require:"ngModel",scope:{label:"@",isDisabled:"=?",isPartial:"=?",value:"=ngModel"},transclude:!0,template:'\n        <div class="checkbox-container">\n          <input type="checkbox" class="visually-hidden checkbox-input" ng-model="value" ng-disabled="isDisabled" tabindex="-1" aria-hidden="true">\n          <button ng-attr-id="{{ ::checkboxId }}" type="button" ng-click="toggle()" role="checkbox" class="checkbox-box" ng-attr-aria-checked="{{ value }}" ng-disabled="isDisabled">\n            <svg ng-if="isPartial && value" width="16" height="16" fill="currentColor" class="checkbox-box-svg">\n              <path d="M12.7 8.7V7.3H3.3v1.4h9.4Z"/>\n            </svg>\n            <svg ng-if="!isPartial && value" width="16" height="16" fill="currentColor" class="checkbox-box-svg">\n              <path fill-rule="evenodd" d="m11.8 6.5-3.9 3.9c-.3.3-.8.3-1.1 0L4.2 7.8l1-1 2.1 2.3L11 5.5l.9 1Z" clip-rule="evenodd"/>\n            </svg>\n          </button>\n          <label ng-attr-for="{{ ::checkboxId }}" class="checkbox-label">\n            <ng-transclude>{{ ::label }}</ng-transclude>\n          </label>\n        </div>\n      ',link:function(e,t,n,o){e.checkboxId=ad(),e.toggle=function(){e.isDisabled||(o.$setViewValue(!e.value),o.$processModelValue())}}}})),angular.module("bandlab.common").component("textTruncate",{bindings:{maxCharacters:"<",maxWords:"<",maxLines:"<",zeroCaseText:"@",text:"<",isHtml:"<"},transclude:!0,templateUrl:"https://www.bandlab.com/web-app/common/partials/_text-truncate-08b1cafc.html",controllerAs:"vm",controller:["$filter",function(e){const t=this;function n(){t.truncatedText=e("textTruncate")({content:t.text},t.maxCharacters,t.maxWords,t.maxLines)}t.truncatedText="",t.isTruncated=!0,t.$onInit=n,t.$onChanges=n}]}),angular.module("bandlab.common").directive("fieldErrorUsername",(function(){return{restrict:"E",scope:{form:"="},replace:!0,templateUrl:"https://www.bandlab.com/web-app/common/partials/_field-error-username-eca73c92.html"}})),angular.module("bandlab.common").directive("usernamize",(function(){return{require:"ngModel",restrict:"A",link:function(e,t,n,o){o.$parsers.push((function(e){var t=e.replace(/[^a-z0-9]+/gi,"_").toLowerCase();return t!==e&&(o.$setViewValue(t),o.$render()),t}))}}})),angular.module("bandlab.common").directive("viewOverlay",["$state","$window",function(e,t){return{restrict:"C",link:function(n,o){function r(t){-1!==["INPUT","TEXTAREA"].indexOf(t.target.nodeName)&&"file"!==t.target.type||e.current.name.includes(".tree")||o.hasClass("is-active")&&27===t.keyCode&&e.go("^")}n.closeOverlay=function(t){(t.target.classList.contains("view-overlay")||t.target.classList.contains("close-button"))&&o[0].classList.contains("is-active")&&e.go("^")},t.addEventListener("keyup",r),n.$on("$destroy",(function(){t.removeEventListener("keyup",r)}))}}}]),angular.module("bandlab.common").filter("bigNumber",(function(){return LA})),angular.module("bandlab.common").filter("domainName",(function(){return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{return new URL(e).hostname.replace(/^www\./,"")}catch(t){return e}}})),angular.module("bandlab.common").filter("fullDate",(function(){return Ac((function(e,t){if(e)return FA(e,t)}))})).filter("mediumDate",(function(){return Ac((function(e){if(e)return BA(e)}))})).filter("dateOnly",(function(){return Ac(UA)})).filter("dateWithYear",(function(){return Ac((function(e,t){if(e)return VA(e,t)}))})).filter("monthDate",(function(){return Ac((function(e){if(e)return qA(e)}))})).filter("timeOnly",(function(){return Ac(HA)})).filter("timeAgo",(function(){return Ac(NA,(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return JSON.stringify(t)}))})),angular.module("bandlab.common").filter("localizeRole",(function(){return function(e){return{Admin:"Admin",Owner:"Owner",Member:"Member",Collaborator:"Collaborator"}[e]}})),angular.module("bandlab.common").filter("location",(function(){return function(e){return GA(e)}})),angular.module("bandlab.common").filter("masteringName",(function(){return pu})),angular.module("bandlab.common").directive("ngPluralizeHtml",["$interpolate","$locale",function(e,t){var n=/{}/g,o=/^when(Minus)?(.+)$/;return{restrict:"EA",link:function(r,i,a){var s,l=a.count,c=a.$attr.when&&i.attr(a.$attr.when),u=a.offset||0,d=r.$eval(c)||{},p={},m=e.startSymbol(),f=e.endSymbol(),h=`${m}${l}-${u}${f}`,g=angular.noop;function v(e){i.html(e||"")}angular.forEach(a,(function(e,t){const n=o.exec(t);if(n){const e=`${n[1]?"-":""}${n[2].toLowerCase()}`;d[e]=i.attr(a.$attr[t])}})),angular.forEach(d,(function(t,o){p[o]=e(t.replace(n,h))})),r.$watch(l,(function(e){let n=parseFloat(e);const o=isNaN(n);if(o||n in d||(n=t.pluralCat(n-u)),!(n===s||o&&isNaN(s))){g();const e=p[n];angular.isUndefined(e)?(g=angular.noop,v()):g=r.$watch(e,v),s=n}}))}}}]),angular.module("bandlab.common").filter("textTruncate",["$state",function(e){return function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4,i=20,a=5*i;e.includes("post")&&(n=1e3,o=200,r*=2,i*=2,a*=2),e.includes("fanReachFanCollector")&&(i=0,a=0);const s=t.content||"";let l=s.split("\n"),c=s.split(" ");if(c.length<=o+i&&l.length<=r&&s.length<=n+a&&(t.truncate=!1,t.isFullyVisible=!0),!1===t.truncate)return s;t.truncate=!0,c=c.slice(0,o),l=c.join(" ").split("\n"),l=l.slice(0,r);const u=!!Intl.Segmenter,d=u?function(e,t){return[...(new Intl.Segmenter).segment(e)].map((e=>{let{segment:t}=e;return t})).slice(0,t).join("")}(l.join("\n"),n):l.join("\n").substring(0,n).trim(),p=u?d:d.replace(/[\uD800-\uDBFF]([^\uD800-\uDBFF]*)$/,"");return`${p}${p.endsWith(".")?"..":"..."}`}}]).filter("filenameTruncate",(function(){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;const n=e||"",o=n.lastIndexOf("."),r=n.slice(o-4);return n.length>t?`${n.slice(0,t-r.length)}...${r}`:n}})),VD.$inject=["Modal"],WD.$inject=["Modal"],BD.$inject=["Modal"],FD.$inject=["$animate","$compile","$q","$rootScope","$templateRequest","$timeout","$transitions"],qD.$inject=["$injector","$transitions"],UD.$inject=["$rootScope"],ND.$inject=["$rootScope"],angular.module("bandlab.common").directive("zfClose",ND).directive("zfModal",UD).directive("modalGroup",qD).factory("Modal",FD).factory("ConfirmModal",BD).factory("MessageModal",WD).factory("ChatRetryModal",VD),function(e){var t;(t=window.angular.module("angular-bind-html-compile",[])).directive("bindHtmlCompile",["$compile",function(e){return{restrict:"A",link:function(t,n,o){t.$watch((function(){return t.$eval(o.bindHtmlCompile)}),(function(r){n.html(r&&r.toString());var i=t;o.bindHtmlScope&&(i=t.$eval(o.bindHtmlScope)),e(n.contents())(i)}))}}}]),e.exports&&(e.exports=t.name)}({exports:{}}),GD.$inject=["$compile","$rootScope"],HD.$inject=["$sce","$timeout"],zD.$inject=["$rootScope"],angular.module("bandlab.common.notification",["angular-bind-html-compile"]).directive("zfNotificationSet",zD).directive("zfNotification",HD).factory("NotificationFactory",GD).factory("AppNotifications",["NotificationFactory",function(e){return new e({})}]).directive("privacyBanner",(function(){return{restrict:"E",template:'<div style="display: contents;"></div>',link:function(e,t){Promise.resolve().then((()=>yp)).then((function(e){let{setupPrivacyConsent:n}=e;return n(t[0])})).then((function(){t.remove()}))}}})),angular.module("bandlab.common").factory("appActions",["$state","authService","Me",function(e,t,n){const o=["addToCollection","bandJoinRequest","bandRequestInvite","blockUser","boost","checkout","comment","favoriteSounds","follow","fork","joinCommunity","like","getMembership","reportContent","search","shareOnBandLab","startStream","submitToOpportunity","talkTo","tip","upload","download","useDistribution","useFanReach","useSongStarter","useSplitter","getReviews","getPromote","savePreset"],r={bandInvite:()=>n?.permissions?.canInvite,communityInvite:()=>n?.permissions?.canInvite,projectInvite:()=>n?.permissions?.canInvite,stream:()=>n?.isEmailConfirmed,talkTo:()=>n?.permissions?.canCreateConversations};return{checkAllowed:function(n){let{toState:i=e.current.name,toParams:a=e.params}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{title:s,description:l,onCancel:c,redirectState:u}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return-1===o.indexOf(n)||d()?!(r[n]&&!r[n]())||(t.displayConfirmationEmailError(n),!1):(t.setAfterAuthState({toState:i,toParams:a}),t.displayAuthModal({title:s,description:l,onCancel:c,redirectState:u}),!1)},checkStateCompatibility:function(e){if(angular.isFunction(e.isCompatible))return e.isCompatible()}}}]),angular.module("bandlab.common").factory("FileHelper",["$http","$rootScope",function(e,t){return{upload:function(n,o,r){var i=new FormData,a=angular.extend({transformRequest:angular.identity,headers:{"Content-Type":void 0}},r);return Array.isArray(n)?_.forEach(n,(function(e){i.append("file",e)})):i.append("file",n),e.post(o,i,a).then((function(e){return t.$broadcast("$file:uploadSuccess",e.data),e})).catch((function(e){throw t.$broadcast("$file:uploadFailed"),e}))}}}]),angular.module("bandlab.common").factory("Loader",["$q",function(e){return{create:function(t,n){let o=0,r=null,i=e.resolve([]),a=!1;function s(){return i=i.then((()=>{if(a)return e.resolve([]);const i=Object.assign({},n,r&&{after:r}||o&&{offset:o}||{});return t(i).$promise.then((e=>{const t=e.paging,i=e.data||e;return(n.limit&&i.length<n.limit||!i.length)&&(a=!0),t?r=t.cursors.after:o+=e.length,i}))})),i}const l=[];let c=-1;return{get:function(){return c++,l[c]||(l[c]=s()),l[c+1]||(l[c+1]=s()),l[c]},incOffset:function(){o++},decOffset:function(){o--}}}}}]),angular.module("bandlab.common").factory("Page",["$state","$stateParams","$transitions","Me",function(e,t,n,o){const r=document.createElement("meta");r.name="twitter:player";const i=document.createElement("meta");i.name="twitter:player:width",i.content="480";const a=document.createElement("meta");a.name="twitter:player:height",a.content="202";const s={metadata:{},slug:"loading"},l={title:document.title,description:document.querySelector('meta[name="description"]').getAttribute("content"),image:document.querySelector('meta[property="og:image"]').getAttribute("content"),imageType:document.querySelector('meta[property="og:image:type"]').getAttribute("content"),imageHeight:document.querySelector('meta[property="og:image:height"]').getAttribute("content"),imageWidth:document.querySelector('meta[property="og:image:width"]').getAttribute("content"),type:document.querySelector('meta[property="og:type"]').getAttribute("content"),twitterCard:document.querySelector('meta[name="twitter:card"]').getAttribute("content")};return n.onSuccess({},(function(e){c(e.to(),e.params())})),{clearMetadata:function(){s.metadata={}},setMetadata:function(e){s.metadata=e},update:c};function c(n,c){n=n||e.current,c=c||e.params,n.abstract||(function(e){const t=`state-${s.slug}`;s.slug=e.name.replace(/\./g,"-").toLowerCase(),document.body.classList.remove(t),document.body.classList.add(`state-${s.slug}`)}(n),function(n,c){const u=_.get(o,"counters.unreadInviteNotifications",0)+_.get(o,"counters.unreadYouNotifications",0);var d=function(e){var n=angular.copy(l),o=e.name.split(".")[0];switch(s.metadata.image&&(n.image=s.metadata.image,s.metadata.imageType&&(n.imageType=s.metadata.imageType),s.metadata.imageHeight&&s.metadata.imageWidth?(n.imageHeight=s.metadata.imageHeight,n.imageWidth=s.metadata.imageWidth):(n.imageHeight="",n.imageWidth="")),n.tapBarTitle=s.metadata.tapBarTitle||"",o){case"beats":n.title="BandLab | Beats";break;case"boost":n.title="BandLab | Boost";break;case"crowdReview":n.title="Crowd Reviews - Unbiased Fan Feedback | BandLab x ReverbNation",n.description="Get your track heard by a targeted sample of real music fans and get detailed feedback about your tracks market appeal.";break;case"explore":n.title=s.metadata.title||"Explore",n.hreflang=!0;break;case"fanReachCreate":n.title="Create campaign";break;case"promoteOverview":n.title="Campaign Details";break;case"feed":n.title="Feed";break;case"warning":n.title="Account Warning";break;case"userAlbum":case"band":case"collection":case"community":case"post":case"show":case"song":case"track":case"user":case"userTip":n.type="object",n.title=s.metadata.title,n.description=s.metadata.description?s.metadata.description:"",n.player=s.metadata.player||"";break;case"mixEditor":n.title="Studio",s.metadata.title&&(n.title=`${s.metadata.title} - `.concat(n.title));break;case"landing":n.hreflang=!0;break;case"login":n.title="Log in to BandLab",n.hreflang=!0;break;case"signUp":n.title="Sign up for BandLab",n.hreflang=!0;break;case"subscribers":n.title="Manage Subscribers";break;case"notifications":n.title="Notifications";break;case"library":n.title="Library";break;case"playbackhistory":n.title="Playback History";break;case"dashboard":switch(e.name){case"dashboard.distribution.list":n.title=p()?"Distribution":"Artist Services";break;case"dashboard.distribution.earnings":n.title="My Earnings";break;case"dashboard.fanReach.sent":case"dashboard.fanReach.drafts":n.title=p()?"Fan Reach":"Artist Services";break;case"dashboard.fanReach.myFans":n.title="Fans";break;case"dashboard.fanReach.settings":n.title="Settings";break;case"dashboard.promote.list":n.title=p()?"Boost":"Artist Services";break;default:n.title="Artist Services"}break;case"search":t.q?n.title=`${t.q} | BandLab Search`:n.title="Search in BandLab";break;case"features":n.title="BandLab | FREE Online DAW & Award-Winning Features",n.hreflang=!0;break;case"albums":n.title="BandLab | Introducing Albums",n.description="Albums are an excellent way to make a creative statement. Publish yours in three easy steps and make a name for yourself today!",n.hreflang=!0;break;case"download":case"unavailable":n.title="Download BandLab for your device",n.description="Get the BandLab app on your mobile phone.";break;case"mastering":n.title="BandLab | Unlimited FREE Instant Online Audio Mastering",n.description="Unlimited Free Algorithmic Mastering by BandLab",n.image="https://www.bandlab.com/web-app/images/open-graph-mastering-5d917a6157.png",n.hreflang=!0;break;case"upload":n.title="BandLab | Upload your music and share it with millions of listeners around the world",n.description="BandLab provides free and unlimited uploads with unlimited storage, easy-to-use embeddable players and convenient private sharing.",n.hreflang=!0;break;case"quickUpload":n.title="Create";break;case"quickUpload2":n.title="BandLab | Upload your music and share it with millions of listeners around the world";break;case"report":n.title="Send Feedback";break;case"reportEntity":case"reportGeneral":n.title="Report";break;case"distribution":n.title="BandLab | Distribution",n.description="Distribute your music to all major music platforms. Keep 100% of your royalties and rights.",n.image="https://www.bandlab.com/web-app/images/open-graph-distribution-91db0fa994.png";break;case"songStarter":n.title="BandLab SongStarter | Generate royalty-free music",n.description="SongStarter is a free AI-powered idea generator that acts as your starting point to create new music  all in one easy-to-use interface.";break;case"careers":n.title="BandLab | Careers",n.description="Thinking about a career in music or tech? No matter where you are in the world, BandLab is a place where you can hone your creativity and develop your passions alongside a diverse team of music lovers.";break;case"opportunities":case"opportunitiesLandingPage":n.title="BandLab | Opportunities",n.description="Get your foot in the door by applying for opportunities that match your sound and goals.";break;case"opportunitiesSubmission":n.title=s.metadata.title||"BandLab | Opportunities",n.description=s.metadata.description||"Get your foot in the door by applying for opportunities that match your sound and goals.";break;case"fx":n.title="BandLab | Craft your unique sound with ease",n.description="Sound like your favorite artist with AutoPitch, give depth to your beats with Studio Reverb or dial in vintage tones with Valve Screamer.";break;case"splitter":n.title="Splitter | Free Vocal Remover Tool",n.description="Want to remove vocals from a song or create a backing track? Try Splitter now, our free audio separation tool that splits your song into high-quality stems.";break;case"sounds":n.title=s.metadata.title||"BandLab Sounds: Royalty-Free Music, Loops & Samples",n.description=s.metadata.description||"Create your next hit with 100,000+ royaltyfree music samples including free vocal samples, dynamic drum samples, guitar loops, free drum kits, and more.";break;default:!function(e,t){switch(e.name){case"products.assistant":t.title="BandLab Assistant | BandLab Products",t.description="Your central hub for your musical creative process on Windows and Mac.",t.hreflang=!0;break;case"products.cakewalk":t.title="Cakewalk by BandLab | BandLab Products",t.description="The next generation of SONAR, the worlds finest and most powerful desktop DAW - now FREE.",t.image="https://www.bandlab.com/web-app/images/cakewalk/open-graph-cakewalk-655985ff2b.png",t.hreflang=!0;break;case"products.cakewalkWhatsNew":t.title="Whats New in Cakewalk by BandLab | BandLab Products",t.description="Release notes, features, enhancements and fixes from the latest version of Cakewalk by BandLab.",t.image="https://www.bandlab.com/web-app/images/cakewalk/open-graph-cakewalk-655985ff2b.png",t.hreflang=!0;break;case"checkout.complete":t.title="Order Complete";break;case"checkout.summary":t.title="Order summary";break;case"checkout.payment":t.title="Checkout";break;case"contest.posts":t.title=s.metadata.title,t.description=s.metadata.description;break;case"settings.profile":t.title="Profile";break;case"settings.account":t.title="Account";break;case"settings.membership":t.title="Membership";break;case"settings.payments":t.title="Payments";break;case"settings.creatorConnect":t.title="Collaboration";break;case"settings.linkedAccounts":t.title="Linked Accounts";break;case"settings.notifications":t.title="Notifications";break;case"settings.security":t.title="Security";break;case"settings.privacy":t.title="Privacy";break;case"settings.apps":t.title="Authorized OAuth Apps";break;case"settings.language":t.title="Language"}}(e,n)}return n}(n);Zb(d.title),u>0&&!p()&&(document.title=`(${u}) `.concat(d.title));const m=document.querySelector(".tab-bar-title");m&&(m.textContent=d.tapBarTitle||d.title),Qb(d.description),ey(d.image,d.imageWidth,d.imageHeight,d.imageType,d.type),document.querySelector('meta[property="og:url"]').setAttribute("content",document.location.href),d.player?(function(e){let{player:t}=e;r.content=t,document.head.append(r),document.head.append(i),document.head.append(a)}(d),ty("player")):(r.remove(),i.remove(),a.remove(),ty(d.twitterCard)),function(){const e=document.querySelectorAll("link[hreflang]");for(const t of e)document.head.removeChild(t)}(),d.hreflang&&function(e){const t=["en","es","fr","hi","ja","ru","tr","x-default"],n=new URL(e);for(const e of t){const t=document.createElement("link");t.rel="alternate",t.hreflang=e,"x-default"===e?n.searchParams.delete("lang"):n.searchParams.set("lang",e),t.href=n.toString(),document.head.append(t)}}(e.href(n.name,c,{absolute:!0})),p()&&document.querySelector('meta[name="viewport"]').setAttribute("content","width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, viewport-fit=cover")}(n,c))}}]),angular.module("bandlab.common").factory("Place",["$resource",function(e){return e("https://www.bandlab.com/api/v1.3/places",{},{query:{method:"GET",isArray:!0,params:{type:"cities"}}})}]),angular.module("bandlab.common").factory("Tag",["$http",function(e){return{getDefaultGenre:function(){return t().then((function(e){let{defaultGenreId:t,genres:n}=e;return n.find((e=>e.id===t))}))},getGenres:function(){return t().then((function(e){let{genres:t}=e;return t}))},getSkills:function(){return t().then((function(e){let{skills:t}=e;return t}))}};function t(){return e({url:"https://www.bandlab.com/api/v1.3/labels",method:"GET",cache:!0}).then((function(e){return e.data}))}}]),angular.module("bandlab.common").factory("Validation",["$http","Me",function(e,t){return{validate:function(n,o,r){var i={};return i[o]=r,"user"===n&&"password"===o?e.get("https://accounts.bandlab.com/oauth/blacklists/passwords",{cache:!0}):(t.isAnonymous()||(i.id=t.id),e({url:`https://www.bandlab.com/api/v1.3/validation/${n}`,method:"GET",params:i}))}}}]),angular.module("bandlab.common").factory("Share",["$analytics","$state","Me",function(e,t,n){return{getEmbedRevisionUrl:function(e){let{id:t}=e;return`https://www.bandlab.com/embed/?id=${t}`},getShareUrl:function(e){if(e)switch(e.type){case"Album":return t.href("userAlbum",{id:e.object.id,username:e.object.creator.username},{absolute:!0});case"Collection":return t.href("collection",{id:e.object.id,username:e.object.creator.username},{absolute:!0});case"Community":return t.href("community",{username:e.object.username},{absolute:!0});case"Post":case"Track":return e.object.albumId?t.href("albumTracks",{username:e.object.creator.username,id:e.object.albumId,trackId:e.object.id},{absolute:!0}):t.href("post",{id:e.object.id},{absolute:!0});case"Show":return t.href("show",{id:e.object.id},{absolute:!0});case"Revision":return t.href("post",{id:e.object.postId},{absolute:!0});case"User":return t.href("fanReachFanCollector",{username:n.username},{absolute:!0})}return window.location.href},withFacebook:function(e){return import("./chunk-b006dddf.js").then((function(t){let{ui:n}=t;return n({display:"popup",method:"share",href:e})})).then((()=>o("Facebook"))).catch(angular.noop)},withReddit:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n="https://www.reddit.com/submit?";n+=`url=${encodeURIComponent(e)}`,n+=`&title=${t}`,r(600,400,n),o("Reddit")},withTwitter:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:encodeURIComponent("BandLab"),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i="https://x.com/intent/tweet?";i+=`url=${encodeURIComponent(e)}`,i+=`&hashtags=${t}`,i+=`&text=${n}`,r(535,360,i),o("Twitter")}};function o(t){e.eventTrack("Share",{category:"Social",label:t})}function r(e,t,n){const o=window.screen.width/2-e/2,r=window.screen.height/2-t/2;window.open(n,"",`toolbar=0, status=0, width=${e}, height=${t}, left=${o}, top=${r}`)}}]).controller("SNSShareCtrl",["$scope","Share",function(e,t){e.shareOnFacebook=function(){t.withFacebook(e.shareUrl)},e.shareOnTwitter=function(){t.withTwitter(e.shareUrl)}}]).controller("ShareCtrl",["$scope",function(e){e.copiedShareUrl=function(){e.isShareUrlCopied=!0,setTimeout((()=>{e.isShareUrlCopied=!1,e.$applyAsync()}),3e3)}}]).controller("EmbedCtrl",["$sce","$scope","Share",function(e,t,n){function o(){switch(t.shareData.type){case"Revision":return t.embedOptions.width=560,t.embedOptions.height=202,void t.setEmbedCode();case"Album":case"Collection":return t.embedOptions.width=560,t.embedOptions.height=353,void t.setEmbedCode();default:return t.embedOptions.width=560,void window.addEventListener("message",a)}}function r(){return`<iframe width="${t.embedOptions.width}" height="${t.embedOptions.height}" src="${i()}" allowfullscreen></iframe>`}function i(){const o={Album:`https://www.bandlab.com/embed/collection/?id=${t.shareData.object.id}`,Collection:`https://www.bandlab.com/embed/collection/?id=${t.shareData.object.id}`,Post:`https://www.bandlab.com/embed/shout/?id=${t.shareData.object.id}`,Track:`https://www.bandlab.com/embed/shout/?id=${t.shareData.object.id}`,Revision:n.getEmbedRevisionUrl({id:t.shareData.object.id})}[t.shareData.type]||"";return e.trustAsResourceUrl(o)}function a(e){let{data:{height:n,id:o}={}}=e;o===t.shareData.object.id&&(t.embedOptions.height=n,t.embedCode=r(),t.isIframeLoaded=!0,t.$applyAsync(),window.removeEventListener("message",a))}t.setEmbedCode=function(){t.embedUrl=i(),t.embedCode=r()},t.copiedEmbedUrl=function(){t.isEmbedUrlCopied=!0,setTimeout((()=>{t.isEmbedUrlCopied=!1,t.$applyAsync()}),3e3)},t.embedOptions={},t.initIframe=o,t.isIframeLoaded=!1,t.embedUrl=i(),t.embedCode="Loading",o()}]).directive("shareModal",["$analytics","Modal","Share",function(e,t,n){return{restrict:"A",scope:{shareModalCallback:"=",shareModalObject:"=",shareModalOrigin:"=",shareModalType:"="},link:function(o,r){var i;function a(e){i||(i=new t({class:"modal-share",templateUrl:"https://www.bandlab.com/web-app/common/share/_share-modal-7e512bdb.html",contentScope:{tab:"share",shareCallback:o.shareModalCallback,shareData:e,shareOrigin:o.shareModalOrigin,shareUrl:n.getShareUrl(e)},onDestroy:function(){i=null}})).show()}r.on("click",(()=>{const t={object:o.shareModalObject,type:o.shareModalType};return Yf&&p()?window.open(`intent:#Intent;action=android.intent.action.SEND;type=text/plain;S.android.intent.extra.TEXT=${n.getShareUrl(t)};end`,"_blank"):navigator.share&&(Zf||Qf)?function(t){return navigator.share({url:n.getShareUrl(t)}).then((function(){e.eventTrack("Web Share API",{category:"Share",label:t.type})})).catch((function(e){/Share canceled/.test(e.message)||"AbortError"===e.name||a(t)}))}(t):void a(t)}))}}}]),angular.module("bandlab.common").directive("sharePostModal",["$rootScope","$state","appActions","AppNotifications","ChatHelper","Me","Modal","Post","Share",function(e,t,n,o,r,i,a,s,l){return{restrict:"A",scope:{sharePostModalObject:"=",sharePostModalType:"=",sharePostModalUrl:"=",sharePostModalCaption:"=",onPostCreate:"="},link:function(c,u){var d,p={};function m(n,r){const a=l.getShareUrl({object:c.sharePostModalObject,type:c.sharePostModalType});return s.createPost({caption:n,id:i.id,entity:"users",link:c.sharePostModalCaption?null:{url:a}}).$promise.then((async function(n){e.$broadcast("$post:repost");const{openBoostPostOfferModal:a}=await Promise.resolve().then((()=>BY));a(i,n),r.$setPristine(),d.destroy(),t.is("userTip")?o.addNotification({title:"Post published",action:`<a class="button-scd button-height-32 button-padding-16 button-rounded" href="${t.href("post",{id:n.id})}"><i class="icon-arrow-right"></i></a>`,classList:"success",autoclose:8e3}):o.addNotification({content:"Post shared to feed",autoclose:3e3})})).catch((function(e){403!==e.status&&o.addNotification({title:"Unable to create post",classList:"alert",autoclose:5e3})}))}u.on("click",(function(){!d&&n.checkAllowed("shareOnBandLab")&&(c.sharePostModalObject&&(p.attachment={object:c.sharePostModalObject,type:c.sharePostModalType},p.link=!0),d=new a({class:"share-post-modal",templateUrl:"https://www.bandlab.com/web-app/common/share/_share-post-modal-07fae8fd.html",contentScope:{me:i,post:p,caption:c.sharePostModalCaption,submitPost:m},onCreate:t=>{d.element=t[0].querySelector(".modal"),d.element&&d.element.classList.remove("modal"),c.sharePostModalUrl&&async function(){p.type="Text",p.pending=!0,r.getLinkPreview(c.sharePostModalUrl).then((function(e){let[{object:t}]=e;p.link=t,p.pending=!1}))}(),setTimeout((()=>e.$broadcast("elastic:adjust")),0)},onDestroy:function(){d=null}}),d.show())}))}}}]),angular.module("bandlab.community",[]),KD.$inject=["$location","$q","$scope","$state","$timeout","Me","PlayerHistory","Post","theCommunity"],angular.module("bandlab.community.routes",[]).config(["$stateProvider",function(e){e.state("community",{url:"/community/{username:[a-z][0-9a-z_]{1,19}}",abstract:!0,template:'<div ui-view="content"></div>',resolve:{theCommunity:["$stateParams","Community",function(e,t){return t.get({id:e.username}).$promise}]},onEnter:["Page","theCommunity",function(e,t){e.setMetadata({title:`${t.name} | Communities on BandLab`,description:`${t.about?`${t.about} | `:""}${t.name} has ${t.counters.members} member${t.counters.members>1?"s":""} on BandLab. Check it out today!`,image:`${t.picture.url}360x360`,imageHeight:"360",imageWidth:"360"})}],onExit:["Page",function(e){e.clearMetadata()}],controller:["$scope","$state","$stateParams","Me","theCommunity",function(e,t,n,o,r){e.community=r,e.$on("$invite:changed",(function(){e.community.$get({id:e.community.id})})),e.$on("$community:changed",(function(o,r){"update"===r.action&&n.username!==e.community.username&&t.go(t.current.name,Object.assign(t.params,{username:e.community.username,changed:!0}),{reload:!0})})),e.$on("$community:left",(function(n,r){e.community===r.community&&(""===t.current.name?t.go("community.edit.profile",{username:o.username}):setTimeout((()=>{t.go(".",t.params,{reload:!0})}),1e3))}))}]}).state("community.feed",{url:"",views:{content:{controller:KD,templateUrl:"https://www.bandlab.com/web-app/community/views/community-feed-30a85f59.html"}}}).state("community.feed.shout",{url:"/shout?postId",reloadOnSearch:!1,resolve:{thePost:["$stateParams","Post",function(e,t){return t.get({id:e.postId}).$promise}]},onEnter:DL,onExit:jL,views:{"overlay@":{templateUrl:"https://www.bandlab.com/web-app/shout/views/shout-image-view-922d75e9.html",controller:["$scope","$state","$stateParams","thePost",function(e,t,n,o){e.post=o,e.$on("$post:delete",(function(e,r){o.id===r.post.id&&t.go("community.feed",{username:n.username})})),e.$on("$user:relationChanged",(function(e,n){"block"===n.type&&o.creator.id===n.user.id&&t.go("^")})),e.updateCounter=function(t){e.post.counters.comments=t(e.post.counters.comments)}}]}}}).state("community.edit",{url:"/edit",params:{rewriteTracking:function(){return e=>e.replace(/^\/community\/[a-z][0-9a-z_]{1,19}(($|\/).*)/g,"/community$1")}},redirectTo:function(e){return{state:"community.edit.profile",params:{username:e.params().username}}},resolve:{canEdit:["$q","theCommunity",function(e,t){return"Admin"===t.role||"Owner"===t.role?e.resolve(!0):e.reject({status:403})}]},views:{content:{templateUrl:"https://www.bandlab.com/web-app/community/views/manage/community-manage-layout-5eb33bc0.html",controller:["$scope","Me",function(e,t){e.me=t,e.userRole=e.community.role,e.setUserRole=function(t){e.userRole=t,e.community.role=t}}]}}}).state("community.edit.profile",{url:"/profile",templateUrl:"https://www.bandlab.com/web-app/community/views/manage/community-edit-5808a837.html",controller:"CommunityEditCtrl"}).state("community.edit.members",{url:"/members",templateUrl:"https://www.bandlab.com/web-app/community/views/manage/community-members-3daca55c.html"}).state("community.edit.privacy",{url:"/privacy",templateUrl:"https://www.bandlab.com/web-app/community/views/manage/community-privacy-9ecefba5.html",controller:"CommunityEditCtrl"}).state("communityId",{url:"/community/{id:[a-zA-Z0-9-_]+}",redirectTo:function(e){return e.injector().get("Community").get({id:e.params().id}).$promise.then((function(e){return{state:"community.feed",params:{username:e.username}}}))}})}]),angular.module("bandlab.community").controller("CommunityCreateCtrl",["$analytics","$rootScope","$scope","$state","AppNotifications","Community",function(e,t,n,o,r,i){n.community=new i,n.community.type="Public",n.$on("$file:uploadSuccess",(function(e,t){n.community.pictureId=t.id,n.community.picture=t,n.communityForm.$setDirty()})),n.addCommunity=function(){n.community.$save().then((function(n){t.$broadcast("createCommunityModal","close"),t.$broadcast("$community:changed",{action:"create",community:n}),e.eventTrack("Create Community",{category:"Community"}),r.addNotification({title:"Community created",content:"Invite people and share just about anything with them.",image:`${n.picture.url}48x48 1x, ${n.picture.url}96x96 2x`,action:`\n              <div ng-click="hide()">\n                <a class="button-dark button-height-32 button-padding-16 button-rounded" href="${o.href("community.edit.members",{username:n.username})}"><i class="icon-persons-plus"></i></a>\n              </div>\n            `,classList:"project",autoclose:5e3})})).catch((function(e){n.communityForm.$setPristine(),202!==e?.data?.errorCode&&r.addNotification({title:"Unable to create community. Check your internet connection and try again.",content:e.data.message,classList:"alert",autoclose:8e3})}))}}]),angular.module("bandlab.community").controller("CommunityEditCtrl",["$analytics","$rootScope","$scope","$state","$timeout","AppNotifications","Community","theCommunity",function(e,t,n,o,r,i,a,s){n.changeError=!1,n.community=angular.copy(s),n.$on("$community:changed",(function(e,t){let{action:o,data:r}=t;"picture"===o&&(Object.assign(s.picture,r.picture),Object.assign(n.community.picture,r.picture))})),n.updateCommunity=function(){n.changeError=!1,a.update({id:s.id,name:n.community.name,username:n.community.username,about:n.community.about,type:n.community.type,commentCreateGroup:n.community.commentCreateGroup,postCreateRole:n.community.postCreateRole}).$promise.then((function(a){r((function(){Object.assign(s,a),t.$broadcast("$community:changed",{action:"update",community:s})}),1e3),n.communityForm.$setPristine(),i.addNotification({title:"Community profile updated",action:`<a class="button-scd button-height-32 button-padding-16 button-rounded" href="${o.href("community.feed",{username:a.username})}"><i class="icon-arrow-right"></i></a>`,classList:"success",autoclose:8e3}),e.eventTrack("Update Community",{category:"Community"})})).catch((function(){n.communityForm.$setPristine(),n.changeError=!0}))}}]),angular.module("bandlab.community").controller("CommunityJoinCtrl",["$scope","CommunityActions",function(e,t){e.cancelRequestToJoinCommunity=function(e){return t.cancelRequestToJoinCommunity(e.id,e.invite.id).then((function(){e.invite={}})).catch((function(t){return 401!==t.status&&404!==t.status||(e.invite={}),Promise.reject(t)}))}}]),angular.module("bandlab.community").controller("CommunityLeaveCtrl",["$rootScope","$scope","$state","AppNotifications","CommunityActions","MessageModal",function(e,t,n,o,r,i){function a(){let{isLastMember:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r.deleteCommunity(t.community,e).then((function(){n.go("library.communities")})).catch((e=>s(e,"Cannot delete community")))}function s(e,t){"Cancelled"!==e&&o.addNotification({title:t,content:_.get(e,"data.message")||_.get(e,"message","Unknown error"),autoclose:5e3,classList:"alert"})}t.deleteCommunity=a,t.leaveCommunity=function(){return"Owner"===t.userRole?new i({contentScope:{title:"Leave Community",message:"<p>Before leaving, you need to transfer ownership to one of the members here.</p>"}}).show():1===t.community.counters.members?a({isLastMember:!0}):r.leaveCommunity(t.community).then((function(){e.$broadcast("$community:left",{community:t.community})})).catch((e=>s(e,"Cannot leave community")))},t.userRole=t.community.role}]),angular.module("bandlab.community").controller("CommunityManageCtrl",["$scope","Invite","User",function(e,t,n){function o(){t.query({id:e.community.id,entity:"communities",accepted:!1,limit:50}).$promise.then((function(t){e.pendingInvitedUser=[],e.pendingInvitedExternalUser=[],t.forEach((function(t){var o;t.user?((o=new n(t.user)).invite=t,e.pendingInvitedUser.push(o)):((o=new n({email:t.email})).invite=t,e.pendingInvitedExternalUser.push(o))}))}))}e.$on("$invite:changed",(function(){o()})),o()}]),angular.module("bandlab.community").controller("CommunityMembersCtrl",["$q","$scope","CommunityActions","Me","Role","User",function(e,t,n,o,r,i){t.removeMember=function(e){n.removeMember(t.community,e).then((function(){Gf(t.members,(function(t){return t.id===e.id})),t.community.counters.members-=1})).catch(u)},t.updateRole=function(e,o){if("Owner"===o){const o=_.find(t.members,{role:"Owner"});return n.assignOwnership(t.community,e).then((function(){o.role="Admin",t.setUserRole("Admin")}))}r.setUserRole({communityId:t.community.id,userId:e.id,role:o}).then((function(t){e.role=t.role}))},t.me=o;var a,s=20,l=null,c=!1;function u(){l=null,a=null,c=!1,t.members=null,t.infiniteScrollEnded=!1,d().then(t.loadMore)}function d(){return c?e.resolve([]):a=i.fromCommunity({communityId:t.community.id,limit:s,after:l,accepted:!0}).$promise.then((function(e){let{paging:t,data:n}=e;return c=t.itemsCount<t.limit,l=t.cursors.after,n}))}t.loadMore=function(){return t.infiniteScrollEnded?e.resolve():a=a.then((function(e){return t.infiniteScrollEnded=c,t.members=t.members||[],t.members=t.members.concat(e),d()}))},t.setUserRole=function(e){t.userRole=e,t.community.role=e},t.$on("$invite:changed",u),u()}]),angular.module("bandlab.community").controller("CommunityNotificationsCtrl",["$scope","Me","Role",function(e,t,n){e.setNotifications=function(){let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"All";n.setNotifications({communityId:e.community.id,userId:t.id,settings:{activityNotifications:o,pushNotifications:o}}).then((t=>{let{activityNotifications:n,pushNotifications:o}=t;e.community.activityNotifications=n,e.community.pushNotifications=o}))}}]),angular.module("bandlab.community").controller("ShareWithCommunityCtrl",["$analytics","$rootScope","$scope","AppNotifications","ChatHelper","Community","Me","Post","Share",function(e,t,n,o,r,i,a,s,l){n.communities=i.fromUser({userId:a.id,limit:50}),n.link=l.getShareUrl(n.attachment),n.submitForm=function(i){return r.getLinkPreview(n.link).then((function(e){let[{object:t}]=e;return s.createPost({id:n.selectedCommunity.id,entity:"communities",caption:n.caption,link:t}).$promise})).then((()=>{e.eventTrack("Share with a Community",{category:"Post",label:"text"}),o.addNotification({content:`Post shared with ${n.selectedCommunity.name}`,autoclose:3e3}),t.$broadcast(n.modalId,"close")})).catch((()=>{i.$submitted=!1}))}}]),angular.module("bandlab.community").component("communityCard",{bindings:{community:"="},templateUrl:"https://www.bandlab.com/web-app/community/partials/_community-card-dfa9e85a.html",controller:["CommunityActions",function(e){this.joinCommunity=e.joinCommunity,this.requestToJoinCommunity=e.requestToJoinCommunity}],controllerAs:"vm"}),angular.module("bandlab.community").component("communityMembersCard",{bindings:{community:"<"},templateUrl:"https://www.bandlab.com/web-app/community/partials/_community-members-card-7439ee05.html",controller:["$rootScope","User",function(e,t){const n=this;function o(){r({limit:10}).then((e=>{let{data:t}=e;n.users=t}))}function r(e){return Object.assign(e,{communityId:n.community.id,accepted:!0}),t.fromCommunity(e).$promise}n.$onInit=o,n.getCommunityMembers=r,e.$on("$invite:changed",o)}],controllerAs:"vm"}),angular.module("bandlab.community").component("communityTile",{bindings:{community:"="},transclude:{actions:"?communityTileActions"},templateUrl:"https://www.bandlab.com/web-app/community/partials/_community-tile-cf27f928.html",controllerAs:"vm",controller:["User",function(e){const t=this;t.getCommunityMembers=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.fromCommunity(Object.assign({communityId:t.community.id,accepted:!0},n)).$promise}}]}),angular.module("bandlab.community").factory("Community",["$http","$resource",function(e,t){var n="https://www.bandlab.com/api/v1.3/communities";return t(n,{},{delete:{method:"DELETE",params:{id:"@id"},url:`${n}/:id`},fromUser:{method:"GET",isArray:!0,params:{userId:"",limit:10,offset:0},url:"https://www.bandlab.com/api/v1.3/users/:userId/communities"},get:{method:"GET",params:{id:"@id"},url:`${n}/:id`},save:{method:"POST",url:n,transformResponse:[...e.defaults.transformResponse,YD]},update:{method:"PATCH",params:{id:"@id"},url:`${n}/:id`}})}]),angular.module("bandlab.community").factory("CommunityActions",["$analytics","$q","$rootScope","appActions","AppNotifications","authService","ConfirmModal","Invite","Me","Role",function(e,t,n,o,r,i,a,s,l,c){return{assignOwnership:function(e,n){return t((function(t,o){return new a({confirmLabel:"Transfer",contentScope:{title:`Transfer ownership to ${n.name}?`,message:"<p>Your ownership rights will be given to the selected user.</p>"},onCancel:o,onConfirm:function(){c.setUserRole({communityId:e.id,userId:n.id,role:"Owner"}).then((function(e){n.role=e.role,t(n)})).catch(o)}}).show()}))},cancelRequestToJoinCommunity:function(e,t){return s.remove({communifyId:e,id:t}).$promise},deleteCommunity:function(o,r){return t((function(t,s){return new a({confirmLabel:"Delete",contentScope:{title:"Delete Community",message:`\n            <div class="text-left">\n              ${r?"<p>Theres no one else in this community. If you leave, it will be deleted.</p>":""}\n              <p>Deleting a community cannot be undone. By doing so:</p>\n              <ul>\n                <li>You will lose access to the existing community posts.</li>\n                <li>All community members will no longer be in the community.</li>\n                <li>All community members will lose access to the existing community posts.</li>\n              </ul>\n              <p>Are you sure you want to delete ${o.name}?</p>\n            </div>\n          `},onCancel:()=>s("Cancelled"),onConfirm:function(){n.$broadcast("$community:changed",{action:"mark-deleted",community:o}),o.$delete().then(i.refreshMe).then((function(){n.$broadcast("$community:changed",{action:"delete",community:o}),e.eventTrack("Delete Community",{category:"Community"}),t(o)})).catch((e=>{n.$broadcast("$community:changed",{action:"unmark-deleted",community:o}),s(e)}))}}).show()}))},joinCommunity:function(t){if(!o.checkAllowed("joinCommunity"))return;const n=new s;return n.userIds=[l.id],n.$save({rel:"communities",id:t.id}).then((function(){e.eventTrack("Join Community",{category:"Community"}),Promise.resolve().then((()=>rb)).then((function(e){let{logCommunityJoin:t}=e;t()}))})).finally((()=>u(t)))},leaveCommunity:function(o){return t((function(t,r){return new a({confirmLabel:"Leave",contentScope:{title:"Leave this community?",message:"<p>You can rejoin it anytime you want.</p>"},onCancel:()=>r("Cancelled"),onConfirm:function(){n.$broadcast("$community:changed",{action:"mark-deleted",community:o}),c.removeUserRole({communityId:o.id,userId:l.id}).then((function(){e.eventTrack("Leave Community",{category:"Community"}),u(o),t(o)})).catch((e=>{n.$broadcast("$community:changed",{action:"unmark-deleted",community:o}),r(e)}))}}).show()}))},removeMember:function(e,n){return t((function(t,o){return new a({confirmLabel:"Remove",contentScope:{title:"Remove Member",message:"<p>Remove this member from the community?</p>"},onCancel:o,onConfirm:function(){c.removeUserRole({communityId:e.id,userId:n.id}).then(t).catch(o)}}).show()}))},requestToJoinCommunity:function(t){if(!o.checkAllowed("joinCommunity"))return;const n=new s;return n.userIds=[l.id],n.$save({rel:"communities",id:t.id}).then((function(){e.eventTrack("Request to join Community",{category:"Community"}),r.addNotification({title:"Request sent",content:"Youll be notified once its approved.",image:`${t.picture.url}48x48 1x, ${t.picture.url}96x96 2x`,classList:"community",autoclose:5e3})})).finally((()=>u(t)))}};function u(e){e.$get&&setTimeout((()=>{e.$get({id:e.id})}),1e3)}}]),angular.module("bandlab.common").directive("creatorConnectVideo",["$analytics","$rootScope","$sce","$timeout","Player","VideoTile",function(e,t,n,o,r,i){return{restrict:"E",replace:!0,scope:{video:"=?"},templateUrl:"https://www.bandlab.com/web-app/connect/partials/_creator-connect-video-2572aa8e.html",link:function(a,s){const l=s[0].querySelector("video");let c,u=a.video?.counters?.views;function d(){o.cancel(c),c=o((function(){a.isLoading=!0}),1e3)}l.autoplay=a.video&&a.video.autoplay,a.isPlaying=l.autoplay,l.addEventListener("play",(function(){i.current&&l!==i.current&&i.current.pause(),u+=1,t.$broadcast("views",{views:u,id:a.video.id}),i.current=l,r.pause(),e.eventTrack("Play",{category:"Video"}),a.$applyAsync(),r.pauseOtherTabs(),4===l.readyState?l.setAttribute("controls",""):d()})),l.addEventListener("pause",(function(t){if(1===t.target.readyState)return!1;e.eventTrack("Pause",{category:"Video"}),l.removeAttribute("controls"),o.cancel(c),a.isLoading=!1,a.$applyAsync()})),l.addEventListener("waiting",d),l.addEventListener("canplaythrough",(function(){o.cancel(c),a.isLoading=!1,l.setAttribute("controls",""),a.$applyAsync()})),function(){if(a.file)return l.src=URL.createObjectURL(a.file),void(a.video={status:"Ready"});a.video&&a.video.url&&(l.src=n.trustAsResourceUrl(a.video.url))}(),a.isPlaying=function(){return!l.paused},a.isEnded=function(){return l.paused&&l.currentTime===l.duration},a.play=function(){l.paused?l.play():l.pause()}}}}]),angular.module("bandlab.connect.routes",["ui.router"]).config(["$stateProvider",function(e){e.state("creatorConnect",{url:"/creator-connect?category&genres&place&skills&nearby",templateUrl:"https://www.bandlab.com/web-app/connect/views/creator-connect-d337ace3.html",redirectTo:function(e){return e.injector().getAsync("theQuery").then((function(t){let{genres:n,place:o,skills:r,nearby:i}=t;if(!(r.length||n.length||o||angular.isDefined(i)))return{state:"creatorConnect",params:function(){switch(e.params().category){case"beatmakers":return{genres:"hip-hop;r-n-b",nearby:!1,skills:"dj-beatmaker;vocalist"};case"guitarists":return{nearby:!1,skills:"bass-player;guitarist"};case"near-you":return{nearby:!0};default:return{nearby:!1}}}()}}))},resolve:{theLocation:["$stateParams","Place",function(e,t){if(e.place)return t.query({query:e.place}).$promise.then((function(e){return e[0]}))}],theQuery:["$stateParams","theGenres","theSkills",function(e,t,n){const o=e.genres&&e.genres.split(";").map((e=>t.find((t=>t.id===e))))||[],r=e.place,i=r?null:e.nearby;return{genres:o,place:r,skills:e.skills&&e.skills.split(";").map((e=>n.find((t=>t.id===e))))||[],nearby:i}}],theGenres:["Tag",function(e){return e.getGenres()}],theSkills:["Tag",function(e){return e.getSkills()}]},controller:["$analytics","$http","$scope","$state","$stateParams","CreatorConnect","Me","Place","Player","Search","theGenres","theLocation","theQuery","theSkills","VideoTile",function(e,t,n,o,r,i,a,s,l,c,u,d,p,m,f){let h=null;function g(){return c.collaborators({after:h,nearby:d?null:i.query.nearby||null,placeId:d?d.id:null,latitude:null,longitude:null,maxDistance:null,genres:i.query.genres.map((e=>e.id)).sort().join(";")||null,skills:i.query.skills.map((e=>e.id)).sort().join(";")||null}).then((function(e){let{data:o,paging:r}=e;h=r.cursors.after,n.users=(n.users||[]).concat(o),o.map((function(e){t.get(`https://www.bandlab.com/api/v1.3/users/${e.id}/posts`,{silent:!0}).then((function(t){let{data:n}=t;e.pinnedPost=_.find(n,{isPinned:!0,type:"Revision"}),e.pinnedPost&&(e.pinnedPost.revision.postId=e.pinnedPost.id)}))}))})).catch((function(e){n.users=[],n.errorCode=_.get(e,"data.errorCode")}))}function v(){f.current&&f.current.pause(),l.getCurrentSong().id===_.get(i,"user.pinnedPost.revision.id")&&l.pause()}n.creatorConnect=i,n.theSkills=m,n.theGenres=u,n.me=a,n.location={search:"",places:[],theLocation:d},i.query=p,n.$watch("location.search",(function(e){s.query({query:e}).$promise.then((function(e){n.location.places=e}))})),g().then((function(){n.user=n.users[0]})),n.initGenreFilters=function(){return i.query.genres.reduce((function(e,t){return e[t.id]=!0,e}),{})},n.initSkillFilters=function(){return i.query.skills.reduce((function(e,t){return e[t.id]=!0,e}),{})},n.applySkills=function(e){const t=Object.keys(e).filter((t=>e[t])).join(";");t!==r.skills&&o.go(".",{skills:t},{reload:!0})},n.applyGenres=function(e){const t=Object.keys(e).filter((t=>e[t])).join(";");t!==r.skills&&o.go(".",{genres:t},{reload:!0})},n.applyLocation=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;JSON.stringify(e)===r&&t===r.place||o.go(".",{...t?{}:{nearby:e},place:t},{reload:!0})},n.hasPrevious=function(){return i.userEl&&i.userEl.previousElementSibling&&i.userEl.previousElementSibling.hasAttribute("creator-connect-carousel-user")},n.hasNext=function(){return i.userEl&&i.userEl.nextElementSibling&&i.userEl.nextElementSibling.hasAttribute("creator-connect-carousel-user")},n.next=function(){if("scrollBehavior"in document.documentElement.style)i.userEl.nextElementSibling.scrollIntoView({behavior:"smooth",inline:"center"});else{const{width:e}=i.userEl.nextElementSibling.getBoundingClientRect();i.userEl.parentNode.scrollTo({left:i.userEl.nextElementSibling.offsetLeft-(document.body.clientWidth-e)/2,behavior:"smooth"})}n.users.length-n.users.indexOf(i.user)<3&&g(),v(),e.eventTrack("Browse next user",{category:"Creator Connect",label:n.users.indexOf(i.user)})},n.previous=function(){if("scrollBehavior"in document.documentElement.style)i.userEl.previousElementSibling.scrollIntoView({behavior:"smooth",inline:"center"});else{const{width:e}=i.userEl.nextElementSibling.getBoundingClientRect();i.userEl.parentNode.scrollTo({left:i.userEl.previousElementSibling.offsetLeft-(document.body.clientWidth-e)/2,behavior:"smooth"})}v()}}]})}]).constant("CreatorConnect",{query:{},user:{},userEl:{}}).directive("creatorConnectKeyboard",(function(){return{link:function(e){function t(t){const n=t.ctrlKey||t.metaKey;if(-1===["INPUT","TEXTAREA"].indexOf(t.target.nodeName)&&!n&&!t.shiftKey){switch(t.code){case"ArrowLeft":return t.preventDefault(),e.previous();case"ArrowRight":return t.preventDefault(),e.next()}e.$applyAsync()}}angular.element(document.body).on("keydown",t),e.$on("$destroy",(function(){angular.element(document.body).off("keydown",t)}))}}})).directive("creatorConnectLocationKeyboard",(function(){return{link:function(e,t){t.on("keydown",(function(t){if(!t.ctrlKey&&!t.metaKey&&!t.shiftKey){switch(t.code){case"Enter":{const n=_.find(e.location.places,{isHovered:!0});n&&e.applyLocation(!1,n.name),t.stopPropagation(),t.preventDefault();break}case"ArrowUp":{const n=_.findIndex(e.location.places,{isHovered:!0}),o=_.find(e.location.places,{isHovered:!0});o&&(o.isHovered=!1),e.location.places[Math.max(n-1,0)].isHovered=!0,t.preventDefault();break}case"ArrowDown":{const n=_.findIndex(e.location.places,{isHovered:!0}),o=_.find(e.location.places,{isHovered:!0});o&&(o.isHovered=!1),e.location.places[Math.min(n+1,e.location.places.length-1)].isHovered=!0,t.preventDefault();break}}e.$applyAsync()}}))}}})).directive("creatorConnectCarouselUser",["CreatorConnect",function(e){return{restrict:"A",link:function(t,n){new IntersectionObserver((function(o){let[{intersectionRatio:r}]=o;r>=.8&&(e.user=t.user,e.userEl=n[0],t.$applyAsync())}),{threshold:.8}).observe(n[0])}}}]).directive("creatorConnectVideo",["$q","$timeout","AppNotifications",function(e,t,n){return{restrict:"A",require:"?ngModel",link:function(o,r,i,a){const s=r[0].querySelector("input");o.selectFile=function(){setTimeout((()=>s.click()))},o.removeVideo=function(){o.user.introVideo=null,o.user.introVideoId=null,o.videoFile=null,a&&a.$setViewValue(null)},o.$on("$ngFile:fileChanged",(function(r,i){let[a]=i;a&&async function(e){return await Dh(e,100),await eg(e,{minDuration:10,maxDuration:60})}(a).then((function(e){let{file:n}=e;o.user.introVideo=null,o.user.introVideoId=null,o.videoFile=null,o.importing=!0,t((function(){o.videoFile=n,o.importing=!1}))})).catch((function(t){return n.addNotification({title:"Import Error",content:t.message,classList:"alert",autoclose:8e3}),e.reject(t)}))}))}}}]),angular.module("bandlab.common").controller("ArtistsCtrl",["$rootScope","$scope",function(e,t){t.user?t.inspiredBy=[...t.user.inspiredBy]:t.collaborationPreferences&&(t.inspiredBy=[...t.collaborationPreferences.lookingFor.inspiredBy]),t.closeModal=function(){e.$broadcast("$inspiredBy:update")},t.updateInspiration=function(e){t.user?t.user.inspiredBy=e:t.collaborationPreferences&&(t.collaborationPreferences.lookingFor.inspiredBy=e),angular.isFunction(t.onSubmit)&&t.onSubmit()}}]),angular.module("bandlab.user").directive("addArtistForm",(function(){return{restrict:"E",replace:!0,transclude:{submit:"?addArtistFormSubmit",zerocase:"?addArtistFormZeroCase"},scope:{inspiredBy:"=?",onSubmit:"&?"},templateUrl:"https://www.bandlab.com/web-app/connect/partials/_add-artist-form-4ad55322.html",controller:["$rootScope","$scope",function(e,t){const n=this;n.removeUser=function(e){Gf(n.artists,e)},n.updateInspiration=function(){t.onSubmit&&t.onSubmit({artists:n.artists}),e.$broadcast("artists","close"),e.$broadcast("collab_artists","close")},t.inspiredBy?n.artists=t.inspiredBy:n.artists=[],t.$on("$inspiredBy:update",(()=>{n.updateInspiration()}))}],controllerAs:"vm"}})),angular.module("bandlab.user").directive("selectMultipleArtists",["$http","$timeout",function(e,t){return{restrict:"E",templateUrl:"https://www.bandlab.com/web-app/connect/partials/_select-multiple-artists-b2727a2d.html",scope:{artists:"="},link:function(n,o){let r,i,a=0;n.inviteUser="",n.suggestions={artists:[]};const s=ay((function(o){angular.isUndefined(o)||0===o.length?n.suggestions={artists:[]}:(r=e.get(`https://www.bandlab.com/api/v1.3/artists?query=${o}&limit=24`,{retryNumber:3}).then((e=>{let{data:t}=e;return a=0,t.slice(0,5)})).catch((function(){if(i===o&&o&&a<3)return t((function(){return s(i)}),1e3*Math.pow(++a,2))})),r.then((e=>{if(i!==o&&o)return s(i);const t=n.artists.map((e=>e.id));n.suggestions.artists=_.filter(e,(e=>!t.includes(e.id)))})))}),500);o[0].closest(".modal").addEventListener("click",(function(e){!e.target.closest(".select-multiple-users")&&n.inviteUser&&n.$applyAsync()})),n.setUser=function(e){e.type="user",n.artists.push(e),n.inviteUser=""},n.handleKeys=function(e){(9===e.which&&n.inviteUser||13===e.which)&&e.preventDefault()},n.clearSuggestions=function(){n.suggestions={artists:[]}},n.$watch("inviteUser",(function(){i=n.inviteUser,r&&0===_.get(r,"$$state.status")||s(i)}))}}}]),angular.module("bandlab.web").controller("ReportCtrl",["$analytics","$cookies","$q","$scope","$state","$stateParams","authService","Contact","User",function(e,t,n,o,r,i,a,s,l){let c=n.resolve();function u(){try{window.AndroidReport.onReportSubmitted()}catch{}try{window.webkit.messageHandlers.onReportSubmitted.postMessage({message:"onReportSubmitted"})}catch{}}function d(e){return e?.data?.message||"Something went wrong, please try again later"}o.toReport.creator&&l.get({id:o.toReport.creator.id}).$promise.then((function(e){o.toReport.creator=e,o.wasFollower=e.isFollower})),o.$watch("reason",(function(){if(!o.reason&&!i.reason)return;const e=new RegExp(/spam/i),t=e.test(o.reason)||e.test(i.reason);o.isMessageFieldRequired=!t})),o.contact=new s({reason:""}),o.messageSent=!1,o.goBack=function(){"true"===t.get("webview")?r.go(".",{"#":"bl_closeWebView"}):window.history.back()},o.openCopyrightForm=function(){window.open("https://docs.google.com/forms/d/e/1FAIpQLSdJiKNGI1FcG46e9BRanKu5yPquVnm4LItokpWAgwTbSEuITQ/viewform","_blank")},o.submitReason=function(e){let{reason:t}=e;o.step="form",o.reason=t},o.submitReport=function(){let{reason:t=o.reason||""}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};0!==c.$$state.status&&a.solveCaptcha().then((()=>{o.loading=!0,o.contact.objectType=o.toReport.objectType,o.contact.objectId=o.toReport.objectId,o.contact.reason=t.split(" ").join("-"),o.contact.description=o.contact.description||`${o.contact.reason}\n${o.toReport.objectType}\n${o.toReport.objectId}`,o.contact.subObjectId=o.toReport.subObjectId,o.contact.objectCreatorId=o.toReport.objectCreatorId||o.toReport.creator?.id,c=o.contact.$report().then((function(){e.eventTrack(`Report ${t}`,{category:"Contact",label:o.toReport.objectType}),o.loading=!1,o.step="thanks"})).catch((function(e){o.loading=!1,o.reportError=d(e)}))}))},o.submitFeedback=function(){let{reason:e=o.reason,type:t=o.type}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};0!==c.$$state.status&&a.solveCaptcha().then((()=>{o.loading=!0,o.contact.reason=e.split(" ").join("-"),o.contact.subject="bugs"===t?"Something isn't working":"",c=o.contact.$save().then((function(){o.loading=!1,o.step="thanks-feedback"})).catch((function(e){o.loading=!1,o.reportError=d(e)}))}))},o.submitReportWebview=function(){let{reason:t=i.reason||""}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};0!==c.$$state.status&&a.solveCaptcha().then((()=>{o.loading=!0,o.contact.objectType=o.toReport.objectType,o.contact.objectId=o.toReport.objectId,o.contact.postId=o.toReport.entityId,o.contact.reason=t.split(" ").join("-"),o.contact.description=o.contact.description||`${o.contact.reason}\n${o.toReport.objectType}\n${o.toReport.objectId}`,o.contact.subObjectId=o.toReport.subObjectId,o.contact.objectCreatorId=o.toReport.objectCreatorId||o.toReport.creator?.id,c=o.contact.$report().then((function(){u(),e.eventTrack("Report Content within web view",{category:"Contact",label:o.contact.objectType}),o.loading=!1,r.go(".",{step:"thanks"},{location:"replace"})})).catch((function(e){o.loading=!1,o.reportError=d(e)}))}))},o.submitFeedbackWebview=function(){let{reason:t=i.reason||""}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};0!==c.$$state.status&&a.solveCaptcha().then((()=>{o.loading=!0,o.contact.reason=t.split(" ").join("-"),o.contact.subject="bugs"===i.type?"Something isn't working":"",o.contact.description=o.contact.description||`${o.contact.reason}\n${o.toReport.objectType}\n${o.toReport.objectId}`,c=o.contact.$save().then((function(){u(),e.eventTrack("Send Feedback within web view",{category:"Contact",label:t}),o.loading=!1,r.go(".",{step:"thanks-feedback"},{location:"replace"})})).catch((function(e){o.loading=!1,o.reportError=d(e)}))}))},o.openFeedbackModal=function(){const e=zn((()=>import("./chunk-4533850d.js")));Promise.resolve().then((()=>Tg)).then((function(t){let{createModal:n}=t;n(e)}))}}]),angular.module("bandlab.web").factory("Contact",["$cookies","$resource","$window","Me",function(e,t,n,o){var r="https://www.bandlab.com/api/v1.3/";const i=t(r,{},{save:{method:"POST",url:`${r}feedback`,headers:{"X-Client-Id":e.get("X-Client-Id"),"X-Client-Version":e.get("X-Client-Version")},transformRequest:[function(e){return{name:o.name||null,type:"Feedback",username:o.username||null,debugInfo:n.debugInfo,...e}},angular.toJson]},report:{method:"POST",url:`${r}report`,headers:{"X-Client-Id":e.get("X-Client-Id"),"X-Client-Version":e.get("X-Client-Version")},transformRequest:[function(e){return{reportType:"Other",debugInfo:n.debugInfo,...e}},angular.toJson]}});return function(e){return new i({email:o.email||null,language:n.navigator.userLanguage||n.navigator.language,userAgent:n.navigator.userAgent,...e})}}]),angular.module("bandlab.web").config(["$stateProvider",function(e){n.$inject=["$stateParams"];const t=["popular","recent"];function n(e){return t.includes(e.sort)?e.sort:t[0]}e.state("contest",{url:"/contests",redirectTo:function(e){return e.injector().getAsync("theContests").then((function(e){let[t]=e;return{state:"contest.posts",params:{id:t.id}}}))},resolve:{theContests:["$http",function(e){return e.get("https://www.bandlab.com/api/v2.0/contents/explore?types=contests",{cache:!0}).then((e=>e.data.data.map((function(e){return e.startDateObject=new Date(e.startDate),e.endDateObject=new Date(e.endDate),e.now=new Date,e})))).catch((()=>[]))}]},template:"<ui-view/>"}).state("contest.posts",{url:"/:id?sort",params:{sort:"popular"},onEnter:["Page","theContest",function(e,t){e.setMetadata({title:t.name,description:t.description,image:t.picture.url,imageWidth:850,imageHeight:445})}],onExit:["Page",function(e){e.clearMetadata()}],resolve:{theContest:["$stateParams","Contest",function(e,t){return t.get({id:e.id}).$promise.then((function(e){return e.startDateObject=new Date(e.startDate),e.endDateObject=new Date(e.endDate),e.now=new Date,e.post&&(e.post.revision.postId=e.post.id),e}))}],theSort:n},views:{"":{templateUrl:"https://www.bandlab.com/web-app/contest/views/contest-posts-62fc3aca.html",controller:["$scope","theContest","theContests",function(e,t,n){e.contest=t,e.contests=n.filter((e=>e.id!==t.id))}]},"sort@contest.posts":{templateUrl:"https://www.bandlab.com/web-app/contest/partials/_sort-a15b9080.html"},"list@contest.posts":{templateUrl:"https://www.bandlab.com/web-app/explore/partials/_explore-posts-63b729bb.html",controller:"PostsListCtrl"}}})}]),angular.module("bandlab.web").factory("Contest",["$resource",function(e){var t="https://www.bandlab.com/api/v1.3/contests";return e(t,{},{get:{method:"GET",params:{id:"@id"},url:`${t}/:id`}})}]);const JD=22,XD=120,ZD=Object.freeze(Object.defineProperty({__proto__:null,CODE_NO_EMAIL:JD,CODE_UNCONFIRMED_EMAIL:XD},Symbol.toStringTag,{value:"Module"}));function QD(e){return e.items?e.items.map((t=>({title:t.fields.title,link:t.fields.link,imgUrl:eN(e,t.fields.picture.sys.id)}))):[]}function eN(e,t){return e.includes.Asset.find((e=>e.sys.id===t)).fields.file?.url}function tN(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};const o=e.get("$state"),r=e.get("Me"),i=e.get("User");let a=0;return window.addEventListener("popstate",s),t.$on("$destroy",(function(){window.removeEventListener("popstate",s)})),{startPurchaseFlow:function(e,t,n){const r=Cg(l.get("X-Client-Version"),"10.71.0",1071e4);if(p()&&r){const r=o.href("getMembership",{contentId:n,productAttribution:e,productAttributionGroup:t,persistWebview:!0},{absolute:!0});window.open(r,"_blank")}else o.go(".",{"#":"bl_startMembershipPurchaseFlow"})}};function s(){location.hash&&a++,["#bl_purchaseCompleted","#bl_purchaseCancelled"].includes(location.hash)&&(window.history.go(-1*a),a=0),"#bl_purchaseCompleted"===location.hash&&i.getMembershipStatus({userId:r.id}).$promise.then((e=>e.plan)).then((e=>{n(e)}))}}async function nN(e){return await async function(e){const t=new Image;t.crossOrigin="Anonymous",t.src="https://images.bandlab.workers.dev/?src="+encodeURIComponent(e);const n=new Promise((e=>{t.addEventListener("load",(()=>e(t)),{once:!0}),t.addEventListener("error",(()=>e(null)),{once:!0}),setTimeout((()=>{e(null)}),500)}));return Promise.all([import("./chunk-7d5c09a7.js"),n]).then((e=>{let[{default:t},n]=e;if(!n)return localStorage.removeItem("colors");const o=new t,r=o.getColor(n),i=o.getPalette(n);localStorage.setItem("colors",JSON.stringify({color:r,palette:i}))}))}(e.picture),e}function oN(e){let t=0;if(e.endsOn){const n=new Date(e.endsOn).getTime()-Date.parse((new Date).toUTCString());n>0&&(t=Math.ceil(n/864e5)),t>0&&(t+=1)}return t}function rN(e){return"Exclusive"===e?"BandLab Platform":e}const iN=90;function aN(e,t){return e?.canEdit||t?.permissions.edit}function sN(e,t){return e?.mixdown.duration>=iN||t?.track.sample.duration>=iN}function lN(e){return"Ready"===e?.mixdown.status}function cN(e,t,n){return lN(e)?sN(e,t)?!!aN(e,t)||n.addNotification({title:"Crowd Review error",content:"Only the creator can submit",classList:"warning",autoclose:8e3}):n.addNotification({title:"Crowd Review error",content:"Your track must be longer than 90 seconds",classList:"warning",autoclose:8e3}):n.addNotification({title:"Crowd Review error",content:"Currently processing. Please wait a few seconds before trying again.",classList:"warning",autoclose:8e3})}function uN(e,t,n){return lN(e)?sN(e,t)?aN(e,t)?!!function(e,t){const{state:n}=e.post??t;return"Public"===n||"Unlisted"===n}(e,t)||n.addNotification({title:"Oops! This is private",content:"Make your track public to promote it",innerScope:{revision:e},action:'<a class="button-dark button-height-32 button-padding-16 button-rounded"\n        async-modal="https://www.bandlab.com/web-app/song/partials/_revision-publish-f4991e60.html"\n        async-modal-id="editRevisionModal"\n        async-modal-parse="{ revision: $parent.innerScope.revision }">Publish</a>',classList:"warning",autoclose:8e3}):n.addNotification({title:"Zire error",content:"Only the creator can submit",classList:"warning",autoclose:8e3}):n.addNotification({title:"Zire error",content:"Must be longer than 90 secs",classList:"warning",autoclose:8e3}):n.addNotification({title:"Zire error",content:"Currently processing. Please wait a few seconds before trying again.",classList:"warning",autoclose:8e3})}const dN=60;function pN(e,t,n,o){return function(e,t){return t.getAccess({userId:e.id}).$promise.then((function(e){let{featureAccess:t}=e;return!t.error||"1426"===t.error.code||1425===t.error.code||Promise.reject(t.error)}))}(t,n).catch((function(t){if(t.code===JD||t.code===XD){const e=zn((()=>import("./chunk-14e15eec.js")));Promise.resolve().then((()=>Tg)).then((function(n){let{createModal:r}=n;r(e,{emailUnconfirmed:t.code===XD},{onClose:function(){o&&(o.releasing=!1)}})}))}else{if(500===t.status||500===t.code)return;e.addNotification({title:t.message,classList:"alert",autoclose:8e3})}}))}function mN(e,t){return t.getAccess({userId:e.id}).$promise.catch((e=>e.featureAccess?e:{featureAccess:{remainingReleases:0}}))}function fN(e,t){return t.getMembershipStatus({userId:e.id}).$promise.catch((function(){return{isTrial:null}}))}function hN(e){return Promise.resolve().then((()=>Ap)).then((function(t){let{getAmplitudeFeatureFlag:n}=t;return n(e,"distro_pilot_user_flow")})).then((function(e){return"true"===e||"on"===e}))}function gN(e){return Promise.resolve().then((()=>Ap)).then((function(t){let{getAmplitudeFeatureFlag:n}=t;return n(e,"distro_multitrack_prototype")})).then((function(e){return"true"===e||"on"===e}))}function vN(e,t){return e?.mixdown.duration>=dN||t?.track.sample.duration>=dN}function bN(e){return lN(e)&&vN(e)&&aN(e)}async function yN(e,t){return(await e.getFormOptions({userId:t.id}).$promise).genres}function wN(){return[{label:"English",value:"EN"},{label:"Spanish",value:"ES"},{label:"Portuguese",value:"PT"},{label:"No lyrics / Instrumental",value:"ZXX"},{label:"Abkhazian",value:"AB"},{label:"Afar",value:"AA"},{label:"Afrikaans",value:"AF"},{label:"Akan",value:"AK"},{label:"Albanian",value:"SQ"},{label:"Amharic",value:"AM"},{label:"Arabic",value:"AR"},{label:"Aragonese",value:"AN"},{label:"Armenian",value:"HY"},{label:"Assamese",value:"AS"},{label:"Avaric",value:"AV"},{label:"Avestan",value:"AE"},{label:"Aymara",value:"AY"},{label:"Azerbaijani",value:"AZ"},{label:"Bambara",value:"BM"},{label:"Bashkir",value:"BA"},{label:"Basque",value:"EU"},{label:"Belarusian",value:"BE"},{label:"Bengali",value:"BN"},{label:"Bhojpuri",value:"BHO"},{label:"Bislama",value:"BI"},{label:"Bosnian",value:"BS"},{label:"Breton",value:"BR"},{label:"Bulgarian",value:"BG"},{label:"Burmese",value:"MY"},{label:"Cantonese",value:"YUE"},{label:"Catalan",value:"CA"},{label:"Central Khmer",value:"KM"},{label:"Chamorro",value:"CH"},{label:"Chechen",value:"CE"},{label:"Chichewa",value:"NY"},{label:"Chinese",value:"ZH"},{label:"Church Slavic",value:"CU"},{label:"Chuvash",value:"CV"},{label:"Cornish",value:"KW"},{label:"Corsican",value:"CO"},{label:"Cree",value:"CR"},{label:"Creole, English based",value:"CPE"},{label:"Creole, French based",value:"CPF"},{label:"Creole, Portuguese based",value:"CPP"},{label:"Croatian",value:"HR"},{label:"Czech",value:"CS"},{label:"Danish",value:"DA"},{label:"Divehi",value:"DV"},{label:"Dutch",value:"NL"},{label:"Dzongkha",value:"DZ"},{label:"Esperanto",value:"EO"},{label:"Estonian",value:"ET"},{label:"Ewe",value:"EE"},{label:"Faroese",value:"FO"},{label:"Fijian",value:"FJ"},{label:"Finnish",value:"FI"},{label:"French",value:"FR"},{label:"Fulah",value:"FF"},{label:"Gaelic",value:"GD"},{label:"Galician",value:"GL"},{label:"Georgian",value:"KA"},{label:"German",value:"DE"},{label:"Greek",value:"EL"},{label:"Guarani",value:"GN"},{label:"Gujarati",value:"GU"},{label:"Haitian Creole",value:"HAT"},{label:"Haitian",value:"HT"},{label:"Hausa",value:"HA"},{label:"Hebrew",value:"HE"},{label:"Herero",value:"HZ"},{label:"Hindi",value:"HI"},{label:"Hiri Motu",value:"HO"},{label:"Hungarian",value:"HU"},{label:"Icelandic",value:"IS"},{label:"Ido",value:"IO"},{label:"Igbo",value:"IG"},{label:"Indonesian",value:"ID"},{label:"Interlingua",value:"IA"},{label:"Interlingue",value:"IE"},{label:"Inuktitut",value:"IU"},{label:"Inupiaq",value:"IK"},{label:"Irish",value:"GA"},{label:"Italian",value:"IT"},{label:"Japanese",value:"JA"},{label:"Javanese",value:"JV"},{label:"Kalaallisut",value:"KL"},{label:"Kannada",value:"KN"},{label:"Kanuri",value:"KR"},{label:"Kashmiri",value:"KS"},{label:"Kazakh",value:"KK"},{label:"Kikuyu",value:"KI"},{label:"Kinyarwanda",value:"RW"},{label:"Kirghiz",value:"KY"},{label:"Komi",value:"KV"},{label:"Kongo",value:"KG"},{label:"Korean",value:"KO"},{label:"Kuanyama",value:"KJ"},{label:"Kurdish",value:"KU"},{label:"Lao",value:"LO"},{label:"Latin",value:"LA"},{label:"Latvian",value:"LV"},{label:"Limburgan",value:"LI"},{label:"Lingala",value:"LN"},{label:"Lithuanian",value:"LT"},{label:"Luba-Katanga",value:"LU"},{label:"Luganda",value:"LG"},{label:"Luxembourgish",value:"LB"},{label:"Macedonian",value:"MK"},{label:"Magahi",value:"MAG"},{label:"Maithili",value:"MAI"},{label:"Malagasy",value:"MG"},{label:"Malay",value:"MS"},{label:"Malayalam",value:"ML"},{label:"Maltese",value:"MT"},{label:"Manx",value:"GV"},{label:"Maori",value:"MI"},{label:"Marathi",value:"MR"},{label:"Marshallese",value:"MH"},{label:"Mongolian",value:"MN"},{label:"Nauru",value:"NA"},{label:"Navajo",value:"NV"},{label:"Ndonga",value:"NG"},{label:"Nepali",value:"NE"},{label:"North Ndebele",value:"ND"},{label:"Northern Sami",value:"SE"},{label:"Norwegian Bokml",value:"NB"},{label:"Norwegian Nynorsk",value:"NN"},{label:"Norwegian",value:"NO"},{label:"Occitan",value:"OC"},{label:"Ojibwa",value:"OJ"},{label:"Oriya",value:"OR"},{label:"Oromo",value:"OM"},{label:"Ossetian",value:"OS"},{label:"Pali",value:"PI"},{label:"Persian",value:"FA"},{label:"Polish",value:"PL"},{label:"Punjabi",value:"PA"},{label:"Pushto",value:"PS"},{label:"Quechua",value:"QU"},{label:"Romanian",value:"RO"},{label:"Romansh",value:"RM"},{label:"Rundi",value:"RN"},{label:"Russian",value:"RU"},{label:"Samoan",value:"SM"},{label:"Sango",value:"SG"},{label:"Sanskrit",value:"SA"},{label:"Sardinian",value:"SC"},{label:"Serbian",value:"SR"},{label:"Shona",value:"SN"},{label:"Sichuan Yi",value:"II"},{label:"Sindhi",value:"SD"},{label:"Sinhala",value:"SI"},{label:"Slovak",value:"SK"},{label:"Slovene",value:"SL"},{label:"Somali",value:"SO"},{label:"Sotho, Southern",value:"ST"},{label:"South Ndebele",value:"NR"},{label:"Sundanese",value:"SU"},{label:"Swahili",value:"SW"},{label:"Swati",value:"SS"},{label:"Swedish",value:"SV"},{label:"Tagalog",value:"TL"},{label:"Tahitian",value:"TY"},{label:"Tajik",value:"TG"},{label:"Tamil",value:"TA"},{label:"Tatar",value:"TT"},{label:"Telugu",value:"TE"},{label:"Thai",value:"TH"},{label:"Tibetan",value:"BO"},{label:"Tigrinya",value:"TI"},{label:"Tonga (Tonga Islands)",value:"TO"},{label:"Tsonga",value:"TS"},{label:"Tswana",value:"TN"},{label:"Turkish",value:"TR"},{label:"Turkmen",value:"TK"},{label:"Twi",value:"TW"},{label:"Uighur",value:"UG"},{label:"Ukrainian",value:"UK"},{label:"Urdu",value:"UR"},{label:"Uzbek",value:"UZ"},{label:"Venda",value:"VE"},{label:"Vietnamese",value:"VI"},{label:"Volapk",value:"VO"},{label:"Walloon",value:"WA"},{label:"Welsh",value:"CY"},{label:"Western Frisian",value:"FY"},{label:"Wolof",value:"WO"},{label:"Xhosa",value:"XH"},{label:"Yiddish",value:"YI"},{label:"Yoruba",value:"YO"},{label:"Zhuang",value:"ZA"},{label:"Zulu",value:"ZU"},{label:"No language listed",value:"NLL"}]}function $N(){return[{id:"Primary",name:"Primary"},{id:"Featuring",name:"Featuring"}]}function kN(){return[{id:"Choir",name:"Choir"},{id:"Conductor",name:"Conductor"},{id:"Engineer",name:"Engineer"},{id:"Ensemble",name:"Ensemble"},{id:"Mixer",name:"Mixer"},{id:"Orchestra",name:"Orchestra"},{id:"Producer",name:"Producer"},{id:"Remixer",name:"Remixer"},{id:"Soloist",name:"Soloist"},{id:"Writer",name:"Writer"}]}async function SN(e,t,n,o,r,i,a,s,l,c,u){const d=await gN(i);function m(){return t.tracksLoadingInPicker=!0,t.projectLoader.get().then((function(e){if(t.tracksLoadingInPicker=!1,t.tracks=t.tracks||[],t.tracks=t.tracks.concat(e),u)for(const e of t.tracks)t.releaseSongs.some((t=>t.revision.id===e.revision.id))&&(e.existInWizard=!0);return t.$applyAsync(),e})).catch((()=>{t.tracksLoadingInPicker=!1}))}t.projectLoader||(t.projectLoader=r.create(c.getDistroProjects,{id:i.id,limit:15})),t.selectedTracks=[],!t.tracksWatchSet&&d&&(t.$watch("tracks",(function(e){e&&(t.selectedTracks=e.filter((e=>e.selected)))}),!0),t.tracksWatchSet=!0),t.canOpenWizard=!1,new a({id:"multiTrackReleaseModal",templateUrl:"https://www.bandlab.com/web-app/distribution/partials/_distribution-multi-track-release-library-dbfacfb9.html",contentScope:{me:i,activeSegment:"tracks",isiOs:Jf,isMacOs:Xf,hasWebviewCookie:p(),canOpenWizard:()=>t.canOpenWizard,openWizard:()=>{t.openWizard()},selectedTracks:()=>t.selectedTracks,tracks:()=>t.tracks,tracksLoadingInPicker:()=>t.tracksLoadingInPicker,totalTracksCount:()=>u?t.selectedTracks.length+t.releaseSongs.length:t.selectedTracks.length,isMultitrackPrototype:()=>d,isEmpty:()=>{if(u)return t.tracks?!t.tracks.some((e=>!e.existInWizard)):void 0},btnLoading:()=>t.btnLoading,selectProjectsToReview:()=>{_N(e,t,n,i,s,0,null,u,null,n.params.redirect)},onSelect:function(e,n){e.preventDefault(),d?n.selected?n.selected=!1:n.selected=!0:t.selectedTracks=[n]},loadMore:m},onCreate:function(){t.tracks||m()},onCancel:function(){t.tracks.forEach((e=>{e.selected=!1})),t.selectedTracks=[],u||(t.releaseSongs=[]),t.btnLoading=!1}}).show()}async function _N(e,t,n,o,r,i,a,s,l,c){t.btnLoading=!0;const u=a?[a]:t.selectedTracks;if(t.releaseSongs||(t.releaseSongs=[]),t.releaseSongs=t.releaseSongs.concat(u.map((e=>({title:e.title,copyrightYear:new Date(e.createdOn).getFullYear(),language:"",explicitContent:"",artists:s?[{...t.release.artist,type:"Primary"}]:null,contributors:[],isrc:null,publisher:null,rightsOrg:null,mechanicalOrg:null,audioId:e.revision?.id||e.id,audioUrl:e.revision?.sample.url||e.mixdown?.file,duration:e.revision?.sample.duration||e.mixdown?.duration})))),s)return t.tracks.forEach((e=>{e.selected=!1})),t.releaseSongs.forEach((e=>{e.hasBeenReleasedBefore||=!1,e.revision||(e.revision={id:e.audioId,mixdown:{duration:e.duration,file:e.audioUrl,id:e.audioId},song:{id:e.audioId}})})),t.selectedTracks=[],void e.$broadcast("multiTrackReleaseModal","close");Promise.resolve().then((()=>rb)).then((function(e){let{logDistroReleaseStart:t}=e;t(u.length,l)}));const d={userId:o.id,artist:{name:o.name,links:{spotify:o.links.spotify,appleMusic:null}},releaseTitle:null,releaseDate:(new Date).toISOString(),genre:"",assets:t.releaseSongs,picture:{isDefault:!0},upc:null,label:null,catalogNumber:null},m=await r.create(d).$promise;if((Jf||Xf)&&p())return t.canOpenWizard=!0,t.openWizard=function(){const t=n.href("distributionCreate",{releaseId:m.id,"#":"bl_openModalWebview"},{absolute:!0});window.open(t,"_blank"),e.$broadcast("multiTrackReleaseModal","close")},void t.$applyAsync();if(p()){const t=n.href("distributionCreate",{releaseId:m.id,"#":"bl_openModalWebview"},{absolute:!0});e&&e.$broadcast("multiTrackReleaseModal","close"),window.open(t,"_blank")}else{const e={releaseId:m.id};n.params.redirect?e.redirect=n.params.redirect:c&&(e.redirect=encodeURIComponent(JSON.stringify(c))),n.go("distributionCreate",e)}}function PN(e){return{Released:"You will lose all release data, remove the release from streaming services as well as stop receiving royalties",InReview:"You will lose all release data as well as stop the review process",Rejected:e.isEditable?"You will lose all release data. If you want to submit for review again, you can edit release and try again.":"You will lose all your release data. To resubmit, create a new release for review."}[e.state]||"You will lose all release data"}function MN(e){return e.membership.isTrial?e.remainingReleases?`You have ${e.remainingReleases} ${1===e.remainingReleases?"release":"releases"} available for submission`:"You've hit the limit for release submissions":e.remainingReleases?`You have ${e.remainingReleases} ${1===e.remainingReleases?"release":"releases"} available this month`:"You've reached the release limit this month"}function TN(e){const t=e.map((e=>e.name||`${e.firstName} ${e.lastName}`));return t.length>0&&new Intl.ListFormat("en",{style:"narrow",type:"conjunction"}).format(t)}function CN(e,t,n,o,r,i,a,s,l){return new a({id:"distroReleaseOverviewModal",templateUrl:"https://www.bandlab.com/web-app/distribution/partials/_distribution-release-overview-modal-89fe385e.html",contentScope:{scope:t,type:o.type,hasWebviewCookie:p,pauseRelease:function(e){return l.submit({userId:i.id,releaseId:e.releaseId,state:"Paused"})},editRelease:function(o){function a(){const o={userId:i.id,releaseId:t.release.id,state:"Draft"};return l.updateState(o).$promise.then((function(){e.$broadcast("distroReleaseOverviewModal","close"),n.go("distributionEdit",{releaseId:t.release.id})})).catch((function(e){r.addNotification({title:e?.data.message,classList:"alert"})}))}if(o.isEditable&&"Rejected"===o.state)return a();new s({confirmLabel:"Edit",contentScope:{title:"Edit Release?",message:"<p>Editing this release will return it to Drafts and stop the review process. Youll need to resubmit and restart the review process.</p>"},onConfirm:a}).show()}},onCreate:function(){!async function(){t.genres=await yN(l,i),l.get({userId:i.id,releaseId:t.release.id}).$promise.then((async function(e){t.releaseDetails=e,t.$applyAsync()})).catch((t=>{e.$broadcast("distroReleaseOverviewModal","close"),r.addNotification({title:t?.data.message||"Unable to retrieve information. Please try again.",classList:"alert",autoclose:8e3})}))}()},onDestroy:function(){t.releaseDetails=null,n.go("dashboard.distribution.list",{releaseId:null})}}).show()}function EN(e){e.pause(),e.getCurrentSong().id=""}function IN(e){const t=e.injector().get("Me"),n=e.injector().get("Release"),o=e.injector().get("AppNotifications");if(!t.isAnonymous())return e.injector().getAsync("theRelease").then((function(e){if("InReview"===e.state)return"dashboard.distribution";if(!e.isEditable)return{state:"dashboard.distribution.list",params:{releaseId:e.releaseId}};if("Rejected"===e.state){const o={userId:t.id,releaseId:e.releaseId,state:"Draft"};n.updateState(o)}})).catch((function(e){return o.addNotification({title:e?.data?.message||"Something went wrong, please try again later",autoclose:8e3,classList:"warning"}),"dashboard.distribution"}))}function RN(e,t,n){const o=new URL(`https://www.bandlab.com/api/v1.3/users/${e}/promote/posts/${t}/music-web-campaigns`);return Uu.post(o.toString(),{json:n}).json()}function AN(e,t,n,o){const r=new URL(`https://www.bandlab.com/api/v1.3/users/${e}/promote/posts/${t}/music-web-campaigns/${n}`);return Uu.put(r.toString(),{json:o}).json()}function xN(){let{campaignType:e="MusicWeb",width:t=800,height:n=800,x:o=0,y:r=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Uu.post("https://www.bandlab.com/api/v1.3/promote/images".toString(),{json:{campaignType:e,width:t,height:n,x:o,y:r}}).json()}function LN(e){const t=new URL(`https://www.bandlab.com/api/v1.3/promote/images/${e}`);return Uu.get(t.toString()).then((t=>200===t.status?t.json():LN(e)))}function ON(e){let{url:t,image:n}=e;return fetch(t,{method:"PUT",headers:{"x-ms-blob-type":"BlockBlob","Content-Type":n.type},body:n.file})}function jN(e){let t="";switch(e){case"all":t="active,ended,cancelled,inreview,rejected,paid";break;case"inreview":t="inreview,paid";break;default:t=e}return t}function DN(e,t){let{status:n}=t;const o=new URL(`https://www.bandlab.com/api/v1.3/users/${e}/promote/campaigns?type=ProfileBandLab${n?`&status=${n}`:""}`);return Uu.get(o.toString()).json()}function NN(e){let{type:t,status:n,search:o,sort:r,limit:i=15,after:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=new URL(`https://www.bandlab.com/api/v1.3/users/${e}/promote/campaigns`),l=new URLSearchParams(Yk({type:t,status:jN(n),titleFilter:o,sortOrder:r,after:a,limit:i}));return Uu.get(s.toString(),{searchParams:l}).json()}function UN(e,t){const n="promote"===(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"promote")?new URL(`https://www.bandlab.com/api/v1.3/users/${e}/promote/music-web-campaigns/${t}`):new URL(`https://www.bandlab.com/api/v1.3/users/${e}/promote/boost-campaigns/${t}`);return Uu.get(n.toString()).json()}function FN(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"MusicWeb";if(p()){const t=new URL(`https://www.bandlab.com/api/v1.3/promote/prices?campaignType=${e}`);return Uu.get(t.toString()).json()}const t=new URL(`https://www.bandlab.com/api/v1.3/promote/reach-estimates?${e}`);return Uu.get(t.toString()).json()}const BN={class:"modal"},WN={class:"modal-content-small"},VN={class:"modal-header-new"},qN={class:"modal-header-title"},zN={class:"modal-content modal-content-new"},HN={class:"modal-confirm-message"},GN={class:"modal-confirm-buttons"},KN={key:0,class:"loader-spinner"},YN={key:1},JN={__name:"BoostPostPrivateModal",props:{onConfirm:{type:Function,required:!0},description:{type:String,default:"Please make your account public to boost this post. "}},emits:["closeModal"],setup(e,t){let{emit:n}=t;const o=e,r=n,i=Zo("$injector"),a=i.get("authService"),s=i.get("AppNotifications"),l=i.get("Identity"),c=Vt(!1);return(t,n)=>(si(),pi("aside",BN,[bi("div",WN,[bi("div",{class:"modal-close",onClick:n[0]||(n[0]=e=>t.$emit("closeModal"))}),bi("header",VN,[bi("h2",qN,me("Your account is private"),1)]),bi("div",zN,[bi("div",HN,me(e.description),1),bi("div",GN,[bi("button",{class:"modal-cancel button-scd-theme button-height-40 button-padding-fill button-rounded",type:"button",onClick:n[1]||(n[1]=e=>t.$emit("closeModal"))},me("Cancel"),1),bi("button",{class:ae(["modal-confirm button-dark button-height-40 button-padding-fill button-rounded",{disabled:c.value}]),type:"submit",onClick:n[2]||(n[2]=e=>(c.value=!0,void l.update({isPrivate:!1}).$promise.then((function(e){return s.addNotification({title:"Privacy settings updated",classList:"success",autoclose:8e3}),a.setMe(e)})).then((function(){o.onConfirm(),r("closeModal")})).finally((function(){c.value=!1}))))},[c.value?(si(),pi("span",KN)):_i("v-if",!0),c.value?_i("v-if",!0):(si(),pi("span",YN,me("Continue"),1))],2)])])])]))}},XN={components:{IconLoading:zn((()=>Promise.resolve().then((()=>Od))))},props:{loadMore:{type:Function,default:()=>Promise.resolve()}},setup(e){const t=Vt(!0),n=Vt(null);return ao((async function(){let o=Promise.resolve();new IntersectionObserver((()=>{t.value=!0,o=o.then((()=>e.loadMore())).finally((()=>{t.value=!1}))}),{root:null,rootMargin:"0px",threshold:0}).observe(n.value)})),{loading:t,sentinel:n}}},ZN=ld(XN,[["render",function(e,t,n,o,r,i){const a=vo("IconLoading");return si(),pi("div",{ref:"sentinel",style:te([{"margin-top":"-2px","min-height":"1px","min-width":"1px","grid-column":"1 / 4"},{height:o.loading?"78px":"initial"}])},[o.loading?(si(),mi(a,{key:0,size:26,class:"loader loader-spinning"})):_i("v-if",!0)],4)}]]),QN=Object.freeze(Object.defineProperty({__proto__:null,default:ZN},Symbol.toStringTag,{value:"Module"})),eU=new WeakMap,tU={mounted:nU,updated:nU,unmounted:function(e){eU.get(e).$destroy()}};function nU(e,t){let{value:{name:n,params:o}}=t;const r=angular.element(document.body).injector().get("$compile"),i=angular.element(document.body).injector().get("$rootScope");e.setAttribute("ui-state","name"),e.setAttribute("ui-state-params","params");const a=eU.get(e)??i.$new();a.name=n,a.params=o,r(e)(a),eU.set(e,a)}const oU=["width","height","aria-hidden"],rU=[bi("path",{fill:"currentColor",d:"M7.57 2.18A1 1 0 0 0 6 3v18a1 1 0 0 0 1.57.82l13-9a1 1 0 0 0 0-1.64z"},null,-1)],iU={__name:"play",props:{size:{type:Number,required:!0}},setup:e=>(t,n)=>(si(),pi("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none","aria-hidden":t.$attrs["aria-label"]||t.$attrs["aria-labelledby"]?null:"true"},rU,8,oU))},aU=Object.freeze(Object.defineProperty({__proto__:null,default:iU},Symbol.toStringTag,{value:"Module"})),sU={class:"promote-picker-post-card"},lU={class:"post-card row-gap-16"},cU={class:"post-card-header"},uU=["srcset","src","alt"],dU={class:"post-card-header-title user-badge-container"},pU={class:"post-card-header-subtitle"},mU=["datetime","title"],fU={key:0,class:"post-card-caption row-gap-16"},hU={class:"revision-description"},gU={class:"revision-description-text text-scd"},vU={class:"promote-picker-revision-tile"},bU={key:0,class:"revision-player-audio-overlay show-for-medium-down"},yU={class:"revision-player-audio-overlay-message revision-player-area-duration regular-12"},wU=bi("span",{class:"loader-spinner"},null,-1),$U={class:"revision-tile-player"},kU={class:"revision-tile-project-cover"},SU=["srcset","alt"],_U={class:"revision-player-header"},PU={class:"revision-player-titles"},MU={class:"revision-player-main-title revision-player-area-title"},TU={class:"revision-player-title semibold-18/24"},CU={class:"revision-player-subtitle revision-player-area-author"},EU={class:"regular-14/20"},IU={class:"revision-player-subtitle revision-player-area-duration regular-14/20"},RU={key:0,class:"revision-player-audio-overlay hide-for-medium-down"},AU={class:"revision-player-audio-overlay-message revision-player-area-duration regular-12"},xU=bi("span",{class:"loader-spinner"},null,-1),LU={class:"post-picker-revision-genre-label"},OU={class:"revision-player-counter"},jU={class:"semibold-12"},DU={__name:"PostPickerCard",props:{item:{type:Object,required:!0}},emits:["success"],setup(e,t){let{emit:n}=t;const o=n,r=e,i=Zo("$injector"),a=i.get("$state"),s=i.get("Me"),{username:l,picture:c}=s,u=Vt(!1);async function d(){u.value=!0,function(){const e=encodeURIComponent(JSON.stringify({name:"dashboard.promote"}));if(Bv(r.item.id,"promote_post_picker"),p()){const t=a.href("promoteWizard",{postId:r.item.id,redirect:e,"#":"bl_openModalWebview"},{absolute:!0});return o("success"),window.open(t,"_blank")}a.go("promoteWizard",{postId:r.item.id,redirect:e})}()}return(t,n)=>(si(),pi("article",sU,[bi("div",lU,[bi("header",cU,[Cn((si(),pi("a",null,[bi("img",{class:"post-card-avatar",srcset:`${Gt(c).url}48x48 1x, ${Gt(c).url}96x96 2x`,src:Gt(c).url,alt:e.item.creator.name,width:"48",height:"48"},null,8,uU)])),[[Gt(tU),{name:"user.feed",params:{username:Gt(l)}}]]),bi("div",null,[bi("div",dU,[Cn((si(),pi("a",null,[ki(me(e.item.creator.name),1)])),[[Gt(tU),{name:"user.feed",params:{username:Gt(l)}}]])]),bi("div",pU,[bi("time",{datetime:e.item.createdAt,title:Gt(FA)(e.item.createdAt)},[Cn((si(),pi("a",null,[ki(me(Gt(NA)(e.item.createdAt)),1)])),[[Gt(tU),{name:"post",params:{id:e.item.id}}]])],8,mU)])]),yi(Dd,{type:"button",size:"medium",color:"primary",padding:"default","is-loading":u.value,onClick:d},{default:Tn((()=>[ki(me("Boost"),1)])),_:1},8,["is-loading"])]),e.item?.revision?.description?(si(),pi("div",fU,[bi("p",hU,[bi("span",gU,me(e.item.revision.description),1)])])):_i("v-if",!0),bi("div",vU,[e.item.revision.duration?_i("v-if",!0):(si(),pi("div",bU,[bi("div",yU,[wU,bi("div",null,me("Processing"),1)])])),bi("div",$U,[bi("div",kU,[bi("img",{srcset:`${e.item.picture.url}96x96 1x, ${e.item.picture.url}192x192 2x`,alt:e.item.name,width:"96",height:"96"},null,8,SU)]),bi("header",_U,[bi("div",PU,[bi("div",MU,[bi("span",TU,me(e.item.name),1)]),bi("div",CU,[bi("span",EU,me(e.item.creator.name),1)]),bi("div",IU,me(Gt(KA)(e.item.revision.duration)),1),e.item.revision.duration?_i("v-if",!0):(si(),pi("div",RU,[bi("div",AU,[xU,bi("div",null,me("Processing"),1)])])),bi("div",{class:"revision-player-area-waveform promote-picker-card-labels",style:te([{display:"flex"},{"--dominant-color-background-hover":"#b1bbc5"}])},[bi("span",LU,me(e.item.genre),1),bi("div",OU,[yi(iU,{size:14}),bi("span",jU,me(Gt(LA)(e.item.revision.counters.plays)),1)])])])])])])])]))}},NU={__name:"LoaderNoContent",setup:e=>(e,t)=>(si(),mi(Ld,{class:"loader loader-no-content",size:24}))},UU=Object.freeze(Object.defineProperty({__proto__:null,default:NU},Symbol.toStringTag,{value:"Module"})),FU={class:"modal"},BU={class:"modal-header-new"},WU={class:"modal-header-title"},VU={key:2,class:"row-gap-24"},qU={__name:"PromotePostPicker",emits:["closeModal"],setup(e){const t=Zo("$injector"),n=t.get("Me"),o=t.get("AppNotifications");let r;const i=Vt(!0),a=Vt(!1),s=Vt([]),l=Vt(null),c=Vt(null),u=m(l),d=m(c);function p(){return a.value?Promise.resolve():function(e,t){let{after:n,limit:o=5}=t;const r=`https://www.bandlab.com/api/v1.3/users/${e}/song-posts`,i=new URLSearchParams(Yk({after:n,limit:o}));return Uu.get(r.toString(),{searchParams:i}).json()}(n.id,{after:r,limit:15}).then((function(e){i.value=!1,s.value=s.value.concat(e.data).filter((e=>e.revision)),a.value=e.paging.itemsCount<e.paging.limit,r=_.get(e,"paging.cursors.after",0)})).catch((function(){o.addNotification({title:"Something went wrong, please try again later",classList:"alert",autoclose:8e3})}))}function m(e){const t=Vt(!1),n=new IntersectionObserver((function(e){t.value=!e[0].isIntersecting}),{threshold:1});return Lr(e,(function(t){t?n.observe(e.value):n.disconnect()})),co((function(){n.disconnect()})),t}return ao(p),(e,t)=>(si(),pi("aside",FU,[bi("div",{class:"modal-close",onClick:t[0]||(t[0]=t=>e.$emit("closeModal"))}),bi("header",BU,[bi("h2",WU,me("Select your Post in BandLab"),1)]),bi("div",{class:ae(["promote-picker-modal-content modal-content-new-scroll modal-content-new modal-list promote-picker-modal-list scroll-divider",{"scroll-divider-bottom":Gt(d),"scroll-divider-top":Gt(u)}])},[i.value||s.value.length?_i("v-if",!0):(si(),mi(xI,{key:0},{"illustration-icon":Tn((e=>[yi(DI,{class:ae(e.class),size:40},null,8,["class"])])),title:Tn((()=>[ki(me("No posts found"),1)])),_:1})),i.value?(si(),mi(NU,{key:1})):_i("v-if",!0),bi("div",{ref_key:"sentinelTop",ref:l,class:"scroll-top-child"},null,512),s.value.length?(si(),pi("div",VU,[(si(!0),pi(ti,null,So(s.value,((n,o)=>(si(),mi(DU,{key:o,item:n,onSuccess:t[1]||(t[1]=t=>e.$emit("closeModal"))},null,8,["item"])))),128)),i.value?_i("v-if",!0):(si(),mi(ZN,{key:0,"load-more":p}))])):_i("v-if",!0),bi("div",{ref_key:"sentinelBottom",ref:c,class:"scroll-bottom-child"},null,512)],2)]))}},zU={costSteps:[4,8,12,20],costDefault:12,durationSteps:[1,2,3,4,5,6,7],durationDefault:4},HU={25:"periodic25",50:"periodic50"},GU={get:function(){return localStorage.getItem("campaignsList")},set:function(e){localStorage.setItem("campaignsList",e)},invalidate:function(){localStorage.removeItem("campaignsList")}};function KU(e){return"website-ad-campaigns"!==e.type&&!["all","active","ended","cancelled","inreview","rejected","paid"].includes(e.status)}function YU(e){return e.caption?e.caption:e.link?.title?e.link.title:`${e.type} posted ${VA(e.createdOn)}`}const JU={Video:'<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="none"><rect width="48" height="48" fill="currentColor" rx="4"/><path fill="#fff" fill-rule="evenodd" d="M23.26 20c-1.11-.73-2.6.06-2.6 1.39v5.22a1.67 1.67 0 0 0 2.6 1.39l3.91-2.61c1-.66 1-2.12 0-2.78l-3.91-2.6Zm-.93 1.39L26.25 24l-3.92 2.61v-5.22Z" clip-rule="evenodd"/><path fill="#fff" fill-rule="evenodd" d="M19 16.5a3.33 3.33 0 0 0-3.33 3.33v8.34c0 1.84 1.49 3.33 3.33 3.33h10c1.84 0 3.33-1.5 3.33-3.33v-8.34c0-1.84-1.49-3.33-3.33-3.33H19Zm-1.67 3.33c0-.92.75-1.66 1.67-1.66h10c.92 0 1.67.74 1.67 1.66v8.34c0 .92-.75 1.66-1.67 1.66H19c-.92 0-1.67-.74-1.67-1.66v-8.34Z" clip-rule="evenodd"/></svg>',Show:'<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="none"><rect width="48" height="48" fill="currentColor" rx="4"/><path fill="#fff" fill-rule="evenodd" d="M23.26 20c-1.11-.73-2.6.06-2.6 1.39v5.22a1.67 1.67 0 0 0 2.6 1.39l3.91-2.61c1-.66 1-2.12 0-2.78l-3.91-2.6Zm-.93 1.39L26.25 24l-3.92 2.61v-5.22Z" clip-rule="evenodd"/><path fill="#fff" fill-rule="evenodd" d="M19 16.5a3.33 3.33 0 0 0-3.33 3.33v8.34c0 1.84 1.49 3.33 3.33 3.33h10c1.84 0 3.33-1.5 3.33-3.33v-8.34c0-1.84-1.49-3.33-3.33-3.33H19Zm-1.67 3.33c0-.92.75-1.66 1.67-1.66h10c.92 0 1.67.74 1.67 1.66v8.34c0 .92-.75 1.66-1.67 1.66H19c-.92 0-1.67-.74-1.67-1.66v-8.34Z" clip-rule="evenodd"/></svg>',Link:'<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="none"><rect width="48" height="48" fill="currentColor" rx="4"/><path fill="#fff" d="M30.78 16.63a3.33 3.33 0 0 0-4.72 0l-2.08 2.09 1.18 1.17 2.08-2.08c.65-.65 1.7-.65 2.36 0l.59.6c.65.64.65 1.7 0 2.35l-4.72 4.71c-.65.65-1.7.65-2.35 0l-.6-.59-1.17 1.18.59.6a3.33 3.33 0 0 0 4.71 0l4.72-4.72a3.33 3.33 0 0 0 0-4.72l-.6-.59Z"/><path fill="#fff" d="M21.94 23.12c.65-.65 1.7-.65 2.35 0l.6.59 1.17-1.18-.59-.6a3.33 3.33 0 0 0-4.71 0l-4.13 4.13a3.33 3.33 0 0 0 0 4.72l.6.59a3.33 3.33 0 0 0 4.7 0l1.81-1.81-1.17-1.18-1.81 1.8c-.65.66-1.7.66-2.36 0l-.59-.58a1.67 1.67 0 0 1 0-2.36l4.13-4.12Z"/></svg>',Image:'<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="none"><rect width="48" height="48" fill="currentColor" rx="4"/><path fill="#fff" d="M23.17 20.67a1.67 1.67 0 1 1-3.34 0 1.67 1.67 0 0 1 3.34 0Z"/><path fill="#fff" d="M15.67 19c0-1.84 1.49-3.33 3.33-3.33h10c1.84 0 3.33 1.49 3.33 3.33v10c0 1.84-1.49 3.33-3.33 3.33H19A3.33 3.33 0 0 1 15.67 29V19Zm15 0c0-.92-.75-1.67-1.67-1.67H19c-.92 0-1.67.75-1.67 1.67v5.59l3.6 1.83 5.88-4.74a.83.83 0 0 1 .99-.04l2.87 1.94V19ZM17.33 29c0 .92.75 1.67 1.67 1.67h10c.92 0 1.67-.75 1.67-1.67v-3.41l-3.3-2.22-5.81 4.69c-.26.2-.6.24-.9.09l-3.33-1.7V29Z"/></svg>',Text:'<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="none"><rect width="48" height="48" fill="currentColor" rx="4"/><path fill="#fff" d="M15 18h18v2H15v-2ZM25 25H15v-2h10v2ZM15 30h14v-2H15v2Z"/></svg>'},XU={"all-campaigns":"PostBandLab,MusicWeb","boost-campaigns":"PostBandLab","website-ad-campaigns":"MusicWeb"};function ZU(e){const t=e.content||e.type;return{...e,headline:["ProfileBandLab","BandLabProfile","PostBandLab","BandLabPost"].includes(t)&&e.title||e.headline,icon:["PostBandLab","BandLabPost"].includes(t)&&JU[e.postType]}}function QU(e){return function(e){const{costSteps:t,costDefault:n,durationSteps:o,durationDefault:r}=e;return{costMin:Math.min(...t),costMax:Math.max(...t),costCheckpoints:[...t].sort(((e,t)=>e-t)),durationMin:Math.min(...o),durationMax:Math.max(...o),durationCheckpoints:[...o].sort(((e,t)=>e-t)),costDefault:n,durationDefault:r}}(e||zU)}async function eF(e){return Rp(e,"booster_campaign_params").then((function(e){return e.payload})).catch((()=>{}))}function tF(e,t){return new Promise((function(n,o){return e.isPrivate?_g(JN,{onConfirm:n,description:t},{onClose:o}):n()}))}function nF(e,t){return t.addNotification({title:e.title||"Boost Error",content:e.description,classList:"warning",autoclose:8e3})}function oF(e){return function(e){return"Ready"===e?.mixdown.status}(e)?function(e){return e?.mixdown.duration>=50}(e)?void 0:{title:"Your track is too short",description:{one:"Music tracks need to be longer than 50 second for boosting outside BandLab",other:"Music tracks need to be longer than 50 seconds for boosting outside BandLab"}[new Intl.PluralRules("en").select(50)]}:{title:"Boost Error",description:"Currently processing. Please wait a few seconds before trying again."}}function rF(){const e=Vt(!1),t=Vt(0),n=Vt(""),o=Vt(!1);let r=new AbortController;Nu.forEach(((e,t)=>{t.startsWith("https://ad.bandlab.io/v2/estimate")&&Nu.delete(t)}));const i=ay((function(i){let{budget:a,duration:s}=i;r.abort(),r=new AbortController,e.value=!0,function(e){let{budget:t,duration:n,signal:o,kyCache:r}=e;return Uu.post(`https://ad.bandlab.io/v2/estimate?budget=${t}&duration=${n}`,{json:{type:"bandlab_post",budget:t,duration:n},signal:o,kyCache:r}).json()}({budget:a,duration:s,signal:r.signal,kyCache:!0}).then((r=>{t.value=r.impressions,n.value=r.impressionsString,o.value=r.boostDiscountCampaign,e.value=!1})).catch((()=>{}))}),100);return{impressions:t,impressionsString:n,isEligibleForDiscount:o,loadingEstimates:e,syncEstimates:i}}function iF(e){const t=e.startsOn||e.createdAt,n=e.duration,o=new Date(t);let r=0;const i=new Date(o.getTime()+24*n*60*60*1e3).getTime()-Date.parse((new Date).toUTCString());return i>0&&(r=Math.ceil(i/864e5)),r}function aF(e){const t=new Date(e.startsOn||e.createdAt),n=new Date(t.getTime()+24*e.duration*60*60*1e3),o={day:"2-digit",month:"short"};var r;return`${new Intl.DateTimeFormat("en",o).format(t)}  ${t.getFullYear()!==n.getFullYear()?(r=n,new Intl.DateTimeFormat("en",{...o,year:"numeric"}).format(r)):new Intl.DateTimeFormat("en",o).format(n)}`}function sF(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return new Intl.NumberFormat("en",{maximumFractionDigits:t}).format(e/100)}function lF(e,t,n){return 100*As((e-n)/(t-n),0,1)}function cF(e,t,n){const o=[];for(let r=t;r<=e;r+=n)o.push(lF(r,e,t));return o}function uF(e,t){return new e({cancelLabel:"No",confirmLabel:"Yes",contentScope:{title:"Cancel this campaign?"},onConfirm:function(){t()}}).show()}function dF(e,t,n){return function(e,t){const n=new URL(`https://www.bandlab.com/api/v1.3/users/${e}/promote/campaigns/${t}`);return Uu.patch(n.toString(),{json:{state:"Cancelled"}}).json()}(t,n).then((()=>{e.addNotification({title:"Campaign cancelled",classList:"success",autoclose:8e3})})).catch((()=>{e.addNotification({title:navigator.onLine?"Something went wrong, please try again later":"Check your internet connection and try again",classList:"alert",autoclose:8e3})}))}function pF(e,t){tF(e,"Please make your account public to boost posts").then((function(){Fv(t),_g(qU,{})})).catch((()=>{}))}function mF(e,t){new e({templateUrl:"https://www.bandlab.com/web-app/distribution/partials/_picture-upload-2da43eba.html",id:"pictureUploadSuccess",contentScope:t}).show()}angular.module("bandlab.web").config(["$stateProvider",function(e){e.state("dashboard",{url:"/dashboard",templateUrl:"https://www.bandlab.com/web-app/dashboard/dashboard-layout-752cd3a6.html",redirectTo:"dashboard.overview"}).state("dashboard.overview",{url:"/overview",template:'<div id="vue"></div>',controllerAs:"vm",controller:["$compile","$element","$http","$injector","$rootScope","$scope","$state","Me",function(e,t,n,o,r,i,a,s){Promise.all([import("./chunk-9c911b54.js").then((e=>{let{mountOverview:t}=e;return t}))]).then((function(l){let[c]=l;const u=c(t[0].querySelector("#vue"),{$compile:e,$http:n,$injector:o,$rootScope:r,$state:a,Me:s});i.$on("$destroy",(function(){u.unmount()}))}))}]}).state("dashboard.crowdReview",{url:"/crowd-review?filter",templateUrl:"https://www.bandlab.com/web-app/dashboard/dashboard-crowd-review-9889961f.html",controller:["$scope","$stateParams","AppNotifications","Loader","Me","Modal","Song",function(e,t,n,o,r,i,a){var s,l=null,c=!1;const u=o.create(a.fromUserWithCursor,{id:r.id,limit:15});function d(){if(c)return Promise.resolve([]);const e=new URLSearchParams(Yk({after:l,limit:15,state:{pending:"Pending",completed:"Completed"}[t.filter]})).toString();return s=Uu.get(`https://www.bandlab.com/api/v1.3/users/${r.id}/crowd-review/submissions?${e}`).json().then((function(e){let{data:t,paging:n}=e;return l=n.cursors?.after,c=!l,t}))}function p(){return u.get().then((function(t){return e.projects=e.projects||[],e.projects=e.projects.concat(t),t}))}e.getReviewScoreColor=function(e){return e<7?e<4?"#f12c18":"#ffaf13":"#00c37d"},e.loadMore=function(){return e.infiniteScrollEnded?Promise.resolve():s=s.then((function(t){return e.infiniteScrollEnded=c,e.reviews=e.reviews||[],e.reviews=e.reviews.concat(t),e.$applyAsync(),d()}))},e.openLibrary=function(){new i({templateUrl:"https://www.bandlab.com/web-app/crowdreview/partials/_crowd-review-library-256cd61f.html",contentScope:{me:r,projects:()=>e.projects,selectProjectToReview:async e=>{const t=await async function(e){return await a.get({id:e.id}).$promise.then((e=>e.revision))}(e);if(!cN(t,null,n))return;const o=`https://www.reverbnation.com/c/bandlab/crowd_review/${r.id}?revision_id=${t.id}`;window.open(o,"_blank")},title:"Request review",loadMore:p},onCreate:function(){p()}}).show()},e.transformTimeAgoString=e=>`Submitted ${e}`,e.transformDateString=e=>`Submitted on ${e}`,d().then(e.loadMore)}]}).state("dashboard.distribution",{url:"/distribution?source",templateUrl:"https://www.bandlab.com/web-app/dashboard/views/dashboard-distribution-e36402a0.html",redirectTo:"dashboard.distribution.list",resolve:{theAccess:["Me","Release",function(e,t){return mN(e,t)}],theMembershipStatus:["Me","User",function(e,t){return fN(e,t)}],isPilotUser:["Me",function(e){return hN(e)}]},controller:["$injector","$rootScope","$scope","$state","isPilotUser","AppNotifications","Loader","Me","Modal","Release","Revision","Song","theAccess","theMembershipStatus",function(e,t,n,o,r,i,a,s,l,c,u,d,m,f){if("distro_landing"===o.params.source&&Promise.resolve().then((()=>rb)).then((function(e){let{logDistroLpDashboardOpen:t}=e;t()})),p()&&ql.shouldLogDistroReleaseDismiss){const e=JSON.parse(ql.shouldLogDistroReleaseDismiss);Promise.resolve().then((()=>rb)).then((function(t){let{logDistroReleaseDismiss:n}=t;n(e.state),ql.removeItem("shouldLogDistroReleaseDismiss")}))}n.isPilotUser=r,n.openLibrary=async function(){function e(e){new l({id:"reachedReleaseLimitModal",templateUrl:e,contentScope:{getMembership:function(){t.$broadcast("reachedReleaseLimitModal","close"),g()},createDraft:async function(){t.$broadcast("reachedReleaseLimitModal","close"),SN(t,n,o,0,a,s,l,c,0,d)}}}).show()}"Free"!==n.membership.plan||n.isPilotUser?"Free"===n.membership.plan&&n.isPilotUser?e("https://www.bandlab.com/web-app/distribution/partials/_distribution-package-selection-modal-06e6c654.html"):SN(t,n,o,0,a,s,l,c,0,d):e("https://www.bandlab.com/web-app/distribution/partials/_distribution-reached-release-limit-modal-f828b105.html")},n.openPaywall=g,n.remainingReleases=m.featureAccess.remainingReleases,n.membership=f,n.dayLeft=function(){const e=new Date,t=e.getMonth(),n=e.getFullYear(),o=new Date(n,t+1,0).getDate()-e.getDate();return Math.max(o,1)}(),n.membershipBannerTitle=MN(n),n.distributionHelpCenter=[{title:"What is digital music distribution and how does it work?",link:"https://help.bandlab.com/hc/en-us/articles/16970445724825-What-is-Distribution-"},{title:"Is digital distribution available during the BandLab Membership trial period?",link:"https://help.bandlab.com/hc/en-us/articles/26256626786201-Is-digital-distribution-available-during-the-BandLab-Membership-trial-period-"},{title:"How long does it take for my track to go live?",link:"https://help.bandlab.com/hc/en-us/articles/16970445724825#How%20long%20does%20it%20take%20for%20my%20track%20to%20go%20live?"},{title:"When and how will I receive my royalties?",link:"https://help.bandlab.com/hc/en-us/articles/16970445724825#When%20and%20how%20will%20I%20receive%20my%20royalties?"},{title:"How do I monitor my current releases?",link:"https://help.bandlab.com/hc/en-us/articles/16970445724825#How%20do%20I%20monitor%20my%20current%20releases?"}],n.gettingWallets=Xg(s.id).then((function(e){n.hasPayoutMethod=e.some((e=>"Tipalti"===e.gateway))})),Wg(s.id).then((function(e){n.earningsBalance=DA(e.balances.find((e=>"USD"===e.currency))?.balanceIncludingPendingPayment||0),n.$applyAsync()}));const{startPurchaseFlow:h}=tN(e,n,(function(e){n.membership=e&&"Free"!==e}));function g(){p()?h("distro","artist_services"):new l({id:"paywallModal",templateUrl:"https://www.bandlab.com/web-app/membership/partials/_paywall-modal-ee6789e7.html",contentScope:{productAttribution:"distro",productAttributionGroup:"artist_services"}}).show()}}]}).state("dashboard.distribution.earnings",{url:"/earnings",views:{list:{controller:["$element","$injector","$scope",function(e,t,n){const o=import("./chunk-c5009dc3.js").then((function(o){let{mountDistributionEarnings:r}=o;return r(e[0],{$injector:t,$scope:n})}));n.$on("$destroy",(async function(){(await o).unmount()}))}]}}}).state("dashboard.distribution.list",{url:"/:category?releaseId",reloadOnSearch:!1,params:{category:"all"},resolve:{isPilotUser:["Me",function(e){return hN(e)}]},views:{list:{templateUrl:"https://www.bandlab.com/web-app/distribution/views/releases-list-2f5f78d3.html",controller:"DistributionReleasesCtrl"}}}).state("dashboard.fanReach",{url:"/fan-reach",templateUrl:"https://www.bandlab.com/web-app/dashboard/views/dashboard-fan-reach-c975879a.html",resolve:{theFanReachStatus:["Me","User",function(e,t){return t.getFanReachStatus({userId:e.id}).$promise}],theMembershipStatus:["Me","User",function(e,t){return t.getMembershipStatus({userId:e.id,fallbackToFree:!0}).$promise}]},controller:["$cacheFactory","$injector","$scope","$state","AppNotifications","Me","Modal","theFanReachStatus","theMembershipStatus",function(e,t,n,o,r,i,a,s,l){e.get("FanReach")?.removeAll(),n.state=o,n.fanReachNav=[{state:"dashboard.fanReach.sent",stateName:"Sent",iconName:"mail"},{state:"dashboard.fanReach.drafts",stateName:"Drafts",iconName:"mail-draft"},{state:"dashboard.fanReach.myFans",stateName:"Fans",iconName:"users"},{state:"dashboard.fanReach.settings",stateName:"Settings",iconName:"settings"}],n.state=o,n.status=s,n.bannerIconCampaignCounter=1-n.status.featureAccess.remainingCampaigns+"/1",n.isActivating=!1,n.membership=l,n.openCampaignCreator=function(){if(n.status.featureAccess.isActivated)if(n.status.permissions.reachSubscribers)if(p()){const e=o.href("fanReachCreate",{"#":"bl_openModalWebview"},{absolute:!0});window.open(e,"_blank")}else o.go("fanReachCreate");else r.addNotification({title:"Unable to create campaign",content:"You need to have at least one subscriber to access this feature",classList:"alert",autoclose:8e3});else new a({id:"fanreachActivateModal",templateUrl:"https://www.bandlab.com/web-app/fanreach/partials/_fanreach-activate-modal-d44c9632.html",class:"artist-services-usps-modal-root"}).show()},n.activateFanReach=function(){import("./chunk-3652b411.js").then((function(e){let{handleActivateFanReach:n}=e;n(i.id,t)}))};const{startPurchaseFlow:c}=tN(t,n,(function(e){n.membership=e&&"Free"!==e}));n.getMembership=function(){p()?c("fan_reach","artist_services"):new a({id:"paywallModal",templateUrl:"https://www.bandlab.com/web-app/membership/partials/_paywall-modal-ee6789e7.html",contentScope:{productAttribution:"fan_reach",productAttributionGroup:"artist_services"}}).show()},n.$on("$fanReach:statusToggled",(function(e,t){n.isActivating=t.isActivating})),n.$on("$fanReach:statusChanged",(function(t,o){n.isActivating=!1,n.status={...o.response},e.get("FanReach")?.removeAll()}))}],redirectTo:"dashboard.fanReach.sent"}).state("dashboard.fanReach.myFans",{url:"/my-fans",templateUrl:"https://www.bandlab.com/web-app/fanreach/views/fanreach-my-fans-bd1d4a69.html",controller:"FanReachMyFansCtrl"}).state("dashboard.fanReach.sent",{url:"/sent-campaigns",templateUrl:"https://www.bandlab.com/web-app/fanreach/views/fanreach-sent-campaigns-1203527a.html",controller:["$scope","$state","AppNotifications","Me","Modal",function(e,t,n,o,r){function i(){new r({id:"fanreachActivateModal",templateUrl:"https://www.bandlab.com/web-app/fanreach/partials/_fanreach-activate-modal-d44c9632.html",class:"artist-services-usps-modal-root"}).show()}import("./chunk-91644797.js").then((function(r){let{mountFanReachSentEmails:a}=r;const s=a(document.querySelector("#fanReachSentEmailsVue"),{$scope:e,$state:t,AppNotifications:n,fanReachStatus:e.$parent.status,Me:o,showActivateModal:i});e.$on("$destroy",(function(){s.unmount()})),e.$on("handleCreateCampaign",(function(){e.$parent.openCampaignCreator()}))}))}]}).state("dashboard.fanReach.drafts",{url:"/drafts",template:'<div id="fanReachDraftEmailsVue" class="fanreach-drafts-layout"></div>',controller:["$scope","$state","AppNotifications","Me","Modal",function(e,t,n,o,r){function i(){new r({id:"fanreachActivateModal",templateUrl:"https://www.bandlab.com/web-app/fanreach/partials/_fanreach-activate-modal-d44c9632.html",class:"artist-services-usps-modal-root"}).show()}import("./chunk-91644797.js").then((function(r){let{mountFanReachDraftEmails:a}=r;const s=a(document.querySelector("#fanReachDraftEmailsVue"),{$scope:e,$state:t,AppNotifications:n,fanReachStatus:e.$parent.status,Me:o,showActivateModal:i});e.$on("$destroy",(function(){s.unmount()})),e.$on("handleCreateCampaign",(function(){e.$parent.openCampaignCreator()}))}))}]}).state("dashboard.fanReach.settings",{url:"/settings",templateUrl:"https://www.bandlab.com/web-app/fanreach/views/fanreach-settings-2858b72c.html",controller:"FanReachSettingsCtrl"}).state("dashboard.boostRedirect",{url:"/promote",redirectTo:"dashboard.promote"}).state("dashboard.promote",{url:"/boost",templateUrl:"https://www.bandlab.com/web-app/dashboard/views/dashboard-promote-27428ad8.html",controller:["$scope","$state","Me",function(e,t,n){e.search=t.params.search,e.sort=t.params.sort,e.openPostPicker=function(){pF(n)},e.promoteSideNav=[{state:'dashboard.promote.list({type: "all-campaigns"})',stateName:"All Campaigns",stateCategory:"all-campaigns",imgSrc:"https://www.bandlab.com/web-app/images/promote/all-campaigns-312ddfc2a7.svg"},{state:'dashboard.promote.list({type: "boost-campaigns"})',stateName:"Boost",stateCategory:"boost-campaigns",imgSrc:"https://www.bandlab.com/web-app/images/promote/boost-campaigns-2ab267147c.svg"},{state:'dashboard.promote.list({type: "website-ad-campaigns"})',stateName:"Website Ad",stateCategory:"website-ad-campaigns",imgSrc:"https://www.bandlab.com/web-app/images/promote/website-ad-campaigns-67bbb5e723.svg"}],e.$watch("search",(function(e,t){e!==t&&o()})),e.$watch("sort",(function(e,t){e!==t&&r()}));const o=ay((function(){e.setSearchState(!0),r()}),500);function r(){t.go("dashboard.promote.list",{search:e.search,sort:e.sort})}e.setSortState=function(){e.sort=e.sort?"":"asc"},e.setSearchState=function(t){e.searchIsActive=t,e.$applyAsync()},e.resetSearch=function(){e.search="",e.$applyAsync()}}],redirectTo:"dashboard.promote.list"}).state("dashboard.promote.picker",{url:"/post-picker",redirectTo:"dashboard.promote.list.picker"}).state("dashboard.promote.list",{url:"/campaigns/:type?status&search&sort",params:{type:"all-campaigns",status:{value:"all"},squash:!0},template:'<div id="promoteCampaignsPanel"></div>',controller:["$injector","$scope","$stateParams","AppNotifications","Me",function(e,t,n,o,r){import("./chunk-0a669517.js").then((function(i){let{mountCampaignsPanel:a}=i;const s=a(document.querySelector("#promoteCampaignsPanel"),{$stateParams:n,$injector:e,AppNotifications:o,Me:r,setSearchState:t.setSearchState,resetSearch:t.resetSearch});t.$on("$destroy",(function(){s.unmount()}))}))}]}).state("dashboard.promote.list.picker",{url:"/post-picker"})}]),angular.module("bandlab.distribution",[]),angular.module("bandlab.distribution").controller("DistributionCtrl",["$injector","$location","$rootScope","$scope","$state","AppNotifications","ConfirmModal","isPilotUser","Loader","Me","Modal","Player","PlayerHistory","Release","Revision","Song","theAccess","theGenres","theMembershipStatus","theRelease","theReleaseSongs",function(e,t,n,o,r,i,a,s,l,c,u,d,m,f,h,g,v,b,y,w,$){o.genres=b,o.release=w,o.releaseSongs=$,o.isPilotUser=s,o.hasWebviewCookie=p(),o.isDistroEdit=r.includes("distributionEdit"),o.membership=y,o.remainingReleases=v.featureAccess.remainingReleases,o.membershipBannerTitle=MN(o),o.soundTimeFormat=KA;const k=t.url();m.setCurrentPageContext({loader:null,url:k,contentSource:_p(r)}),m.pushQueueSongs([],k,!0),o.genres.some((e=>e.id===o.release.genre))||(o.release.genre=""),gN(c).then((e=>{o.isMultitrackPrototype=e}));for(const e of o.releaseSongs)e.originalTitle=e.title,e.revision={id:e.audioId,mixdown:{duration:KA(e.duration),file:e.audioUrl,id:e.audioId},song:{id:e.audioId}};o.getGenreName=function(e){return o.genres.find((t=>t.id===e))?.name},o.languages=[{label:"English",value:"EN"},{label:"Spanish",value:"ES"},{label:"Portuguese",value:"PT"},{label:"No lyrics / Instrumental",value:"ZXX"},{label:"Abkhazian",value:"AB"},{label:"Afar",value:"AA"},{label:"Afrikaans",value:"AF"},{label:"Akan",value:"AK"},{label:"Albanian",value:"SQ"},{label:"Amharic",value:"AM"},{label:"Arabic",value:"AR"},{label:"Aragonese",value:"AN"},{label:"Armenian",value:"HY"},{label:"Assamese",value:"AS"},{label:"Avaric",value:"AV"},{label:"Avestan",value:"AE"},{label:"Aymara",value:"AY"},{label:"Azerbaijani",value:"AZ"},{label:"Bambara",value:"BM"},{label:"Bashkir",value:"BA"},{label:"Basque",value:"EU"},{label:"Belarusian",value:"BE"},{label:"Bengali",value:"BN"},{label:"Bhojpuri",value:"BHO"},{label:"Bislama",value:"BI"},{label:"Bosnian",value:"BS"},{label:"Breton",value:"BR"},{label:"Bulgarian",value:"BG"},{label:"Burmese",value:"MY"},{label:"Cantonese",value:"YUE"},{label:"Catalan",value:"CA"},{label:"Central Khmer",value:"KM"},{label:"Chamorro",value:"CH"},{label:"Chechen",value:"CE"},{label:"Chichewa",value:"NY"},{label:"Chinese",value:"ZH"},{label:"Church Slavic",value:"CU"},{label:"Chuvash",value:"CV"},{label:"Cornish",value:"KW"},{label:"Corsican",value:"CO"},{label:"Cree",value:"CR"},{label:"Creole, English based",value:"CPE"},{label:"Creole, French based",value:"CPF"},{label:"Creole, Portuguese based",value:"CPP"},{label:"Croatian",value:"HR"},{label:"Czech",value:"CS"},{label:"Danish",value:"DA"},{label:"Divehi",value:"DV"},{label:"Dutch",value:"NL"},{label:"Dzongkha",value:"DZ"},{label:"Esperanto",value:"EO"},{label:"Estonian",value:"ET"},{label:"Ewe",value:"EE"},{label:"Faroese",value:"FO"},{label:"Fijian",value:"FJ"},{label:"Finnish",value:"FI"},{label:"French",value:"FR"},{label:"Fulah",value:"FF"},{label:"Gaelic",value:"GD"},{label:"Galician",value:"GL"},{label:"Georgian",value:"KA"},{label:"German",value:"DE"},{label:"Greek",value:"EL"},{label:"Guarani",value:"GN"},{label:"Gujarati",value:"GU"},{label:"Haitian Creole",value:"HAT"},{label:"Haitian",value:"HT"},{label:"Hausa",value:"HA"},{label:"Hebrew",value:"HE"},{label:"Herero",value:"HZ"},{label:"Hindi",value:"HI"},{label:"Hiri Motu",value:"HO"},{label:"Hungarian",value:"HU"},{label:"Icelandic",value:"IS"},{label:"Ido",value:"IO"},{label:"Igbo",value:"IG"},{label:"Indonesian",value:"ID"},{label:"Interlingua",value:"IA"},{label:"Interlingue",value:"IE"},{label:"Inuktitut",value:"IU"},{label:"Inupiaq",value:"IK"},{label:"Irish",value:"GA"},{label:"Italian",value:"IT"},{label:"Japanese",value:"JA"},{label:"Javanese",value:"JV"},{label:"Kalaallisut",value:"KL"},{label:"Kannada",value:"KN"},{label:"Kanuri",value:"KR"},{label:"Kashmiri",value:"KS"},{label:"Kazakh",value:"KK"},{label:"Kikuyu",value:"KI"},{label:"Kinyarwanda",value:"RW"},{label:"Kirghiz",value:"KY"},{label:"Komi",value:"KV"},{label:"Kongo",value:"KG"},{label:"Korean",value:"KO"},{label:"Kuanyama",value:"KJ"},{label:"Kurdish",value:"KU"},{label:"Lao",value:"LO"},{label:"Latin",value:"LA"},{label:"Latvian",value:"LV"},{label:"Limburgan",value:"LI"},{label:"Lingala",value:"LN"},{label:"Lithuanian",value:"LT"},{label:"Luba-Katanga",value:"LU"},{label:"Luganda",value:"LG"},{label:"Luxembourgish",value:"LB"},{label:"Macedonian",value:"MK"},{label:"Magahi",value:"MAG"},{label:"Maithili",value:"MAI"},{label:"Malagasy",value:"MG"},{label:"Malay",value:"MS"},{label:"Malayalam",value:"ML"},{label:"Maltese",value:"MT"},{label:"Manx",value:"GV"},{label:"Maori",value:"MI"},{label:"Marathi",value:"MR"},{label:"Marshallese",value:"MH"},{label:"Mongolian",value:"MN"},{label:"Nauru",value:"NA"},{label:"Navajo",value:"NV"},{label:"Ndonga",value:"NG"},{label:"Nepali",value:"NE"},{label:"North Ndebele",value:"ND"},{label:"Northern Sami",value:"SE"},{label:"Norwegian Bokml",value:"NB"},{label:"Norwegian Nynorsk",value:"NN"},{label:"Norwegian",value:"NO"},{label:"Occitan",value:"OC"},{label:"Ojibwa",value:"OJ"},{label:"Oriya",value:"OR"},{label:"Oromo",value:"OM"},{label:"Ossetian",value:"OS"},{label:"Pali",value:"PI"},{label:"Persian",value:"FA"},{label:"Polish",value:"PL"},{label:"Punjabi",value:"PA"},{label:"Pushto",value:"PS"},{label:"Quechua",value:"QU"},{label:"Romanian",value:"RO"},{label:"Romansh",value:"RM"},{label:"Rundi",value:"RN"},{label:"Russian",value:"RU"},{label:"Samoan",value:"SM"},{label:"Sango",value:"SG"},{label:"Sanskrit",value:"SA"},{label:"Sardinian",value:"SC"},{label:"Serbian",value:"SR"},{label:"Shona",value:"SN"},{label:"Sichuan Yi",value:"II"},{label:"Sindhi",value:"SD"},{label:"Sinhala",value:"SI"},{label:"Slovak",value:"SK"},{label:"Slovene",value:"SL"},{label:"Somali",value:"SO"},{label:"Sotho, Southern",value:"ST"},{label:"South Ndebele",value:"NR"},{label:"Sundanese",value:"SU"},{label:"Swahili",value:"SW"},{label:"Swati",value:"SS"},{label:"Swedish",value:"SV"},{label:"Tagalog",value:"TL"},{label:"Tahitian",value:"TY"},{label:"Tajik",value:"TG"},{label:"Tamil",value:"TA"},{label:"Tatar",value:"TT"},{label:"Telugu",value:"TE"},{label:"Thai",value:"TH"},{label:"Tibetan",value:"BO"},{label:"Tigrinya",value:"TI"},{label:"Tonga (Tonga Islands)",value:"TO"},{label:"Tsonga",value:"TS"},{label:"Tswana",value:"TN"},{label:"Turkish",value:"TR"},{label:"Turkmen",value:"TK"},{label:"Twi",value:"TW"},{label:"Uighur",value:"UG"},{label:"Ukrainian",value:"UK"},{label:"Urdu",value:"UR"},{label:"Uzbek",value:"UZ"},{label:"Venda",value:"VE"},{label:"Vietnamese",value:"VI"},{label:"Volapk",value:"VO"},{label:"Walloon",value:"WA"},{label:"Welsh",value:"CY"},{label:"Western Frisian",value:"FY"},{label:"Wolof",value:"WO"},{label:"Xhosa",value:"XH"},{label:"Yiddish",value:"YI"},{label:"Yoruba",value:"YO"},{label:"Zhuang",value:"ZA"},{label:"Zulu",value:"ZU"},{label:"No language listed",value:"NLL"}],o.$on("topBarExit",(function(){o.updateDistributionForm(o.currentStepNumber,!0).then((()=>{if(p())return r.go(".",{"#":"bl_closeWebView"});if(Promise.resolve().then((()=>rb)).then((function(e){let{logDistroReleaseDismiss:t,logDistroRating:n}=e;t("Distro Release - Closed/Dismissed"),document.addEventListener("ratingEvent",(function e(t){n(t.detail),document.removeEventListener("ratingEvent",e)}))})),r.params.redirect){const{name:e,params:{postId:t}={}}=JSON.parse(decodeURIComponent(r.params.redirect));return r.go(e,{id:t})}return r.go("dashboard.distribution")}))})),o.currentStepNumber=1,o.stepsList=[{step:1,name:"Release Details",title:"Tell us about your release",description:'Share your artist name, genre, and more release details with us to help us find the best audience for your music. Learn more in our <a href="https://bnd.la/digital-distribution-help" target="_blank" rel="noopener" class="text-prm">Help Center</a>.',errors:null},{step:2,name:"Songs",title:"Build Your Release",description:'\n          To avoid copyright infringement, make sure you own 100% of the music you submit, or have the required licenses.\n          <br><br>\n          The track must not contain a sample of a major thirdparty artist or a cover of a song.\n          <br><br>\n          Lastly, do not include featured artists or contributors when filling in your track title.\n          <div class="hide-for-medium-down"><br></div>\n          For more information, head to our <a href="https://bnd.la/digital-distribution-help" target="_blank" rel="noopener" class="text-prm">Help Center</a>.\n        ',errors:null},{step:3,name:"Cover Art",title:"Add Your Cover Art",description:"\n          Paint a picture with your cover image, but do follow these steps to ensure it gets approved:\n          <br><br>\n          <ul>\n            <li>Every release should have a unique cover artwork</li>\n            <li>Use a high quality visual (1400 x 1400 px min, 6000 x 6000px max)</li>\n            <li>Make sure there are no references to drugs, nudity, or extreme violence</li>\n            <li>Only include text that matches the release details you provided, limited to release name, artist name, featured artist names, and record label</li>\n            <li>Only include visuals and logos that you own the rights to</li>\n          </ul>\n        ",errors:null},{step:4,name:"Review",title:"Review your release details",description:'Youre almost there! Review the details you\'ve provided, and hit the "back" button to make edits if necessary.'}];const S=new MutationObserver((function(e){const t=document.getElementById("distroTrackDropdown");for(const n of e)"childList"===n.type&&(t?document.body.classList.add("has-distro-track-dropdown"):document.body.classList.remove("has-distro-track-dropdown"))}));function _(){o.hasValidationError=0===o.releaseSongs.length||o.releaseSongs.some((e=>!1===e.isValid||!0===e.isDeleted||!0===e.pendingValidation))}function P(e){e.data.errorData&&Object.keys(e.data.errorData).forEach((t=>{e.data.errorData[t]&&"artist"===t?(o.form.artistName.$setValidity("valid",!e.data.errorData[t].name),o.form.artistName.errorMessage=e.data.errorData[t].name,o.form.subform.artistApple&&e.data.errorData[t].links&&(o.form.subform.artistApple.$setValidity("valid",!e.data.errorData[t].links.appleMusic),o.form.subform.artistApple.errorMessage=e.data.errorData[t].links.appleMusic),o.form.subform.artistSpotify&&e.data.errorData[t].links&&(o.form.subform.artistSpotify.$setValidity("valid",!e.data.errorData[t].links.spotify),o.form.subform.artistSpotify.errorMessage=e.data.errorData[t].links.spotify)):e.data.errorData[t]&&"assets"!==t&&(o.form[t].$setValidity("valid",!e.data.errorData[t]),o.form[t].errorMessage=e.data.errorData[t]),o.$applyAsync()}))}S.observe(document.body,{childList:!0,subtree:!0}),o.$on("$destroy",(function(){S.disconnect()})),o.$watch("form.$invalid",(function(e){o.hasValidationError=e})),o.$watchGroup(["form","release.error","release.rejectedReasons"],(function(){var e;o.isDistroEdit&&o.form&&(P({data:{errorData:o.release.errors}}),(e=o.release.rejectedReasons)&&Object.keys(e).forEach((t=>{if(e[t]&&"artist"===t){for(const n of e[t])if("Error"===n.level&&!n.isAddressed){o.form.artistName.$setValidity("valid",n.isAddressed);break}}else if(e[t]&&"assets"!==t&&"coverArt"!==t&&"release"!==t)for(const n of e[t])if("Error"===n.level&&!n.isAddressed){o.form[t].$setValidity("valid",n.isAddressed);break}o.$applyAsync()})))})),o.$watch("form.$pending",(function(e){o.pendingValidation=e,o.release.rejectedReasons&&Object.keys(o.release.rejectedReasons).forEach((e=>{if(o.release.rejectedReasons[e]&&"artist"===e&&o.form){for(const t of o.release.rejectedReasons[e])if("Error"===t.level&&o.form.artistName.$dirty){t.isAddressed=!0;break}}else if(o.release.rejectedReasons[e]&&o.form&&"assets"!==e&&"coverArt"!==e&&"release"!==e)for(const t of o.release.rejectedReasons[e])if("Error"===t.level&&o.form[e].$dirty){t.isAddressed=!0;break}o.$applyAsync()}))})),o.pictureInitialized=!1,o.$watch("release.picture",(function(e){e&&!e.isDefault&&(o.hasValidationError=!1,o.hasConfirmedCoverArtCompliance=!1),o.pictureInitialized&&!o.release.rejectedReasons?.coverArt[0]?.isAddressed&&(o.release.rejectedReasons.coverArt[0].isAddressed=!0),o.pictureInitialized=!0}),!0),o.$watch("releaseSongs",(function(){_(),function(){if(1===o.releaseSongs.length&&(o.releaseSongs[0].title=w.releaseTitle,o.releaseSongs[0].version=w.version,o.releaseSongs[0].rejectedReasons)){for(const e of o.releaseSongs[0].rejectedReasons.title)e.isAddressed=!0;for(const e of o.releaseSongs[0].rejectedReasons.version)e.isAddressed=!0}}()}),!0),o.$watch("currentStepNumber",(function(e){1===e&&o.form?o.hasValidationError=o.form.$invalid:2===e?_():3===e&&(!o.release.picture||o.release.picture.isDefault||o.release.rejectedReasons?.coverArt[0]&&!o.release.rejectedReasons.coverArt[0].isAddressed)&&(o.hasValidationError=!0)})),o.removeTrack=function(e){new a({confirmLabel:"Remove",toFocusConfirm:!0,contentScope:{title:"Remove the track?",message:"You will lose all track information entered for the release"},onConfirm:()=>{if(o.tracks)for(const e of o.tracks)o.releaseSongs.some((t=>t.revision.id===e.revision.id))&&(e.existInWizard=!1);o.releaseSongs=o.releaseSongs.filter((t=>t.revision.id!==e.revision.id)),d.getCurrentSong().id===e.audioId&&d.pause()}}).show()},o.removeDeletedTrack=function(e){o.releaseSongs=o.releaseSongs.filter((t=>t.revision.id!==e.revision.id))},o.openDeletedTrackInfoModal=function(e){window.innerWidth<768&&_g(zn((()=>import("./chunk-b1f77df0.js"))),{size:"small",title:e,subtitle:"You cannot continue the release process with the deleted track. Recover it or select another track."})},o.openTrack=function(e){h.get({id:e}).$promise.then((function(e){const t=r.href("track",{id:e.postId},{absolute:!0});window.open(t,"_blank")}))},o.openLibrary=function(){SN(n,o,r,0,l,c,u,f,0,g,!0)},o.addArtistSpotify=function(e){e.links||(e.links={}),e.links.spotify=""},o.removeArtistSpotify=function(e){e.links.spotify=null},o.addArtistAppleMusic=function(e){e.links||(e.links={}),e.links.appleMusic=""},o.removeArtistAppleMusic=function(e){e.links.appleMusic=null},o.checkLyrics=function(e){"ZXX"===e.language&&(e.contributors=e.contributors.filter((e=>"Lyricist"!==e.type)),e.explicitContent=null)},o.setFieldValid=function(e,t,n){e[t]&&e[t].$setValidity("valid",!0),n&&n[t].forEach((e=>{e.isAddressed=!0}))},o.getFeaturing=function(e){return e.filter((e=>"Featuring"===e.type))},o.getFeaturingArtists=function(e){const t=e.filter((e=>"Featuring"===e.type)).map((e=>e.name||`${e.firstName} ${e.lastName}`));return t.length>0&&`(feat. ${new Intl.ListFormat("en",{style:"long",type:"conjunction"}).format(t)})`},o.$on("$releasePicture:changed",(function(e,t){let{data:n}=t;o.release.picture=n,o.release.picture.isDefault=!1}));let M=Promise.resolve();const{startPurchaseFlow:T}=tN(e,o,C);function C(){y.plan="Basic"}o.openCoverArtComplianceModal=function(){new u({id:"coverArtComplianceModal",templateUrl:"https://www.bandlab.com/web-app/distribution/partials/_distribution-cover-art-compliance-modal-d5cf687c.html",contentScope:{picture:o.release.picture,confirmCoverArt:o.confirmCoverArt}}).show()},o.confirmCoverArt=function(){n.$broadcast("coverArtComplianceModal","close"),o.hasConfirmedCoverArtCompliance=!0,o.updateDistributionForm(4)},o.updateDistributionForm=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function a(){o.releaseSongErrors=o.release.errors?.assets||null,o.releaseSongs.forEach(((e,t)=>{e.error=o.release.errors?o.release.errors.assets[t]:null})),o.$applyAsync()}function l(){o.releaseSongRejectedReasons=o.release.rejectedReasons?.assets||null,o.releaseSongs.forEach(((e,t)=>{e.rejectedReasons=o.release.rejectedReasons?o.release.rejectedReasons.assets[t]:null})),o.$applyAsync()}if(o.submitButtonDisabled=!1,1===o.currentStepNumber){try{await function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];for(const e of o.releaseSongs)e.artists[0]=JSON.parse(JSON.stringify({...w.artist,type:"Primary"}));const t={userId:c.id,...JSON.parse(JSON.stringify(o.release)),shouldValidate:e};return f.update(t).$promise.then((function(e){o.release.releaseId=e.releaseId??e.id}))}(!t)}catch(e){return e?.data?.errorData?void P(e):void i.addNotification({title:e?.data?.message||"Something went wrong, please try again later",autoclose:8e3,classList:"warning"})}a(),l()}if(3===o.currentStepNumber&&2===e&&(a(),l()),2===o.currentStepNumber)try{await function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=o.releaseSongs.map((e=>({...e,title:e.title||e.originalTitle}))),n={userId:c.id,releaseId:o.release.releaseId,assets:t,shouldValidate:e};return f.addSong(n).$promise}(!t&&1!==e);const n=await f.get({userId:c.id,releaseId:o.release.releaseId}).$promise;o.release.errors=n.errors}catch(e){if(e?.data?.errorData?.assets){o.releaseSongErrors=e.data.errorData.assets||[];for(let t=0;t<o.releaseSongs.length;t++)o.releaseSongs[t].error=e.data.errorData.assets[t];o.$applyAsync()}else i.addNotification({title:e.message||"Something went wrong, please try again later",autoclose:8e3,classList:"warning"});return}if(3!==o.currentStepNumber||4!==e||t||(f.picture({userId:c.id,releaseId:o.release.releaseId,pictureId:o.release.picture.id||o.release.picture.url.split("/")[5]}).$promise.catch((function(e){i.addNotification({title:e?.data.message,autoclose:8e3,classList:"warning"})})),o.hasConfirmedCoverArtCompliance))return 4===e&&0===o.remainingReleases&&y.isTrial&&(o.submitButtonDisabled=!0),o.stepsList.find((t=>t.step===e))&&(o.currentStepNumber=e,o.$applyAsync()),5===e&&(o.submitButtonDisabled=!0,o.isSubmitting=!0,f.getAccess({userId:c.id}).$promise.then((e=>{const t=e.featureAccess.remainingReleases<=0;if("Free"===y.plan&&(s&&t||!s))return new u({id:"reachedReleaseLimitPilotModal",templateUrl:"https://www.bandlab.com/web-app/distribution/partials/_distribution-reached-release-limit-modal-f828b105.html",contentScope:{isPilotUser:s,source:"releaseForm",getMembership:function(){n.$broadcast("reachedReleaseLimitPilotModal","close"),p()?T("distro","artist_services"):new u({id:"paywallModal",templateUrl:"https://www.bandlab.com/web-app/membership/partials/_paywall-modal-ee6789e7.html",contentScope:{useCheckoutModal:!0,checkoutSuccess:C,productAttribution:"distro",productAttributionGroup:"artist_services"}}).show()},createDraft:function(){n.$broadcast("topBarExit")}}}).show(),o.submitButtonDisabled=!1,void(o.isSubmitting=!1);if(!o.stepsList.flatMap((e=>e.errors??[])).length){return new u({id:"distroUserVettingModal",templateUrl:"https://www.bandlab.com/web-app/distribution/partials/_distribution-user-vetting-modal-dde2de25.html",contentScope:{terms:[{index:0,selected:!1,text:"I have all the rights required for BandLab to make and authorize, on a nonexclusive basis, any online distribution of my recordings, metadata, or other info."},{index:1,selected:!1,text:"I grant BandLab all the necessary rights for online distribution of my recordings, and any metadata, through digital services."},{index:2,selected:!1,text:'I\'ve read, and agreed to, the <a href="https://blog.bandlab.com/terms-of-use/" target="_blank" rel="noopener">Terms of Service</a>.'}],releasing:!1,userAgree:function(){const e=this;e.releasing=!0,M=M.then((function(){return pN(i,c,f,e)})).then((function(e){if(e){const e={userId:c.id,releaseId:o.release.releaseId,state:"InReview"};return f.updateState(e).$promise.then((function(){Promise.resolve().then((()=>rb)).then((function(e){let{logDistroReleaseComplete:t}=e;t(o.release.releaseId,"solo_release",o.releaseSongs.length)})),r.go("distributionSuccess",{redirect:r.params.redirect})}))}})).catch((t=>{o.submitButtonDisabled=!1,o.isSubmitting=!1,e.releasing=!1,i.addNotification({title:t?.data.message,autoclose:8e3,classList:"warning"})}))},userDisagree:function(){n.$broadcast("topBarExit")}}}).show(),o.submitButtonDisabled=!1,void(o.isSubmitting=!1)}p()?r.go(".",{"#":"bl_closeWebView"}):r.go("dashboard.distribution.list")})).catch((()=>{new u({id:"DistributionMembershipErrorModal",templateUrl:"https://www.bandlab.com/web-app/distribution/partials/_distribution-membership-error-modal-1dfc0f6e.html",releasing:!1,contentScope:{tryAgain:function(){o.updateDistributionForm(5)}}}).show(),o.submitButtonDisabled=!1,o.isSubmitting=!1}))),M;o.openCoverArtComplianceModal()}}]).controller("ReleaseEditCtrl",["$rootScope","$scope","AppNotifications","ConfirmModal","Me","Release",function(e,t,n,o,r,i){t.confirmDeleteRelease=function(e){new o({confirmLabel:"Delete",toFocusConfirm:!0,contentScope:{title:"Released"===e.state?`Taking down ${e.name}?`:`Delete ${e.name||"draft release"}?`,message:PN(e)},onConfirm:()=>t.deleteRelease(e.id)}).show()},t.deleteRelease=function(t){return i.delete({userId:r.id,releaseId:t}).$promise.then((function(){e.$broadcast("$distributionRelease:deleted",{releaseId:t})})).catch((function(e){n.addNotification({title:e?.data.message,classList:"alert",autoclose:8e3})}))}}]).directive("pictureUploadPlaceholderFilepicker",["Modal",function(e){return{link:function(t,n){n.on("click",(function(){Fh({accept:"image/*",multiple:!1}).then((function(n){let[o]=n;o&&mF(e,{release:t.release,file:o})}))}))}}}]).directive("pictureUploadPlaceholderDropzone",["Modal",function(e){return{link:function(t,n){n.on("dragenter",(function(e){e.preventDefault(),e.stopPropagation(),n.addClass("drag-over")})),n.on("dragleave",(function(e){e.preventDefault(),e.stopPropagation(),n.removeClass("drag-over")})),n.on("dragover",(function(e){e.stopPropagation(),e.preventDefault(),n.addClass("drag-over")})),n.on("drop",(function(n){n.preventDefault(),n.stopPropagation();const[o]=n.dataTransfer.files;mF(e,{release:t.release,file:o})}))}}}]).directive("distributionStep3AccordionWrapper",["$compile","$templateRequest",function(e,t){return{link:function(n,o){const r=Promise.all([import("./chunk-a7f0147e.js"),t("https://www.bandlab.com/web-app/distribution/partials/_distribution-step-3-accordion-header-51455617.html"),t("https://www.bandlab.com/web-app/distribution/partials/_distribution-step-3-accordion-panel-4933cfab.html")]).then((function(t){let[{mountStep3Accordion:r},i,a,s]=t;return n.$applyAsync(),r(o[0],{header:e(i)(n),isDeleted:n.releaseSong.isDeleted||!1,panel:e(a)(n),panelNested:e(s)(n),releaseSongsLength:n.releaseSongs.length})}));n.$watch("form.$invalid",(function(e){n.releaseSong.isValid=!e})),n.$watch("form.$pending",(function(e){n.releaseSong.pendingValidation=!!e,n.releaseSong.rejectedReasons&&Object.keys(n.releaseSong.rejectedReasons).forEach((e=>{for(const t of n.releaseSong.rejectedReasons[e]){if("title"===e&&n.form.songTitle){n.form.songTitle.$dirty&&(t.isAddressed=!0);break}if(n.form[e]){n.form[e].$dirty&&(t.isAddressed=!0);break}}}))})),n.$watch("releaseSong.error.contributorTypes",(function(e){const t=e?.composer||e?.lyricist;n.form.$setValidity("valid",!t)}),!0),n.$watchGroup(["releaseSongErrors","form","releaseSongRejectedReasons"],(function(){n.releaseSong.error&&Object.keys(n.releaseSong.error).forEach((e=>{if("title"===e&&n.form.songTitle)n.form.songTitle.$setValidity("valid",!n.releaseSong.error.title),n.form.songTitle.errorMessage=n.releaseSong.error.title;else if("artists"===e)for(let t=0;t<n.releaseSong.artists.length;t++)n.releaseSong.error[e]&&(n.releaseSong.artists[t].error=n.releaseSong.error[e][t]);else if("contributors"===e&&n.releaseSong.error.contributors){const e=n.releaseSong.error?.contributors?.filter((e=>e.type&&"Composer"!==e.type&&"Lyricist"!==e.type))||[],t=n.releaseSong.error?.contributors?.filter((e=>"Composer"===e.type))||[],o=n.releaseSong.error?.contributors?.filter((e=>"Lyricist"===e.type))||[],r=n.releaseSong.contributors.filter((e=>"Composer"!==e.type&&"Lyricist"!==e.type)),i=n.releaseSong.contributors.filter((e=>"Composer"===e.type)),a=n.releaseSong.contributors.filter((e=>"Lyricist"===e.type));e.forEach(((e,t)=>{r[t]&&(r[t].error=e)})),t.forEach(((e,t)=>{i[t]&&(i[t].error=e)})),o.forEach(((e,t)=>{a[t]&&(a[t].error=e)}))}else n.form[e]&&(n.form[e].$setValidity("valid",!n.releaseSong.error[e]),n.form[e].errorMessage=n.releaseSong.error[e])})),n.releaseSong.rejectedReasons&&Object.keys(n.releaseSong.rejectedReasons).forEach((e=>{for(const t of n.releaseSong.rejectedReasons[e]){if("title"===e&&n.form.songTitle){n.form.songTitle.$setValidity("valid",t.isAddressed);break}if(n.form[e]){n.form[e].$setValidity("valid",t.isAddressed);break}}}))})),n.$on("$destroy",(async function(){(await r).unmount()}))}}}]).directive("distributionStep5AccordionWrapper",["$compile","$templateRequest",function(e,t){return{link:function(n,o){const r=Promise.all([import("./chunk-a7f0147e.js"),t("https://www.bandlab.com/web-app/distribution/partials/_distribution-step-5-accordion-header-16a41036.html"),t("https://www.bandlab.com/web-app/distribution/partials/_distribution-step-5-accordion-panel-9f3f55c9.html")]).then((function(t){let[{mountStep5Accordion:r},i,a]=t;return n.$applyAsync(),r(o[0],{header:e(i)(n),isDeleted:n.releaseSong.revision.isDeleted||!1,panel:e(a)(n),scope:n})}));n.$on("$destroy",(async function(){(await r).unmount()}))}}}]).directive("distributionReleaseSongDetails",["$injector",function(e){return{link:function(t,n){const o=Mt({releaseSong:t.releaseSong,languages:t.languages}),r=Promise.all([import("./chunk-a7f0147e.js")]).then((function(r){let[{mountReleaseSongDetails:i}]=r;return t.$applyAsync(),i(n[0],{scope:t,$injector:e},o)}));t.$watch((function(e){const{releaseSong:t,languages:n}=e;o.releaseSong=t,o.languages=n}),!0),t.$on("$destroy",(async function(){(await r).unmount()}))}}}]).directive("distributionFormAlert",["$injector",function(e){return{restrict:"E",scope:{type:"@",desc:"@",isAddressed:"="},link:function(t,n){const o=Mt({type:t.type,desc:t.desc,isAddressed:t.isAddressed}),r=Promise.all([import("./chunk-268cad9c.js")]).then((function(r){let[{mountDistributionFormAlert:i}]=r;return i(n[0],{$injector:e,scope:t},o)}));t.$watch((function(e){const{isAddressed:t}=e;o.isAddressed=t}),!0),t.$on("$destroy",(async function(){(await r).unmount()}))}}}]),angular.module("bandlab.distribution").controller("DistributionReleasesCtrl",["$rootScope","$scope","$state","$stateParams","AppNotifications","ConfirmModal","isPilotUser","Me","Modal","Release",function(e,t,n,o,r,i,a,s,l,c){var u,d=null,p=!1;function m(){return p?Promise.resolve([]):u=c.getList({after:d,limit:30,state:f(),userId:s.id}).$promise.then((function(e){return d=e.paging.cursors.after,p=!d,e.data}))}function f(){switch(o.category){case"draft":return"Draft";case"in-review":return"InReview";case"released":return"Released";case"paused":return"Paused";case"rejected":return"Rejected";default:return""}}t.isPilotUser=a,t.$on("$distributionRelease:deleted",((e,n)=>{let{releaseId:o}=n;t.releases=t.releases.filter((e=>e.id!==o))})),o.releaseId&&c.get({userId:s.id,releaseId:o.releaseId}).$promise.then((o=>{"Rejected"===o.state&&(t.release={...o,id:o.releaseId,type:o.state},CN(e,t,n,t.release,r,s,l,i,c))})),t.loadMore=function(){return t.infiniteScrollEnded?Promise.resolve([]):u=u.then((function(e){return t.infinteScrollEnded=p,t.releases||=[],t.releases=t.releases.concat(e),m()}))},m().then(t.loadMore)}]).directive("distributionRelease",(function(){return{scope:{release:"="},templateUrl:"https://www.bandlab.com/web-app/distribution/partials/_distribution-release-tile-31976d87.html",controller:["$rootScope","$scope","$state","$stateParams","AppNotifications","ConfirmModal","Me","Modal","Release",function(e,t,n,o,r,i,a,s,l){t.hasWebviewCookie=p,t.openEditReleaseModal=function(e){if("Draft"!==e&&"Rejected"!==e)return new i({confirmLabel:"Edit",contentScope:{title:"Edit Release?",message:"<p>Editing this release will return it to Drafts and stop the review process. Youll need to resubmit and restart the review process.</p>"},onConfirm:()=>{const e={userId:a.id,releaseId:t.release.id,state:"Draft"};return l.updateState(e).$promise.then((function(){if(p()){t.release.state="Draft";const e=n.href("distributionEdit",{releaseId:t.release.id,"#":"bl_openModalWebview"},{absolute:!0});window.open(e,"_blank")}else n.go("distributionEdit",{releaseId:t.release.id})})).catch((function(e){r.addNotification({title:e?.data.message,classList:"alert",autoclose:8e3})}))}}).show();if(p()){const e=n.href("distributionEdit",{releaseId:t.release.id,"#":"bl_openModalWebview"},{absolute:!0});window.open(e,"_blank")}else n.go("distributionEdit",{releaseId:t.release.id})},t.clickReleaseTile=function(o){"Draft"===o.state?t.openEditReleaseModal(o.state):CN(e,t,n,o,r,a,s,i,l)}}]}})).directive("distributionReleaseReviewDetails",(function(){return{scope:{release:"=",genres:"=",releaseSong:"="},templateUrl:"https://www.bandlab.com/web-app/distribution/partials/_distribution-release-review-details-09aab5d1.html",controller:["$scope",function(e){e.getGenreName=function(t){return e.genres?.find((e=>e.id===t))?.name}}]}})).filter("formatCurrencyString",(function(){return DA})).directive("distributionReleaseOverviewAccordionWrapper",["$injector",function(e){return{link:function(t,n,o){const r=Mt({asset:t.asset,isDeleted:t.asset.isDeleted||!1,releaseState:o.distributionReleaseOverviewAccordionWrapperState}),i=Promise.all([import("./chunk-a7f0147e.js")]).then((function(o){let[{mountOverviewModalAccordion:i}]=o;return t.$applyAsync(),i(n[0],{scope:t,$injector:e},r)}));t.$on("$destroy",(async function(){const e=await i;setTimeout((()=>{e.unmount()}),200)}))}}}]).directive("distributionReleaseOverviewDetailsWrapper",["$injector",function(e){return{scope:{release:"=",genres:"=",type:"=",inWizard:"=?"},link:function(t,n){const o=Mt({release:t.release||{},genres:t.genres||[],type:t.type||"",inWizard:t.inWizard});t.$watch((function(e){const{release:t,genres:n,type:r}=e;o.release=t||{},o.genres=n||[],o.type=r||""}));const r=Promise.all([import("./chunk-e01967e7.js")]).then((function(r){let[{mountOverviewModalDetails:i}]=r;return t.$applyAsync(),i(n[0],{scope:t,$injector:e},o)}));t.$on("$destroy",(async function(){const e=await r;setTimeout((()=>{e.unmount()}),200)}))}}}]),angular.module("bandlab.distribution").directive("editableRoleList",(function(){return{restrict:"E",templateUrl:"https://www.bandlab.com/web-app/distribution/partials/_distribution-editable-role-list-9eb72a03.html",scope:{releaseSong:"=",label:"<",variant:"<",isRequired:"<"},controller:["$scope",function(e){"artists"===e.label?e.roleTypes=[{id:"Primary",name:"Primary"},{id:"Featuring",name:"Featuring"}]:"contributors"===e.label&&(e.roleTypes=[{id:"Choir",name:"Choir"},{id:"Conductor",name:"Conductor"},{id:"Engineer",name:"Engineer"},{id:"Ensemble",name:"Ensemble"},{id:"Mixer",name:"Mixer"},{id:"Orchestra",name:"Orchestra"},{id:"Producer",name:"Producer"},{id:"Remixer",name:"Remixer"},{id:"Soloist",name:"Soloist"},{id:"Writer",name:"Writer"}]),e.startRoleCreation=function(){e.endRoleEdition(),e.roleListCreationFormActive=!0,e.roleListCreationData||("typeTwo"===e.variant?e.roleListCreationData={firstName:null,lastName:null,links:{spotify:null,appleMusic:null},type:null}:"typeOne"===e.variant&&(e.roleListCreationData={name:null,links:{spotify:null,appleMusic:null},type:null}))},e.loadError=function(t,n,o){if(!n.error)return;function r(e,t){e&&t&&(e.$setValidity("valid",!1),e.errorMessage=t)}const i=e.$watch((()=>t),(function(){"Composer"===n.type?(r(t.composerFirstName,n.error.firstName),r(t.composerLastName,n.error.lastName)):"Lyricist"===n.type?(r(t.lyricistFirstName,n.error.firstName),r(t.lyricistLastName,n.error.lastName)):(r(t[`roleName${o}`],n.error.name),n.error.links&&(r(t.subform?.roleApple,n.error.links?.appleMusic),r(t.subform?.roleSpotify,n.error.links?.spotify))),i()}))},e.endRoleCreation=function(){e.roleListCreationFormActive=!1,e.roleListCreationData=null},e.startRoleEdition=function(t,n){e.endRoleCreation(),e.roleListEditFormIndex=n,e.roleListEditionData=JSON.parse(JSON.stringify(t))},e.endRoleEdition=function(){e.roleListEditFormIndex=null,e.roleListEditionData=null},e.editRole=function(t){"typeOne"===e.variant?(t.name=e.roleListEditionData.name,t.type=e.roleListEditionData.type,t.role=e.roleListEditionData.type,t.links.spotify=e.roleListEditionData.links.spotify,t.links.appleMusic=e.roleListEditionData.links.appleMusic):(t.firstName=e.roleListEditionData.firstName,t.lastName=e.roleListEditionData.lastName),t.error={},e.endRoleEdition()},e.addRole=function(){"typeTwo"===e.variant?(e.releaseSong.contributors.push({...e.roleListCreationData,type:vg(e.label)}),e.releaseSong.error?.contributorTypes&&(e.releaseSong.error.contributorTypes[e.label]=null)):"typeOne"===e.variant&&e.releaseSong[e.label].push({...e.roleListCreationData,role:e.roleListCreationData.type}),e.endRoleCreation()},e.removeRoleListItems=function(t,n){const o="artists"===e.label?t.artists:t.contributors,r=o.indexOf(n);o.splice(r,1)},e.addRoleSpotify=function(e){e.links||(e.links={}),e.links.spotify=""},e.removeRoleSpotify=function(e){e.links.spotify=null},e.addRoleAppleMusic=function(e){e.links||(e.links={}),e.links.appleMusic=""},e.removeRoleAppleMusic=function(e){e.links.appleMusic=null},e.isRequired&&0===e.releaseSong.contributors.filter((t=>t.type===vg(e.label))).length&&e.startRoleCreation()}]}})),angular.module("bandlab.distribution").directive("isolatedForm",(function(){return{restrict:"A",require:"form",link:function(e,t,n,o){e.isRequired||(o.$setValidity=function(){})}}})),angular.module("bandlab.distribution").directive("releaseVersionSuggestions",["$parse",function(e){return{require:["^form","ngModel"],link:function(t,n,o,r){const i=r[1],a=[{id:"1",mainText:"Remix",name:"Remix"},{id:"2",mainText:"Edit",name:"Edit"},{id:"3",mainText:"Live",name:"Live"},{id:"4",mainText:"Extended",name:"Extended"},{id:"5",mainText:"Acoustic",name:"Acoustic"},{id:"6",mainText:"Remastered",name:"Remastered"},{id:"7",mainText:"Demo",name:"Demo"}];function s(){const e=i.$viewValue;var n;t.releaseVersionSuggestions={popularValues:(n=e,n?a.filter((e=>e.name.toLowerCase().includes(n.toLowerCase()))):a)}}function l(){!i.$invalid&&t.releaseVersionSuggestions.popularValues?.length||(t.releaseVersionSuggestions={})}i.$viewChangeListeners.push((function(){s()})),t.completeInput=function(n){(0,e(o.ngModel).assign)(t,n.name),i.$processModelValue(),t.releaseVersionSuggestions={}},n.on("focus",s),n.on("blur",l),t.$on("$destroy",(function(){n.off("focus",s),n.off("blur",l)}))}}}]),angular.module("bandlab.distribution").factory("Release",["$resource",function(e){const t="https://www.bandlab.com/api/v1.3/users";return e(t,{},{create:{method:"POST",url:`${t}/:userId/distro/releases`,params:{userId:"@userId"}},get:{method:"GET",url:`${t}/:userId/distro/releases/:releaseId`,params:{userId:"@userId",releaseId:"@releaseId"}},delete:{method:"DELETE",url:`${t}/:userId/distro/releases/:releaseId`,params:{userId:"@userId",releaseId:"@releaseId"}},update:{method:"PUT",url:`${t}/:userId/distro/releases/:releaseId`,params:{userId:"@userId",releaseId:"@releaseId"}},updateState:{method:"PUT",url:`${t}/:userId/distro/releases/:releaseId/state`,params:{userId:"@userId",releaseId:"@releaseId"}},addSong:{method:"PUT",url:`${t}/:userId/distro/releases/:releaseId/songs`,params:{userId:"@userId",releaseId:"@releaseId"}},submit:{method:"PUT",url:`${t}/:userId/distro/releases/:releaseId/state`,params:{userId:"@userId",releaseId:"@releaseId"}},getList:{method:"GET",url:`${t}/:userId/distro/releases`,params:{userId:"@userId"},preservePagination:!0},picture:{method:"PUT",url:`${t}/:userId/distro/releases/:releaseId/cover-art`,params:{userId:"@userId",releaseId:"@releaseId"}},getAccess:{method:"GET",url:`${t}/:userId/distro`,params:{userId:"@userId"}},getFormOptions:{method:"GET",cache:!0,url:`${t}/:userId/distro/form-options`,params:{userId:"@userId"}}})}]),angular.module("bandlab.editor",[]),angular.module("bandlab.audio").directive("audioEditorWaveformCanvas",["$injector",function(e){return{replace:!0,restrict:"E",template:'<div class="audio-editor-waveform-canvas-container"></div>',link:async function(t,n){import("./chunk-2c45a9f7.js").then((function(o){let{mountAudioEditorWaveformCanvas:r}=o;const i=r(n[0],{$injector:e,scope:t});t.$on("$destroy",(function(){i.unmount()}))}))}}}]);const fF="Shift",hF="Space",gF="Delete",vF="Backspace",bF="CMD",yF="OPT",wF="",$F="",kF=[{category:"Edit",shortcuts:[{keybindings:[["S"]],label:"Slice Region",keywords:"crop cut",tooltips:["Slice at Playhead"]},{keybindings:[["Q"]],label:"Quantize Note",tooltips:["Quantize Note"]},{keybindings:[[""],[""]],label:"Move Playhead / Note"},{keybindings:[[wF],[$F]],label:"Transpose Note by 1 Semitone"},{keybindings:[[fF,wF],[$F]],label:"Transpose Note by 12 Semitones"},{keybindings:[[vF],[gF]],label:"Delete"},{keybindings:[[bF,"C"]],label:"Copy"},{keybindings:[[bF,"V"]],label:"Paste"},{keybindings:[[bF,"X"]],label:"Cut Region / Note"},{keybindings:[[bF,"A"]],label:"Select All Regions / Note"},{keybindings:[[bF,"Z"]],label:"Undo"},{keybindings:[[bF,fF,"Z"]],label:"Redo"},{keybindings:[[yF,"Drag"]],label:"Duplicate Region / Note"}]},{category:"Tools",shortcuts:[{keybindings:[["A"]],label:"Toggle Automation",tooltips:["Show/Hide Automation"]},{keybindings:[["C"]],label:"Toggle Cycle",tooltips:["Cycle"]},{keybindings:[["V"]],label:"Toggle Velocity Mode",tooltips:["Edit Note Velocity"]},{keybindings:[[fF,"M"]],label:"Mute Track",tooltips:["Mute"]},{keybindings:[[fF,"S"]],label:"Solo Track",tooltips:["Solo"]},{keybindings:[[fF,"T"]],label:"Add Track"},{keybindings:[[fF,"D"]],label:"Duplicate Track"},{keybindings:[[fF,gF]],label:"Delete Track"}]},{category:"View",shortcuts:[{keybindings:[["L"]],label:"Toggle BandLab Sounds Browser"},{keybindings:[[bF,"-"]],label:"Zoom Out"},{keybindings:[[bF,"+"]],label:"Zoom In"},{keybindings:[[yF,"-"],["+"]],label:"MIDI Editor Vertical Zoom"},{keybindings:[[bF,"/"]],label:"Toggle Shortcuts Tab"}]},{category:"Transport",shortcuts:[{keybindings:[[hF]],label:"Play / Stop",tooltips:["Play","Stop"]},{keybindings:[[fF,hF]],tooltips:["Pause"],label:"Pause / Play from Start of Track / Cycle"},{keybindings:[["R"]],label:"Record / Stop Recording",tooltips:["Start Recording","Stop Recording"]},{keybindings:[["Enter"],["Return"]],label:"Set Playhead to Beginning of Project"}]},{category:"Settings",shortcuts:[{keybindings:[["M"]],label:"Toggle Metronome",tooltips:["Disable Metronome","Enable Metronome"]},{keybindings:[["G"]],label:"Toggle Snap to Grid",tooltips:["Snap to Grid"]},{keybindings:[[bF,"Hold"]],label:"Disable Snap to Grid / Turn on Note Insert Mode"},{keybindings:[[fF,"A"]],label:"Arm Automation Recording"}]},{category:"Project",shortcuts:[{keybindings:[[bF,"S"]],label:"Save Revision"}]},{category:"Special",shortcuts:[{keybindings:[[hF]],label:"Toggle Drum Machine Pattern Preview"},{keybindings:[[fF,"L"]],label:"Toggle Drum Machine Live Mode"},{keybindings:[[wF],[$F]],label:"Previous / Next Sounds Preview"},{keybindings:[[fF,"Click"]],label:"Add automation point to selection"}]}].map((e=>{let{category:t,shortcuts:n}=e;const o=n.map((e=>{return{...e,category:t,shortcutString:(n=e.keybindings,Array.from(new Set(n.map((e=>e.map((e=>{switch(e){case vF:case gF:return"";case bF:return Xf?"":"Ctrl";case yF:return Xf?"":"Alt";case wF:return"Up";case $F:return"Down";case"":return"Left";case"":return"Right";default:return e}})).join(" + "))))).join(" or "))};var n}));return{category:t,shortcuts:o}})),SF={Edit:"Edit",Tools:"Tools",View:"View",Transport:"Transport",Settings:"Settings",Project:"Project",Special:"Special"};function _F(e){if(!e)return;const t=kF.flatMap((e=>e.shortcuts)).find((t=>t.tooltips?.includes(e)||t.label===e||t.label.includes(e)))?.shortcutString;return t?`${e} (${t})`:e}function PF(e){if(e)return kF.flatMap((e=>e.shortcuts)).find((t=>t.tooltips?.includes(e)||t.label===e||t.label.includes(e)))?.shortcutString}const MF=rd((function(){const e=document.createElement("div");e.style.visibility="hidden",e.style.overflowY="scroll",e.style.padding="0",e.style.border="none";const t=document.createElement("div");t.style.padding="0",t.style.border="none",document.body.appendChild(e),e.appendChild(t);const n=e.offsetWidth-t.offsetWidth;return e.parentNode.removeChild(e),n}));function TF(e){return null!==e&&"object"==typeof e&&"name"in e&&"string"==typeof e.name}var CF=[0,2,4,5,7,9,11],EF=e=>{let{step:t,alt:n}=e;return(CF[t]+n+120)%12},IF=e=>{let{step:t,alt:n,oct:o,dir:r=1}=e;return r*(CF[t]+n+12*(void 0===o?-100:o))},RF=e=>{const t=IF(e);return void 0!==e.oct&&t>=-12&&t<=115?t+12:null};function AF(e){return null!==e&&"object"==typeof e&&"step"in e&&"number"==typeof e.step&&"alt"in e&&"number"==typeof e.alt}var xF=[0,2,4,-1,1,3,5],LF=xF.map((e=>Math.floor(7*e/12)));function OF(e){const{step:t,alt:n,oct:o,dir:r=1}=e,i=xF[t]+7*n;return void 0===o?[r*i]:[r*i,r*(o-LF[t]-4*n)]}var jF=[3,0,4,1,5,2,6];function DF(e){const[t,n,o]=e,r=jF[function(e){const t=(e+1)%7;return t<0?7+t:t}(t)],i=Math.floor((t+1)/7);return void 0===n?{step:r,alt:i,dir:o}:{step:r,alt:i,oct:n+4*i+LF[r],dir:o}}var NF=(e,t)=>Array(Math.abs(t)+1).join(e),UF={empty:!0,name:"",pc:"",acc:""},FF=new Map,BF=e=>"CDEFGAB".charAt(e),WF=e=>e<0?NF("b",-e):NF("#",e),VF=e=>"b"===e[0]?-e.length:e.length;function qF(e){const t=JSON.stringify(e),n=FF.get(t);if(n)return n;const o="string"==typeof e?function(e){const t=HF(e);if(""===t[0]||""!==t[3])return UF;const n=t[0],o=t[1],r=t[2],i=(n.charCodeAt(0)+3)%7,a=VF(o),s=r.length?+r:void 0,l=OF({step:i,alt:a,oct:s}),c=n+o+r,u=n+o,d=(YF[i]+a+120)%12,p=void 0===s?KF(YF[i]+a,12)-1188:YF[i]+a+12*(s+1),m=p>=0&&p<=127?p:null;return{empty:!1,acc:o,alt:a,chroma:d,coord:l,freq:void 0===s?null:440*Math.pow(2,(p-69)/12),height:p,letter:n,midi:m,name:c,oct:s,pc:u,step:i}}(e):AF(e)?qF(function(e){const{step:t,alt:n,oct:o}=e,r=BF(t);if(!r)return"";const i=r+WF(n);return o||0===o?i+o:i}(e)):TF(e)?qF(e.name):UF;return FF.set(t,o),o}var zF=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function HF(e){const t=zF.exec(e);return t?[t[1].toUpperCase(),t[2].replace(/x/g,"##"),t[3],t[4]]:["","","",""]}function GF(e){return qF(DF(e))}var KF=(e,t)=>(e%t+t)%t,YF=[0,2,4,5,7,9,11];const JF=Array.from({length:128},((e,t)=>128-(t+1))),XF="fold",ZF="scale",QF=Vt(null),eB=Vt(!1);function tB(e,t){if(eB.value&&QF.value===XF&&!e)return t(ZF),void(QF.value=ZF);t(e),QF.value=e}const nB=Gi((()=>{const e=BS.value.tonal||BS.value.label,t=WS.value.tonal||WS.value.label;return uT.get([e,t]).notes}));let oB=rB;function rB(){}function iB(e){oB=e}function aB(){oB(),oB=rB}const sB=Vt([]),lB=Vt(sB.value);function cB(){const e=Lr(sB,(()=>{let t=lB.value.concat(sB.value);t=Array.from(new Set(t)),lB.value=t,e()}))}Lr([BS,QF,jS,WS],(()=>{lB.value=sB.value}));const uB=Gi((()=>JF.filter((e=>{if(!QF.value)return!0;if(0===lB.value.length){if(QF.value===XF)return!0;if(QF.value===ZF)return wB(qF(DP.fromMidi(e)).pc)}const t=lB.value.includes(e);return QF.value===XF?t:QF.value===ZF?t||wB(qF(DP.fromMidi(e)).pc):void 0})))),dB=Gi((()=>uB.value.slice().map((e=>{const t=qF(DP.fromMidi(e));return{...t,enharmonic:DP.enharmonic(t.pc)}})))),pB=Gi((()=>[...uB.value].reverse()));function mB(){DS.value=xS,eB.value=!1,QF.value=null,sB.value=[],aB()}function fB(e){return Gi({get:()=>eB.value,set:t=>{Qv(t),eB.value=t;const n=QF.value===XF;(n&&t&&0===sB.value.length||!n&&t)&&tB(ZF,e),n||t||tB(null,e)}})}Lr(uB,(()=>{document.body.style.setProperty("--midi-editor-piano-roll-row-count",uB.value.length.toString())}));const hB=Vt(JF.reduce(((e,t)=>(e[t]=!1,e)),{})),gB=Vt(JF.reduce(((e,t)=>(e[t]=!1,e)),{}));function vB(e){return eB.value&&wB(e)}function bB(e){return eB.value&&$B(e)}function yB(e){const t=DP.enharmonic(e),n=nB.value.map((e=>DP.simplify(e)));let o=n.indexOf(e);return o<0&&(o=n.indexOf(t)),{actual:nB.value[o],simplified:n[o]}}function wB(e){const t=yB(e).actual;return nB.value.includes(t)}function $B(e){return yB(e).actual===(BS.value.tonal||BS.value.label)}function kB(e,t){let n=pB.value.indexOf(e);return n=As(n+t,0,uB.value.length-1),pB.value[n]}function SB(e){const t=mx(e,"midiNote"),n=t[t.length-1],o=t[0],r=pB.value.indexOf(n.midiNote);return{infDeltaMidiNote:-pB.value.indexOf(o.midiNote),supDeltaMidiNote:uB.value.length-1-r}}const _B=Object.freeze(Object.defineProperty({__proto__:null,MIDI_ROLL_MODE_FOLD:XF,MIDI_ROLL_MODE_SCALE:ZF,MidiRollSmartViewEnabled:eB,MidiRollViewMode:QF,NotesInKeyView:nB,NotesInRoll:uB,NotesInRollAsNotes:dB,NotesInRollReversed:pB,NotesIsActiveMap:hB,NotesIsMappedMap:gB,getMidiAfterDelta:kB,getNotesBoundariesByIndex:SB,inKeyView:wB,isRoot:$B,notesInSelectedTrack:sB,resetMIDIRollSettings:mB,setMidiRollViewMode:tB,showKeyHighlight:vB,showRootHighlight:bB,startAngularViewModeWatcher:iB,stopAngularViewModeWatcher:aB,updateMidiRollManually:cB,useIsSmartView:fB},Symbol.toStringTag,{value:"Module"})),PB=Array.from({length:194},((e,t)=>10+t)),MB=Vt(PB[0]),TB=Vt(16),CB=Gi({get:()=>QF.value?TB.value:MB.value,set:e=>{QF.value?(TB.value=e,EB("--midi-roll-key-simple-height",e)):(MB.value=e,function(){const e=7*MB.value,t=Math.floor(7*MB.value/4),n=5*MB.value,o=Math.floor(5*MB.value/3),r={FtoB:[t,(e-2*t)/2],CtoE:[o,n-2*o]};EB("--midi-editor-roll-piano-keys-white-ftob-1-height",r.FtoB[0]),EB("--midi-editor-roll-piano-keys-white-ftob-2-height",r.FtoB[1]),EB("--midi-editor-roll-piano-keys-white-ctoe-1-height",r.CtoE[0]),EB("--midi-editor-roll-piano-keys-white-ctoe-2-height",r.CtoE[1])}(),EB("--midi-roll-key-skeuomorphic-height",e))}});function EB(e,t){document.documentElement.style.setProperty(e,`${t}px`)}const IB=Vt(null);let RB;function AB(e){let t;return t=PB.indexOf(CB.value)+e,t=As(t+e,0,PB.length-1),PB[t]}function xB(){clearTimeout(RB),IB.value=null}const LB={title:"Next",hasCaret:!0},OB={escapeClose:!1,overlayClose:!1},jB=350,DB=zn((()=>import("./chunk-725143a3.js")));function NB(e){const t=document.querySelector(e);return t?Promise.resolve(t):new Promise((t=>{const n=new MutationObserver((o=>{for(const r of o){if("childList"!==r.type||0===r.addedNodes.length)return;r.addedNodes.forEach((o=>{if(o.nodeType!==Node.ELEMENT_NODE)return;const r=o,i=r.matches(e)?r:r.querySelector(e);i&&(t(i),n.disconnect())}))}}));setTimeout((()=>{t(),n.disconnect()}),1500),n.observe(document.body,{childList:!0,subtree:!0})}))}function UB(e,t){function n(){YA.value=e,JA.value=0,e.onBeforeInitLesson(t).then((e=>{"begin"===e&&(WB(XA.currentStep),qB(t,!0),_g(DB,{params:t},OB)),"cancel"===e&&FB(t)}))}YA.value?(VB(),n()):(document.body.classList.add("studio-tutorial-mode"),setTimeout(n,jB))}function FB(e,t){if(!YA.value)return;const n=!t?.abort&&YA.value.onBeforeLessonEnd?YA.value.onBeforeLessonEnd(e):Promise.resolve();YA.value=null,JA.value=-1,n.then((()=>{VB(),qB(e,!1),setTimeout((()=>document.body.classList.remove("studio-tutorial-mode")),jB)}))}function BB(){let{delay:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!YA.value)return;const t=Math.min(JA.value+1,YA.value.steps.length),n=YA.value.steps[t];setTimeout((()=>{(n.targetEl?NB(n.targetEl.selector):Promise.resolve()).then((()=>{!function(e){if(e&&e.targetEl){const t=document.querySelector(e.targetEl.selector);t&&t.classList.remove("tutorial-active")}}(XA.currentStep),WB(n),JA.value=t}))}),e||0)}function WB(e){if(e&&e.targetEl){const t=document.querySelector(e.targetEl.selector);t&&t.classList.add("tutorial-active")}}function VB(){document.querySelectorAll(".tutorial-active").forEach((e=>e.classList.remove("tutorial-active")))}function qB(e,t){const n=e.$injector.get("$rootScope"),o=e.$injector.get("EditorState");if(n.$applyAsync((()=>o.isInBackground=t)),t){const e=n.$watch((()=>o.isInBackground),(t=>{if(YA.value){if(t)return;o.isInBackground=!0}else e()}))}}function zB(){let e=Promise.resolve();return{afterDelay:function t(n){return e=(e?e.then((()=>new Promise((e=>setTimeout(e,jB))))):Promise.resolve()).then(n),{afterDelay:t}}}}function HB(e,t){const n=e?document.getElementById(e):t?document.querySelector(t):null;n?.click()}function GB(e,t){e.value=t,e.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0})),e.blur()}const KB={components:{Button:Dd,IconCheckmark:zn((()=>Promise.resolve().then((()=>xW)))),IconZerocaseNote:zn((()=>import("./chunk-38849bce.js"))),SearchInput:zn((()=>Promise.resolve().then((()=>zj)))),ZeroCase:zn((()=>Promise.resolve().then((()=>LI))))},props:{sample:{type:Object,required:!0},onSuccess:{type:Function,default:()=>{}},onFail:{type:Function,default:()=>{}},addToSoundsUserCollection:{type:Function,default:()=>{}},createCollection:{type:Function,default:()=>{}}},emits:["closeModal"],setup(e,t){let{emit:n}=t;const o=Vt(null),r=Vt(null),i=Hd(o),a=Hd(r),s=Vt(null),l=Vt(!1),c=Vt(!1),u=Vt(null),d=Vt(""),p=Vt(null);function m(){l.value=!0,e.addToSoundsUserCollection(e.sample,u.value.collectionId).then((()=>{n("closeModal"),e.onSuccess()})).catch((t=>{409===t.errorCode&&n("closeModal"),e.onFail(t)})).finally((()=>{l.value=!1,c.value=!1}))}return{addToCollection:m,closeModal:function(){n("closeModal")},createAndAddToCollection:function(t){c.value=!0;const n=t.target.elements.newCollectionTitle.value||"New collection";e.createCollection(n,"add_new_collection_modal").then((e=>(u.value=e,m()))).catch((e=>{c.value=!1,p.value=gS.value||e?.message||"Failed to create collection, please try again later"}))},filteredCollections:Gi((()=>""===d.value?hS.value:hS.value.filter((e=>e.displayName.toLowerCase().includes(d.value.toLowerCase()))))),isAddingToCollection:l,isCreatingCollection:c,isLoadingSoundsUserCollections:fS,modalNewCollectionInput:s,newCollectionInputError:p,searchCollectionDisplayName:d,selectedCollection:u,scrollContainerSentinelBottom:o,scrollContainerSentinelTop:r,scrollContainerDividerBottom:i,scrollContainerDividerTop:a,soundsUserCollections:hS}}},YB={class:"modal sounds-user-collections-modal"},JB={class:"modal-header-new"},XB={class:"modal-header-title"},ZB={class:"modal-content-new modal-content-medium-640 sounds-user-collections-modal-main-content"},QB={class:"sounds-user-collections-modal-list-container"},eW={key:0,style:{"margin-bottom":"24px"}},tW={ref:"scrollContainerSentinelTop",class:"scroll-top-child"},nW=["aria-selected","onClick"],oW={class:"sounds-user-collections-button-span"},rW={key:0,class:"sounds-user-collection-button-full-indicator"},iW={ref:"scrollContainerSentinelBottom",class:"scroll-bottom-child"},aW={key:2,class:"loader-spinner"},sW={key:3,class:"modal-confirm-buttons",style:{margin:"24px 0 -8px"}},lW={key:0,class:"modal-header-new sounds-user-collection-modal-header-secondary"},cW=bi("hr",{class:"sounds-browse-collection-divider"},null,-1),uW={class:"modal-header-title-h3",style:{"text-align":"center","margin-bottom":"16px"}},dW={key:1,class:"modal-content-new modal-content-medium-640"},pW=["placeholder"],mW={key:0,class:"sounds-side-bar-input-field-error"},fW={style:{"margin-top":"16px"}},hW=ld(KB,[["render",function(e,t,n,o,r,i){const a=vo("SearchInput"),s=vo("IconCheckmark"),l=vo("IconZerocaseNote"),c=vo("ZeroCase"),u=vo("Button");return si(),pi("aside",YB,[bi("div",{class:"modal-close",onClick:t[0]||(t[0]=function(){return o.closeModal&&o.closeModal(...arguments)})}),bi("header",JB,[bi("h2",XB,me("Add to Collection"),1)]),bi("div",ZB,[bi("div",QB,[o.soundsUserCollections.length>5?(si(),pi("div",eW,[yi(a,{modelValue:o.searchCollectionDisplayName,"onUpdate:modelValue":t[1]||(t[1]=e=>o.searchCollectionDisplayName=e),placeholder:"Search"},null,8,["modelValue","placeholder"])])):_i("v-if",!0),bi("div",{class:ae(["sounds-user-collections-modal-list scroll-divider",{"scroll-divider-bottom":o.scrollContainerDividerBottom,"scroll-divider-top":o.scrollContainerDividerTop}])},[bi("div",tW,null,512),(si(!0),pi(ti,null,So(o.filteredCollections,(e=>(si(),pi("button",{key:e.collectionId,type:"button",class:"sounds-user-collections-modal-collection-button","aria-selected":o.selectedCollection===e,onClick:t=>o.selectedCollection=e},[bi("span",oW,[ki(me(e.displayName)+" ",1),1e4===e.idsCount?(si(),pi("span",rW,me("Collection is full"),1)):_i("v-if",!0)]),o.selectedCollection===e?(si(),mi(s,{key:0,class:"sounds-user-collection-button-checkmark-icon",size:20})):_i("v-if",!0)],8,nW)))),128)),bi("div",iW,null,512)],2),0===o.filteredCollections.length||0===o.soundsUserCollections.length?(si(),mi(c,{key:1},{"illustration-icon":Tn((e=>[yi(l,{size:40,class:ae(e.class)},null,8,["class"])])),title:Tn((()=>[ki(me(o.soundsUserCollections.length>0?"No collections found":"You dont have any collections yet. "),1)])),message:Tn((()=>[ki(me(o.soundsUserCollections.length>0?"Try a different search term":""),1)])),_:1})):_i("v-if",!0),o.isLoadingSoundsUserCollections?(si(),pi("div",aW)):_i("v-if",!0),o.filteredCollections.length>0?(si(),pi("div",sW,[yi(u,{type:"button",padding:"default",color:"primary",size:"large","is-disabled":!o.selectedCollection||o.isCreatingCollection,"is-loading":o.isAddingToCollection&&!o.isCreatingCollection,class:"ds-button-full-width",onClick:o.addToCollection},{default:Tn((()=>[ki(me("Add to Collection"),1)])),_:1},8,["is-disabled","is-loading","onClick"])])):_i("v-if",!0)])]),o.soundsUserCollections.length>0&&o.soundsUserCollections.length<50?(si(),pi("header",lW,[cW,bi("h3",uW,me("Create new collection"),1)])):_i("v-if",!0),o.soundsUserCollections.length<50?(si(),pi("div",dW,[bi("form",{onSubmit:t[3]||(t[3]=ss((function(){return o.createAndAddToCollection&&o.createAndAddToCollection(...arguments)}),["prevent"]))},[bi("input",{ref:"modalNewCollectionInput",name:"newCollectionTitle",type:"text",class:ae(["input-text validate-untouched input-text-rounded",{"ng-invalid":o.newCollectionInputError}]),placeholder:"New Collection",minlength:"1",maxlength:"100",onFocus:t[2]||(t[2]=e=>o.newCollectionInputError=null)},null,42,pW),o.newCollectionInputError?(si(),pi("div",mW,me(o.newCollectionInputError),1)):_i("v-if",!0),bi("div",fW,[yi(u,{type:"submit",padding:"default",color:"secondary",size:"large","is-disabled":o.isAddingToCollection,"is-loading":o.isCreatingCollection,class:"ds-button-full-width"},{default:Tn((()=>[ki(me("Create and add"),1)])),_:1},8,["is-disabled","is-loading"])])],32)])):_i("v-if",!0)])}]]),gW={class:"modal"},vW={class:"modal-header-new"},bW={class:"modal-header-title"},yW={class:"modal-content-small modal-content modal-content-new"},wW={class:"modal-confirm-message"},$W={class:"modal-confirm-buttons"},kW={__name:"ConfirmDeleteUserCollectionModal",props:{message:{type:String,required:!0},onSuccess:{type:Function,required:!0}},emits:["closeModal"],setup(e,t){let{emit:n}=t;const o=n,r=e;function i(){o("closeModal")}function a(){r.onSuccess(),o("closeModal")}return(t,n)=>(si(),pi("aside",gW,[bi("div",{class:"modal-close",onClick:i}),bi("header",vW,[bi("h2",bW,me("Delete collection?"),1)]),bi("div",yW,[bi("p",wW,me(e.message),1),bi("div",$W,[bi("button",{class:"modal-cancel button-scd-theme button-height-40 button-padding-fill button-rounded",type:"button",onClick:i},me("Cancel"),1),bi("button",{class:"modal-confirm button-default button-height-40 button-padding-fill button-rounded",type:"submit",onClick:a},me("Delete"),1)])])]))}},SW={class:"modal"},_W={class:"modal-header-new"},PW={class:"modal-header-title"},MW={class:"modal-content-small modal-content modal-content-new"},TW={class:"modal-confirm-message"},CW={class:"modal-confirm-buttons"},EW={__name:"ConfirmRemoveSampleModal",props:{message:{type:String,required:!0},onSuccess:{type:Function,required:!0}},emits:["closeModal"],setup(e,t){let{emit:n}=t;const o=n,r=e;function i(){o("closeModal")}function a(){r.onSuccess(),o("closeModal")}return(t,n)=>(si(),pi("aside",SW,[bi("div",{class:"modal-close",onClick:i}),bi("header",_W,[bi("h2",PW,me("Remove sample?"),1)]),bi("div",MW,[bi("p",TW,me(e.message),1),bi("div",CW,[bi("button",{class:"modal-cancel button-scd-theme button-height-40 button-padding-fill button-rounded",type:"button",onClick:i},me("Cancel"),1),bi("button",{class:"modal-confirm button-default button-height-40 button-padding-fill button-rounded",type:"submit",onClick:a},me("Remove"),1)])])]))}},IW=["width","height","aria-hidden"],RW=[bi("path",{fill:"currentColor","fill-rule":"evenodd",d:"M20.7 7.71 9.77 18.44l-6.5-7.08 1.47-1.35 5.1 5.55L19.3 6.3z","clip-rule":"evenodd"},null,-1)],AW={__name:"checkmark",props:{size:{type:Number,required:!0}},setup:e=>(t,n)=>(si(),pi("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none","aria-hidden":t.$attrs["aria-label"]||t.$attrs["aria-labelledby"]?null:"true"},RW,8,IW))},xW=Object.freeze(Object.defineProperty({__proto__:null,default:AW},Symbol.toStringTag,{value:"Module"})),LW={class:"checkbox-container"},OW=ld({props:{checkboxId:{type:String,default:()=>ad()}}},[["render",function(e,t,n,o,r,i){return si(),pi("div",LW,[Po(e.$slots,"default",{checkboxId:n.checkboxId})])}]]),jW=["for"],DW={__name:"CheckboxLabel",props:{for:{type:String,required:!0}},setup(e){const t=e;return(e,n)=>(si(),pi("label",{for:t.for,class:"checkbox-label"},[Po(e.$slots,"default")],8,jW))}},NW={props:{modelValue:{type:[Array,Number,Object,String,Boolean,null],required:!0},radioButtonId:{type:String,required:!0}},emits:["update:modelValue"],setup(e,t){let{attrs:n,emit:o}=t;const r=Gi({get:()=>e.modelValue===n.value,set(e){o("update:modelValue",e)}});return{attrs:n,isChecked:r,onChange:function(){n.disabled||(r.value=n.value)}}}},UW=["id","checked"],FW=ld(NW,[["render",function(e,t,n,o,r,i){return si(),pi("input",{id:n.radioButtonId,type:"radio",class:"ds-radio-button",checked:o.isChecked,onChange:t[0]||(t[0]=function(){return o.onChange&&o.onChange(...arguments)})},null,40,UW)}]]),BW=Object.freeze(Object.defineProperty({__proto__:null,default:FW},Symbol.toStringTag,{value:"Module"})),WW={class:"ds-radio-button-container"},VW=ld({props:{radioButtonId:{type:String,default:()=>ad()}}},[["render",function(e,t,n,o,r,i){return si(),pi("div",WW,[Po(e.$slots,"default",{radioButtonId:n.radioButtonId})])}]]),qW=Object.freeze(Object.defineProperty({__proto__:null,default:VW},Symbol.toStringTag,{value:"Module"})),zW=["for"],HW={__name:"RadioButtonLabel",props:{for:{type:String,required:!0}},setup(e){const t=e;return(e,n)=>(si(),pi("label",{for:t.for,class:"ds-radio-button-label"},[Po(e.$slots,"default")],8,zW))}},GW=["width","height","aria-hidden"],KW=[bi("path",{fill:"currentColor",d:"M5 4a1 1 0 0 1 1-1h3a1 1 0 0 1 1 1v16a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1zm9 0a1 1 0 0 1 1-1h3a1 1 0 0 1 1 1v16a1 1 0 0 1-1 1h-3a1 1 0 0 1-1-1z"},null,-1)],YW={__name:"pause",props:{size:{type:Number,required:!0}},setup:e=>(t,n)=>(si(),pi("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none","aria-hidden":t.$attrs["aria-label"]||t.$attrs["aria-labelledby"]?null:"true"},KW,8,GW))},JW=Object.freeze(Object.defineProperty({__proto__:null,default:YW},Symbol.toStringTag,{value:"Module"})),XW=["width","height","aria-hidden"],ZW=[bi("path",{fill:"currentColor",d:"M12 4a8 8 0 1 0 7.42 11h2.12A10 10 0 1 1 21 7.64V4h2v7h-7V9h3.42A8 8 0 0 0 12 4"},null,-1)],QW={__name:"arrow-reload",props:{size:{type:Number,required:!0}},setup:e=>(t,n)=>(si(),pi("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none","aria-hidden":t.$attrs["aria-label"]||t.$attrs["aria-labelledby"]?null:"true"},ZW,8,XW))},eV=Object.freeze(Object.defineProperty({__proto__:null,default:QW},Symbol.toStringTag,{value:"Module"})),tV={__name:"PlayerAudioButton",setup:e=>(e,t)=>(si(),pi(ti,null,[yi(iU,{size:32,class:"icon-player-play","aria-label":"Play"},null,8,["aria-label"]),yi(YW,{size:32,class:"icon-player-pause","aria-label":"Pause"},null,8,["aria-label"]),yi(Ld,{size:32,class:"icon-player-loading","aria-label":"Loading"},null,8,["aria-label"]),yi(QW,{size:32,class:"icon-player-restart",style:{transform:"scaleX(-1)"},"aria-label":"Restart"},null,8,["aria-label"])],64))},nV=Object.freeze(Object.defineProperty({__proto__:null,default:tV},Symbol.toStringTag,{value:"Module"})),oV={__name:"WaveformBars",props:{align:{type:String,default:"bottom"},barGap:{type:Number,default:null},barWidth:{type:Number,default:1},colorNotPlayedYet:{type:String,default:"#fff"},colorProgressBackward:{type:String,default:"#fff"},colorProgressForward:{type:String,default:"#000"},colorProgressSoFar:{type:String,default:"#000"},getData:{type:Function,required:!0},progress:{type:Number,default:0},fixedBarCount:{type:Number,default:null}},emits:["setPosition"],setup(e,t){let{emit:n}=t;const o=e,r=n,i=Vt(null),a=Vt(null),s=Gi((()=>i.value.getContext("2d"))),l=Vt(0),c=Gi((()=>o.fixedBarCount?Math.round(o.progress*o.fixedBarCount)/o.fixedBarCount:o.progress)),u=ay((()=>{g(),v()}),300),d=new ResizeObserver(u);function p(e){a.value=f(e)}function m(e){r("setPosition",f(e)),e.preventDefault(),e.stopPropagation()}function f(e){return o.fixedBarCount?Math.round(e.offsetX/e.currentTarget.clientWidth*o.fixedBarCount)/o.fixedBarCount:e.offsetX/e.currentTarget.clientWidth}function h(){a.value=null}function g(){const{height:e,width:t}=i.value.parentElement.getBoundingClientRect();l.value=!o.barGap&&o.fixedBarCount?(t-o.fixedBarCount*o.barWidth)/(o.fixedBarCount-1):o.barGap,i.value.height=oC(Math.round(e)),i.value.width=o.fixedBarCount?o.fixedBarCount*oC(o.barWidth)+(o.fixedBarCount-1)*oC(l.value):oC(Math.round(t))}async function v(){lC(s.value,o.getData(i.value,o),c.value,a.value,oC(o.barWidth),oC(l.value),o.align,o.colorProgressSoFar,o.colorProgressBackward,o.colorProgressForward,o.colorNotPlayedYet)}return ao((function(){g(),i.value.addEventListener("click",m),i.value.addEventListener("pointerleave",h),i.value.addEventListener("pointermove",p),d.observe(i.value.parentElement)})),co((()=>{u.cancel(),i.value.removeEventListener("click",m),i.value.removeEventListener("pointerleave",h),i.value.removeEventListener("pointermove",p),d.unobserve(i.value.parentElement)})),Ar((async()=>{i.value&&v()})),(e,t)=>(si(),pi("canvas",{ref_key:"canvasRef",ref:i},null,512))}},rV=Object.freeze(Object.defineProperty({__proto__:null,default:oV},Symbol.toStringTag,{value:"Module"})),iV=["width","height","aria-hidden"],aV=[bi("path",{fill:"currentColor",d:"M12 4a8 8 0 0 0-7.75 6H2.2A10 10 0 0 1 21 7.64V5h2v6h-6V9h2.42A8 8 0 0 0 12 4M4.58 15H7v-2H1v6h2v-2.64A10 10 0 0 0 21.8 14h-2.05a8 8 0 0 1-15.17 1M22 12"},null,-1)],sV={__name:"sounds-loops",props:{size:{type:Number,required:!0}},setup:e=>(t,n)=>(si(),pi("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none","aria-hidden":t.$attrs["aria-label"]||t.$attrs["aria-labelledby"]?null:"true"},aV,8,iV))},lV=Object.freeze(Object.defineProperty({__proto__:null,default:sV},Symbol.toStringTag,{value:"Module"})),cV=["width","height","aria-hidden"],uV=[bi("path",{fill:"currentColor",d:"M3 22V2h2v20zm4-4V6h2v12zm4-10v8h2V8zm4 6v-4h2v4zm4-3v2h2v-2z"},null,-1)],dV={__name:"sounds-oneshots",props:{size:{type:Number,required:!0}},setup:e=>(t,n)=>(si(),pi("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none","aria-hidden":t.$attrs["aria-label"]||t.$attrs["aria-labelledby"]?null:"true"},uV,8,cV))},pV=Object.freeze(Object.defineProperty({__proto__:null,default:dV},Symbol.toStringTag,{value:"Module"}));function mV(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return e=Math.min(n,e),Math.max(t,e)}function fV(e){let{defaultShowMilliseconds:t=!1,defaultShowMinutes:n=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=Math.floor(e/3600),r=Math.floor((e-3600*o)/60),i=Math.floor((e-3600*o-60*r)%60),a=Math.round(e%1*1e3),s=o>0?2:1;return`${o>0?`${o}:`:""}${n||r>0?`${String(r).padStart(s,"0")}:`:""}${String(i).padStart(2,"0")}${t?`.${String(a).padStart(3,"0")}`:""}`}function hV(e){return{one:`${t=Math.round(e.duration/(60/e.features?.loop?.tempo*4))} bar`,other:`${t} bars`}[new Intl.PluralRules("en").select(t)];var t}function gV(e){const t=e.lastIndexOf(".");return-1!==t?e.substring(0,t):e}function vV(e){const t=e.lastIndexOf(".");return-1!==t?e.substring(t+1):null}const bV={class:"sounds-sample-preview"},yV=["src","alt"],wV={class:"sounds-loop-waveform-ui-container"},$V={class:"sounds-loop-name-container"},kV={class:"text-truncate semibold-16/20"},SV={class:"sounds-sample-preview-waveform-data"},_V={key:0,class:"sounds-loop-waveform-ui-description"},PV={key:2,class:"sounds-loop-waveform-track cursor-pointer"},MV={class:"regular-12/14"},TV=Vn({__name:"SoundsSamplePreviewStandalone",props:{sample:{type:Object,required:!0},imageUrl:{type:String,required:!0}},setup(e){const t=e,n=Zo("$injector").get("$analytics"),o=Mt({paused:!0,currentTime:0,duration:0}),r=new Audio,i=Gi((()=>Cs(o.currentTime/t.sample.duration,.001))),{colorNotPlayedYet:a,colorProgressBackward:s,colorProgressForward:l,colorProgressSoFar:c}=aC("#ffffff","#7e8999",!0,!0);function u(){o.paused=r.paused,o.currentTime=r.currentTime,o.duration=r.duration}function d(){r.src!==t.sample.audioUrl||r.paused?(r.src=t.sample.audioUrl,r.play(),n.eventTrack("blsounds_action",{platform:"firebase",params:{action:"preview",content_type:"sample",category:window.location.pathname.includes("/sounds/")?"sounds":"studio",content_id:t.sample.id,is_user_content:!0,triggered_from:"uploads_sample_details"}})):r.pause()}function p(e){r.paused&&d(),r.currentTime=e*r.duration}function m(){return t.sample.waveform.values}return ao((()=>{r.addEventListener("ended",u),r.addEventListener("pause",u),r.addEventListener("play",u),r.addEventListener("timeupdate",u)})),co((()=>{t.sample.audioUrl!==r.src||r.paused||r.pause(),r.removeEventListener("ended",u),r.removeEventListener("pause",u),r.removeEventListener("play",u),r.removeEventListener("timeupdate",u)})),(n,r)=>(si(),pi("div",bV,[bi("div",{class:ae(["sounds-sample-preview-player-container sounds-pack-container",{"status-paused":o.paused,"status-playing":!o.paused}])},[bi("img",{class:"sounds-loop-player-image",src:e.imageUrl,alt:e.sample.name},null,8,yV),bi("button",{type:"button",class:"sounds-pack-player-button-container base-button player-audio-controls player-button-overlay is-visible",onClick:d},[yi(tV)])],2),bi("div",wV,[bi("div",$V,[bi("div",kV,me(e.sample.name),1)]),bi("div",SV,[t.sample.waveform.maxValue?(si(),pi("div",_V,[e.sample.features?.loop?(si(),mi(sV,{key:0,class:"sounds-loop-icon-mobile",size:16})):e.sample.features?.oneShot?(si(),mi(dV,{key:1,class:"sounds-loop-icon-mobile",size:16})):_i("v-if",!0),e.sample.waveform?(si(),pi("div",PV,[yi(oV,{"fixed-bar-count":m().length,"color-not-played-yet":Gt(a),"color-progress-backward":Gt(s),"color-progress-forward":Gt(l),"color-progress-so-far":Gt(c),"get-data":m,progress:i.value,onSetPosition:p},null,8,["fixed-bar-count","color-not-played-yet","color-progress-backward","color-progress-forward","color-progress-so-far","progress"])])):_i("v-if",!0)])):_i("v-if",!0),bi("span",MV,me(t.sample.features?.loop&&t.sample.duration&&t.sample.features?.loop?.tempo?hV(t.sample):t.sample.duration?fV(t.sample.duration):""),1)])])]))}}),CV={class:"ds-modal-header"},EV={class:"ds-modal-title"},IV={key:0,class:"ds-modal-content"},RV={class:"sounds-edit-sample-details-modal-preview-section"},AV={class:"form-field-default"},xV=bi("label",{for:"sampleName",class:"form-label"},me("Sample name"),-1),LV={key:0,class:"sounds-side-bar-input-field-error"},OV={class:"form-field-default"},jV={for:"type",class:"form-label"},DV={style:{display:"flex",gap:"24px","margin-top":"8px"}},NV={key:0,class:"form-field-default"},UV={for:"instrument",class:"form-label"},FV={class:"select select-height-40"},BV=bi("option",{disabled:"",selected:"",hidden:"",value:""}," Select instrument ",-1),WV=["value"],VV=bi("option",{value:""}," - ",-1),qV={key:1,class:"form-field-default"},zV=bi("label",{for:"genres",class:"form-label"},me("Genres"),-1),HV=["aria-expanded"],GV={class:"sounds-edit-sample-dropdown-inline-tags"},KV=["placeholder","onClick"],YV={key:0,class:"sounds-edit-sample-dropdown-option",style:{"pointer-events":"none"}},JV=["aria-selected"],XV={key:2,class:"form-field-default"},ZV={for:"characters",class:"form-label"},QV={style:{position:"relative"}},eq=["aria-expanded"],tq={class:"sounds-edit-sample-dropdown-inline-tags"},nq=["placeholder","onClick"],oq={key:0,class:"sounds-edit-sample-dropdown-option",style:{"pointer-events":"none"}},rq=["aria-selected"],iq={class:"form-field-grid sounds-edit-sample-bottom-form-field-grid"},aq={class:"form-field-default sounds-edit-sample-bottom-form-field"},sq={for:"bpm",class:"form-label"},lq=["disabled","placeholder"],cq={class:"form-field-default sounds-edit-sample-bottom-form-field"},uq={for:"key",class:"form-label"},dq={style:{position:"relative"}},pq=["aria-expanded"],mq={key:0,class:"regular-14/20"},fq={key:1,class:"sounds-edit-sample-dropdown-placeholder"},hq=["onClick"],gq=["value","aria-selected","onClick"],vq={class:"ds-modal-footer ds-modal-footer-two-buttons"},bq={__name:"EditSampleDetailsModal",props:{loop:{type:Object,required:!0},imageUrl:{type:String,required:!0},updateSampleDetails:{type:Function,required:!0},getSampleNameValidationError:{type:Function,required:!0},onSuccess:{type:Function,default:()=>{}},onFail:{type:Function,default:()=>{}}},emits:["closeModal"],setup(e,t){let{emit:n}=t;const o=n,r=Vt(!1),i=Vt(null),a=e,s=Vt({}),l=Vt(null),c=Gi((()=>l.value.genres.filter((e=>!l.value.searchGenres||e.name.toLowerCase().includes(l.value.searchGenres))))),u=Gi((()=>l.value.characters.filter((e=>!l.value.searchCharacters||e.name.toLowerCase().includes(l.value.searchCharacters)))));ao((()=>{$$().then((e=>{l.value=e,l.value.instruments.sort(((e,t)=>e.name.toLowerCase().localeCompare(t.name.toLowerCase()))),l.value.genres.sort(((e,t)=>e.name.toLowerCase().localeCompare(t.name.toLowerCase()))),l.value.characters.sort(((e,t)=>e.name.toLowerCase().localeCompare(t.name.toLowerCase())))})),s.value={id:a.loop.id,name:a.loop.name,characters:a.loop.characters,features:a.loop.features,instrumentId:a.loop.instrumentId||"",genres:a.loop.genres,bpm:a.loop.features?.loop?.tempo||null,selectedFeature:a.loop.features?.oneShot?"oneShot":"loop",key:a.loop.features?.loop?.key||a.loop.features?.oneShot?.key||""},document.body.classList.toggle("sounds-sample-details-editor-visible")})),uo((()=>{document.body.classList.toggle("sounds-sample-details-editor-visible")}));const d=Vt([{id:"loop",name:"Loop"},{id:"oneShot",name:"One Shot"}]),p={major:tl,minor:nl};function m(e,t){t.length>0&&!e.includes(t[0].id)&&e.push(t[0].id)}function f(){i.value=a.getSampleNameValidationError(s.value.name)}function h(){if(!i.value){r.value=!0;const{id:e,name:t,selectedFeature:n,key:i,bpm:l,instrumentId:c,genres:u,characters:d}=s.value;a.updateSampleDetails({id:e,name:t,instrumentId:c,genres:u,characters:d,features:{name:n,key:i,bpm:"loop"===n?l:null}}).then((e=>{o("closeModal"),a.onSuccess(e)})).catch((e=>{a.onFail(e)})).finally((()=>{r.value=!1}))}}return(t,n)=>(si(),pi("form",{class:"ds-modal ds-modal-size-small sounds-edit-sample-details-modal modal",onSubmit:ss(h,["prevent"])},[bi("header",CV,[bi("h2",EV,me("Sample details"),1)]),s.value.id?(si(),pi("div",IV,[bi("div",RV,[yi(TV,{sample:{...e.loop,features:{[s.value.selectedFeature]:{key:s.value.key,tempo:s.value.bpm}}},"image-url":e.imageUrl},null,8,["sample","image-url"])]),bi("div",AV,[xV,Cn(bi("input",{id:"sampleName","onUpdate:modelValue":n[0]||(n[0]=e=>s.value.name=e),class:ae(["input-text",{"ng-invalid":i.value}]),type:"text","aria-label":"Enter sample name",placeholder:"Enter sample name",minlength:"1",maxlength:"100",required:"","aria-required":"true",onBlur:f,onFocus:n[1]||(n[1]=e=>i.value=null)},null,34),[[Ya,s.value.name]]),i.value?(si(),pi("div",LV,me(i.value),1)):_i("v-if",!0)]),bi("div",OV,[bi("label",jV,me("Type"),1),bi("div",DV,[(si(!0),pi(ti,null,So(d.value,(e=>(si(),mi(VW,{key:e.id},{default:Tn((t=>{let{radioButtonId:o}=t;return[yi(FW,{modelValue:s.value.selectedFeature,"onUpdate:modelValue":n[2]||(n[2]=e=>s.value.selectedFeature=e),"radio-button-id":o,value:e.id},null,8,["modelValue","radio-button-id","value"]),yi(HW,{for:o},{default:Tn((()=>[ki(me(e.name),1)])),_:2},1032,["for"])]})),_:2},1024)))),128))])]),l.value?(si(),pi("div",NV,[bi("label",UV,me("Instrument"),1),bi("div",FV,[Cn(bi("select",{"onUpdate:modelValue":n[3]||(n[3]=e=>s.value.instrumentId=e)},[BV,(si(!0),pi(ti,null,So(l.value.instruments,(e=>(si(),pi("option",{key:e.id,value:e.id},me(e.name),9,WV)))),128)),VV],512),[[Qa,s.value.instrumentId]])])])):_i("v-if",!0),l.value?(si(),pi("div",qV,[zV,yi(Rj,{"dismissable-layer":!0},{trigger:Tn((e=>{let{setTriggerElement:t,isActive:o}=e;return[bi("div",{ref:t,"aria-expanded":o,class:"sounds-edit-sample-dropdown-trigger flex-space-between",onClick:n[9]||(n[9]=ss((()=>{}),["stop"]))},[bi("div",GV,[(si(!0),pi(ti,null,So(s.value.genres,((e,t)=>(si(),mi(rk,{key:e,shape:"squared",size:"compact",onClick:n[4]||(n[4]=ss((()=>{}),["stop"])),onRemove:e=>s.value.genres.splice(t,1)},{default:Tn((()=>[ki(me(l.value.genres.filter((t=>t.id===e))[0].name),1)])),_:2},1032,["onRemove"])))),128)),Cn(bi("input",{"onUpdate:modelValue":n[5]||(n[5]=e=>l.value.searchGenres=e),class:"sounds-edit-sample-dropdown-input",placeholder:0===s.value.genres.length?"Select genres":"",style:te({"--dropdown-input-min-width":o?"80px":null}),onClick:e=>o?e.stopPropagation():null,onBlur:n[6]||(n[6]=e=>l.value.searchGenres=null),onKeydown:[n[7]||(n[7]=cs((e=>e.target.value?null:s.value.genres.pop()),["delete"])),n[8]||(n[8]=cs(ss((e=>{m(s.value.genres,c.value),l.value.searchGenres=null}),["prevent"]),["enter"]))]},null,44,KV),[[Ya,l.value.searchGenres]])]),yi(bd,{class:"sounds-edit-sample-dropdown-trigger-chevron",size:20})],8,HV)]})),content:Tn((e=>{let{setContentElement:t}=e;return[bi("ul",{ref:t,class:"dropdown-menu sounds-edit-sample-dropdown-menu list-style-none"},[0===c.value.length?(si(),pi("li",YV," No genres found ")):_i("v-if",!0),(si(!0),pi(ti,null,So(c.value,(e=>(si(),pi("li",{key:e.id,"aria-selected":s.value.genres.includes(e.id)},[yi(OW,{class:"sounds-edit-sample-dropdown-option"},{default:Tn((t=>{let{checkboxId:o}=t;return[yi(wk,{modelValue:s.value.genres,"onUpdate:modelValue":n[10]||(n[10]=e=>s.value.genres=e),"checkbox-id":o,value:e.id},null,8,["modelValue","checkbox-id","value"]),yi(DW,{for:o,class:"sounds-edit-sample-dropdown-option-checkbox-label"},{default:Tn((()=>[ki(me(e.name),1)])),_:2},1032,["for"])]})),_:2},1024)],8,JV)))),128))],512)]})),_:1})])):_i("v-if",!0),l.value?(si(),pi("div",XV,[bi("label",ZV,me("Character"),1),bi("div",QV,[yi(Rj,{"dismissable-layer":!0,direction:"up"},{trigger:Tn((e=>{let{setTriggerElement:t,isActive:o}=e;return[bi("div",{ref:t,"aria-expanded":o,class:"sounds-edit-sample-dropdown-trigger flex-space-between",onClick:n[16]||(n[16]=ss((()=>{}),["stop"]))},[bi("div",tq,[(si(!0),pi(ti,null,So(s.value.characters,((e,t)=>(si(),mi(rk,{key:e,shape:"squared",size:"compact",onClick:n[11]||(n[11]=ss((()=>{}),["stop"])),onRemove:e=>s.value.characters.splice(t,1)},{default:Tn((()=>[ki(me(l.value.characters.filter((t=>t.id===e))[0].name),1)])),_:2},1032,["onRemove"])))),128)),Cn(bi("input",{"onUpdate:modelValue":n[12]||(n[12]=e=>l.value.searchCharacters=e),class:"sounds-edit-sample-dropdown-input",placeholder:0===s.value.characters.length?"Select characters":"",style:te({"--dropdown-input-min-width":o?"80px":null}),onClick:e=>o?e.stopPropagation():null,onBlur:n[13]||(n[13]=e=>l.value.searchCharacters=null),onKeydown:[n[14]||(n[14]=cs((e=>e.target.value?null:s.value.characters.pop()),["delete"])),n[15]||(n[15]=cs(ss((e=>{m(s.value.characters,u.value),l.value.searchCharacters=null}),["prevent"]),["enter"]))]},null,44,nq),[[Ya,l.value.searchCharacters]])]),yi(bd,{class:"sounds-edit-sample-dropdown-trigger-chevron",size:20})],8,eq)]})),content:Tn((e=>{let{setContentElement:t}=e;return[bi("ul",{ref:t,class:"dropdown-menu sounds-edit-sample-dropdown-menu list-style-none"},[0===u.value.length?(si(),pi("li",oq," No characters found ")):_i("v-if",!0),(si(!0),pi(ti,null,So(u.value,(e=>(si(),pi("li",{key:e.id,"aria-selected":s.value.characters.includes(e.id)},[yi(OW,{class:"sounds-edit-sample-dropdown-option"},{default:Tn((t=>{let{checkboxId:o}=t;return[yi(wk,{modelValue:s.value.characters,"onUpdate:modelValue":n[17]||(n[17]=e=>s.value.characters=e),"checkbox-id":o,value:e.id},null,8,["modelValue","checkbox-id","value"]),yi(DW,{for:o,class:"sounds-edit-sample-dropdown-option-checkbox-label"},{default:Tn((()=>[ki(me(e.name),1)])),_:2},1032,["for"])]})),_:2},1024)],8,rq)))),128))],512)]})),_:1})])])):_i("v-if",!0),bi("div",iq,[bi("div",aq,[bi("label",sq,me("BPM"),1),Cn(bi("input",{id:"bpm","onUpdate:modelValue":n[18]||(n[18]=e=>s.value.bpm=e),disabled:"loop"!==s.value.selectedFeature,class:"input-text sounds-edit-sample-form-field-input",type:"number",min:"40",max:"240",placeholder:"loop"===s.value.selectedFeature?"Enter BPM":"-",onInput:n[19]||(n[19]=()=>s.value.bpm=parseInt(s.value.bpm.toString().slice(0,3)))},null,40,lq),[[Ya,s.value.bpm]])]),bi("div",cq,[bi("label",uq,me("Key"),1),bi("div",dq,[yi(Rj,{"dismissable-layer":!0,direction:"up"},{trigger:Tn((e=>{let{setTriggerElement:t,isActive:o}=e;return[bi("div",{ref:t,"aria-expanded":o,class:"sounds-edit-sample-dropdown-trigger flex-space-between",onClick:n[20]||(n[20]=ss((()=>{}),["stop"]))},[s.value.key?(si(),pi("span",mq,me(s.value.key),1)):(si(),pi("span",fq,me("Select key"))),yi(bd,{class:"sounds-edit-sample-dropdown-trigger-chevron",size:20})],8,pq)]})),content:Tn((e=>{let{setContentElement:t,toggleContent:n}=e;return[bi("ul",{ref:t,class:"dropdown-menu sounds-edit-sample-dropdown-menu list-style-none",onClick:ss(n,["stop"])},[(si(!0),pi(ti,null,So([...p.major,...p.minor,null],(e=>(si(),pi("li",{key:e,value:e,"aria-selected":s.value.key===e,class:"sounds-edit-sample-dropdown-option flex-space-between",onClick:t=>s.value.key=e},[bi("span",null,me(e||"-"),1),s.value.key===e?(si(),mi(AW,{key:0,class:"sounds-selection-option-checkmark",size:16})):_i("v-if",!0)],8,gq)))),128))],8,hq)]})),_:1})])])])])):_i("v-if",!0),bi("footer",vq,[yi(Dd,{type:"button",size:"medium",color:"secondary",padding:"default","is-disabled":r.value,onClick:n[21]||(n[21]=e=>o("closeModal"))},{default:Tn((()=>[ki(me("Cancel"),1)])),_:1},8,["is-disabled"]),yi(Dd,{type:"submit",size:"medium",color:"primary",padding:"default","is-loading":r.value},{default:Tn((()=>[ki(me("Save"),1)])),_:1},8,["is-loading"])]),yi(ib,{onClick:n[22]||(n[22]=e=>o("closeModal"))})],32))}};function yq(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=Zo("$analytics"),n=Zo("AppNotifications"),o=Zo("Me"),r=o.isAnonymous()?Zo("appActions"):null,i=o.isAnonymous()?Zo("state"):null,a=e?i$():null;return{addPackToLibrary:function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!o.isAnonymous()){const r=[...mS.value];return mS.value.push(e.packId),R$({objectId:e.packId,userId:o.id}).then((()=>{window.location.pathname.includes("/sounds/")&&t.eventTrack("Add Pack To Favorites",{category:"Sounds",extra:{...e,target:s||kq[a.name],triggeredFrom:s||Nk(a.name)}})})).catch((e=>{throw mS.value=r,n.addNotification({content:e?.message||"Failed to add to Favorites, please try again later",classList:"alert",autoclose:5e3}),e}))}{const t=a?{path:a.path.split("/")[2],subpath:a.params.id}:{path:"pack",subpath:e.id};r.checkAllowed("favoriteSounds",{toState:"sounds",toParams:t},{title:"Sign up to find your favorite packs in one place",redirectState:btoa(JSON.stringify({path:i.href("sounds",t)}))})||ql.setItem("soundsPackToFavorite",JSON.stringify(e))}},addSampleToLibrary:function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!o.isAnonymous()){const r=[...pS.value];return pS.value.push(e.sampleId),C$({objectId:e.sampleId,userId:o.id}).then((()=>{window.location.pathname.includes("/sounds/")&&t.eventTrack("Add Sample To Favorites",{category:"Sounds",extra:{...e,target:s||kq[a.name],triggeredFrom:s||Nk(a.name)}})})).catch((e=>{throw pS.value=r,n.addNotification({content:e?.message||"Failed to add to Favorites, please try again later",classList:"alert",autoclose:5e3}),e}))}{const t={path:a.path.split("/")[2],subpath:a.params.id};r.checkAllowed("favoriteSounds",{toState:"sounds",toParams:t},{title:"Sign up to find your favorite samples in one place",redirectState:btoa(JSON.stringify({path:i.href("sounds",t)}))})||ql.setItem("soundsSampleToFavorite",JSON.stringify(e))}},removePackFromLibrary:function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const i=[...mS.value];return mS.value=mS.value.filter((t=>t!==e.packId)),function(e){let{userId:t,objectId:n}=e;return Uu.delete(`https://www.bandlab.com/api/v3.0/sounds/users/${t}/packs/${n}`).json().catch((function(e){return D$(e)}))}({objectId:e.packId,userId:o.id}).then((()=>{window.location.pathname.includes("/sounds/")&&t.eventTrack("blsounds_action",{platform:"firebase",params:{action:"remove",content_type:"pack",category:"sounds",content_id:e.id,is_user_content:!1,target:"favorites",triggered_from:r||Nk(a.name)}})})).catch((e=>{throw mS.value=i,n.addNotification({content:"Failed to remove pack from Favorites, please try again later",classList:"alert",autoclose:5e3}),e}))},removeSampleFromLibrary:function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const i=[...pS.value];return pS.value=pS.value.filter((t=>t!==e.sampleId)),function(e){let{userId:t,objectId:n}=e;return Uu.delete(`https://www.bandlab.com/api/v3.0/sounds/users/${t}/samples/${n}`).json()}({objectId:e.sampleId,userId:o.id}).then((()=>{window.location.pathname.includes("/sounds/")&&t.eventTrack("blsounds_action",{platform:"firebase",params:{action:"remove",content_type:"sample",category:"sounds",content_id:e.id,pack_slug:e.packSlug,is_user_content:!1,target:"favorites",triggered_from:r||Nk(a.name)}})})).catch((e=>{throw pS.value=i,n.addNotification({content:"Failed to remove sample from Favorites, please try again later",classList:"alert",autoclose:5e3}),e}))},checkUndoRemovePackFromLibrary:function(e,t){return new Promise((o=>{n.addNotification({title:"Removed from Favorites",content:e.name,autoclose:5e3,image:t,action:'<button type="button" class="button-dark button-height-32 button-padding-16 button-rounded" ng-click="$parent.innerScope.undoRemove()">Undo</button>',innerScope:{undoRemove:o}})}))},checkUndoRemoveSampleFromLibrary:function(e,t){return new Promise((o=>{n.addNotification({title:"Removed from Favorites",content:e.name,autoclose:5e3,image:t,action:'<button type="button" class="button-dark button-height-32 button-padding-16 button-rounded" ng-click="$parent.innerScope.undoRemove()">Undo</button>',innerScope:{undoRemove:o}})}))}}}function wq(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0;const n=e?r$():null,o=Zo("AppNotifications"),r=Zo("Me"),i=t?t.get("$analytics"):Zo("$analytics"),a=e?i$():null;function s(){return fS.value=!0,A$({userId:r.id}).then((e=>{hS.value=[...e],fS.value=!1})).catch((()=>{fS.value=!1}))}function l(t,n){return new Promise(((o,a)=>{d(t)?function(e){let{userId:t,displayName:n}=e;return Uu.post(`https://www.bandlab.com/api/v3.0/sounds/users/${t}/collections`,{json:{displayName:n}}).json().catch((function(e){return D$(e)}))}({userId:r.id,displayName:t}).then((t=>{hS.value.unshift(t),i.eventTrack("blsounds_action",{platform:"firebase",params:{action:"add",content_type:"collection",category:e?"sounds":"studio",content_id:t.collectionId,is_user_content:!0,target:"collections",triggered_from:n}}),o(t)})).catch((e=>{a(e)})):a()}))}function c(e){const t=hS.value.findIndex((t=>t.collectionId===e.collectionId));-1!==t&&(hS.value[t]=e)}function u(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return function(e){let{userId:t,collectionId:n,sampleId:o}=e;return Uu.put(`https://www.bandlab.com/api/v3.0/sounds/users/${t}/collections/${n}/${o}`).json().catch((function(e){return D$(e)}))}({userId:r.id,collectionId:t,sampleId:e.sampleId}).then((o=>{c(o),s(),window.location.pathname.includes("/sounds/")&&i.eventTrack("blsounds_action",{platform:"firebase",params:{action:"add",content_type:"sample",category:"sounds",content_id:e.id,pack_slug:e.packSlug,collection_id:t,is_user_content:!1,target:"collection",triggered_from:n||Nk(a.name)}})}))}function d(e){return gS.value=function(e){return e.trim().length<1||e.trim().length>100?"Name must be between 1 and 100 characters":null}(e),!gS.value}return{addToSoundsUserCollection:u,checkUndoRemoveFromSoundsUserCollection:function(e,t){return new Promise((n=>{o.addNotification({title:"Sample was removed from the collection.",content:e.name,autoclose:5e3,image:t,action:'<button type="button" class="button-dark button-height-32 button-padding-16 button-rounded" ng-click="$parent.innerScope.undoRemove()">Undo</button>',innerScope:{undoRemove:n}})}))},openAddToSoundsUserCollectionModal:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";_g(hW,{sample:e,onSuccess:()=>{o.addNotification({content:`${e.name} was added to your collection`,classList:"success",autoclose:5e3})},onFail:e=>{o.addNotification({content:e?.message||"Failed to add sample to collection, please try again later",classList:409===e.errorCode?"warning":"alert",autoclose:5e3})},addToSoundsUserCollection:(e,n)=>u(e,n,t),createCollection:l})},collectionInputError:gS,createCollection:l,deleteCollection:function(t,a){return new Promise(((l,c)=>{_g(kW,{message:`${t.displayName} and its samples will be deleted from My Sounds.`,onSuccess:()=>{t.isDeleting=!0,function(e){let{userId:t,collectionId:n}=e;return Uu.delete(`https://www.bandlab.com/api/v3.0/sounds/users/${t}/collections/${n}`).json().catch((function(e){return D$(e)}))}({userId:r.id,collectionId:t.collectionId}).then(s).then((()=>{i.eventTrack("blsounds_action",{platform:"firebase",params:{action:"remove",content_type:"collection",category:e?"sounds":"studio",content_id:t.collectionId,is_user_content:!0,target:"collections",triggered_from:a}}),window.location.href.includes(t.collectionId)&&(e?n.replace({name:"sounds.mySounds.collections"}):window.location.href="/sounds/my-sounds/collections"),o.addNotification({title:"Collection was deleted from My Sounds",content:`<span class="semibold-12">${t.displayName}</span> `,classList:"success",autoclose:5e3}),l()})).catch((e=>{t.isDeleting=!1,o.addNotification({title:"Error!",content:e?.message||"Failed to delete collection, please try again later",classList:"alert",autoclose:5e3}),c()}))}})}))},getCollections:s,removeFromSoundsUserCollection:function(t,n){return function(e){let{userId:t,collectionId:n,sampleId:o}=e;return Uu.delete(`https://www.bandlab.com/api/v3.0/sounds/users/${t}/collections/${n}/${o}`).json().catch((function(e){return D$(e)}))}({userId:r.id,collectionId:n,sampleId:t.sampleId}).then((o=>{c(o),i.eventTrack("blsounds_action",{platform:"firebase",params:{action:"remove",content_type:"sample",category:e?"sounds":"studio",content_id:t.id,pack_slug:t.packSlug,collection_id:n,is_user_content:!1,target:"collection",triggered_from:"collection"}})})).catch((e=>{throw o.addNotification({title:"Error!",content:e?.message||"Failed to remove sample from collection, please try again later",classList:"alert",autoclose:5e3}),e}))},updateCollection:function(t,n,o){return new Promise(((a,s)=>{d(n)?function(e){let{userId:t,displayName:n,collectionId:o}=e;return Uu.put(`https://www.bandlab.com/api/v3.0/sounds/users/${t}/collections/${o}`,{json:{displayName:n}}).json().catch((function(e){return D$(e)}))}({userId:r.id,displayName:n,collectionId:t.collectionId}).then((n=>{c(n),i.eventTrack("blsounds_action",{platform:"firebase",params:{action:"edit",content_type:"collection",category:e?"sounds":"studio",content_id:t.collectionId,is_user_content:!0,triggered_from:o}}),a()})).catch((e=>s(e))):s()}))}}}function $q(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=Zo("Me"),n=Zo("AppNotifications"),o=Zo("ProjectUploader"),r=Zo("User"),i=Zo("$analytics"),a=Zo("$http");function s(e){return function(e){let{userId:t,sample:n}=e;return Uu.put(`https://www.bandlab.com/api/v3.0/sounds/users/${t}/uploads/samples/${n.id}`,{json:n}).json().catch((function(e){return D$(e)}))}({userId:t.id,sample:e})}function l(e){return e.trim().length<1||e.trim().length>100?"Sample name should be between 1-100 characters":/^[\p{L}\p{M}\p{P}0-9\s!"#$%&'()*+,\-./:;<=>?[@^_`{|}~]{1,100}$/u.test(e)?null:"Name can contain only numbers and letters"}return{checkMembership:function(){return r.getMembershipStatus({userId:t.id}).$promise.then((e=>"Free"!==e.plan)).catch((()=>!1))},removeFromSoundsUploads:function(o){return new Promise(((r,a)=>{_g(EW,{message:`Sample ${o.name} will be removed`,onSuccess:()=>{o.isRemoving=!0,O$({userId:t.id,sampleId:o.id}).then((()=>{n.addNotification({title:"Sample was removed successfully",content:`<span class="semibold-12">${o.name}</span> `,classList:"success",autoclose:5e3}),o.fileSize&&(vS.value=vS.value+o.fileSize),i.eventTrack("blsounds_my_sounds_file_remove",{platform:"firebase",params:{file_size_mb:o.fileSize?Math.ceil(o.fileSize/1048576):null,available_storage_size_mb:Math.ceil(vS.value/1048576)}}),i.eventTrack("blsounds_action",{platform:"firebase",params:{action:"remove",content_type:"sample",category:e?"studio":"sounds",content_id:o.id,is_user_content:!0,target:"uploads",triggered_from:"uploads"}}),r()})).catch((e=>{o.isRemoving=!1,n.addNotification({title:"Error!",content:e?.message||"Failed to remove sample from Uploads, please try again later",classList:"alert",autoclose:5e3}),a()}))}})}))},editSoundsUploadsSampleMetadata:function(o,r){return new Promise(((a,c)=>{const u=structuredClone(Ot(o));_g(bq,{loop:u,imageUrl:`${t.picture.url}64x64`,updateSampleDetails:s,getSampleNameValidationError:l,onSuccess:t=>{Object.assign(o,t),n.addNotification({content:"Sample details saved",classList:"success",autoclose:5e3}),i.eventTrack("blsounds_my_sounds_uploaded_sample_edit",{platform:"firebase",params:{is_name_edited:u.name!==t.name,is_type_edited:Object.keys(u.features)[0]!==Object.keys(t.features)[0],is_instrument_edited:(u.instrumentId||"")!==(t.instrumentId||""),is_genre_edited:JSON.stringify(u.genres)!==JSON.stringify(t.genres),is_character_edited:JSON.stringify(u.characters)!==JSON.stringify(t.characters),is_bpm_edited:u.features?.loop?.tempo!==t.features?.loop?.tempo,is_key_edited:(u.features?.loop?.key||t.features?.loop?.key||"")!==(t.features?.loop?.key||t.features?.oneShot?.key||"")}}),i.eventTrack("blsounds_action",{platform:"firebase",params:{action:"edit",content_type:"sample",category:e?"studio":"sounds",content_id:t.id,is_user_content:!0,triggered_from:"uploads_sample_details"}}),a()},onFail:e=>{n.addNotification({content:e?.message||"Failed to update sample, please try again later",classList:"alert",autoclose:5e3}),c()}},{overlayClose:!1,onClose:r})}))},uploadSample:function(e,n){const r={isSounds:!0,createdAt:performance.now(),name:Lh(e.name).substring(0,100),file:e,progress:0,loaded:0,complete:!1,upload:s(),cancel:function(){let{isBatch:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Gf(o.queue,r),r.upload.cancel(e)},retry:function(){r.upload=s(),r.failed=!1,r.error=null}};function s(){let o,s;const l=new Promise(((n,l)=>{const c=new Promise(((e,t)=>{o=function(){t(new Error("Cancel"))}}));function u(){O$({userId:t.id,sampleId:s})}const d={formats:["audio/aac","audio/flac","audio/m4a","audio/mp3","audio/mp4","audio/mpeg","audio/wav","audio/webm","audio/x-aac","audio/x-m4a","audio/x-wav"],readable:"MP3, M4A, WAV, AAC, FLAC"};let p=(e.type??"").startsWith("video/")?"wav":e.name.split(".").pop()!==e.name?e.name.split(".").pop():Ah(e);((e.type??"").startsWith("video/")||!Ah(e)?Bh(e):Promise.resolve(e)).then((e=>Nh(e,d))).then((e=>jh(e,60))).then((e=>d.formats.includes(e.type)?e:(p="wav",Bh(e)))).then((e=>0===e.size?Promise.reject(new Error("Unable to import file. Please check that your file is not corrupted.")):e.size>vS.value?Promise.reject(new Error(`The file size (${jA(e.size)}) exceeds the available storage (${jA(vS.value)})`)):Promise.resolve(e))).catch((e=>{throw r.isOnlyCancellable=!0,e})).then((e=>Oh(e))).then((e=>Promise.race([L$({userId:t.id,fileObject:{name:e.name.replace(new RegExp(`\\.${p}$`),"").substring(0,100),format:p,features:{name:"oneShot"}}}).then((e=>(s=e.id,r.failed&&u(),e))),c]))).then((t=>Promise.race([a({method:"PUT",url:t.value,data:e,headers:{"Content-Type":t.contentType},uploadEventHandlers:{progress:function(e){r.total=e.total,r.loaded=e.loaded,r.progress=e.loaded/e.total}},timeout:()=>l(new Error("Timeout"))}),c]))).then((()=>{n(s)})).catch((e=>{r.failed=!0,r.error=e.message,409===e.errorCode&&(r.isOnlyCancellable=!0,r.error="Name can contain only numbers and letters"),s&&u(),i.eventTrack("blsounds_my_sounds_error",{platform:"firebase",params:{error_message:e.message,triggered_from:"uploads"}})}))}));return Object.assign(l.then((t=>{r.complete=!0,n(t),xh(e).then((n=>{i.eventTrack("blsounds_my_sounds_file_upload_success",{platform:"firebase",platforms:["amplitude"],params:{file_name:e.name,file_size_mb:Math.ceil(e.size/1048576),file_length_ms:Math.ceil(1e3*n),file_format:e.type,file_id:t}})}))})),{cancel:t=>(t||i.eventTrack("blsounds_my_sounds_file_upload_cancel",{platform:"firebase",params:{error_message:r.error,name_size_chars:Lh(e.name).length}}),o())})}o.queue.push(r)},getSampleNameValidationError:l}}const kq={"sounds.browse":"browse","sounds.collection":"collection","sounds.loops":"loops","sounds.oneShots":"one_shots","sounds.pack":"pack","sounds.packs":"packs","sounds.mySounds.favorites.samples":"my_sounds_favorites","sounds.mySounds.favorites.packs":"my_sounds_favorites","sounds.mySounds.collection":"my_sounds_collection","sounds.searchResults":"search"};function Sq(){const e=Mt({src:"",paused:!0});function t(){e.src=YS.src,e.paused=YS.paused}t(),YS.addEventListener("ended",t),YS.addEventListener("pause",t),YS.addEventListener("play",t),uo((function(){YS.removeEventListener("ended",t),YS.removeEventListener("pause",t),YS.removeEventListener("play",t)})),Xo("player",e)}function _q(e){const t=Zo("$analytics"),n=Zo("context"),o=Zo("player"),r=Gi((function(){return o.src===e.pack.audioUrl&&!o.paused}));return uo((function(){e.pack.audioUrl!==YS.src||YS.paused||YS.pause()})),{isPreviewingPack:r,previewPack:function(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";e.audioUrl!==YS.src||YS.paused?(KS.audioNode?.onended&&KS.audioNode.stop(),YS.src=e.audioUrl,YS.play().catch((()=>{})),t.eventTrack("blsounds_action",{platform:"firebase",params:{action:"preview",content_type:"pack",category:"studio",content_id:e.id,triggered_from:o||xq[n.tab.value]}})):YS.pause()}}}const Pq=Vt({}),Mq=Vt(0),Tq=Vt(null);function Cq(){const e=Zo("$analytics"),t=Zo("AudioStretch"),n=Zo("context"),o=Zo("EditorRevision"),r=Zo("scope");let i=0,a=0,s=0;const l=lh();function c(){return o.current?.metronome.pristine?1:Pq.value?.features.loop?.tempo/r.revision.metronome.bpm||1}function u(){Pq.value.playing?(Mq.value=l.currentTime-i+a,s=requestAnimationFrame(u)):cancelAnimationFrame(s)}return{handle:s,previewLoop:function d(p,m){let f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,h=arguments.length>3?arguments[3]:void 0,g=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";cancelAnimationFrame(s),Pq.value.playing&&!f&&(Mq.value=0),m?.scrollIntoView({block:"nearest"}),KS.audioNode?.onended&&KS.audioNode.stop(),KS.loop=p,Pq.value=p,Pq.value.playing=!(!f&&!h&&Pq.value.playing),YS.pause(),t.convertLoop(p,o.current,o.current?.metronome.pristine??!0).then((t=>{if(!(Pq.value===p&&p.playing||(p.playing=!1,f||h)))return;KS.audioNode=lh().createBufferSource(),KS.audioNode.connect(lh().destination),KS.audioNode.buffer=t,a=f,KS.audioNode.start(0,f),p.playing=!0,i=l.currentTime,cancelAnimationFrame(s),s=requestAnimationFrame(u);const o=r.$watch("revision.metronome.bpm",ay(((e,t)=>{e!==t&&(Pq.value={},d(p,m,0),o())}),100,{trailing:!0}));KS.audioNode.onended=()=>{"loop"in p.features&&Pq.value===p&&l.currentTime-i+a>=Pq.value.duration*c()?d(p,null,0,!0):(p.playing=!1,o())},e.eventTrack("blsounds_action",{platform:"firebase",params:{action:"preview",content_type:"sample",category:"studio",content_id:p.sampleId,pack_slug:p.packSlug,...n.tab.value.includes("collection")?{collection_id:n.selectedCollection.value.collectionId}:{},is_user_content:n.tab.value.includes("library.uploads"),triggered_from:g||Lq(n.tab.value,n.selectedPack.value,n.selectedCollection.value)}})}))},scaleTempo:c,selectedLoop:Pq,time:Mq}}function Eq(e,t){const n=Zo("context"),o=Zo("editorEvents"),r=Zo("player"),i=Zo("scope"),a=Vt([]),s=Vt([]),l=Vt([]),c=Vt({}),u=Vt([]),d=Vt([]),p=Vt([]),m=Vt(""),{handle:f,previewLoop:h,scaleTempo:g,selectedLoop:v,time:b}=Cq();let y,w;ao((function(){k(),e&&!t||(y=P(),w=M())}));let $=0;return Xn((()=>{y=P(),w=M()})),Zn((()=>{y(),w()})),co((function(){e&&!t||(y(),w())})),Ar((function(){r.paused||T()})),{addToTrack:function(e){T(),i.$emit(o.importFile,{...Dq(e),triggeredFrom:Lq(n.tab.value,n.selectedPack.value,n.selectedCollection.value),gesture:"double_tap"})},characters:a,characterNames:s,genres:l,instrumentNames:c,instruments:u,lastSearch:m,loopEls:d,loops:p,previewLoop:h,scaleTempo:g,selectedLoop:v,setupLoopFilters:k,stopPreview:T,time:b};function k(){return $$({features:e}).then((function(e){a.value=e.characters,l.value=e.genres,u.value=e.instruments,c.value=e.instruments.reduce((function(e,t){return e[t.id]=t.name,e}),{}),s.value=e.characters.reduce((function(e,t){return e[t.id]=t.name,e}),{})}))}function S(e){if(!p.value[e])return;v.value=p.value[e];const t=d.value[v.value.id].$el;t.scrollIntoView({block:"nearest"}),clearTimeout($),$=setTimeout((()=>{v.value={},h(p.value[e],t)}),500)}function _(){return p.value.findIndex((e=>e.audioUrl===v.value.audioUrl))}function P(){return i.$on(o.keyDown.previousLoop,(()=>{S(Math.min(Math.max(0,_()-1),p.value.length))}))}function M(){return i.$on(o.keyDown.nextLoop,(()=>{S(Math.min(Math.max(0,_()+1),p.value.length))}))}function T(){KS.audioNode?.onended&&KS.audioNode.stop(),cancelAnimationFrame(f)}}function Iq(){return{after:Vt(null),availableLoopsPerCharacter:Vt({}),availableLoopsPerGenre:Vt({}),characters:Vt([]),currentSort:Vt("recent"),ended:Vt(!1),genres:Vt([]),lastScrollTop:Vt(null),lastSearch:Vt(""),loopsLibraryPacks:Vt(null),packs:Vt([])}}const Rq={loops:"loops",oneshots:"one_shots",packs:"pack","library.favorites.samples":"my_sounds_favorites","library.collections":"my_sounds_collection"},Aq={packs:"packs","library.favorites.packs":"my_sounds_favorites"},xq={loops:"samples",oneshots:"samples",packs:"packs","library.favorites.samples":"favorite_samples","library.collections":"collections","library.uploads":"uploads","library.favorites.packs":"favorite_packs"};function Lq(e,t,n){return t?.id?"pack":n?.collectionId?"collection":xq[e]}function Oq(){const e=Zo("context"),t=Zo("AppNotifications"),n=Zo("$analytics"),{addPackToLibrary:o,addSampleToLibrary:r,removePackFromLibrary:i,removeSampleFromLibrary:a,checkUndoRemovePackFromLibrary:s,checkUndoRemoveSampleFromLibrary:l}=yq(!1),{addToSoundsUserCollection:c}=wq(!1);return{addSampleToLibraryStudio:function(t){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";r(t,o).then((()=>{e.tab.value.includes("library")||Bq(t.sampleId),n.eventTrack("Add Sample To Favorites",{category:"Mix Editor",extra:{...t,target:o||Rq[e.tab.value],triggeredFrom:o||Lq(e.tab.value,e.selectedPack.value,e.selectedCollection.value)}})}))},removeSampleFromLibraryStudio:function(t){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return a(t).then((()=>{e.tab.value.includes("library")||Wq(t.sampleId),n.eventTrack("blsounds_action",{platform:"firebase",params:{action:"remove",content_type:"sample",category:"sounds",content_id:t.id,pack_slug:t.packSlug,is_user_content:!1,target:"favorites",triggered_from:o||Lq(e.tab.value,e.selectedPack.value,e.selectedCollection.value)}})}))},checkUndoRemoveSampleFromLibrary:l,addPackToLibraryStudio:function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";o(t).then((()=>{"library.favorites.packs"!==e.tab.value&&Bq(t.packId),n.eventTrack("Add Pack To Favorites",{category:"Mix Editor",extra:{...t,target:Aq[e.tab.value],triggeredFrom:r||xq[e.tab.value]}})}))},removePackFromLibraryStudio:function(t){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return i(t).then((()=>{"library.favorites.packs"!==e.tab.value&&Wq(t.packId),n.eventTrack("blsounds_action",{platform:"firebase",params:{action:"remove",content_type:"pack",category:"sounds",content_id:t.id,is_user_content:!1,target:"favorites",triggered_from:o||xq[e.tab.value]}})}))},checkUndoRemovePackFromLibrary:s,addSampleToCollectionStudio:function(o,r){c(o,r).then((()=>{t.addNotification({content:`${o.name} was added to your collection`,classList:"success",autoclose:5e3}),n.eventTrack("blsounds_action",{platform:"firebase",params:{action:"add",content_type:"sample",category:"studio",content_id:o.id,pack_slug:o.packSlug,collection_id:r,is_user_content:!1,target:"collection",triggered_from:Lq(e.tab.value,e.selectedPack.value,e.selectedCollection.value)}})})).catch((e=>{t.addNotification({content:e?.message||"Failed to add sample to collection, please try again later",classList:409===e.errorCode?"warning":"alert",autoclose:5e3})}))}}}function jq(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=Zo("context");let n;const o=Vt(null),r=Vt(e);return ao((()=>{o.value.addEventListener("dragstart",(e=>{e.stopPropagation(),e.dataTransfer.setDragImage&&(n=document.createElement("div"),n.textContent=r.value.name,n.classList.add("text-truncate"),n.style.backgroundColor="#282c32",n.style.borderRadius="4px",n.style.color="#fff",n.style.fontSize="14px",n.style.padding="8px 12px",n.style.position="absolute",n.style.transform="translateX(-500px)",n.style.minWidth="100px",n.style.maxWidth="200px",n.style.width="auto",document.body.appendChild(n),e.dataTransfer.setDragImage(n,0,0)),HS.value={...Dq(r.value),triggeredFrom:Lq(t.tab.value,t.selectedPack.value,t.selectedCollection.value),gesture:"drag_and_drop"}})),o.value.addEventListener("dragend",(function(){n&&document.body.removeChild(n),HS.value={}}))})),{element:o,loop:r}}function Dq(e){return{id:e.id,bpm:e.features?.loop?.tempo??e.features?.oneShot?.tempo,duration:e.duration,key:e.features?.loop?.key??e.features?.oneShot?.key,name:e.name,original:e,src:e.audioUrl,type:"audio"}}function Nq(e,t){Object.keys(t).map((n=>{t[n].isExpanded=n===e&&!t[n].isExpanded}))}function Uq(e){return Object.values(e).map((e=>e.list?e.list?.filter((e=>e.isSelected)).length:e.selectedCount?e.selectedCount:e.isSelected?1:0)).reduce(((e,t)=>e+t))}const Fq=Vt(JSON.parse(ql.getItem("soundsLibraryNewItems"))||[]);function Bq(e){const t=JSON.parse(ql.getItem("soundsLibraryNewItems"))||[];return t.push(e),ql.setItem("soundsLibraryNewItems",JSON.stringify(t)),Fq.value=t,t}function Wq(e){if(Fq.value.includes(e)){const t=Fq.value.filter((t=>t!==e));Fq.value=t,ql.setItem("soundsLibraryNewItems",JSON.stringify(t))}}const Vq={onBeforeInitLesson:function(){return new Promise((e=>function(e){zB().afterDelay((()=>HB("studio-menu-hamburger-button"))).afterDelay((()=>{const e=document.getElementById("studio-menu-help-submenu");e&&(e.style.visibility="visible")})).afterDelay((()=>e("begin")))}(e)))},onBeforeLessonEnd:function(){return HB("studio-menu-hamburger-button"),Promise.resolve()},steps:[{title:"Get Started",content:"You can take the introduction tour at any time later, by going to the <strong>Help</strong> section under the menu top left of the screen.",targetEl:{selector:"#studio-menu-start-tutorial-button",direction:"right"},highlighter:{direction:"right"},hideProgress:!0,buttonForward:{title:"Got It",hasCaret:!1,callback:FB}}]},qq=zn((()=>import("./chunk-2254347c.js")));async function zq(e,t){const n=e.get("$rootScope"),o=e.get("EditorPlayer"),r=e.get("EditorRevision");r.selectedTrack.volume=t,await o.current.setTrackVolume(r.selectedTrack,t),gR.start("syncVolume"),n.$applyAsync()}function Hq(e,t,n){const o=e.get("$rootScope"),r=e.get("EditorCycle"),i=e.get("editorEvents");r.set(t,n),o.$broadcast(i.cycleChanged),o.$applyAsync()}async function Gq(e,t){const n=e.get("EditorPlayer");e.get("EditorState").isCycling=t,await n.current.setCycleState(t)}function Kq(e){const{$injector:t}=e;return new Promise((e=>{_g(qq,{resolve:e,isEnd:!1},OB)})).then((n=>{if("begin"===n){const e=t.get("EditorRevision");e.current.key="D minor",e.current.metronome.bpm=120,qv()}return"maybe"===n&&UB(Vq,e),t.get("Identity").setUsedStudio(),n}))}function Yq(){return new Promise((e=>{_g(qq,{resolve:()=>e(),isEnd:!0},OB),zv()}))}angular.module("bandlab.editor").directive("mixEditor",["$analytics","$injector","$q","$rootScope","$state","AppNotifications","AudioStretch","DrumMachine","Editor","EditorAllowActions","EditorAutomation","EditorCollaboratorsState","EditorData","EditorDB","editorEvents","EditorHelper","EditorHistory","EditorImporter","EditorLoader","EditorMidiSamples","EditorPlayback","EditorReset","EditorRevision","EditorScroll","EditorScrollState","EditorSocket","EditorState","EditorTrack","Me","MidiDevice","MidiEditor","MidiEditorState","MidiMapping","Modal","Page",function(e,t,n,o,r,i,a,s,l,c,u,d,p,m,f,h,g,v,b,y,w,$,k,S,P,M,T,C,E,I,R,A,x,L,O){return{replace:!0,restrict:"E",scope:{revision:"="},templateUrl:"https://www.bandlab.com/web-app/editor/partials/_mix-editor-df4ae4a9.html",controller:["$scope",function(j){const D=rd((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Promise.resolve().then((()=>rb)).then((function(t){let{logMixEditorOpen:n}=t;n({open_attribution:r.params.open_attribution??e.open_attribution,open_attribution_category:r.params.open_attribution_category??e.open_attribution_category??"revision"})}))}));function N(e){Promise.resolve().then((()=>rb)).then((function(t){let{logStudioRating:n}=t;n(e.detail)}))}document.addEventListener("ratingEvent",N);var U=n.defer();function F(e,t,n){(function(e){try{var t=C.addTrack(e);return t.type===Qs?h.displayAutoPitch({toggle:!1}):t.type===Ys||t.type===Js?h.displayPresetSettings({toggle:!1}):h.displayInstrument({toggle:!1}),t}catch(e){}})(e="piano"===t?angular.extend(e,{name:n,soundbank:al,type:"piano"}):t===Ks?angular.extend(e,{name:n,soundbank:"808-kit",type:Ks}):angular.extend(e,{name:n,type:t})),D({open_attribution:{"drum-machine":"drum_machine","guitar-bass":"bass","guitar-electric":"guitar",piano:"midi_instrument",sampler:"sampler",voice:"voice"}[t],open_attribution_category:"ss_track_type"})}async function B(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=zn((()=>import("./chunk-161351b8.js")));var o=angular.noop,r=n.defer();return T.isInBackground=!0,_g(t,{onCancel:D,addTrack:function(t,n){i(),F(e,t,n)},openTemplateBrowser:e=>W("addTrackModal",e),browseLoops:function(){j.displayTab("Loops"),D({open_attribution:"loops",open_attribution_category:"ss_sound_content"})},importFile:function(){return document.querySelector(".mix-editor-track-placeholder").click(),new Promise((e=>{o=j.$on(f.importFile,(function(){e(),i(),D({open_attribution:"import",open_attribution_category:"ss_upload"})}))}))}},{escapeClose:!0,overlayClose:!0,onClose:function(){T.isInBackground=!1,o(),r.resolve()}}),r.promise;function i(){A.isVisible=!1,r.resolve()}}function W(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"addTrackModal",t=arguments.length>1?arguments[1]:void 0;D();const n=zn((()=>import("./chunk-b37eea57.js")));T.isInBackgrund=!0,_g(n,{back:function(){"addTrackModal"===e&&B()},maxHeight:t,origin:e,useTemplateInStudio:V},{escapeClose:!0,overlayClose:!0,onClose:()=>{T.isInBackground=!1}})}function V(e){return j.showAskSaveModal((async()=>{const{logSongTemplateLoad:t,logSongTemplateFirstModify:n}=await Promise.resolve().then((()=>rb));m.removeSnapshot(k.current.id),h.hidePanel(),j.closeSideTab();try{await l.loadRevision({newProject:!1,id:e.revisionId,template:e}),j.revision=k.current,T.isRevisionLoadedFromTemplateBrowser=!0,T.crTime=0;const o=j.$watch((()=>T.hasRevisionChanges),(()=>{T.hasRevisionChanges&&(o(),n())}));O.setMetadata({title:j.revision.song.name}),O.update(),t()}catch(e){}}))}function q(){let{state:e=T,time:t=T.crTime}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=e===T?"scale:timeline":"scale:notesTimeline",o=e.scalePx;e.scalePx=4*e.scale*k.current.metronome.bpm/120,e.containerWidth=JS.SONG_DURATION_MAX*e.scalePx;const r=e===T?A:T;if(A.isLocked&&r.scalePx!==e.scalePx){A.isZooming=!0;const n=r===T?"scale:timeline":"scale:notesTimeline";r.scalePx=e.scalePx,r.containerWidth=e.containerWidth,gR.start(n,!1,{oldScalePx:o,time:t,scalePx:e.scalePx},!0,!1),setTimeout((function(){A.isZooming=!1}))}gR.start(n,!1,{oldScalePx:o,time:t,scalePx:e.scalePx},!0,!1),document.body.style.setProperty("--mix-editor-track-width",`${T.containerWidth}px`),document.body.style.setProperty("--midi-editor-track-width",`${A.containerWidth}px`)}function z(){T.isSnapping=!T.isSnapping}j.user=E,j.isCollaborating=!0,j.historyState=g.state,j.state=T,j.midiEditorState=A,j.editorCollaboratorState=d,T.scale=jl[35],A.scale=jl[57],j.trackColors=zs,j.getTrackAccentColors=e=>h.getTrackAccentColors(e,T.hasSoloTrack),j.addTrack=F,j.broadcastScale=q,j.displaySongStarter=async function(){var e;(e=new L({template:'<songstarter-modal close="close()"></songstarter-modal>',class:"modal-large",overlayClose:!1,onCreate:function(){T.isInBackground=!0},onDestroy:function(){T.isInBackground=!1},contentScope:{close:function(){e.destroy()}}})).show()},j.displayAddTrack=B,j.disconnectSocket=function(){m.removeSnapshot(j.revision.id),M.leaveSession(),r.go("mixEditor",{id:r.params.id},{location:"replace"})},j.save=function(e){let{publish:t=!1,pristine:n=!1,redirect:r=!0,triggeredFrom:i}=e;return T.isPreviewingRevision?t?void o.$broadcast("MixEditor:askPublishOlderRevision"):void o.$broadcast("MixEditor:askRestoreOlderRevision"):(t&&(YS.pause(),s.stop(),w.pausePlay()),l.startSave({publish:t,pristine:n,redirect:r,triggeredFrom:i}).then((function(e){return o.$broadcast("MixEditor:savedRevision",e),O.setMetadata({title:j.revision.song.name}),O.update(),e})))},j.toggleSnap=z,j.toggleArm=function(){T.isArming=!T.isArming,T.isArming||(k.armedTracks[2]=null)},j.toggleAutomationRecording=function(){T.isRecordingAutomation=!T.isRecordingAutomation},j.toggleFollowPlayhead=function(){JS.FOLLOW_PLAYHEAD=!JS.FOLLOW_PLAYHEAD,localStorage.followPlayhead=JS.FOLLOW_PLAYHEAD},j.toggleOverdubbing=function(){JS.OVERDUBBING=!JS.OVERDUBBING,localStorage.overdubbing=JS.OVERDUBBING},j.toggleQuantization=function(){JS.QUANTIZATION=!JS.QUANTIZATION,localStorage.quantization=JS.QUANTIZATION},j.zoomIn=function(){let{state:e=T,scale:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const o=e===T?"zoomIn":"midiRollZoomIn";if(!c.isAllowed(o))return;var r=jl.findIndex((t=>t>e.scale));if(t)e.scale=t;else{if(!jl[r])return;e.scale=jl[r]}const i=e===T?A:T;A.isLocked&&i.scale!==e.scale&&(i.scale=e.scale),q({state:e,...n})},j.zoomOut=function(){let{state:e=T,scale:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const o=e===T?"zoomOut":"midiRollZoomOut";if(!c.isAllowed(o))return;var r=jl.findIndex((t=>t>=e.scale))-1;if(t)e.scale=t;else{if(!jl[r])return;e.scale=jl[r]}const i=e===T?A:T;A.isLocked&&i.scale!==e.scale&&(i.scale=e.scale),q({state:e,...n})},j.initZoomTimer=function(){let{state:e=T}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=e===T?f.startZoom:f.startZoomMIDI,n=e===T?f.stopZoom:f.stopZoomMIDI,r=e===T?"scale:applyZoomTimeline":"scale:applyZoomNotesTimeline",i=e===T?A:T;if(!T.isZooming&&(T.isZooming=!0,o.$broadcast(t),A.isLocked)){const e=i===T?f.startZoom:f.startZoomMIDI;o.$broadcast(e)}clearTimeout(T.zoomTimer),T.zoomTimer=setTimeout((()=>{if(o.$broadcast(n),gR.start(r),A.isLocked){gR.start(i===T?"scale:applyZoomTimeline":"scale:applyZoomNotesTimeline")}T.isZooming=!1}),250)},j.notifyTrackLimit=C.notifyTrackLimit,j.shouldNotifyTrackLimit=C.shouldNotifyTrackLimit,j.canChangeInput=()=>c.isAllowed("changeInput"),j.displayInstrument=h.displayInstrument,j.displayAudioEditor=h.displayAudioEditor,j.displayAutoPitch=h.displayAutoPitch,j.displayMidiEditor=h.displayMidiEditor,j.displayPresetSettings=h.displayPresetSettings,j.getTrack=()=>k.selectedTrack,j.hasSelectedNotes=R.hasSelectedNotes,j.hidePanel=h.hidePanel,j.isTrackTransposable=()=>h.isTrackTransposable(A.track),j.refreshRollLayout=R.refreshRollLayout,j.resizeRollHeight=R.resizeRollHeight,j.storeRollHeight=R.storeRollHeight,j.actionTooltip=Ac(_F),j.actionShortcut=Ac(PF),j.blurInput=e=>{13!==e.which&&27!==e.which||e.currentTarget.blur()},j.updateMirror=e=>{setTimeout((function(){e.target.parentElement.previousElementSibling.textContent=e.target.value}))},j.toggleAutomationView=function(){T.isAutomationVisible=!T.isAutomationVisible},j.toggleRegionAudioStretch=function(){T.isRegionAudioStretchEnabled=!T.isRegionAudioStretchEnabled},j.canSlice=function(){return!T.isPlaying&&!T.isRecording&&j.revision.tracks.filter((function(e){return e.type!==Ks})).some((function(e){return e.regions.some((function(t){return(k.selectedRegions.has(t)||e===k.selectedTrack)&&t.startPosition<=T.crTime&&t.endPosition>=T.crTime}))}))},j.triggerSlice=function(){j.$broadcast(f.slice,T.crTime)},JS.IS_LEGACY_KEYBOARD="true"===localStorage.isLegacyKeyboard,isNaN(localStorage.countInDuration)||(JS.COUNT_IN_DURATION=parseInt(localStorage.countInDuration)),localStorage.preferSharps||(JS.PREFER_SHARPS="true"===localStorage.preferSharps),j.savePreferSharps=e=>{JS.PREFER_SHARPS=e,localStorage.preferSharps=JS.PREFER_SHARPS},j.getPreferSharps=()=>JS.PREFER_SHARPS,n.race([l.init(j.revision),U.promise]).then((function(){if(j.revision=k.current,r.params.id){const e=b.pushTask("loadSample");M.joinProject().then((function(){if("true"===r.params.autoconnect||T.hasRealTimeCollaboratByDefault)return Promise.all([M.getMySessionStatus(),M.getSessionUsers()]).then((function(){if(j.getConnected().length>0&&"remote"===j.editorCollaboratorsState.status||T.hasRealTimeCollaboratByDefault)return M.joinSession()}))})).finally((()=>{b.finishTask(e),Mp(E,"band_permissions_update_enabled").then((function(e){j.isBandPermissionsUpdateEnabled="true"===e,j.isBandPermissionsUpdateEnabled&&"Band"===j.revision.song.author.type&&!j.revision.canPublish&&(j.isBandSaveTooltipActive=!0,setTimeout((function(){j.isBandSaveTooltipActive=!1,j.$applyAsync()}),1e4))}))}))}if(_.some(j.revision.samples,{error:!0})&&i.addNotification({title:"Samples could not be loaded. Refresh the page and try again.",classList:"alert",autoclose:5e3}),localStorage.followPlayhead&&(JS.FOLLOW_PLAYHEAD=JSON.parse(localStorage.followPlayhead)),localStorage.overdubbing&&(JS.OVERDUBBING=JSON.parse(localStorage.overdubbing)),localStorage.quantization&&(JS.QUANTIZATION=JSON.parse(localStorage.quantization)),0===j.revision.tracks.length&&r.params.songstarter)j.displaySongStarter();else if(0!==j.revision.tracks.length||r.params.userId||r.params.sampleId||["file",Ks].includes(r.params.source))if(r.params.midiId){if(k.projectOrigin="songstarter",r.params.key){const e=decodeURI(r.params.key);(tl.includes(e)||nl.includes(e))&&(R.transposeRevision(j.revision,e),j.revision.key=e)}if(r.params.bpm&&+r.params.bpm>=40&&+r.params.bpm<=240){var e=b.pushTask("postProcessAudio");const t=j.revision.metronome.bpm,n=j.revision.tracks.flatMap((e=>e.regions));j.revision.metronome.bpm=+r.params.bpm,Promise.all(n.filter((e=>h.isAudioRegion(e))).map((function(e){const n=e.playbackRate*k.current.metronome.bpm/t;return a.convertRegion(e,n,e.pitchShift,!0)}))).finally((function(){b.finishTask(e),p.updateSongDuration()}))}D({open_attribution:"songstarter",open_attribution_category:"external"})}else r.params.splitter?k.projectOrigin="splitter":D();else{if(!E.ftue.usedStudio||r.params.tutorial)return void j.initWelcomeTutorial();j.displayAddTrack({pushUndo:!1})}r.params.preset||r.params.effect||r.params.open_effects_library?h.displayPresetSettings({toggle:!1}):(r.params.soundbank||r.params.source===Ks)&&h.displayInstrument({toggle:!1}),j.revision.tracks.forEach((function(e){e.isFrozen&&(e.isFrozen=!1,C.freezeTrack(j,e));const t=(e.automation.volume.length?"volume":e.automation.pan.length&&"pan")||u.getAutomatableParameters(e.effects).find((function(e){return e.automation.length}));k.trackAutomationParameters.set(e,t||"volume")})),I.init(),x.pruneMappings(),x.updateMappings()})).catch((function(e){e.message!==dh&&(Sentry.onLoad((function(){Sentry.captureException(e||gh,{error:e,extra:{revision:k.current}})})),alert(gh))})),q({state:T}),q({state:A}),j.$on("MixEditor:onAfterAddDrumMachineTrack",((e,t)=>{let{track:n,resolve:o}=t;j.$apply((()=>{C.setSelected(n),h.displayInstrument({toggle:!1}),S.scrollToBottom(),o()}))})),j.$on(f.importFile,(function(t,n){c.isAllowed("import")&&(v.importFile(n),n.file&&e.eventTrack("Import File",{category:"Mix Editor",label:n.file.type}))})),j.$on(f.keyDown.addTrack,(function(){j.displayAddTrack()})),j.$on(f.keyDown.zoomInPianoRollVertical,(()=>j.zoomPianoRollVertical(1))),j.$on(f.keyDown.zoomOutPianoRollVertical,(()=>j.zoomPianoRollVertical(-1))),j.zoomPianoRollVertical=function(e,t){if(function(e){return 10===CB.value&&e<0||194===CB.value&&e>0}(e))return;const n=function(e,t,n,o){const{y:r,height:i}=t.getBoundingClientRect(),a=e+((o?o.y:r+i/2)-r-xl);if(!IB.value){let e;e=Math.floor(a/CB.value),e=As(e,0,uB.value.length-1),IB.value={originRowIndex:e}}const s=IB.value.originRowIndex*CB.value;return e+(IB.value.originRowIndex*AB(n)-e-(s-e))}(P.notesTop,P.notesEl,e,t);P.notesTop=n,gR.start("scroll:notesTop",!1,P.notesTop,!0,!1),j.$apply((()=>function(e){clearTimeout(RB),CB.value=AB(e),RB=window.setTimeout((()=>{xB()}),300)}(e,P.notesEl,P.notesTop))),P.notesTop=n,gR.start("scroll:notesTop",!1,P.notesTop,!0,!1)},j.$on(f.keyDown.zoomIn,(function(){const e=A.hasFocus?A:T;j.initZoomTimer({state:e}),j.zoomIn({state:e})})),j.$on(f.keyDown.zoomOut,(function(){const e=A.hasFocus?A:T;j.initZoomTimer({state:e}),j.zoomOut({state:e})})),j.$on(f.keyDown.save,(function(){j.save({publish:!1,triggeredFrom:"keyboard_shortcut"})})),j.$on(f.keyDown.selectAllRegions,(function(){k.selectedRegions=new Set(p.getRegions())})),j.$on(f.keyDown.snapReleased,(function(){T.isSnapping=!T.isSnapping})),j.$on(f.keyDown.snapPressed,(function(){T.isSnapping=!T.isSnapping})),j.$on(f.keyDown.toggleLoops,(function(){j.toggleTab("Loops")})),j.$on(f.keyDown.toggleSnap,(function(){z()})),j.$on(f.keyDown.recordAutomation,(function(){j.toggleAutomationRecording()})),j.$on(AT,(function(){j.$applyAsync()})),j.$on("$destroy",(function(){m.deleteFiles(),m.removeSnapshot(j.revision.id),mB(),MB.value=PB[0],TB.value=16,xB(),document.body.classList.remove("studio-tutorial-mode"),YA.value=null,JA.value=-1,document.querySelectorAll(".tutorial-active").forEach((e=>e.classList.remove("tutorial-active"))),qS.showPitch=!1,qS.octave=2,$.reset(),U.reject(new Error(dh)),document.removeEventListener("ratingEvent",N)})),j.$watch((()=>{if(OS.value=k.current.key,jS.value=k.selectedTrack.id,!k.selectedTrack||!k.selectedTrack.regions||k.selectedTrack.regions.some((e=>!y.get(e.sampleId)))||k.selectedTrack.type===Ks)return void(sB.value=[]);const e=k.selectedTrack.regions.flatMap((e=>y.get(e.sampleId).notes.map((e=>e.midiNote))));sB.value=Array.from(new Set(e)).sort(((e,t)=>e-t))})),j.initWelcomeTutorial=function(){const e={addTrackAndDisplayPanel:function(){let{type:e,name:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};F({},e,t)},closeSideTab:function(){o.$broadcast("MixEditor:closeSideTab")},displayAddTrack:B,displayPresetSettings:function(){h.displayPresetSettings(),j.$applyAsync()},displayTab:j.displayTab,hidePanel:h.hidePanel,setProjectTempo:function(e){k.current.metronome.bpm=e,j.$applyAsync()},selectPreset:C.selectPreset},n=function(){const e=[{title:"Add a Track",videoURL:"https://videos.ctfassets.net/ob0gzt6pkpwb/4B0jfFKidoSbn1xNAm6pGo/06e87199f3ae2f909150682ca7daeb2f/1_New_Track.mp4",content:"In order to add musical elements to your song, youll need to add a track. Well show you how in the next step.",buttonForward:{...LB,callback:e=>{let{scope:t}=e;t.displayAddTrack(),BB({delay:350})}}},{title:"Add a Drum Beat",content:"For now, lets start by adding a beat as a foundation for your song.",targetEl:{selector:"#studio-add-track-modal-drum-machine-button",direction:"right"},highlighter:{direction:"right"},buttonForward:{...LB,callback:function(e){let{$injector:t}=e;const n=t.get("$rootScope"),o=t.get("EditorRevision"),r=t.get("EditorState");HB("studio-add-track-modal-drum-machine-button"),r.isAudioInputActive=!1;const i=n.$watch((()=>o.selectedTrack),(e=>{e.type===Ks&&(i(),zq(t,.45).catch((()=>{})).finally(BB))}))}}},{title:"Program Drums",content:"Weve set a drum pattern for you and enabled the preview for you to hear it in action!",targetEl:{selector:"#studio-tutorial-welcome-beat-starter",direction:"right"},highlighter:{direction:"right"},buttonForward:{...LB,callback:e=>{let{$injector:t}=e;const n=t.get("DrumMachine");HB("studio-tutorial-welcome-beat-starter"),n.toggle(),BB()}}},{title:"Program Drums",content:"Weve set a drum pattern for you and enabled the preview for you to hear it in action!",targetEl:{selector:"#studio-tutorial-welcome-audio-input-panel",direction:"top"},highlighter:{direction:"top"},buttonForward:{...LB,callback:e=>{let{$injector:t}=e;t.get("DrumMachine").stop(),BB()}}},{title:"Set Project Tempo",content:"Great! Now that you have a drum beat, lets set the project tempo to make the beat run faster or slower. <em>(bpm stands for Beats Per Minute)</em>",targetEl:{selector:"#studio-toolbar-met-bpm-tsig",direction:"bottom"},highlighter:{},buttonForward:{...LB,callback:e=>{let{scope:t}=e;t.setProjectTempo(125),document.getElementById("studio-toolbar-bpm")?.classList.add("tutorial-active"),BB()}}},{title:"Set Project Tempo",content:"Great! Now that you have a drum beat, lets set the project tempo to make the beat run faster or slower. <em>(bpm stands for Beats Per Minute)</em>",targetEl:{selector:"#studio-toolbar-met-bpm-tsig",direction:"bottom"},highlighter:{},buttonForward:{...LB,callback:e=>{let{scope:t}=e;t.hidePanel(),document.getElementById("studio-toolbar-bpm")?.classList.remove("tutorial-active"),BB()}}},{title:"Add Effects",content:"This is a good time to spice up that drum beat. Were going to use an Effect from our wide range of <em>fx</em> <strong>Presets</strong> for that. Effect Presets help color the audio signal.",videoURL:"https://videos.ctfassets.net/ob0gzt6pkpwb/7hLii640cF9piLSQAg0ExT/4b46c3e7a2b1aae9b94a8807512e958e/2_Add_an_effect.mp4",targetEl:{selector:"#mix-editor-footer-preset-settings",direction:"top"},highlighter:{direction:"top"},buttonForward:{...LB,callback:e=>{let{scope:t}=e;t.displayPresetSettings(),BB()}}},{title:"Add a Preset",content:"We have chosen a preset that makes the drums sound more natural by adding a bit of reverb.",videoURL:"https://videos.ctfassets.net/ob0gzt6pkpwb/7hLii640cF9piLSQAg0ExT/4b46c3e7a2b1aae9b94a8807512e958e/2_Add_an_effect.mp4",targetEl:{selector:"#studio-preset-selector-carousel",direction:"right"},buttonForward:{...LB,callback:e=>{let{$injector:t,scope:n}=e;const o=t.get("EffectsPreset");n.selectPreset(o.getBySlug("woodenRoom")),BB()}}},{title:"BandLab Sounds",content:"Time to add your second track. BandLab has a large collection of premade Sounds for you to choose from!",targetEl:{selector:"#mix-editor-footer-loops",direction:"top"},highlightOnEnter:!0,highlighter:{direction:"top"},buttonForward:{...LB,callback:e=>{let{scope:t}=e;t.hidePanel(),t.displayTab("Loops"),HB("studio-tutorial-welcome-7"),BB()}}},{title:"BandLab Sounds",content:"For now, weve preselected a melody loop for you.",targetEl:{selector:"#mix-editor-footer-loops",direction:"top"},highlighter:{direction:"top"},buttonForward:{...LB,callback:e=>{let{$injector:t,scope:n}=e;const o=t.get("EditorImporter"),r=t.get("EditorPlayback"),i=$s(t.get("EditorRevision").current.metronome);b$({ids:"fab7fa20-07de-4f66-92cc-aee1f6906b3d"}).then((e=>{const n=4*i,r=e?.loops?.[0],a=Dq(r),s=function(e){return e.get("EditorTrack").addTrack({type:"voice",name:"Audio"})}(t);return o.importFile({time:n,track:s,...a})})).then((()=>zq(t,.45))).then((()=>Gq(t,!0))).then((()=>{Hq(t,4*i,8*i),r.togglePlay()})).catch((()=>{})).finally((()=>{n.closeSideTab(),n.hidePanel(),BB({delay:300})}))}}},{title:"BandLab Sounds",content:"For now, weve preselected a melody loop for you.",targetEl:{selector:"#mix-editor-footer-loops",direction:"top"},highlighter:{direction:"top"},buttonForward:{...LB,callback:e=>{let{$injector:t}=e;const n=t.get("EditorPlayback"),o=t.get("EditorRevision"),r=t.get("EditorState"),i=$s(o.current.metronome);n.togglePlay(),r.crTime=0,Hq(t,0,4*i),Gq(t,!1).then((()=>BB()))}}},{title:"Add a MIDI Track",videoURL:"https://videos.ctfassets.net/ob0gzt6pkpwb/1JGbTUAUroTtZXaEQSJN4g/c575408b77fa313c43099f066878e159/3_Add_a_MIDI.mp4",content:"Time to add a bassline! Were going to use a MIDI track for this so we can play the notes on our keyboard or MIDI controller.",buttonForward:{...LB,callback:()=>{HB("mix-editor-add-track-button"),BB({delay:500})}}},{title:"Lets add a MIDI bassline",content:"Hit Next to add a <strong>Virtual Instrument</strong> track so we can start creating a bassline.",targetEl:{selector:"#studio-add-track-flyout-midi-button",direction:"right"},highlighter:{direction:"right"},buttonForward:{...LB,callback:e=>{let{$injector:t,scope:n}=e;HB("mix-editor-add-track-button"),n.addTrackAndDisplayPanel({type:"piano",name:"Bassline"}),zq(t,.4).then((()=>BB()))}}},{title:"Select Soundbank",content:"This is where you select your bass sound. For now, we have preselected one for you from our <strong>Virtual Instruments</strong>.",targetEl:{selector:"#studio-soundbank-flyout-button",direction:"bottom"},highlighter:{},buttonForward:{...LB,callback:()=>{zB().afterDelay((()=>{HB("studio-soundbank-flyout-button")})).afterDelay((()=>{const e=document.getElementById("studio-soundbank-flyout-search-input").querySelector("input");e&&GB(e,"Bass Lead")})).afterDelay((()=>{HB(null,".soundbank-list-item"),BB()}))}}},{title:"Select Soundbank",content:"This is where you select your bass sound. For now, we have preselected one for you from our <strong>Virtual Instruments</strong>.",targetEl:{selector:"#studio-soundbank-flyout-button",direction:"bottom"},highlighter:{},buttonForward:{...LB,callback:e=>{let{$injector:t,scope:n}=e;const o=t.get("EditorImporter"),r=t.get("EditorRevision");Uu.get("https://assets.ctfassets.net/ob0gzt6pkpwb/6nd1NE4QNRazUQj4IHQQTT/5e63e8f16a0e781f7c975b99752deae1/studio-tutorial-welcome-bassline.mid").blob().then((e=>o.importFile({file:e,time:0,track:r.current.tracks[r.current.tracks.length-1]}))).then((()=>{n.hidePanel();const e=r.current.tracks[r.current.tracks.length-1].regions[0];e.endPosition=8*$s(r.current.metronome),e.loopLength=4*$s(r.current.metronome),document.querySelector(`.mix-editor-region[data-id="${e.id}"]`)?.setAttribute("id","studio-tutorial-welcome-10")})).catch((()=>{})).finally(BB)}}},{title:"Record MIDI",content:"Heres an example of a bassline with MIDI notes.",targetEl:{selector:"#studio-tutorial-welcome-10",direction:"bottom"},highlighter:{},buttonForward:{...LB,callback:e=>{let{$injector:t}=e;const n=t.get("EditorRevision");Hq(t,0,8*$s(n.current.metronome)),BB()}}},{title:"Arrange Song",content:"If you want to hear all the parts of the song from start to end, well need to set the <strong>Cycle</strong> to the full 8 bars.",videoURL:"https://videos.ctfassets.net/ob0gzt6pkpwb/FsNwAuCFlvuDOM1G4CejT/4c594781153521552e582146884321b2/4_Arrangement.mp4",buttonForward:{...LB,callback:e=>{let{$injector:t}=e;const n=t.get("EditorPlayback");Gq(t,!0).then((()=>{n.togglePlay(),BB()}))}}},{title:"Cycle Enabled",content:"<strong>Cycle</strong> allows you to listen to a section of your project in a continuous loop. This can be helpful for practicing, songwriting, and mixing.",targetEl:{selector:"#mix-editor-cycle",direction:"bottom"},highlighter:{direction:"bottom"},buttonForward:{...LB,callback:e=>{let{$injector:t}=e;t.get("EditorPlayback").stop(),BB()}}},{title:"Mix your song",content:"Now that we have a couple of tracks, we can adjust their volume to make them sound good together.",videoURL:"https://videos.ctfassets.net/ob0gzt6pkpwb/3x2NApyXXA3bctZJLeVL42/a43cfb419946d56ce8d48f428d3fcd06/5_Mixing.mp4",buttonForward:{...LB,callback:e=>{let{$injector:t}=e;const n=t.get("EditorRevision"),o=n.current.tracks[n.current.tracks.length-1];document.querySelector(`.mix-editor-track-header[data-id="${o.id}"]`)?.querySelector(".mix-editor-slider-cursor")?.setAttribute("id","studio-tutorial-welcome-12"),BB()}}},{title:"Levels",content:"Here you can adjust the track volume by dragging the slider. Keep an eye on the output meter, you want to avoid the output signal going in the red.",targetEl:{selector:"#studio-tutorial-welcome-12",direction:"right"},highlighter:{direction:"right"},buttonForward:{...LB,callback:e=>{let{$injector:t}=e;const n=t.get("EditorRevision"),o=n.current.tracks[n.current.tracks.length-1];document.querySelector(`.mix-editor-track-header[data-id="${o.id}"]`)?.querySelector(".mix-editor-track-header-solo-mute")?.setAttribute("id","studio-tutorial-welcome-13"),BB()}}},{title:"Mute and Solo",content:"Do you only want to hear certain tracks at a time? Use the <strong>Solo</strong> and <strong>Mute</strong> functions!",targetEl:{selector:"#studio-tutorial-welcome-13",direction:"right"},highlighter:{direction:"right"},buttonForward:{...LB,callback:()=>{GB(document.getElementById("studio-project-name-input"),"My Song"),BB()}}},{title:"Name Project",content:"Time to give your Project a name!",targetEl:{selector:"#studio-project-name-input",direction:"bottom"},highlighter:{},buttonForward:{...LB,callback:()=>BB()}},{title:"Save Project",content:"Save your progress and come back to your project at any time. When youre happy with the result, you can publish, master, and distribute it to digital platforms using BandLab Distribution.",offsetX:90,offsetY:100,targetEl:{selector:"#studio-header-save-button",direction:"left"},highlighter:{direction:"right"},buttonForward:{...LB,callback:e=>{let{$injector:t,scope:n}=e;t.get("Editor").startSave({publish:!1}).finally((()=>{FB({$injector:t,scope:n})}))}}}];return{onBeforeInitLesson:Kq,onBeforeLessonEnd:Yq,steps:e}}();UB(n,{$injector:t,scope:e})},j.showAskSaveModal=function(e){c.shouldAskToSave()&&k.current.tracks.some((e=>e.regions.length))?h.show2StepSaveModal({saveFn:()=>{j.save({publish:!1,redirect:!1}).then((t=>{l.displaySavingSuccess(t),setTimeout(e,2e3)}))},onDiscard:e}):e()},j.openTemplateBrowser=W,j.useTemplateInStudio=V,function(){const e=MF();document.documentElement.style.setProperty("--audio-input-scrollbar-size",`${e}px`)}()}]}}]),angular.module("bandlab.editor").directive("allowAction",["EditorAllowActions",function(e){return{restrict:"A",priority:-100,compile:function(t,n){return e.isAllowed(n.allowAction)||t.addClass("disabled").attr("disabled","disabled"),function(t,n,o){t.$watch("state",(function(){e.isAllowed(o.allowAction)?n.removeClass("disabled").removeAttr("disabled"):n.addClass("disabled").attr("disabled","disabled")}),!0)}}}}]),angular.module("bandlab.editor").directive("mixEditorAreaSelection",["EditorRevision","EditorScroll","EditorScrollState","EditorState","EditorTrack",function(e,t,n,o,r){return{restrict:"A",link:function(i,a){var s,l,c,u,d,p,m,f;function h(e,t){m=e,f=t}function g(){var e=Math.min(d,m),t=Math.min(p,f),n=Math.max(d,m),o=Math.max(p,f);s.css({left:`${e}px`,top:`${t}px`,right:`calc(100% - ${n}px)`,bottom:`calc(100% - ${o}px)`})}function v(e){for(const t of i.revision.tracks)for(const n of t.regions)if(n.id===e)return n}function b(e){return!(e.bottomRight.y<Math.min(p,f)||Math.max(p,f)<e.topLeft.y||e.topLeft.x>Math.max(d,m)||Math.min(d,m)>e.bottomRight.x)}function y(){e.selectedRegions.clear(),u.filter(b).filter((e=>e.model.canEdit)).forEach((function(t){e.selectedRegions.add(t.model)}))}function w(e){var r,s=a[0].getBoundingClientRect(),u=a[0].parentElement.scrollLeft,v=a[0].scrollTop,b=a[0].clientHeight+s.top,w=a[0].clientWidth;e.target===a[0]?h(e.offsetX,e.offsetY+a[0].scrollTop):h(s.left>e.pageX&&0===u?0:Math.min(e.pageX-s.left,w),s.top>e.pageY&&0===v?0:Math.min(e.pageY,b)-s.top+v),Math.max(Math.abs(p-f),Math.abs(d-m))>5&&(o.isAreaSelecting=!0),g(),y(),i.$digest(),a[0].setPointerCapture(e.pointerId),c(),clearInterval(l),l=setInterval((function(){r=function(e,t){const o=a[0].scrollHeight,r=a[0].clientWidth,i=n.SCROLL_STEP,s=a[0].parentElement.getBoundingClientRect();return s.top>t?(f=Math.max(f-i,0),{up:!0}):s.top+s.height<=t?(f=Math.min(f+i,o),{down:!0}):s.left>e?(m=Math.max(m-i,0),{left:!0}):s.left+s.width-37<=e?(m=Math.min(m+i,r),{right:!0}):void 0}(e.clientX,e.clientY),t.manualScroll(r),g()}),30)}function $(){if(y(),i.$digest(),e.selectedRegions.size){const t=p>f?0:e.selectedRegions.size-1,n=Array.from(e.selectedRegions)[t];r.setSelected(e.current.tracks.find((e=>e.id===n.trackId)))}o.isAreaSelecting=!1,s.remove(),a.removeClass("selecting"),clearInterval(l),a.off("pointermove",w),window.removeEventListener("pointerup",$),d=0,p=0,m=0,f=0}a.on("pointerdown",(function(e){const t=a[0].getBoundingClientRect().top;1!==e.which||e.ctrlKey||e.target.closest(".mix-editor-region")||e.target.closest(".mix-editor-automation")||(s&&s.remove(),s=angular.element('<div class="mix-editor-area-selection"><div>'),a.prepend(s),a.addClass("selecting"),function(e,t){d=e,p=t,m=e,f=t}(e.offsetX,e.clientY+n.tracksEl.scrollTop-t),u=function(e){return Array.from(document.querySelectorAll(".mix-editor-region")).map((function(t){const o=t.getBoundingClientRect();return{model:v(t.getAttribute("data-id")),topLeft:{x:t.offsetLeft,y:o.top-e+n.tracksTop},bottomRight:{x:t.offsetLeft+o.width,y:o.top-e+o.height+n.tracksTop}}}))}(t),a.on("pointermove",w),window.addEventListener("pointerup",$),c=rd((function(){document.addEventListener("mouseup",(function(e){e.stopPropagation()}),{capture:!0,once:!0})})))}))}}}]),angular.module("bandlab.audio").directive("mixEditorArpeggiatorControls",["$injector","EditorPlayer","EditorState",function(e,t,n){return{restrict:"E",replace:!0,template:'<div id="midi-fx-arp" class="midi-fx-container"></div>',link:function(o,r){const i=Mt({onUpdateArpeggiatorSettings:function(e){const n={...o.getTrack()};t.current.updateArpeggiatorSettings(e,n.id)}});o.$watch((function(e){const{getTrack:t}=e;i.track={...t()},i.isAudioInputVisible=n.isAudioInputVisible})),import("./chunk-30d932ed.js").then((function(t){let{mountArpeggiatorControls:n}=t;const a=n(r[0],{$injector:e,scope:o},i);o.$on("$destroy",(function(){a.unmount()}))}))}}}]);const Jq=90,Xq=128,Zq=144,Qq=160,ez=176,tz=64,nz=192,oz=208,rz=224,iz=0,az=1,sz=2,lz=3,cz=4,uz=5,dz=6,pz=7,mz=32,fz=47,hz=81,gz=84,vz=88,bz=89,yz=127,wz=15360,$z=8,kz=24,Sz="MThd",_z="\0\0\0",Pz="\0\0",Mz="\0",Tz=[0,255,47,0],Cz=[77,84,114,107],Ez={"A#":"Bb","C#":"Db","D#":"Eb","F#":"Gb","G#":"Ab"},Iz={A:21,B:23,C:12,D:14,E:16,F:17,G:19},Rz={12:"C",13:"C#",14:"D",15:"D#",16:"E",17:"F",18:"F#",19:"G",20:"G#",21:"A",22:"A#",23:"B"},Az=["C major","G major","D major","A major","E major","B major","F major","C major","G major","D major","A major","E major","B major","F major","C major"],xz=["A minor","E minor","B minor","F minor","C minor","G minor","D minor","A minor","E minor","B minor","F minor","C minor","G minor","D minor","A minor"];function Lz(e){return"number"!=typeof e&&/[^0-9]/.test(e)?function(e){const t=/([A-G])(#+|b+)?([0-9]+)$/i.exec(e),n=t[1].toUpperCase(),o=t[2]||"";return 12*parseInt(t[3],10)+Iz[n]+("#"===o.substr(0,1)?1:-1)*o.length}(e):parseInt(e,10)}function Oz(e,t){let n,o=0,r=e;return t=t||!1,e>23&&(o=Math.floor(e/12)-1,r=e-12*o),n=Rz[r],t&&n.indexOf("#")>0&&(n=Ez[n]),n+o}function jz(e){let t=Math.floor(6e7/e);const n=[];do{n.unshift(255&t),t>>=8}while(t);for(;n.length<3;)n.push(0);return n}function Dz(e){return String.fromCharCode.apply(null,e)}function Nz(e,t){if(t)for(;e.length/2<t;)e=`0${e}`;const n=[];let o,r;for(r=e.length-1;r>=0;r-=2)o=0===r?e[r]:e[r-1]+e[r],n.unshift(parseInt(o,16));return n}function Uz(e){if(e<0)throw new Error(`Invalid tick value ${e}`);let t=127&e,n=!0;const o=[];for(e>>=7;e;)t<<=8,t|=127&e|128,e>>=7;for(;n;)o.push(255&t),128&t?t>>=8:n=!1;return o}function Fz(e,t){return 60/t*e/(arguments.length>2&&void 0!==arguments[2]?arguments[2]:wz)}function Bz(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:wz;return Math.round(e/60*t*n)}function Wz(e,t){return[Az,xz][t][e+7]}function Vz(e){return Az.includes(e)?[Az.indexOf(e)-7,0]:xz.includes(e)?[xz.indexOf(e)-7,1]:[null,null]}function qz(e,t){const n=Vt(function(){const t=ql.getItem(e);if(!t)return new Map;const n=JSON.parse(t).map((e=>{let[t,n]=e;return[t,new Set(n)]}));return new Map(n)}());function o(e){return e??="new",n.value.has(e)||n.value.set(e,new Set),n.value.get(e)}function r(e,t){e??="new",o(e).add(t)}function i(e,t){return e??="new",o(e).has(t)}return Lr(n,(()=>{s(),t()}),{deep:!0}),{cleanEntries:function(e,t){e??="new";const r=o(e),i=t.map((e=>e.id)),a=Array.from(r).filter((e=>i.includes(e))),s=[...r].slice().sort(),l=a.slice().sort();s.length===l.length&&s.every(((e,t)=>e===l[t]))||n.value.set(e,new Set(a))},isTrackPropertySet:i,getEntriesWithProperty:o,unsetTrackProperty:a,setTrackProperty:r,toggleTrackProperty:function(e,t){e??="new",i(e,t)?a(e,t):r(e,t)},onSaveRevision:function(e,t){e??="new",n.value.set(t,n.value.get(e)||new Set),"new"===e&&n.value.delete("new"),s()}};function a(e,t){e??="new",o(e).delete(t)}function s(){const t=Array.from(n.value.entries()).slice(0,100).filter((e=>e[1].size>0)).map((e=>{let[t,n]=e;return[t,Array.from(n)]}));ql.setItem(e,JSON.stringify(t))}}function zz(){const e=window.getComputedStyle(document.body);return{TRACK_HEIGHT:parseInt(e.getPropertyValue("--mix-editor-track-height")),TRACK_COLLAPSED_HEIGHT:parseInt(e.getPropertyValue("--mix-editor-track-collapsed-height")),TRACK_GROUP_HEADER_HEIGHT:parseInt(e.getPropertyValue("--mix-editor-track-group-header-height"))}}function Hz(e,t){return e&&e.length?Cj(e,Vf(t)):[]}angular.module("bandlab.editor").filter("pathString",["EditorAutomation",function(e){return function(t){var n;if(t)return 0!==t.automation.length?((n=t.automation.slice()).unshift({position:-10,value:n[0].value}),n.push({position:JS.SONG_DURATION_MAX+10,value:n[n.length-1].value})):n=[{position:0,value:t.value},{position:JS.SONG_DURATION_MAX,value:t.value}],n.map((function(n){return`${e.convertTimeToX(n.position)},${e.convertValueToY(n.value,t.height,t.meta)}`})).join(" ")}}]).directive("mixEditorAutomation",["$document","$filter","EditorAllowActions","EditorAutomation","editorEvents","EditorHelper","EditorHistory","EditorPlayer","EditorRevision","EditorScrollState","EditorState",function(e,t,n,o,r,i,a,s,l,c,u){return{replace:!0,restrict:"E",templateUrl:"https://www.bandlab.com/web-app/editor/partials/_mix-editor-automation-ae3b3d9c.html",link:function(d,p){let m=0,f=[];var h,g,v,b,y,w,$,k,S,P=o.MARKER_AREA,M={pan:ml,sendLevel:fl,volume:pl}[l.trackAutomationParameters.get(d.track)||"volume"];d.selectionMark={value:0},d.isReadoutAtEndOfTrack=e=>{const{timelineLeft:t,timelineEl:n}=c,o=n.getBoundingClientRect().width+t-Al-80,r=u.scalePx*JS.SONG_DURATION_MAX-80;return e>o||e>r};let T=null;p[0].addEventListener("contextmenu",(e=>{T=e.offsetX,o.currentTrackId.value=d.track.id})),d.hasPointsInClipboard=function(){if("automation"!==zS.value?.type)return!1;const{automation:e,trackId:t}=zS.value.data;return e.length>0&&t===d.track.id},d.$on(r.keyDown.copy,(function(){u.isAutomationVisible&&o.currentTrackId.value===d.track.id&&d.copySelectedPoints()})),d.$on(r.keyDown.paste,(function(){u.isAutomationVisible&&o.currentTrackId.value===d.track.id&&d.hasPointsInClipboard()&&d.pasteSelectedPoints(!0)})),d.copySelectedPoints=function(){zS.value={type:"automation",data:{automation:_.cloneDeep(d.selectedPoints),trackId:d.track.id}}},d.pasteSelectedPoints=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];a.pushUndo(d.revision);const t=zS.value.data.automation.map((e=>e.position)).sort(((e,t)=>e.position-t.position)),n=t[0];let r;if(T&&!e){if(r=o.convertXtoTime(T)-n,T=null,u.isSnapping){const e=n+r,t=i.snapToGrid(e,u.snapDuration,{padding:10/u.scalePx});r+=t-e}}else r=u.crTime-n;const s=zS.value.data.automation.map((e=>({position:e.position+r,value:e.value}))),c=d.track.automation[M&&M.name]||l.trackAutomationParameters.get(d.track)&&l.trackAutomationParameters.get(d.track).automation||[];o.pasteSelection(c,s),d.selectedPoints=s,re(c),oe()},d.getAutomationData=function(){let e=l.trackAutomationParameters.get(d.track);return(M=e?.metadata||{pan:ml,sendLevel:fl,volume:pl}[e||"volume"])&&"sendLevel"===M.name?e=d.track.auxSends[0].sendLevel:!M||"volume"!==M.name&&"pan"!==M.name?(k=e?.index,S=e?.param,$=e?.effect,e=$.params[S]):e=d.track[M.name],{automation:d.track.automation[M&&M.name]||M&&"sendLevel"===M.name&&d.track.auxSends[0].automation||l.trackAutomationParameters.get(d.track)&&l.trackAutomationParameters.get(d.track).automation||[],track:d.track,height:p[0].clientHeight,meta:M&&M.metadata||M||{},value:e}};const C=t("displayUnit");function E(){return d.track.automation[M?.name]||"sendLevel"===M?.name&&d.track.auxSends[0].automation||l.trackAutomationParameters.get(d.track)?.automation||[]}d.getMarkerMidId=()=>`marker-mid: url(#markerCircle-${d.track.id});`,d.resetAutomation=function(){a.pushUndo(d.revision),"pan"===M.name?(d.track.automation.pan=[],s.current.setTrackPanAutomation(d.track,d.track.automation.pan)):"volume"===M.name?(d.track.automation.volume=[],s.current.setTrackVolumeAutomation(d.track,d.track.automation.volume)):l.trackAutomationParameters.get(d.track)&&(Gf(l.trackAutomationParameters.get(d.track).automation,Boolean),s.current.setTrackEffectAutomation(d.track,k,S,l.trackAutomationParameters.get(d.track).automation,u.crTime)),d.selectedPoints=[],gR.start("syncVolume")},d.$watch((function(){return l.trackAutomationParameters.get(d.track)}),(function(e){S=e?.param,$=e?.effect,M=e?.metadata||{pan:ml,sendLevel:fl,volume:pl}[e||"volume"],d.selectedPoints=[]})),d.toProperUnit=function(e){return"volume"===M.name?ys(e):C(e,ml)},d.deleteSelectedPoints=()=>ne(d.selectedPoints),d.$on(r.keyDown.undo,j),d.$on(r.keyDown.redo,j),d.$on("Automation:ClearSelectedPoints",j),d.$on(r.keyDown.deleteSelectedAutomationPoints,d.deleteSelectedPoints),Lr(o.currentTrackId,(e=>{d.track.id!==e&&(d.selectedPoints=[])}));const I=p[0].getElementsByTagName("polyline")[0],R=p[0].querySelector(".hover-dot");let A=!1,x=!1;function L(){d.selectedPointsCoordinates=o.convertToCoordinates(d.selectedPoints,p[0].clientHeight,M)}function O(){L(),d.selectionMark={value:0},R.style.visibility="hidden"}function j(){d.selectedPoints=[],O()}d.selectedPoints=[],d.selectedPointsCoordinates=[],d.$watch("selectedPoints",L,!0),gR.add("scroll:timelineLeft",O),d.$on("$destroy",(()=>{gR.remove("scroll:timelineLeft",O)}));const{areaEl:D,isAreaSelecting:N,areaCoordinates:U,onPointerDown:F,onPointerMove:B,onPointerUp:W}=function(e){const t=Vt(document.createElement("div"));t.value.classList.add("mix-editor-area-selection");const n=Vt(!1),o=document.querySelector(".mix-editor-ruler"),r=document.querySelector(".mix-editor-tracks");let i=0;const a=Mt({x0:0,y0:0,x1:0,y1:0}),s=Gi((()=>{const{x0:e,x1:t,y0:n,y1:o}=a;return{left:Math.min(e,t),top:Math.min(n,o),right:Math.max(e,t),bottom:Math.max(n,o)}}));return Lr(s,(e=>{t.value.style.left=`${e.left}px`,t.value.style.top=`${e.top}px`,t.value.style.right=`calc(100% - ${e.right}px)`,t.value.style.bottom=`calc(100% - ${e.bottom}px)`})),{areaEl:t,areaCoordinates:s,isAreaSelecting:n,onPointerDown:function(e,t){!function(e,t){a.x0=e,a.y0=t,a.x1=e,a.y1=t}(e.offsetX,e.offsetY),i=t},onPointerUp:function(){e.classList.remove("selecting"),n.value=!1,a.x1=0,a.y0=0,a.x1=0,a.y1=0},onPointerMove:function(t){e.classList.add("selecting"),n.value=!0;const{top:s,bottom:l}=e.getBoundingClientRect();let c;c=Math.max(0,i,t.offsetX),c=Math.min(c,i+(r.clientWidth-17));const u=s-o.getBoundingClientRect().bottom,d=u<0?Math.abs(u):0,p=r.getBoundingClientRect().bottom-l,m=p<0?Math.abs(p):0;let f;f=Math.min(t.offsetY,e.clientHeight-m-(m>0?17:0)),f=Math.max(f,0,d),function(e,t){a.x1=e,a.y1=t}(c,f)}}}(p[0]);function V(){R.style.visibility="hidden",p.off("pointermove",Z),p.off("pointerleave",V),d.$digest()}p.on("pointerenter",(function(){p.on("pointermove",Z),p.on("pointerleave",V)})),p.on("pointerdown",(function(t){if(2!==t.button&&n.isAllowed("editTrack")){if(o.currentTrackId.value=d.track.id,clearTimeout(b),w=p[0].getBoundingClientRect(),v=Q(t)){if(b)return function(e){e.shiftKey||(d.selectionMark={value:0},ne([Q(e)]))}(t),void(b=!1);r(),Z(null,v)}else{if(b)return function(e){v=te({posX:e.offsetX,posY:e.offsetY-P/2},!0),e.shiftKey&&(d.selectedPoints.push(v),d.$digest())}(t),void(b=!1);!function(e){if(A)return v=te({posX:e.offsetX,posY:Math.min(e.offsetY,p[0].clientHeight-P)}),void d.$digest();d.selectedPoints.length>0&&!e.shiftKey&&(d.selectedPoints=[],d.$digest())}(t),r(),F(t,c.timelineLeft-Al)}(function(e){g=_.cloneDeep(d.revision),y=[...d.track.automation[M&&M.name]||l.trackAutomationParameters.get(d.track)&&l.trackAutomationParameters.get(d.track).automation||[]],h={...v},z=_.cloneDeep(E()),m={y:e.pageY,x:Math.max(e.clientX-w.left,P/2)},Y()})(t),p[0].setPointerCapture(t.pointerId),e.on("pointermove",X),e.on("pointerup",J),p.off("pointermove",Z)}function r(){b=setTimeout((function(){b=!1}),q)}})),d.getCursor=()=>N.value?"crosshair":"auto";const q=500;let z,H,G,K;function Y(){f=_.cloneDeep(d.selectedPoints.map((e=>({value:M===pl?gs(e.value/pl.range,1):Ss(e.value,M),position:e.position})))),v&&(H=ee(v,d.selectedPoints));const e=f.map((e=>e.position));K=JS.SONG_DURATION_MAX-Math.max(...e),G=-Math.min(...e)}function J(t){!v||h.position===v.position&&h.value===v.value||g&&(a.pushUndo(g),g=null),function(e){if(!v||N.value||x)return;if(!e)return d.selectedPoints=[v],void d.$digest();const t=d.selectedPoints.indexOf(v);t>=0?d.selectedPoints.splice(t,1):d.selectedPoints.push(v),d.$digest()}(t.shiftKey),x=!1,N.value&&(W(),p[0].removeChild(D.value)),d.$apply(),e.off("pointermove",X),e.off("pointerup",J),p.on("pointermove",Z)}function X(e){if(!v)return p.prepend(D.value),B(e),function(e){const{left:t,top:n,right:r,bottom:i}=U.value,a=d.track.automation[M&&M.name]||M&&"sendLevel"===M.name&&d.track.auxSends[0].automation||l.trackAutomationParameters.get(d.track)&&l.trackAutomationParameters.get(d.track).automation||[];e.shiftKey||(d.selectedPoints=[]),o.convertToCoordinates(a,p[0].clientHeight,M).forEach(((e,o)=>{e.posX>=t&&e.posX<=r&&e.posY>=n&&e.posY<=i&&d.selectedPoints.push(a[o])}))}(e),void d.$digest();d.selectedPoints.includes(v)||(e.shiftKey?d.selectedPoints.push(v):d.selectedPoints=[v],Y()),x=!0;const t=Math.max(e.clientX-w.left,P/2)-m.x,n=m.y-e.pageY,{position:r}=f[H];let a=o.convertXtoTime(t);if(u.isSnapping){const e=r+a,t=i.snapToGrid(e,u.snapDuration,{padding:5/u.scalePx});a+=t-e}d.selectedPoints.forEach(((e,t)=>{const o=ee(e,z),{value:r,position:i}=f[t],s=As(r+n/p[0].clientHeight,0,1),l=_s(M===pl?vs(s*pl.range,pl.range):ks(Ps(s,M),M),M),c=i+As(a,G,K);z[o]={position:c,value:l},e.position=c,e.value=l,t===H&&(v.position=c,v.value=l)})),function(e,t,n,o){const r=e.map((e=>e.position)),i=t.map((e=>e.position)),a=e.map((e=>ee(e,n))).sort(),s=a.reduce(((e,t,n,o)=>(0===n||t!==o[n-1]+1?e.push([t]):e[e.length-1].push(t),e)),[]),c=new Set;s.forEach((e=>{const t=e[0],s=n[t].position,l=[{initPos:i[r.indexOf(s)],currPos:s,currIndex:t}];if(e.length>1){const t=e[e.length-1],o=n[t].position,a=i[r.indexOf(o)];l.push({initPos:a,currPos:o,currIndex:t})}o.forEach(((e,t)=>{if(a.includes(t))return;const n=l.reduce(((n,o)=>{return n||(r=e,i=t,a=o.initPos,s=o.currPos,l=o.currIndex,r.position>a&&r.position<s||r.position<a&&r.position>s||r.position===a&&i>l&&r.position<s||r.position===a&&i<l&&r.position>s);var r,i,a,s,l}),!1);n&&c.add(t)}))}));const u=o.filter(((e,t)=>!c.has(t))),p=d.track.automation[M&&M.name]||l.trackAutomationParameters.get(d.track)&&l.trackAutomationParameters.get(d.track).automation||[];p.splice(0,p.length,...u),re(p)}(d.selectedPoints,f,z,y),d.$digest(),Z(null,v),oe()}function Z(e,t){t=t||Q(e);var n=d.selectionMark||{};if(t?(d.selectionMark=o.convertToCoordinates([t],p[0].clientHeight,M)[0],d.selectionMark.value=t.value):d.selectionMark={value:0},d.selectionMark.posX===n.posX&&d.selectionMark.posY===n.posY||d.$digest(),!e)return void(R.style.visibility="hidden");const r=e.clientX+c.timelineLeft-Rl-Al,a=o.convertXtoTime(r),s=u.isSnapping?i.snapToGrid(a,u.snapDuration,{padding:5/u.scalePx})*u.scalePx:r,l=o.getPolylineYFromX(I,s);return t?(R.style.visibility="hidden",void(A=!1)):e.offsetY<l+2*P&&e.offsetY>l-2*P&&!N.value&&!x?(R.setAttribute("cx",`${s}`),R.setAttribute("cy",`${l}`),R.style.visibility="visible",void(A=!0)):(R.style.visibility="hidden",void(A=!1))}function Q(e){const t=d.track.automation[M&&M.name]||M&&"sendLevel"===M.name&&d.track.auxSends[0].automation||l.trackAutomationParameters.get(d.track)&&l.trackAutomationParameters.get(d.track).automation||[];var n=_.findIndex(o.convertToCoordinates(t,p[0].clientHeight,M),(function(t){return Math.pow(e.offsetX-t.posX,2)+Math.pow(e.offsetY-t.posY,2)<P*P}));return(d.track.automation[M&&M.name]||l.trackAutomationParameters.get(d.track)&&l.trackAutomationParameters.get(d.track).automation||[])[n]}function ee(e,t){const n=t||E();let o=-1;for(const[t,r]of n.entries())if(r.value===e.value&&r.position===e.position){o=t;break}return o}function te(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];a.pushUndo(d.revision);const n=o.convertXtoTime(e.posX),r=u.isSnapping?i.snapToGrid(n,u.snapDuration,{padding:10/u.scalePx}):n,s=d.track.automation[M&&M.name]||M&&"sendLevel"===M.name&&d.track.auxSends[0].automation||l.trackAutomationParameters.get(d.track)&&l.trackAutomationParameters.get(d.track).automation||[];let c;if(t){const t=As((p[0].clientHeight-e.posY)/p[0].clientHeight,0,1);c=M===pl?vs(t*pl.range,pl.range):ks(Ps(t,M),M),c=_s(c,M)}else c=o.getAutomatedValue(M&&M.metadata||M||{},s.length?s:[{value:d.getAutomationData().value,position:r}],r);const m={position:r,value:c},f=_.sortedIndexBy(s,m,"position");return s.splice(f,0,m),s.sort(((e,t)=>e.position-t.position)),d.$applyAsync(),oe(),R.style.visibility="hidden",s[f]}function ne(e){if(!e||0===e.length)return;const t=d.track.automation[M&&M.name]||M&&"sendLevel"===M.name&&d.track.auxSends[0].automation||l.trackAutomationParameters.get(d.track)&&l.trackAutomationParameters.get(d.track).automation||[];a.pushUndo(d.revision),Gf(t,(e=>d.selectedPoints.includes(e))),d.selectedPoints=[],d.$applyAsync(),oe()}function oe(){"pan"===M.name?s.current.setTrackPanAutomation(d.track,d.track.automation.pan):"volume"===M.name?s.current.setTrackVolumeAutomation(d.track,d.track.automation.volume):s.current.setTrackEffectAutomation(d.track,k,S,l.trackAutomationParameters.get(d.track).automation,u.crTime),gR.start("syncVolume")}function re(e){e.forEach(((e,t,n)=>{n[t+1]&&e.position===n[t+1].position&&(n[t].position-=Fz(1,l.current.metronome.bpm))}))}}}}]),angular.module("bandlab.editor").directive("mixEditorBody",["$injector","EditorHelper","EditorHistory","EditorRevision","EditorScroll","EditorState","EditorTrack","MidiKeyboardHandler",function(e,t,n,o,r,i,a,s){return{restrict:"E",replace:!0,templateUrl:"https://www.bandlab.com/web-app/editor/partials/_mix-editor-body-a95afbaf.html",link:function(t,r){r[0].querySelector(".mix-editor-track-header-placeholder").addEventListener("dragover",(function(){const e=t.trackHeadersSequence[t.trackHeadersSequence.length-1];("trackGroup"===e.kind||t.isTrackCollapsed(e.id))&&(f(),t.$applyAsync())}));const{isDraggingItem:s,isDropTarget:l,isTrackBeingDragged:c,shouldShowDropBottom:u,shouldShowDropTop:d,shouldShowDropToMerge:p,shouldShowDropTopOnPlaceholder:m,onDragOverOnPlaceholder:f,onDragEndOnItem:h,onDragOverOnItem:g,onDragStartOnItem:v,resetDragState:b}=function(e,t){const n=e.get("AppNotifications"),o=e.get("EditorRevision"),r=e.get("EditorState"),i=e.get("EditorTrack"),{TRACK_HEIGHT:a,TRACK_COLLAPSED_HEIGHT:s,TRACK_GROUP_HEADER_HEIGHT:l}=zz(),c=Mt({draggingItem:null,targetItem:null,dropPosition:null,errorMsg:null});function u(){document.body.classList.remove("is-disallowed"),window.removeEventListener("dragover",p)}function d(e,t){return!!c.targetItem&&("placeholder"===e?c.targetItem.kind===e:c.targetItem.kind===e&&c.targetItem.item.id===t)}return{isDraggingItem:function(e){return e===c.draggingItem?.item.id},isDropTarget:d,isTrackBeingDragged:function(e){return!!c.draggingItem&&("track"===c.draggingItem.kind?c.draggingItem.item.id===e:"trackGroup"===c.draggingItem.kind&&c.draggingItem.item.tracks.find((t=>t.id===e)))},shouldShowDropBottom:function(e,t){return d(e,t)&&"bottom"===c.dropPosition},shouldShowDropTop:function(e,t){return d(e,t)&&"top"===c.dropPosition},shouldShowDropToMerge:function(e,t){const n=i.isGroupCollapsed(e,t);return d("trackGroup",t)&&n&&"bottom"===c.dropPosition},shouldShowDropTopOnPlaceholder:function(){return"placeholder"===c.targetItem?.kind&&"top"===c.dropPosition},onDragOverOnPlaceholder:function(){c.targetItem={kind:"placeholder"},c.dropPosition="top",document.body.classList.remove("is-disallowed")},onDragEndOnItem:function(){if(c.draggingItem){if(!c.targetItem)return c.errorMsg&&n.addNotification({id:"drag-edit-track",title:c.errorMsg,content:'<a href="https://www.bandlab.com/membership" target="_blank">Learn more about Membership</a>',autoclose:5e3}),void u();if("placeholder"===c.targetItem.kind)return function(e){const{tracks:n}=o.current;if("trackGroup"===e.kind){const o=e,r=n.findIndex((e=>e.id===o.item.tracks[0].id));t();const i=n.splice(r,o.item.tracks.length);n.push(...i)}if("track"===e.kind){const o=e,r=n.findIndex((e=>e.id===o.item.id));t(),o.item.trackGroupId=void 0;const[i]=n.splice(r,1);n.push(i)}}(c.draggingItem),void u();if("trackGroup"===c.draggingItem.kind&&function(e,t){if("trackGroup"===t.kind){const n=t,r=i.isGroupCollapsed(o.current.id,n.item.id);if("bottom"===c.dropPosition&&r)return i.mergeGroups(o.current,n.item.id,e.item.id,-1,!0),void(e.item.tracks.find((e=>e.id===o.selectedTrack?.id))&&b(e.item.tracks));h("top",e,n.item.tracks[0].id)}const n=t,r=i.getGroupData(o.current,n.item.trackGroupId);if("track"===t.kind&&r){const t=r.trackIds.indexOf(n.item.id)+("top"===c.dropPosition?0:1);i.mergeGroups(o.current,r.id,e.item.id,t,!0)}"track"!==t.kind||r||h(c.dropPosition,e,n.item.id)}(c.draggingItem,c.targetItem),"track"===c.draggingItem.kind){const e=i.getGroupData(o.current,c.draggingItem.item.trackGroupId);e?function(e,t,n){"trackGroup"===t.kind&&f(!0,e,t);const r=t,a=i.getGroupData(o.current,r.item.trackGroupId);if("track"===t.kind&&a){const{id:t,trackIds:s}=a,l=s.indexOf(r.item.id)+("top"===c.dropPosition?0:1);if(n.id!==a.id)return void i.addTrackToGroupAtIndex(o.current,t,e.item,l,!0);const u=s.indexOf(e.item.id);if(u===l)return;i.moveTrackInGroup(o.current,t,u,l,!0)}"track"!==t.kind||a||m(!0,e,r)}(c.draggingItem,c.targetItem,e):function(e,t){"trackGroup"===t.kind&&f(!1,e,t);const n=t,r=i.getGroupData(o.current,n.item.trackGroupId);if("track"===t.kind&&r){const t=r.trackIds.indexOf(n.item.id)+("top"===c.dropPosition?0:1);i.addTrackToGroupAtIndex(o.current,r.id,e.item,t,!0)}"track"!==t.kind||r||m(!1,e,n)}(c.draggingItem,c.targetItem)}u()}else u()},onDragOverOnItem:function(e,t,n){if(!c.draggingItem)return;if(e.dataTransfer.dropEffect="move","placeholder"===n.kind||!c.draggingItem)return void document.body.classList.remove("is-disallowed");const o=e.offsetY<function(e,t,n){return("trackGroup"===t?l:i.isTrackCollapsed(e,n)?s:a)/2}(t,n.kind,n.item.id)/2?"top":"bottom";c.errorMsg=function(e,t,n,o){if(r.hasMembership)return null;const{kind:a,item:s}=t,{kind:l,item:c}=n;return["trackGroup"===l&&"bottom"===o&&i.isGroupCollapsed(e,c.id),"trackGroup"===a&&"track"===l&&!!c.trackGroupId,"track"===a&&!!s.trackGroupId&&"track"===l&&!!c.trackGroupId&&s.trackGroupId!==c.trackGroupId,"track"===a&&!s.trackGroupId&&"track"===l&&!!c.trackGroupId].some(Boolean)?"Group editing is a membership feature":null}(t,c.draggingItem,n,o),c.targetItem=c.errorMsg?null:n,c.dropPosition=c.errorMsg?null:o,document.body.classList.toggle("is-disallowed",!!c.errorMsg)},onDragStartOnItem:function(e,t){e.dataTransfer.effectAllowed="move",c.draggingItem=t,HS.value={type:t.kind},window.addEventListener("dragover",p)},resetDragState:function(){c.draggingItem=null,c.targetItem=null,c.dropPosition=null,c.errorMsg=null}};function p(e){e.preventDefault()}function m(e,n,r){const i=o.current.tracks.findIndex((e=>e.id===n.item.id)),a=v(i,o.current.tracks.findIndex((e=>e.id===r.item.id)),c.dropPosition);(i!==a||e)&&(t(),n.item.trackGroupId=void 0,g(a,i))}function f(e,n,r){const{id:a,tracks:s}=o.current,l=i.isGroupCollapsed(a,r.item.id);if("bottom"===c.dropPosition&&l)return i.addTrackToGroupAtIndex(o.current,r.item.id,n.item,-1,!0),void(n.item.id===o.selectedTrack.id&&b([n.item]));const u=s.findIndex((e=>e.id===n.item.id)),d=s.findIndex((e=>e.id===r.item.tracks[0].id)),p=d-(u<d?1:0);if(e)t(),n.item.trackGroupId=void 0;else{if(p===u)return;t()}g(p,u)}function h(e,n,r){const{tracks:i}=o.current,a=i.findIndex((e=>e.id===n.item.tracks[0].id)),s=i.findIndex((e=>e.id===r));let l=v(a,s,e);if(l===a)return;t();const c=i.splice(a,n.item.tracks.length);l=v(a,s,e),i.splice(l,0,...c)}function g(e,t){const[n]=o.current.tracks.splice(t,1);o.current.tracks.splice(e,0,n)}function v(e,t,n){return t+("top"===n?0:1)-(e<t?1:0)}function b(e){const t=[...o.selectedRegions].filter((t=>!e.find((e=>e.id===t.trackId))));o.selectedRegions=new Set(t),o.selectedTrack={}}}(e,(function(){n.pushUndo(o.current),i.hasRevisionChanges=!0}));t.isDraggingItem=s,t.isDropTarget=l,t.isTrackBeingDragged=c,t.shouldShowDropTop=d,t.shouldShowDropBottom=u,t.shouldShowDropToMerge=p,t.shouldShowDropTopOnPlaceholder=m,t.onDragEndOnItem=h,t.onDragOverOnItem=g,t.onDragStartOnItem=v,t.resetDragState=b,t.getDSGroupColor=e=>"Violet"===e?"purple":e.toLowerCase(),t.getTrackHeaderOrGroupWrapperClass=e=>{let n="";if("trackGroup"===e.kind){const r=o.current.trackGroups.find((t=>t.id===e.item.id))?.colorName??e.item.colorName,i=e.item.tracks.map((e=>e.isMuted)).every(Boolean),s=a.isGroupCollapsed(o.current.id,e.item.id);n=`track-header-group-wrapper-${t.getDSGroupColor(r)} ${i?"is-muted":""} ${s?"collapsed":""}`}return"track"===e.kind&&(n="mix-editor-track-header-wrapper"),n}},controller:["$scope",function(e){function n(){let{cleanTrackGroups:n=!1,cleanCollapseData:r=!1,sortTrackIds:i=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n&&a.cleanTrackGroupsData(e.revision),r&&a.cleanCollapseData(e.revision.id,e.revision.tracks,e.revision.trackGroups),function(){let n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const r=a.getTracksSequence(e.revision);e.trackHeadersSequence=r.trackHeadersSequence,e.tracksSequence=r.tracksSequence,n&&(e.revision.tracks=r.trackIdsSorted.map((e=>o.current.tracks.find((t=>t.id===e)))).filter((e=>!!e)),e.revision.tracks=t.applyTracksOrder(e.revision.tracks));const i=a.getGridHeight(o.current.id,r.trackHeadersSequence);document.body.style.setProperty("--mix-editor-arrangement-view-grid-height",`${i}px`),gR.start("anticipateScrollLayoutShift:tracksTop"),e.$applyAsync()}(i)}e.isMovingRegions=!1,e.toggleCollapseTrack=(t,n)=>{const r=a.isTrackCollapsed(e.revision.id,n.id)?"expand_track":"collapse_track";return t.altKey&&n.trackGroupId?(a.toggleCollapseAllTracksInGroup(e.revision,n),e.$applyAsync(),void Promise.resolve().then((()=>rb)).then((t=>{let{logMeMixerActions:o}=t;a.getGroupData(e.revision,n.trackGroupId).trackIds.forEach((()=>o(r)))}))):t.altKey&&!n.trackGroupId?(a.toggleCollapseAllTracksAndGroups("track",n.id),e.$applyAsync(),void Promise.resolve().then((()=>rb)).then((e=>{let{logMeMixerActions:t}=e;o.current.tracks.filter((e=>!e.trackGroupId)).forEach((()=>t(r)))}))):(Promise.resolve().then((()=>rb)).then((e=>{let{logMeMixerActions:t}=e;return t(r)})),a.toggleCollapseTrack(e.revision.id,n.id),void e.$applyAsync())},e.isTrackCollapsed=t=>a.isTrackCollapsed(e.revision.id,t),e.getTrackYPosition=t=>a.getTrackYPosition(e.revision.id,e.tracksSequence,t),e.trackHeadersSequence=[],e.tracksSequence=[],gR.add("updateArrangementView",n),e.$on("$destroy",(()=>{gR.remove("updateArrangementView",n)})),e.$watch("revision.id",(()=>{gR.start("updateArrangementView",!1,{cleanCollapseData:!0},!1,!0)})),e.$watch((()=>e.revision.tracks.map((e=>e.id))),(()=>{gR.start("updateArrangementView",!1,{cleanCollapseData:!0,cleanTrackGroups:!0,sortTrackIds:!0},!1,!0)}),!0),e.$watch((()=>e.revision.trackGroups.map((t=>{const n=e.revision.tracks.filter((e=>e.trackGroupId===t.id)).map((e=>e.id));return[t.id,...n].join("-")})).join("-")),(()=>{gR.start("updateArrangementView",!1,{cleanCollapseData:!0,cleanTrackGroups:!0,sortTrackIds:!0},!1,!0)})),e.selectTrack=function(t,n){if(!e.isMovingRegions&&(!n||n.target.classList.contains("mix-editor-track")||n.target.classList.contains("mix-editor-region")||n.target.closest(".mix-editor-track-header"))&&(!n||!["track-header-collapse-button","mix-editor-track-header-record"].some((e=>n.target.classList.contains(e))))){if(!i.isRecording&&t.id!==o.selectedTrack.id){if(a.setSelected(t),n&&n.shiftKey)return;o.selectedRegions.forEach((e=>{[e.trackId,e._trackId].includes(t.id)||o.selectedRegions.delete(e)}))}s.releaseAll()}};let l=null;e.fireAutoscroll=function(t,n){const o=document.querySelector(".mix-editor-block-headers"),{top:i,height:a}=o.getBoundingClientRect(),{clientY:s}=n;e.endAutoscroll(),l=setInterval((function(){const e=function(e){return i>e?{up:!0}:i+a<=e?{down:!0}:void 0}(s);r.manualScroll(e)}),30)},e.endAutoscroll=()=>clearInterval(l)}]}}]),angular.module("bandlab.editor").directive("mixEditorCollaborators",["$interval","$q","$rootScope","Chat","EditorCollaboratorsState","EditorRevision","Me","User",function(e,t,n,o,r,i,a,s){return{replace:!0,restrict:"E",templateUrl:"https://www.bandlab.com/web-app/editor/partials/_mix-editor-collaborators-b4badc6d.html",controller:["$scope",function(a){let l;function c(){o.getOneConversation(i.current.song.id).then((function(e){r.activeChat={conversation:e}}))}function u(){let e=t.resolve();n.$broadcast("$invite:changed");{const n="Band"===_.get(a,"revision.song.author.type")?s.fromBand({bandId:a.revision.song.author.id,accepted:!0}).$promise.then((e=>{let{data:t}=e;return t.forEach((function(e){e.isMember=!0})),t})).catch((()=>[])):t.resolve([]),o="User"===_.get(a,"revision.song.author.type")?s.get({id:a.revision.song.author.id}).$promise.then((e=>(e.isOwner=!0,[e]))).catch((()=>[])):t.resolve([]),r=a.revision.song.id?s.getCollaborators({songId:a.revision.song.id,limit:50}).$promise.then((e=>{let{data:t}=e;return t.forEach((function(e){e.isCollaborator=!0})),t})).catch((()=>[])):t.resolve([]);e=t.all([o,n,r])}return e.then((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const o=Hz(t.flat(2).filter((e=>!!e)),"id"),a=o.filter((e=>!0)).map((e=>{const t=_.find(r.chats||[],{participant:{id:e.id}});return{participant:e,conversation:t&&t.conversation}}));r.chats=a,r.members=o.reduce(((e,t)=>(e[t.id]=t,e)),{}),!r.activeChat&&i.current.song.id&&c()}))}a.editorCollaboratorsState=r,a.$on("$destroy",(function(){e.cancel(l)})),r.projectChat.messages=null,u().then((()=>{i.current.song.id&&c(),l=e(u,3e4)}))}]}}]).directive("mixEditorCollaboratorCursorTracker",["EditorScrollState","EditorSocket","EditorState",function(e,t,n){return{restrict:"A",link:function(o,r){r[0].addEventListener("mousemove",ly((function(o){XS.position={x:o.pageX<293?o.pageX-293:(o.pageX-293+e.timelineLeft)/n.scalePx,y:o.pageY-96+e.tracksTop},t.sendCursor()}),100),{passive:!0})}}}]).directive("mixEditorCollaboratorCursor",["EditorScrollState","EditorState",function(e,t){return{restrict:"E",replace:!0,templateUrl:"https://www.bandlab.com/web-app/editor/partials/_mix-editor-collaborator-cursor-d1bcb620.html",link:function(n,o){let r=angular.noop;const i=n.$on("MixEditor:cursor",(function(i,a){let{position:{x:s,y:l},label:c,userId:u}=a;n.user&&u!==n.user.id||(gR.remove("scroll:timelineLeft",r),gR.remove("scroll:tracksTop",r),gR.remove("scale:timeline",r),r=function(){const r=s<0?s+293:s*t.scalePx-e.timelineLeft+293,i=l-e.tracksTop;o[0].style.setProperty("--mouse-x",`${r}px`),o[0].style.setProperty("--mouse-y",`${i}px`),n.label=c},r(),gR.add("scroll:timelineLeft",r),gR.add("scroll:tracksTop",r),gR.add("scale:timeline",r))}));n.$on("$destroy",(function(){i(),gR.remove("scroll:timelineLeft",r),gR.remove("scroll:tracksTop",r),gR.remove("scale:timeline",r)}))}}}]).directive("mixEditorCollaboratorsZeroCase",(function(){return{restrict:"E",replace:!0,template:"<div></div>",controller:["$element","$scope",function(e,t){import("./chunk-21eb2c72.js").then((function(n){let{mountMixEditorCollaboratorsZeroCase:o}=n;const r=o(e[0],{user:t.user,showRealtimeModal:t.showRealtimeModal});t.$on("$destroy",(function(){r.unmount()}))}))}]}})),angular.module("bandlab.editor").directive("mixEditorCycleSelection",(function(){return{restrict:"E",replace:!0,scope:!0,templateUrl:"https://www.bandlab.com/web-app/editor/partials/_mix-editor-cycle-selection-38e74b9b.html",controller:["$scope","EditorCycle","editorEvents","EditorHelper","EditorScrollState","EditorState",function(e,t,n,o,r,i){var a,s,l,c,u=4*$s(e.revision.metronome);function d(){return!i.isTimeRuler&&i.isSnapping}function p(){l.start=c,l.end=c,c=null}function m(){var e,n;l.start>l.end&&(e=l.start,l.start=l.end,l.end=e),e=l.start/i.scalePx,(n=l.end/i.scalePx)-e<1&&(n=e+1,l.end=n*i.scalePx),n>JS.SONG_DURATION_MAX&&(n=JS.SONG_DURATION_MAX,e=JS.SONG_DURATION_MAX-1,l.start=e*i.scalePx,l.end=n*i.scalePx),t.set(e,n),t.reschedule()}function f(){document.body.classList.add("is-resizing")}function h(){document.body.classList.remove("is-resizing"),document.body.classList.remove("is-moving")}t.set(0,u),l={start:0,end:u*i.scalePx},gR.add("scale:timeline",(function(t){function n(e){return e*t.scalePx/t.oldScalePx}t&&(l.start=n(l.start),l.end=n(l.end),e.$applyAsync())})),e.$on(n.cycleChanged,(function(){l.start=t.get().startTime*i.scalePx,l.end=t.get().endTime*i.scalePx})),e.createCycleStart=function(e){e=e+r.timelineLeft-Rl-Al;var t=i.snapDuration*i.scalePx;d()&&(e=o.snapToGrid(e,t,{padding:t/2})),c=e,s={start:e,end:e},a=rd(p),f()},e.backupPosition=function(){s={start:l.start,end:l.end},c=null},e.getCycleStart=function(){return Math.min(l.end,l.start)},e.getCycleDuration=function(){return Math.abs(l.end-l.start)},e.setCycleStart=function(e){var t=Math.max(s.start-e,0),n=i.snapDuration*i.scalePx;t=Math.min(t,r.timelineEl.scrollWidth-Al),i.isCycling=!0,d()&&(t=o.snapToGrid(t,n,{padding:n/2})),l.start=t,f()},e.setCycleEnd=function(e,t){if(null!==c){if(Math.abs(e)<=30)return;a()}var n=Math.min(s.end-e,r.timelineEl.scrollWidth-Al),u=i.snapDuration*i.scalePx;n=Math.max(n,0),i.isCycling=!0,d()&&!0!==t&&(n=o.snapToGrid(n,u,{padding:u/2})),l.end=n,f()},e.moveCycle=function(t){var n=l.start,o=l.end;e.setCycleStart(t),e.setCycleEnd(t,!1),n-o!=l.start-l.end&&(t>0?l.end=l.start+(o-n):t<0&&(l.start=l.end-(o-n))),document.body.classList.add("is-moving")},e.createCycleEnd=function(e){h(),m()},e.setCycle=function(e){h(),e?m():t.toggle()}}]}})),angular.module("bandlab.editor").directive("mixEditorFooter",["editorEvents","EditorModel","EditorState","MidiEditorState",function(e,t,n,o){return{restrict:"E",replace:!0,template:'<footer class="mix-editor-footer"></footer>',link:async function(r,i){import("./chunk-bfc1fae3.js").then((a=>{let{mount:s}=a;const l=s(i[0],{scope:r,editorEvents:e,EditorModel:t,EditorState:n,MidiEditorState:o});r.$on("$destroy",(()=>l.unmount()))}))}}}]),angular.module("bandlab.editor").directive("mixEditorGrid",["EditorGrid",function(e){return{replace:!0,restrict:"E",templateUrl:"https://www.bandlab.com/web-app/editor/partials/_mix-editor-grid-28675dbf.html",link:function(t){var n=document.getElementById("mix-editor-grid-pattern");function o(){e.updateRulerGrid({pattern:n})}t.$watchGroup(["state.snapSetting","state.isTimeRuler"],o),gR.add("scale:timeline",o)}}}]),angular.module("bandlab.editor").directive("mixEditorHeader",(function(){return{restrict:"E",replace:!0,templateUrl:"https://www.bandlab.com/web-app/editor/partials/_mix-editor-header-fc855fed.html",controller:["$scope","Editor",function(e,t){e.updateProjectName=t.updateProjectName}]}})),angular.module("bandlab.editor").directive("mixEditorHeadersActionBar",["$injector","EditorState","EditorTrack",function(e,t,n){return{restrict:"E",replace:!0,template:'<div class="mix-editor-headers-actionbar"></div>',link:function(o,r){import("./chunk-d3961739.js").then((function(i){let{mount:a}=i;const s=a(r[0],{$injector:e,scope:o,EditorState:t,EditorTrack:n});o.$on("$destroy",(function(){s.unmount()}))}))}}}]),angular.module("bandlab.editor").directive("mixEditorIncompatibleBanner",["$injector",function(e){return{replace:!0,restrict:"E",template:'<div id="mix-editor-incompatible-banner"></div>',link:async function(t,n){import("./chunk-9f40b15e.js").then((function(o){let{mountIncompatibleBanner:r}=o;const i=r(n[0],{$injector:e,scope:t});t.$on("$destroy",(function(){i.unmount()}))}))}}}]),angular.module("bandlab.editor").directive("mixEditorInstrument",["EditorHelper","EditorState","MidiKeyboardHandler","Soundbank",function(e,t,n,o){return{restrict:"E",replace:!0,templateUrl:"https://www.bandlab.com/web-app/editor/partials/_mix-editor-instrument-d8d672e3.html",link:function(r){r.current=o.getCurrent(),r.displayInstrument=e.displayInstrument,r.$watch("state.isAudioInputActive",(function(e){!e||o.getCurrent().input.kind!==Gs&&o.getCurrent().input.kind!==Zs?n.disable():n.enable()})),r.$on(LT,(function(){o.getCurrent().input.kind!==Gs&&o.getCurrent().input.kind!==Zs||(t.isAudioInputActive=!0)}))}}}]),angular.module("bandlab.editor").directive("mixEditorKeyEvents",["$rootScope","editorEvents","EditorRevision","EditorState","EditorTrack","MidiEditorState","Soundbank",function(e,t,n,o,r,i,a){return{restrict:"A",link:function(s){const l=new Set;function c(c){if(!(c.repeat||!c.code||l.has(c.code)&&th)){l.add(c.code);var u=c.ctrlKey||c.metaKey;if((-1===["INPUT","TEXTAREA"].indexOf(c.target.nodeName)||"file"===c.target.type)&&-1===c.target.className.indexOf(Gs)&&"true"!==c.target.getAttribute("contenteditable"))if("Meta"!==c.key&&"Control"!==c.key||e.$broadcast(t.keyDown.snapPressed),o.isInBackground)c.preventDefault();else{if(o.isAudioInputActive&&!u){if(-1===[8,13,32,37,38,39,40,46,77].indexOf(c.which))return;if(32===c.which&&a.getCurrent().input.slug===Ks||77===c.which&&a.getCurrent().input.kind===Gs||77===c.which&&a.getCurrent().input.kind===Zs)return}if(o.canCollaborate)if(c.altKey)switch(c.code){case"Minus":c.preventDefault(),i.hasFocus&&i.isPianoRoll&&e.$broadcast(t.keyDown.zoomOutPianoRollVertical);break;case"Equal":c.preventDefault(),i.hasFocus&&i.isPianoRoll&&e.$broadcast(t.keyDown.zoomInPianoRollVertical)}else if(u||c.shiftKey){if(u&&!c.shiftKey){switch(String.fromCharCode(c.which).toLowerCase()){case"a":i.hasFocus||e.$broadcast(t.keyDown.selectAllRegions),c.preventDefault();break;case"c":i.hasFocus||e.$broadcast(t.keyDown.copy);break;case"x":i.hasFocus||e.$broadcast(t.keyDown.cut);break;case"v":i.hasFocus||e.$broadcast(t.keyDown.paste);break;case"s":c.preventDefault(),e.$broadcast(t.keyDown.save);break;case"z":c.preventDefault(),e.$broadcast(t.keyDown.undo)}switch(c.key){case"-":c.preventDefault(),e.$broadcast(t.keyDown.zoomOut);break;case"=":c.preventDefault(),e.$broadcast(t.keyDown.zoomIn);break;case"/":c.preventDefault(),e.$broadcast(t.keyDown.toggleShortcuts)}}else if(u&&c.shiftKey)"z"===String.fromCharCode(c.which).toLowerCase()&&(c.preventDefault(),e.$broadcast(t.keyDown.redo));else if(c.shiftKey){switch(String.fromCharCode(c.which).toLowerCase()){case"a":c.preventDefault(),e.$broadcast(t.keyDown.recordAutomation);break;case"d":c.preventDefault(),e.$broadcast(t.keyDown.duplicateTrack);break;case"m":c.preventDefault(),e.$broadcast(t.keyDown.muteTrack);break;case"s":c.preventDefault(),e.$broadcast(t.keyDown.soloTrack);break;case"t":c.preventDefault(),e.$broadcast(t.keyDown.addTrack)}switch(c.which){case 8:case 46:c.preventDefault(),e.$broadcast(t.keyDown.deleteTrack);break;case 32:c.preventDefault(),e.$broadcast(t.keyDown.playFromStart)}}}else switch(c.which){case 8:case 46:c.preventDefault(),o.isAudioInputActive&&a.getCurrent().input.kind===Zs?e.$broadcast("Sampler:deletePad"):o.isAutomationVisible?e.$broadcast(t.keyDown.deleteSelectedAutomationPoints):i.hasFocus||e.$broadcast(t.keyDown.delete);break;case 13:e.$broadcast(t.keyDown.goToBeginning);break;case 32:c.preventDefault(),e.$broadcast(t.keyDown.togglePlayStop);break;case 37:case 39:e.$broadcast(t.keyArrow,c);break;case 71:e.$broadcast(t.keyDown.toggleSnap);break;case 65:if(0===n.current.tracks.length||n.current.tracks.every((e=>r.isTrackCollapsed(n.current.id,e.id)))||n.current.trackGroups>0&&n.current.trackGroups.every((e=>r.isGroupCollapsed(n.current.id,e.id))))return;o.isAutomationVisible=!o.isAutomationVisible;break;case 67:e.$broadcast(t.keyDown.toggleCycle);break;case 76:e.$broadcast(t.keyDown.toggleLoops);break;case 77:e.$broadcast(t.keyDown.toggleMetronome);break;case 82:e.$broadcast(t.keyDown.toggleRecord);break;case 83:e.$broadcast(t.keyDown.triggerSlice);break;case 86:e.$broadcast(t.keyDown.toggleVelocity);break;case 38:c.preventDefault(),"Loops"!==s.currentActiveTab||i.hasFocus||e.$broadcast(t.keyDown.previousLoop);break;case 40:c.preventDefault(),"Loops"!==s.currentActiveTab||i.hasFocus||e.$broadcast(t.keyDown.nextLoop)}else if(!u&&!c.shiftKey)switch(c.which){case 13:e.$broadcast(t.keyDown.goToBeginning);break;case 32:c.preventDefault(),e.$broadcast(t.keyDown.play)}}}}function u(n){s.$applyAsync(),!m()||"Meta"!==n.key&&"Control"!==n.key||e.$broadcast(t.keyDown.snapReleased),"Alt"===n.key&&th&&n.preventDefault(),l.delete(n.code)}function d(e){((32===e.keyCode||13===e.keyCode)&&"INPUT"===e.target.nodeName&&"file"===e.target.type||"BUTTON"===e.target.nodeName||e.target.closest("button"))&&e.preventDefault()}function p(){m()&&(e.$broadcast(t.keyDown.snapReleased),l.clear())}function m(){return[...l].some((e=>e.includes("Meta")||e.includes("Control")||e.includes("OS")))}angular.element(document).on("keydown",d),angular.element(document.body).on("keydown",c),angular.element(window).on("keyup",u),window.addEventListener("blur",p),s.$on("$destroy",(function(){angular.element(document).off("keydown",d),angular.element(document.body).off("keydown",c),angular.element(window).on("keyup",u),window.removeEventListener("blur",p)}))}}}]),angular.module("bandlab.editor").directive("mixEditorMenu",["$rootScope","$state","Editor","EditorCollaboratorsState","EditorDB","editorEvents","EditorHelper","EditorPlayer","EditorRevision","EditorScrollState","EditorState","Me","MidiEditorState","Modal","Page","Song",function(e,t,n,o,r,i,a,s,l,c,u,d,p,m,f,h){return{restrict:"E",replace:!0,templateUrl:"https://www.bandlab.com/web-app/editor/partials/_mix-editor-menu-2179b8b8.html",link:function(g){function v(){h.fromUserWithCursor({id:d.id,limit:6}).$promise.then((e=>{g.recentProjects=e.data.filter((e=>e.id!==l.current.song.id))}))}async function b(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,{initWelcomeTutorial:o=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.removeSnapshot(l.current.id),a.hidePanel(),g.closeSideTab(),await n.loadRevision({newProject:null===t,id:t?(await h.getBySlug({entity:"users",username:t.isCollaborator?t.author.username:d.username,slug:t.slug}).$promise).revision.id:null}),g.revision=l.current,u.crTime=0,e.$applyAsync((()=>{e.$applyAsync((()=>{gR.start("syncVolume")}))})),v(),t||(o?g.initWelcomeTutorial():g.displayAddTrack({pushUndo:!1})),f.setMetadata({title:g.revision.song.name}),f.update()}function y(){g.isFullScreen=document.fullscreenElement,g.$applyAsync()}g.editorSettings=JS,g.snapSettings=$l,g.hasCollaborators=!1,g.libraryLink=t.href("library.projects.songs",{category:"recent"}),g.recentProjects=[],g.canLoadProject=function(){return u.isPlaying||u.isRecording},v(),g.displayZendesk=function(){window.zESettings={webWidget:{contactForm:{suppress:!0}}},xc("https://static.zdassets.com/ekr/snippet.js?key=4b42234b-3029-4412-b79e-42cc18704d33",document.head,{id:"ze-snippet"}).then((function(){zE("webWidget:on","close",rd((()=>zE("webWidget","hide")))),zE("webWidget","show"),zE("webWidget","toggle")}))},g.$on("$destroy",(function(){window.zE&&zE("webWidget","hide"),document.removeEventListener("fullscreenchange",y)})),g.$watch((()=>o.writers),(e=>{g.hasCollaborators=Object.keys(e).length>1,g.hasCollaborators&&"RevisionHistory"===g.currentActiveTab&&g.closeSideTab()})),g.openLatencyTest=function(){new m({template:'\n               <div class="modal-close" ng-click="cancel()"></div>\n               <header class="modal-header-new">\n                 <h2 class="modal-header-title">Round-trip Latency Correction</h2>\n               </header>\n               <div class="modal-content modal-content-small modal-content-new">\n                 <latency-test></latency-test>\n               </div>\n            ',onCreate:function(){u.isInBackground=!0},onDestroy:function(){u.isInBackground=!1}}).show()},g.openTuner=a.openTuner,g.showShortcuts=function(){e.$broadcast(i.keyDown.toggleShortcuts)},g.askSaveLoadNewProject=function(){let{initWelcomeTutorial:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};g.showAskSaveModal((()=>{b(null,{initWelcomeTutorial:e})}))},g.askSaveLoadProject=function(e){g.showAskSaveModal((()=>{b(e)}))},g.startTutorial=function(){document.body.click(),g.showAskSaveModal((()=>t.go(".",{id:null,tutorial:!0},{reload:!0,inherit:!1})))},document.addEventListener("fullscreenchange",y),g.toggleFullScreenMode=function(){var e=document.documentElement;g.isFullScreen?document.exitFullscreen():e.requestFullscreen()},g.toggleLock=function(){p.isLocked=!p.isLocked,p.isLocked&&(p.scale=u.scale,g.broadcastScale({state:p}),c.notesLeft=c.timelineLeft)},g.toggleLegacyKeyboardShortcuts=a.toggleLegacyKeyboardShortcuts,g.setCountIn=function(e){JS.COUNT_IN_DURATION=e,ql.countInDuration=JS.COUNT_IN_DURATION,s.current.setCountIn(JS.COUNT_IN_DURATION)}}}}]),angular.module("bandlab.editor").directive("metronomeSettings",["$analytics","EditorPlayer","Metronome","MetronomeState",function(e,t,n,o){return{replace:!0,restrict:"E",templateUrl:"https://www.bandlab.com/web-app/editor/partials/_mix-editor-metronome-settings-f6354b04.html",link:function(e,t){var n=t[0].querySelector(".metronome-tap-button-body");n.querySelector("label").addEventListener("mouseenter",(function(){n.classList.add("hovered"),setTimeout((function(){n.classList.remove("hovered")}),600)})),n.addEventListener("click",(function(){n.classList.add("clicked"),setTimeout((function(){n.classList.remove("clicked")}),300)}))},controller:["$interval","$scope","$timeout",function(r,i,a){const s=o.settings;var l,c;i.backupBPM(),o.settings=_.clone(o.settings),i.countInDuration=`${JS.COUNT_IN_DURATION}`,i.isPreviewEnabled=!1,i.metronomeState=o,i.tempoMax=ol,i.tempoMin=40,n.getSounds().then((function(e){i.metronomeSounds=e})),i.saveCountInSettings=()=>{JS.COUNT_IN_DURATION=parseInt(i.countInDuration),localStorage.countInDuration=JS.COUNT_IN_DURATION,t.current.setCountIn(JS.COUNT_IN_DURATION)},i.$on("$destroy",(function(){i.isPreviewEnabled&&i.togglePreview(),s.bpm=o.settings.bpm,o.settings=s,i.stretchRevision()})),i.changeTempo=function(e){o.settings.bpm="up"===e?Math.min(ol,o.settings.bpm+1):Math.max(40,o.settings.bpm-1),l=a((function(){c=r((function(){o.settings.bpm="up"===e?Math.min(ol,o.settings.bpm+1):Math.max(40,o.settings.bpm-1),t.current.setMetronomeBpm(o.settings.bpm)}),125)}),300)},i.stopChangeTempo=function(){a.cancel(l),r.cancel(c),t.current.setMetronomeBpm(o.settings.bpm)},i.setVolume=n.setVolume,i.tapTempo=function(){t.current.tapTempo().then((function(e){o.settings.bpm=e,i.$applyAsync()}))},i.togglePreview=function(){i.isPreviewEnabled=!i.isPreviewEnabled,i.isPreviewEnabled?t.current.startMetronomePreview():t.current.stopMetronomePreview()},i.changeMetronomeSound=function(){n.setSound(o.sound),e.eventTrack("Change Metronome Sound",{category:"Mix Editor",label:o.sound})}}]}}]),angular.module("bandlab.editor").directive("mixEditorOutVolumeMeter",["$injector",function(e){return{replace:!0,restrict:"E",template:"<div></div>",link:async function(t,n){import("./chunk-d14579cc.js").then((function(o){let{mount:r}=o;const i=r(n[0],{$injector:e,scope:t});t.$on("$destroy",(function(){i.unmount()}))}))}}}]),angular.module("bandlab.editor").directive("mixEditorPanel",["AudioEditorView","EditorHelper","EditorRevision","EditorScrollState","EditorState","MidiEditor","MidiEditorState",function(e,t,n,o,r,i,a){return{replace:!0,restrict:"E",templateUrl:"https://www.bandlab.com/web-app/editor/partials/_mix-editor-panel-29e85cff.html",link:function(s){s.$on("MixEditorPanel:AdjustRegionWidth",((e,t)=>s.adjustRegionWidth(t))),s.$watch((()=>r.isSidetabOpen),(()=>{if((r.isVisible||a.isVisible)&&s.getTrack().regions)for(const n of s.getTrack().regions){const r=o.notesLeft,i={left:n.startPosition*a.scalePx,width:t.getTotalDuration(n)*a.scalePx};if(e.isRegionVisible(i,r)){s.adjustRegionWidth(n);break}}})),s.adjustRegionWidth=function(e){const o=t.getTotalDuration(e),r=s.currentActiveTab?document.querySelector(".mix-editor-panel-track").getBoundingClientRect().width-400:document.querySelector(".mix-editor-panel-track").getBoundingClientRect().width,l=o*a.scale>r?s.zoomOut:s.zoomIn,c=jl.map((e=>({regionWidth:d(o,e),scale:e}))),u=c.filter((e=>{let{regionWidth:t}=e;return t<=r})).pop()||c[0];function d(e,t){return e*t*4*n.current.metronome.bpm/120}l({state:a,scale:u.scale}),setTimeout((()=>i.scrollToRegion(e)))},s.viewMode=QF.value,s.getNoteHeight=i.getNoteHeight,s.getViewMode=()=>s.viewMode,iB(Lr(QF,(()=>{s.viewMode=QF.value,i.focusedScrollToNotesY(),s.$digest()}))),s.$on("$destroy",(()=>{aB()}))}}}]).directive("audioEditorHeader",["$analytics","AudioStretch","EditorHelper","EditorHistory","EditorPlayer","EditorRevision","EditorTimeline",function(e,t,n,o,r,i,a){return{replace:!0,restrict:"E",templateUrl:"https://www.bandlab.com/web-app/editor/partials/_audio-editor-header-6aac6162.html",controller:["$scope",function(s){const l=new WeakMap,c=new WeakMap;function u(){const e=Array.from(i.selectedRegions);return e.some((e=>!n.isAudioRegion(e)))?(s.hasSelectedRegions=0,[]):(s.hasSelectedRegions=e.length>0,e)}function d(e,t){return As(e+t/(arguments.length>2&&void 0!==arguments[2]?arguments[2]:1)*Math.sign(e),.1,10)}function p(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return As(e+Math.floor(t/n),-12,12)}function m(){const e=u();return e.length&&1===[...new Set(e.map((e=>e.gain)))].length?e[0].gain:null}s.getSelectedRegions=u,s.hasRegionsLoading=!1,s.hasSelectedRegions=!1,s.getPitchShift=function(){const e=u();return e.length&&1===[...new Set(e.map((e=>e.pitchShift)))].length?l.has(e[0])?l.get(e[0]):e[0].pitchShift:""},s.getPlaybackRate=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=u();if(t.length&&1===[...new Set(t.map((e=>e.playbackRate)))].length){const n=c.get(t[0])?c.get(t[0]):t[0].playbackRate;return e?n.toFixed(2):Math.abs(n).toFixed(2)}return""},s.pitchShiftRegion=function(n){e.eventTrack("Change pitch in Audio Editor",{category:"Mix Editor"}),o.pushUndo(i.current),u().forEach((function(e){const o=p(e.pitchShift,n);o!==e.pitchShift&&t.convertRegion(e,e.playbackRate,o).finally((function(){s.$applyAsync()}))}))},s.stretchRegion=function(n){e.eventTrack("Stretch region in Audio Editor",{category:"Mix Editor"}),o.pushUndo(i.current),u().forEach((function(e){const o=d(e.playbackRate,n);o!==e.playbackRate&&t.convertRegion(e,o).then((function(){a.moveRegions(i.selectedTrack)})).finally((function(){c.delete(e),s.$applyAsync()}))}))},s.reverseRegion=function(){e.eventTrack("Reverse region in Audio Editor",{category:"Mix Editor"}),o.pushUndo(i.current),o.startToIgnorePushUndo(),r.current.reverseRegions(i.selectedRegions).finally((function(){u().forEach((e=>c.delete(e))),s.$applyAsync(),o.stopToIgnorePushUndo()}))},s.setRegionPitchShift=function(e,t){u().forEach((function(e){const n=p(e.pitchShift,t,10);n!==e.pitchShift&&l.set(e,n)}))},s.setRegionPlaybackRate=function(e,t){u().forEach((function(e){const n=d(e.playbackRate,t,10);n!==e.playbackRate&&c.set(e,n)}))},s.updateRegions=function(){s.hasRegionsLoading=!0,o.pushUndo(i.current),u().forEach((function(e){o.startToIgnorePushUndo(),s.$applyAsync(),e.pitchShift=l.has(e)?l.get(e):e.pitchShift,t.convertRegion(e,c.get(e)).then((function(){a.moveRegions(i.selectedTrack)})).finally((function(){l.delete(e),c.delete(e),s.hasRegionsLoading=!1,s.$applyAsync(),o.stopToIgnorePushUndo()}))}))},s.isResettable=function(){return s.hasSelectedRegions&&"1.00"!==s.getPlaybackRate(!0)&&""!==s.getPlaybackRate()||0!==s.getPitchShift()&&""!==s.getPitchShift()||1!==m()&&null!==m()},s.resetChanges=function(){u().forEach((function(e){e.pitchShift=0,e.gain=1,c.set(e,1)})),s.updateRegions()}}]}}]).directive("audioEditor",["AudioEditorView","EditorAutomation","EditorHelper","EditorHistory","EditorPlayer","EditorRevision","EditorScroll","EditorState","EditorTimeline","MidiEditorState",function(e,t,n,o,r,i,a,s,l,c){return{replace:!0,restrict:"E",templateUrl:"https://www.bandlab.com/web-app/editor/partials/_audio-editor-7b6ae673.html",link:function(u,d){function p(e){e&&a.focusedNotesRescale(e)}gR.add("scale:notesTimeline",p),u.$on("$destroy",(function(){gR.remove("scale:notesTimeline",p)})),u.getTrack=function(){return i.selectedTrack},u.clipboard=zS,u.pasteRegion=function(){if(!zS.value||s.crTime>=JS.SONG_DURATION_MAX)return;o.pushUndo(i.current);var e=_.minBy(zS.value,"startPosition").startPosition,n=_.minBy(zS.value,"trackOrder").trackOrder,a=_.maxBy(zS.value,"trackOrder").trackOrder-n;if(i.selectedTrack.order+a>=u.revision.tracks.length)return void(i.current.tracks.length<JS.TRACKS_LIMIT?alert("Please add extra track"):alert("Please paste to other track"));i.selectedRegions.clear();const c=new Set;_.forEach(zS.value,(function(t){var o=t.endPosition-t.startPosition,r=i.selectedTrack.order-n+t.trackOrder,a=_.find(u.revision.tracks,{order:r});(t=_.clone(t)).id=ad(),t.trackId===a.id&&c.add(t),t.trackId=a.id,t.startPosition=t.startPosition-e+s.crTime,t.endPosition=Math.min(t.startPosition+o,JS.SONG_DURATION_MAX),i.selectedRegions.add(t),t.startPosition<JS.SONG_DURATION_MAX&&(a.regions.push(t),l.moveRegions(a))})),t.checkConfirmation("paste",zS.value).then((function(e){e&&_.forEach(Array.from(i.selectedRegions),(function(e){var n=_.find(u.revision.tracks,{id:e.trackId});t.deleteAutomationInRange(n,e.startPosition,e.endPosition),t.pasteAutomation(n,e,e.startPosition,c.has(e))}))})),r.updateSourcesInTracks()},e.init(d[0].getBoundingClientRect()),u.$watch((function(){return s.isVisible?i.selectedTrack:{}}),(function(e){if(e.type!==Ks)return e.soundbank||e.samplerKit?(c.track=e,void n.displayMidiEditor()):void(c.track=e);n.hidePanel()}))}}}]).directive("audioEditorRegion",["$analytics","$rootScope","AudioEditorView","AudioStretch","EditorCycle","editorEvents","EditorHelper","EditorHistory","EditorMidiSamples","EditorPlayer","EditorRevision","EditorScrollState","EditorState","EditorTimeline","EditorWaveform","MidiEditorState",function(e,t,n,o,r,i,a,s,l,c,u,d,p,m,f,h){let g={};return{replace:!0,restrict:"E",templateUrl:"https://www.bandlab.com/web-app/editor/partials/_audio-editor-region-6b5d4c4a.html",link:function(e,t){const o=p.isWebGLEnabled,r=Math.round(oC(1)),s=parseInt(window.getComputedStyle(document.body).getPropertyValue("--audio-editor-waveform-height"))*r,m=rd((function(){gR.add("scroll:notesLeft",P),gR.add("scale:notesTimeline",T),gR.add("scale:applyZoomNotesTimeline",P),e.$on(i.startZoomMIDI,(()=>{gR.remove("scroll:notesLeft",P),S=h.scalePx,$=g.canvasLeft/h.scalePx,k=g.canvasWidth/h.scalePx})),e.$on(i.stopZoomMIDI,(()=>{gR.add("scroll:notesLeft",P),S=null,$=null,k=null})),P(),o&&(I(),gR.add("region:notes:census",I),e.$watch("region",(function(t,n){const o=n.endPosition-n.startPosition,r=t.endPosition-t.startPosition,i=Math.abs(r-o)>1e-6,a=t.isMoving!==n.isMoving||t.isProcessing!==n.isProcessing,s=t.isProcessing!==n.isProcessing||i||t.sampleId!==n.sampleId||t.sampleOffset!==n.sampleOffset||t.loopLength!==n.loopLength||t.playbackRate!==n.playbackRate||t._trackId!==n._trackId,l=t.bpm!==n.bpm||t.gain!==n.gain||t.endPosition!==n.endPosition||t.startPosition!==n.startPosition,c={viewId:e.$id,region:e.region,track:e.track,revision:e.revision};a&&gR.start("region:notes:updateRegionVisibility",!1,c,!1,!1),s&&gR.start("region:notes:updateSamples",!1,c,!1,!1),l&&gR.start("region:notes:updateTransform",!1,c,!1,!1),e.$applyAsync((function(){gR.start("scroll:notesLeft",!1,d.notesLeft),gR.start("scroll:notesLeft:noRAF",!1,d.notesLeft)}))}),!0),e.$watch("track.order",(function(){const t={viewId:e.$id,region:e.region,track:e.track,revision:e.revision};gR.start("region:notes:updateTransform",!1,t,!1,!1)})),e.$watch((()=>a.getRegionColor(e.track,e.region)),(function(){const t={viewId:e.$id,region:e.region,track:e.track,revision:e.revision};gR.start("region:notes:updateSamples",!1,t,!1,!1)}))),o||(e.$watch("region",(function(t,n){switch(!0){case t.isProcessing!==n.isProcessing:case t.sampleId!==n.sampleId:!function(){v=C(),gR.remove("scroll:notesLeft",P),gR.remove("scale:notesTimeline",T);const t=e.$watch((function(){return v=C(),v&&(v.buffer&&a.isAudioBuffer(v.buffer)||v.error||v.notes)}),(function(e){e?(T(),gR.add("scroll:notesLeft",P),gR.add("scale:notesTimeline",T)):rC(y),t()}))}();break;case t.bpm!==n.bpm:case t.endPosition!==n.endPosition&&t.startPosition===n.startPosition:case t.sampleOffset!==n.sampleOffset:case t.loopLength!==n.loopLength:case t.gain!==n.gain:case t.playbackRate!==n.playbackRate:case p.isRegionAudioStretchEnabled&&t.startPosition!==n.startPosition:T()}}),!0),e.$watch((()=>a.getRegionColor(e.track,e.region)),T)),e.$on("$destroy",(function(){o&&(gR.start("region:notes:delete",!1,{viewId:e.$id,region:e.region},!1,!1),gR.remove("region:notes:census",I)),gR.remove("scroll:notesLeft",P),gR.remove("scale:notesTimeline",T),gR.remove("scale:applyZoomNotesTimeline",P)}))}));let g={},v={};const b=t[0].querySelector("canvas"),y=b.getContext("2d");b.style.height=s/r+"px",b.height=s,b.width=oC(screen.width),e.isSelected=function(){return u.selectedRegions.has(e.region)},e.track=u.selectedTrack,e.state=h,e.state.canCollaborate=!0;const w=e.$watch((function(){return v=C(),v&&(v.buffer&&a.isAudioBuffer(v.buffer)||v.error||v.notes)}),(function(){if(!v||!v.notes&&!v.buffer&&!v.error)return!1;e.region.hasSample=!v.error,e.region.isPlayable=a.isRegionPlayable(e.region,e.getTrack())||!e.region.canEdit,v.buffer&&a.isAudioBuffer(v.buffer)&&m(),w()}));let $,k,S;function P(t,o){y.canvas.style.width&&!p.isZooming&&(y.canvas.style.width=null),t=t||d.notesLeft;var r=n.isRegionVisible({left:e.region.startPosition*h.scalePx,width:a.getTotalDuration(e.region)*h.scalePx},t);r&&r.canvasWidth&&v||(r={canvasLeft:0,canvasWidth:0}),p.isZooming&&e.track.type!==Ks?(S<=h.scalePx&&(y.canvas.style.left=$*h.scalePx+"px",y.canvas.style.width=k*h.scalePx+"px"),S>h.scalePx&&(M({canvasLeft:r.canvasLeft/h.scalePx*S,canvasWidth:r.canvasWidth/h.scalePx*S},S),y.canvas.style.left=`${r.canvasLeft}px`,y.canvas.style.width=`${r.canvasWidth}px`),g=r):r&&(r.canvasWidth||g.canvasWidth)&&v&&((o||r.canvasWidth!==g.canvasWidth||r.canvasLeft!==g.canvasLeft)&&(b.style.left=`${r.canvasLeft}px`,M(r,h.scalePx)),g=r)}function M(t,n){o||f.drawFromBuffers(y,t.canvasLeft,t.canvasLeft+t.canvasWidth,v.id,n,n*a.getFirstLoopDuration(e.region),n*a.getExtraLoopDuration(e.region),e.region.canEdit?n*e.region.sampleOffset:n*e.region.startPosition,!1,s,E,a.getRegionColor(e.track,e.region),e.region.gain,e.region.playbackRate)}function T(){return P(null,!0)}function C(){const t=e.region.canEdit||l.get(e.region.sampleId)?e.region.sampleId:e.getTrack().sampleId;return l.get(t)||_.find(e.revision.samples,{id:t})}function E(){return f.cacheWaveform(v.buffer,v.id,h.scalePx,s,a.getRegionColor(e.track,e.region),e.region.gain,e.region.playbackRate)}function I(){let{rerender:t=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};gR.start("region:notes:create",!1,{viewId:e.$id,region:e.region,track:e.track,revision:e.revision,rerender:t},!1,!1)}e.getRegionBackgroundColor=()=>a.getRegionBackgroundColor(e.track,e.region,"audio"),e.onDblClick=function(){c.setPlaybackPosition(e.region.startPosition),e.adjustRegionWidth(e.region)}},controller:["$scope",function(n){let l=angular.noop;n.backupRegion=function(){s.pushUndo(n.revision),u.selectedRegions.add(n.region),g={playbackRate:n.region.playbackRate,startPosition:n.region.startPosition,sampleOffset:n.region.sampleOffset,loopLength:n.region.loopLength,endPosition:n.region.endPosition,firstTrack:u.selectedTrack,scalePx:h.scalePx}},n.getFirstLoopWidth=function(){return a.getFirstLoopWidth(n.region,h.scalePx)},n.getExtraLoopDuration=function(){return a.getExtraLoopDuration(n.region)},n.getTotalDuration=function(){return a.getTotalDuration(n.region)},n.getRightHandleType=function(){return n.canStretchRegion()?"stretch":n.getExtraLoopDuration()>0||n.track.type===Ks?"loop":"trim"},n.canStretchRegion=function(){return p.isRegionAudioStretchEnabled&&(n.track.type===Js||n.track.type===Ys||n.track.type===Hs||n.track.type===Qs)},n.resizingLeft=function(e){n.canStretchRegion()?(p.isRegionAudioStretching=!0,m.stretchRegionLeft(n.region,{...g,delta:e},h)):(p.isResizingLeft=!0,m.resizeRegionLeft(n.region,{...g,delta:e},h)),n.$applyAsync()},n.resizingRight=function(e){n.canStretchRegion()?(p.isRegionAudioStretching=!0,m.stretchRegionRight(n.region,{...g,delta:e},h)):(p.isResizingRight=!0,m.resizeRegionRight(n.region,{...g,delta:e},h)),n.$applyAsync()},n.expandLoop=function(e){p.isResizingLoop=!0,m.expandRegionLoop(n.region,{...g,delta:e},h),n.$applyAsync()},n.resizingFirstLoop=function(e){n.canStretchRegion()?(p.isRegionAudioStretching=!0,m.stretchRegionRight(n.region,{...g,delta:e},h)):(p.isResizingRight=!0,m.resizeFirstLoop(n.region,{...g,delta:e},h)),n.$applyAsync()},n.expandLoop=function(e){p.isResizingLoop=!0,m.expandRegionLoop(n.region,{...g,delta:e},h),n.$applyAsync()},n.regionUpdateResetLoopLength=function(){n.track.type!==Ks&&a.getTotalDuration(n.region)<=n.region.loopLength&&(n.region.loopLength=0),n.regionUpdate()},n.regionUpdate=function(){u.selectedRegions.clear(),u.selectedRegions.add(n.region),g={},p.isResizingLeft=!1,p.isResizingRight=!1,p.isResizingLoop=!1,p.isRegionAudioStretchEnabled&&p.isRegionAudioStretching&&o.convertRegion(n.region).then((()=>{m.moveRegions(u.selectedTrack)})).finally((()=>{p.isRegionAudioStretching=!1,n.$applyAsync()})),m.moveRegions(n.track),c.updateSourcesInTracks(),n.$applyAsync()},n.getHandlerOffset=function(){const e=n.region.fadeIn+n.region.fadeOut,t=n.getTotalDuration(n.region)-12/h.scalePx,o=Math.min((e-t)*h.scalePx,12);if(o>=0)return-o/(0===n.region.fadeIn||0===n.region.fadeOut?1:2)-6+"px"},n.backupFadeIn=function(){g=n.region.fadeIn||0,n.isFadingIn=!0,l=rd((function(){s.pushUndo(u.current),e.eventTrack("Apply region fade in Audio Editor",{category:"Mix Editor"})}))},n.moveFadeIn=function(e){l();const t=g-e/h.scalePx,o=n.region.startPosition+t,r=a.snapToGrid(o,h.snapDuration,{padding:5/h.scalePx},h)-o;n.region.fadeIn=As(p.isSnapping?t+r:t,0,n.getTotalDuration()-(n.region.fadeOut||0)),n.$applyAsync()},n.updateFadeIn=function(){n.isFadingIn=!1,c.updateSourcesInTracks()},n.backupFadeOut=function(){g=n.region.fadeOut||0,n.isFadingOut=!0,l=rd((function(){s.pushUndo(u.current),e.eventTrack("Apply region fade in Audio Editor",{category:"Mix Editor"})}))},n.moveFadeOut=function(e){l();const t=g+e/h.scalePx,o=n.region.endPosition-t,r=a.snapToGrid(o,h.snapDuration,{padding:5/h.scalePx},h)-o;n.region.fadeOut=As(p.isSnapping?t-r:t,0,n.getTotalDuration()-(n.region.fadeIn||0)),n.$applyAsync()},n.updateFadeOut=function(){n.isFadingOut=!1,c.updateSourcesInTracks()},n.setCycleToSelection=function(){var e=n.region.startPosition,o=n.region.endPosition;Array.from(u.selectedRegions).forEach((function(t){t.startPosition<e&&(e=t.startPosition),t.endPosition>o&&(o=t.endPosition)})),p.isCycling=!0,r.set(e,o),t.$broadcast(i.cycleChanged)},n.downloadRegionAsFile=function(){m.downloadRegionAsFile(n.region,n.track)},n.analyzeTempo=function(){a.openAnalyzeTempo(n.region)},n.selectTake=function(e){s.pushUndo(n.revision),n.region.sampleId=e}}]}}]).directive("audioEditorKeyEvents",["$rootScope","editorEvents","EditorState","MidiEditorState",function(e,t,n,o){return{restrict:"A",link:function(r){function i(i){if(o.hasFocus&&n.canCollaborate){var a=i.ctrlKey||i.metaKey;if(a||i.shiftKey){if(a&&!i.shiftKey)switch(i.key){case"a":e.$broadcast(t.keyDown.selectAllRegions),i.preventDefault();break;case"c":e.$broadcast(t.keyDown.copy);break;case"x":e.$broadcast(t.keyDown.cut);break;case"v":e.$broadcast(t.keyDown.paste)}}else switch(i.code){case"Backspace":case"Delete":e.$broadcast(t.keyDown.delete)}r.$applyAsync()}}document.addEventListener("keydown",i),r.$on("$destroy",(function(){document.removeEventListener("keydown",i)}))}}}]),angular.module("bandlab.editor").directive("mixEditorPlayhead",["EditorCycle","editorEvents","EditorPlayback","EditorPlayer","EditorScroll","EditorScrollState","EditorState","EditorView","MidiEditor","MidiEditorState",function(e,t,n,o,r,i,a,s,l,c){return{replace:!0,restrict:"E",templateUrl:"https://www.bandlab.com/web-app/editor/partials/_mix-editor-playhead-d5987599.html",link:function(u,d){var p;const m=new IntersectionObserver((function(t){0===t[0].intersectionRatio&&a.isPlaying&&a.isFollowingPlayhead&&!(a.crTime<0)&&JS.FOLLOW_PLAYHEAD&&(i.timelineLeft>a.scalePx*a.crTime?r.scrollToX({time:e.get().startTime,scalePx:a.scalePx}):r.scrollToX({direction:"right",offset:0}))}));function f(){s.isVisible(d[0],!1)||r.scrollToX({time:a.isSidetabOpen?a.crTime+200/a.scalePx:a.crTime,scalePx:a.scalePx})}function h(e){o.setPlaybackPosition(e),gR.start("syncVolume"),g(),s.isVisible(d[0],!1)||r.scrollToX({time:e,scalePx:a.scalePx})}function g(){var e=Math.round(a.crTime*a.scalePx-7);p!==e&&(d[0].style.transform=`translateX(${e}px)`),p=e}m.observe(d[0]),gR.add("playing",g),u.$on("$destroy",(function(){gR.remove("playing",g),m&&m.disconnect()})),u.$on(t.keyArrow,(function(e,t){if(!(a.isPlaying||c.hasFocus&&l.hasSelectedNotes())){var n=Math.floor(a.crTime/a.snapDuration)*a.snapDuration,o=n+a.snapDuration;n=n===a.crTime?n-a.snapDuration:n,o=o===a.crTime?o+a.snapDuration:o,h(37===t.which?Math.max(n,0):Math.min(o,JS.SONG_DURATION_MAX)),function(e){var t=a.crTime,n=i.timelineEl.scrollLeft+i.timelineEl.clientWidth-a.scalePx*t,o=i.timelineEl.clientWidth-n,s=i.timelineEl.clientWidth/6,l=(i.timelineEl.scrollLeft+i.timelineEl.clientWidth/2)/a.scalePx;if(39===e&&n-s<0&&n>0?r.scrollToX({time:l+a.snapDuration,scalePx:a.scalePx}):37===e&&o-s<0&&o<i.timelineEl.clientWidth&&o>0&&r.scrollToX({time:l-a.snapDuration,scalePx:a.scalePx}),c.isVisible){const e=i.notesTimelineEl.getBoundingClientRect().width/2;i.notesLeft=a.crTime*c.scalePx-e,gR.start("scroll:notesLeft",!1,i.notesLeft,!0,!1)}}(t.which),u.$digest(t.which)}})),u.$on(xT,(()=>{JS.FOLLOW_PLAYHEAD&&f()})),u.$on(t.keyDown.paste,(()=>f())),u.$on(DT,(()=>{d[0].style.pointerEvents="none",setTimeout((()=>{d[0].style.pointerEvents=null}),200)})),d.on("contextmenu",(function(e){e.preventDefault(),e.stopImmediatePropagation()})),u.goToBeginning=function(){n.startPositions.play=n.startPositions.play||0,h(n.startPositions.play),n.startPositions.play=0},u.$on(t.keyDown.goToBeginning,(function(){a.isPlaying||u.goToBeginning()}))}}}]),angular.module("bandlab.editor").directive("mixEditorRecordingRegion",["$rootScope","editorEvents","EditorPlayback","EditorState",function(e,t,n,o){return{restrict:"E",replace:!0,templateUrl:"https://www.bandlab.com/web-app/editor/partials/_mix-editor-recording-region-5361f2ba.html",link:function(r,i){gR.add("playing",l),i.css("background-color",r.track.color),i.css("left",`${Math.round(n.startPositions.record*o.scalePx)}px`),i.css("width","0px");const a=i[0].querySelector(".mix-editor-region-recording-cycle-count");a.style.display=o.isCycling?"block":"none",a.textContent=1;const s=e.$on(t.endOfCycle,(function(e,t){a.textContent=t+1}));function l(){i[0].style.width=(o.crTime-n.startPositions.record)*o.scalePx+"px"}r.$on("$destroy",(function(){s(),gR.remove("playing",l)}))}}}]),angular.module("bandlab.editor").directive("mixEditorRecordTakePlaceholder",["$rootScope","EditorCycle","editorEvents","EditorPlayback","EditorState",function(e,t,n,o,r){return{restrict:"E",replace:!0,templateUrl:"https://www.bandlab.com/web-app/editor/partials/_mix-editor-record-take-placeholder-b7ecca9d.html",link:function(i,a){const{endTime:s}=t.get();a.css("display","none");const l=e.$on(n.endOfCycle,(function(e,t){t&&(a.css("left",`${Math.round(o.startPositions.record*r.scalePx)}px`),a.css("width",(s-o.startPositions.record)*r.scalePx+"px"),a.css("display","block"))}));i.$on("$destroy",(function(){l()}))}}}]);let Gz=function(e){return e[e.AUDIO_SILENCE=101]="AUDIO_SILENCE",e[e.INVALID_AUDIO=102]="INVALID_AUDIO",e[e.BAD_PARAMETERS=103]="BAD_PARAMETERS",e[e.MODEL_UNKNOWN_ERROR=108]="MODEL_UNKNOWN_ERROR",e[e.UNKNOWN_ERROR=109]="UNKNOWN_ERROR",e}({});function Kz(e){var t=e.touches&&e.touches.length?e.touches:[e],n=e.changedTouches&&e.changedTouches[0]||t[0];return{x:n.clientX,y:n.clientY}}angular.module("bandlab.editor").directive("mixEditorRegion",["$injector","$rootScope","AudioStretch","DrumMachine","DrumMachineState","EditorAllowActions","EditorCycle","EditorDB","editorEvents","EditorHelper","EditorHistory","EditorMidiSamples","EditorMixdown","EditorPlayback","EditorPlayer","EditorRevision","EditorScrollState","EditorState","EditorTimeline","EditorTrack","EditorView","EditorWaveform","Modal",function(e,t,n,o,r,i,a,l,c,u,d,p,m,f,h,g,v,b,y,w,$,k,S){let P={};return{replace:!0,restrict:"E",templateUrl:"https://www.bandlab.com/web-app/editor/partials/_mix-editor-region-93ea51fc.html",link:function(e,t){const n=b.isWebGLEnabled&&u.isAudioTrack(e.track);var o,i,a=t[0].querySelector("canvas").getContext("2d"),s=rd((function(){function s(t){const{beatsPerBar:n,stepsPerBeat:o,stepCount:r}=t,i=r/o/n,a=$s({bpm:e.revision.metronome.bpm,signature:{noteValue:4,notesCount:4}});e.region.loopLength/a!==i&&(e.region.loopLength=a*i)}gR.add("scroll:timelineLeft",S),gR.add("scale:timeline",M),gR.add("scale:applyZoomTimeline",S),e.$on(c.startZoom,(()=>{gR.remove("scroll:timelineLeft",S),w={scalePx:b.scalePx,scale:b.scale},f=l.canvasLeft/b.scalePx,y=l.canvasWidth/b.scalePx})),e.$on(c.stopZoom,(()=>{gR.add("scroll:timelineLeft",S),w={},f=null,y=null})),e.track.type===Ks&&e.$on("DrumMachine:update",(function(t){let{oldSampleId:n,newSampleId:o,pattern:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.track===g.selectedTrack&&n===e.region.sampleId&&(e.region.sampleId=o,s(r))})),e.setSelectedRegionsDrumMachinePattern=e=>{const t=r.patterns[r._patterns.indexOf(e)],n=p.get(t.sampleId);Array.from(g.selectedRegions).some((e=>e.sampleId!==n.id))&&(s(e),d.pushUndo(g.current),g.selectedRegions.forEach((e=>{e.sampleId=n.id})),h.updateSourcesInTracks(),Gv("switch_pattern"))},n&&(C(),gR.add("region:timeline:census",C),e.$watch("region",(function(e,t){const n=t.endPosition-t.startPosition,o=e.endPosition-e.startPosition,r=Math.abs(o-n)>1e-6,i=e.isMoving!==t.isMoving||e.isProcessing!==t.isProcessing,a=e.isProcessing!==t.isProcessing||r||e.sampleId!==t.sampleId||e.sampleOffset!==t.sampleOffset||e.loopLength!==t.loopLength||e.playbackRate!==t.playbackRate||e._trackId!==t._trackId,s=e.bpm!==t.bpm||e.gain!==t.gain||e.endPosition!==t.endPosition||e.startPosition!==t.startPosition;i&&gR.start("region:timeline:updateRegionVisibility",!1,E(),!1,!1),a&&gR.start("region:timeline:updateSamples",!1,E(),!1,!1),s&&gR.start("region:timeline:updateTransform",!1,E(),!1,!1)}),!0),e.$watch("trackDragged",(function(t){const n={viewId:e.$id,region:e.region,track:e.track,revision:e.revision,dragged:t};gR.start("region:timeline:updateRegionVisibility",!1,n,!1,!1)})),e.$watch("track.order",(function(){gR.start("region:timeline:updateTransform",!1,E(),!1,!1)})),e.$watch((()=>u.getRegionColor(e.track,e.region)),(function(){gR.start("region:timeline:updateSamples",!1,E(),!1,!1)})),e.$watch((()=>e.isTrackCollapsed(e.track.id)),(()=>gR.start("region:timeline:updateSamples",!1,E(),!1,!1))),e.$watch("trackY",(()=>gR.start("region:timeline:updateTransform",!1,E(),!1,!1)))),n||(e.$watch((()=>e.isTrackCollapsed(e.track.id)),(e=>{a.canvas.height=e?k.WAVEFORM_HEIGHT_COLLAPSED:k.WAVEFORM_HEIGHT,M()})),e.$watch("region",(function(t,n){switch(!0){case t.isProcessing!==n.isProcessing:case t.sampleId!==n.sampleId:!function(){if(o=m(),gR.remove("scroll:timelineLeft",S),gR.remove("scale:timeline",M),o&&p.has(o.id))return e.region.isProcessing=!1,M(),gR.add("scroll:timelineLeft",S),void gR.add("scale:timeline",M);i=e.$watch((function(){return(o=m())&&(o.buffer&&u.isAudioBuffer(o.buffer)||o.error||o.notes)}),(function(t){t?(e.region.isProcessing=!1,M(),gR.add("scroll:timelineLeft",S),gR.add("scale:timeline",M)):rC(a),i()}))}();break;case t.bpm!==n.bpm:case t.endPosition!==n.endPosition:case t.sampleOffset!==n.sampleOffset:case t.loopLength!==n.loopLength:case t.gain!==n.gain:case t.playbackRate!==n.playbackRate:case t.startPosition!==n.startPosition:M()}}),!0),e.$watch((()=>u.getRegionColor(e.track,e.region)),M)),e.$watch("region",(function(t,n){switch(e.track.type===Ks&&t.sampleOffset!==n.sampleOffset&&(e.region.sampleOffset=0),!0){case t.isProcessing!==n.isProcessing:case t.sampleId!==n.sampleId:r.selectedPattern.sampleId!==t.sampleId&&r.selectedPattern.sampleId!==n.sampleId||e.loadDrumMachinePattern()}}),!0),e.$on("$destroy",(function(){n&&(gR.start("region:timeline:delete",!1,{viewId:e.$id,region:e.region},!1,!1),gR.remove("region:timeline:census",C)),gR.remove("scroll:timelineLeft",S),gR.remove("scale:timeline",M),gR.remove("scale:applyZoomTimeline",S)})),e.canReversePlaybackRate=function(){return e.region.sampleOffset<o.buffer.duration},e.renameRegion=function(){t.find("input")[0].focus()},e.reversePlaybackRate=function(){d.pushUndo(g.current),h.current.reverseRegions(g.selectedRegions).then((function(){e.$applyAsync()}))},Uu.get("https://voice-transfer.bandlab.io/v1/models").json().then((t=>{e.voiceModels=t})).catch((()=>{e.voiceModels=[]})),S()})),l={};function m(){const t=e.region.canEdit||p.get(e.region.sampleId)?e.region.sampleId:e.track.sampleId;return p.get(t)||_.find(e.revision.samples,{id:t})}let f,y;e.track.type===Ks&&(t[0].querySelector(".mix-editor-region-left-handler").remove(),t[0].querySelector(".mix-editor-region-right-handler").remove()),e.track.type!==Ys&&e.track.type!==Js&&e.track.type!==Qs&&t[0].querySelector(".studio-region-fade").remove(),a.canvas.height=k.WAVEFORM_HEIGHT,a.canvas.width=oC(screen.width),i=e.$watch((function(){return(o=m())&&(o.buffer&&u.isAudioBuffer(o.buffer)||o.error||o.notes)}),(function(){if(!o||!o.notes&&!o.buffer&&!o.error)return!1;e.region.hasSample=!o.error,e.region.isPlayable=u.isRegionPlayable(e.region,e.track)||!e.region.canEdit,e.region.isProcessing=!1,(o.buffer&&u.isAudioBuffer(o.buffer)||p.has(o.id))&&s(),i()})),e.getRegionBackgroundColor=function(){return u.getRegionBackgroundColor(e.track,e.region)};let w={};function S(t,n){a.canvas.style.width&&!b.isZooming&&(a.canvas.style.width=null),t=t||v.timelineLeft;const r=e.region.startPosition*b.scalePx,i=u.getTotalDuration(e.region)*b.scalePx;var s=$.isRegionVisible({left:r,width:i},t);!s&&l&&(s={canvasLeft:0,canvasWidth:r>t?i:0}),b.isZooming&&e.track.type!==Ks?(w.scalePx<=b.scalePx&&(a.canvas.style.left=f*b.scalePx+"px",a.canvas.style.width=y*b.scalePx+"px"),w.scalePx>b.scalePx&&(P({canvasLeft:s.canvasLeft/b.scalePx*w.scalePx,canvasWidth:s.canvasWidth/b.scalePx*w.scalePx},w.scalePx,w.scale),a.canvas.style.left=`${s.canvasLeft}px`,a.canvas.style.width=`${s.canvasWidth}px`),l=s):s&&(s.canvasWidth||l.canvasWidth)&&o&&((n||s.canvasWidth!==l.canvasWidth||s.canvasLeft!==l.canvasLeft)&&(a.canvas.style.left=`${s.canvasLeft}px`,P(s,b.scalePx,b.scale)),l=s)}function P(t,r,i){n||k.drawFromBuffers(a,t.canvasLeft,t.canvasLeft+t.canvasWidth,o.id,r,r*u.getFirstLoopDuration(e.region),r*u.getExtraLoopDuration(e.region),e.region.canEdit?r*e.region.sampleOffset:r*e.region.startPosition,p.has(o.id)&&i,e.isTrackCollapsed(e.track.id)?k.WAVEFORM_HEIGHT_COLLAPSED:k.WAVEFORM_HEIGHT,T,u.getRegionColor(e.track,e.region),e.region.gain,e.region.playbackRate,e.track.type,e.isTrackCollapsed(e.track.id))}function M(){return S(null,!0)}function T(){return p.has(o.id)?e.track.type===Ks&&_.find(e.track.patterns,{sampleId:e.region.sampleId})?k.cachePattern(_.findIndex(e.track.patterns,{sampleId:e.region.sampleId}),b.scalePx,u.getRegionColor(e.track,e.region),u.getFirstLoopDuration(e.region)):k.cacheScore(p.get(e.region.sampleId).notes,e.region.sampleOffset,b.scalePx,k.WAVEFORM_HEIGHT,u.getRegionColor(e.track,e.region),e.revision.metronome.bpm):k.cacheWaveform(o.buffer,o.id,b.scalePx,k.WAVEFORM_HEIGHT,u.getRegionColor(e.track,e.region),e.region.gain,e.region.playbackRate)}function C(){let{rerender:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};gR.start("region:timeline:create",!1,{rerender:e,...E()},!1,!1)}function E(){return{viewId:e.$id,region:e.region,track:e.track,revision:e.revision,isCollapsed:e.isTrackCollapsed(e.track.id),trackY:e.trackY}}},controller:["$scope","$analytics",function(r,v){let $=angular.noop;function k(){return g.selectedRegions.size>1}r.getNonEmptyDrumMachinePatterns=o.getNonEmptyDrumMachinePatterns,r.getDrumMachinePatternLabel=o.getDrumMachinePatternLabel,r.isSelected=function(){return g.selectedRegions.has(r.region)},r.backupRegion=function(){r.isSelected()||(g.selectedRegions.clear(),g.selectedRegions.add(r.region)),k()?t.$broadcast(c.mouseDown.multiRegionBackup):(d.pushUndo(r.revision),P={playbackRate:r.region.playbackRate,startPosition:r.region.startPosition,sampleOffset:r.region.sampleOffset,loopLength:r.region.loopLength,endPosition:r.region.endPosition,firstTrack:r.track,scalePx:b.scalePx})},r.openEditor=function(){r.region.isPlayable&&(g.selectedRegions=new Set([r.region]),w.setSelected(r.track),b.isPlaying||h.setPlaybackPosition(r.region.startPosition),r.track.type!==Ks?(r.isEditable()?u.displayMidiEditor({toggle:!1}):u.displayAudioEditor({toggle:!1}),setTimeout((()=>{r.$apply((()=>{t.$broadcast("MixEditorPanel:AdjustRegionWidth",r.region)}))}),200)):u.displayInstrument({toggle:!1}))},r.$on("DrumMachine:loadPattern",((e,t)=>{t.region.id===r.region.id&&r.loadDrumMachinePattern()})),r.loadDrumMachinePattern=r.track.type===Ks?function(){var e=_.find(r.track.patterns,{sampleId:r.region.sampleId});e&&(r.selectTrack(r.track),r.midiEditorState.isVisible=!1,o.selectPattern(e),b.isAudioInputActive=!0)}:angular.noop,r.getFirstLoopWidth=function(){return u.getFirstLoopWidth(r.region)},r.getExtraLoopDuration=function(){return u.getExtraLoopDuration(r.region)},r.getTotalDuration=function(){return u.getTotalDuration(r.region)},r.getRightHandleType=function(){return r.canStretchRegion()?"stretch":r.getExtraLoopDuration()>0||r.track.type===Ks?"loop":"trim"},r.canStretchRegion=function(){return b.isRegionAudioStretchEnabled&&(r.track.type===Js||r.track.type===Ys||r.track.type===Hs||r.track.type===Qs)},r.resizingLeft=function(e){k()?t.$broadcast(c.mouseDown.multiRegionResizeLeft,e):(r.canStretchRegion()?(b.isRegionAudioStretching=!0,y.stretchRegionLeft(r.region,{...P,delta:e},b)):(b.isResizingLeft=!0,y.resizeRegionLeft(r.region,{...P,delta:e},b)),r.$applyAsync())},r.resizingRight=function(e){k()?t.$broadcast(c.mouseDown.multiRegionResizeRight,e):(r.canStretchRegion()?(b.isRegionAudioStretching=!0,y.stretchRegionRight(r.region,{...P,delta:e},b)):(b.isResizingRight=!0,y.resizeRegionRight(r.region,{...P,delta:e},b)),r.$applyAsync())},r.resizingFirstLoop=function(e){k()?t.$broadcast(c.mouseDown.multiRegionResizeRight,e):(r.canStretchRegion()?(b.isRegionAudioStretching=!0,y.stretchRegionRight(r.region,{...P,delta:e},b)):(b.isResizingRight=!0,y.resizeFirstLoop(r.region,{...P,delta:e},b)),r.$applyAsync())},r.expandLoop=function(e){k()?t.$broadcast(c.mouseDown.multiRegionExpandLoop,e):(b.isResizingLoop=!0,y.expandRegionLoop(r.region,{...P,delta:e},b))},r.regionUpdateResetLoopLength=function(){r.track.type!==Ks&&u.getTotalDuration(r.region)<=r.region.loopLength&&(r.region.loopLength=0),r.regionUpdate()},r.regionUpdate=function(){k()?t.$broadcast(c.mouseUp.multiRegionUpdate):(g.selectedRegions.clear(),g.selectedRegions.add(r.region),P={},b.isResizingLeft=!1,b.isResizingRight=!1,b.isResizingLoop=!1,b.isRegionAudioStretchEnabled&&b.isRegionAudioStretching&&n.stretchRegion(r.region).then((()=>{y.moveRegions(g.selectedTrack)})).finally((()=>{b.isRegionAudioStretching=!1,r.$applyAsync()})),y.moveRegions(r.track),h.updateSourcesInTracks(),r.$applyAsync())},r.getHandlerOffset=function(){const e=r.region.fadeIn+r.region.fadeOut,t=r.getTotalDuration(r.region)-6/b.scalePx,n=Math.min((e-t)*b.scalePx,6);if(n>=0)return-n/(0===r.region.fadeIn||0===r.region.fadeOut?1:2)-3+"px"},r.backupFadeIn=function(){P=r.region.fadeIn||0,r.isFadingIn=!0,$=rd((()=>{d.pushUndo(g.current),v.eventTrack("Apply region fade in on track region",{category:"Mix Editor"})}))},r.moveFadeIn=function(e){$();const t=P-e/b.scalePx,n=r.region.startPosition+t,o=u.snapToGrid(n,b.snapDuration,{padding:5/b.scalePx})-n;r.region.fadeIn=As(b.isSnapping?t+o:t,0,r.getTotalDuration()-(r.region.fadeOut||0)),r.$applyAsync()},r.updateFadeIn=function(){r.isFadingIn=!1,h.updateSourcesInTracks()},r.backupFadeOut=function(){P=r.region.fadeOut||0,r.isFadingOut=!0,$=rd((function(){d.pushUndo(g.current),v.eventTrack("Apply region fade out on track region",{category:"Mix Editor"})}))},r.moveFadeOut=function(e){$();const t=P+e/b.scalePx,n=r.region.endPosition-t,o=u.snapToGrid(n,b.snapDuration,{padding:5/b.scalePx})-n;r.region.fadeOut=As(b.isSnapping?t-o:t,0,r.getTotalDuration()-(r.region.fadeIn||0)),r.$applyAsync()},r.updateFadeOut=function(){r.isFadingOut=!1,h.updateSourcesInTracks()},r.downloadRegionAsFile=function(){y.downloadRegionAsFile(r.region,r.track)},r.setCycleToSelection=function(){var e=r.region.startPosition,n=r.region.endPosition;Array.from(g.selectedRegions).forEach((function(t){t.startPosition<e&&(e=t.startPosition),t.endPosition>n&&(n=t.endPosition)})),b.isCycling=!0,a.set(e,n),t.$broadcast(c.cycleChanged)},r.canAudioStretch=()=>u.isAudioRegion(r.region),r.audioStretchPitchShift=function(e){d.pushUndo(g.current),Array.from(g.selectedRegions).filter(u.isAudioRegion).map((function(t){const o=Math.max(Math.min(t.pitchShift+e,12),-12);n.convertRegion(t,t.playbackRate,o).then((function(){r.$applyAsync()}))}))},r.audioStretchPlaybackRate=function(e){d.pushUndo(g.current),Array.from(g.selectedRegions).filter(u.isAudioRegion).map((function(t){const o=t.playbackRate+e*Math.sign(t.playbackRate);n.convertRegion(t,o).then((function(){y.moveRegions(g.current.tracks.find((e=>e.regions.includes(t)))),r.$applyAsync()}))}))},r.launchAudioStretch=function(){n.preview(r.region)},r.analyzeTempo=function(){u.openAnalyzeTempo(r.region)},r.isAudioRegionInVoiceTrack=()=>u.isAudioRegion(r.region)&&r.track.type===Qs,r.isAudioRegion=()=>u.isAudioRegion(r.region),r.canAiComposeRegion=()=>u.isMidiRegion(r.region)&&r.track.type!==Ks&&r.track.type!==Zs&&4===g.current.metronome.signature.notesCount&&4===g.current.metronome.signature.noteValue,r.recomposeRegion=function(e){d.pushUndo(g.current),d.startToIgnorePushUndo(),r.midiEditorState.isVisible=!1,y.recomposeMidiRegion(r.region,e).finally((()=>{h.updateSourcesInTracks(),d.stopToIgnorePushUndo()}))},r.aiComposeExtendRegion=function(e,t){d.pushUndo(g.current),d.startToIgnorePushUndo(),r.midiEditorState.isVisible=!1,y.aiComposeExtendMidiRegion(r.region,e,t).finally((()=>{h.updateSourcesInTracks(),d.stopToIgnorePushUndo()}))},r.aiComposeLayerRegion=function(e){d.pushUndo(g.current),d.startToIgnorePushUndo(),y.aiComposeLayerMidiRegion(r.region,e.order).finally((()=>{u.refreshTracksOrder(g.current.tracks),r.$applyAsync(),h.updateSourcesInTracks(),d.stopToIgnorePushUndo()}))},r.voiceClean=function(){if(b.isInBackground=!0,b.hasMembership)return t(),void s.set("hasSeenVoiceCleaner",!0,{expires:365});function e(){new S({id:"paywallModal",templateUrl:"https://www.bandlab.com/web-app/membership/partials/_paywall-modal-ee6789e7.html",contentScope:{useCheckoutModal:!0,checkoutSuccess:()=>{b.hasMembership=!0,t()},productAttribution:"voice_cleaner",productAttributionGroup:"voice_cleaner"},onCancel:()=>{b.isInBackground=!1}}).show()}function t(){d.pushUndo(g.current),d.startToIgnorePushUndo(),r.$applyAsync(),u.voiceClean(r.region).then((e=>{let{sampleBuffer:t,sampleId:n}=e;return f.saveAudioRecord(t,n)})).then((()=>{h.updateSourcesInTracks()})).finally((()=>{r.$applyAsync(),d.stopToIgnorePushUndo(),b.isInBackground=!1}))}s.get("hasSeenVoiceCleaner")?e():(_g(zn((()=>import("./chunk-9c38f0b2.js"))),{imageSrc:"https://www.bandlab.com/web-app/images/membership/membership-voice-cleaner-22c2747fdf.png",imageAlt:"Try Voice Cleaner with Membership",title:"Unlock crystalclear vocals",description:"Experience pure vocals with Voice Cleaner. Perfect for artists recording on the go, this AI feature removes background noise.",onTryMembership:e,onCancel:()=>{b.isInBackground=!1}}),s.set("hasSeenVoiceCleaner",!0,{expires:365}))},r.convertAudioToMidi=function(e,t){if(b.isInBackground=!0,b.hasMembership)return o(),void s.set("hasSeenAudioToMidi",!0,{expires:365});function n(){new S({id:"paywallModal",templateUrl:"https://www.bandlab.com/web-app/membership/partials/_paywall-modal-ee6789e7.html",contentScope:{useCheckoutModal:!0,checkoutSuccess:()=>{b.hasMembership=!0,o()},productAttribution:"audio_to_midi",productAttributionGroup:"audio_to_midi"},onCancel:()=>{b.isInBackground=!1}}).show()}function o(){d.pushUndo(g.current),d.startToIgnorePushUndo(),y.generateMidiRegionFromAudioRegion(r.region,t).then((t=>{const n=e.type===Js?"guitars":e.type===Ys?"bass":"piano",o=e.type===Js?"sparkling-acoustic-v2-v4":e.type===Ys?sl:al;r.addTrack({order:e.order,regions:[t],id:t.trackId,soundbank:o},n,"Audio-to-MIDI"),g.selectedRegions=new Set([t]),b.crTime=t.startPosition,g.current.tracks=u.refreshTracksOrder(g.current.tracks),g.current.tracks=u.applyTracksOrder(g.current.tracks)})).finally((()=>{r.$applyAsync(),h.updateSourcesInTracks(),d.stopToIgnorePushUndo(),b.isInBackground=!1}))}s.get("hasSeenAudioToMidi")?n():(_g(zn((()=>import("./chunk-9c38f0b2.js"))),{imageSrc:"https://www.bandlab.com/web-app/images/membership/membership-audio-to-midi-4023dbbf05.png",imageAlt:"Try Audio-to-MIDI with Membership",title:"Turn audio to MIDI notes",description:"Transform your singing or instrumental recordings into MIDI notes and explore 370+ virtual instruments with AudiotoMIDI.",onTryMembership:n,onCancel:()=>{b.isInBackground=!1}}),s.set("hasSeenAudioToMidi",!0,{expires:365}))},r.applyVoiceModelToRegion=function(e,t){let{id:n,name:o}=t;d.pushUndo(g.current),d.startToIgnorePushUndo(),b.isInBackground=!0,y.applyVoiceModelToVoiceRegion(r.region,n,o).then((t=>{const n=structuredClone(e);delete n.color,delete n.colorName,r.addTrack({...n,regions:[t],id:t.trackId},"voice","Voice Transfer"),g.selectedRegions=new Set([t]),g.current.tracks=u.refreshTracksOrder(g.current.tracks),g.current.tracks=u.applyTracksOrder(g.current.tracks)})).finally((()=>{r.$applyAsync(),h.updateSourcesInTracks(),d.stopToIgnorePushUndo(),b.isInBackground=!1}))},r.estimateKey=function(){return TL(r.region.id,r.track,e,r)},r.isEditable=function(){return p.has(r.region.sampleId)&&r.track.type!==Ks},r.downloadMidFile=function(){return m.renderToMidi(null,[r.region]).then((function(e){let{blob:t}=e;Kh(t,`${r.region.name||r.track.name}.mid`)}))},r.selectTake=function(e){d.pushUndo(r.revision),r.region.sampleId=e},r.track.type!==Ks&&r.$on(c.slice,(function(e,t){if((g.selectedRegions.has(r.region)||r.track===g.selectedTrack)&&i.isAllowed("slice")&&t-r.region.startPosition>Vl&&r.region.endPosition-t>Vl&&!r.region.isProcessing){d.pushUndo(r.revision);var n=y.splitRegion(r.region,t,t,r.track.regions);g.selectedRegions.delete(r.region),g.selectedRegions.add(n[1]),l.addSnapshot(r.revision.id,r.revision),h.updateSourcesInTracks()}}))}]}}]),angular.module("bandlab.editor").directive("mixEditorRegionGainSlider",["$injector",function(e){return{replace:!0,restrict:"E",template:"<div></div>",link:async function(t,n){import("./chunk-dfbd8ad4.js").then((function(o){let{mount:r}=o;const i=r(n[0],{$injector:e,scope:t});t.$on("$destroy",(function(){i.unmount()}))}))}}}]),angular.module("bandlab.editor").directive("mixEditorRuler",["EditorGrid","EditorHelper","EditorPlayer","EditorScroll","EditorScrollState","EditorState","EditorTimeline","Me","MidiEditorState",function(e,t,n,o,r,i,a,s,l){return{replace:!0,restrict:"E",templateUrl:"https://www.bandlab.com/web-app/editor/partials/_mix-editor-ruler-11137211.html",link:function(t,n){const o=n[0].querySelector(".mix-editor-ruler-graduation"),a=n[0].querySelector(".mix-editor-ruler-record-mark");function s(){e.updateGridLabel({element:o,state:i,leftBounds:r.timelineLeft-Al,viewportWidth:r.timelineEl.getBoundingClientRect().width})}t.$watch("state.isTimeRuler",s),t.$on(LT,(function(e,t){const n=`translateX(${(t.fromTime*i.scalePx).toFixed(0)}px)`;a.style.transform=n})),gR.add("scale:timeline",s),gR.add("scroll:timelineLeft",s)},controller:["$scope",function(e){let c,u=angular.noop;function d(e){let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e=Math.max(0,e),e=i.isTimeRuler||o?e:t.snapToGrid(e,i.snapDuration*i.scalePx,{}),e=Math.min(e/i.scalePx,JS.SONG_DURATION_MAX),n.setPlaybackPosition(e),gR.start("syncVolume")}function p(){const t=r.timelineEl.getBoundingClientRect().width/2;r.timelineLeft=i.crTime*i.scalePx-t,gR.start("scroll:timelineLeft",!1,r.timelineLeft,!0,!1),e.$applyAsync()}e.startMovingPlayhead=function(e,t){i.isDraggingPlayhead=!0,i.isInBackground=!0,d(t-Al)},e.finishMovingPlayhead=function(){clearInterval(c),i.isInBackground=!1,i.isDraggingPlayhead=!1},e.setCurrentTime=function(t,n,a,s,l){clearInterval(c);const u=function(e){const{tracksEl:t,timelineEl:n}=r,{left:o}=t.getBoundingClientRect(),{left:i,width:a}=n.getBoundingClientRect(),s=Math.ceil(o)<293;return e<i+32&&s?{left:!0}:e>i+a-32?{right:!0}:null}(l);if(u)c=setInterval((()=>{o.manualScroll(u),d(n=u.left?Math.max(p(i.crTime)-r.SCROLL_STEP,0):Math.min(p(i.crTime)+r.SCROLL_STEP,p(JS.SONG_DURATION_MAX)),!0),e.$digest(),e.$applyAsync()}),30);else{const e=function(e){const{left:t,width:n}=r.tracksEl.getBoundingClientRect();return e=Math.max(e-t,0),e=Math.min(e,n)}(l);d(n=(n-=Al)!==e?e:n)}function p(e){return i.scalePx*e}},e.$watch((()=>l.isDraggingPlayhead),(t=>{t?l.isVisible&&!l.isLocked&&(u=e.$watch("state.crTime",p)):u()})),e.me=s,e.exportCycleSelectionToMidi=a.exportCycleSelectionToMidi}]}}]),angular.module("bandlab.editor").directive("mixEditorScrollable",["EditorScrollState","EditorState","MidiEditorState",function(e,t,n){return{restrict:"A",link:function(o,r,i){var a=o.$eval(i.listeners)||{},s=o.$eval(i.emitters)||{};function l(e){r[0].scrollTop=e}function c(e){r[0].scrollLeft=e}function u(t){let{deltaX:n=0,deltaY:o=0}=t;s.notesTop&&(e.notesTop+=o),s.timelineLeft&&(e.timelineLeft+=n),s.tracksTop&&(e.tracksTop+=o),s.notesLeft&&(e.notesLeft+=n)}function d(e,t,n,r){const i=function(e,t){let n=0,o=e.length-1;for(;n<=o;){const r=Math.floor((n+o)/2);if(e[r]===t)return r;e[r]<t?n=r+1:o=r-1}return-1}(jl,n.scale);r>0?o.zoomOut({scale:jl[i-r]??1,state:n,time:t/n.scalePx}):o.zoomIn({scale:jl[i-r]??Ol,state:n,time:t/n.scalePx}),o.$apply(),e.preventDefault()}let p;r[0].addEventListener("wheel",(function(i){if(a$.element)return;!function(e){let o;r[0].classList.contains("mix-editor-tracks")?o=t.isFollowingPlayhead:r[0].classList.contains("midi-editor-container")&&(o=n.isFollowingPlayhead),o&&(clearTimeout(p),f.deltaX+=Math.abs(e.deltaX),f.deltaX>m&&(r[0].classList.contains("mix-editor-tracks")?t.isFollowingPlayhead=!1:r[0].classList.contains("midi-editor-container")&&(n.isFollowingPlayhead=!1),f.deltaX=0),p=setTimeout((()=>f.deltaX=0),500))}(i);const a=Math.sign(i.deltaY)*Math.ceil(Math.abs(i.deltaY/15));if(function(e){return e.ctrlKey&&0!==e.deltaY&&0===e.deltaX}(i)||i.ctrlKey||i.metaKey){if(th||Xf)if(r[0].classList.contains("mix-editor-tracks"))o.initZoomTimer({state:t}),d(i,i.pageX-269+e.timelineLeft,t,a);else if(r[0].classList.contains("midi-editor-container")){if(i.altKey&&n.isPianoRoll)return i.preventDefault(),void o.zoomPianoRollVertical(-a,i);o.initZoomTimer({state:n}),d(i,i.pageX-269+e.notesLeft,n,a)}}else{if(!i.altKey)return i.shiftKey?(i.preventDefault(),void u({deltaX:i.deltaY||i.deltaX,deltaY:0})):void(0===i.deltaX&&0===i.deltaY||(i.preventDefault(),u(i)));n.isPianoRoll&&r[0].classList.contains("midi-editor-container")&&(i.preventDefault(),o.zoomPianoRollVertical(-a,i))}})),r[0].addEventListener("touchstart",(function(e){if(t.isDraggingRegions)return;let n=Kz(e);function o(e){const t=Kz(e),o=n.x-t.x,r=n.y-t.y;e.preventDefault(),u({deltaX:o,deltaY:r}),n=t}r[0].addEventListener("touchmove",o),r[0].addEventListener("touchend",(function e(){r[0].removeEventListener("touchmove",o),r[0].removeEventListener("touchend",e)}))})),a.notesTop&&gR.add("scroll:notesTop",l),a.notesLeft&&gR.add("scroll:notesLeft",c),a.timelineLeft&&gR.add("scroll:timelineLeft",c),a.tracksTop&&gR.add("scroll:tracksTop",l),r[0].classList.contains("mix-editor-tracks")&&(e.timelineEl=r[0]),r[0].classList.contains("mix-editor-block-tracks")&&(e.tracksEl=r[0]),r[0].classList.contains("mix-editor-panel-track")&&(e.notesTimelineEl=r[0]),r[0].classList.contains("midi-editor-container")&&(e.notesEl=r[0]),o.$on("$destroy",(function(){gR.remove("scroll:notesLeft",c),gR.remove("scroll:notesTop",l),gR.remove("scroll:timelineLeft",c),gR.remove("scroll:tracksTop",l)}));const m=20,f={deltaX:0}}}}]),angular.module("bandlab.editor").directive("mixEditorScrollbarHorizontal",["EditorScroll","EditorScrollState","EditorState",function(e,t,n){return{restrict:"E",replace:!0,templateUrl:"https://www.bandlab.com/web-app/editor/partials/_mix-editor-scrollbar-horizontal-8d7bf882.html",link:function(o,r){const i=r[0].querySelector(".mix-editor-scrollbar-horizontal");let a=0;const s=new ResizeObserver((function(e){let[t]=e;a=t.contentRect.width,l()}));function l(){var e={clientWidth:a,scrollWidth:o.state.scalePx*Math.min(Math.max(180,o.state.songDuration+30),JS.SONG_DURATION_MAX),scrollLeft:t.timelineLeft},n=Math.round(Math.min(e.clientWidth/e.scrollWidth*e.clientWidth,e.clientWidth)),r=Math.max(n,40),s=Math.round(e.scrollLeft/(e.scrollWidth-e.clientWidth)*(e.clientWidth-r));o.barScale=n/r,o.scrollPercent=e.scrollLeft/(e.scrollWidth-e.clientWidth),i.style.width=`${r}px`,i.style.transform=`translateX(${s}px)`}s.observe(r[0]),gR.add("scroll:timelineLeft",l),gR.add("scale:timeline",l),r[0].addEventListener("mousedown",(function(t){var n=i.getBoundingClientRect(),o=t.clientX;o<n.left?e.scrollToX({direction:"left"}):o>n.right&&e.scrollToX({direction:"right"})}),{capture:!0}),o.$on("$destroy",(function(){s.disconnect()})),l(),o.state=n,o.$watch("state.songDuration",(function(){l()}))},controller:["EditorScroll","$scope",function(e,o){var r,i;o.backupPositionX=function(e,a,s){n.isFollowingPlayhead=!1,r=s.target.closest(".mix-editor-scrollbar-horizontal")?o.scrollPercent-(o.scrollPercent-e)*o.barScale:e,i=t.timelineLeft},o.scrollX=function(t){e.scrollToX({clickPosition:r,offsetPosition:i,percent:t,scrollWidth:Math.min(Math.max(180,n.songDuration+30),JS.SONG_DURATION_MAX)*n.scalePx})}}]}}]).directive("mixEditorScrollbarVertical",["EditorScroll","EditorScrollState",function(e,t){return{restrict:"E",replace:!0,templateUrl:"https://www.bandlab.com/web-app/editor/partials/_mix-editor-scrollbar-vertical-daf9cb4e.html",link:function(n,o){const r=o[0].querySelector(".mix-editor-scrollbar-vertical"),i=new ResizeObserver(a);function a(){var e=t.tracksEl.clientHeight,n=t.tracksEl.scrollHeight,i=t.tracksEl.scrollTop,a=Math.round(e/n*e),s=Math.round(i/(n-e)*(e-a));r.style.height=`${a}px`,r.style.transform=`translateY(${s}px)`,o[0].classList.toggle("hidden",e>=n),document.body.style.setProperty("--mix-editor-tracks-height",`${t.tracksEl.scrollHeight}px`)}i.observe(o[0]),o[0].addEventListener("mousedown",(function(t){var n=r.getBoundingClientRect(),o=t.clientY;o<n.top?e.scrollToY({direction:"up"}):o>n.bottom&&e.scrollToY({direction:"down"})}),{capture:!0}),n.$on("$destroy",(function(){i.disconnect()})),n.$watch("revision.tracks.length",a),gR.add("scroll:tracksTop",a)},controller:["EditorScroll","$scope",function(e,n){var o,r;n.backupPositionY=function(e){o=1-e,r=t.tracksTop},n.scrollY=function(t){e.scrollToY({clickPosition:o,offsetPosition:r,percent:1-t})}}]}}]),angular.module("bandlab.editor").directive("loopsLibrary",["$analytics","$http","$injector","$rootScope","$state","AppNotifications","AudioStretch","editorEvents","EditorRevision","Me","Modal","ProjectUploader","User","UserHelper",function(e,t,n,o,r,i,a,s,l,c,u,d,p,m){return{replace:!0,restrict:"E",link:async function(f,h){Promise.all([import("./chunk-577d17ed.js")]).then((async function(g){let[{mountLoopsLibrary:v}]=g;const b=v(h[0],{$analytics:e,$http:t,$injector:n,$rootScope:o,$state:r,scope:f,AppNotifications:i,AudioStretch:a,editorEvents:s,EditorRevision:l,Me:c,ProjectUploader:d,showPaywallModal:function(e,t,n){new u({id:"paywallModal",templateUrl:"https://www.bandlab.com/web-app/membership/partials/_paywall-modal-ee6789e7.html",contentScope:{useCheckoutModal:!0,checkoutSuccess:()=>n(),productAttribution:e,productAttributionGroup:"my_sounds"},onCancel:function(){t()}}).show()},User:p,UserHelper:m});f.$on("$destroy",(function(){b.unmount()}))}))}}}]).directive("studioRevisionHistorySidebar",["$rootScope","Editor","EditorCollaboratorsState","EditorRevision","EditorState","Post",function(e,t,n,o,r,i){return{replace:!0,restrict:"E",template:"<div></div>",link:async function(a,s){const l=Mt({applyAsyncAndSyncVolume:()=>{e.$applyAsync((()=>{e.$applyAsync((()=>{gR.start("syncVolume")}))}))},closeSideTab:()=>{a.closeSideTab(),a.$applyAsync()},getRevisionHistory:async()=>(await i.fromSong({songId:a.revision.song.id}).$promise).data.filter((e=>"Revision"===e.type)),loadRevision:t.loadRevision}),c=import("./chunk-2f350bda.js").then((function(c){let{mount:u}=c;return u(s[0],{$rootScope:e,scope:a,Editor:t,EditorCollaboratorsState:n,EditorRevision:o,EditorState:r,Post:i},l)}));a.$on("$destroy",(function(){!async function(){const e=await c;"RevisionHistory"===a.currentActiveTab&&a.closeSideTab(),e.unmount()}()}))}}}]).directive("mixEditorSidetabs",["$analytics","$state","$stateParams","EditorCollaboratorsState","EditorState","MidiMappable","MidiMapping",function(e,t,n,o,r,i,a){return{replace:!0,restrict:"E",templateUrl:"https://www.bandlab.com/web-app/editor/partials/_mix-editor-sidetabs-015c63d6.html",link:function(s){function l(){"MIDI"===s.currentActiveTab&&e.eventTrack("Close MIDI Mappings",{category:"Mix Editor",label:s.mappings.length}),r.isSidetabOpen=!1,s.currentActiveTab=null,s.stopMapping()}function c(t){"MIDI"===s.currentActiveTab&&e.eventTrack("Close MIDI Mappings",{category:"Mix Editor",label:s.mappings.length}),r.isSidetabOpen=!0,s.currentActiveTab=t,s.stopMapping(),e.eventTrack("Open Side Panel",{category:"Mix Editor",label:t}),"Lyrics"===t?s.$broadcast("elastic:adjust"):"MIDI"===t&&(i.target=null,s.startMapping())}s.closeSideTab=l,s.editorCollaboratorsState=o,s.currentActiveTab=null,s.displayTab=c,s.toggleTab=function(e){s.currentActiveTab===e?l():c(e)},s.mappings=a.getMappings(),s.clearMappings=a.clearMappings,s.isMapping=function(){return document.body.classList.contains("is-mapping")},s.startMapping=function(){document.body.classList.add("is-mapping")},s.stopMapping=function(){document.body.classList.remove("is-mapping")},s.$on("MixEditor:closeSideTab",l),s.$on("$destroy",(function(){s.stopMapping()})),n.userId&&s.toggleTab("Collab"),("soundLibrary"===t.params.source||t.params.sampleId||t.params.userSoundsSampleId||t.params.samplePack)&&c("Loops"),t.params.lyric&&c("Lyrics")}}}]),angular.module("bandlab.audio").directive("mixEditorSmartChordsControls",["$injector","EditorState",function(e,t){return{restrict:"E",replace:!0,template:'<div class="midi-fx-container"></div>',link:function(n,o){const r=Mt({});n.$watch((function(e){const{getTrack:n}=e;r.track={...n()},r.isAudioInputVisible=t.isAudioInputVisible})),import("./chunk-639bd649.js").then((function(t){let{mountSmartChordsControls:i}=t;const a=i(o[0],{$injector:e,scope:n},r);n.$on("$destroy",(function(){a.unmount()}))}))}}}]);const Yz={class:"ds-modal ds-modal-size-small"},Jz={class:"ds-modal-header"},Xz={class:"ds-modal-title"},Zz={class:"ds-modal-content"},Qz=["innerHTML"],eH={class:"ds-modal-footer ds-modal-footer-two-buttons"},tH=Vn({__name:"AskTranspositionConfirmationModal",props:{tonic:{},cancelFn:{type:Function},updateKeyFn:{type:Function},transposeRevisionFn:{type:Function}},emits:["closeModal"],setup:e=>(e,t)=>(si(),pi("section",Yz,[bi("header",Jz,[bi("h2",Xz,me("Transposition"),1)]),bi("section",Zz,[bi("p",{class:"ds-modal-content-p",innerHTML:`Would you like to adjust existing regions to <strong>${e.tonic}</strong>?`},null,8,Qz)]),bi("footer",eH,[yi(Dd,{type:"button",size:"medium",color:"secondary",padding:"default",onClick:t[0]||(t[0]=t=>{e.updateKeyFn(),e.$emit("closeModal")})},{default:Tn((()=>[ki(me("Dont Adjust"),1)])),_:1}),yi(Dd,{type:"button",size:"medium",color:"primary",padding:"default",onClick:t[1]||(t[1]=t=>{e.transposeRevisionFn(),e.$emit("closeModal")})},{default:Tn((()=>[ki(me("Adjust"),1)])),_:1})]),yi(ib,{onClick:t[2]||(t[2]=t=>{e.cancelFn(),e.$emit("closeModal")})})]))}),nH={class:"ds-modal ds-modal-small"},oH={class:"ds-modal-header"},rH={class:"ds-modal-title"},iH={class:"ds-modal-content"},aH=["innerHTML"],sH={class:"ds-modal-footer ds-modal-footer-two-buttons"},lH=Vn({__name:"MixEditorAskToStretchModal",props:{fromBPM:{},toBPM:{},cancelFn:{type:Function},stretchRevisionFn:{type:Function}},emits:["closeModal"],setup:e=>(e,t)=>(si(),pi("section",nH,[bi("header",oH,[bi("h2",rH,me("Audio stretching"),1)]),bi("section",iH,[bi("p",{class:"ds-modal-content-p",innerHTML:`Would you like to adjust existing audio regions from ${e.fromBPM} BPM to <strong>${e.toBPM} BPM</strong>?`},null,8,aH)]),bi("footer",sH,[yi(Dd,{type:"button",size:"medium",color:"secondary",padding:"default",onClick:t[0]||(t[0]=t=>e.$emit("closeModal"))},{default:Tn((()=>[ki(me("Dont Adjust"),1)])),_:1}),yi(Dd,{type:"button",size:"medium",color:"primary",padding:"default",onClick:t[1]||(t[1]=t=>e.stretchRevisionFn().then((()=>e.$emit("closeModal"))))},{default:Tn((()=>[ki(me("Adjust"),1)])),_:1})]),yi(ib,{onClick:t[2]||(t[2]=t=>{e.cancelFn(),e.$emit("closeModal")})})]))});angular.module("bandlab.editor").directive("mixEditorToolbar",["$q","$rootScope","AppNotifications","AudioStretch","EditorAllowActions","EditorCollaboratorsState","EditorCycle","EditorData","editorEvents","EditorHelper","EditorHistory","EditorLoader","EditorPlayback","EditorPlayer","EditorRevision","EditorSocket","EditorState","EditorTimeline","EditorTrack","Me","Metronome","MetronomeState","MidiEditor","MidiEditorState","Modal","Revision","RevisionImporter","SharedMidiSynth","Soundbank","User",function(e,t,n,o,r,i,a,s,l,c,u,d,p,m,f,h,g,v,b,y,w,$,k,S,P,M,T,C,E,I){return{replace:!0,restrict:"E",templateUrl:"https://www.bandlab.com/web-app/editor/partials/_mix-editor-toolbar-559b9207.html",controller:["$scope",function(R){var A,x;function L(e){var n;u.state["undo"===e?"hasUndo":"hasRedo"]()&&(g.isAutomationVisible&&t.$broadcast("Automation:ClearSelectedPoints"),R.revision=u[e](R.revision),R.revision.tracks.length&&!b.isGroupCollapsed(f.current.id,f.selectedTrack.trackGroupId)?(n=_.find(R.revision.tracks,{id:f.selectedTrack.id})||R.revision.tracks[0],b.setSelected(n)):b.setSelected({}),f.selectedTrack.type===Ks?E.setDrumMachine(f.selectedTrack):f.selectedTrack.soundbank&&E.setFromSoundbank(f.selectedTrack.soundbank),g.hasSoloTrack=s.checkAnySolo(),QF.value&&cB(),m.updateSourcesInTracks(),C.getSampler().bindMultipadSampler(),gR.start("syncVolume"))}R.changeTimeSignatureValue=function(e){u.pushUndo(R.revision),R.revision.metronome.signature.noteValue=e,m.current.updateTimeSignature()},R.changeTimeSignatureCount=function(e){u.pushUndo(R.revision),R.revision.metronome.signature.notesCount=e,m.current.updateTimeSignature()},R.$watch("revision.metronome",(function(e,t){var n=t.bpm/e.bpm;const o=$.justLoaded;if($.justLoaded=!1,e.bpm!==t.bpm&&!o){f.current.metronome.pristine=!1,g.scalePx=4*g.scale*e.bpm/120,S.scalePx=4*S.scale*e.bpm/120,m.setPlaybackPosition(Math.min(g.crTime*t.bpm/e.bpm,JS.SONG_DURATION_MAX)),g.containerWidth=JS.SONG_DURATION_MAX*g.scalePx,S.containerWidth=JS.SONG_DURATION_MAX*S.scalePx,f.current.tracks.flatMap((e=>[e.automation.pan,e.automation.volume,e.effects.map((e=>Object.values(e.automation)))])).flat(3).forEach((function(e){e.position*=n})),f.current.tracks.flatMap((e=>e.regions)).filter(c.isMidiRegion).filter((function(t){return t.bpm!==e.bpm})).forEach((function(n){const o=t.bpm/e.bpm;n.sampleOffset=n.sampleOffset*o,n.startPosition=n.startPosition*o,n.startPosition=Math.min(n.startPosition,JS.SONG_DURATION_MAX),n.loopLength=n.loopLength*o,n.endPosition=n.endPosition*o,n.endPosition>JS.SONG_DURATION_MAX&&(n.endPosition=JS.SONG_DURATION_MAX,v.warnTruncatedRegions()),n.bpm=e.bpm})),f.current.tracks.flatMap((e=>e.regions)).filter(c.isAudioRegion).forEach((function(t){t.bpm=e.bpm}));const{startTime:o,endTime:r}=a.get();a.set(o*n,r*n),a.reschedule(),m.updateSourcesInTracks()}e.signature.notesCount===t.signature.notesCount&&e.signature.noteValue===t.signature.noteValue||(e.signature.pristine=!1),document.body.style.setProperty("--mix-editor-track-width",`${g.containerWidth}px`),document.body.style.setProperty("--midi-editor-track-width",`${S.containerWidth}px`),gR.start("scale:notesTimeline",!1),gR.start("scale:timeline",!1)}),!0),R.optsKeys={major:tl,minor:nl},R.optsNoteValue=il,R.optsNotesCount=rl,R.undo=function(){L("undo")},R.$on(l.keyDown.undo,(function(){r.isAllowed("historyMove")&&R.$apply((function(){R.undo()}))})),R.redo=function(){L("redo")},R.$on(l.keyDown.redo,(function(){r.isAllowed("historyMove")&&R.$apply((function(){R.redo()}))})),R.$on(l.keyDown.triggerSlice,(function(){r.isAllowed("slice")&&R.triggerSlice()})),R.$on(l.keyDown.play,(function(){R.togglePlay()})),R.$on(l.keyDown.togglePlayStop,(function(){if(g.isPlaying)R.stop();else{if(!r.isAllowed("play"))return;R.togglePlay()}})),R.$on(l.keyDown.playFromStart,(function(){g.isPlaying||(g.isCycling?m.setPlaybackPosition(a.get().startTime):m.setPlaybackPosition(0)),R.togglePlay()}));const O=ay((function(){u.pushUndo(f.current)}),1e3,{leading:!0,trailing:!1});function j(){let t=e.resolve();{const n="Band"===_.get(R,"revision.song.author.type")?I.fromBand({bandId:R.revision.song.author.id,accepted:!0}).$promise.then((e=>{let{data:t}=e;return t.forEach((function(e){e.isMember=!0})),t})).catch((()=>[])):e.resolve([]),o="User"===_.get(R,"revision.song.author.type")?I.get({id:R.revision.song.author.id}).$promise.then((e=>(e.isOwner=!0,[e]))).catch((()=>[])):e.resolve([]),r=R.revision.song.id?I.getCollaborators({songId:R.revision.song.id,limit:50}).$promise.then((e=>{let{data:t}=e;return t.forEach((function(e){e.isCollaborator=!0})),t})).catch((()=>[])):e.resolve([]);t=e.all([o,n,r])}return t.then((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const o=t.flat(2).filter((e=>!!e));i.members=o.reduce(((e,t)=>(e[t.id]=t,e)),{})}))}function D(){const t=g.hasRevisionChanges||!f.current.song.id,n=d.pushTask("uploadMeta"),o=d.pushTask("createMixdown");return e.resolve(t?R.save({pristine:!0,publish:!1,redirect:!1}):f.current).then((function(o){return d.finishTask(n),o.isFork||!t&&"Ready"===f.current.mixdown.status?e.resolve(o):T.pollMixdown(o)})).then((function(e){return d.finishTask(o),e})).catch((function(t){return d.flushQueue(),e.reject(t)}))}R.$on("MidiMapping:MASTER_PLAYBACK",(function(e,t){let{toggle:n,value:o}=t;O(),(n||o&&!g.isPlaying||!o&&g.isPlaying)&&R.togglePlay()})),R.$on("MidiMapping:MASTER_VOLUME",(function(e){let{volume:t,toggle:n,min:o,max:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};O(),n&&(t=R.revision.volume>o?o:r),R.revision.volume=t,R.setRevisionVolume(t),gR.start("syncVolume")})),R.togglePlay=p.togglePlay,R.toggleMetronome=function(){g.isMetronomeEnabled=!g.isMetronomeEnabled,w.update()},R.$on(l.keyDown.toggleMetronome,(function(){R.toggleMetronome()})),R.backupBPM=function(){x=R.revision.metronome.bpm,f.current.tracks.flatMap((e=>e.regions)).forEach((function(e){e.bpm=x})),g.isPlaying&&R.togglePlay()},R.setRevisionBPM=function(e,t){var n=x+parseInt(.3*t);n=Math.min(ol,Math.max(n,40)),R.revision.metronome.bpm=n},R.stretchRevision=function(){setTimeout((function(){if(x===f.current.metronome.bpm||c.hasUneditableTrack())return;const t=f.current.metronome.bpm,n=f.current.tracks.flatMap((e=>e.regions));g.hasRevisionChanges=!0,A||(f.current.metronome.bpm=x,u.pushUndo(f.current),f.current.metronome.bpm=t,c.areMidiRegions(n)||function(){g.isInBackground=!0,A=!0;const t={fromBPM:x,toBPM:f.current.metronome.bpm,cancelFn:R.undo,stretchRevisionFn:()=>{var t=d.pushTask("postProcessAudio");return e.all(n.filter(c.isAudioRegion).map((function(e){const t=e.playbackRate*f.current.metronome.bpm/x;return o.convertRegion(e,t,e.pitchShift,!0)}))).then((function(e){const t=_.filter(e,(function(e){return e.endPosition-e.startPosition<Vl}));t.length&&(v.deleteRegionsFromTracks(f.current.tracks,t),v.warnDeletedRegions());const n=_.filter(e,(function(e){return e.endPosition>JS.SONG_DURATION_MAX}));n.length&&(_.forEach(n,(function(e){e.endPosition=JS.SONG_DURATION_MAX})),v.warnTruncatedRegions())})).finally((function(){d.finishTask(t),s.updateSongDuration()}))}};_g(lH,t,{onClose:()=>{g.isInBackground=!1,A=!1}})}())}))},R.setRevisionVolume=function(e){m.current.setMasterVolume(e)},R.setRevisionKey=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{};if(f.current.key?.toLowerCase()===t?.toLowerCase())return;const r=!t||!f.current.key||0===k.transposeKeys(f.current.key,t)||!f.current.tracks.flatMap((function(e){return c.isTrackTransposable(e)?e.regions:[]})).length||c.hasUneditableTrack();g.hasRevisionChanges=!0,r?(u.pushUndo(f.current),f.current.key=t,R.$applyAsync()):(g.isInBackground=!0,u.pushUndo(f.current),_g(tH,{tonic:t,cancelFn:n,transposeRevisionFn:()=>{g.isPlaying&&R.togglePlay();var n=d.pushTask("postProcessAudio");return e.all([k.transposeRevision(f.current,t),o.convertRevision(f.current,t)]).then((function(){f.current.key=t,d.finishTask(n)}))},updateKeyFn:()=>f.current.key=t},{onClose:()=>{g.isInBackground=!1}}))},R.toggleCycle=a.toggle,R.$on(l.keyDown.toggleCycle,(function(){r.isAllowed("cycle")&&R.toggleCycle()})),R.toggleRecord=p.toggleRecord,R.stop=()=>{p.stop()},R.$on(l.keyDown.toggleRecord,(function(){R.toggleRecord()})),R.$on("MidiMapping:MASTER_RECORD",(function(e,t){let{toggle:n,value:o}=t;n?R.toggleRecord():(!o||g.isRecording||g.isWaitingCountIn)&&(o||!g.isRecording&&!g.isWaitingCountIn)||R.toggleRecord()})),R.downloadEveryTrack=function(){return D().then(T.downloadStems)},R.downloadMixdown=function(){return D().then((function(e){M.get({id:e.id,edit:!0}).$promise.then((function(e){T.downloadMixdown(e)}))}))},R.isMIDITrackSelected=function(){return!!f.selectedTrack&&c.isBandLabInstrumentTrack(f.selectedTrack)},R.showRealtimeModal=function(){return(f.current.song.id?Promise.resolve():R.save({publish:!1,pristine:!0,triggeredFrom:"on_invite"})).then((function(){return h.getLink(f.current)})).then((function(n){!function(n){const o=new P({templateUrl:"https://www.bandlab.com/web-app/editor/partials/_mix-editor-collaborators-invite-035fdb9c.html",contentScope:{copyLink:e,disconnectSocket:R.disconnectSocket,editorCollaboratorsState:i,link:n,me:y,song:R.revision.song,sortMembers:t}});j(),o.show()}(n)}));function e(){n.addNotification({title:"Copied to clipboard",classList:"success",autoclose:1e3})}function t(e){return Object.values(e).sort((function(e,t){return e.id===y.id?-1:!i.writers[e.id]&&!i.readers[e.id]||i.writers[t.id]||i.readers[t.id]?(!i.writers[t.id]&&!i.readers[t.id]||i.writers[e.id]||i.readers[e.id],1):-1}))}},j(),R.getOthers=function(){return Object.keys(i.writers).filter((e=>e!==y.id)).map((e=>i.members[e]))},R.getConnected=function(){return Object.keys(i.writers).map((e=>i.members[e]))},R.isPreviewingRevision=function(){return g.isPreviewingRevision},R.joinSession=function(){return g.hasRevisionChanges=g.hasRevisionChanges||!f.current.song.id,e.resolve(g.hasRevisionChanges?R.save({publish:!1}):f.current).then((function(){return h.joinSession()}))},R.leaveSession=function(){h.leaveSession()},R.startSession=function(){return g.hasRevisionChanges=g.hasRevisionChanges||!f.current.song.id,(g.hasRevisionChanges?R.save({publish:!1}):Promise.resolve()).then((function(){return h.startSession()}))}}]}}]).directive("studioNotificationCenter",["$injector",function(e){return{replace:!0,restrict:"E",template:'<div class="studio-notification-center-opener"></div>',link:async function(t,n){import("./chunk-4bf552f2.js").then((o=>{let{mount:r}=o;const i=r(n[0],{$injector:e});t.$on("$destroy",i.unmount)}))}}}]).directive("projectKeySelector",["EditorRevision","EditorState",function(e,t){return{replace:!0,restrict:"E",template:"<div></div>",link:async function(n,o){const r=Mt({setIsInBackground:e=>t.isInBackground=e,setRevisionKey:n.setRevisionKey,revisionKey:e.current.key});n.$watch((()=>e.current.key),(()=>{r.revisionKey=e.current.key})),import("./chunk-6b3937e9.js").then((e=>{let{mount:t}=e;const i=t(o[0],{},r);n.$on("$destroy",i.unmount)}))}}}]),angular.module("bandlab.editor").directive("mixEditorToolbarBeatsDisplay",["$filter","EditorState",function(e,t){return{replace:!0,restrict:"E",template:'<div class="mix-editor-toolbar-beats-display" ng-class="{ recording: state.isRecording, playing: state.isPlaying }" ng-bind-html="state.crTime | timeToBeats: revision.metronome"></div>',link:function(n,o){var r,i=e("timeToBeats");function a(){var e=i(t.crTime,n.revision.metronome);r!==e&&(o[0].innerHTML=e),r=e}gR.add("playing",a),n.$on("$destroy",(function(){gR.remove("playing",a)}))}}}]).filter("timeToBeats",(function(){return function(e,t){var n=e/$s(t)+1,o=(n-Math.floor(n))*t.signature.notesCount+1;return`\n        <span class="bars">${n=`${Math.floor(Math.max(n,0))}`.padStart(3,0)}<span class="unit">bar</span></span>\n        <span class="beats">${o=Math.floor(o)}<span class="unit">beat</span></span>\n      `}})),angular.module("bandlab.editor").directive("mixEditorToolbarTimeDisplay",["$filter","EditorState",function(e,t){return{replace:!0,restrict:"E",template:'<span class="mix-editor-toolbar-time-display" ng-class="{ recording: state.isRecording, playing: state.isPlaying }" ng-bind="state.crTime | soundTime: true"></span>',link:function(n,o){var r,i=e("soundTime");function a(){var e=i(t.crTime,!0);r!==e&&(o[0].firstChild.nodeValue=e),r=e}gR.add("playing",a),n.$on("$destroy",(function(){gR.remove("playing",a)}))}}}]),angular.module("bandlab.editor").directive("mixEditorTrack",["$compile","$rootScope","DrumMachine","DrumMachineState","EditorAllowActions","EditorAutomation","editorEvents","EditorHelper","EditorHistory","EditorMidiSamples","EditorPlayer","EditorRevision","EditorState","EditorTimeline","EditorTrack",function(e,t,n,o,r,i,a,s,l,c,u,d,p,m,f){return{replace:!0,restrict:"E",templateUrl:"https://www.bandlab.com/web-app/editor/partials/_mix-editor-track-cac32392.html",link:function(r,i){let a;function l(){r.trackY=r.getTrackYPosition(r.track.id)}function h(e){e-=i[0].getBoundingClientRect().left,e=p.isTimeRuler?e:s.snapToGrid(e,p.snapDuration*p.scalePx,{}),e=Math.min(e/p.scalePx,JS.SONG_DURATION_MAX),u.setPlaybackPosition(e),gR.start("syncVolume")}r.$on(OT,(function(t,n){if(!p.isRecording||!f.isArmed(r.track))return;const o={audio:s.isAudioTrack(r.track),midi:s.isBandLabInstrumentTrack(r.track)},a=Object.assign(r.$new(!0),n,{audio:o.audio,channel:r.track.channel,isRecordingMidi:o.midi,track:r.track}),l=e("<mix-editor-recording-region></mix-editor-recording-region>")(a);i.append(l);const c=e("<mix-editor-record-take-placeholder></mix-editor-record-take-placeholder>")(a);i.append(c);const u=r.$on(jT,(function(){l.remove(),c.remove(),a.$destroy(),u()}))})),i[0].addEventListener("mouseup",(function(e){if(!(1!==e.which||e.target!==i[0]||p.isPlaying||p.isAreaSelecting||r.isMovingRegions))return s.isAudioTrack(r.track)||r.drumMachinePresetEmpty()?(h(e.clientX),void r.$applyAsync()):(1===e.detail&&(h(e.clientX),t.$broadcast(DT)),2===e.detail&&r.createMidiRegion(e.offsetX),r.$digest(),void r.$applyAsync())}),!1),i[0].addEventListener("touchstart",(function(e){0!==e.which||e.touches.length>1||p.isPlaying||h(e.touches[0].clientX)}),!1),i[0].addEventListener("contextmenu",(e=>{a=e.offsetX})),r.$watch((()=>r.isTrackBeingDragged(r.track.id)),(e=>r.trackDragged=e)),gR.add("updateArrangementView",l),r.$on("$destroy",(()=>{gR.remove("updateArrangementView",l)})),r.hasSelectedPattern=function(){return n.getCurrentPreset()},r.drumMachinePresetEmpty=function(){const e=c.get(n.getCurrentPreset().sampleId);return r.track.type===Ks&&(!e?.notes||0===e.notes.length)},r.createMidiRegion=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;if(!e||r.drumMachinePresetEmpty())return;const n=$s(d.current.metronome),i=Math.floor(e/p.scalePx/n)*n;let l;if(r.track.type===Ks){const{selectedPattern:e,selectedPatternIndex:t,_patterns:n,patternLengthInBars:r}=o;l=m.createDrumMachineRegion(d.selectedTrack,e.sampleId,n[t],i,r),Gv("new_pattern")}else l=m.createEmptyRegion(r.track,{time:i,endTime:i+n});u.setPlaybackPosition(i),gR.start("syncVolume"),r.track.type===Ks?s.displayInstrument({toggle:!1}):(s.displayMidiEditor({toggle:!1}),setTimeout((()=>{r.$apply((()=>{t.$broadcast("MixEditorPanel:AdjustRegionWidth",l)}))}),200))}},controller:["$scope",function(e){e.pasteRegion=function(){if(!zS.value||"automation"===zS.value.type||p.crTime>=JS.SONG_DURATION_MAX)return;l.pushUndo(e.revision);var t=_.minBy(zS.value,"startPosition").startPosition,n=_.minBy(zS.value,"trackOrder").trackOrder,o=_.maxBy(zS.value,"trackOrder").trackOrder-n;if(e.track.order+o>=e.revision.tracks.length)return void(e.revision.tracks.length<JS.TRACKS_LIMIT?alert("Please add extra track"):alert("Please paste to other track"));d.selectedRegions.clear();const r=new Set;_.forEach(zS.value,(function(o){var i=o.endPosition-o.startPosition,a=e.track.order-n+o.trackOrder,s=_.find(e.revision.tracks,{order:a});(o=_.clone(o)).id=ad(),o.trackId===s.id&&r.add(o),o.trackId=s.id,o.startPosition=o.startPosition-t+p.crTime,o.endPosition=Math.min(o.startPosition+i,JS.SONG_DURATION_MAX),d.selectedRegions.add(o),o.startPosition<JS.SONG_DURATION_MAX&&(s.regions.push(o),m.moveRegions(s))})),i.checkConfirmation("paste",zS.value).then((function(t){t&&_.forEach(Array.from(d.selectedRegions),(function(t){var n=_.find(e.revision.tracks,{id:t.trackId});i.deleteAutomationInRange(n,t.startPosition,t.endPosition),i.pasteAutomation(n,t,t.startPosition,r.has(t))}))})),u.updateSourcesInTracks()},e.clipboard=zS,e.isSelected=()=>d.selectedTrack===e.track,e.$on(a.keyDown.paste,(function(){"automation"!==zS.value.type&&d.selectedTrack===e.track&&r.isAllowed("paste")&&e.$apply(e.pasteRegion)}))}]}}]),angular.module("bandlab.editor").directive("mixEditorTrackDropFile",["editorEvents","EditorState",function(e,t){return{restrict:"A",link:function(n,o){var r=angular.element('<div class="mix-editor-region-ghost"></div>');function i(){o.removeClass("dropping"),r.remove(),r.removeClass("disallow"),r.css("width",null),window.removeEventListener("dragend",i)}function a(e){var n=Math.floor(e/t.scalePx/t.snapDuration)*t.snapDuration*t.scalePx;return t.isSnapping?n:e}o.bind("drop",(function(o){var r=o.dataTransfer.items,s={time:a(o.offsetX)/t.scalePx,track:n.track};i(),o.preventDefault(),o.stopPropagation(),o.dataTransfer.files.length?n.$emit(e.importFile,Object.assign(s,{file:o.dataTransfer.files[0],type:r[0].type})):n.$emit(e.importFile,Object.assign(s,HS.value))})),o.bind("dragover",(function(e){if(e.preventDefault(),e.stopPropagation(),pI.value.slug)return void(e.dataTransfer.dropEffect="none");const{value:o}=HS;if("track"===o.type)return t.droppedTrack=n.track,t.droppedTrackY=e.offsetY,r.css("visibility","hidden"),void n.$applyAsync();function i(t){r.addClass(`disallow ${t}`),e.dataTransfer.dropEffect="none"}o.type===Ks&&o.trackId!==n.track.id?i(n.track.type===Ks?"not-supported-track":"not-drum-machine"):"audio"===o.type&&n.track.soundbank||"audio"===o.type&&n.track.type===Zs?i("not-audio"):(o.type===Ks&&n.track.type===Ks||"audio"===o.type&&!n.track.soundbank||e.dataTransfer.types.includes("Files"))&&(e.dataTransfer.dropEffect="copy"),r.css("visibility","visible"),r.css("left",`${a(e.offsetX)}px`)})),o.bind("dragenter",(function(e){if(e.preventDefault(),e.stopPropagation(),window.removeEventListener("dragend",i),window.addEventListener("dragend",i),!pI.value.slug&&(o.addClass("dropping"),!e.target.classList.contains("mix-editor-region"))){o.append(r),r.removeClass("disallow not-audio not-midi not-drum-machine not-supported-track");let i=HS.value.duration;HS.value.bpm&&HS.value.bpm!==n.revision.metronome.bpm&&(i=i*HS.value.bpm/n.revision.metronome.bpm),r.css({left:`${a(e.offsetX)}px`,width:i*t.scalePx+"px"})}})),o.bind("dragleave",(function(e){e.target.classList.contains("mix-editor-region")||i()}))}}}]),angular.module("bandlab.editor").directive("mixEditorTrackGrid",["EditorGrid","EditorState",function(e,t){return{replace:!0,restrict:"E",templateUrl:"https://www.bandlab.com/web-app/editor/partials/_mix-editor-track-grid-57bb17a5.html",link:function(n){var o=document.getElementById("mix-editor-track-grid-pattern"),r=document.getElementById("mix-editor-track-highlight-pattern");function i(){1!==t.snapSetting.value&&0!==t.snapSetting.value||!t.isTripletGrid||(t.isTripletGrid=!1),e.updateTrackGrid({gridPattern:o,highlightPattern:r})}n.$watchGroup(["state.snapSetting","state.isTimeRuler","state.isTripletGrid"],i),gR.add("scale:timeline",i)}}}]),angular.module("bandlab.editor").directive("mixEditorTrackHeaderInstrument",["$injector",function(e){return{restrict:"C",link:function(t,n){import("./chunk-bdb26337.js").then((function(o){let{mount:r}=o;const i=r(n[0],{$injector:e,scope:t});t.$on("$destroy",(function(){i.unmount()}))}))}}}]).directive("volumeSlider",["$injector",function(e){return{restrict:"E",replace:!0,template:"<div></div>",link:function(t,n){import("./chunk-c446c90b.js").then((function(o){let{mountVolumeSlider:r}=o;const i=r(n[0],{$injector:e,scope:t});t.$on("$destroy",(function(){i.unmount()}))}))}}}]).directive("panKnob",["$injector",function(e){return{restrict:"E",replace:!0,template:"<div></div>",link:function(t,n){import("./chunk-8b071d3b.js").then((function(o){let{mountPanKnob:r}=o;const i=r(n[0],{$injector:e,scope:t});t.$on("$destroy",(function(){i.unmount()}))}))}}}]).directive("mixEditorTrackHeaderGroup",["$timeout","EditorRevision","EditorState","EditorTrack",function(e,t,n,o){return{restrict:"E",transclude:!0,templateUrl:"https://www.bandlab.com/web-app/editor/partials/_mix-editor-track-header-group-6684355d.html",link:function(r,i){function a(){return r.$parent.e.item}function s(e){r.fireAutoscroll(i[0],e)}function l(){r.resetDragState(),r.endAutoscroll(),i[0].draggable=!1,document.removeEventListener("dragover",s),document.removeEventListener("pointerup",l)}function c(e){e.target!==i[0].querySelector(".mix-editor-track-header-name input")&&(i.off("dragstart",c),r.onDragStartOnItem(e,{kind:"trackGroup",item:a()}),r.$applyAsync())}let u;function d(){const e=a().tracks.map((e=>e.id));return t.current.tracks.filter((t=>e.includes(t.id)))}r.getGroupFromScope=a,r.isGroupMuted=()=>d().every((e=>e.isMuted)),r.isGroupSoloed=()=>d().every((e=>e.isSolo)),r.isNoSoloInGroup=()=>d().every((e=>!e.isSolo)),r.toggleMuteAllTracksInGroup=()=>o.toggleMuteTracks(d()),r.toggleSoloAllTracksInGroup=e=>{e.altKey?o.toggleExclusiveSoloTracks(d()):o.toggleSoloTracks(d())},Qf||(i.on("pointerdown",(function(e){e.target!==i[0]&&e.target!==i[0].querySelector(".mix-editor-track-header-name")||(i[0].draggable=!0,i.on("dragstart",c),document.addEventListener("dragover",s,{passive:!1}),document.addEventListener("pointerup",l))})),i.on("dragend",(function(){r.onDragEndOnItem(),l(),e((function(){gR.start("anticipateScrollLayoutShift:tracksTop")}))})),angular.element(i[0].querySelector(".track-header-group-header")).on("dragover",(function(e){r.onDragOverOnItem(e,r.revision.id,{kind:"trackGroup",item:a()}),r.$applyAsync()}))),r.moveGroup=e=>o.moveGroup(a(),e),r.toggleCollapseGroup=e=>{const{id:n,tracks:i}=a(),s=i.map((e=>e.id));e.altKey?o.toggleCollapseAllTracksAndGroups("trackGroup",n):(o.toggleCollapseGroup(r.revision.id,n),o.isGroupCollapsed(r.revision.id,n)&&(t.selectedRegions=new Set([...t.selectedRegions].filter((e=>!s.includes(e.trackId)))),s.includes(t.selectedTrack?.id)&&(t.selectedTrack={})))},r.$watch((()=>r.revision.trackGroups.find((e=>e.id===a().id))),(e=>{const t=e||a();r.groupColor=r.getDSGroupColor(t.colorName),r.colorName=t.colorName,r.name=t.name}),!0),r.focusNameInput=()=>{n.hasMembership&&(i[0].querySelector(".mix-editor-track-header-name input").focus(),i[0].querySelector(".mix-editor-track-header-name input").select())},r.onNameFocus=()=>{u=r.name},r.onNameBlur=()=>{if(!n.hasMembership)return void(r.name=u);const e=r.name||u;e!==u&&o.updateGroupName(r.revision.trackGroups,a().id,e,!0)},r.setGroupColor=e=>o.updateGroupColor(r.revision.trackGroups,a().id,e),r.ungroup=()=>o.ungroup(r.revision.trackGroups,a().id,!0),r.trackColorsMatchGroupColor=()=>d().every((e=>e.colorName===r.colorName)),r.applyGroupColorToTracks=()=>{d().forEach((e=>{const{hex:t}=r.trackColors.find((e=>e.name===r.colorName));e.color=t,e.colorName=r.colorName}))}}}}]).directive("mixEditorTrackHeader",["$analytics","$injector","$rootScope","$timeout","EditorAutomation","editorEvents","EditorHelper","EditorHistory","EditorMixdown","EditorPlayer","EditorRevision","EditorState","EditorTrack","EffectsPreset","Soundbank",function(e,t,n,o,r,i,a,s,l,c,u,d,p,m,f){return{replace:!0,restrict:"E",templateUrl:"https://www.bandlab.com/web-app/editor/partials/_mix-editor-track-header-89965deb.html",link:function(t,r){let a;function l(e){e.target!==r[0].querySelector(".mix-editor-track-header-name input")&&(r.off("dragstart",l),t.onDragStartOnItem(e,{kind:"track",item:t.track}),t.$applyAsync())}function c(){r.removeClass("dropping"),document.querySelector(`.mix-editor-track[data-id="${t.track.id}"]`).classList.remove("dropping"),document.body.style.cursor=null,document.body.removeAttribute("title")}function m(e,t){return e.id!==t.id&&t.effects.length<8}function f(e){t.fireAutoscroll(r[0],e)}function h(){t.resetDragState(),t.endAutoscroll(),r[0].draggable=!1,document.removeEventListener("dragover",f),document.removeEventListener("mouseup",h)}t.createGroupFromTrack=()=>p.createGroupFromTrack(t.revision.trackGroups,t.track,"Group",t.track.colorName,!0),t.addTrackToGroup=e=>p.addTrackToGroupAtIndex(t.revision,e.id,t.track,-1,!0),t.listAvailableGroups=()=>p.listAvailableGroups(t.revision,t.track.trackGroupId),t.formatTrackIndex=()=>`${t.revision.tracks.findIndex((e=>e.id===t.track.id))+1}`.padStart(2,"0"),Qf||(r.on("mousedown",(function(e){e.target!==r[0]&&e.target!==r[0].querySelector(".mix-editor-track-header-name")&&e.target!==r[0].querySelector(".mix-editor-track-header-index")||(r[0].draggable=!0,r.on("dragstart",l),document.addEventListener("dragover",f,{passive:!1}),document.addEventListener("mouseup",h))})),r.on("dragover",(function(e){if(pI.value.slug){const n=u.selectedTrack,o=t.track;if(n.id===o.id)return;return e.preventDefault(),e.stopPropagation(),r.addClass("dropping"),document.querySelector(`.mix-editor-track[data-id="${t.track.id}"]`).classList.add("dropping"),m(n,o)||(e.dataTransfer.dropEffect="none",document.body.style.cursor="not-allowed",document.body.title="Maximum amount of effects reached"),void t.$applyAsync()}t.onDragOverOnItem(e,t.revision.id,{kind:"track",item:t.track}),t.$applyAsync()})),r.on("dragend",(function(){t.onDragEndOnItem(),h(),o((function(){gR.start("anticipateScrollLayoutShift:tracksTop")}))})),r.on("drop",(function(e){if(pI.value.slug){e.preventDefault(),e.stopPropagation();const o=u.selectedTrack,r=t.track,i=JSON.parse(angular.toJson(_.cloneDeep(pI.value)));if(!m(o,r))return;e.altKey||n.$broadcast(hT,{effects:o.effects.filter((e=>e.id!==i.id)),preset:"none"===o.preset?null:o.preset}),i.id=ad(),t.selectTrack(r),n.$broadcast(hT,{effects:r.effects.concat(i),preset:"none"===r.preset?null:r.preset}),c()}})),r.on("dragleave",c)),t.selectFile=function(){return Fh({accept:"audio/*"}).then((function(e){t.$emit(i.importFile,{file:e[0],track:t.track})}))},t.focusTrackName=function(){r[0].querySelector(".mix-editor-track-header-name input").focus(),r[0].querySelector(".mix-editor-track-header-name input").select()},t.onTrackNameFocus=function(){a=t.track.name},t.onTrackNameBlur=function(){const n=t.track.name||a;n!==a&&(t.track.name=a,s.pushUndo(u.current),d.hasRevisionChanges=!0,e.eventTrack("Rename Track",{category:"Mix Editor"})),t.track.name=n}},controller:["$scope",function(e){e.duplicateTrack=function(){p.duplicateTrack(e.track),gR.start("anticipateScrollLayoutShift:tracksTop")},e.displayPresetSettings=()=>a.displayPresetSettings({toggle:!1}),e.isArmed=()=>p.isArmed(e.track),e.toggleSolo=function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).altKey?p.toggleExclusiveSolo(e.track):p.toggleSolo(e.track)},e.toggleMute=()=>p.toggleMute(e.track),e.openAudioInput=()=>e.track.type===Qs?a.displayAutoPitch({toggle:!1}):a.displayInstrument({toggle:!1}),e.$on(i.keyDown.soloTrack,(function(){e.isSelected()&&e.toggleSolo()})),e.$on(i.keyDown.muteTrack,(function(){e.isSelected()&&e.toggleMute()}));const n=ay((function(){s.pushUndo(u.current)}),1e3,{leading:!0,trailing:!1});e.$on("MidiMapping:TRACK_MUTE",(function(t,o){let{trackId:r,value:i,toggle:a}=o;r===e.track.id&&(n(),a?p.toggleMute(e.track):i?p.mute(e.track):p.unmute(e.track),e.$applyAsync())})),e.$on("MidiMapping:TRACK_SOLO",(function(t,o){let{trackId:r,value:i,toggle:a}=o;r===e.track.id&&(n(),a?p.toggleSolo(e.track):i?p.solo(e.track):p.unsolo(e.track),e.$applyAsync())})),e.current=f.getCurrent(),e.getPresetName=()=>m.computeSelectedPreset(e.getTrack()).displayName,e.hasPreset=()=>"none"!==e.getTrack().preset,e.hasPresetChanged=function(){const n=_.get(e.getTrack(),"effectsData.originalPresetId",e.getTrack().preset),o=[...m.getPresetsSync().all,...m.getUserPresetsSync(),...m.trendingPresets.value].find((e=>e.id===n||e.slug===n));if(!o)return;const r=o.effects.map((e=>hI(t,e)));return!gf((e.getTrack().effects||[]).map((e=>hI(t,e))),r)},e.getTrack=function(){return e.track},e.setTrackVolume=function(t){c.current.setTrackVolume(e.track,t)},e.$on("MidiMapping:TRACK_VOLUME",(function(t,o){let{trackId:r,volume:i,toggle:a,min:s,max:l,crTime:c}=o;r===e.track.id&&(n(),e.track.volume=a?e.track.volume>s?s:l:i,e.setTrackVolume(e.track.volume),gR.start("syncVolume"),d.isRecording&&d.isRecordingAutomation&&xs(e.track.automation.volume,c,e.track.volume))})),e.setTrackPan=function(t){c.current.setTrackPan(e.track,t)},e.$on("MidiMapping:TRACK_PAN",(function(t,o){let{pan:r,trackId:i,toggle:a,min:s,max:l,crTime:c}=o;i===e.track.id&&(n(),e.track.pan=a?e.track.pan>s?s:l:r,e.setTrackPan(c),gR.start("syncVolume"),d.isRecording&&d.isRecordingAutomation&&xs(e.track.automation.pan,c,e.track.pan))})),e.hasTrackAutomation=function(){return e.track.automation.volume.length>0||e.track.automation.pan.length>0||r.getAutomatableParameters(e.track.effects).some((function(e){return e.automation.length}))},e.isSelected=function(){return u.selectedTrack===e.track},e.downloadTrackAsWav=function(){return d.isPlaying&&e.togglePlay(),p.downloadTrackMixdown(e.track)},e.downloadTrackAsMid=function(){return l.renderToMidi(e.track).then((function(t){let{blob:n}=t;Kh(n,`${e.track.name||"MIDI Track"}.mid`)}))},e.toggleFreeze=p.toggleFreeze(e),e.$on("MixEditor:FreezeTrack",((t,n)=>{n===e.track.id&&p.freezeTrack(e,e.track)})),e.$on("MixEditor:UnfreezeTrack",((t,n)=>{n===e.track.id&&p.unfreezeTrack(e.track)}))}]}}]).directive("mixEditorAutomationMenu",["$rootScope","EditorAutomation","EditorRevision","EditorState",function(e,t,n,o){return{replace:!0,restrict:"E",template:'<div class="mix-editor-track-header-automation"></div>',link:function(r,i){const a=Mt({hasNewTrackHeadUpdate:o.hasNewTrackHeadUpdate,setAutomationParameter:t=>{n.trackAutomationParameters.set(r.track,t),e.$applyAsync()},automatableParameters:t.getAutomatableParameters(r.track.effects),selectedParam:s(),trackAutomation:r.track.automation});function s(){const e=n.trackAutomationParameters.get(r.track);return["pan","sendLevel","volume"].includes(e)?{pan:ml,sendLevel:fl,volume:pl}[e]:e||pl}r.$watchGroup(["track.automation",s],(()=>{a.selectedParam=s(),a.trackAutomation=r.track.automation})),r.$watch((()=>t.getAutomatableParameters(r.track.effects)),(()=>{n.selectedTrack.id===r.track.id&&(a.automatableParameters=t.getAutomatableParameters(r.track.effects))}),!0),import("./chunk-929a2ee2.js").then((e=>{let{mount:t}=e;const n=t(i[0],{},a);r.$on("$destroy",n.unmount)}))}}}]),angular.module("bandlab.editor").directive("mixEditorTrackPlaceholder",["$stateParams","editorEvents","EditorRevision","EditorScrollState","EditorState","EditorTrack",function(e,t,n,o,r,i){return{replace:!0,restrict:"E",template:['<div class="mix-editor-track-placeholder" ng-class="{ hidden: getPlaceholderHidden(), \'mix-editor-track\': dropping, \'mix-editor-track-drop-top\': shouldShowDropTopOnPlaceholder() }" ng-click="onClickPlaceholder()">','<svg ng-if="!dropping" class="icon-note-plus" fill="currentColor" viewBox="0 0 24 24"><path d="M5 4V1h2v3h3v2H7v3H5V6H2V4h3Z" /><path fill-rule="evenodd" clip-rule="evenodd" d="M22 4.73 11 7.38v8.792A3 3 0 1 0 13 19V8.953l7-1.685v7.902a3 3 0 1 0 1.999 2.746H22V4.73ZM11 19a1 1 0 1 0-2 0 1 1 0 0 0 2 0Zm8-2a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z" /></svg>','<span ng-if="!dropping">Drop a loop or an audio/MIDI/video file</span>',"</div>"].join(""),link:function(a,s){var l=angular.element('<div class="mix-editor-region-ghost"></div>');function c(e){e+o.timelineEl.clientWidth-12>r.containerWidth&&(e-=e+o.timelineEl.clientWidth-r.containerWidth-12),s[0].style.transform=`translate3d(${e}px, 0, 0)`}function u(e,n,i){a.$emit(t.importFile,{file:e,time:(o.timelineEl.scrollLeft+n)/r.scalePx,multiple:i})}function d(e){let t;a.dropping=e,a.dropping?(document.body.style.setProperty("--mix-editor-track-placeholder-visible","1"),document.querySelector(".mix-editor-track-header-placeholder").classList.add("dropping"),document.querySelector(".mix-editor-playhead").style.pointerEvents="none",t=o.timelineLeft-Math.min(Al,o.timelineLeft)):(document.body.style.setProperty("--mix-editor-track-placeholder-visible","0"),document.querySelector(".mix-editor-track-header-placeholder").classList.remove("dropping"),document.querySelector(".mix-editor-playhead").style.pointerEvents="unset",t=o.timelineLeft),a.$applyAsync((()=>{c(t)}))}function p(e){const t=o.timelineLeft-Math.min(Al,o.timelineLeft);return function(e){var t=Math.floor(e/r.scalePx/r.snapDuration)*r.snapDuration*r.scalePx;return r.isSnapping?t:e}(t+e)-t}function m(){d(!1),l.remove(),l.removeClass("disallow"),l.css("width",null),window.removeEventListener("dragend",m)}a.dropping=!1,a.getPlaceholderHidden=i.isAddTrackDisabled,a.onClickPlaceholder=function(){if(!i.shouldNotifyTrackLimit())return Fh({accept:"audio/*",multiple:!0}).then((function(e){e.forEach((t=>u(t,0,e.length>1)))}));i.notifyTrackLimit()},gR.add("scroll:timelineLeft",c),s.bind("mousedown",(function(e){e.stopPropagation()})),s.on("drop",(function(e){if(m(),e.preventDefault(),e.stopPropagation(),i.shouldNotifyTrackLimit())return void i.notifyTrackLimit();const s=p(e.offsetX)+Math.min(Al,o.timelineLeft);if(e.dataTransfer.files.length)return void Array.from(e.dataTransfer.files,(t=>u(t,s,e.dataTransfer.files.length>1)));let l=r.scalePx;HS.value.bpm&&n.current.metronome.pristine&&!r.songDuration&&(l=4*r.scale*HS.value.bpm/120),a.$emit(t.importFile,Object.assign({time:(o.timelineEl.scrollLeft+s)/l},HS.value))})),s.on("dragover",(function(e){e.preventDefault(),e.stopPropagation(),pI.value.slug||HS.value.type===Ks?e.dataTransfer.dropEffect="none":(l.css("visibility","visible"),l.css("left",`${p(e.offsetX)}px`))})),s.on("dragenter",(e=>{if(e.preventDefault(),e.stopPropagation(),!pI.value.slug&&HS.value.type!==Ks&&(d(!0),window.removeEventListener("dragend",m),window.addEventListener("dragend",m),!e.target.classList.contains("mix-editor-region-ghost"))){s.append(l),l.removeClass("disallow not-audio not-midi not-drum-machine");let t=HS.value.duration;HS.value.bpm&&HS.value.bpm!==a.revision.metronome.bpm&&(t=t*HS.value.bpm/a.revision.metronome.bpm),l.css({left:`${p(e.offsetX)}px`,width:t*r.scalePx+"px"})}})),s.on("dragleave",(e=>{e.target.classList.contains("mix-editor-region-ghost")||m()})),"file"===e.source&&s.find("input")[0].click()}}}]),angular.module("bandlab.editor").directive("mixEditorTracks",["$analytics","$rootScope","AppNotifications","AudioStretch","EditorAllowActions","EditorAutomation","editorEvents","EditorHelper","EditorHistory","EditorPlayback","EditorPlayer","EditorRevision","EditorScroll","EditorState","EditorTimeline","EditorTrack","EditorView","EffectsPreset","Katnip","MidiEditor","MidiEditorState",function(e,t,n,o,r,i,a,s,l,c,u,d,p,m,f,h,g,v,b,y,w){const $=new Map;function k(e){return d.selectedRegions.has(e)}return{restrict:"A",link:function(e,n){const o=n[0].closest(".mix-editor-panel-track")?w:m,a=n[0].parentElement,c=angular.noop;var v,b,y,S,P={x:0,y:0},M=0;function T(t){const n=_.sortBy(Array.from(d.selectedRegions),"startPosition"),r=d.current.tracks.reduce((function(e,t){return e[t.id]=t,e}),{}),a=n.reduce((function(e,t){return e[t.id]=t.startPosition,e}),{}),s=Math.max(...n.map((e=>e.endPosition)));_.forEach(n,(function(e){e.automation=i.getAutomationInRange(r[e.trackId],e.startPosition,e.endPosition)}));const l=_.min(Object.values(a)),c=_.find(e.revision.tracks,{id:n[0].trackId}),u=e.revision.tracks.filter((function(e){return _.some(e.regions,k)}));return{altKey:t.altKey,firstPosition:l,firstTrack:c,lastPosition:s,originalSelectedRegions:_.cloneDeep(n),possibleOffsets:C(e.revision,u),scalePx:o.scalePx,selectedRegions:n,startPositions:a,tracksById:r}}function C(t,n){const o=function(e,t){return E(e,e.tracks[0],t[0])}(t,n),r=function(e,t){return E(e,e.tracks[e.tracks.length-1],t[t.length-1])}(t,n),i=function(e,t){return _.map(e.tracks,(e=>t.includes(e)))}(e.revision,n),a=function(e){return e.tracks.map((e=>!!e.canEdit))}(e.revision);return Array.from(Array(r-o+1),((e,t)=>o+t)).filter((e=>function(e,t,n){return n<0?t=t.slice(Math.abs(n),t.length):n>0&&(t=Array(n).fill(!1).concat(t)),t.every(((t,n)=>!t||t===e[n]))}(a,i,e)))}function E(e,t,n){return e.tracks.indexOf(t)-e.tracks.indexOf(n)}function I(t){if(t.preventDefault(),t.stopPropagation(),!r.isAllowed("editRegion"))return;v.dragged||(e.isMovingRegions=!0,l.pushUndo(e.revision),d.selectedRegions.clear(),_.forEach(v.selectedRegions,(function(e){const n=_.cloneDeep(e);GS.set(n,t.altKey?n:e),$.set(e,n),n.id=ad(),n.isMoving=!0,v.tracksById[e.trackId].regions.push(n),d.selectedRegions.add(n),e===y&&(y.isMoving=!1,y=n)})),v=T(t),HS.value=y),v.dragged=!0;const{x:n,y:o}=Kz(t),i=n+a.scrollLeft,s=document.elementsFromPoint(n,o).find((e=>e.closest(".mix-editor-track")||e.closest(".audio-editor-track")));if(s){const t=_.find(e.revision.tracks,{id:s.getAttribute("data-id")}),n=E(e.revision,t,b);n-M&&v.possibleOffsets.includes(n)&&(function(e,t,n){var o=new Set(t);_.forEach(e,(function(t,r){var i=Gf(t.regions,(function(e){return o.has(e)&&o.delete(e)})),a=e[r+n];i.length&&(a.regions=a.regions.concat(i),_.forEach(i,(function(e){e._trackId=a.id})))}))}(e.revision.tracks,v.selectedRegions,n-M),M=n),function(e,t){let n=0;_.forEach(t.selectedRegions,(function(o,r){n=f.moveRegion(o,r,{...t,delta:e,firstRegionSnapped:n},m)}))}(i-P.x,v),L()}const c=!!s&&!t.target.closest(".mix-editor-audio-input")&&[...GS.keys()].some((e=>!R(e)));document.body.classList.toggle("is-disallowed",c),e.$digest(),e.$applyAsync(),clearInterval(S),S=setInterval((function(){const t=function(e,t){const n=a.getBoundingClientRect();return n.top>t?{up:!0}:n.top+n.height-20<=t&&n.top+n.height>t?{down:!0}:n.left>e?{left:!0}:n.left+n.width-37<e?{right:!0}:void 0}(n,o);p.manualScroll(t),e.$digest(),e.$applyAsync()}),30)}function R(e){if(!v||!e._trackId)return!0;const t=v.tracksById[e.trackId],n=v.tracksById[e._trackId],o=[Qs,Ys,Js,Xs];return!(!r(t)||!r(n))||!(!t.patterns||!n.patterns||t.id!==n.id)||!!(i(t)&&n.samplerKit||i(t)&&i(n)||t.samplerKit&&n.samplerKit||t.samplerKit&&i(n));function r(e){return o.includes(e.type)}function i(e){return e.soundbank&&!e.patterns}}function A(n){if(HS.value={},x(),clearInterval(S),function(){const e=v.tracksById[y._trackId||y.trackId];if(GS.size>1||e.type!==Ks||e.type===Ks&&!e.patterns.find((e=>e.sampleId===y.sampleId)))return;if(!v.dragged)return void t.$broadcast("DrumMachine:loadPattern",{region:y});const n=GS.get(y);n.startPosition===y.startPosition&&t.$broadcast("DrumMachine:loadPattern",{region:n})}(),e.isMovingRegions=!1,document.body.classList.remove("is-disallowed"),e.$applyAsync(),function(){const e=[...GS.keys()];if(e.every((e=>!e._trackId))||e.every((e=>R(e))))return!1;const t=[...GS.entries()].reduce(((e,t)=>{let[n,o]=t;return R(n)||(e.has(o.trackId)&&e.get(o.trackId).push(o),e.set(o.trackId,[o])),e}),new Map);return e.some((e=>{const n=t.get(e._trackId);return!(!R(e)||!n)&&n.some((t=>f.areRegionsOverlapping(t,e)))}))}())return l.undo(d.current),d.selectedRegions=new Set(v.selectedRegions),GS.clear(),u.updateSourcesInTracks(),void document.body.classList.remove("is-disallowed");const o=[],r=[];if(Array.from(GS.keys()).forEach((function(e){if(!R(e))return d.selectedRegions.delete(e),void r.push(e);e.trackId=e._trackId||e.trackId,delete e._trackId,o.push(e)})),!v.dragged)return d.selectedRegions.add(y),void(y.isMoving=!1);if(m.isDraggingRegions=!1,n.target.closest(".sampler-pad")||n.target.closest(".mix-editor-sampler-editor")||n.target.closest(".loops-library-main"))return void d.current.tracks.forEach((function(e){e.regions=e.regions.filter((function(e){return!GS.has(e)||!e.isMoving}))}));d.current.tracks.forEach((function(e){e.regions=e.regions.filter((function(e){if(GS.has(e)){const t=GS.get(e);return e.id=t.id,e.isMoving=!1,o.includes(e)}const t=$.get(e);return r.includes(t)?(d.selectedRegions.add(e),!0):!t||v.altKey}))})),GS.clear(),i.checkConfirmation(v.altKey?"copy":"move",v.selectedRegions,v).then((function(t){if(!t)return;const{x:o}=Kz(n);P.x<o&&(v.selectedRegions.reverse(),v.originalSelectedRegions.reverse()),_.forEach(v.selectedRegions,(function(t,n){var o=v.originalSelectedRegions[n],r=_.find(e.revision.tracks,{id:o.trackId}),a=_.find(e.revision.tracks,{id:t.trackId});v.altKey||i.deleteAutomationInRange(r,o.startPosition,o.endPosition),i.deleteAutomationInRange(a,t.startPosition,t.endPosition),i.pasteAutomation(a,t,t.startPosition,r===a)}))}));const a=new Set([...v.selectedRegions,...v.originalSelectedRegions].map((e=>e.trackId)));var s,c;s=e.revision,c=a,s.tracks.forEach((function(e){c.has(e.id)&&f.moveRegions(e)})),u.updateSourcesInTracks(),document.body.classList.remove("is-disallowed")}function x(){document.removeEventListener("mousemove",I,{passive:!1}),document.removeEventListener("mouseup",A,{passive:!1}),document.removeEventListener("touchmove",I,{passive:!1}),document.removeEventListener("touchend",A,{passive:!1}),c()}function L(){const t=e.getTrackYPosition(y._trackId||y.trackId);document.body.style.setProperty("--mix-editor-track-moving-y",`${t}px`)}function O(){g.init(n[0].getBoundingClientRect())}n.on("mousedown touchstart",(function(t){if(x(),window.getSelection().removeAllRanges(),M=0,GS.clear(),$.clear(),y=e.revision.tracks.flatMap((e=>e.regions)).find((e=>e.id===t.target.getAttribute("data-id"))),y){if(t.stopPropagation(),t.shiftKey||k(y)||d.selectedRegions.clear(),3===t.which){const t=d.current.tracks.find((e=>e.id===y.trackId));return h.setSelected(t),d.selectedRegions.add(y),e.$digest(),void e.$applyAsync()}if(1===t.which||0===t.which){const n=Kz(t);P={x:n.x+a.scrollLeft,y:n.y},b=_.find(e.revision.tracks,{id:y.trackId}),e.revision.tracks=s.refreshTracksOrder(e.revision.tracks),d.selectedRegions.add(y),m.isDraggingRegions=!0,y.isMoving=!0,L(),e.$digest(),e.$applyAsync(),v=T(t),document.addEventListener("mousemove",I,{passive:!1}),document.addEventListener("mouseup",A,{passive:!1}),document.addEventListener("touchmove",I,{passive:!1}),document.addEventListener("touchend",A,{passive:!1})}}else d.selectedRegions.clear()})),n.on("dragover drop",(function(e){e.preventDefault(),e.stopPropagation()})),n[0].matches(".audio-editor-track")||(gR.add("scale:timeline",(function(e){e&&p.focusedRescale(e)})),window.addEventListener("resize",O),e.$on("$destroy",(function(){window.removeEventListener("resize",O)})),g.init(n[0].getBoundingClientRect()),e.isGhostRegion=function(e){return GS.has(e)},e.isClickedRegion=function(e){return e===y})},controller:["$element","$scope","EditorMidiSamples",function(t,p,g){if(p.countSelectedRegions=function(){return d.selectedRegions.size},p.canDenoiseAllSelectedRegions=function(){return M().every((e=>s.isAudioRegion(e)))},p.denoiseSelectedRegions=function(){M().forEach((t=>o.denoiseRegion(t).then((t=>(e.eventTrack("Denoise region",{category:"Mix Editor",label:"Region",value:t.buffer.duration}),c.saveAudioRecord(t.buffer,t.id)))).finally(p.$applyAsync)))},p.canMergeRegions=function(){var e=Array.from(d.selectedRegions),t=1===e.length&&!!e[0].loopLength,n=e.length>1,o=[...new Set(e.map((e=>e.trackId)))],r=1===o.length,i=d.current.tracks.find((e=>e.id===o[0]))?.type===Ks;return(t||n)&&(s.areAudioRegions(e)||s.areMidiRegions(e))&&r&&!i},p.copySelectedRegions=function(){if(!m.isAutomationVisible){var e=_.reduce(p.revision.tracks,(function(e,t){const n=t.regions.filter(k).map((function(e){return Object.assign({},e,{automation:i.getAutomationInRange(t,e.startPosition,e.endPosition),trackOrder:t.order})}));return e.concat(n)}),[]);e.length>0&&(zS.value=e)}},p.cutSelectedRegions=function(){l.pushUndo(p.revision),p.copySelectedRegions(),p.deleteSelectedRegions("cut")},p.deleteSelectedRegions=function(e){l.pushUndo(p.revision),d.selectedRegions.forEach((function(e){e.automation=i.getAutomationInRange(_.find(d.current.tracks,{id:e.trackId}),e.startPosition,e.endPosition)})),i.checkConfirmation(e,Array.from(d.selectedRegions)).then((function(e){e?p.revision.tracks.forEach((function(e){var t=Gf(e.regions,k);_.forEach(t,(function(t){i.deleteAutomationInRange(e,t.startPosition,t.endPosition)}))})):p.revision.tracks.forEach((function(e){Gf(e.regions,k)})),u.updateSourcesInTracks(),d.selectedRegions.clear(),p.$applyAsync()}))},p.mergeSelectedRegions=function(e){var[t,o]=_.partition(Array.from(d.selectedRegions),(function(e){return g.has(e.sampleId)})),r=t.length>1||t[0]&&t[0].loopLength,i=o.length>1||o[0]&&o[0].loopLength;(r||i)&&l.pushUndo(d.current),r?f.mergeMidiRegions([e],t,e,d.current.metronome.bpm):i&&f.mergeAudioRegions([e],o,e).catch((function(e){n.addNotification({title:e.message,content:mh,classList:"alert",autoclose:5e3})}))},p.moveTrack=h.moveTrack,p.deleteTrack=function(e){r.isAllowed("deleteTrack")&&(h.deleteTrack(e),d.current.tracks.length||(w.isVisible=w.hasFocus=!1),gR.start("anticipateScrollLayoutShift:tracksTop"))},p.armTrack=function(e){s.isBandLabInstrumentTrack(e)&&s.isBandLabInstrumentTrack(d.armedTracks[1])||e!==d.armedTracks[1]&&(e===d.armedTracks[2]?d.armedTracks[2]=null:(d.armedTracks[2]=e,e.channel=1===d.armedTracks[1].channel?2:1))},p.transposeRegions=function(e){y.transposeRegions(d.current,e,d.selectedRegions)},p.canTransposeRegions=function(){var e=Array.from(d.selectedRegions);return e.filter((function(e){return g.has(e.sampleId)&&function(e){const t=d.current.tracks.find((t=>t.id===e));return s.isTrackTransposable(t)}(e.trackId)})).length===e.length&&e.length>0},p.quantizeRegions=function(e){y.quantizeNotesInRegion(e,Array.from(d.selectedRegions))},p.canQuantizeRegions=function(){const e=Array.from(d.selectedRegions);return e.filter((function(e){return g.has(e.sampleId)&&(t=e.trackId,d.current.tracks.find((e=>e.id===t)).type!==Ks);var t})).length===e.length&&e.length>0},t[0].matches(".audio-editor-track"))return;p.$on(a.keyDown.delete,(function(){p.deleteSelectedRegions("erase")})),p.$on(a.keyDown.copy,(function(){m.isAutomationVisible||p.copySelectedRegions()})),p.$on(a.keyDown.cut,(function(){p.cutSelectedRegions()})),p.$on(a.keyDown.deleteTrack,(function(){p.$apply((()=>{p.deleteTrack(d.selectedTrack)}))})),p.$on(a.keyDown.duplicateTrack,(function(){d.selectedTrack.id&&(h.duplicateTrack(d.selectedTrack),gR.start("anticipateScrollLayoutShift:tracksTop"))}));const $=new WeakMap,S=new WeakMap;function P(e){return p.revision.tracks.find((t=>t.id===e))}function M(){return[...d.selectedRegions]}function T(e){const t=P(e.trackId).type;return m.isRegionAudioStretchEnabled&&(t===Js||t===Ys||t===Hs||t===Qs)}p.$on(a.mouseDown.multiRegionBackup,(()=>{l.pushUndo(p.revision),M().forEach((e=>{$.set(e,{playbackRate:e.playbackRate,startPosition:e.startPosition,sampleOffset:e.sampleOffset,loopLength:e.loopLength,endPosition:e.endPosition,firstTrack:P(e.trackId),scalePx:m.scalePx})}))})),p.$on(a.mouseDown.multiRegionResizeLeft,((e,t)=>{m.isResizingLeft=!0,p.$apply((()=>{M().forEach((e=>{T(e)?(S.set(e,!0),f.stretchRegionLeft(e,{...$.get(e),delta:t},m)):P(e.trackId).type!==Ks&&f.resizeRegionLeft(e,{...$.get(e),delta:t},m)}))}))})),p.$on(a.mouseDown.multiRegionResizeRight,((e,t)=>{m.isRegionAudioStretchEnabled||(m.isResizingRight=!0),p.$apply((()=>{M().forEach((e=>{T(e)?(S.set(e,!0),f.stretchRegionRight(e,{...$.get(e),delta:t},m)):P(e.trackId).type!==Ks?f.resizeRegionRight(e,{...$.get(e),delta:t},m):f.expandRegionLoop(e,{...$.get(e),delta:t},m)}))}))})),p.$on(a.mouseDown.multiRegionExpandLoop,((e,t)=>{m.isResizingLoop=!0,p.$apply((()=>{M().forEach((e=>{f.expandRegionLoop(e,{...$.get(e),delta:t},m)}))}))})),p.$on(a.mouseUp.multiRegionUpdate,(()=>{m.isResizingLeft=!1,m.isResizingRight=!1,m.isResizingLoop=!1,M().forEach((e=>{S.get(e)&&o.stretchRegion(e).finally((()=>{S.set(e,!1),p.$applyAsync()}))})),[...new Set([...d.selectedRegions].flatMap((e=>e.trackId)))].forEach((e=>f.moveRegions(P(e)))),u.updateSourcesInTracks(),p.$applyAsync()})),p.$on(hT,(function(e,t){l.pushUndo(d.current),d.selectedTrack.preset=t.preset||"custom",d.selectedTrack.effects=t.effects,u.current.setTrackEffects(d.selectedTrack,d.selectedTrack.effects),m.hasRevisionChanges=!0,d.selectedTrack.effects.length||t.presetId||(d.selectedTrack.preset="none"),"none"===d.selectedTrack.preset?d.selectedTrack.effectsData={}:(t.preset||t.presetId)&&(d.selectedTrack.effectsData={presetId:t.presetId,originalPresetId:t.preset||t.presetId,link:t.presetLink},v.getBySlug(t.preset)||(d.selectedTrack.effectsData.displayName=t.displayName));const n=d.trackAutomationParameters.get(d.selectedTrack)||{},o=i.getAutomatableParameters(d.selectedTrack.effects),r=n.effect?o.find((e=>e.effect.id===n.effect.id&&e.param===n.param))??"volume":"volume";d.trackAutomationParameters.set(d.selectedTrack,r)})),p.$on(fT,(function(e,t){l.pushUndo(d.current),d.selectedTrack.preset="custom",p.$applyAsync(),E(d.selectedTrack)&&(d.selectedTrack.effectsData={}),u.current.setTrackEffectsBypass(d.selectedTrack,t.bypass)})),p.$on(mT,(function(e,t){l.pushUndo(d.current),d.selectedTrack.preset="custom",p.$applyAsync(),E(d.selectedTrack)&&(d.selectedTrack.effectsData={}),u.current.setTrackEffectParameter(d.selectedTrack,t.effectOrder,t.paramSlug,t.value),"bypass"!==t.paramSlug&&b.metadata[d.selectedTrack.effects[t.effectOrder].slug].params[t.paramSlug].automatable&&m.isRecording&&m.isRecordingAutomation&&xs(d.selectedTrack.effects[t.effectOrder].automation[t.paramSlug],m.crTime,t.value),"bypass"!==t.paramSlug&&d.selectedTrack.effects.every((e=>e.bypass))&&h.setEffectChainBypass(!1),function(e){if("bypass"===e.paramSlug)return;const{effectOrder:t,paramSlug:n}=e,o=d.selectedTrack,r=o.effects[t],a=i.getAutomatableParameters(o.effects).find((e=>{let{effect:t,param:o}=e;return t.id===r.id&&o===n}));d.trackAutomationParameters.set(o,a)}(t)}));const C=ay((function(){l.pushUndo(d.current)}),1e3,{leading:!0,trailing:!1});function E(e){return v.getRevisionPresets().some((t=>t.id===e.effectsData?.originalPresetId))}p.$on("MidiMapping:TRACK_EFFECT_PARAMETER",(function(e,t){let{trackId:n,effectIndex:o,effectParameter:r,value:i,toggle:a,min:s,max:l,crTime:c}=t;p.$applyAsync();try{const e=d.current.tracks.find((e=>e.id===n));if(!e)return;C(),e.preset="custom",E(e)&&(e.effectsData={});const t=b.metadata[e.effects[o].slug].params[r],p=a?e.effects[o].params[r]>ks(Ps(s,t),t)?ks(Ps(s,t),t):ks(Ps(l,t),t):ks(Ps(i,t),t);e.effects[o].params[r]=_s(p,t),u.current.setTrackEffectParameter(e,o,r,e.effects[o].params[r]),m.isRecording&&m.isRecordingAutomation&&xs(e.effects[o].automation[r],c,e.effects[o].params[r]),gR.start("syncVolume")}catch(e){}})),p.$on("MidiMapping:TRACK_EFFECT_BYPASS",(function(e,t){let{trackId:n,effectIndex:o,value:r,toggle:i}=t;p.$applyAsync();try{const e=d.current.tracks.find((e=>e.id===n));if(!e)return;i&&(r=!e.effects[o].bypass),l.pushUndo(d.current),e.preset="custom",E(e)&&(e.effectsData={}),u.current.setTrackEffectParameter(e,o,"bypass",r),e.effects[o].bypass=r}catch(e){}})),p.$on(gT,(function(){d.selectedTrack.id&&h.setInputSourceToTrack(d.selectedTrack)}))}]}}]),angular.module("bandlab.editor").directive("mixEditorVolumeSlider",["$analytics","EditorAutomation","EditorHistory","EditorRevision","EditorState",function(e,t,n,o,r){return{replace:!0,restrict:"E",scope:{history:"=",setVolume:"=",model:"="},templateUrl:"https://www.bandlab.com/web-app/editor/partials/_mix-editor-volume-slider-dc4607b8.html",compile:function(){let i=0,a=0,s=!1;return{pre:function(l,c){var u,d,p=c[0].querySelector(".mix-editor-volume-slider-cursor"),m=c[0].querySelector(".mix-editor-volume-slider-cursor-shadow");function f(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gs(1/pl.range,1);const t=r.isRecording&&r.isRecordingAutomation;if(!_.get(l,"model.automation.volume",[]).length||t){var n=vs(e*pl.range,pl.range);n!==l.model.volume&&u(),(n<0||n>2)&&(Sentry.onLoad((function(){Sentry.captureException("Out of range volume",{extra:{uiValue:e,value:n}})})),n=Math.min(2,Math.max(n,0))),l.model.volume=n,l.setVolume(n),r.hasRevisionChanges=!0,t&&xs(l.model.automation.volume,r.crTime,n),l.$applyAsync((function(){h()}))}}function h(){!function(e){if(e!==d){var t=100*gs(e/pl.range,1);p.style.left=`${t}%`,m.style.width=`calc(${t}% + 12px)`,d=e}}(t.getMomentValue(pl,l.model?.automation?.volume,l.model.volume))}l.metadata=pl,l.setVolumeFromSlider=f,l.startSettingVolumeFromSlider=function(t,r,a){u=l.history?rd((function(){n.pushUndo(o.current),e.eventTrack("Adjust Volume",{category:"Mix Editor",label:l.model.color?"Track":"Revision"})})):angular.noop,a.shiftKey?(i=gs(l.model.volume/pl.range,1),s=!0):(i=t,f(t),s=!1)},l.setVolumeByDraggingSlider=function(e,t,n,o){a!==o&&(f(s?i+.015*(a>o?1:-1):e),i=gs(l.model.volume/pl.range,1),a=o)},l.setVolumeByDraggingSliderWithShift=function(e){a!==e&&(f(i-.001*(a>e?1:-1)),i=gs(l.model.volume/pl.range,1),a=e,s=!0)},gR.add("playing",h),gR.add("syncVolume",h),l.$on("$destroy",(function(){gR.remove("playing",h),gR.remove("syncVolume",h)})),h(l.model.volume)}}}}}]),angular.module("bandlab.audio").directive("mixEditorWaveformCanvas",["$injector",function(e){return{replace:!0,restrict:"E",template:'<div class="mix-editor-waveform-canvas-container"></div>',link:async function(t,n){import("./chunk-4bdc10e8.js").then((function(o){let{mountMixEditorWaveformCanvas:r}=o;const i=r(n[0],{$injector:e,scope:t},{});t.$on("$destroy",(function(){i.unmount()}))}))}}}]),angular.module("bandlab.editor").directive("moveHandler",["EditorScroll","EditorScrollState",function(e,t){return{restrict:"A",link:function(n,o,r){var i,a,s,l,c,u,d=n.$eval(r.onMoveEnd),p=n.$eval(r.onMoveStart),m=n.$eval(r.onMove),f=30,h=311,g=30,v=t.notesTimelineEl.contains&&t.notesTimelineEl.contains(o[0]),b=v?e.manualNotesScroll:e.manualScroll,y=v?t.notesTimelineEl:t.timelineEl;function w(e){var o,r=e.pageX>u-f,d=e.pageX<h;o=Kz(e).x,i=a-o,clearInterval(c),(d||r)&&(c=setInterval((function(){d?(a=Math.min(a+t.SCROLL_STEP,l),b({left:!0})):(a=Math.max(a-t.SCROLL_STEP,s),b({right:!0})),m(a-o),n.$digest()}),g)),angular.isFunction(m)&&(m(i),n.$digest())}function $(){o.off("pointermove",w),angular.element(window).off("pointerup",$),clearInterval(c),angular.isFunction(d)&&n.$apply((function(){d(i)}))}o.on("pointerdown",(function(e){3!==e.which&&(e.stopPropagation(),e.preventDefault(),a=Kz(e).x,i=0,u=document.documentElement.clientWidth,s=a-(y.scrollWidth-y.scrollLeft-y.clientWidth),l=a+y.scrollLeft,o[0].setPointerCapture(e.pointerId),o.on("pointermove",w),angular.element(window).on("pointerup",$),angular.isFunction(p)&&(p(a),n.$digest()))}))}}}]);const cH={class:"ds-modal ds-modal-size-small"},uH={class:"ds-modal-header"},dH={class:"ds-modal-title"},pH={class:"ds-modal-content"},mH={class:"ds-modal-content-p"},fH={class:"ds-modal-footer ds-modal-footer-two-buttons"},hH=ld({components:{Button:Dd,ModalCloseButton:ib},props:{leaveFn:{type:Function,required:!0},cancelFn:{type:Function,required:!0}},emits:["closeModal"]},[["render",function(e,t,n,o,r,i){const a=vo("Button"),s=vo("ModalCloseButton");return si(),pi("section",cH,[bi("header",uH,[bi("h2",dH,me("Saving is in progress"),1)]),bi("section",pH,[bi("p",mH,me("If you leave without saving, all your changes will be lost."),1)]),bi("footer",fH,[yi(a,{type:"button",size:"medium",color:"secondary",padding:"default",onClick:t[0]||(t[0]=t=>{n.leaveFn(),e.$emit("closeModal")})},{default:Tn((()=>[ki(me("Leave"),1)])),_:1}),yi(a,{type:"button",size:"medium",color:"primary",padding:"default",onClick:t[1]||(t[1]=t=>{n.cancelFn(),e.$emit("closeModal")})},{default:Tn((()=>[ki(me("Stay"),1)])),_:1})]),yi(s,{onClick:t[2]||(t[2]=t=>{n.cancelFn(),e.$emit("closeModal")})})])}]]);function gH(e,t,n,o,r,i,a,s,l,c,u,d,p,m,f){function h(e){(p.hasRevisionChanges||p.isPreSaving||p.isSaving||p.isRecording||d.uploadingSamples.length||p.isAiComposingRegion)&&(e.returnValue=!0),p.isRecording&&u.toggleRecord(),p.isVoiceCleaningRegion&&c.cancelVoiceClean()}function g(){l.removeSnapshot(n.revision.id)}function v(){d.releaseLock(),l.removeSnapshot(n.revision.id),window.removeEventListener("beforeunload",h),window.removeEventListener("unload",g)}n.revision=f,n.editorState=p,window.addEventListener("beforeunload",h),window.addEventListener("unload",g),this.uiCanExit=function(n){return a.shouldAskToSave()?function(n){return new Promise((r=>{const a={onDiscard:()=>{e.eventTrack("Leave",{category:"Mix Editor",label:"leave"}),v(),r(n)},saveFn:()=>{e.eventTrack("Leave",{category:"Mix Editor",label:"save"}),s.status="remote",i.startSave({redirect:!1,triggeredFrom:"on_exit"}).then((e=>{setTimeout((()=>{const t=o.target("track",{id:e.postId});r(t)}),1e3),v()}))},cancelFn:()=>{e.eventTrack("Leave",{category:"Mix Editor",label:"cancel"}),r(!1)}};YA.value&&FB({$injector:t},{abort:!0}),p.isSaving||p.isPreSaving?_g(hH,{leaveFn:a.onDiscard,cancelFn:a.onCancel},{escapeClose:!1,overlayClose:!1}):c.show2StepSaveModal(a)}))}(n):(v(),n)}}function vH(e,t){let{type:n,object:o}=t;const r=e.get("$state"),i=e.get("Share"),a=Vt(!1),s=Vt(function(){const{width:e,height:t}="Revision"===n?{width:560,height:202}:{width:560};return`<iframe width="${e}" height="${t}" src="${{Revision:i.getEmbedRevisionUrl({id:o.id})}[n]||""}" allowfullscreen></iframe>`}());return{copyEmbedCode:function(){a.value=!0,RD(s.value),Av(o,"embed",_p(r)),setTimeout((()=>{a.value=!1}),3e3)},isEmbedCodeCopied:a,embedCode:s}}async function bH(e,t){const n=t.get("Me");if("true"!==await Mp(n,"publish-to-share-popup"))return;const o=_p(t.get("$state"));_g(zn((()=>import("./chunk-bcd2d77c.js"))),{revision:e}),ob(o)}gH.$inject=["$analytics","$injector","$scope","$state","$transition$","Editor","EditorAllowActions","EditorCollaboratorsState","EditorDB","EditorHelper","EditorPlayback","EditorRevision","EditorState","Me","revision"],angular.module("bandlab.editor.routes",["ui.router"]).config(["$stateProvider",function(e){const t=["{id:new|[a-zA-Z0-9-_]+}","autoconnect","assignmentId","solutionId","classname","access","projectId","bandId","splitter","songstarter","tutorial","midiId","revisionId","fileName","lyric","bpm","key","forkRevisionId","isTemplate","templateId","samplerKit","source","soundbank","responseTime","targetNotes","slug","remoteSample","addTrack","samplePack","sampleId","userSoundsSampleId","preset","effect","category","open_effects_library"].join("&");e.state("mixEditorLegacy",{url:`/mix-editor?${t}`,redirectTo:"mixEditor"}).state("mixEditor",{url:`/studio?${t}`,isCompatible:oh,params:{rewriteTracking:{dynamic:!0,value:["$stateParams",function(e){return()=>"/mix-editor"+(e.id?"/revision":"")}]},open_attribution:{dynamic:!0,value:null,squash:!0},open_attribution_category:{dynamic:!0,value:null,squash:!0}},template:"<mix-editor revision=\"revision\"  ng-class=\"{ 'is-resizing': editorState.isRegionAudioStretching, 'e-resize': editorState.isResizingLoop || editorState.isResizingLeft, 'col-resize': editorState.isResizingRight }\"></mix-editor>",reloadOnSearch:!1,resolve:Object.assign({getExposedVersionOfAutoPitch:["$injector","Me",function(e,t){const n=e.get("Katnip");return Promise.all([Promise.resolve().then((()=>Ap)),n]).then((function(e){let[{getAmplitudeFeatureVariant:n}]=e;return n(t,"autopitch_version_exposed")})).then((function(e){return t_.value=e.payload.version>t_.value?t_.value:e.payload.version,e})).catch((()=>{}))}],hasRealTimeCollaboratByDefault:["Me","EditorState",function(e,t){return Promise.resolve().then((()=>Ap)).then((function(t){let{getAmplitudeFeatureFlag:n}=t;return n(e,"realtime-collaboration-by-default")})).then((function(e){return t.hasRealTimeCollaboratByDefault="on"===e,e})).catch((()=>{}))}],hasNewTrackHeadUpdate:["Me","EditorState",function(e,t){return Promise.resolve().then((()=>Ap)).then((function(t){let{getAmplitudeFeatureFlag:n}=t;return n(e,"studio_web_track_head_updates")})).then((function(e){return t.hasNewTrackHeadUpdate="true"===e,e})).catch((()=>{}))}],isPracticeProject:["$stateParams",function(e){return!1}],isUnderAiComposeExperiment:["Me","EditorState",function(e,t){return Promise.resolve().then((()=>Ap)).then((function(t){let{getAmplitudeFeatureFlag:n}=t;return n(e,"smart_tools_bp_enabled")})).then((function(e){return t.isUnderAiComposeExperiment="true"===e,e})).catch((()=>{}))}],isUnderAiVocalPaywallExperiment:["Me","EditorState",function(e,t){return Promise.resolve().then((()=>Ap)).then((function(t){let{getAmplitudeFeatureFlag:n}=t;return n(e,"ai_vocal_paywall_2_enabled")})).then((function(e){return t.isUnderAiVocalPaywallExperiment="true"===e,e})).catch((()=>{}))}],isWebGLEnabled:["Me","EditorState",function(e,t){return Promise.all([Promise.resolve().then((()=>Ap)),import("./chunk-ba45d086.js")]).then((t=>{let[{getAmplitudeFeatureFlag:n},{checkWebGLSupport:o}]=t;return Promise.all([n(e,"webgl_waveforms_enabled"),o()])})).then((e=>{let[t,n]=e;return["true"===t,n]})).then((e=>{let[n,o]=e;t.isWebGLEnabled=n&&o})).catch(console.error)}],isUnderVoiceTransferExperiment:["Me","EditorState",function(e,t){return Promise.resolve().then((()=>Ap)).then((function(t){let{getAmplitudeFeatureFlag:n}=t;return n(e,"voice_transfer_enabled")})).then((function(e){return t.isUnderVoiceTransferExperiment="true"===e,e})).catch((()=>{}))}],isUnderAutoPitchExperiment:["Me","EditorState",function(e,t){return Promise.resolve().then((()=>Ap)).then((function(t){let{getAmplitudeFeatureFlag:n}=t;return n(e,"autopitch_mem_vocal_settings_enabled")})).then((function(e){return t.isUnderAutoPitchExperiment="true"===e&&!1,e})).catch((()=>{}))}],hasMembership:["Me","EditorState","User",function(e,t,n){return n.getMembershipStatus({userId:e.id}).$promise.then((e=>{t.hasMembership="Free"!==e.plan})).catch((()=>{t.hasMembership=!1}))}],refreshFtue:["authService",function(e){return e.refreshFtue()}]},{},{templates:["$templateCache","$templateRequest","$q",function(e,t,n){return n.all([t("https://www.bandlab.com/web-app/audio/partials/_audio-input-preset-settings-fc0dd951.html"),t("https://www.bandlab.com/web-app/audio/partials/_audio-input-99df960e.html"),t("https://www.bandlab.com/web-app/audio/partials/_drum-machine-1b7f8da4.html"),t("https://www.bandlab.com/web-app/audio/partials/_select-audio-device-c08efafd.html"),t("https://www.bandlab.com/web-app/audio/partials/_virtual-drum-pads-837e4753.html"),t("https://www.bandlab.com/web-app/audio/partials/_virtual-piano-3c9f7d21.html"),t("https://www.bandlab.com/web-app/editor/partials/_mix-editor-automation-ae3b3d9c.html"),t("https://www.bandlab.com/web-app/editor/partials/_mix-editor-body-a95afbaf.html"),t("https://www.bandlab.com/web-app/editor/partials/_mix-editor-cycle-selection-38e74b9b.html"),t("https://www.bandlab.com/web-app/editor/partials/_mix-editor-grid-28675dbf.html"),t("https://www.bandlab.com/web-app/editor/partials/_mix-editor-header-fc855fed.html"),t("https://www.bandlab.com/web-app/editor/partials/_mix-editor-loader-e0afafc5.html"),t("https://www.bandlab.com/web-app/editor/partials/_mix-editor-menu-2179b8b8.html"),t("https://www.bandlab.com/web-app/editor/partials/_mix-editor-metronome-settings-f6354b04.html"),t("https://www.bandlab.com/web-app/editor/partials/_mix-editor-modal-2faa35f3.html"),t("https://www.bandlab.com/web-app/editor/partials/_mix-editor-playhead-d5987599.html"),t("https://www.bandlab.com/web-app/editor/partials/_mix-editor-recording-region-5361f2ba.html"),t("https://www.bandlab.com/web-app/editor/partials/_mix-editor-region-93ea51fc.html"),t("https://www.bandlab.com/web-app/editor/partials/_mix-editor-ruler-11137211.html"),t("https://www.bandlab.com/web-app/editor/partials/_mix-editor-scrollbar-horizontal-8d7bf882.html"),t("https://www.bandlab.com/web-app/editor/partials/_mix-editor-scrollbar-vertical-daf9cb4e.html"),t("https://www.bandlab.com/web-app/editor/partials/_mix-editor-sidetabs-015c63d6.html"),t("https://www.bandlab.com/web-app/editor/partials/_mix-editor-toolbar-559b9207.html"),t("https://www.bandlab.com/web-app/editor/partials/_mix-editor-track-header-89965deb.html"),t("https://www.bandlab.com/web-app/editor/partials/_mix-editor-track-cac32392.html"),t("https://www.bandlab.com/web-app/editor/partials/_mix-editor-volume-slider-dc4607b8.html"),t("https://www.bandlab.com/web-app/midi/partials/_midi-editor-grid-d7f78aae.html"),t("https://www.bandlab.com/web-app/midi/partials/_midi-editor-header-a6dc3467.html"),t("https://www.bandlab.com/web-app/midi/partials/_midi-editor-region-note-e3ed4ce0.html"),t("https://www.bandlab.com/web-app/midi/partials/_midi-editor-region-17fb19fa.html"),t("https://www.bandlab.com/web-app/midi/partials/_midi-editor-ruler-3a99db64.html"),t("https://www.bandlab.com/web-app/midi/partials/_midi-editor-track-grid-2d3ec864.html"),t("https://www.bandlab.com/web-app/midi/partials/_midi-editor-d0cddeb1.html"),t("https://www.bandlab.com/web-app/song/partials/_revision-new-9e40f8e6.html")]).then((function(t){t.forEach(e.put)})).catch((function(){}))}],theProject:["$stateParams","Song",function(e,t){return e.projectId?t.get({id:e.projectId}).$promise:{}}],revision:["$analytics","$injector","$q","$stateParams","$transition$","AppNotifications","DrumMachine","EditorDB","EditorHelper","EditorLoader","EditorMidiSamples","EditorMidiScore","EditorModel","EditorTimeline","EffectsPreset","EditorPlayer","EditorReset","EditorState","Me","Revision","Sample","Song","Soundbank","isPracticeProject","theProject","User",function(e,t,n,o,r,i,a,s,l,c,u,d,p,m,f,h,g,v,b,y,w,$,k,S,P,M){const T=t.get("Katnip");g.resetBeforeInitialization();const C=c.pushTask("loadSample");return PC=function e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return v$({features:"multipadSampler",after:arguments.length>1?arguments[1]:void 0}).then((function(n){const o=n;return t=t.concat(o.packs),o.totalCount&&t.length<o.totalCount?e(t,o.after??void 0):{packs:t}}))}().then((function(e){return MC=e.packs,MC.forEach((function(e){e.features.multipadSampler.id=ad(),e.features.multipadSampler.displayName=e.name})),MC})).catch((()=>[])),n.all([Promise.all([k.getList(),T]).then((async function(n){let[r]=n;const c=await async function(){return o.id}(),u=await async function(){return o.bandId}();if(o.midiId&&o.revisionId){const t=lh(),n=`https://songstarter.bandlab.io/midi/${o.midiId}`;return(o.revisionId?y.get({id:o.revisionId,edit:!0}).$promise:Promise.resolve(null)).then((e=>Promise.all([e?.tracks,xx(t,n,e)]))).then((e=>{let[t,n]=e;return Promise.all([t,Nx(n.mix,ad()),qx(n.mix,!1,[]),jx(n.mix.tracks).then((function(e){return Promise.all(e.map((function(e){let{id:t,blob:n}=e;return d.importMidToScore(n,t).then((function(e){let[n]=e;return s.updateFile({blob:n,sampleId:t})}))})))}))])})).then((function(e){let[t,n,r]=e;return n.tracks.forEach((function(e,n){e.auxSends[0].automation=[],t&&(e.colorName=t[n].colorName)})),n.parentId=void 0,n.id=void 0,v.hasRevisionChanges=!0,p.createRevision({...n,samples:Array.from(r).map((e=>({id:e}))),song:new $({bandId:u,canEdit:!0,isForkable:!1,name:o.fileName??""}),lyrics:{content:o.lyric}})})).catch((function(t){return e.eventTrack(`SongStarter error ${t?.message}`,{category:"Debug",label:`${o.midiId}, ${o.revisionId}`}),Promise.reject(t)}))}if(o.projectId)return y.get({id:P.revision.id,edit:!0}).$promise;if(c&&"new"!==c)return y.get({id:c,edit:!0}).$promise;if(o.splitter){const{splitterRevision:e,splitterPlaybackStemsCache:t,splitterAnalysedBpm:n,splitterAnalysedKey:r,SPLITTER_DEFAULT_BPM:i}=await import("./chunk-c6b86c7e.js").then((e=>e.ad)),{splitterInstrumentDetails:a}=await import("./chunk-9f862d2e.js");if(e.value){const l=_.cloneDeep(e.value);l.metronome.bpm=n.value||i,r.value&&(l.key=r.value),l.tracks.forEach((e=>{e.name=a[e.name].name,e.isMuted=!1,e.isSolo=!1,e.volume=1,e.regions.forEach((e=>{e.playbackRate=1,e.pitchShift=0}))})),await Promise.all(t.value.map((e=>s.updateFile({blob:e.wav,sampleId:e.sampleId}))));const c=t.value.map((e=>({id:e.sampleId,name:e.wav.name,buffer:e.audioBuffer})));return v.hasRevisionChanges=!0,p.createRevision({...l,samples:c,song:new $({bandId:u,canEdit:!0,isForkable:!1,name:o.fileName})})}}const m=p.createRevision({song:new $({bandId:u,canEdit:!0,isForkable:!1,name:S?"New Personal Project":"New Project",...P})});if(o.soundbank&&_.find(r,{slug:o.soundbank})&&o.source!==Ks)m.tracks[0]=p.createTrack({soundbank:o.soundbank});else if("autopitch"===o.source){const e=o.slug||T.effectsJson.autoPitchGroups.find((e=>e.slug===o.category))?.presets[0].slug||"classic";m.tracks[0]=p.createTrack({type:"voice",autoPitch:{bypass:!1,responseTime:PL(t,o.responseTime),targetNotes:ML(o.targetNotes),slug:e,scale:"scale_undefined",tonic:"tonic_undefined"}}),l.displayAutoPitch()}else o.addTrack||o.samplePack||o.source&&"file"!==o.source&&o.source!==Ks?(m.tracks[0]=p.createTrack({type:o.source||"voice"}),m.tracks[0].type===Ks?(m.tracks[0].patterns=a.createDefaultPatterns(m.tracks[0].id),m.tracks[0].soundbank="808-kit"):m.tracks[0].type===Zs&&(m.tracks[0].samplerKit={...qs,id:ad()},l.displayInstrument())):o.samplerKit&&(m.tracks[0]=p.createTrack({type:"sampler",samplerKit:{...qs,id:ad()}}),l.displayInstrument());if(o.open_effects_library&&(m.tracks[0]||(m.tracks[0]=p.createTrack({type:"voice"})),ql.openEffectFlyout=!0),o.preset){const e=f.getUserPresetsSync().find((e=>e.id===o.preset))||f.getBySlug(o.preset);if(!e)return i.addNotification({title:"Content not found or has been deleted",classList:"alert",autoclose:8e3}),m;const t=_.cloneDeep(e);m.tracks[0]||(m.tracks[0]=p.createTrack({type:"voice"})),"none"===o.preset&&(ql.openPresetFlyout=!0),m.tracks[0].preset=t.slug||"custom",m.tracks[0].effectsData={displayName:t.name||t.displayName,originalPresetId:t.slug||t.id,presetId:t.id},m.tracks[0].effects=t.effects}else if(o.effect){const e=T.metadata[o.effect];if(!e)return i.addNotification({title:"Content not found or has been deleted",classList:"alert",autoclose:8e3}),m;m.tracks[0]||(m.tracks[0]=p.createTrack({type:"voice"})),m.tracks[0].effects=gI(e),m.tracks[0].preset="custom"}return m})),f.getPresets(),f.getTrendingPresets(),f.getArtistPresets(),f.getUserPresets(),f.getFavoritePresetIds(),IC(t),Promise.all([w.getOptions().then((function(e){return JS.SONG_DURATION_MAX=e.maxSongDuration,{maxTracks:e.maxTracks}})),Promise.resolve().then((()=>Ap)).then((e=>{let{getAmplitudeFeatureVariant:t}=e;return t(b,"studio_max_tracks")})).then((e=>{const t=parseInt(e.value);return{maxTracks:isNaN(t)?null:t}})),M.getMembershipStatus({userId:b.id}).$promise.catch((()=>({plan:"Free"})))]).then((e=>{let[t,n,{plan:o}]=e;"Free"!==o?JS.TRACKS_LIMIT=el:n.maxTracks?JS.TRACKS_LIMIT=n.maxTracks:t.maxTracks&&(JS.TRACKS_LIMIT=t.maxTracks)}))]).then((function(e){let[t]=e;t=m.cleanRevision(t),f.addPresetsFromRevision(t);const o=f.getRevisionPresets();return f.addUnsavedUserPresetsFromRevisionPresets(o),t.canEdit?t:n.reject({status:403})})).finally((function(){c.finishTask(C)}))}]}),onEnter:["$rootScope","$state","$stateParams","$transition$","Page","Player","ProjectUploader","Revision","revision","Song",function(e,t,n,o,r,i,a,s,l,c){if(r.setMetadata({title:l.song.name}),i.getCurrentSong().id="",i.pause(),i.pauseOtherTabs(),vj(),a.isVisible=!1,n.forkRevisionId)return Promise.all([s.get({id:n.forkRevisionId}).$promise,c.fork({revisionId:n.forkRevisionId}).$promise]).then((function(e){let[n,o]=e;return Promise.resolve().then((()=>rb)).then((function(e){let{logRevisionFork:r}=e;r(o.revision.id,n.postId,n.creator.id,null,t)})),t.target("mixEditor",{id:o.revision.id,forkRevisionId:null},{inherit:!1,reload:!0})})).catch((function(){return t.target("mixEditor",{forkRevisionId:null},{inherit:!1,reload:!0})}))}],onExit:["$rootScope","Page",function(e,t){t.clearMetadata()}],controller:gH})}]),angular.module("bandlab.editor").factory("AudioStretch",["$injector","$q","$rootScope","AppNotifications","EditorHelper","EditorHistory","EditorPlayer","EditorRevision","MidiEditor","Modal","Sample",function(e,t,n,o,r,i,a,s,l,c,u){return{clampPlaybackRate:d,convertAudioBuffer:p,convertLoop:function(e,t,n){var o=n||!e.features?.loop?.tempo?1:d(s.current.metronome.bpm/e.features?.loop?.tempo),r=0;return e.features?.loop?.key&&t.key&&(r=l.transposeKeys(e.features?.loop?.key,t.key)),u.getBuffer(e.audioUrl).then(ch).then((function(e){return p(e,o,r)}))},convertRegion:m,convertRevision:function(e,t){var n=l.transposeKeys(e.key,t);return Promise.all(e.tracks.flatMap((function(e){return e.regions=e.regions.filter((function(e){return e.endPosition-e.startPosition>=Vl})),e.regions})).filter(r.isAudioRegion).map((function(e){let t=(e.pitchShift+n+12)%12;return t>6&&(t-=12),m(e,e.playbackRate,t)})))},denoiseRegion:function(n){const o=n.sampleId,l=s.current.samples.find((e=>e.id===o));if(!l||!r.isAudioBuffer(l.buffer))return t.reject(new Error("Sample not found"));i.pushUndo(s.current);const c={id:ad(),buffer:{duration:0}};return n.isProcessing=!0,n.sampleId=c.id,Zx(o,e).then((function(e){let{arrayBuffer:t}=e;return ch(t)})).then((function(e){return s.current.samples.push(c),c.buffer=e,c})).catch((function(e){return n.sampleId=o,Promise.reject(e)})).finally((function(){a.updateSourcesInTracks(),n.isProcessing=!1}))},preview:async function(e){const{default:t}=await import("./chunk-ea826f1b.js");var r=new t,a=e.playbackRate,l=e.pitchShift,u=e.playbackRate,p=e.pitchShift,h=(e.endPosition-e.startPosition)/Vl,g={playbackRate:Math.abs(e.playbackRate),pitchShift:e.pitchShift},v={player:r,region:e,regionCopy:g,reset:function(){v.setPlaybackRate(1),v.setPitchShift(0)},adjustPlaybackRate:function(e,t){g.playbackRate=u+.01*t,g.playbackRate=d(g.playbackRate,h),r.setPlaybackRate(g.playbackRate)},adjustPitchShift:function(e,t){g.pitchShift=p+.01*t,g.pitchShift=Math.min(Math.max(g.pitchShift,-12),12),r.setPitchShift(g.pitchShift)},startAdjusting:function(){u=g.playbackRate,p=g.pitchShift},setPlaybackRate:function(e,t){t&&(e=parseFloat(e.toFixed(2)),e=t>0?5*Math.ceil(100*g.playbackRate/5+.51*t)/100:5*Math.floor(100*g.playbackRate/5+.51*t)/100),g.playbackRate=d(e,h),r.setPlaybackRate(g.playbackRate)},setPitchShift:function(e,t){t&&(e=parseFloat(e.toFixed(2)),e=t>0?Math.floor(g.pitchShift)+t:Math.ceil(g.pitchShift)+t),g.pitchShift=Math.min(Math.max(e,-12),12),r.setPitchShift(g.pitchShift)}};new c({class:"light",templateUrl:"https://www.bandlab.com/web-app/editor/partials/_audiostretch-preview-c8dfea4b.html",contentScope:v,onCreate:function(){setTimeout((function(){var t=e.sampleId,n=_.find(s.current.samples,{id:t});const o=getComputedStyle(document.querySelector(".audiostretch-modal")).color;r.init({waveformDiv:"waveformDiv",overviewDiv:"overviewDiv",backgroundColor:"rgba(0, 0, 0, 0)",waveColor:"#7e8999",midlineColor:"#7e8999",playheadColor:"#dc3710",loopLabelFont:"20px 'Lucida Console', Monaco, monospace",loopMarkerColor:"#c1c1c1",loopLabelColor:"#c1c1c1",tickMarkColor:"#d3dce2",timeLabelColor:o,timeLabelFont:"14px 'BandLab Sans', 'Lucida Console', Monaco, monospace"},lh()),e.playbackRate<0?r.setAudioBuffer(f(n.buffer)):r.setAudioBuffer(n.buffer),r.setPlaybackRate(g.playbackRate),r.setPitchShift(g.pitchShift),r.estimateCPULoad()}),100)},onConfirm:function(){if(Math.abs(a)===g.playbackRate&&l===g.pitchShift)return;i.pushUndo(s.current);const t=Math.abs(a)/g.playbackRate;return e.playbackRate=g.playbackRate*Math.sign(a),e.pitchShift=g.pitchShift,m(e).then((function(){const r=(e.endPosition-e.startPosition)*t;e.sampleOffset*=t,e.loopLength*=t,e.endPosition=e.startPosition+r,e.endPosition>JS.SONG_DURATION_MAX&&(e.endPosition=JS.SONG_DURATION_MAX,o.addNotification({title:"Track duration has been exceeded.",content:"Region has been truncated",autoclose:5e3})),n.$applyAsync()}))},onDestroy:function(){r.pause(),r.destroy()},overlayClose:!1}).show()},stretchRegion:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.playbackRate;return Promise.resolve().then((function(){const n=Math.abs(e.playbackRate/t);return e.fadeIn*=n,e.fadeOut*=n,a.updateSourcesInTracks(),e}))}};function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return Math.min(Math.max(e,.1),Math.min(t,10))}function p(e,n,o){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.defer();return Promise.race([import("./chunk-c1d87621.js"),r.promise]).then((function(t){let{default:i}=t;const a=new Worker("https://www.bandlab.com/web-app/common/workers/AudioStretchWorker-f18fd0ae09.js"),s=new i;return s.init(lh()),Promise.race([s.convertAsync(e,Math.abs(n),o,a).finally((function(){s.destroy()})),r.promise]).finally((function(){a.terminate()}))})).then((function(e){return n<0?Promise.race([f(e),r.promise]):e})).catch((function(e){return Sentry.onLoad((function(){Sentry.captureException(e&&(e.message||e.name),{extra:{colno:e&&e.colno,lineno:e&&e.lineno,message:e&&e.message}})})),t.reject(e)}))}function m(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.playbackRate,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.pitchShift,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return n=Math.max(Math.min(n,12),-12),t=d(Math.abs(t))*Math.sign(t),Promise.resolve().then((function(){const r=Math.abs(e.playbackRate/t);return e.playbackRate=t,e.pitchShift=n,e.sampleOffset*=r,e.loopLength*=r,e.fadeIn*=r,e.fadeOut*=r,o?(e.startPosition*=r,e.endPosition*=r):e.endPosition=e.startPosition+(e.endPosition-e.startPosition)*r,e.endPosition=Math.min(e.endPosition,JS.SONG_DURATION_MAX),a.updateSourcesInTracks(),e}))}function f(e){const t=lh().createBuffer(e.numberOfChannels,e.length,e.sampleRate);for(let n=0;n<e.numberOfChannels;n++)t.copyToChannel(e.getChannelData(n),n,0),t.getChannelData(n).reverse();return t}}]),angular.module("bandlab.editor").factory("Editor",["$analytics","$injector","$q","$rootScope","$state","$stateParams","AppNotifications","AudioStretch","ConfirmModal","EditorAllowActions","EditorCollaboratorsState","EditorData","EditorDB","EditorHelper","EditorHistory","EditorImporter","EditorLoader","EditorMidiSamples","EditorMidiScore","EditorModel","EditorPlayer","EditorRevision","EditorSocket","EditorState","EditorTimeline","EditorTrack","Katnip","Me","Metronome","MetronomeState","MidiEditor","Modal","Page","Revision","RevisionImporter","Sample","SharedMidiSynth","Song","Soundbank",function(e,t,n,o,r,i,a,s,l,c,u,d,p,m,f,h,g,v,b,y,w,$,k,S,P,M,T,C,E,I,R,A,x,L,O,j,D,N,U){const F="BroadcastChannel"in window,B="another_tab_open",W="just_opened";return Ar((()=>{S.isFreezing=$.trackFreezing.size>0,o.$applyAsync()})),{init:function(o){var a=o.song.id&&g.pushTask("loadSample");return M.cleanCollapseData(o.id,o.tracks,o.trackGroups),$.current=o,I.justLoaded=!0,I.settings=o.metronome,(F?function(){const e=$.current.id||i.templateId||"new",t=n.defer(),o=new BroadcastChannel(e);return $.releaseLock=()=>o.close(),o.onmessage=function(e){e.data===B&&(t.reject({message:"This revision is already open in another tab.\nYou cant open same revision in multiple tabs."}),o.close()),e.data===W&&o.postMessage(B)},o.postMessage(W),setTimeout((()=>{t.resolve()}),100),t.promise}().catch((function(e){alert(e.message)})).then((function(){const t=$.current.id||"new";return function(t){if(!t)return o();function o(){p.addSnapshot($.current.id)}const r=n.defer();return new l({confirmLabel:"Restore",contentScope:{title:"Restore last session?",message:"<p>You have unsaved changes for this revision</p>"},onConfirm:function(){t.revision.song=new N(t.revision.song),$.current=t.revision,S.hasRevisionChanges=!0,e.eventTrack("Restore Snapshot",{category:"Mix Editor"}),r.resolve(t)},onCancel:function(){o(),e.eventTrack("Decline Snapshot",{category:"Mix Editor"}),r.resolve()}}).show(),r.promise}(p.getSnapshot(t))})):n.resolve()).then((function(){return n.all([d.requestTrackMixdown($.current).then((function(){return d.loadAllSamples($.current)})),T,U.getList()])})).then((function(){const e=$.current.tracks.flatMap((e=>e.regions));return e.filter((e=>m.isAudioRegion(e)&&(1!==e.playbackRate||0!==e.pitchShift))).reduce(((e,t)=>e.then((()=>s.convertRegion(t))).catch(angular.noop)),n.resolve()).then((()=>w.init($.current))).then((()=>function(){const t=e.filter((e=>m.isTransposableMidiRegion(e)&&0!==e.pitchShift)),o=YI(t,"pitchShift");return Object.entries(o).reduce(((e,t)=>{let[n,o]=t;return e.then((()=>R.transposeRegions($.current,parseFloat(n),new Set(o))))}),n.resolve())}()))})).then((function(){return async function(e,t){const n=e.get("EditorPlayer").current.audioEngineNode;for(const e of t.tracks.filter((e=>e.autoPitch))){const t={...e.autoPitch,scale:e.autoPitch.scale||"scale_undefined",slug:e.autoPitch.slug||"classic",tonic:e.autoPitch.tonic||"tonic_undefined"};if(t.tonic=await n.MusicUtils.slugToTonic(t.tonic),t.scale=await n.MusicUtils.slugToScale(t.scale),!await n.AutoPitch.isSupported(t))throw new Error}}(t,o).catch((function(){return r.go("unavailable",{reload:!0})}))})).then((function(){if(r.params.remoteSample)return au.get(r.params.remoteSample).blob().then((e=>h.importFile({file:e,time:0}))).catch(angular.noop);if(r.params.sampleId||r.params.userSoundsSampleId)return b$({ids:r.params.sampleId||r.params.userSoundsSampleId,isUploads:!r.params.sampleId,userId:C.id}).then((e=>{if(e.loops.length>0){const t=Dq(e.loops[0]);return $.current.key=t.key,$.current.metronome.bpm=t.bpm||120,h.importFile(t)}})).catch(angular.noop);if("autopitch"===i.source){const e=["","classic","modernRap","robot","bigHarmony","duet"],t=["natural","stone","yummy","playCard","ultrashift","hyper","bitz","futurescape","krafty","gorgon"];if($.current.tracks[0].autoPitch.version=t_.value,i.slug)return w.current.audioEngineNode.AutoPitch.getSupportedSlugs(t_.value).then((function(e){(!e.includes($.current.tracks[0].autoPitch.slug)||!S.hasMembership&&t.includes($.current.tracks[0].autoPitch.slug))&&($.current.tracks[0].autoPitch.slug="classic")}));(i.category&&"0.0"===t_.value||!S.hasMembership&&(!e.includes($.current.tracks[0].autoPitch.slug)||i.category))&&($.current.tracks[0].autoPitch.slug="classic")}})).then((function(){if(i.midiId){const e=$.current.tracks.findLastIndex((e=>e.type===Qs));-1!==e&&M.setSelected($.current.tracks[e])}else $.current.tracks[0]&&M.setSelected($.current.tracks[0])})).then((function(){return w.current.updateMix()})).then((async function(){if(i.addTrack||i.source!==Ks){if(i.samplerKit){await PC;const e=EC(),n=e.find((e=>e.id===i.samplerKit))??e[0];if(n.features.multipadSampler)return D.setSampler($.current.tracks[0]).then((function(){return DC(t,n.features.multipadSampler,D.getSampler())}))}}else!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"808-kit";const t=U.getBanks().find((t=>t.slug===e));e=t&&["drum-kit","drum-pads"].includes(t.instrumentSlug)?e:"808-kit",M.addTrack({type:Ks,name:"Drum Machine",beatStarter:0,pushUndo:!1,soundbank:e})}(i.soundbank)})).then((function(){return w.current.audioEngineNode.MusicUtils.getKeySignatureMenuList()})).then((async function(e){const{getKeySignatureMenuKeyForIndex:t,getScaleFromKeySignature:n,getSimplestEnharmonicKeySignature:o,keySigToString:r}=w.current.audioEngineNode.MusicUtils,i=[];for(const[a,s]of e.entries()){const e=await t(a),l=await o(e),c=await r(l),u=(await n(e)).toLowerCase(),d=s.includes("/"),p=d&&s.replace(c,"").replace("/",""),m=d&&`${p} ${u}`;i.push({label:{long:s,short:c,enharmonic:m},key:{long:s.split(" ")[0],short:c.split(" ")[0],enharmonic:p},scale:u.toLowerCase()})}NS.value=i})).finally((function(){g.finishTask(a),S.isInBackground=!1,S.hasSoloTrack=d.checkAnySolo(),d.updateSongDuration(),E.init(),$.current.metronome.pristine=!$.current.id}))},displaySavingSuccess:J,loadRevision:async function(e){let{newProject:t=!1,id:n,template:o}=e;o||(S.isRevisionLoadedFromTemplateBrowser=!1);const i=g.pushTask("postProcessAudio");let a;"live"===u.status?await k.disconnect():k.resetEditorCollaboratorsState(),r.go(".",{id:o?null:n??null},{location:"replace"}),t?a=y.createRevision({song:new N({bandId:null,canEdit:!0,isForkable:!1,name:"New Project"})}):(a=await L.get({id:o?o.revisionId:n,edit:!0}).$promise,o&&(a.creator=void 0,a.id=void 0,a.createdOn=void 0,a.modifiedOn=void 0,a.post=void 0,a.postId=void 0,a=y.createRevision({...a,canEdit:!0,song:new N({canEdit:!0,name:o.name})})),a=P.cleanRevision(a)),$.current=a,I.justLoaded=!0,I.settings=a.metronome,M.cleanCollapseData(a.id,a.tracks,a.trackGroups),n&&(await d.requestTrackMixdown($.current),await d.loadAllSamples($.current)),await w.current.updateMix(),zS.value=null,f.clear(),m.refreshSelectedRegions($.current.tracks),m.refreshSelectedTrack($.current.tracks),S.hasSoloTrack=d.checkAnySolo(),S.hasRevisionChanges=!1,w.updateSourcesInTracks(),JSON.stringify($.selectedTrack)!==JSON.stringify({})&&M.setInputSourceFromTrack($.selectedTrack),g.finishTask(i)},updateProjectName:function(t,n){if(t.song.name!==n)return e.eventTrack("Edit name of revision",{category:"Mix Editor"}),t.song.id&&t.song.canEdit?(S.isSaving=!0,N.update({id:t.song.id,name:t.song.name}).$promise.then((function(){S.isSaving=!1,x.setMetadata({title:t.song.name}),x.update()}))):(x.setMetadata({title:t.song.name}),void x.update())},startSave:function(o){let{publish:i=!1,pristine:a=!1,redirect:s=!0,triggeredFrom:l="quick_save"}=o;return!i&&!a&&!c.isAllowed("save")||i&&!c.isAllowed("publish")||a&&!c.isAllowed("savePristine")?n.reject({message:yh}):(e.eventTrack("Start Saving",{category:"Mix Editor",label:i?"Long Save":"Quick Save"}),(i?function(e){let{isPublic:o=!0,triggeredFrom:r}=e;const i=S.hasRevisionChanges;return V({masteringSetting:"auto",hasRevisionChanges:i}).then((function(e){return n((function(t,n){const o=_.cloneDeep(e.song),r=new A({templateUrl:i?"https://www.bandlab.com/web-app/song/partials/_revision-new-9e40f8e6.html":"https://www.bandlab.com/web-app/song/partials/_revision-publish-f4991e60.html",contentScope:{editorState:S,revision:e,resolve:function(e){Object.assign($.current.song,e.song),t(e),r.destroy()}},onCancel:function(){e.song=o,n({message:dh,hasRevisionChanges:i})}});r.show()}))})).then((e=>i?Y(e,0,r):function(e){return S.isSaving=!0,e.song.id&&e.song.canEdit?N.update({id:e.song.id,name:e.song.name,isForkable:e.song.isForkable,pictureId:e.song.pictureId}).$promise.then((function(){return t()})):t();function t(){var t,n=e.masteringSetting;return"auto"===n?e.mastering={preset:"cdMaster"}:"manual"===n?t=g.pushTask("masterTrack"):e.mastering=null,new L({description:e.description,genres:e.genres,id:e.id}).$update().then((function(e){return"manual"===n?O.pollMixdown(e).then((function(){return O.masterRevision(e,t)})).catch((function(){return e})):e})).then((e=>e))}}(e))).then((e=>(i&&o&&bH(e,t),e))).finally((function(){S.isPreSaving=!1,S.isSaving=!1}))}({triggeredFrom:l}):function(e){let{triggeredFrom:t}=e;return V({masteringSetting:"off",hasRevisionChanges:!0}).then((function(e){return Y(e,0,t)}))}({triggeredFrom:l})).catch(X).then((function(t){return M.onSaveRevision($.current.id,t.id),function(t,n){e.eventTrack("End Saving",{category:"Mix Editor",label:n?"Long Save":"Quick Save"})}(0,i),function(e){$.current.createdOn=e.createdOn,$.current.creator=e.creator,$.current.description=e.description,$.current.genres=e.genres,$.current.id=e.id,$.current.isFork=e.isFork,$.current.mixdown=e.mixdown,$.current.modifiedOn=e.modifiedOn,$.current.parentId=e.parentId,$.current.postId=e.postId,Object.assign($.current.song,_.omit(e.song,"name"))}(t),s&&r.is("mixEditor")?(r.params.id||k.joinProject().then((function(){if(S.hasRealTimeCollaboratByDefault)return Promise.all([k.getMySessionStatus(),k.getSessionUsers()]).then((function(){k.joinSession()}))})),J(t),r.go(".",{id:t.id},{location:"replace",inherit:!1}).then((()=>t))):t})))}};function V(e){let{masteringSetting:t,hasRevisionChanges:o=!1}=e;var r;return S.isPreSaving=!0,n.resolve(function(e){var t=e.tracks.flatMap((e=>e.regions)).some((e=>e.takes&&e.takes.length>1)),o=n.defer();if(!t)return n.resolve();const r=zn((()=>import("./chunk-b1f77df0.js")));return S.isInBackground=!0,_g(r,{title:"Warning",subtitle:"By saving, you will lose all unused takes made during cycle recording.",size:"small",actions:[{label:"Cancel",color:"secondary",onClick:()=>{o.reject()}},{label:"OK",color:"destructive",onClick:()=>{o.resolve()}}]},{onClose:()=>{S.isInBackground=!1}}),o.promise}($.current)).then((function(){return function(e){const t=e.tracks.filter((e=>e.canEdit)).filter((e=>!e.regions.every((t=>m.isRegionPlayable(t,e))))),o=n.defer();if(!t.length)return n.resolve();const r=zn((()=>import("./chunk-b1f77df0.js")));return S.isInBackground=!0,_g(r,{title:"Some Work Will Be Lost",subtitleVHtml:`<p class="text-left">Weve found some regions that are incompatible with the track they are in (e.g. MIDI region in an audio track).\nIncompatible regions in the following tracks will be deleted if they are not moved before saving:</p><p><ul class="text-left">${t.map((e=>`<li>${e.name}</li>`)).join("")}</ul></p>`,size:"small",actions:[{label:"Move Regions",color:"secondary",onClick:()=>{o.reject(new Error(hh))}},{label:"Save Now",color:"destructive",onClick:()=>{f.pushUndo($.current),e.tracks.filter((e=>e.canEdit)).forEach((e=>{e.regions=e.regions.filter((t=>m.isRegionPlayable(t,e)))})),o.resolve()}}]},{onClose:()=>{S.isInBackground=!1}}),o.promise}($.current)})).then((function(){return e=$.current,w.current.detectDuplicateSamples().then((function(t){e.tracks.flatMap((e=>e.regions)).forEach((e=>{e.sampleId=t.find((t=>t.includes(e.sampleId)))?.[0]??e.sampleId}))}));var e})).then((function(){r=_.cloneDeep($.current),a.clearAll(),P.sanitize(r),o&&(r.description="",r.masteringSetting=t,r.placeId=null);const e=Ns(r);return r.sampleId=e>0?ad():null,!1})).then((function(){return w.current.validateRevision(r).then((function(e){if(!e.ok){const t=new Error(e.msg);t.name="ValidateRevisionError",Sentry.onLoad((function(){Sentry.captureException(t)}))}})),r.song.id?N.get({id:r.song.id}).$promise.then((function(e){return e.name=r.song.name,e.description=r.song.description,r.song=e,r})):r})).finally((function(){S.isPreSaving=!1}))}function q(e){return new Set(e.tracks.flatMap((function(e){return e.type===Ks?[]:e.regions})).map((e=>e.sampleId)))}function z(e){return Promise.all(e.tracks.filter((function(e){return e.type===Ks})).flatMap((function(e){return e.patterns})).map((function(e){let{sampleId:t}=e;if(!v.get(t).isSaved)return w.current.getSampleMidFileFromVirtualFileSystem(t).then((function(e){return{blob:e,id:t,score:v.get(t)}}))})))}function H(e){return Promise.all(e.tracks.filter((function(e){return e.samplerKit&&e.canEdit})).map((function(e){return kC(t,e).then((function(t){let{samplerKit:n,samples:o}=t;return n.kit=JSON.parse(n.kit),n.kit.layers=n.kit.layers||[],e.samplerKit=WC(n),o}))}))).then((function(e){return e.flat()}))}function G(e){return n.all([...q(e)].filter((function(e){return v.has(e)&&!v.get(e).isSaved})).map(K))}function K(e){var t=v.get(e);return b.exportScoreToMid(t.id).then((function(e){return{blob:e,id:t.id,score:t}}))}function Y(t,o,r){const i=performance.now();var a,s,l=t.masteringSetting;return S.isSaving=!0,S.hasRevisionChanges=!1,"manual"===l?(a=g.pushTask("createMixdown"),s=g.pushTask("masterTrack")):t.mastering="auto"===l?{preset:"cdMaster"}:null,t.post=t.post||{},t.post.state=t.availabilitySetting||"Private",delete t.availabilitySetting,Sentry.onLoad((function(){Sentry.addBreadcrumb({message:"Save Revision: start",category:"editor.save"})})),n.all($.uploadingSamples).then((function(){return n.all([(o=t,r=q(o),p.getAll().then((function(e){return Hz(e.concat([...e_.values()]),"sampleId").filter((function(e){return r.has(e.sampleId)&&e.blob instanceof Blob})).map((function(e){return{id:e.sampleId,blob:e.blob}}))}))),G(t),z(t),H(t),n.all(_.map($.failedEncodingTasks,(function(t){return t().then((function(t){return e.eventTrack("Failed encoding task recovered",{category:"Debug"}),t}))})))]);var o,r})).then((function(e){Sentry.onLoad((function(){Sentry.addBreadcrumb({message:"Save Revision: upload samples",category:"editor.save"})}));const t=e.flat().filter(Boolean).map((function(e){return j.upload({blob:e.blob,sampleId:e.id,sampleType:"samples"}).then((function(){QS[e.id]=!0,p.deleteFile(e.id),e.score&&(e.score.isSaved=!0)}))}));return n.all(t)})).then((async function(){const n={};return t.tracks.forEach((function(o){o.regions.forEach((function(r){if(!QS[r.sampleId]){e.eventTrack("Missing sample",{category:"Debug",label:`${r.sampleId} in ${t.song.id} (${C.id})`});const i=m.isRegionPlayable(r,o);e.eventTrack("Looking up missing sample",{category:"Debug",label:`${r.sampleId} (${i})`}),i&&!n[r.sampleId]?n[r.sampleId]=function(e){return m.isAudioRegion(e)?Sh($.current.samples.find((t=>t.id===e.sampleId)).buffer):m.isMidiRegion(e)?K(e.sampleId).then((function(e){let{blob:t}=e;return t})):Promise.reject()}(r).then((function(e){return j.upload({blob:e,sampleId:r.sampleId,sampleType:"samples"})})).then((function(){QS[r.sampleId]=!0})).catch((function(t){return e.eventTrack("Error while re-uploading missing sample",{category:"Debug",label:`${r.sampleId} (${t.message})`}),Promise.reject(t)})):n[r.sampleId]=Promise.reject()}}))})),await Promise.all(Object.values(n)),Sentry.onLoad((function(){Sentry.addBreadcrumb({message:"Save Revision: post revision",category:"editor.save"})})),t.song.id&&t.song.canEdit?N.update({id:t.song.id,name:t.song.name,description:t.song.description,isForkable:!!S.isPracticeProject||t.song.isForkable,pictureId:t.song.pictureId}).$promise.then((function(){return L.save({revision:t,triggeredFrom:r,projectOrigin:$.projectOrigin,autokeyUsedCount:$.autokeyUsedCount}).$promise})):L.save({revision:t,triggeredFrom:r,projectOrigin:$.projectOrigin,autokeyUsedCount:$.autokeyUsedCount}).$promise})).then((e=>e)).then((function(n){return t.id||e.eventTrack("Create Project",{category:"Song",label:n.song.isForkable?"Forkable":"Non-forkable"}),p.removeSnapshot(t.id),p.addSnapshot(n.id),$.projectOrigin=null,$.autokeyUsedCount=0,e_.clear(),g.finishTask(a),Promise.resolve().then((()=>fv)).then((e=>{let{logEvent:t}=e;t("revision_save_success",{time:(performance.now()-i)/1e3})})),"manual"===l?O.pollMixdown(n).then((function(){return O.masterRevision(n,s)})).catch((function(){return n})):n})).finally((function(){g.finishTask(a),g.finishTask(s),$.uploadingSamples=[],S.isSaving=!1}))}function J(e){const t={title:e.isPublic?"Revision published":"Project saved",action:'<a ui-sref="track({\n               id: $parent.innerScope.revision.postId\n             })"\n             class="button-scd button-height-32 button-padding-16 button-rounded notification-actions-item"\n             analytics-on="click"\n             analytics-event="Go to Revision page"\n             analytics-category="Mix Editor"\n             analytics-label="Save success notification">\n            <i class="icon-arrow-right"></i>\n          </a>'};a.addNotification({...t,image:`${e.song.picture.url}48x48 1x, ${e.song.picture.url}96x96 2x`,innerScope:{revision:e},autoclose:1e4,classList:"light project notification-actions"})}function X(e){switch(_.get(e,"status",0),S.hasRevisionChanges=!0,e.message||e.statusText){case dh:S.hasRevisionChanges=e.hasRevisionChanges;break;case hh:case"Unauthorized":break;default:if(-1===e?.status){p.addSnapshot($.current.id,$.current),new A({templateUrl:"https://www.bandlab.com/web-app/editor/partials/_mix-editor-modal-2faa35f3.html",contentScope:{status:"isOffline"},onDestroy:function(){S.isInBackground=!1}}).show();break}if(function(){const{fingerprint:t,message:n}=function(e){const t=_.get(e,"config.url",""),n=_.get(e,"status",0);switch(!0){case t.includes("/revisions"):return{fingerprint:["save","revision",n],message:`Error ${n} on save revision ${_.get(e,"data.modelState[0]","")}`};case t.includes("/songs"):return{fingerprint:["save","song",n],message:`Error ${n} on save revision ${_.get(e,"data.message","")}`};default:return{fingerprint:["{{ default }}"],message:e&&(e.message||e.status||e.name)}}}(e);Sentry.onLoad((function(){Sentry.captureException(n,{extra:{error:e,original:$.current},fingerprint:t,tags:{issue:"cannot-save-revision"}})}))}(),202===e?.data.errorCode)break;a.addNotification({title:bh,content:mh,classList:"alert",action:'<a class="button-scd button-height-32 button-padding-10" href="https://help.bandlab.com/hc/en-us/articles/115002945193-Why-aren-t-my-projects-and-revisions-syncing-saving-"  target="_blank" rel="noopener">Read More</a>'})}return g.flushQueue(),n.reject(e)}}]),angular.module("bandlab.editor").factory("EditorAllowActions",["EditorRevision","EditorState","MidiEditorState","Soundbank",function(e,t,n,o){function r(i){switch(i){case"addTrack":case"editRegion":return t.canCollaborate;case"armTrack":case"changeBPM":case"changeKey":case"changeTrackSoundbank":case"cycle":case"cycleSelect":case"historyMove":case"import":case"paste":return t.canCollaborate&&!t.isRecording;case"play":return t.canCollaborate&&!t.isFreezing;case"deleteTrack":return t.canCollaborate&&!t.isRecording&&e.current.tracks.length;case"analyze":case"effect":return!t.isPlaying;case"export":case"freezeTrack":return(t.canCollaborate||!t.hasRevisionChanges)&&!t.isSaving&&!t.isPreSaving&&!t.isRecording&&!t.isMixing&&t.songDuration&&!t.isPlaying&&!t.isFreezing;case"record":return t.canCollaborate&&(t.isRecording||!t.isPlaying||!t.isWaitingCountIn)&&e.current.tracks.length&&e.selectedTrack.type!==Ks&&!t.isFreezing;case"publish":return r("savePristine")&&t.songDuration;case"save":return r("savePristine")&&t.hasRevisionChanges;case"savePristine":return t.canCollaborate&&!t.isSaving&&!t.isPreSaving&&!t.isRecording&&!t.isAiComposingRegion;case"movePlayHead":return!t.isRecording;case"changeInput":return!t.isRecording&&!t.isWaitingCountIn&&t.canCollaborate;case"midiRollZoomOut":return!t.isRecording&&n.scale>1;case"midiRollZoomIn":return!t.isRecording&&n.scale<Ol;case"zoomOut":return!t.isRecording&&t.scale>1;case"zoomIn":return!t.isRecording&&t.scale<Ol;case"analyseAudioInput":return o.getCurrent().input.kind===Hs;case"stopLiveSession":return!t.isSaving&&!t.isPreSaving;default:return!0}}return{isAllowed:r,shouldAskToSave:function(){return r("save")||t.isWaitingCountIn||e.uploadingSamples.length}}}]);const yH={class:"ds-modal ds-modal-size-small"},wH={class:"ds-modal-header"},$H={class:"ds-modal-title"},kH={class:"ds-modal-content"},SH=["innerHTML"],_H={class:"ds-modal-footer ds-modal-footer-two-buttons"},PH=ld({components:{Button:Dd,ModalCloseButton:ib},props:{doNothingFn:{type:Function,required:!0},confirmFn:{type:Function,required:!0},cancelFn:{type:Function,required:!0}},emits:["closeModal"]},[["render",function(e,t,n,o,r,i){const a=vo("Button"),s=vo("ModalCloseButton");return si(),pi("section",yH,[bi("header",wH,[bi("h2",$H,me("Move automation"),1)]),bi("section",kH,[bi("p",{class:"ds-modal-content-p",innerHTML:"Do you want to <strong>move</strong> the automation data for the selected region(s)?"},null,8,SH)]),bi("footer",_H,[yi(a,{type:"button",size:"medium",color:"secondary",padding:"default",onClick:t[0]||(t[0]=t=>{n.doNothingFn(),e.$emit("closeModal")})},{default:Tn((()=>[ki(me("Dont move"),1)])),_:1}),yi(a,{type:"button",size:"medium",color:"primary",padding:"default",onClick:t[1]||(t[1]=t=>{n.confirmFn(),e.$emit("closeModal")})},{default:Tn((()=>[ki(me("Move"),1)])),_:1})]),yi(s,{onClick:t[2]||(t[2]=t=>{n.cancelFn(),e.$emit("closeModal")})})])}]]);angular.module("bandlab.editor").factory("EditorAutomation",["$analytics","EditorHistory","EditorRevision","EditorState","Katnip",function(e,t,n,o,r){return{MARKER_AREA:6,checkConfirmation:function(e,o,r){if("move"===e&&r){const e=_.sortBy(Array.from(o),"startPosition"),t=_.min(e.map((e=>e.startPosition))),n=e[0].trackId,i=r.firstPosition,a=r.firstTrack.id;if(Ws(t)===Ws(i)&&n===a)return Promise.resolve()}return o.some((function(e){return[e.automation.pan,e.automation.volume,...e.automation.effects.map((function(e){return Object.values(e||{}).map((function(e){return e}))}))].flat(2).length>0}))?new Promise((function(e){_g(PH,{doNothingFn:()=>{e()},cancelFn:()=>{t.undo(n.current),e()},confirmFn:()=>{e(!0)}},{escapeClose:!1,overlayClose:!1})})):Promise.resolve()},convertToCoordinates:function(e,t,n){return _.map(e,(function(e){return{posX:a(e.position),posY:i(e.value,t,n)}}))},convertTimeToX:a,convertValueToY:i,convertXtoTime:function(e){return e/o.scalePx},currentTrackId:Vt(null),deleteAutomationInRange:function(e,t,n){[e.automation.pan,e.automation.volume,...e.effects.map((function(e){return Object.values(e.automation||{}).map((function(e){return e}))})).flat(1)].forEach((function(e){Gf(e,(function(e){return e.position>=t&&e.position<=n}))}))},getMomentValue:function(e,t,n){return t&&t.length?s(e,t):n},getAutomatableParameters:function(e){const t={};return e.reduce((function(e,n,o){const{name:i,params:a}=r.metadata[n.slug],{paramList:s}=r.effectsJson.effectsUI.effects[n.slug];return t[i]=(t[i]??0)+1,e.concat(s.reduce((function(e,r){return a[r].automatable?e.concat({id:`${o}-${n.slug}-${r}`,index:o,param:r,effect:n,name:`${i} ${t[i]>1?`(${t[i]})`:""} - ${a[r].name}`,metadata:a[r],automation:n.automation[r]}):e}),[]))}),[])},getAutomatedValue:s,getAutomationInRange:function(e,t,n){return{pan:o(e.automation.pan),volume:o(e.automation.volume),effects:e.effects.map((function(e){return Object.entries(e.automation||{}).reduce((function(e,t){let[n,r]=t;return e[n]=o(r),e}),{})}))};function o(e){return e.filter((function(e){return e.position>=t&&e.position<=n})).map((function(e){return{...e,position:e.position-t}}))}},getPolylineYFromX:function(e,t){const n=e.points;let o=n.getItem(0);for(let e=1;e<n.numberOfItems;e++){const r=n.getItem(e);if(r.x>=t){const e=(r.y-o.y)/(r.x-o.x);return e*t+(o.y-e*o.x)}o=r}return o.y},pasteAutomation:function(t,n,o,r){function i(t,n){t.forEach((function(e){let{...t}=e;t.position=t.position+o,n.push(t)})),n.sort((function(e,t){return e.position-t.position}));const r=_.uniqBy(n,"position");r.length!==n.length&&e.eventTrack("Duplicate times in pasteAutomation",{category:"Debug",label:`${r.length} !== ${n.length}`})}i(n.automation.pan,t.automation.pan),i(n.automation.volume,t.automation.volume),r&&t.effects.forEach((function(e,o){Object.keys(e.automation).forEach((function(e){i(n.automation.effects[o][e],t.effects[o].automation[e])}))}))},pasteSelection:function(e,t){const n=t[0].position,o=t[t.length-1].position;let r=-1;Gf(e,(function(e,t){return r<0&&(r=t),e.position>n&&e.position<o})),e.splice(r,0,...t),e.sort(((e,t)=>e.position-t.position))}};function i(e,t,n){if(n.display){return t-6-(t-12)*Ss(e,n)}var o=t-6,r=(t-12)*(e-n.min)/(n.max-n.min);return"log"===n.scale?o-gs(r,t-12):o-r}function a(e){return e*o.scalePx}function s(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.crTime;var r=e.max-e.min,i=function(e){let[...t]=e;return t.unshift({position:0,value:t[0].value}),t.push({position:JS.SONG_DURATION_MAX,value:t[t.length-1].value}),t}(t),a=_.findIndex(i,(function(e){return e.position>0&&e.position<=JS.SONG_DURATION_MAX&&e.position>=n}));const s={...i[a-1]},l={...i[a]};return"volume"===e.name&&"log"===e.scale?(s.value=gs(s.value,r),l.value=gs(l.value,r),vs(c(s,l)*(n-s.position)+s.value,r)):"log"===e.scale?(s.value=Ss(s.value,e),l.value=Ss(l.value,e),Ps(c(s,l)*(n-s.position)+s.value,e)):c(s,l)*(n-s.position)+s.value;function c(e,t){return(t.value-e.value)/(t.position-e.position)}}}]),angular.module("bandlab.editor").factory("EditorCycle",["$injector","$rootScope","editorEvents","EditorState",function(e,t,n,o){var r,i,a,s=!1,l=0;return{get:function(){return{startTime:i,endTime:a,cycleCount:l}},reschedule:c,set:function(t,n){i=Ws(t),a=Ws(n),e.get("EditorPlayer").current.setCycleState?.(o.isCycling),e.get("EditorPlayer").current.setCycle?.(i,a)},reset:function(){d(),l=0,s=!1},toggle:function(){o.isCycling=!o.isCycling,d(),o.isCycling&&u(),e.get("EditorPlayer").current.setCycleState?.(o.isCycling),e.get("EditorPlayer").current.setCycle?.(i,a)}};function c(){d(),u()}function u(){var e=a-o.crTime;!e||e<=0||(r=performance.now()/1e3+e,s=!1,o.isCycling&&gR.add("playing",p))}function d(){gR.remove("playing",p)}function p(){o.isCycling&&performance.now()/1e3>r&&!s&&(l++,t.$broadcast(n.endOfCycle,l),s=!0,setTimeout((()=>{c()}),100))}}]),angular.module("bandlab.editor").factory("EditorData",["$http","$q","$stateParams","EditorCollaboratorsState","EditorDB","EditorLoader","EditorMidiSamples","EditorMidiScore","EditorRevision","EditorState","RevisionImporter","Sample",function(e,t,n,o,r,i,a,s,l,c,u,d){return{checkAnySolo:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.current.tracks;return _.some(e,{isSolo:!0})},getRegions:function(){return l.current.tracks.filter((e=>e.canEdit)).flatMap((e=>e.regions))},loadAllSamples:function(e){return t.all(e.samples.map((function(n){const o=i.pushTask("loadSample");return r.getFile(n.id).then((function(o){return o?o.blob.notes?(a.set(o.blob.id,o.blob),t.resolve()):o.blob.arrayBuffer().then(l).catch(c):n.isMidi?au.get(n.file).blob().then((function(t){return s.importMidToScore(t,n.id,!0,(o=n.id,r=e.tracks,r.filter((e=>e.type===Ks)).find((e=>e.patterns.find((e=>o===e.sampleId))))?.id));var o,r})):n.file?d.getBuffer(n.file).then(l):d.getJSON(`samples/${n.id}?format=m4a`).then((function(e){return QS[n.id]=!0,e})).then((e=>{let{value:t}=e;return d.getBuffer(t)})).then(l)})).catch(c).finally((function(){i.finishTask(o)}));function l(e){return ch(e).then((function(e){return n.buffer=e,n}))}function c(){return n.error=!0,n}})))},requestTrackMixdown:function(o){const r=o.tracks.filter((e=>!e.canEdit)).filter((e=>e.regions.length));if(!r.length)return t.resolve();const i=r.map((function(t){const r=`https://www.bandlab.com/api/v1.3/revisions/${o.id}/tracks/${t.id}/download-options/aac-44100-16bit-192kbps`;return e.post(r).then((function(){return u.pollOnDemand(r,(()=>n.id!==o.id))})).then((function(e){let{data:{url:n}}=e;o.samples.find((e=>e.id===t.sampleId)).file=n}))}));return t.all(i)},scheduleSampleUpload:function(e,t){if(!Object.keys({...o.writers,...o.writers}).length)return;const n=d.upload({blob:e,sampleId:t,sampleType:"samples"}).then((function(){return QS[t]=!0,Gf(l.uploadingSamples,n),l.uploadingSamples.length||(c.isPreSaving=!1),r.deleteFile(t)}));l.uploadingSamples.push(n),c.isPreSaving=!0},updateSongDuration:function(){c.songDuration=Ns(l.current)}}}]),angular.module("bandlab.editor").factory("EditorDB",["$analytics","$q","$timeout",function(e,t,n){const o=rd((function(){const e=t((function(e,t){const n=indexedDB.open(ul,2);n.onerror=t,n.onclose=t,n.onblocked=t,n.onsuccess=function(){e(n.result)},n.onupgradeneeded=function(e){const t=e.currentTarget.result;try{t.deleteObjectStore(dl)}catch(e){}t.createObjectStore(dl,{keyPath:"sampleId",autoIncrement:!1})}})),o=n((()=>t.reject(new Error("Could not create IndexedDB instance"))),3e4);return t.race([e,o]).catch(r)}));return{addSnapshot:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=JSON.parse(JSON.stringify(t)),o=[];n.tracks&&(n.tracks.forEach((function(e){e.regions.forEach((function(e){o.push(e.sampleId)})),e.patterns&&o.push(...e.patterns.map((function(e){return e.sampleId})))})),n.samples=o.map((function(e){return{id:e}}))),localStorage.setItem(`snapshot_${e||"new"}`,JSON.stringify({revision:n,createdAt:(new Date).getTime()}))},deleteFile:a,deleteFiles:function(){return i().then((function(e){const n=e.map((function(e){return a(e.sampleId)}));return t.all(n)}))},getAll:i,getFile:function(e){return t.when(o()).then((function(n){const o=n.transaction([dl],"readonly"),r=o.objectStore(dl).get(e),i=t((function(e,t){r.onerror=t,r.onsuccess=function(t){e(t.target.result)}}));return t.all([s(o),i]).then((function(){return i}))})).catch((function(e){r(e)}))},getSnapshot:function(e){var t=`snapshot_${e||"new"}`,n=localStorage.getItem(t);return n?(n=JSON.parse(n)).createdAt&&(new Date).getTime()-n.createdAt<2592e6&&n.revision?.tracks?n:(localStorage.removeItem(t),null):null},removeSnapshot:function(e){localStorage.removeItem(`snapshot_${e||"new"}`)},updateFile:function(e){return e_.set(e.sampleId,e),t.when(o()).then((function(n){const o=n.transaction([dl],"readwrite"),r=o.objectStore(dl).put(e),i=t((function(e,t){r.onerror=t,r.onsuccess=e}));return t.all([s(o),i])})).catch(r)}};function r(n){return e.eventTrack("IndexedDB error",{category:"Mix Editor",label:[_.get(n,"target.error.code"),_.get(n,"target.error.message"),_.get(n,"target.error.name")].join(" ")}),t.reject(n)}function i(){return t.when(o()).then((function(e){const t=e.transaction([dl],"readonly"),n=t.objectStore(dl).getAll(),o=new Promise((function(e,t){n.onerror=t,n.onsuccess=function(t){e(t.target.result)}}));return Promise.all([s(t),o]).then((function(){return o}))})).catch((function(e){return r(e),[]}))}function a(e){return e_.delete(e),t.when(o()).then((function(n){const o=n.transaction([dl],"readwrite"),r=o.objectStore(dl).delete(e),i=t((function(e,t){r.onerror=t,r.onsuccess=e}));return t.all([s(o),i])})).catch(r)}function s(e){return t((function(t,n){e.onabort=n,e.oncomplete=t,e.onerror=n}))}}]),angular.module("bandlab.editor").constant("editorEvents",{cycleChanged:"MixEditor:cycleChanged",endOfCycle:"MixEditor:endOfCycle",importFile:"MixEditor:importFile",keyArrow:"MixEditor:keyArrow",keyDown:{addTrack:"MixEditor:addTrack",copy:"MixEditor:copy",cut:"MixEditor:cut",delete:"MixEditor:delete",deleteTrack:"MixEditor:deleteTrack",deleteSelectedAutomationPoints:"MixEditor:deleteSelectedAutomationPoints",duplicateTrack:"MixEditor:duplicateTrack",goToBeginning:"MixEditor:goToBeginning",nextLoop:"MixEditor:nextLoop",muteTrack:"MixEditor:muteTrack",paste:"MixEditor:paste",play:"MixEditor:play",playFromStart:"MixEditor:playFromStart",previousLoop:"MixEditor:previousLoop",record:"MixEditor:record",recordAutomation:"MixEditor:recordAutomation",redo:"MixEditor:redo",save:"MixEditor:save",selectAllRegions:"MixEditor:selectAllRegions",snapPressed:"MixEditor:snapPressed",snapReleased:"MixEditor:snapReleased",soloTrack:"MixEditor:soloTrack",toggleCycle:"MixEditor:toggleCycle",toggleLoops:"MixEditor:toggleLoops",toggleMetronome:"MixEditor:toggleMetronome",togglePlayStop:"MixEditor:togglePlayStop",toggleRecord:"MixEditor:toggleRecord",toggleShortcuts:"MixEditor:toggleShortcuts",toggleSnap:"MixEditor:toggleSnap",toggleVelocity:"MixEditor:toggleVelocity",triggerSlice:"MixEditor:triggerSlice",undo:"MixEditor:undo",zoomIn:"MixEditor:zoomIn",zoomOut:"MixEditor:zoomOut",zoomInPianoRollVertical:"MixEditor:zoomInPianoRollVertical",zoomOutPianoRollVertical:"MixEditor:zoomOutPianoRollVertical"},mouseDown:{multiRegionBackup:"MixEditor:multiRegionBackup",multiRegionResizeLeft:"MixEditor:multiRegionResizeLeft",multiRegionResizeRight:"MixEditor:multiRegionResizeRight",multiRegionExpandLoop:"MixEditor:multiRegionExpandLoop"},mouseUp:{multiRegionUpdate:"MixEditor:multiRegionUpdate"},slice:"MixEditor:slice",startZoom:"MixEditor:startZoomTimeline",startZoomMIDI:"MixEditor:startZoomNotesTimeline",stopZoom:"MixEditor:stopZoomTimeline",stopZoomMIDI:"MixEditor:stopZoomNotesTimeline"}),angular.module("bandlab.editor").factory("EditorGrid",["$filter","EditorRevision","EditorState",function(e,t,n){return{updateGridLabel:function(i){let{element:a,state:s,leftBounds:c,viewportWidth:u}=i;const{array:d,interval:p}=n.isTimeRuler?function(t){for(var n=l(t),o=1,r=0,i=n.primary<=.2,a=e("soundTime"),s=[];o*n.primary*t.scalePx<50;)o++;for(;r<JS.SONG_DURATION_MAX;)s.push(a(r,i).substring(1)),r+=o*n.primary;return{array:s,interval:n.primary*t.scalePx*o}}(s):function(e){for(var n,i,a,s,l=t.current.metronome,c=1,u=r(e),d=o(e),p=u>50,m=1,f=[];d<=4;)d*=2,c*=2;for(n=d,i=c;n<50;)n+=d,c+=i;for(a=n,p&&(a=u);m<=JS.SONG_DURATION_MAX/$s(l);){for(f.push(`${m}`),s=2;p&&s<=l.signature.notesCount;)f.push(`${m}.${s}`),s++;m+=c}return{array:f,interval:a}}(s),m=c+u,f=d.reduce((function(e,t,n){return n*p<c-100||n*p>m+100?e:e.concat(`<span style="left: ${Math.round(p*n)}px">${t}</span>`)}),"");a.innerHTML=f},updateRulerGrid:function(e){let{pattern:t,state:s=n}=e;var c,u,d,p;if(n.isTimeRuler){const e=l(s);c=i(e.primary,s),u=i(e.secondary,s)}else c=o(s),u=r(s);return 0===s.snapSetting.value&&((d=u)>=16&&(d/=2),(p=d)>=16&&(p/=2)),a(t,c,u,d,p)},updateTrackGrid:function(e){let{gridPattern:s,highlightPattern:c,state:u=n,height:d}=e;var p,m,f=o(u),h=r(u);if(n.isTimeRuler){const e=l(u);f=i(e.primary,u),h=i(e.secondary,u)}if(0===u.snapSetting.value)(p=h)>=16&&(p/=2),(m=p)>=16&&(m/=2);else if(1===u.snapSetting.value)h=f;else{const{notesCount:e,noteValue:n}=t.current.metronome.signature;(h*=u.snapSetting.value*n)*e>f&&(f=h*e),u.isTripletGrid&&(h=(f=2*h)/3)}(function(e,r){const a=t.current.metronome.signature.notesCount/t.current.metronome.signature.noteValue;var s;n.isTimeRuler?s=i(l(r).primary,r):(s=o(r),a in Il&&r.scale>=10&&(s*=Dl[a][r.scale]));for(;s<=4;)s*=2;let c=s;for(;c<50;)c+=s;for(e.setAttribute("width",2*c);e.lastChild;)e.removeChild(e.lastChild);var u,d,p;u=e,d=c,(p=document.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("width",d),p.setAttribute("height",3240),p.setAttribute("fill","#00000024"),p.setAttribute("x",0),u.appendChild(p)})(c,u),u.snapDuration=a(s,f,h,p,m,d)/u.scalePx}};function o(e){return $s(t.current.metronome)*e.scalePx}function r(e){return ws(t.current.metronome)*e.scalePx}function i(e,t){return e*t.scalePx}function a(e,t,n,o,r,i){for(var a,l,c;t<=4;)t*=2;for(;n<=4;)n*=2;for(l=t;l<50;)l+=t;for(n&&l>t?(e.classList.add("is-ignore-second"),n=0):e.classList.remove("is-ignore-second"),e.setAttribute("width",l);e.lastChild;)e.removeChild(e.lastChild);for(a=t,s(e,0,0,i),c=0;t*c<l;c++)s(e,t*c,30,i);if(n>=8)for(a=n,c=0;n*c<l;c++)s(e,n*c,30,i,o>=16?"second":"");if(o>=16)for(a=o,c=0;o*c<l;c++)s(e,o*c,30,i);if(r>=32)for(a=r,c=0;r*c<l;c++)s(e,r*c,30,i);return a}function s(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3240,r=arguments.length>4?arguments[4]:void 0;if(!e.querySelector(`[x="${t}"]`)){var i=document.createElementNS("http://www.w3.org/2000/svg","rect");r&&i.classList.add(r),i.setAttribute("width",.5),i.setAttribute("height",o),i.setAttribute("fill","var(--graduation-fill)"),i.setAttribute("x",t),i.setAttribute("y",n),e.appendChild(i)}}function l(e){return wl.find((function(t){return e.scale>=t.scaleMin&&e.scale<=t.scaleMax}))}}]);const MH={class:"ds-modal ds-modal-size-small"},TH={class:"ds-modal-header"},CH={class:"ds-modal-title"},EH={class:"ds-modal-content"},IH={key:0},RH=bi("img",{src:"https://www.bandlab.com/web-app/images/mix-editor/mix-editor-saving-e3766d2c80.svg",alt:"",width:"100",height:"100"},null,-1),AH={class:"ds-modal-content-p"},xH={key:1,class:"info info-error",style:{"margin-bottom":"0"}},LH={class:"ds-modal-content-p"},OH={key:2},jH=["innerHTML"],DH=["innerHTML"],NH={class:"ds-modal-footer ds-modal-footer-one-button"},UH=Vn({__name:"AudioAnalyzerTempo",props:{analyzer:{}},emits:["closeModal"],setup:e=>(e,t)=>(si(),pi("section",MH,[bi("header",TH,[bi("h2",CH,me("Tempo analysis"),1)]),bi("section",EH,[e.analyzer.result||e.analyzer.error?_i("v-if",!0):(si(),pi("div",IH,[RH,bi("p",AH,me("Please wait while we analyze this region."),1)])),e.analyzer.error?(si(),pi("div",xH,[bi("h3",null,me("Unable to detect tempo"),1),bi("p",LH,me(422===e.analyzer.error?"Try again using a longer sample":"We couldnt analyze this sample. Please try again."),1)])):_i("v-if",!0),e.analyzer.result?(si(),pi("div",OH,[bi("p",{class:"ds-modal-content-p",innerHTML:`This region is at <strong>${e.analyzer.result.tempo}</strong> BPM`},null,8,jH),bi("p",{class:"ds-modal-content-p",innerHTML:`Time signature of <strong>${e.analyzer.result.timesig}</strong>`},null,8,DH)])):_i("v-if",!0)]),bi("footer",NH,[yi(Dd,{type:"button",size:"medium",color:"primary",padding:"default",onClick:t[0]||(t[0]=t=>e.$emit("closeModal"))},{default:Tn((()=>[ki(me("Done"),1)])),_:1})]),yi(ib,{onClick:t[1]||(t[1]=t=>e.$emit("closeModal"))})]))}),FH={queuing:{id:"queuing",maxProgress:70,rate:500,message:"Please wait. Your request is in the queue",lottieAnimationPath:"https://www.bandlab.com/web-app/common/static/clock-e59ebbeb08.json"},processing:{id:"processing",minProgress:70,maxProgress:99,rate:500,message:"Voice Cleaner is in action",lottieAnimationPath:"https://www.bandlab.com/web-app/common/static/voice-cleaning-f025af7a2d.json"},failed:{id:"failed",message:"Something went wrong, please try again later"}},BH={queuing:{id:"queuing",maxProgress:70,rate:200,message:"Please wait. Your request is in the queue",lottieAnimationPath:"https://www.bandlab.com/web-app/common/static/clock-e59ebbeb08.json"},processing:{id:"processing",minProgress:70,maxProgress:99,rate:200,message:"Audio-to-MIDI is in action",lottieAnimationPath:"https://www.bandlab.com/web-app/common/static/voice-to-midi-processing-e28c3b767f.json"},failed:{id:"failed",message:"Something went wrong, please try again later"}},WH={processing:{id:"processing",maxProgress:99,rate:200,message:"Audio-to-MIDI is in action",lottieAnimationPath:"https://www.bandlab.com/web-app/common/static/voice-to-midi-processing-e28c3b767f.json"},failed:{id:"failed",message:"Something went wrong, please try again later"}},VH={queuing:{id:"queuing",maxProgress:70,rate:500,message:"Please wait. Your request is in the queue",lottieAnimationPath:"https://www.bandlab.com/web-app/common/static/clock-e59ebbeb08.json"},processing:{id:"processing",minProgress:70,maxProgress:99,rate:500,message:"Voice Transfer is in action",lottieAnimationPath:"https://www.bandlab.com/web-app/common/static/voice-transfer-processing-77f2de6f1b.json"},failed:{id:"failed",message:"Something went wrong, please try again later"}},qH={processing:{id:"processing",maxProgress:99,rate:100,message:"Extend is in action",lottieAnimationPath:"https://www.bandlab.com/web-app/common/static/ai-compose-extend-processing-d40325e93b.json"},failed:{id:"failed",message:"Something went wrong, please try again later"}},zH={processing:{id:"processing",maxProgress:99,rate:100,message:"Recompose is in action",lottieAnimationPath:"https://www.bandlab.com/web-app/common/static/ai-compose-recompose-processing-92cf66979b.json"},failed:{id:"failed",message:"Something went wrong, please try again later"}};angular.module("bandlab.editor").factory("EditorHelper",["$analytics","AppNotifications","EditorMidiSamples","EditorMixdown","EditorRevision","EditorState","InputDevice","MidiEditorState","Sample","Soundbank",function(e,t,n,o,r,i,a,s,l,c){return{applyTracksOrder:function(e){return e.map(((e,t)=>(e.order=t,e)))},areAudioRegions:function(e){return e.every(f)},areMidiRegions:function(e){return e.every(m)},cancelVoiceClean:b,closestSnapPosition:function(e){let[t,...n]=e;for(const e of n)Math.abs(e)<Math.abs(t)&&(t=e);return t===1/0?0:t},colorNameToColorHex:function(e){const t=_.find(zs,{name:e});return t&&t.hex||zs[0].hex},displayAudioEditor:function(){let{toggle:t=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i.isVisible&&t?i.isVisible=!1:(v(),i.isAudioInputActive=!1,i.isVisible=!0,i.track=r.selectedTrack,e.eventTrack("Open Audio Editor",{category:"Mix Editor"}))},displayAutoPitch:function(){let{toggle:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i.isAutoPitchVisible&&e?i.isAutoPitchVisible=!1:(v(),i.isAutoPitchVisible=!0)},displayInstrument:function(){let{toggle:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(i.isAudioInputVisible&&e)return i.isAudioInputActive=!1,void(i.isAudioInputVisible=!1);v(),i.isAudioInputActive=!0,i.isAudioInputVisible=!0},displayMidiEditor:function(){let{toggle:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s.isVisible&&e?s.isVisible=!1:(v(),s.isVisible=!0,s.track=r.selectedTrack)},displayPresetSettings:function(){let{toggle:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(i.isPresetSettingsVisible&&e)return i.isPresetSettingsVisible=!1,void(i.isAudioInputActive=!1);v(),i.isPresetSettingsVisible=!0},getExtraLoopDuration:d,getExtraLoopWidth:function(e){return d(e)*i.scalePx},getFirstLoopDuration:u,getFirstLoopWidth:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.scalePx;return u(e)*t},getRegionColor:p,getRegionBackgroundColor:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const o=e.isMuted||i.hasSoloTrack&&!e.isSolo;if(!e.isFrozen&&!o)return ms(p(e,t),"midi"===n?.06:.5);let r;switch(n){case"midi":r=.06;break;case"audio":r=o?.2:.5;break;default:e.isFrozen&&(r=.5),o&&(r=.2)}return ms("#ffffff",r)},getTotalDuration:function(e){return u(e)+d(e)},getTrackAccentColors:function(e,t){let n=e.color;return e.isMuted||t&&!e.isSolo?(n="#ffffff",`--accent-color: ${ms(n,.5)}; --accent-color-bis: ${ms(n,.495)}`):(e.isFrozen&&(n="#ffffff"),`--accent-color: ${n}; --accent-color-bis: ${ms(n,.99)}`)},hasUneditableTrack:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.current;return _.some(e.tracks,{canEdit:!1})},hidePanel:v,isAudioBuffer:h,isAudioRegion:f,isAudioTrack:function(e){const t=new Set([Ys,Js,Xs,Qs]);return e&&t.has(e.type)},isBandLabInstrumentTrack:function(e){return e&&(e.soundbank||e.samplerKit)&&e.type!==Ks},isMidiRegion:m,isRegionPlayable:function(e,t){var o;return t.patterns&&t.patterns.length?(o=n.get(e.sampleId))&&_.some(t.patterns,{sampleId:o.id}):t.soundbank||t.samplerKit?(o=n.get(e.sampleId),n.has(e.sampleId)&&!o.trackId):(o=_.find(r.current.samples,{id:e.sampleId}))&&o.buffer&&h(o.buffer)},isSamplerTrack:function(e){return e&&[Zs].includes(e.type)},isSoundbankTransposable:g,isTimeSignatureValid:function(){let[e,t]=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return rl.includes(e)&&il.includes(t)},isTrackTransposable:function(e){return!e.samplerKit&&(!e.soundbank||g(e.soundbank))},isTransposableMidiRegion:function(e){const t=r.current.tracks.flatMap((e=>e.patterns||[]));return m(e)&&!t.includes(e.sampleId)},openAnalyzeTempo:function(t){const n=ad(),r=Vt({context:"region"});_g(UH,{analyzer:r},{escapeClose:!1,overlayClose:!1}),o.makeMixdown(null,[t]).then((function(e){let{blob:t}=e;return l.upload({sampleType:"analyzed",blob:t,sampleId:n})})).then((function(){return l.analyzeTempo(n)})).then((function(t){t.tempo=Math.round(t.tempo),e.eventTrack("Analyze Tempo",{category:"Mix Editor",label:"Region",value:t.tempo}),r.value.result=t})).catch((function(e){r.value.error=e.status}))},openTuner:function(){const e=zn((()=>import("./chunk-7142b9af.js")));i.isInBackground=!0,_g(e,{inputDevice:a},{onClose:function(){i.isInBackground=!1}})},refreshSelectedRegions:function(e){const t=e.map((e=>e.regions)).flat();r.selectedRegions=new Set(Array.from(r.selectedRegions).map((function(e){return t.find((t=>t.id===e.id))})).filter(Boolean))},refreshSelectedTrack:function(e){const t=e.find((e=>e.id===r.selectedTrack.id));r.selectedTrack=t||(0===e.length?{}:e[0]),r.armedTracks[1]&&(r.armedTracks[1]=e.find((e=>e.id===r.armedTracks[1].id))),r.armedTracks[2]&&(r.armedTracks[2]=e.find((e=>e.id===r.armedTracks[2].id)))},refreshTracksOrder:function(e){return e.slice().sort((function(e,t){return e.order-t.order})).map((function(e,t){return e.order=t,e}))},show2StepSaveModal:function(e){let{onCancel:t=()=>{},onDiscard:n,saveFn:o}=e;i.isInBackground=!0;_g(zn((()=>import("./chunk-e1566ae2.js"))),{leaveFn:function(){!function(e,t){_g(zn((()=>import("./chunk-b1f77df0.js"))),{title:"Discard all changes?",subtitle:"All your changes will be lost.",size:"small",actions:[{label:"Discard Changes",color:"red",onClick:()=>{t(),e()}},{label:"Cancel",color:"secondary",onClick:t}]},{onClose:t})}(n,(()=>{i.isInBackground=!1}))},saveFn:function(){o()},cancelFn:function(){i.isInBackground=!1,t()}},{escapeClose:!1,overlayClose:!1})},snapToEndRegion:function(e,t,n){const o=t.regions.filter((t=>t.id!==e.id)).map((t=>{let{endPosition:n}=t;return{snappingEdge:n,distance:Math.abs(n-e.startPosition)}})).filter((e=>{let{distance:t}=e;return t<5/n})).sort(((e,t)=>e.distance-t.distance))[0]?.snappingEdge||0;return o&&i.isSnapping?o-e.startPosition:0},snapToGrid:function(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i;var r=Math.round(e/t)*t,a=r+t;return n=angular.extend({padding:5,force:!1,delta:!1},n),Math.abs(e-r)<=n.padding&&i.isSnapping||0!==o.snapSetting.value&&i.isSnapping||n.force?n.delta?r-e:r:Math.abs(e-a)<=n.padding&&i.isSnapping||n.force?n.delta?a-e:a:n.delta?1/0:e},snapToLoopLength:function(e,t){if(!e.loopLength)return 1/0;var n=(e.endPosition-e.startPosition)/e.loopLength,o=e.startPosition+Math.ceil(n)*e.loopLength,r=e.startPosition+Math.floor(n)*e.loopLength;return Math.abs(o-e.endPosition)<5/t?o-e.endPosition:Math.abs(r-e.endPosition)<5/t?r-e.endPosition:1/0},snapToPlayhead:function(e,t){return Math.abs(e-i.crTime)*t<=5},snapToStartRegion:function(e,t,n){const o=t.regions.reduce((function(t,n){return n.id!==e.id&&t.push(n.startPosition),t}),[]).find((function(t){return Math.abs(t-e.endPosition)<5/n}));return o&&i.isSnapping?o-e.endPosition:1/0},toggleLegacyKeyboardShortcuts:function(){JS.IS_LEGACY_KEYBOARD=!JS.IS_LEGACY_KEYBOARD,localStorage.isLegacyKeyboard=JS.IS_LEGACY_KEYBOARD},voiceClean:function(n){const o="no voice detected",a="max length detected",s="in use detected",l=zn((()=>import("./chunk-1689dc16.js"))),c=Vt("Created"),u=Vt(""),d=Date.now(),p=n.sampleId,m=r.current.samples.find((e=>e.id===p));let f,h,g=2,v=!1;return new Promise((function(w,$){if(m.buffer.duration>300)return T(a);const k={id:ad(),buffer:{duration:0}};return S();async function S(){c.value="Created",i.isVoiceCleaningRegion=!0,n.isProcessing=!0,n.sampleId=k.id,u.value=null,f=f||await Sh(m.buffer),await _()}function _(){const e=setTimeout((()=>{v||"Cancelled"===c.value||P()}),2e3);return function(e,t){const n=new FormData;return n.append("file",e,t),n.append("format",Ah(e)),n.append("compression","false"),Uu.post("https://vocal-enhancer.bandlab.io/v2/enhance",{body:n}).json()}(f,m.name).then((()=>{clearTimeout(e),"Cancelled"!==c.value&&M()})).catch((e=>{T(429===e?.response?.status?s:e)}))}function P(){v=!0,_g(l,{title:"Voice Cleaner",status:c,states:FH,retryFn:S,cancelFn:C,overwriteFailedMessage:u},{overlayClose:!1})}function M(){return Uu.get("https://vocal-enhancer.bandlab.io/v1/enhance").json().then((t=>{if("Cancelled"!==c.value)switch(c.value="Failed"===t.status&&t.message.includes("ownerId")&&g>0||g>0&&g<2&&"Created"===t.status||"Failed"===t.status&&t.message===o||"Enhancing"===t.status?"Processing":t.status,t.status){case"Failed":if(!(t.message.includes("ownerId")&&g>0))return T(o);_(),g--;break;case"Created":case"Enhancing":"Created"===t.status&&!v&&Date.now()-d>2e3&&P(),h=setTimeout(M,1e3);break;case"Ready to download":return Promise.all([Uu.get("https://vocal-enhancer.bandlab.io/v1/enhance/download").blob(),import("./chunk-51f87187.js").then((e=>e.j)).then((function(e){let{default:t}=e;return new t}))]).then((e=>{let[t,n]=e;return n.loadAsync(t).then((e=>{let t;return e.forEach(((e,n)=>{t||(t=n)})),t.async("arrayBuffer")}))})).then((e=>ch(e))).then((e=>(r.current.samples.push(k),k.buffer=e,k))).then((t=>{Pg(l),v=!1,y(),e.eventTrack("voice_cleaner_complete",{platform:"firebase",platforms:["amplitude","braze"],params:{processed_sample_id:t.id,original_sample_id:p,processing_time_ms:Date.now()-d,result:"success",sample_duration:Cs(t.buffer.duration,.1)}}),w({sampleBuffer:t.buffer,sampleId:t.id})}))}})).catch((e=>{T(e.message)}))}function T(r){n.sampleId=p;const i=r===o||r===a;if(v&&i&&(Pg(l),v=!1),r===a&&(t.addNotification({title:"Sample is too long",content:"Please ensure that your audio sample is under 5 minutes in duration.",image:"https://www.bandlab.com/web-app/images/settings/notifications-warning-6c1f2da96b.svg",autoclose:8e3}),c.value="Cancelled"),e.eventTrack("voice_cleaner_complete",{platform:"firebase",platforms:["amplitude","braze"],params:{processed_sample_id:m.id,original_sample_id:p,processing_time_ms:Date.now()-d,result:"fail",sample_duration:Cs(m.buffer.duration,.1)}}),y(),!i)return r===s&&(u.value="Voice Cleaner is already running for your account. Please wait for completion."),v||P(),void(c.value="Failed");$()}function C(){v=!1,n.sampleId=p,y(),c.value="Cancelled",b(),e.eventTrack("voice_cleaner_complete",{platform:"firebase",platforms:["amplitude","braze"],params:{processed_sample_id:m.id,original_sample_id:p,processing_time_ms:Date.now()-d,result:"canceled",sample_duration:Cs(m.buffer.duration,.1)}}),$()}})).finally((()=>clearTimeout(h)));function y(){n.isProcessing=!1,i.isVoiceCleaningRegion=!1}}};function u(e){return e.loopLength?Math.min(e.endPosition-e.startPosition,e.loopLength):e.endPosition-e.startPosition}function d(e){return e.loopLength?Math.max(e.endPosition-e.startPosition-e.loopLength,0):0}function p(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const o=e.isMuted||i.hasSoloTrack&&!e.isSolo;if(e.isFrozen||o){let t;return e.isFrozen&&(t=1),o&&(t=.2),"midi"===n&&(t=1),ms("#ffffff",t)}return!t.isPlayable&&t.hasSample||t.isProcessing||!t.canEdit?"#7e8999":e.color}function m(e){return n.has(e.sampleId)}function f(e){return _.find(r.current.samples,{id:e.sampleId})&&!n.has(e.sampleId)}function h(e){return e&&e.constructor===AudioBuffer}function g(e){return"kit"!==c.getPropertyValue(e,"category")&&"general-midi-drums-v4"!==e}function v(){i.isAudioInputActive=!1,i.isAutoPitchVisible=!1,i.isAudioInputVisible=!1,i.isPresetSettingsVisible=!1,s.isVisible=!1,i.isVisible=!1}function b(){Uu.delete("https://vocal-enhancer.bandlab.io/v1/enhance").json()}}]),angular.module("bandlab.editor").factory("EditorHistory",["$rootScope","EditorHelper","EditorPlayer","EditorRevision","EditorState","MidiMapping",function(e,t,n,o,r,i){let a=0;return{clear:function(){o.undoStack=[],o.redoStack=[]},pushUndo:c,redo:function(e){if(l()){var t=o.redoStack.pop();return o.undoStack.push({state:d(e)}),u(e,t)}},rewritePlaceholder:function(e,t,n){[...o.undoStack,...o.redoStack,{state:n}].flatMap((e=>{let{state:t}=e;return t.tracks})).flatMap((e=>{let{regions:t}=e;return t})).filter((t=>t.sampleId===e)).forEach((function(e){e.sampleId=t.id,e.isProcessing=!1,e.isPlayable=!0}))},startToIgnorePushUndo:p,withSingleUndo:function(e){return c(o.current),p(),Promise.resolve(e()).finally(m)},state:{hasUndo:s,hasRedo:l},stopToIgnorePushUndo:m,undo:function(e){if(s()){var t=o.undoStack.pop();return o.redoStack.push({state:d(e)}),u(e,t)}}};function s(){return o.undoStack.length>0}function l(){return o.redoStack.length>0}function c(e){a>0||(o.redoStack=[],o.undoStack.push({state:d(e)}),r.hasRevisionChanges=!0,o.undoStack=o.undoStack.slice(-20))}function u(a,s){if(r.hasRevisionChanges=!0,_.merge(a.metronome,s.state.metronome),setTimeout((function(){a.metronome.pristine=s.state.metronome.pristine,a.metronome.signature.pristine=s.state.metronome.signature.pristine})),a.key=s.state.key,a.volume=s.state.volume,a.trackGroups=s.state.trackGroups,a.tracks.length===s.state.tracks.length)return a.tracks.sort(((e,t)=>c(e)-c(t))),_.forEach(a.tracks,(function(t){var r=_.find(s.state.tracks,{id:t.id});t.automation=r.automation,t.autoPitch=r.autoPitch,t.auxSends=r.auxSends,t.effects=r.effects,t.effectsData={...t.effectsData||{},originalPresetId:r?.effectsData?.originalPresetId},t.trackGroupId=r.trackGroupId,t.isFrozen!==r.isFrozen&&(r.isFrozen?e.$broadcast("MixEditor:FreezeTrack",t.id):e.$broadcast("MixEditor:UnfreezeTrack",t.id)),t.name=r.name,t.pan=r.pan,t.patterns=r.patterns,t.preset=r.preset,t.regions=r.regions,t.soundbank=r.soundbank,t.volume=r.volume,n.current.setTrackEffects(t,t.effects);const{effect:{slug:i=""}={}}=o.trackAutomationParameters.get(t)||{};if(t.effects.find((e=>e.slug===i))){const e=o.trackAutomationParameters.get(t);e.automation=t.effects[e.index].automation[e.param]}else{const e=o.trackAutomationParameters.get(t),n=["volume","pan"].includes(e)?e:"volume";o.trackAutomationParameters.set(t,n)}r.samplerKit&&(t.samplerKit={...r.samplerKit})})),a.tracks=t.applyTracksOrder(a.tracks),t.refreshSelectedRegions(a.tracks),i.pruneMappings(),i.updateMappings(),a;a.tracks=_.filter(a.tracks,(function(e){return _.some(s.state.tracks,{id:e.id})}));var l=_.filter(s.state.tracks,(function(e){return!_.some(a.tracks,{id:e.id})}));return n.updateSourcesInTracks(),a.tracks=l.concat(a.tracks),a.tracks.sort(((e,t)=>c(e)-c(t))),a.tracks=t.applyTracksOrder(a.tracks),t.refreshSelectedTrack(a.tracks),t.refreshSelectedRegions(a.tracks),i.pruneMappings(),i.updateMappings(),gR.start("anticipateScrollLayoutShift:tracksTop"),a;function c(e){return s.state.tracks.findIndex((t=>t.id===e.id))}}function d(e){var t=_.cloneDeep(e);return t.samples=null,_.forEach(t.tracks,(function(e){_.forEach(e.regions,(function(e){e.isMoving=!1}))})),t}function p(){a++}function m(){a--}}]),angular.module("bandlab.editor").factory("EditorImporter",["$analytics","$injector","$q","$rootScope","AppNotifications","AudioStretch","DrumMachineState","EditorDB","EditorHelper","EditorHistory","EditorMidiSamples","EditorMidiScore","EditorPlayer","EditorRevision","EditorState","EditorTimeline","EditorTrack","MidiEditor","SharedMidiSynth","Soundbank",function(e,t,n,o,r,i,a,s,l,c,u,d,p,m,f,h,g,v,b,y){return{importFile:function($){return m.selectedRegions.clear(),c.pushUndo(m.current),c.startToIgnorePushUndo(),function(){switch(!0){case"audio"===$.type:return async function(t){try{t.track=t.track||g.addTrack({name:t.name})}catch(e){return n.reject(e)}KS.loop.playing=!1,KS.audioNode?.onended&&KS.audioNode.stop(),YS.pause();let r=0;t.key&&(!m.current.key&&await w(t.key)&&(m.current.key=t.key),r=v.transposeKeys(t.key,m.current.key??t.key)),t.bpm&&m.current.metronome.pristine&&!f.songDuration&&(m.current.metronome.bpm=t.bpm,m.current.metronome.pristine=!1);const a=t.bpm?i.clampPlaybackRate(m.current.metronome.bpm/t.bpm):1,s=h.createRegionPlaceholder(t.track,{duration:Math.max(t.duration/a,Vl),name:t.name,pitchShift:r,playbackRate:a},t.time||0);return e.eventTrack("Import sample from Loops API",{category:"Mix Editor",extra:{...t.original,gesture:t.gesture,triggeredFrom:t.triggeredFrom,importTarget:"track"}}),(t.original.isPremium||t.original.isUserUploaded?h.createSampleFromPremiumAudioLoopUrl(t):h.createSampleFromAudioLoopURL(t)).then((function(e){return e.name=t.name,h.updateRegionPlaceholder(s.sampleId,e),s.isProcessing=!0,i.convertRegion(s)})).then((function(){s.isProcessing=!1})).catch((function(e){return Gf(t.track.regions,s),n.reject(e)})).finally((function(){o.$applyAsync()}))}($);case $.type===Ks:return function(e){var t=u.get(a.selectedPattern.sampleId);if(!t||!t.notes.length)return n.reject(new Error("Make a beat first before exporting it to a track."));e.time=e.time||0;const{selectedPattern:o,selectedPatternIndex:r,_patterns:i,patternLengthInBars:s}=a;return h.createDrumMachineRegion(m.selectedTrack,o.sampleId,i[r],e.time,s),Gv("insert_pattern"),n.resolve()}($);case!!$.midi:return function(e){let{midi:n,track:o,time:r}=e;return VC(t,b.getSampler().multipadSampler,n).then((function(e){try{o=o||g.addTrack({name:e.name})}catch(e){return}return h.createRegionFromAudioFile(e,o,r)}))}($);case"url"===$.type:return function(e){try{e.track=e.track||g.addTrack({name:e.name})}catch(e){return n.reject(e)}const t=h.createRegionPlaceholder(e.track,{duration:Math.max(e.duration/1,Vl),name:e.name,pitchShift:0,playbackRate:1},e.time||0);return Promise.resolve().then((()=>rb)).then((function(e){let{logChatStudioAudioImport:t}=e;t()})),e.original={audioUrl:e.url},h.createSampleFromAudioLoopURL(e).then((function(n){return n.name=e.name,h.updateRegionPlaceholder(t.sampleId,n),t.isProcessing=!0,i.convertRegion(t)})).then((function(){t.isProcessing=!1})).catch((function(o){return Gf(e.track.regions,t),n.reject(o)})).finally((function(){o.$applyAsync()}))}($);case!$.file:return n.resolve()}return n.resolve(Ch($.file)).then((function(e){return Eh.mid.includes(e.type)?function(e,t){return d.importMidToScore(t).then((function(t){function n(t){const n=e.soundbank||y.getPropertyValue(t.soundbankSlug,"slug")||al;return{name:t.name||y.getPropertyValue(t.soundbankSlug,"name"),soundbank:n}}const i=m.current.tracks.length,a=Math.max(0,i+t.length-JS.TRACKS_LIMIT);return a>0&&(t=t.slice(0,JS.TRACKS_LIMIT-i)),Promise.all(_.map(t,(function(t,r){try{if(r){const o=m.current.tracks.includes(e.track)?m.current.tracks.indexOf(e.track)+1:null;e.track=m.current.tracks[o]||g.addTrack(n(t))}else e.track=e.track||g.addTrack(n(t))}catch(e){return}if(t.originalBpm&&m.current.metronome.pristine&&(m.current.metronome.bpm=t.originalBpm,m.current.metronome.pristine=!1,o.$digest()),t.keySignature&&!m.current.key&&(m.current.key=t.keySignature),t.timeSignature&&l.isTimeSignatureValid(t.timeSignature)&&m.current.metronome.signature.pristine){const[e,n]=t.timeSignature;m.current.metronome.signature.notesCount=e,m.current.metronome.signature.noteValue=n,m.current.metronome.signature.pristine=!1}if(e.time=e.time||0,s.updateFile({blob:t,sampleId:t.id}),"midi"===e.type)return t;if(t.keySignature&&m.current.key){const n=e.track,o=e.time;return v.transposeScoreKey(t.id,t.keySignature,m.current.key,n.soundbank).then((function(e){return h.createRegionFromMidiScore(e,n,o)}))}return h.createRegionFromMidiScore(t,e.track,e.time)}))).then((()=>{var e;a>0&&r.addNotification({title:(e=a,{one:`${e} track couldnt be added`,other:`${e} tracks couldnt be added`}[new Intl.PluralRules("en").select(e)]),content:$h.replace("{$1}",String(JS.TRACKS_LIMIT)),classList:"alert",autoClose:5e3})}))}))}($,e):function(e,t){return qh(t).then((function(e){return Bh(e).then(Qx).then((function(t){return{blob:e,analysis:t}}))})).then((function(t){let{blob:n,analysis:o}=t;try{e.track=e.track||g.addTrack({name:n.name})}catch(e){return}if(o.keySignature&&!m.current.key&&(m.current.key=o.keySignature),o.bpm&&m.current.metronome.pristine&&!f.songDuration&&(m.current.metronome.bpm=o.bpm,m.current.metronome.pristine=!1),o.timeSig&&l.isTimeSignatureValid([o.timeSig.beats,o.timeSig.beatUnit])&&m.current.metronome.signature.pristine){const{beats:e,beatUnit:t}=o.timeSig;m.current.metronome.signature.notesCount=e,m.current.metronome.signature.noteValue=t,m.current.metronome.signature.pristine=!1}const r=e.multiple?void 0:o.endPosition,i=e.multiple?0:o.sampleOffset;return h.createRegionFromAudioFile(n,e.track,e.time,r,i)}))}($,e)}))}().then(p.updateSourcesInTracks).catch((function(e){"Track couldnt be added"!==e?.message&&r.addNotification({content:e.message||"Unable to import file. Please check that your file is not corrupted.",classList:"alert",autoclose:8e3})})).finally(c.stopToIgnorePushUndo)},askKeyUpdateConfirmation:w};function w(e){return new Promise((function(t){const n=zn((()=>import("./chunk-b1f77df0.js")));f.isInBackground=!0,_g(n,{size:"small",title:`Set Project Key to ${e}?`,subtitle:"Regions will be transposed when possible.",actions:[{label:"Dont Set",color:"secondary",onClick:()=>t(!1)},{label:"Set",color:"primary",onClick:()=>t(!0)}]},{escapeClose:!1,overlayClose:!1,onClose:()=>{t(!1),f.isInBackground=!1}})}))}}]),angular.module("bandlab.editor").factory("EditorLoader",["Modal",function(e){var t={loadSample:{operation:"load",title:"Loading",label:"Preparing audio"},postProcessAudio:{operation:"load",title:"Loading",label:"Processing audio"},uploadMeta:{operation:"save",title:"Saving",label:"Updating song metadata"},createMixdown:{operation:"save",title:"Saving",label:"Creating mixdown"},uploadMixdown:{operation:"save",title:"Saving",label:"Syncing mixdown"},export:{operation:"export",title:"Exporting audio",label:"Save Audio As File"},masterTrack:{operation:"master",title:"Mastering",label:"Enhancing your mixdown to distribution quality",rate:50},loadMasterPreview:{operation:"master",title:"Mastering",label:"Loading preview"}},n=0,o=[],r=!1,i={destroy:angular.noop,show:angular.noop};return{getDone:function(){return n},getQueue:function(){return o},finishTask:function(e){-1!==o.indexOf(e)&&(o.splice(o.indexOf(e),1),n++)},flushQueue:function(){o.splice(0,o.length),n=0,i.destroy(),r=!1},pushTask:function(n,a){var s=Object.assign({},t[n],a);return r||((i=new e({templateUrl:"https://www.bandlab.com/web-app/editor/partials/_mix-editor-loader-e0afafc5.html",overlayClose:!1,noStateChangeListeners:!0})).show(),r=!0),o.push(s),s}}}]).controller("EditorLoaderCtrl",["$interval","$rootScope","$scope","$timeout","EditorLoader","EditorRevision","EditorState",function(e,t,n,o,r,i,a){var s;n.queue=r.getQueue(),n.progress=0,n.cancelExport=function(){kh.forEach((function(e){e.terminate()})),kh=[],r.flushQueue(),i.mixingTasks=[],a.isMixing=!1},n.cancelMaster=function(){t.$broadcast("Mastering:cancel")},n.$watch("queue.length",(function(t){t&&(n.title=n.queue[0].title,n.operation=n.queue[0].operation,n.label=n.queue[0].label),e.cancel(s),s=e((function(){var i=Math.round(r.getDone()/(r.getDone()+n.queue.length)*100)||0,a=Math.round((r.getDone()+1)/(r.getDone()+n.queue.length)*100)||0,l=Math.min(n.progress+1,a,98);n.progress=Math.min(Math.max(i,l),100),100!==i&&0!==t||(r.flushQueue(),e.cancel(s),o((function(){n.progress=0}),1e3))}),n.queue[0]&&n.queue[0].rate||500)}))}]),angular.module("bandlab.editor").factory("EditorMidiSamples",(function(){return new Map})).factory("EditorMidiScore",["$http","EditorDB","EditorMidiSamples","EditorRevision","MidiEditorState",function(e,t,n,o,r){return{createScore:function(){var e={id:ad(),isSaved:!1,key:o.current.key,notes:[],pitchShift:0};return n.set(e.id,e),e},editScore:i,updateMidiRegionWithScore:function(e,t){if(e.takes){const n=e.sampleId,o=e.takes.findIndex((e=>e===n));e.takes.splice(o,1,t.id)}e.sampleId=t.id},exportScoreToMid:function(t){return function(t){let{bpm:n=o.current.metronome.bpm,soundbank:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Promise.all([import("./chunk-841d4d78.js"),e.get("https://www.bandlab.com/api/v4.1/soundbanks",{cache:!0})]).then((function(e){let[{generate:i},{data:{soundbankToProgramChange:a}}]=e;return i({parts:[t],transport:{bpm:n,timeSignature:[o.current.metronome.signature.notesCount,o.current.metronome.signature.noteValue],instruments:[-1===a[r]?128:a[r]],keySignature:o.current.key}})})).then((function(e){return new Blob([c(e)],{type:"audio/midi"})})).catch((function(e){return Sentry.onLoad((function(){Sentry.captureException(e,{extra:{notes:t,metronome:o.current.metronome,soundbank:r}})})),Promise.reject(e)}))}(n.get(t).notes)},flattenNotes:d,getExactDuration:s,getMidiExcerptScore:function(e,t,n,r){return rL(e,t,Bz(n,o.current.metronome.bpm),Bz(r,o.current.metronome.bpm)).then((e=>a(e,t)))},getNotesTime:l,getRoundedDuration:function(e,t,n){var o,r=s(e,n);return(o=$s({bpm:n,signature:t}))*Math.ceil(r/o)},importMidToScore:a,mergeScore:function(e,o,r){var i,a;i=e.flatMap((function(e){return n.has(e.sampleId)?d(l(e.sampleId,o),e).map((function(t){return t.time+=e.startPosition,t})):[]}));const s=r?_.minBy(e,"startPosition").startPosition:0;return i=i.map((function(e){return e.time-=s,e.time=`${Bz(e.time,o)}i`,e.duration=`${Bz(e.duration,o)}i`,e.id=ad(),e})),a={id:ad(),notes:i,pitchShift:0},t.updateFile({blob:a,sampleId:a.id}),n.set(a.id,a),a}};function i(e,o){let{pitchShift:r=0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var i=ad(),a=_.clone(e);return a.id=i,a.notes=u(o),a.pitchShift=r,a.isSaved=!1,t.updateFile({blob:a,sampleId:i}),n.set(i,a),a}function a(e,t,o,r){return Promise.all([import("./chunk-4c8182dd.js"),iL(e)]).then((function(e){let[{parse:t},[n,o,r]]=e;const i=n.tracks.map((function(e,i){return iL(o[i]).then((function(e){let[,[t]]=e;return n=t,new Promise(((e,t)=>{const o=new FileReader;o.onload=function(t){e(t.target.result)},o.onerror=t,o.readAsBinaryString(n)}));var n})).then((function(o){const{parts:i}=t(o);return[n,r,e,i]}))}));return Promise.all(i)})).then((async function(a){return r&&await Wx(t,e),a.length?a.map((function(e){let[{tempoBPM:a,timeSig:{beats:s,beatUnit:l},tracks:[{length:c}]},d,{program:p,soundbankSlug:m,name:f},[h]]=e;const g={id:t||ad(),isSaved:o,keySignature:d,name:f,notes:h.map((function(e){return e.id=ad(),e})),length:c,originalBpm:Math.round(a),pitchShift:0,programChange:p,soundbankSlug:m,timeSignature:s&&l?[s,l]:void 0,trackId:r};n.set(g.id,g);const v=u(g.notes);return g.notes.length===v.length?(g.notes=v,g):i(g,v)})):(n.set(t,{id:t,isSaved:o,pitchShift:0,notes:[],trackId:r}),[])}))}function s(e,t){return fs(n.get(e).notes.map((e=>Fz(parseFloat(e.time)+parseFloat(e.duration),t))))}function l(e,t){const o=n.get(e).notes.map((function(e){return Object.assign({},e,{duration:Fz(parseFloat(e.duration),t),time:Fz(parseFloat(e.time),t)})}));return mx(o,"time")}function c(e){var t,n=new ArrayBuffer(e.length),o=new Uint8Array(n);for(t=0;t<e.length;t++)o[t]=e.charCodeAt(t);return n}function u(e){let t=e.filter((function(e){const t=e.midiNote>=0&&e.midiNote<=127||"sustain"===e.eventName||"pitchBend"===e.eventName;return t||Sentry.onLoad((function(){Sentry.captureException("Out of range MIDI note",{extra:e})})),t}));return t=mx(t,(e=>-parseInt(e.duration))),t=mx(t,(e=>parseInt(e.time))),t}function d(e,t){const n=e.flatMap((function(e){return e.time>=t.sampleOffset-r.TIME_APPROXIMATION&&(t.loopLength&&e.time-t.sampleOffset<t.loopLength||!t.loopLength&&e.time-t.sampleOffset<t.endPosition)?function(e){for(var n=t.loopLength?(t.endPosition-t.startPosition)/t.loopLength:1,o=e.time-t.sampleOffset,i=t.endPosition-t.startPosition,a=[],s=0;s<n&&o<i-r.TIME_APPROXIMATION;)a.push({...e,time:o,inLoop:s}),s++,o=e.time+t.loopLength*s-t.sampleOffset;return a}(e):[]}));return mx(n,"time")}}]),angular.module("bandlab.editor").factory("EditorMixdown",["$injector","EditorRevision","EditorState",function(e,t,n){return{makeMixdown:function(o,r,i){return n.isMixing=!0,Ex(e,t.current,o,r,i).finally((function(){n.isMixing=!1}))},renderToMidi:function(o,r,i){return n.isMixing=!0,Ix(e,t.current,o,r,i).finally((function(){n.isMixing=!1}))}}}]),angular.module("bandlab.editor").factory("EditorModel",["EditorHelper","EditorRevision","Me","Revision","Soundbank",function(e,t,n,o,r){return{createRegion:function(e){var t=_.defaults({},e,{automation:{pan:[],volume:[],sendLevel:[]},canEdit:!0,fadeIn:0,fadeOut:0,gain:1,id:ad(),loopLength:0,name:"Region",playbackRate:1,pitchShift:0,sampleId:id,sampleOffset:0,startPosition:0,trackId:id});return t.name=t.name.substring(0,40).trim(),t},createRevision:function(e){var t=_.defaults({},e,{canEdit:!0,creator:n,genres:[{id:"other",name:"Other"}],id:null,key:null,lyrics:null,mastering:null,metronome:{bpm:120,pristine:!0,signature:{notesCount:4,noteValue:4,pristine:!0}},pan:0,parentId:null,sampleId:ad(),samples:[],song:null,title:"New Revision",tracks:[],trackGroups:[],volume:1,auxChannels:new Bl});return new o(t)},createTrack:function(e){var n=_.defaults({},e,{automation:{volume:[],pan:[],sendLevel:[]},canEdit:!0,channel:1,effects:[],id:ad(),isMuted:!1,isSolo:!1,name:"Track",order:0,pan:0,patterns:null,preset:Vs.slug,regions:[],soundbank:null,trackGroupId:null,volume:1,auxSends:new Wl}),o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(0===e.length)return zs[Math.round(Math.random()*(zs.length-1))];const t=e[e.length-1].colorName,n=zs.findIndex((e=>e.name===t));return zs[(n+1)%zs.length]}(t.current.tracks);return _.defaults(n,{color:o.hex,colorName:o.name,type:i(n)}),n.type===Ks&&(n.patterns=[]),n.name=n.name.substring(0,128).trim(),n},getTrackType:i};function i(t){return t.patterns&&t.patterns.length?Ks:t.samplerKit?Zs:t.soundbank?r.getPropertyValue(t.soundbank,"instrumentSlug"):e.isAudioTrack(t)?t.type:Qs}}]);const HH={class:"ds-modal ds-modal-size-small"},GH={class:"ds-modal-header"},KH={class:"ds-modal-title"},YH={class:"ds-modal-content"},JH={class:"ds-modal-content-p"},XH={class:"ds-modal-footer ds-modal-footer-one-button"},ZH={__name:"MixEditorWarnEndOfTrackModal",emits:["closeModal"],setup(e,t){let{emit:n}=t;const o=n;return(e,t)=>(si(),pi("section",HH,[bi("header",GH,[bi("h2",KH,me("Track length limit reached"),1)]),bi("section",YH,[bi("p",JH,me("Move the playhead back to record or play"),1)]),bi("footer",XH,[yi(Dd,{type:"button",size:"medium",color:"primary",padding:"default",onClick:t[0]||(t[0]=e=>o("closeModal"))},{default:Tn((()=>[ki(me("OK"),1)])),_:1})]),yi(ib,{onClick:t[1]||(t[1]=e=>o("closeModal"))})]))}};ql.recordingLatency=ql.recordingLatency&&parseFloat(ql.recordingLatency)||0,angular.module("bandlab.editor").factory("EditorPlayback",["$analytics","$q","$rootScope","$timeout","AppNotifications","EditorCycle","EditorData","EditorDB","EditorHelper","EditorHistory","EditorMidiSamples","EditorPlayer","EditorRecorder","EditorRevision","EditorScroll","EditorScrollState","EditorState","EditorTimeline","EditorView","Metronome","MidiEditorState",function(e,t,n,o,r,i,a,s,l,c,u,d,p,m,f,h,g,v,b,y,w){var $,k=angular.noop,S={record:0,play:0};return{pausePlay:A,saveAudioRecord:T,startPositions:S,togglePlay:_,toggleRecord:P,stop:function(){g.isRecording&&P(),g.crTime=S.play,S.play=0,g.isPlaying&&_(),g.isCycling&&(g.crTime=i.get().startTime),gR.start("playing",!1),!b.isRegionVisible({left:g.crTime*g.scalePx,width:1},h.timelineLeft)&&JS.FOLLOW_PLAYHEAD&&f.scrollToX({time:g.crTime,scalePx:g.scalePx})}};function _(){if(Math.ceil(g.crTime)>=JS.SONG_DURATION_MAX&&x(),g.isFollowingPlayhead=!0,w.isFollowingPlayhead=!0,E(),g.isPlaying)g.isRecording&&P(),A();else{if(S.play=g.crTime,g.isCycling){const{startTime:e}=i.get();d.setPlaybackPosition(e)}R(),n.$broadcast(xT)}}function P(){if(g.isRecording&&!g.isWaitingCountIn)return C();var e=i.get(),t=e.endTime-e.startTime;if(m.selectedTrack.id)if(g.isWaitingCountIn)o.cancel($),M(new Error(dh));else if(Math.ceil(g.crTime)<JS.SONG_DURATION_MAX){if(!m.armedTracks[1]&&!m.armedTracks[2])return m.selectedTrack.type===Ks?void r.addNotification({title:"Record function is not available.",content:"Add a pattern from your drum machine track or record on a different type of track.",autoclose:8e3}):void r.addNotification({title:"No input source is selected.",content:"Connect your device and select it as an input source.",autoclose:8e3});if(g.isCycling){if(!t||t<2)return void r.addNotification({title:"Cycle is too short!",content:"Select a cycle duration longer than {$1} seconds.".replace("{$1}",String(2)),autoclose:5e3});g.crTime=e.startTime}!function(){g.isFollowingPlayhead=!0,w.isFollowingPlayhead=!0,S.play=S.record=g.crTime,f.scrollToX({scalePx:g.scalePx,time:S.record}),g.isRecordingAutomation&&(c.pushUndo(m.current),c.startToIgnorePushUndo(m.current)),n.$broadcast(LT,{fromTime:S.record}),E();try{!function(){var e,t=(e=$s(m.current.metronome),S.record%e+e*JS.COUNT_IN_DURATION);function r(e){g.isRecording=!0,g.isRecordingAutomation&&!m.selectedTrack.soundbank||p.start({startTime:S.record}),R(),n.$broadcast(xT),g.isCycling&&i.reschedule(),e&&($=o((function(){g.isWaitingCountIn=!1}),1e3*t,!1))}g.isPlaying?(t=0,g.isCycling?(A(),g.crTime=i.get().startTime,r()):(g.isRecording=!0,g.isRecordingAutomation&&!m.selectedTrack.soundbank||p.start({startTime:S.record}))):(JS.COUNT_IN_DURATION?(d.setPlaybackPosition(S.record-t),g.isWaitingCountIn=!0,r(!0)):r(),g.isCycling&&i.reschedule())}()}catch(e){M()}}()}else x()}function M(e){A(),d.setPlaybackPosition(S.record),g.isRecording=!1,g.isWaitingCountIn=!1,n.$broadcast(jT),g.isRecordingAutomation&&c.stopToIgnorePushUndo()}function T(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.id;return Sh(e).then((function(e){s.updateFile({blob:e,sampleId:t}),a.scheduleSampleUpload(e,t)})).catch((function(){m.failedEncodingTasks.push((function(){return Sh(e).then((function(e){return{blob:e,id:t}}))}))}))}function C(){g.isRecording=!1,p.stop(),function(){const o=l.isBandLabInstrumentTrack(m.armedTracks[1])||l.isBandLabInstrumentTrack(m.armedTracks[2]),i=l.isAudioTrack(m.armedTracks[1])||l.isAudioTrack(m.armedTracks[2]);m.selectedRegions.clear(),c.pushUndo(m.current),c.startToIgnorePushUndo();const s=[];o&&s.push(async function(){const e=await p.getMidiRecord(),n=[m.armedTracks[1],m.armedTracks[2]].filter((e=>e)).filter(l.isBandLabInstrumentTrack),o={};for(const t of n)for(const n of e[t.id]??[]){const e=!o[t.id],{sampleId:r,startPosition:i,endPosition:a}=n;if(e){if(!u.has(r))continue;o[t.id]=v.createRegionFromMidiScore(u.get(r),m.current.tracks.find((e=>e.id===t.id)),i,a)}else v.addTakeToMidiRegion(r,o[t.id])}return a.updateSongDuration(),d.current.updateMix(),t.resolve()}()),i&&!g.isRecordingAutomation&&s.push(async function(){const{shortestDuration:e,buffersByTrack:n}=await p.getAudioRecord();if(e<Vl)return r.addNotification({title:"Record duration is too short!",content:"Duration of record should be more than {$1} sec.".replace("{$1}",String(Vl)),autoclose:5e3}),t.resolve();const o=t.all(Object.values(n).map((e=>e.map((e=>T(e)))))).then((function(){d.current.updateMix()})),i=[m.armedTracks[1],m.armedTracks[2]].filter((e=>e)).filter(l.isAudioTrack),s={};for(const e of i)for(const t of n[e.id]??[])if(s[e.id])v.addTakeToAudioRegion(t,s[e.id]);else{const n=m.current.tracks.find((t=>t.id===e.id));s[e.id]=v.createRegionFromAudioBuffer(n,t,S.record,null,+ql.recordingLatency)}return a.updateSongDuration(),o}()),Promise.all(s).finally((()=>{n.$applyAsync(),c.stopToIgnorePushUndo()})),g.isRecordingAutomation&&c.stopToIgnorePushUndo(),e.eventTrack("End Recording",{category:"Mix Editor",label:m.selectedTrack.type})}()}function E(){k()}async function I(){const e=await d.current.transport.getPlayPositionTicks(),t=await d.current.transport.ticksToSecs(e);g.isPlaying&&(g.crTime=t,g.crTime>=JS.SONG_DURATION_MAX&&(g.isRecording?C():A(),g.crTime=JS.SONG_DURATION_MAX))}async function R(){g.crTime>=JS.SONG_DURATION_MAX||(y.update(),await d.setPlaybackPosition(g.crTime),await d.startPlaying(),gR.add("playing",I),gR.start("playing",!0,g))}function A(){d.pausePlaying(),i.reset(),gR.stop("playing"),gR.remove("playing",I),n.$broadcast(AT)}function x(){g.isInBackground=!0,_g(ZH,{},{escapeClose:!0,overlayClose:!0,onClose:()=>{g.isInBackground=!1}})}}]),angular.module("bandlab.editor").factory("EditorPlayer",["$injector","EditorCycle","EditorData","EditorDB","EditorRevision","EditorState",function(e,t,n,o,r,i){let a=Promise.resolve((()=>{}));var s={current:{},init:function(t){return a=import("./chunk-5c4d1db4.js").then((function(n){let{getPlayer:o}=n;const r=lh();return o(e,r,t)})).then((function(e){return s.current=e,function(){return e.destroy()}})),a},pausePlaying:function(){i.isPlaying=!1,a.then((function(){s.current.stopMix()}))},reset:async function(){(await a)()},setPlaybackPosition:async function(e){i.crTime=e,await(s.current.setPlayPosition?.(e)),i.isPlaying&&i.isCycling&&t.reschedule()},startPlaying:function(){return i.isPlaying=!0,s.current.playSong().then((function(){i.isCycling&&t.reschedule(),e.get("SharedMidiSynth").getSampler().bindMultipadSampler()}))},updateSourcesInTracks:function(){s.current.updateMix(),n.updateSongDuration(),i.songDuration&&o.addSnapshot(r.current.id,r.current)}};return s}]),angular.module("bandlab.editor").factory("EditorRecorder",["$rootScope","EditorHelper","EditorMidiScore","EditorPlayer","EditorRevision","EditorTrack","InputDevice",function(e,t,n,o,r,i,a){let s=Promise.resolve();var l;return{getAudioRecord:async function(){const[e,t]=await s,n={};let r=1/0;for(const i of t)for(const t of i)if(t&&"Midi"!==e.tracks.find((e=>e.id===t.trackId)).type){const e=await o.current.readSample(t.sampleId),i=await c(e);n[t.trackId]=n[t.trackId]?.concat(i)??[i],r=Math.min(r,i.duration)}return{shortestDuration:r,buffersByTrack:n}},getMidiRecord:async function(){const[e,t]=await s,r={};for(const i of t)for(const t of i)if(t&&"Midi"===e.tracks.find((e=>e.id===t.trackId)).type){const e=await o.current.readSample(t.sampleId,"mid"),i=new Blob([e]);await n.importMidToScore(i,t.sampleId),r[t.trackId]=r[t.trackId]?.concat(t)??[t]}return r},start:function(n){const c=t.isBandLabInstrumentTrack(r.armedTracks[1])&&r.armedTracks[1]||t.isBandLabInstrumentTrack(r.armedTracks[2])&&r.armedTracks[2];c&&i.setSelected(c),s=o.current.startRecording(a.connect,n.startTime),e.$broadcast(OT,n),l=!0},stop:function(){l&&(s=s.then((e=>e())),l=!1,e.$broadcast(jT))}};async function c(e){const t=await ch(e);return t.name="Audio record",t.id=ad(),t}}]),angular.module("bandlab.editor").factory("EditorReset",["$rootScope","AudioReset","EditorCollaboratorsState","EditorHistory","EditorLoader","EditorMidiSamples","EditorPlayback","EditorRevision","EditorScroll","EditorSocket","EditorState","EditorWaveform","MidiDevice","MidiEditorState",function(e,t,n,o,r,i,a,s,l,c,u,d,p,m){return{reset:function(){s.current.id&&c.disconnect(),t.reset(),r.flushQueue(),a.pausePlay(),o.clear(),d.deleteUnusedCache(),m.isVisible=null,zS.value=null,s.projectOrigin=null,s.uploadingSamples=[],s.selectedRegions.clear(),s.selectedTrack={},s.trackFreezing.clear(),p.unplug(),n.activeChat=null,gR.reset(["playing","scroll:notesTop","scroll:timelineLeft","scroll:tracksTop","scale:timeline"]),u.reset(),l.reset(),function(){for(var t in e.$$listeners)/MixEditor/.test(t)&&delete e.$$listeners[t]}()},resetBeforeInitialization:function(){i.clear(),u.hasRevisionChanges=null}}}]),angular.module("bandlab.editor").factory("EditorRevision",(function(){return{autokeyUsedCount:0,armedTracks:{1:null,2:null},current:{},failedEncodingTasks:[],lastTrack:{guitar:{},voice:{}},mixingTasks:[],projectOrigin:null,redoStack:[],releaseLock:()=>{},selectedRegions:new Set,selectedTrack:{},trackAutomationParameters:new WeakMap,lastDevice:null,trackFreezing:Mt(new Map),trackMonitoring:new WeakMap,undoStack:[],uploadingSamples:[]}})),angular.module("bandlab.editor").factory("EditorScrollState",["EditorState","MidiEditorState",function(e,t){return new Proxy({notesLeft:0,notesTop:0,timelineLeft:0,tracksTop:0,notesEl:{},notesTimelineEl:{},timelineEl:{},tracksEl:{},SCROLL_STEP:30},{set:function(n,o,r){if(n[o]===r)return!0;const i=!0;switch(o){case"notesLeft":r=Math.max(r,0),(r=Math.min(r,t.containerWidth+100-n.notesTimelineEl.clientWidth))!==n.notesTimelineEl.scrollLeft&&(gR.start("scroll:notesLeft",!1,r,i),gR.start("scroll:notesLeft:noRAF",!1,r,i,!1),t.isLocked&&!t.isZooming&&(gR.start("scroll:timelineLeft",!1,r,i),gR.start("scroll:timelineLeft:noRAF",!1,r,i,!1),n.timelineLeft=r));break;case"notesTop":r=Math.max(r,0),(r=Math.min(r,n.notesEl.scrollHeight-n.notesEl.clientHeight))!==n.notesEl.scrollTop&&(gR.start("scroll:notesTop",!1,r,i),gR.start("scroll:notesTop:noRAF",!1,r,i,!1));break;case"timelineLeft":r=Math.max(r,0),(r=Math.min(r,e.containerWidth+100-n.timelineEl.clientWidth))!==n.timelineEl.scrollLeft&&(gR.start("scroll:timelineLeft",!1,r,i),gR.start("scroll:timelineLeft:noRAF",!1,r,i,!1),t.isLocked&&!t.isZooming&&(gR.start("scroll:notesLeft",!1,r,i),gR.start("scroll:notesLeft:noRAF",!1,r,i,!1),n.notesLeft=r));break;case"tracksTop":r=Math.max(r,0),(r=Math.min(r,n.tracksEl.scrollHeight-n.tracksEl.clientHeight))!==n.tracksEl.scrollTop&&(gR.start("scroll:tracksTop",!1,r,i),gR.start("scroll:tracksTop:noRAF",!1,r,i,!1))}return n[o]=r,!0}})}]).factory("EditorScroll",["EditorScrollState",function(e){return gR.add("anticipateScrollLayoutShift:tracksTop",(function(){gR.start("scroll:tracksTop",!1,e.tracksEl.scrollTop,!0,!1),gR.start("scroll:tracksTop:noRAF",!1,e.tracksEl.scrollTop,!0,!1),e.tracksEl.scrollTop!==e.tracksTop&&(e.tracksTop=e.tracksEl.scrollTop)})),{focusedNotesRescale:function(t){e.notesLeft=o({clientWidth:e.notesTimelineEl.clientWidth,scrollLeft:e.notesLeft,...t}),gR.start("scroll:notesLeft",!1,e.notesLeft,!0,!1)},focusedRescale:function(t){e.timelineLeft=o({clientWidth:e.timelineEl.clientWidth,scrollLeft:e.timelineLeft,...t}),gR.start("scroll:timelineLeft",!1,e.timelineLeft,!0,!1)},manualScroll:function(){let{left:t,right:n,up:o,down:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const i=e.SCROLL_STEP;t||n?e.timelineLeft+=t?-i:i:(o||r)&&(e.tracksTop+=o?-i:i)},manualNotesScroll:function(){let{left:t,right:n,up:o,down:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const i=e.SCROLL_STEP;t||n?e.notesLeft+=t?-i:i:(o||r)&&(e.notesTop+=o?-i:i)},reset:function(){e.notesLeft=0,e.notesTop=0,e.timelineLeft=0,e.tracksTop=0,e.notesEl={},e.timelineEl={},e.tracksEl={}},scrollNotesToX:function(n){e.notesLeft=t(e.notesLeft,e.notesTimelineEl,n)},scrollNotesToY:function(t){e.notesTop=n(e.notesTop,e.notesEl,t)},scrollToBottom:function(){e.tracksTop=1/0},scrollToX:function(n){e.timelineLeft=t(e.timelineLeft,e.timelineEl,n)},scrollToY:function(t){e.tracksTop=n(e.tracksTop,e.tracksEl,t)}};function t(e,t,n){if(angular.isDefined(n.time))return Math.round(n.time*n.scalePx)-Math.round(t.clientWidth/2);if("left"===n.direction)return e-t.clientWidth;if("right"===n.direction)return e+t.clientWidth+(n.offset||0);if(angular.isDefined(n.percent)){const e=n.scrollWidth||t.scrollWidth;return Math.min((n.percent-n.clickPosition)*e+n.offsetPosition,e-t.clientWidth)}}function n(e,t,n){return"up"===n.direction?e-t.clientHeight:"down"===n.direction?e+t.clientHeight:angular.isDefined(n.percent)?(n.percent-n.clickPosition)*t.scrollHeight+n.offsetPosition:void 0}function o(e){let{clientWidth:t,scrollLeft:n,time:o,oldScalePx:r,scalePx:i}=e;const a=o*(r||i);if(a>=n&&a<=n+t)return o*i-(o*(r||i)-n);const s=t/2;return(n+s)/(r||i)*i-s}}]),angular.module("bandlab.editor").value("EditorCollaboratorsState",{activeChat:null,chats:null,members:{},readers:{},writers:{},projectChat:{},session:{},sessions:[]}).factory("EditorSocket",["$analytics","$http","$q","$rootScope","$stateParams","$timeout","EditorCollaboratorsState","EditorData","EditorDB","EditorHelper","EditorHistory","EditorLoader","EditorMidiSamples","EditorModel","EditorPlayer","EditorRevision","EditorState","EditorTrack","Me","MetronomeState","Revision","Sample","User",function(e,t,n,o,r,i,a,s,c,u,d,p,m,f,h,g,v,b,y,w,$,k,S){let P=0,M=0,T={},C={},E=n.defer(),I=angular.noop,R=!1,A=Promise.resolve(),x={addEventListener:angular.noop,close:angular.noop,removeEventListener:angular.noop,send:angular.noop},L=angular.noop,O=angular.noop;const j=import("./chunk-8b982ad8.js").then((e=>e.r)).then((function(e){let{applyPatch:t,createPatch:n}=e;L=t,O=n})),D=ay((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:T;if(R)return;const n=Object.fromEntries(m),o=O({...t,midiSamples:C},{...e,midiSamples:n});o.length?(C=n,U({command:"revision.update",patch:o,version:++P}),T=e):T=e}),400,{leading:!1,trailing:!0});return{disconnect:B,getLink:function e(n){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t.get(`https://www.bandlab.com/api/v1.3/songs/${n.song.id}/invite-link`).then((async function(e){let{data:{inviteLink:t}}=e;return`https://get-bandlab.app.link/invite-link?$canonical_url=${n=t}&$fallback_url=${n}`;var n})).catch((function(t){return o<3?i((()=>e(n,++o,1e3*o))):Promise.reject(t)}))},getMySessionStatus:X,getSessionUsers:function(){const e=ad(),t=Z(e);return A.then((function(){U({id:e,command:"session.users.list"})})),t},isConnected:function(){return!!r.userId},leaveSession:F,joinProject:H,joinSession:J,resetEditorCollaboratorsState:N,sendCursor:function(){v.canCollaborate&&1===x.readyState&&U({command:"cursor.move",x:Math.round(1e3*XS.position.x),y:Math.round(1e3*XS.position.y)})},startSession:G};function N(){a.activeChat=null,a.chats=null,a.members={},a.readers={},a.writers={},a.projectChat={},a.session={},a.sessions=[],a.status=""}function U(e){let{id:t=ad(),...n}=e;x.send(JSON.stringify({id:t,...n}))}function F(){D.cancel(),I();const e=ad(),t=Z(e);return U({id:e,command:"session.leave"}),t}function B(){return x.onclose=angular.noop,x.onmessage=angular.noop,F().then((function(){x.close(),N(),v.canCollaborate=!0}))}function W(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g.current;const{auxChannels:t,id:n,key:o,lyrics:r,metronome:{signature:i,...a},modifiedOn:s,samples:l,tracks:c,volume:u}=e;return{auxChannels:(t||[]).map((function(e){return{...e,effects:(e.effects||[]).map((function(e){return{...e,params:{...e.params}}}))}})),id:n,key:o,lyrics:{content:r?.content},metronome:{signature:{...i},...a},modifiedOn:s,samples:(l||[]).map((function(e){return{id:e.id,pitchShift:e.pitchShift,playbackRate:e.playbackRate}})),tracks:c.map((function(e){return{...e,automation:{...e.automation,pan:(e.automation.pan||[]).map((function(e){let{...t}=e;return t})),volume:(e.automation.volume||[]).map((function(e){let{...t}=e;return t}))},auxSends:(e.auxSends||[]).map((function(e){let{...t}=e;return t})),effects:(e.effects||[]).map((function(e){return{...e,automation:Object.entries(e.automation).reduce((function(e,t){let[n,o]=t;return e[n]=(o||[]).map((function(e){let{...t}=e;return t})),e}),{}),params:{...e.params}}})),...e.patterns?{patterns:(e.patterns||[]).map((function(e){let{...t}=e;return t.notes=t.notes.slice(),t}))}:{},regions:(e.regions||[]).map((function(e){let{...t}=e;return delete t.hasSample,delete t.isMoving,delete t.isPlayable,delete t.isProcessing,t})),...e.autoPitch?{autoPitch:{...e.autoPitch}}:{},...e.samplerKit?{samplerKit:{...e.samplerKit,id:""}}:{}}})),volume:u}}function V(){return o.$watch((function(){D(W())}),(()=>{}),!0)}async function q(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return x.onclose=angular.noop,x.close(),t>1?Promise.reject():(await j,new Promise((function(n,r){const i=new WebSocket(`wss://rtc.bandlab.io/v1/project/${g.current.song.id}?access_token=${l.get("sessionKey")}`);C=Object.fromEntries(m),i.addEventListener("error",(function(e){r(e)})),i.onclose=function(e){return I(),E.reject("Abort"),a.status="remote",o.$applyAsync(),g.current.song?.id?$.get({id:g.current.id,edit:!0}).$promise.then((function(){return q(++t)})).catch(r).then(n):(navigator.onLine||window.addEventListener("online",(function(){H().then((function(){J()}))}),{once:!0}),r(e))},i.onmessage=function(t){const r=JSON.parse(t.data);if("system.online"!==r.command)if(r.client_id!==y.id)switch(r.command){case"cursor.moved":if("remote"===a.status)return;!function(e){let{client_id:t,x:n,y:r}=e;a.members[t]&&(ZS[t]={position:{x:n/1e3,y:r/1e3}},ZS[t].label=a.members[t].name,ZS[t].userId=t,o.$broadcast("MixEditor:cursor",ZS[t]))}(r),o.$applyAsync();break;case"revision.updated":if("remote"===a.status)return;ee(r);break;case"session.started":case"session.joined":case"session.left":U({command:"session.users.list"}),o.$applyAsync();break;case"session.users":!function(e){let{users:t}=e;a.readers={},a.writers=_.reduce(t,(function(e,t){return e[t]=!0,a.members[t]||S.get({id:t}).$promise.then((e=>{a.members[t]=e})),e}),{}),o.$broadcast("$invite:changed"),o.$applyAsync()}(r),o.$applyAsync();break;case"session.status":a.status=r.status,o.$applyAsync();break;case"revision.history":case"system.users":case"system.connected":case"system.disconnected":break;case"system.error":if(703!==r.code)break;if(r.message.includes("InvalidArgument")){e.eventTrack("Error with real-time collaboration server",{label:r.message,category:"Debug"}),B();break}"live"===a.status?z(r):r.message.includes("document is empty")?G():J()}else"system.connected"===r.command?(U({command:"session.status.get"}),U({command:"session.users.list"}),n()):"session.left"===r.command?(U({command:"session.users.list"}),a.status="remote",o.$applyAsync()):r.command.startsWith("session.")&&U({command:"session.users.list"})},x=i})))}function z(e){if(e.message.includes("version"))return I(),void K().then((async function(e){let{document:t,version:n}=e;for(let e=M+1;e<=n;e++)ee(await Y(P));P=n,M=n;const o=Object.fromEntries(m);U({command:"revision.update",patch:O(t,{...W(),midiSamples:o}),version:++P}),I=V()})).catch((function(e){return z(e)}));I(),K().then((function(e){return te(e)}))}function H(){return v.canCollaborate=!0,A=q(),A}function G(){const t=p.pushTask("loadSample");A.then((function(){const e=ad(),t=Z(e);return U({id:e,command:"session.start",revision_id:g.current.id}),t})).then((function(){return K()})).then((function(t){let{document:n,version:o}=t;const r=Object.fromEntries(m),i=O(n,{...W(),midiSamples:r});P=o,M=o,U({command:"revision.update",patch:i,version:++P}),X(),I(),I=V(),e.eventTrack("Start session",{category:"Mix Editor",label:"Real-time collaboration"})})).finally((()=>{p.finishTask(t)}))}function K(){const e=ad(),t=Z(e);return A.then((function(){U({id:e,command:"revision.get"})})),t}function Y(e){const t=ad(),n=Z(t);return A.then((function(){U({id:t,command:"revision.patch.get",version:e})})),n}function J(){const t=ad(),n=Z(t);return A.then((function(){U({id:t,command:"session.join"})})),n.then((function(){return c.removeSnapshot(g.current.id),K()})).then((function(e){return te(e)})).then((function(){X(),e.eventTrack("Join session",{category:"Mix Editor",label:"Real-time collaboration"})}))}function X(){const e=ad(),t=Z(e);return A.then((function(){U({id:e,command:"session.status.get"})})),t}function Z(e){return x.readyState!==x.OPEN&&H(),new Promise((function(t,n){x.addEventListener("message",(function o(r){const i=JSON.parse(r.data);if(i.id===e){if(x.removeEventListener("message",o),"system.error"===i.command)return n(i);t(i)}}))}))}function Q(e,t){const o=t.filter((function(e){return!m.has(e.id)&&(!e.buffer||e.buffer&&e.buffer.constructor!==AudioBuffer)&&"regions-mix"!==e.name&&e.id!==id})).map((function(e){return e.buffer=null,function(e){return k.getJSON(`samples/${e.id}?format=m4a`).then((e=>{let{value:t}=e;return k.getBuffer(t)})).then(ch)}(e).then((function(t){return QS[e.id]=!0,e.buffer=t,e})).catch((function(t){return e.buffer=null,n.reject(t)}))}));return n.race([n.all(o),e.promise]).catch((function(n){"Abort"!==n&&i((()=>Q(e,t)),5e3)}))}function ee(e){let{patch:t,version:r}=e;I();const i=Object.fromEntries(m),a=W(),l=O({...T,midiSamples:C},{...a,midiSamples:i});l.length?(C=i,U({command:"revision.update",patch:l,version:++P}),T=a):T=a,R=!0,E.reject("Abort"),E=n.defer();const c=_.cloneDeep({...g.current,midiSamples:C});L(c,t),d.clear(),c.midiSamples&&(Object.entries(c.midiSamples).map((e=>{let[t,n]=e;m.set(t,n),n.isSaved&&(QS[t]=!0)})),C=c.midiSamples,delete c.midiSamples),c.tracks.forEach((function(e){e.canEdit=!0,e.type=f.getTrackType(e),e.color=u.colorNameToColorHex(e.colorName),e.regions.forEach((e=>{e.canEdit=!0}))})),_.merge(w.settings,c.metronome);const p=O(g.current.auxChannels,c.auxChannels);L(g.current.auxChannels,p);const y=O(g.current.tracks,c.tracks);L(g.current.tracks,y);const $=O(g.current.metronome,c.metronome);L(g.current.metronome,$),g.current.id=c.id,g.current.key=c.key,g.current.lyrics=c.lyrics,g.current.modifiedOn=c.modifiedOn,g.current.title=c.title,g.current.volume=c.volume,g.current.tracks.map((e=>e.regions)).flat().forEach((function(e){const t=g.current.samples.find((t=>t.id===e.sampleId));if(t&&u.isAudioBuffer(t.buffer)){const n=c.samples.find((t=>t.id===e.sampleId));n.buffer=t.buffer,e.isProcessing=!1}else m.has(e.sampleId)?e.isProcessing=!1:e.isProcessing=!0})),g.current.samples=c.samples,Q(E,c.samples),u.refreshSelectedTrack(g.current.tracks),v.hasSoloTrack=s.checkAnySolo(),h.updateSourcesInTracks(),b.setInputSourceFromTrack(g.selectedTrack),P=r,M=r,T=W(),D.cancel(),I=V(),o.$applyAsync((()=>{o.$applyAsync((()=>{R=!1,gR.start("syncVolume")}))}))}function te(e){let{document:t,version:n}=e;ee({patch:O(g.current,t),version:n})}}]),angular.module("bandlab.editor").factory("EditorState",(function(){return{crTime:0,canCollaborate:!0,hasNewTrackHeadUpdate:!1,hasMembership:!1,hasRealTimeCollaboratByDefault:!1,hasRevisionChanges:null,hasRevisionHistory:!1,hasSoloTrack:!1,isAreaSelecting:!1,isArming:!1,isAudioInputActive:!1,isAudioInputVisible:!1,isAutomationVisible:!1,isAutoPitchVisible:!1,isBeatsDisplayed:!1,isCycling:!1,isDraggingRegions:!1,isFreezing:!1,isInBackground:!0,isMetronomeEnabled:!1,isMidiActive:!1,isMixing:!1,isPlaying:!1,isPreSaving:!1,isPreviewingRevision:!1,isPresetSettingsVisible:!1,isRecording:!1,isRegionAudioStretchEnabled:!1,isRegionAudioStretching:!1,isResizingLeft:!1,isResizingRight:!1,isSaving:!1,isSidetabOpen:!1,isSnapping:!0,isTimeRuler:!1,isTripletGrid:!1,isUnderAiComposeExperiment:!1,isAiComposingRegion:!1,isUnderAiVocalPaywallExperiment:!1,isWebGLEnabled:!1,isVoiceCleaningRegion:!1,isUnderVoiceTransferExperiment:!1,isWaitingCountIn:!1,snapSetting:$l[0],songDuration:0,reset:function(){const{hasNewTrackHeadUpdate:e,hasMembership:t,hasRealTimeCollaboratByDefault:n,hasRevisionChanges:o,isSnapping:r,isUnderAiComposeExperiment:i,isUnderAiVocalPaywallExperiment:a,isUnderVoiceTransferExperiment:s}=this;Object.entries(this).forEach((e=>{let[t,n]=e;"boolean"==typeof n&&(this[t]=!1)})),this.hasNewTrackHeadUpdate=e,this.hasMembership=t,this.hasRealTimeCollaboratByDefault=n,this.isSnapping=r,this.isUnderAiComposeExperiment=i,this.isUnderAiVocalPaywallExperiment=a,this.isUnderVoiceTransferExperiment=s,this.canCollaborate=!0,this.crTime=0,this.isInBackground=!0,this.hasRevisionChanges=o}}}));let QH=function(e){return e[e.INVALID_MIDI=201]="INVALID_MIDI",e[e.EMPTY_MIDI=202]="EMPTY_MIDI",e[e.ERROR_IN_USE=209]="ERROR_IN_USE",e}({}),eG=function(e){return e[e.INVALID_MIDI=101]="INVALID_MIDI",e[e.EMPTY_MIDI=102]="EMPTY_MIDI",e[e.ERROR_IN_USE=108]="ERROR_IN_USE",e}({});function tG(e){const t=new FormData;return t.append("Audio",e),t.append("numberOfSongs","5"),t.append("temperature","1.5"),t.append("topP",".7"),Promise.all([Uu.post("https://autobeat.bandlab.io/v1/generate",{body:t}).blob(),import("./chunk-51f87187.js").then((e=>e.j)).then((function(e){let{default:t}=e;return new t}))]).then((e=>{let[t,n]=e;return n.loadAsync(t)})).then((e=>{const t=[];return e.forEach(((e,n)=>{const o=n.async("blob");t.push(o)})),Promise.all(t)})).catch((e=>{if(e instanceof Uc)return e.response.json().then((e=>{throw e}));throw new Error}))}let nG=function(e){return e[e.INVALID_MIDI=101]="INVALID_MIDI",e[e.EMPTY_MIDI=102]="EMPTY_MIDI",e}({});const oG=Ac((function(){let e;return Promise.all([sh(),ah()]).then((t=>{let[n,o]=t;if(n&&o)e="https://www.bandlab.com/web-app/common/workers/libmadonna-8581fc4583.js";else{if(!n||o)return Promise.reject(new Error("No libmadonna compatible"));e="https://www.bandlab.com/web-app/common/workers/libmadonna_no_simd-27c8c101c3.js"}return Promise.all([e,Promise.all([Uu.get("https://model-artifact-proxy.bandlab.io/v1/model/madonna/0.2.2",{kyCache:!0}).blob(),import("./chunk-51f87187.js").then((e=>e.j)).then((function(e){let{default:t}=e;return new t}))]).then((e=>{let[t,n]=e;return n.loadAsync(t)})).then((e=>e.file("artifacts/transcriber.bml"))).then((e=>{if(!e)throw new Error("File not found");return e.async("uint8array")}))])}))}));let rG=function(e){return e[e.TOO_SHORT=101]="TOO_SHORT",e[e.TOO_LONG=102]="TOO_LONG",e[e.TOO_SOFT=103]="TOO_SOFT",e[e.TOO_MANY_NOTES=104]="TOO_MANY_NOTES",e[e.TOO_MANY_NOTE_OFFS=105]="TOO_MANY_NOTE_OFFS",e[e.TEMPO_OUT_OF_RANGE=106]="TEMPO_OUT_OF_RANGE",e[e.TRY_AGAIN_LATER=107]="TRY_AGAIN_LATER",e[e.MODEL_UNKNOWN_ERROR=108]="MODEL_UNKNOWN_ERROR",e[e.UNKNOWN_ERROR=109]="UNKNOWN_ERROR",e[e.INVALID_AUDIO=110]="INVALID_AUDIO",e}({});angular.module("bandlab.editor").factory("EditorTimeline",["$analytics","$injector","$rootScope","AppNotifications","EditorCycle","EditorData","EditorDB","EditorHelper","EditorHistory","EditorLoader","EditorMidiSamples","EditorMidiScore","EditorMixdown","EditorModel","EditorRevision","EditorState","EffectsPreset","Katnip","MidiEditor","Soundbank",function(e,t,n,o,r,i,a,s,l,c,u,d,p,m,f,h,g,v,b,y){return{addTakeToAudioRegion:function(e,t){var n={id:e.id||ad(),buffer:e,name:e.name};t.takes=t.takes||[t.sampleId],t.takes=t.takes.concat(e.id),t.sampleId=e.id,f.current.samples.push(n),f.selectedRegions.add(t)},addTakeToMidiRegion:function(e,t){t.takes=t.takes||[t.sampleId],t.takes=t.takes.concat(e),t.sampleId=e},aiComposeExtendMidiRegion:function(t,r,i){h.isAiComposingRegion=!0;const a=Date.now(),s=t.sampleId,l=ad();let c;const u=Vt("Processing"),m=Vt(""),g=zn((()=>import("./chunk-1689dc16.js")));return new Promise(((v,b)=>{return _g(g,{title:"Extend",status:u,states:qH,retryFn:y,cancelFn:function(){u.value="Cancelled",V(t,s),h.isAiComposingRegion=!1,Pg(g),e.eventTrack("smart_extend_complete",{platform:"firebase",platforms:["amplitude","braze"],params:{original_sample_id:s,processing_time_ms:Date.now()-a,result:"canceled",bars:i,instrument_type:f.selectedTrack.type}}),b()},overwriteFailedMessage:m},{overlayClose:!1}),y();async function y(){return u.value="Processing",m.value=null,c=c||await p.renderToMidi(null,[t]).then((e=>{let{blob:t}=e;return t})),t.isProcessing=!0,t.sampleId=null,n.$applyAsync(),function(e,t){const n=new FormData;return n.append("file",e),n.append("bars",t.toString()),Uu.post("https://compose.bandlab.io/v1/autocomplete",{body:n}).blob().catch((function(e){if(e instanceof Uc)return e.response.json().then((function(e){throw e}));throw new Error}))}(c,i).then((e=>{const n=t.endPosition-t.startPosition,o=n+i*$s(f.current.metronome);return d.getMidiExcerptScore(e,l,n,o)})).then((n=>{if("Cancelled"===u.value)return;const o=t.endPosition,a=t.endPosition+i*$s(f.current.metronome);F(n[0],r,o,a,0),V(t,s),f.selectedRegions.clear(),h.isAiComposingRegion=!1,Pg(g),e.eventTrack("smart_extend_complete",{platform:"firebase",platforms:["amplitude","braze"],params:{processed_sample_id:l,original_sample_id:s,processing_time_ms:Date.now()-o,result:"success",bars:i,instrument_type:f.selectedTrack.type}}),v()})).catch((n=>{!function(n){V(t,s),e.eventTrack("smart_extend_complete",{platform:"firebase",platforms:["amplitude","braze"],params:{original_sample_id:s,processing_time_ms:Date.now()-a,result:"fail",bars:i,instrument_type:f.selectedTrack.type}});if(n===eG.EMPTY_MIDI||n===eG.INVALID_MIDI){let e;Pg(g),h.isAiComposingRegion=!1;let t="Unable to apply Extend. Please try again later.";return n===eG.EMPTY_MIDI?(e="Chirp, Chirp!",t="Make sure your MIDI file has musical content and is not empty."):n===eG.INVALID_MIDI&&(e="Check Your File Format",t="Please ensure youre using a valid MIDI file (.mid)."),o.addNotification({title:e,content:t,image:"https://www.bandlab.com/web-app/images/settings/notifications-warning-6c1f2da96b.svg",autoclose:5e3}),void b()}n===eG.ERROR_IN_USE&&(m.value="Extend is already running for your account. Please wait until it is completed."),u.value="Failed"}(n?.errorCode||n)}))}}))},aiComposeLayerMidiRegion:async function(t,n){const r=zn((()=>import("./chunk-0674dc9a.js"))),i=Vt(new Array(5)),a=Cs(s.getFirstLoopDuration(t)/$s(f.current.metronome),.01),l="max bars detected",c="max tracks detected";let u;return e.eventTrack("smart_layer_start",{platform:"firebase",platforms:["amplitude","braze"],params:{tempo:f.current.metronome.bpm,time_signature:`${f.current.metronome.signature.notesCount}/${f.current.metronome.signature.noteValue}`,key:f.current.key}}),new Promise(((m,g)=>{if(h.isInBackground=!0,a>32)return v(l);if(f.current.tracks.length+2>JS.TRACKS_LIMIT)return v(c);function v(t){let n;Pg(r);let i="Unable to apply Layer. Please try again later.";t===l?(n="MIDI is too long",i="Trim your MIDI to be within 32 bars and try again."):t===c?(n="Track limit reached",i="Please remove some tracks and try Layer again."):t===nG.EMPTY_MIDI?(n="Chirp, Chirp!",i="Make sure your MIDI file has musical content and is not empty."):t===nG.INVALID_MIDI&&(n="Check Your File Format",i="Please ensure youre using a valid MIDI file (.mid)."),o.addNotification({title:n,content:i,image:"https://www.bandlab.com/web-app/images/settings/notifications-warning-6c1f2da96b.svg",autoclose:5e3});const{metronome:a,key:s,id:u}=f.current;e.eventTrack("smart_layer_conversion",{platform:"firebase",platforms:["amplitude","braze"],params:{result:"fail",tempo:a.bpm,time_signature:`${f.current.metronome.signature.notesCount}/${f.current.metronome.signature.noteValue}`,key:s,revision_stamp:u,instrument_type:f.selectedTrack.type}}),g()}_g(r,{region:t,midScores:i,addTracks:function(e){e.forEach((e=>{e.order=n+1})),f.current.tracks.splice(n+1,0,...e),f.current.tracks=s.applyTracksOrder(f.current.tracks),o.addNotification({title:`${e.map((e=>e.name)).join(", ")} added to your Studio Project`,content:"Enjoy your AI generated MIDI.",image:"https://www.bandlab.com/web-app/images/mix-editor/tools-layer-notifications-a7deaa98fb.svg",autoclose:5e3}),m()},refreshTrack:function(e){return tG(u).then((e=>e.reduce(((e,t)=>e.then((e=>d.importMidToScore(t).then((t=>(e.push(t),e)))))),Promise.resolve([])))).then((t=>{i.value.forEach(((n,o)=>{const r=n.findIndex((t=>t.name===e)),i=t[o].find((t=>t.name===e));r?n[r]=i:n.push(i)}))}))}},{overlayClose:!1}),p.renderToMidi(null,[t]).then((e=>{let{blob:t}=e;return u=t,tG(t)})).then((e=>e.reduce(((e,t)=>e.then((e=>d.importMidToScore(t).then((t=>(e.push(t),e)))))),Promise.resolve([])))).then((e=>{i.value=e})).catch((e=>v(e?.errorCode||e)))})).finally((()=>{h.isInBackground=!1}))},applyVoiceModelToVoiceRegion:function(t,n,r){const i="max tracks detected",a="max length detected",s=zn((()=>import("./chunk-1689dc16.js"))),l=Vt("Created"),c=Date.now(),u=t.sampleId,d=f.current.samples.find((e=>e.id===u));let p;const h=ad(),g=ad(),v=m.createRegion({...t,id:ad(),name:r,sampleId:h,trackId:g}),b={id:h,buffer:{duration:0}};let y,w=!1;return new Promise(((r,m)=>{return f.current.tracks.length>=JS.TRACKS_LIMIT?k(i):d.buffer.duration>300?k(a):(_g(s,{title:"Voice Transfer",status:l,states:VH,retryFn:$,cancelFn:function(){clearTimeout(y),w=!0,e.eventTrack("voice_transfer_complete",{platform:"firebase",platforms:["amplitude","braze"],params:{processed_sample_id:h,original_sample_id:u,model_id:n,processing_time_ms:Date.now()-c,result:"canceled",sample_duration:Cs(d.buffer.duration,.1)}}),m()}},{overlayClose:!1}),$());async function $(){l.value="Created",t.isProcessing=!0,t.sampleId=null,p=p||await Sh(d.buffer),w&&m("Cancelled"),function(e,t,n){const o=new FormData;return o.append("audio",e,t),o.append("voice_id",n),Uu.post("https://voice-transfer.bandlab.io/v1/transfer",{body:o}).json()}(p,`${t.name}.wav`,n).then((e=>{let{taskId:t}=e;return w&&m("Cancelled"),function(e){return new Promise(((t,n)=>{!function o(){var r;w&&n("Cancelled"),(r=e,Uu.get(`https://voice-transfer.bandlab.io/v1/transfer/${r}`).json()).then((r=>{"Completed"===r.status?t(e):"Failed"===r.status||r.error?n(r.error?.errorCode):y=setTimeout((()=>{o()}),2e3)})).catch((e=>{n(e)}))}()}))}(t)})).then((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return l.value="Processing",t=e,Uu.get(`https://voice-transfer.bandlab.io/v1/transfer/${t}/download`).blob().then((e=>e.arrayBuffer()));var t})).then((e=>ch(e))).then((t=>{w&&m("Cancelled"),f.current.samples.push(b),b.buffer=t,e.eventTrack("voice_transfer_complete",{platform:"firebase",platforms:["amplitude","braze"],params:{processed_sample_id:h,original_sample_id:u,model_id:n,processing_time_ms:Date.now()-c,result:"success",sample_duration:Cs(d.buffer.duration,.1)}}),r({...v,trackId:g})})).catch((e=>{"Cancelled"!==e&&k(e)}))}function k(r){t.sampleId=u;const p=r===i||r===a||r===Gz.AUDIO_SILENCE;let f,g="Unable to apply Voice Transfer. Please try again later.";r===i?(f="Track limit reached",g="Please remove some tracks and try Voice Transfer again."):r===a?(f="Sample is too long",g="Please ensure that your audio sample is under 5 minutes in duration."):r===Gz.AUDIO_SILENCE&&(f="Oops! Not quite a human voice",g="Try using another one or consider Voice Cleaner for vocals in mixed tracks."),e.eventTrack("voice_transfer_complete",{platform:"firebase",platforms:["amplitude","braze"],params:{processed_sample_id:h,original_sample_id:u,model_id:n,processing_time_ms:Date.now()-c,result:"fail",sample_duration:Cs(d.buffer.duration,.1)}}),p?(Pg(s),o.addNotification({title:f,content:g,image:"https://www.bandlab.com/web-app/images/settings/notifications-warning-6c1f2da96b.svg",autoclose:8e3}),m(r)):l.value="Failed"}})).finally((()=>{t.sampleId=u,t.isProcessing=!1,clearTimeout(y),Pg(s)}))},areRegionsOverlapping:function(e,t){return P(e,t)||M(e,t)||T(e,t)||C(e,t)},cleanRevision:function(e){const t=y.getBanks(),n=new Set;return L(e),e.tracks.forEach((function(o){o.canEdit=!o.preset||"custom"===o.preset||!!g.getBySlug(o.preset),o.canEdit||n.add(o.sampleId),I(o),o.regions.forEach((function(t){t.endPosition>JS.SONG_DURATION_MAX&&(t.endPosition=JS.SONG_DURATION_MAX),t.playbackRate=t.playbackRate||1,t.pitchShift=t.pitchShift||0,t.gain=null===t.gain?1:t.gain,t.bpm=e.metronome.bpm||120,t.canEdit=o.canEdit,t.canEdit&&n.add(t.sampleId)})),o.colorName="Pink"===o.colorName?"Orange":o.colorName||zs[0].name,o.color=s.colorNameToColorHex(o.colorName),o.automation={pan:[],volume:[],...o.automation},o.preset=g.getBySlug(o.preset)||!o.canEdit?o.preset:o.effects&&(o.effects.length||o?.effectsData?.originalPresetId)?"custom":Vs.slug,o.effects=!o.effects||!o.effects.length&&"custom"!==o.preset&&o.canEdit?_.cloneDeep(g.getBySlug(o.preset).effects):o.effects,o.effects.forEach((function(e){e.id=ad(),x(e)})),A(o),o.soundbank&&!_.find(t,{slug:o.soundbank})&&(o.soundbank=al),o.type===Ks&&o.patterns.forEach((e=>{let{sampleId:t}=e;return n.add(t)})),o.type=m.getTrackType(o),w(o,e),o.auxSends=o.auxSends.length?o.auxSends:new Wl,0===o.autoPitch?.targetNotes.length&&(o.autoPitch.targetNotes=yL),o.autoPitch&&(o.autoPitch.version??="0.0"),o.channel=1})),e.samples.forEach((e=>{QS[e.id]=!0})),e.samples=e.samples.filter((e=>n.has(e.id))),e.mastering=null,e.masteringSetting="auto",e.auxChannels=e.auxChannels.length?e.auxChannels:new Bl,e.auxChannels.forEach((function(e){e.preset=g.getBySlug(e.preset)?e.preset:Fl,e.effects=e.effects&&e.effects.length?e.effects:_.cloneDeep(g.getBySlug(e.preset).effects)})),(e.samplerKits?.samples??[]).forEach((function(e){QS[e.id]=!0})),e},createDrumMachineRegion:function(e,t,n,o){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4;l.pushUndo(f.current);const i=$s(f.current.metronome),s=Fz(n.length,f.current.metronome.bpm),c=o+s*(i*r/s),u=m.createRegion({endPosition:c,isPlayable:!0,loopLength:s,sampleId:t,startPosition:o,trackId:e.id});return u.endPosition>JS.SONG_DURATION_MAX&&(u.endPosition=JS.SONG_DURATION_MAX,q()),f.selectedRegions.add(u),e.regions.push(u),j(e),a.addSnapshot(f.current.id,f.current),u},createEmptyRegion:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};l.pushUndo(f.current);var n=f.current.metronome,o=d.createScore(),r=t.time??h.crTime,i=t.endTime??Math.min(r+4*$s(n),JS.SONG_DURATION_MAX),c=m.createRegion({endPosition:i,isPlayable:s.isRegionPlayable({sampleId:o.id},e),name:e.name,sampleId:o.id,startPosition:r,trackId:e.id,...t});return f.selectedRegions=new Set([c]),e.regions.push(c),j(e),a.addSnapshot(f.current.id,f.current),c},createRegionFromAudioBuffer:N,createRegionFromAudioFile:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h.crTime,o=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;var s=ad();return e.arrayBuffer().then(ch).then((function(l){l.id=s,l.name=e.name;var c=N(t,l,n,n+(o??l.duration),r);return a.updateFile({blob:e,sampleId:s}),i.scheduleSampleUpload(e,s),{region:c,audioBuffer:l}})).catch((function(){throw new Error(`Unable to process audio for ${e.name}`)}))},createRegionFromMidiScore:F,createRegionPlaceholder:B,createSampleFromAudioLoopURL:function(e){return fetch(e.original.audioUrl,{cache:"no-cache"}).catch((function(e){return e.message="Check your internet connection and try again",Promise.reject(e)})).then((function(e){return e.arrayBuffer()})).then(ch).then((function(t){return QS[e.id]=!0,t.id=e.id,t}))},createSampleFromPremiumAudioLoopUrl:function(e){const t=ad();return fetch(e.original.audioUrl,{cache:"no-cache"}).then((function(e){return Promise.all([e.clone().arrayBuffer(),e.clone().blob()])})).then((function(e){let[n,o]=e;return a.updateFile({blob:o,sampleId:t}),i.scheduleSampleUpload(o,t),ch(n)})).then((function(e){return e.id=t,e}))},deleteRegionsFromTracks:U,downloadRegionAsFile:function(e,t){const n=c.pushTask("export"),o=p.makeMixdown(null,[e]).then((function(n){let{blob:r}=n;const i=Lh(e.name||t.name);f.mixingTasks.includes(o)&&Kh(r,i)})).finally((function(){c.finishTask(n)}));f.mixingTasks.push(o)},expandRegionLoop:function(e,t,n){let{delta:o,endPosition:r,firstTrack:i,loopLength:a,scalePx:l,startPosition:c}=t;e.loopLength||(e.loopLength=s.getFirstLoopDuration(e));var u=r-o/l;e.endPosition=u,O(e,{delta:o,endPosition:r,firstTrack:i,loopLength:a,scalePx:l,startPosition:c,alterLoopLength:!1},n)},exportCycleSelectionToMidi:function(){const{startTime:e,endTime:n}=r.get(),o=function(e,t,n){const o=JSON.parse(JSON.stringify(e));return o.tracks.forEach((function(e){e.regions.forEach((function(n){t-n.startPosition>Vl&&n.endPosition-t>Vl&&S(n,t,t,e.regions)})),e.regions.forEach((function(t){n-t.startPosition>Vl&&t.endPosition-n>Vl&&S(t,n,n,e.regions)})),e.regions=e.regions.filter((function(e){return e.startPosition>=t&&e.endPosition<=n})).map((function(e){return{...e,startPosition:e.startPosition-t,endPosition:e.endPosition-t}}))})),o}(f.current,e,n);return Ix(t,o).then((function(t){let{blob:o}=t;Kh(o,[f.current.song.id,[z(e,f.current.metronome).join("."),z(n,f.current.metronome).join(".")].join("-"),"mid"].join("."))}))},fixDuplicateIds:L,fixEffectParameters:A,fixMissingEffectParameters:x,fixRegionFades:R,generateMidiRegionFromAudioRegion:function(t,n){const r="max tracks detected",i="in use detected",a=zn((()=>import("./chunk-1689dc16.js"))),s=Vt("voice"===n?"Created":"Processing"),l=Vt(""),c=Date.now(),u=t.sampleId,p=f.current.samples.find((e=>e.id===u));let h;const g=ad(),v=ad(),b=m.createRegion({endPosition:t.endPosition,startPosition:t.startPosition,loopLength:t.loopLength,name:t.name||"",sampleId:g,trackId:v});let y,w;return new Promise(((m,v)=>{return f.current.tracks.length>=JS.TRACKS_LIMIT?_(r):p.buffer.duration>300?_(rG.TOO_LONG):p.buffer.duration<.5?_(rG.TOO_SHORT):(_g(a,{title:"Audio-to-MIDI",status:s,states:"voice"===n?BH:WH,retryFn:$,cancelFn:function(){var o;Pg(a),t.sampleId=u,t.isProcessing=!1,s.value="Cancelled",e.eventTrack("audio_to_midi_complete",{platform:"firebase",platforms:["amplitude","braze"],params:{type:n,processed_sample_id:g,original_sample_id:u,processing_time_ms:Date.now()-c,result:"canceled",sample_duration:Cs(p.buffer.duration,.1)}}),y&&"voice"===n&&(o=y,Uu.delete(`https://voice2midi.bandlab.io/v1/task/${o}`).json()),v()},overwriteFailedMessage:l,..."instrument"===n?{overwriteRate:1e3*p.buffer.duration/100}:{}},{overlayClose:!1}),$());async function $(){s.value="voice"===n?"Created":"Processing",t.isProcessing=!0,t.sampleId=null,l.value=null,h=h||await Sh(p.buffer),"voice"===n?await function(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;const i=new FormData;return i.append("file",e,t),i.append("tempo",n.toString()),i.append("play_rate",o.toString()),i.append("pitch_shift",r.toString()),Uu.post("https://voice2midi.bandlab.io/v1/task",{body:i}).json()}(h,p.name,t.bpm||f.current.metronome.bpm,t.playbackRate,t.pitchShift).then((e=>{let{taskId:t}=e;"Cancelled"!==s.value&&(y=t,k())})).catch((e=>{_(429===e?.response?.status?i:e)})):await async function(e,t,n,o){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return new Promise(((a,s)=>{const l=new Worker("https://www.bandlab.com/web-app/common/workers/madonnaWorker-5f354c91cc.js");l.onerror=function(e){s(e)},l.onmessage=async function(e){e.data&&e.data.output?a(new Blob([e.data.output],{type:"audio/midi"})):s(e.data?.err),l.terminate()},oG().then((a=>{let[s,c]=a;l.postMessage({scriptUrl:s,modelView:c,wavData:e,midiPath:t,sampleRate:n,tempo:o,pitchShift:i,playRate:r})}))}))}(function(e){const t=e.getChannelData(0).length,n=new Float32Array(t);for(let o=0;o<e.numberOfChannels;o++){const r=e.getChannelData(o);for(let e=0;e<t;e++)n[e]=0===o?r[e]:(r[e]+n[e])/2}return n}(p.buffer),`${p.name}.mid`,lh().sampleRate,t.bpm||f.current.metronome.bpm,t.playbackRate,t.pitchShift).then((e=>S(e))).catch((e=>{_(+e)}))}function k(){return(e=y,Uu.get(`https://voice2midi.bandlab.io/v1/task/${e}`).json()).then((e=>{if("Cancelled"!==s.value)switch(s.value=e.status,e.status){case"Ready to download":return function(e){return Uu.get(`https://voice2midi.bandlab.io/v1/task/${e}/download`).blob()}(y).then((e=>S(e)));case"Failed":if(e.error?.errorCode)return _(e.error.errorCode);break;case"Processing":case"Created":w=setTimeout(k,1e3)}})).catch((e=>{_(e.message)}));var e}function S(o){return d.getMidiExcerptScore(o,g,t.sampleOffset,t.endPosition-t.startPosition+t.sampleOffset).then((()=>{t.sampleId=u,Pg(a),t.isProcessing=!1,e.eventTrack("audio_to_midi_complete",{platform:"firebase",platforms:["amplitude","braze"],params:{type:n,processed_sample_id:g,original_sample_id:u,processing_time_ms:Date.now()-c,result:"success",sample_duration:Cs(p.buffer.duration,.1)}}),m(b)})).catch((e=>{_(e)}))}function _(d){t.sampleId=u;const f=d===r||d===rG.TOO_SHORT||d===rG.TOO_LONG||d===rG.TOO_SOFT||d===rG.TOO_MANY_NOTES||d===rG.TOO_MANY_NOTE_OFFS||d===rG.TEMPO_OUT_OF_RANGE;let h,y;f&&Pg(a),d===r?(h="Track limit reached",y="Please remove some tracks and try AudiotoMIDI again."):d===rG.TOO_SHORT?(h="Sample is too short",y="Ensure your sample is at least 0.5 seconds long and try AudiotoMIDI again."):d===rG.TOO_LONG?(h="Sample is too long",y="Please ensure that your audio sample is under 5 minutes in duration."):d!==rG.TOO_MANY_NOTES&&d!==rG.TOO_MANY_NOTE_OFFS||(h="Oops! Not quite a human voice",y="Try using another one or consider Voice Cleaner for vocals in mixed tracks."),t.isProcessing=!1,e.eventTrack("audio_to_midi_complete",{platform:"firebase",platforms:["amplitude","braze"],params:{type:n,processed_sample_id:g,original_sample_id:u,processing_time_ms:Date.now()-c,result:"fail",sample_duration:Cs(p.buffer.duration,.1)}}),d!==rG.TOO_SOFT?f?(o.addNotification({title:h,content:y,image:"https://www.bandlab.com/web-app/images/settings/notifications-warning-6c1f2da96b.svg",autoclose:8e3}),s.value="Cancelled",v()):(d===i&&(l.value="AudiotoMIDI is already running for your account. Please wait for completion."),s.value="Failed"):m(b)}})).finally((()=>clearTimeout(w)))},mergeAudioRegions:function(e,t,n){const o=_.minBy(t,"startPosition"),r=_.maxBy(t,"endPosition");f.selectedRegions.clear();const s=B(n,{duration:r.endPosition-o.startPosition,fadeIn:o.fadeIn,fadeOut:r.fadeOut},o.startPosition);t.forEach((function(e){e.fadeIn=0,e.fadeOut=0})),h.isMixing=!0;const c=p.makeMixdown(null,t);return U(e,t),c.then((function(e){let{arrayBuffer:t,blob:n}=e;return ch(t).then((function(e){return{blob:n,buffer:e}}))})).then((function(e){e.buffer.id=ad(),W(s.sampleId,e.buffer),h.isMixing=!1,a.updateFile({blob:e.blob,sampleId:e.buffer.id}),i.scheduleSampleUpload(e.blob,e.buffer.id)})).catch((function(e){return l.undo(f.current),Promise.reject(e)}))},mergeMidiRegions:function(e,t,n,o){var r=d.mergeScore(t,o,!0),i=_.minBy(t,"startPosition").startPosition,a=_.maxBy(t,"endPosition").endPosition,l=m.createRegion({endPosition:a,isPlayable:s.isRegionPlayable({sampleId:r.id},e[0]),name:e.name,sampleId:r.id,startPosition:i,trackId:e[0].id});return f.selectedRegions.clear(),f.selectedRegions.add(l),U(e,t),n.regions.push(l),j(n),l},moveRegion:function(e,t,n,o){let{delta:r,firstPosition:i,firstRegionSnapped:a,firstTrack:l,lastPosition:c,scalePx:u,startPositions:d}=n;const p=e.endPosition-e.startPosition,m=d[e.id];let f=Math.max(m+r/u,m-i);f=Math.min(f,m+JS.SONG_DURATION_MAX-c);let g=s.snapToEndRegion({id:e.id,startPosition:f},l,u);return 0!==t?f+=a:s.snapToPlayhead(f,u)?(a=h.crTime-f,f=h.crTime):0!==g?(a=g,f+=g):(g=s.snapToGrid(f,o.snapDuration,{padding:5/u}),a=g-f,f=g,f>JS.SONG_DURATION_MAX-p&&(f-=a,a=0)),e.startPosition=Math.min(f,JS.SONG_DURATION_MAX-p),e.endPosition=Math.min(f+p,JS.SONG_DURATION_MAX),a},moveRegions:j,recomposeMidiRegion:function(t,r){h.isAiComposingRegion=!0;const i=Date.now(),a=t.sampleId,l=t.loopLength,c=Cs(s.getFirstLoopDuration(t)/$s(f.current.metronome),.01),u=ad();let m;const g=Vt("Processing"),v=Vt(""),b="max bars detected",y=zn((()=>import("./chunk-1689dc16.js")));return new Promise(((s,w)=>{if(c>64)return C(b);const $=t.startPosition,k=l?t.startPosition+t.loopLength:t.endPosition,S=z($,f.current.metronome),_=parseFloat(`${S[0]}.${S[1]}`),P=z(k,f.current.metronome),M=parseFloat(`${P[0]}.${P[1]}`);return _g(y,{title:"Recompose",status:g,states:zH,retryFn:T,cancelFn:function(){g.value="Cancelled",V(t,a),h.isAiComposingRegion=!1,Pg(y),e.eventTrack("smart_recompose_complete",{platform:"firebase",platforms:["amplitude","braze"],params:{original_sample_id:a,processing_time_ms:Date.now()-i,result:"canceled",bars:c,is_looped:0!==l,instrument_type:f.selectedTrack.type}}),s()},overwriteFailedMessage:v},{overlayClose:!1}),T();async function T(){return g.value="Processing",v.value=null,m=m||await p.renderToMidi(r).then((e=>{let{blob:t}=e;return t})),t.isProcessing=!0,t.sampleId=null,n.$applyAsync(),function(e,t,n){const o=new FormData;return o.append("file",e),o.append("start_bar_beat",t.toString()),o.append("end_bar_beat",n.toString()),Uu.post("https://compose.bandlab.io/v1/remix",{body:o}).blob().catch((function(e){if(e instanceof Uc)return e.response.json().then((function(e){throw e}));throw new Error}))}(m,_,M).then((e=>d.getMidiExcerptScore(e,u,$,k))).then((()=>{"Cancelled"!==g.value&&(V(t,u,!0),h.isAiComposingRegion=!1,Pg(y),e.eventTrack("smart_recompose_complete",{platform:"firebase",platforms:["amplitude","braze"],params:{processed_sample_id:u,original_sample_id:a,processing_time_ms:Date.now()-i,result:"success",bars:c,is_looped:0!==l,instrument_type:f.selectedTrack.type}}),s())})).catch((e=>{C(e?.errorCode||e)}))}function C(n){if(V(t,a),e.eventTrack("smart_recompose_complete",{platform:"firebase",platforms:["amplitude","braze"],params:{original_sample_id:a,processing_time_ms:Date.now()-i,result:"fail",bars:c,is_looped:0!==l,instrument_type:f.selectedTrack.type}}),n===b||n===QH.EMPTY_MIDI||n===QH.INVALID_MIDI){let e;Pg(y),h.isAiComposingRegion=!1;let t="Unable to apply Recompose. Please try again later.";return n===b?(e="MIDI is too long",t="Trim your MIDI to be within 64 bars and try again."):n===QH.EMPTY_MIDI?(e="Chirp, Chirp!",t="Make sure your MIDI file has musical content and is not empty."):n===QH.INVALID_MIDI&&(e="Check Your File Format",t="Please ensure youre using a valid MIDI file (.mid)."),o.addNotification({title:e,content:t,image:"https://www.bandlab.com/web-app/images/settings/notifications-warning-6c1f2da96b.svg",autoclose:5e3}),void w()}n===QH.ERROR_IN_USE&&(v.value="Recompose is already running for your account. Please wait until it is completed."),g.value="Failed"}}))},resizeFirstLoop:function(e,t,n){let{delta:o,loopLength:r,scalePx:i,startPosition:a}=t;var l,c;c=r-o/i,n.isTimeRuler||(c-=(l=e.startPosition+c)-s.snapToGrid(l,n.snapDuration,{padding:5/i})),c=Math.max(c,Vl),e.loopLength=c,s.getExtraLoopDuration(e)||(e.endPosition=a+e.loopLength)},resizeRegionLeft:function(e,t,n){let{delta:o,endPosition:r,loopLength:i,sampleOffset:a,scalePx:l,startPosition:c}=t;var u=0,d=(c*l-o)/l,p=a*l-o;if(!(r-d<Vl))return d<0?(e.startPosition=Math.max(0,c-a),e.sampleOffset=Math.max(0,a-c),void(i&&(e.loopLength=i+c-e.startPosition))):p<0?(e.startPosition=c-a,e.sampleOffset=0,void(i&&(e.loopLength=i+a))):void(i&&(e.loopLength=i+o/l,e.loopLength<Vl)?e.loopLength=Vl:(e.startPosition=d,s.snapToPlayhead(e.startPosition,l)?(u=e.startPosition-h.crTime,e.startPosition=h.crTime):(u=e.startPosition-s.snapToGrid(e.startPosition,n.snapDuration,{padding:5/l}),e.startPosition-=u),e.startPosition=Math.min(e.startPosition,e.endPosition-Vl),e.sampleOffset=p?p/l-u:e.sampleOffset-u,e.sampleOffset=Math.max(e.sampleOffset,0),e.loopLength&&(e.loopLength+=u)))},resizeRegionRight:O,sanitize:function(t){(function(e){e.metronome.bpm=Math.round(e.metronome.bpm)})(t),function(t){(t.metronome.bpm<40||t.metronome.bpm>240)&&e.eventTrack("Out-of-range BPM value",{category:"Debug",label:t.song?.id??t.creator?.id}),t.metronome.bpm=As(t.metronome.bpm,40,240)}(t),L(t),function(t){t.tracks.length>el&&(t.tracks=t.tracks.slice(0,el),e.eventTrack("Number of tracks exceeded",{category:"Debug",label:t.song?.id??t.creator?.id}))}(t),t.tracks.forEach((n=>{n.regions.forEach(D),I(n),function(e){e.canEdit&&(e.regions=_.filter(e.regions,(function(t){var n;return u.has(t.sampleId)?e.type===Ks||d.getExactDuration(t.sampleId,f.current.metronome.bpm)>0:(n=_.find(f.current.samples,{id:t.sampleId}))&&!n.error})))}(n),E(n),function(e){e.regions.forEach((function(e){e.sampleOffset<5e-4&&(e.sampleOffset=0)}))}(n),function(e){_.forEach(e.regions,(function(e){e.loopLengh<.001&&(e.loopLength=0)}))}(n),R(n),function(e){_.forEach(e.regions,(function(e){delete e.takes}))}(n),function(e){const t=(e.patterns??[]).slice().reverse().findIndex((function(t){return u.get(t.sampleId).notes.length>0||e.regions.map((e=>e.sampleId)).includes(t.sampleId)}));e.patterns=-1===t?[]:e.patterns.slice(0,e.patterns.length-t)}(n),function(t,n){t.auxSends.length>1&&(t.auxSends=t.auxSends.slice(0,1),e.eventTrack("auxSends length exceeded",{category:"Debug",label:n.song?.id??n.creator?.id}))}(n,t),function(t,n){t.effects.length>v.effectsJson.effectsUI.maxEffectsPerChain&&(t.effects=t.effects.slice(0,v.effectsJson.effectsUI.maxEffectsPerChain),e.eventTrack("Effect chain length exceeded",{category:"Debug",label:n.song?.id??n.creator?.id}))}(n,t),A(n),function(e){e.automation&&(e.automation={...e.automation,pan:_.sortBy(_.uniqBy(_.map(e.automation.pan,(function(e){let{value:t,position:n}=e;return{position:As(n,0,JS.SONG_DURATION_MAX),value:As(t,-1,1)}})),"position"),"position"),volume:_.sortBy(_.uniqBy(_.map(e.automation.volume,(function(e){let{value:t,position:n}=e;return{position:As(n,0,JS.SONG_DURATION_MAX),value:As(t,0,2)}})),"position"),"position")})}(n),function(e){e.pan=As(e.pan,-1,1)}(n),function(t,n){s.isAudioTrack(t)&&t.soundbank&&(t.soundbank=null,e.eventTrack("Soundbank prop exists on non-MIDI track",{category:"Debug",label:n.song?.id??n.creator?.id}))}(n,t),function(e){e.volume=As(e.volume,0,2)}(n),function(e){if(e.autoPitch?.targetNotes.length){const t=bL,n=new Set(e.autoPitch.targetNotes),o=t.find((t=>{let{scale:n,tonic:o}=t;return n===e.autoPitch.scale&&o===e.autoPitch.tonic}));if(o)return void(e.autoPitch.targetNotes=o.notes);const r=t.find((e=>{let{notes:t}=e;return t.length===n.size&&t.every((e=>n.has(e)))}));if(r)return e.autoPitch.scale=r.scale,e.autoPitch.targetNotes=r.notes,void(e.autoPitch.tonic=r.tonic);e.autoPitch.scale="scale_chromatic",e.autoPitch.targetNotes=[],e.autoPitch.tonic="tonic_undefined"}}(n),w(n,t)}))},splitRegion:S,stretchRegionLeft:function(e,t,n){let{delta:o,endPosition:r,loopLength:i,playbackRate:a,sampleOffset:l,scalePx:c,startPosition:u}=t;var d=0,p=u-o/c;const m=(r-u)*Math.abs(a);if(r-p<Vl||r-p<=.1*m||r-p>=10*m)return;if(e.startPosition=p,e.startPosition<0)return e.startPosition=Math.max(0,u-l),e.sampleOffset=Math.max(0,l-u),void(i&&(e.loopLength=i+u-e.startPosition));s.snapToPlayhead(e.startPosition,c)?(d=e.startPosition-h.crTime,e.startPosition=h.crTime):(d=e.startPosition-s.snapToGrid(e.startPosition,n.snapDuration,{padding:5/c}),e.startPosition-=d),e.startPosition=Math.min(e.startPosition,e.endPosition-Vl);const f=(e.endPosition-e.startPosition)/(r-u);e.loopLength=i*f,e.sampleOffset=l*f,e.playbackRate=a/f},stretchRegionRight:function(e,t,n){let{delta:o,endPosition:r,firstTrack:i,loopLength:a,playbackRate:l,sampleOffset:c,scalePx:u,startPosition:d}=t;var p,m=r-o/u;const f=(r-d)*Math.abs(l);if(m-d<Vl||m-d<=.1*f||m-d>=10*f)return;e.endPosition=m,s.snapToPlayhead(e.endPosition,u)?e.endPosition=h.crTime:(p=n.isTimeRuler?0:s.snapToGrid(e.endPosition,n.snapDuration,{delta:!0,padding:5/n.scalePx}),e.endPosition+=s.closestSnapPosition([p,s.snapToStartRegion(e,i,u),s.snapToLoopLength(e,u)])),e.endPosition=Math.max(e.endPosition,e.startPosition+Vl),e.endPosition=Math.min(e.endPosition,JS.SONG_DURATION_MAX);const g=(e.endPosition-e.startPosition)/(r-d);e.loopLength=a*g,e.playbackRate=l/g,e.sampleOffset=c*g},updateRegionPlaceholder:W,warnDeletedRegions:function(){o.addNotification({title:"Regions less than 50 ms will be deleted.",autoclose:5e3})},warnTruncatedRegions:q};function w(t,n){t.type!==Ks||t.soundbank||(t.soundbank="808-kit",e.eventTrack("Soundbank missing for Drum Machine track",{category:"Debug",label:n.song?.id??n.creator?.id}))}function $(e,t,n){var o=_.clone(e),r=e.endPosition,i=(t-e.startPosition)/e.loopLength;o.id=ad(),e.loopLength?(e.sampleOffset+=t-e.startPosition-Math.floor(i)*e.loopLength,k(e,e.startPosition+Math.ceil(i)*e.loopLength),e.startPosition=t,o.startPosition=e.endPosition,e.endPosition>r?e.endPosition=r:n.push(o)):(e.sampleOffset+=t-e.startPosition,e.startPosition=t)}function k(e,t){e.endPosition=t}function S(e,t,n,o){var r,i=_.clone(e),a=_.clone(e),s=[];return i.id=ad(),a.id=ad(),e.fadeOut=0,i.fadeIn=0,a.fadeIn=0,i.isProcessing=!1,a.isProcessing=!1,e.loopLength?(r=(t-e.startPosition)/e.loopLength,k(i,e.startPosition+Math.ceil(r)*e.loopLength),r=(n-e.startPosition)/e.loopLength,i.startPosition=n,i.sampleOffset=Math.max(i.sampleOffset+(n-e.startPosition)-Math.floor(r)*e.loopLength,0),k(i,e.startPosition+Math.ceil(r)*e.loopLength),i.endPosition>i.startPosition&&(o.push(i),s.push(i)),a.startPosition=i.endPosition,a.endPosition>a.startPosition?(i.fadeOut=0,o.push(a),s.push(a)):i.endPosition=e.endPosition,k(e,t)):($(i,n),k(e,t),o.push(i),s.push(i)),s.unshift(e),R({regions:o}),s}function P(e,t){return t.startPosition<e.endPosition&&t.endPosition>e.endPosition}function M(e,t){return t.startPosition<e.startPosition&&t.endPosition>e.startPosition}function T(e,t){return t.startPosition<e.startPosition&&t.endPosition>e.endPosition}function C(e,t){return t.startPosition>=e.startPosition&&t.endPosition<=e.endPosition}function E(e){e.regions=_.filter(e.regions,(function(e){return e.endPosition-e.startPosition>=Vl}))}function I(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.regions,n=0;for(;t[n];){for(const s of t.slice(n+1))o=[t[n],s],r=e.regions,void 0,void 0,C(i=o[0],a=o[1])?function(e,t){t.splice(t.indexOf(e),1)}(o[1],r):T(i,a)?S(a,i.startPosition,i.endPosition,r):P(i,a)?$(a,i.endPosition,r):M(i,a)&&k(a,i.startPosition);n++}var o,r,i,a}function R(e){function t(e){return Math.round(e*Bs)}function n(e){return e/Bs}_.forEach(e.regions,(function(e){let o=t(Math.max(0,e.fadeIn??0)),r=t(Math.max(0,e.fadeOut??0));const i=o+r,a=t(e.endPosition)-t(e.startPosition);i>a&&(o=Math.round(o/i*a),r=Math.round(r/i*a)),e.fadeIn=n(Math.min(o,a)),e.fadeOut=n(Math.min(r,a));const s=1e-4;e.fadeIn<s&&(e.fadeIn=0),e.fadeOut<s&&(e.fadeOut=0)}))}function A(e){e.effects=_.map(e.effects,(function(t){return t.params=_.reduce(t.params,(function(n,o,r){const i=v.metadata[t.slug].params[r];return i?("float"===i.type?(o=parseFloat(o),o=isNaN(o)?i.default:o,o=Math.max(Math.min(o,i.max),i.min)):"enum"===i.type&&(o=_.get(_.find(i.values,{slug:o}),"slug",i.default)),n[r]=o,t.params[r]!==n[r]&&Sentry.onLoad((function(){Sentry.captureException("Found incorrect value for effect parameter",{extra:{expected:n[r],found:t.params[r],parameter:r,track:e}})})),n):n}),{}),x(t),t}))}function x(e){e.automation??={},Object.entries(v.metadata[e.slug].params).forEach((function(t){let[n,o]=t;o.visible&&!(n in e.params)&&(e.params[n]=o.default),o.automatable&&!(n in e.automation)&&(e.automation[n]=[])}))}function L(e){const t=new Set,n=new Set;e.tracks=e.tracks.map((function(o){let{...r}=o;return t.has(r.id)&&(Sentry.onLoad((function(){Sentry.captureException("Found duplicate track ID",{extra:{revision:e}})})),r.id=ad()),r.regions=r.regions.map((function(t){let{...o}=t;return n.has(o.id)&&(Sentry.onLoad((function(){Sentry.captureException("Found duplicate region ID",{extra:{revision:e}})})),o.id=ad()),o.trackId=r.id,n.add(o.id),o})),t.add(r.id),r}))}function O(e,t,n){let o,{delta:r,endPosition:i,firstTrack:a,loopLength:l,scalePx:c,alterLoopLength:u=!0}=t;e.endPosition=i-r/c,s.snapToPlayhead(e.endPosition,c)?e.endPosition=h.crTime:(o=n.isTimeRuler?0:s.snapToGrid(e.endPosition,n.snapDuration,{delta:!0,padding:5/n.scalePx}),e.endPosition+=s.closestSnapPosition([o,s.snapToLoopLength(e,c),s.snapToStartRegion(e,a,c)])),e.endPosition=Math.max(e.endPosition,e.startPosition+Vl),e.endPosition=Math.min(e.endPosition,JS.SONG_DURATION_MAX),Ws(e.endPosition-e.startPosition)<=Ws(l)&&u&&(e.loopLength=0)}function j(e){const t=e.regions.slice().sort((function(e){return f.selectedRegions.has(e)?-1:1}));I(e,t),E(e),R(e)}function D(e){e.endPosition=Ws(e.endPosition),e.loopLength=Ws(e.loopLength),e.sampleOffset=Ws(e.sampleOffset),e.startPosition=Ws(e.startPosition),e.fadeIn=Ws(e.fadeIn??0),e.fadeOut=Ws(e.fadeOut??0)}function N(e,t,n,o){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;var i=o||n+t.duration,s={id:t.id||ad(),buffer:t,name:t.name},c=m.createRegion({endPosition:i,isPlayable:!e.soundbank,name:t.name,sampleId:s.id,sampleOffset:r,startPosition:n,trackId:e.id});return c.endPosition>JS.SONG_DURATION_MAX&&(c.endPosition=JS.SONG_DURATION_MAX,q()),l.pushUndo(f.current),f.current.samples.push(s),f.selectedRegions.add(c),e.regions.push(c),j(e),a.addSnapshot(f.current.id,f.current),c}function U(e,t){_.forEach(e,(function(e){e.regions=_.difference(e.regions,t)}))}function F(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3?arguments[3]:void 0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;l.pushUndo(f.current);var i=f.current.metronome,c=e.length?Fz(e.length,i.bpm):d.getRoundedDuration(e.id,i.signature,i.bpm),u=o||n+c*r,p=m.createRegion({endPosition:u,isPlayable:s.isRegionPlayable({sampleId:e.id},t),loopLength:r>1?c:null,name:t.name,sampleId:e.id,startPosition:n,trackId:t.id});return p.endPosition>JS.SONG_DURATION_MAX&&(p.endPosition=JS.SONG_DURATION_MAX,q()),f.selectedRegions.add(p),t.regions.push(p),j(t),JS.QUANTIZATION&&t.type!==Ks&&b.quantizeNotesInRegion(16,[p]),a.addSnapshot(f.current.id,f.current),p}function B(e,t,n,o,r){l.pushUndo(f.current);var i=o||n+t.duration,a=m.createRegion({endPosition:i,fadeIn:t.fadeIn,fadeOut:t.fadeOut,isPlayable:!1,isProcessing:!0,loopLength:r,name:t.name,pitchShift:t.pitchShift,playbackRate:t.playbackRate,sampleId:ad(),startPosition:n,trackId:e.id});return a.endPosition>JS.SONG_DURATION_MAX&&(a.endPosition=JS.SONG_DURATION_MAX,q()),f.selectedRegions.add(a),e.regions.push(a),j(e),a}function W(e,t){var n={buffer:t,id:t.id,isMidi:t.isMidi,name:t.name};f.current.samples.push(n),l.rewritePlaceholder(e,n,f.current)}function V(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=f.current.tracks.flatMap((e=>e.regions)).find((t=>t.id===e.id));o&&(n&&(o.sampleOffset=0),o.sampleId=t),GS.forEach(((o,r)=>{o.id===e.id&&(n&&(r.sampleOffset=0),r.sampleId=t)}))}function q(){o.addNotification({title:`Regions over ${JS.SONG_DURATION_MAX/60} minutes will be trimmed.`,autoclose:5e3})}function z(e,t){const n=e/$s(t)+1,o=(n-Math.floor(n))*t.signature.notesCount+1;return[`${Math.floor(Math.max(n,0))}`.padStart(3,0),Math.floor(o)]}}]);const iG={class:"ds-modal ds-modal-size-small"},aG=bi("img",{src:"https://www.bandlab.com/web-app/images/mix-editor/studio-32-track-promo-4fd5c5049d.png",alt:"32 Track Promo Image"},null,-1),sG={class:"ds-modal-header"},lG={class:"ds-modal-title"},cG={class:"ds-modal-content"},uG={class:"ds-modal-content-p studio-32-track-promo-desc"},dG={class:"ds-modal-footer ds-modal-footer-one-button"},pG=Vn({__name:"MixEditorTrackLimitPromoModal",props:{onClickCta:{type:Function}},emits:["closeModal"],setup(e,t){let{emit:n}=t;const o=n;return(e,t)=>(si(),pi("section",iG,[aG,bi("header",sG,[bi("h2",lG,me("Unlock 32 tracks in Studio"),1)]),bi("section",cG,[bi("p",uG,me("Get double the track limit with BandLab Membership perk, Backstage Pass. Take this experimental feature for a spin with our 3day free trial."),1)]),bi("footer",dG,[yi(Dd,{color:"yellow",size:"small",type:"button",padding:"default",class:"studio-32-track-promo-cta",onClick:t[0]||(t[0]=()=>{o("closeModal"),e.onClickCta()})},{default:Tn((()=>[ki(me("Try It Free"),1)])),_:1})]),yi(ib,{onClick:t[1]||(t[1]=e=>o("closeModal"))})]))}});angular.module("bandlab.editor").factory("EditorTrack",["$analytics","$q","$rootScope","AppNotifications","ConfirmModal","DrumMachine","DrumMachineState","EditorData","EditorHelper","EditorHistory","EditorLoader","EditorMidiSamples","EditorMixdown","EditorModel","EditorPlayer","EditorRevision","EditorScroll","EditorState","EditorTimeline","EffectsPreset","InputDevice","MidiEditor","Modal","SharedMidiSynth","Soundbank",function(e,t,n,o,r,i,a,s,l,c,u,d,p,m,f,h,g,v,b,y,w,$,k,S,P){var M,T={};const C=function(e){const{getEntriesWithProperty:t,cleanEntries:n,isTrackPropertySet:o,setTrackProperty:r,unsetTrackProperty:i,toggleTrackProperty:a,onSaveRevision:s}=qz("RevisionCollapsedTracksCache",(()=>{gR.start("updateArrangementView",!1,{cleanCollapseData:!1,cleanTrackGroups:!1},!1,!1)})),{getEntriesWithProperty:l,cleanEntries:c,isTrackPropertySet:u,setTrackProperty:d,unsetTrackProperty:p,toggleTrackProperty:m,onSaveRevision:f}=qz("RevisionCollapsedGroupsCache",(()=>{gR.start("updateArrangementView",!1,{cleanCollapseData:!1,cleanTrackGroups:!1},!1,!1)})),h=function(e){return{cleanTrackGroupsData:function(e){e.trackGroups=e.trackGroups.filter((t=>e.tracks.find((e=>t.id===e.trackGroupId)))),e.tracks=e.tracks.map((t=>{const n=e.trackGroups.find((e=>e.id===t.trackGroupId));return t.trackGroupId&&!n&&(t.trackGroupId=void 0),t}))},getGroupData:t,listAvailableGroups:function(e,n){return n?e.trackGroups.filter((o=>{const r=t(e,o.id);return r&&o.id!==n&&r.trackIds.length>0})):e.trackGroups},addTrackToGroupAtIndex:function(n,o,r,i){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const s=t(n,o);if(r.trackGroupId===o||!s)return;const{trackIds:l}=s;i=i<0?l.length:Math.min(l.length,i);const{tracks:c}=n,u=c.findIndex((e=>e.id===r.id));let d=i===l.length?c.findIndex((e=>e.id===l[l.length-1]))+1:c.findIndex((e=>e.id===l[i]));if(d-=u<d?1:0,a&&e(),u!==d){const[e]=c.splice(u,1);c.splice(d,0,e)}r.trackGroupId=o},createGroupFromTrack:function(t,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Group",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Blue";arguments.length>4&&void 0!==arguments[4]&&arguments[4]&&e();const i={id:ad(),name:o,colorName:r};return t.push(i),n.trackGroupId=i.id,i},mergeGroups:function(n,o,r,i){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const s=t(n,o),l=t(n,r);if(o===r||!s||!l)return;i=i<0?s.trackIds.length:Math.min(s.trackIds.length,i),a&&e();const{tracks:c}=n,u=c.findIndex((e=>e.id===l.trackIds[0])),d=c.splice(u,l.trackIds.length),p=i===s.trackIds.length?c.findIndex((e=>e.id===s.trackIds[s.trackIds.length-1]))+1:c.findIndex((e=>e.id===s.trackIds[i]));c.splice(p,0,...d),d.forEach((e=>{e.trackGroupId=s.id}))},moveTrackInGroup:function(n,o,r,i){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const s=t(n,o);if(!s)return;if(r=As(r,0,s.trackIds.length-1),i=As(i,0,s.trackIds.length),r===i)return;a&&e();const{tracks:l}=n,c=l.findIndex((e=>e.id===s.trackIds[r])),[u]=l.splice(c,1),d=i===s.trackIds.length?l.findIndex((e=>e.id===s.trackIds[s.trackIds.length-1]))+1:l.findIndex((e=>e.id===s.trackIds[i]));l.splice(d,0,u)},ungroup:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=t.findIndex((e=>e.id===n));r<0||(o&&e(),t.splice(r,1))},updateGroupColor:function(e,t,n){const o=e.find((e=>e.id===t));o&&(o.colorName=n)},updateGroupName:function(t,n,o){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=t.find((e=>e.id===n));i&&(r&&e(),i.name=o)}};function t(e,t){const n=e.trackGroups.find((e=>e.id===t));return n?{...n,trackIds:e.tracks.filter((e=>e.trackGroupId===n.id)).map((e=>e.id))}:null}}(e),{TRACK_HEIGHT:g,TRACK_COLLAPSED_HEIGHT:v,TRACK_GROUP_HEADER_HEIGHT:b}=zz();return{onSaveRevision:function(e,t){s(e,t),f(e,t)},cleanCollapseData:function(e,t,o){c(e,o),n(e,t)},cleanCollapsedTracksData:n,collapseTrack:r,isTrackCollapsed:o,toggleCollapseTrack:a,uncollapseTrack:i,onSaveRevisionCollapseTracks:s,cleanCollapsedGroupsData:c,collapseGroup:d,isGroupCollapsed:u,toggleCollapseGroup:m,uncollapseGroup:p,onSaveRevisionCollapseGroups:f,...h,toggleCollapseAllTracksInGroup:function(e,t){const n=!o(e.id,t.id),a=h.getGroupData(e,t.trackGroupId);a&&(n?a.trackIds.forEach((t=>r(e.id,t))):a.trackIds.forEach((t=>i(e.id,t))))},getGridHeight:function(e,t){return t.reduce(((t,n)=>(t+=function(e,t){const{kind:n,item:o}=t;return"trackGroup"===n?function(e,t,n){let o=b;return t||(o+=n.reduce(((t,n)=>t+y(e,n.id)),0)),o}(e,o.isCollapsed,o.tracks):y(e,o.id)}(e,n),t)),0)},getTracksSequence:function(e){const{id:t,tracks:n}=e,o=n.reduce(((o,r)=>{const i=h.getGroupData(e,r.trackGroupId);if(i){if(i.trackIds[0]!==r.id)return o;const e=l(t).has(i.id),a=i.trackIds.map((e=>n.find((t=>t.id===e))));o.push({kind:"trackGroup",item:{id:i.id,name:i.name,colorName:i.colorName,tracks:a,isCollapsed:e}})}else o.push({kind:"track",item:r});return o}),[]),r=o.reduce(((e,t)=>{let{kind:n,item:o}=t;if("trackGroup"===n&&(e.push({kind:n,item:o}),!o.isCollapsed)){const t=o.tracks.map((e=>({kind:"track",item:e})));e.push(...t)}return"track"===n&&e.push({kind:n,item:o}),e}),[]);return{trackIdsSorted:o.flatMap((e=>{let{kind:t,item:n}=e;return"trackGroup"===t?n.tracks.map((e=>e.id)):[n.id]})),tracksSequence:r,trackHeadersSequence:o}},getTrackYPosition:function(e,t,n){let o=0;for(const r of t){if("track"===r.kind){if(r.item.id===n)break;o+=y(e,r.item.id)}"trackGroup"===r.kind&&(o+=b)}return o}};function y(e,n){return t(e).has(n)?v:g}}((function(){c.pushUndo(h.current),v.hasRevisionChanges=!0}));return{addTrack:function(e){if(x())throw L(),new Error(wh);(e=angular.extend({order:h.current.tracks.length,pushUndo:!0},e)).pushUndo&&c.pushUndo(h.current),e.type&&!_.find(yl,{slug:e.type})&&delete e.type,e.soundbank&&!_.find(P.getBanks(),{slug:e.soundbank})&&delete e.soundbank;const t=m.createTrack(e);if(v.hasNewTrackHeadUpdate||(t.name=R({name:t.name})),t.type===Ks)return t.patterns=[],Hv(),void i.addDrumMachineTrack(t,e.beatStarter??null);t.type===Zs&&(t.samplerKit={...qs,id:ad()}),h.current.tracks.push(t),f.updateSourcesInTracks();const n=(l.isAudioTrack(t)||l.isSamplerTrack(t))&&h.trackMonitoring.get(h.lastTrack[t.type]);return n&&h.trackMonitoring.set(t,n),A(t),t.order===h.current.tracks.length-1&&g.scrollToBottom(),t},deleteTrack:function(t){const n=h.current.tracks.indexOf(t);-1!==n&&(c.pushUndo(h.current),h.current.tracks.splice(n,1),f.updateSourcesInTracks(),l.refreshTracksOrder(h.current.tracks),t===h.armedTracks[1]?h.armedTracks[1]=null:t===h.armedTracks[2]&&(h.armedTracks[2]=null),t===h.selectedTrack&&(h.selectedRegions.clear(),h.current.tracks.length?A(h.current.tracks[h.current.tracks.length-1]):h.selectedTrack={}),e.eventTrack("Delete Track",{category:"Mix Editor"}),v.hasSoloTrack=s.checkAnySolo(),$.deleteMidiEditor(t.id))},toggleCollapseAllTracksAndGroups:function(e,t){let n;if("track"===e&&(n=C.isTrackCollapsed(h.current.id,t)),"trackGroup"===e&&(n=C.isGroupCollapsed(h.current.id,t)),h.current.tracks.filter((e=>!e.trackGroupId)).forEach((e=>{if(n)return C.uncollapseTrack(h.current.id,e.id);C.collapseTrack(h.current.id,e.id)})),h.current.trackGroups.forEach((e=>{if(n)return C.uncollapseGroup(h.current.id,e.id);C.collapseGroup(h.current.id,e.id)})),h.selectedTrack?.trackGroupId){const e=[...h.selectedRegions].filter((e=>e.trackId!==h.selectedTrack.id));h.selectedRegions=new Set(e),h.selectedTrack={}}},downloadTrackMixdown:function(n){const r=u.pushTask("export"),i=p.makeMixdown(n).then((function(t){h.mixingTasks.includes(i)&&(Kh(t.blob,`${h.current.song.name} - ${n.name}.wav`),e.eventTrack("Export Track",{category:"Mix Editor",label:"wav"}))})).catch((function(e){return o.addNotification({title:"Unable to create Mixdown",content:e.message,classList:"alert",autoclose:5e3}),t.reject(e)})).finally((function(){u.finishTask(r)}));return h.mixingTasks.push(i),i},duplicateTrack:async function(t){if(v.hasMembership||!t.trackGroupId){if(!x()){c.pushUndo(h.current);var n=_.cloneDeep(t);if(n.id=ad(),v.hasNewTrackHeadUpdate||(n.name=R({name:t.name,isDuplicatingTrack:!0})),n.isFrozen=!1,n.isFreezing=!1,_.forEach(n.regions,(function(e){e.id=ad(),e.trackId=n.id})),n.type===Ks){const e=await f.current.getPatternEditor(t.id),o=await e.getAllPatterns(),r=n.patterns.map((async(e,t)=>{const r=ad(),i=await f.current.getSampleMidFileFromVirtualFileSystem(e.sampleId);return await Promise.resolve().then((()=>vL)).then((e=>{let{putMidiBlobIntoVirtualFileSystem:t}=e;return t(r,i)})),n.regions.filter((t=>t.sampleId===e.sampleId)).forEach((e=>{e.sampleId=r})),d.set(r,{id:r,name:"Drum Machine",notes:o[t].score,parentId:!1,trackId:n.id,isSaved:!1}),e.sampleId=r,e}));n.patterns=await Promise.all(r),e.delete()}if(t.trackGroupId){h.current.tracks.push(n);const e=C.getGroupData(h.current,t.trackGroupId);C.moveTrackInGroup(h.current,n.trackGroupId,e.trackIds.indexOf(n.id),e.trackIds.indexOf(t.id)+1,!1)}else{const e=h.current.tracks.findIndex((e=>e.id===t.id));e<0?h.current.tracks.push(n):h.current.tracks.splice(e+1,0,n),l.applyTracksOrder(h.current.tracks),l.refreshTracksOrder(h.current.tracks)}return h.trackMonitoring.set(n,h.trackMonitoring.get(t)),f.updateSourcesInTracks(),e.eventTrack("Duplicate Track",{category:"Mix Editor"}),C.isTrackCollapsed(h.current.id,t.id)&&C.collapseTrack(h.current.id,n.id),n}L()}else o.addNotification({id:"dup-track-in-group",title:"Group editing is a membership feature",content:'<a href="https://www.bandlab.com/membership" target="_blank">Learn more about Membership</a>',autoclose:5e3})},freezeTrack:U,isAddTrackDisabled:function(){const e=h.current.tracks.length>=JS.TRACKS_LIMIT,t=JS.TRACKS_LIMIT<el;return!!e&&!t},isArmed:function(e){return h.armedTracks[1]?.id===e.id?1:h.armedTracks[2]?.id===e.id&&2},moveGroup:function(e,t){const{tracks:n}=h.current,o=n.findIndex((t=>t.id===e.trackIds[0])),r=n.findIndex((t=>t.id===e.trackIds[e.trackIds.length-1])),i=t<0?o:r,a=As(i+t,0,n.length-1);if(i===a)return;if(t<0)return I(o,t);const s=n[a];s.trackGroupId?I(a,-1):E(s,-1)},moveTrack:E,selectPreset:function(t){let{fromCarousel:o=!1,shouldAskConfirmation:i=!0,analyticsExtra:a={}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};function s(){t=_.cloneDeep(t),h.lastTrack[P.getCurrent().input.slug]=h.selectedTrack,n.$broadcast(hT,{displayName:t.name||t.displayName,preset:t.slug,presetId:t.id,presetLink:t.link,effects:t.effects.map((function(e){return e.id=ad(),b.fixMissingEffectParameters(e),e}))})}M||(i&&"custom"!==t.slug&&"custom"===h.selectedTrack.preset&&!_.get(h.selectedTrack,"effectsData.originalPresetId")?(M=new r({cancelLabel:"No",confirmLabel:"Yes",contentScope:{title:"You Have Unsaved Effects",message:"none"===t.slug?"Would you like to save them before deleting the current effects chain?":`<p>Would you like to save them before applying <strong>${t.name||t.displayName}${y.isNewerPreset(h.selectedTrack.preset,t.slug)?" (updated)":""}</strong>?</p>`},onCancel:s,onConfirm:function(){l.displayPresetSettings({toggle:!1}),mI.value=t},onDestroy:function(){M=null}})).show():s(),o||e.eventTrack("Select FX Preset",{category:"Mix Editor",label:`${h.selectedTrack.type} - ${t.name}`,extra:{preset_id:t.id||t.slug,track_type:h.selectedTrack.type,...a}}),n.$applyAsync())},setEffectChainBypass:function(e){h.selectedTrack.effects.forEach((t=>{t.bypass=e})),n.$broadcast(fT,{bypass:e})},setInputSourceFromTrack:B,setInputSourceToTrack:function(e){var t=P.getCurrent();e.soundbank?(e.soundbank!==t.soundbank.slug&&(v.hasRevisionChanges=!0,e.soundbank=t.soundbank.slug,e.type=m.getTrackType(e),f.updateSourcesInTracks()),v.isAudioInputActive=!0):(e.type!==t.input.slug&&(v.hasRevisionChanges=!0),h.lastDevice=w.getCurrent().device,h.lastTrack[e.type]=e)},setSelected:A,shouldNotifyTrackLimit:x,notifyTrackLimit:L,toggleFreeze:function(e){return function(t){t.isFrozen?(c.pushUndo(h.current),F(t)):U(e,t,!0)}},toggleMute:function(t){t.isMuted=!t.isMuted,f.current.setTrackMuted(t,t.isMuted),e.eventTrack("Toggle Mute",{category:"Mix Editor",label:t.isMuted}),v.hasRevisionChanges=!0},toggleMuteTracks:function(t){const n=!t.every((e=>e.isMuted));t.forEach((t=>{t.isMuted=n,f.current.setTrackMuted(t,t.isMuted),e.eventTrack("Toggle Mute",{category:"Mix Editor",label:t.isMuted})})),v.hasRevisionChanges=!0},toggleExclusiveSolo:function(e){const t=h.current.tracks.filter((t=>t.id!==e.id&&t.isSolo));e.isSolo&&t.length>0||O(e),t.forEach((e=>D(e))),v.hasRevisionChanges=!0},toggleExclusiveSoloTracks:function(e){const t=e.every((e=>e.isSolo)),n=e.map((e=>e.id)),o=h.current.tracks.filter((e=>!n.includes(e.id)&&e.isSolo));t||e.forEach(j),t&&!o.length&&e.forEach(D),o.forEach(D),v.hasRevisionChanges=!0},toggleSolo:O,toggleSoloTracks:function(t){const n=!t.every((e=>e.isSolo));t.forEach((t=>{t.isSolo=n,N(t),f.current.setTrackSolo(t,t.isSolo),e.eventTrack("Toggle Solo",{category:"Mix Editor",label:t.isSolo})})),v.hasSoloTrack=s.checkAnySolo(),v.hasRevisionChanges=!0},unfreezeTrack:F,mute:function(e){e.isMuted=!0,f.current.setTrackMuted(e,e.isMuted)},unmute:function(e){e.isMuted=!1,f.current.setTrackMuted(e,e.isMuted)},solo:j,unsolo:D,...C};function E(e,t){const n=C.getGroupData(h.current,e.trackGroupId);if(n){const o=n.trackIds.findIndex((t=>t===e.id)),r=o+t;return void C.moveTrackInGroup(h.current,n.id,o,r,!0)}const o=h.current.tracks.findIndex((t=>t.id===e.id));o<0||I(o,t)}function I(e,t){const n=As(e+t,0,h.current.tracks.length-1),o=C.getGroupData(h.current,h.current.tracks[n].trackGroupId),r=o?h.current.tracks.findIndex((e=>e.id===o.trackIds[0])):n;if(e===r)return;c.pushUndo(h.current),v.hasRevisionChanges=!0;const[i]=h.current.tracks.splice(e,1);h.current.tracks.splice(r,0,i),h.current.tracks=l.applyTracksOrder(h.current.tracks)}function R(e){let{existingTracks:t=_.sortBy(h.current.tracks,"name"),isDuplicatingTrack:n=!1,name:o}=e;const r=/\s+(copy)?(\s\d*)?$/;let i=o.substr(0,128),[a=""]=o.match(r)||[];for(o=o.replace(r,"");_.some(t,{name:i});)n&&!/(\s+)copy(\s\d*)?$/.test(a)?a+=" Copy":/(\s+)(\d+)$/.test(a)?a=a.replace(/(.*)(\s+)(\d+)$/,(function(e,t,n,o){return t+n+ ++o})):a+=" 2",i=o.substr(0,128-a.length)+a;return i}function A(e){if((e===h.selectedTrack||!e.canEdit)&&e.type!==Ks)return;v.isAudioInputVisible&&e.type===Qs&&h.selectedTrack.type!==Qs?l.displayAutoPitch({toggle:!1}):v.isAutoPitchVisible&&e.type!==Qs&&l.displayInstrument({toggle:!1});const t=h.selectedTrack;t&&l.isBandLabInstrumentTrack(t)&&$.previewStopNotes(t?.id),h.selectedTrack=e,h.armedTracks[2]===e&&(h.armedTracks[2]=h.armedTracks[1]),h.armedTracks[1]=e,l.isBandLabInstrumentTrack(h.armedTracks[1])&&l.isBandLabInstrumentTrack(h.armedTracks[2])&&(h.armedTracks[2]=null),B(e)}function x(){return h.current.tracks.length>=JS.TRACKS_LIMIT}function L(){JS.TRACKS_LIMIT<el?(v.isInBackground=!0,_g(pG,{onClickCta:()=>{new k({id:"paywallModal",templateUrl:"https://www.bandlab.com/web-app/membership/partials/_paywall-modal-ee6789e7.html",contentScope:{useCheckoutModal:!0,checkoutSuccess:()=>{JS.TRACKS_LIMIT=el,n.$applyAsync()},productAttribution:"studio_32_tracks",productAttributionGroup:"studio"}}).show()}},{onClose:()=>{v.isInBackground=!1}})):o.addNotification({id:wh,title:wh,content:$h.replace("{$1}",String(JS.TRACKS_LIMIT)),classList:"alert",autoclose:5e3})}function O(t){t.isSolo=!t.isSolo,v.hasSoloTrack=s.checkAnySolo(),N(t),f.current.setTrackSolo(t,t.isSolo),e.eventTrack("Toggle Solo",{category:"Mix Editor",label:t.isSolo}),v.hasRevisionChanges=!0}function j(e){e.isSolo=!0,v.hasSoloTrack=s.checkAnySolo(),N(e),f.current.setTrackSolo(e,e.isSolo)}function D(e){e.isSolo=!1,v.hasSoloTrack=s.checkAnySolo(),f.current.setTrackSolo(e,e.isSolo)}function N(e){e.isMuted=e.isMuted&&e.isSolo?!e.isMuted:e.isMuted,f.current.setTrackMuted(e,e.isMuted)}function U(n,r){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return r.isFreezing=!0,h.trackFreezing.set(r,t.defer()),T[r.id]=n.$watch((function(){return{effects:r.effects,soundbank:r.soundbank,regions:r.regions.map((function(e){let{startPosition:t,endPosition:n,loopLength:o,sampleId:r}=e;return{startPosition:t,endPosition:n,loopLength:o,sampleId:r}}))}}),(function(e,t){if(e!==t)return F(r)}),!0),t.race([f.current.freezeTrack(r.id),h.trackFreezing.get(r).promise]).then((function(t){i&&c.pushUndo(h.current),r.trackSampleId=t,r.isFreezing=!1,r.isFrozen=!0,h.trackFreezing.delete(r),e.eventTrack("Freeze Track",{category:"Mix Editor"})})).catch((function(e){F(r),e!==dh&&"Mixdown doesnt contain any sounds!"!==e&&(Sentry.onLoad((function(){Sentry.captureException(e)})),o.addNotification({title:"Unable to freeze track",content:e.message,classList:"alert",autoclose:8e3}))}))}function F(t){return f.current.unfreezeTrack(t.id).then((()=>{delete t.trackSampleId,t.isFreezing=!1,t.isFrozen=!1,T[t.id]?.(),h.trackFreezing.has(t)&&(h.trackFreezing.get(t).reject(dh),h.trackFreezing.delete(t)),e.eventTrack("Unfreeze Track",{category:"Mix Editor"})}))}function B(e){const t=h.lastDevice;if(e.type===Ks)P.setDrumMachine(e),f.current.armMidiTrack(e),f.current.connectMidiInput(e),h.armedTracks[1]=null,h.armedTracks[2]=null,a.patterns!==e.patterns&&i.selectTrack(e);else if(e.soundbank)P.setFromSoundbank(e.soundbank),S.stopNotes(),f.current.armMidiTrack(e),f.current.connectMidiInput(e);else if(e.samplerKit)P.setSampler(e),S.setSampler(e),S.stopNotes(),f.current.armMidiTrack(e),f.current.connectMidiInput(e),v.isRecording||(t?w.switchTo(t).then((function(){return f.current.setMonitoring(e,h.trackMonitoring.get(e),w.connect)})):w.getAudioDevices().then((function(e){return w.switchTo(e[0])})).then((function(){return f.current.setMonitoring(e,h.trackMonitoring.get(e),w.connect)})));else{P.setFromAudioType(e.type),v.isRecording||(t?w.switchTo(t).then((function(){f.current.setMonitoring(e,h.trackMonitoring.get(e),w.connect)})):w.getAudioDevices().then((function(t){return w.switchTo(t[0]).then((function(){f.current.setMonitoring(e,h.trackMonitoring.get(e),w.connect)}))})));const n=l.isBandLabInstrumentTrack(h.armedTracks[1])&&h.armedTracks[1]||l.isBandLabInstrumentTrack(h.armedTracks[2])&&h.armedTracks[2];n&&P.getBank({slug:n.soundbank}).then((function(t){S.setSoundbank(t),f.current.setTrackMonitoring(e),f.current.connectMidiInput(e)}))}}}]),angular.module("bandlab.editor").factory("EditorView",(function(){var e;return{init:function(t){e=t},isRegionVisible:function(e,t){var n={left:t-Al,width:window.innerWidth};return n.right=n.left+n.width,e.right=e.left+e.width,!(e.right<n.left||e.left>n.right)&&(e.left<n.right&&e.right>n.right?{canvasLeft:Math.max(0,n.left-e.left),canvasWidth:n.width}:e.left<=n.left&&e.right>n.left?{canvasLeft:Math.max(0,n.left-e.left),canvasWidth:e.width-Math.max(0,n.left-e.left)}:e.left>=n.left&&e.right<=n.right?{canvasLeft:0,canvasWidth:e.width}:e.left<n.left&&e.right>n.right?{canvasLeft:0,canvasWidth:n.width}:void 0)},isVisible:function(t,n){var o=t.getBoundingClientRect(),r=n?0:e.left,i=window.innerWidth;return!(o.right<r||o.left>i)&&(o.left<e.right&&o.right>e.right?{canvasLeft:Math.max(0,e.left-o.left),canvasWidth:e.width}:o.left<=r&&o.right>r?{canvasLeft:Math.max(0,e.left-o.left),canvasWidth:o.width-(e.left-o.left)}:o.left>=r&&o.right<=e.right?{canvasLeft:0,canvasWidth:o.width}:o.left<r&&o.right>e.right?{canvasLeft:0,canvasWidth:e.width}:void 0)}}})).factory("AudioEditorView",(function(){var e;return{init:function(t){e=t},isRegionVisible:function(e,t){var n={left:t-Al,width:window.innerWidth};return n.right=n.left+n.width,n.width-=Rl,e.right=e.left+e.width,!(e.right<n.left||e.left>n.right)&&(e.left<n.right&&e.right>n.right?{canvasLeft:Math.max(0,n.left-e.left),canvasWidth:n.width}:e.left<=n.left&&e.right>n.left?{canvasLeft:Math.max(0,n.left-e.left),canvasWidth:e.width-(n.left-e.left)}:e.left>=n.left&&e.right<=n.right?{canvasLeft:0,canvasWidth:e.width}:e.left<n.left&&e.right>n.right?{canvasLeft:0,canvasWidth:n.width}:void 0)},isVisible:function(t,n){var o=t.getBoundingClientRect(),r=n?0:e.left;return!(o.right<r||o.left>e.right)&&(o.left<e.right&&o.right>e.right?{canvasLeft:Math.max(0,e.left-o.left),canvasWidth:e.width}:o.left<=r&&o.right>r?{canvasLeft:Math.max(0,e.left-o.left),canvasWidth:o.width-(e.left-o.left)}:o.left>=r&&o.right<=e.right?{canvasLeft:0,canvasWidth:o.width}:o.left<r&&o.right>e.right?{canvasLeft:0,canvasWidth:e.width}:void 0)}}})),angular.module("bandlab.editor").factory("EditorWaveform",(function(){const e=function(){const e=document.createElement("canvas");return e.width=1,e.height=1,e}();var t=Math.round(oC(1)),n=parseInt(window.getComputedStyle(document.body).getPropertyValue("--mix-editor-waveform-height")),o=parseInt(window.getComputedStyle(document.body).getPropertyValue("--mix-editor-waveform-collapsed-height")),r=32e3,i=1,a=new Map,s=new Map;return i*=t,{WAVEFORM_HEIGHT:n*=t,WAVEFORM_HEIGHT_COLLAPSED:o*=t,cachePattern:function(e,o,i,a){const s=14*t,l=16*t,c=5*t,u=[];let d=a*(o*=t);const p=[new Path2D("M0 2.4C0 1.075 1.099 0 2.455 0h22.09C25.902 0 27 1.075 27 2.4v19.2c0 1.325-1.099 2.4-2.454 2.4H2.454C1.099 24 0 22.925 0 21.6V2.4Zm24.546 0H2.454v19.2h22.09V2.4Z"),new Path2D("M4.91 14.4V12h2.454v2.4H4.909ZM4.91 19.2v-2.4h2.454v2.4H4.909ZM9.818 14.4V12h2.455v2.4H9.818ZM9.818 19.2v-2.4h2.455v2.4H9.818ZM14.727 14.4V12h2.455v2.4h-2.455ZM14.727 19.2v-2.4h2.455v2.4h-2.455ZM19.636 14.4V12h2.455v2.4h-2.455ZM19.636 19.2v-2.4h2.455v2.4h-2.455ZM12.273 6h9.818v2.4h-9.818V6Z"),new Path2D("M9.818 7.2c0 1.325-1.099 2.4-2.454 2.4-1.356 0-2.455-1.075-2.455-2.4s1.099-2.4 2.455-2.4c1.355 0 2.454 1.075 2.454 2.4Z")];for(;d>0;)u.push(m(i,a*o)),d-=Math.min(d,r);return[u];function m(o,i){var a=document.createElement("canvas"),u=a.getContext("2d");if(a.width=Math.min(d,r),a.height=n,u.lineWidth=1,u.fillStyle=o,i<64*t){u.textAlign="center",u.textBaseline="middle";const n=a.width/2,o=a.height/2;u.font=`500 ${s}px BandLab Sans`,i>=24*t&&u.fillText(String.fromCharCode(97+e).toUpperCase(),n,o)}else{u.translate(i/2-l,n/2-14*t),u.scale(t,t);for(const e of p)u.fill(e,"evenodd");u.resetTransform(),u.translate(i/2-l,n/2-14*t),u.translate(c,-7*t),u.font=`500 ${s}px BandLab Sans`,u.fillText(String.fromCharCode(97+e).toUpperCase(),32*t,30*t)}return a}},cacheScore:function(e,n,o,r,i,a){const s=[],c=function(e,n,o,r,i){var a,s,l=_.minBy(e,"midiNote"),c=_.maxBy(e,"midiNote"),u=2,d=4,p=new Path2D,m=new Path2D,f=0;u*=t,d*=t;for(l=l?l.midiNote-1:0,c=c?c.midiNote+1:0;h(u,d)<0;)d=Math.max(d-.1,1),u-=.1;return a=h(u,d),function(){for(s=0;s<e.length;s++){const t=e[s].midiNote,c=Fz(parseFloat(e[s].duration),r),m=Fz(parseFloat(e[s].time),r);m<n||(Number.isInteger(t)&&p.rect(Math.round(m*o),2*Math.round((i-2-a-(t-l)*(u+d))/2),2*Math.round(Math.max(c*o,4)/2),2*Math.round(d/2)),f=isNaN(m+c)?f:Math.max(f,m+c))}}(),{lower:m,upper:p,width:f*o};function h(e,t){return(i-(c-l)*(e+t))/2}}(e,n,o*=t,a,r);return l(c,c.width,s,r,i),[s]},cacheWaveform:function(e,n,o,r,s){let c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;o*=t;const d=Math.floor(e.duration*o/Math.abs(u)),p=[],m=function(e,t,n,o){var r,i,a,s=new Path2D,l=new Path2D,c=Math.round(o/2);for(s.moveTo(0,c),l.moveTo(0,c-1),r=0;r<e.length;r++)i=r*t,a=e[r]*n,s.lineTo(i,c+a),l.lineTo(i,c-1-a);return i=r*t,s.lineTo(i,c),l.lineTo(i,c-1),{lower:s,upper:l}}(function(e,t,n){return a.has(n)||a.set(n,function(e){var t,n,o,r,a,s,l,c,u=2560/i,d=new Array(Math.floor(e.duration*u)),p=e.numberOfChannels,m=e.length/d.length;for(n=0;n<p;n++)for(t=e.getChannelData(n),a=0;a<d.length;a++){for(o=0,l=Math.floor(a*m),c=Math.floor(l+m),s=l;s<c;s+=8)o=(r=Math.abs(t[s]))>o?r:o;(0===n||o>d[a])&&(d[a]=Math.floor(100*o))}return d}(e)),function(e,t){var n,o,r,i,a,s=2560/t,l=new Array(Math.floor(e.length/s)),c=e.length/l.length;if(1===s)return e;for(o=0;o<l.length;o++){for(n=0,i=Math.floor(o*c),a=Math.max(Math.floor(i+c),i+1),r=i;r<a;r++)n=e[r]>n?e[r]:n;l[o]=n}return l}(a.get(n),t)}(e,o/Math.abs(u),n),i,r/2/100*c,r);l(m,d,p,r,s);return[p,p.map((function(e){const t=document.createElement("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");return n.scale(-1,1),n.drawImage(e,-e.width,0),t})).reverse()]},deleteUnusedCache:function(){s.clear(),a.clear()},drawFromBuffers:function(e,n,o,i,a,l,c,m,f,h,g,v){let b=arguments.length>12&&void 0!==arguments[12]?arguments[12]:1,y=arguments.length>13&&void 0!==arguments[13]?arguments[13]:1,w=arguments.length>14?arguments[14]:void 0,$=arguments.length>15?arguments[15]:void 0;n*=t,o*=t,l*=t,m*=t,m=w===Ks?0:m;const k=w===Ks?l:null,[S,_]=function(e,t,n,o,r,i,a,l,c,u){let d=e+(t||n)+o+r+i+l+a;return u&&(d+=u),s.has(d)||s.set(d,c()),s.get(d)}(i,f,a,h,v,b,Math.abs(y),m,g,k),P=y>0?S:_,M=[],T=c>0;var C,E,I=d(P,Math.floor(n%l+m),Math.floor(m+l)),R=0;if(I.length){for(e.canvas.width=o-n,f||$||function(e,t,n){e.fillStyle=t,e.fillRect(0,Math.round(n/2)-1,r,1)}(e,v,h),E=0;E<I.length;E++)$?R+=I[E].to-I[E].from:R=p(e,I[E],R,h);for(T&&(M.push(u(R,h)),C=R),I=d(P,m,m+l);R<o-n;){for(E=0;E<I.length;E++)$?R+=I[E].to-I[E].from:R=p(e,I[E],R,h);T&&M.push(u(R,h))}T&&(e.fillStyle="rgba(0, 0, 0, .3)",e.fillRect(n>=l?0:C,0,o-n,h),e.strokeStyle="rgba(255, 255, 255, 1)",M.pop(),M.forEach((t=>e.stroke(t))))}}};function l(e,t,n,o,i){for(var a=0;t>0;)n.push(c(e,a,t,i,o)),t-=Math.min(t,r),a-=n[n.length-1].width}function c(e,t,n,o,i){var a=document.createElement("canvas"),s=a.getContext("2d");return a.width=Math.min(n,r),a.height=i,function(e,t,n,o){e.translate(n,0),e.fillStyle=o,t.lower&&e.fill(t.lower),t.upper&&e.fill(t.upper)}(s,e,t,o),a}function u(e,t){const n=new Path2D;return n.rect(e+.5,0,.5,t),n}function d(t,n,o){var r,i,a=0,s=0,l=[];for(i=0;i<t.length;i++)r=t[i],a<=n&&a+r.width>n?(l.push({from:n-a,to:Math.min(o-a,r.width),buffer:r}),s+=Math.min(o-a,r.width)-(n-a)):a<o&&a+r.width>o&&(l.push({from:0,to:o-a,buffer:r}),s+=o-a),a+=r.width;return s<o-n&&l.push({from:0,to:o-n-s,buffer:e}),l}function p(e,t,n,o){return e.drawImage(t.buffer,t.from,0,t.to-t.from,o,n,0,t.to-t.from,o),n+(t.to-t.from)}})),angular.module("bandlab.common").component("emojiPicker",{bindings:{direction:"<",teleported:"<"},controllerAs:"vm",controller:["$scope","$element",function(e,t){const n=this,o=angular.element(t[0].closest(".textarea-emoji-wrapper,.conversation-input-textarea-wrapper")).find("textarea");function r(){o.triggerHandler("change")}o&&xj?import("./chunk-554ed3f9.js").then((function(i){let{mountEmojiPicker:a}=i;const s=a(t[0],{},{direction:n.direction,inputRef:o[0],teleported:n.teleported,onEmojiSelection:r});e.$on("$destroy",(function(){s.unmount()}))})):(e.$destroy(),t.remove())}]}),angular.module("bandlab.error.routes",["ui.router"]).config(["$stateProvider",function(e){e.state("0",{url:"/0",templateUrl:"https://www.bandlab.com/web-app/error/views/0-1dd386ca.html"}).state("403",{url:"/403",templateUrl:"https://www.bandlab.com/web-app/error/views/403-e9cb164c.html",onEnter:function(){document.querySelector('meta[name="prerender-status-code"]').setAttribute("content","403")},onExit:function(){document.querySelector('meta[name="prerender-status-code"]').setAttribute("content","200")}}).state("404",{url:"/404",template:"<div></div>",onEnter:function(){document.querySelector('meta[name="prerender-status-code"]').setAttribute("content","404")},onExit:function(){document.querySelector('meta[name="prerender-status-code"]').setAttribute("content","200")},controller:["$element","$scope","$transition$",function(e,t,n){import("./chunk-9f270e0a.js").then((function(o){let{mountError404:r}=o;const i=r(e[0],{},n.options().custom);t.$on("$destroy",(function(){i.unmount()}))}))}]}).state("500",{url:"/500",templateUrl:"https://www.bandlab.com/web-app/error/views/500-e0376215.html",onEnter:function(){document.querySelector('meta[name="prerender-status-code"]').setAttribute("content","500")},onExit:function(){document.querySelector('meta[name="prerender-status-code"]').setAttribute("content","200")}}).state("useChrome",{url:"/use-chrome",templateUrl:"https://www.bandlab.com/web-app/error/views/use-chrome-b0c9948f.html"}).state("updateBrowser",{url:"/update-browser",templateUrl:"https://www.bandlab.com/web-app/error/views/update-browser-e21fdb5b.html"}).state("projectFull",{url:"/project-full",templateUrl:"https://www.bandlab.com/web-app/error/views/project-full-5685a55c.html"}).state("unavailable",{url:"/unavailable?url",templateUrl:"https://www.bandlab.com/web-app/error/views/unavailable-f48cbb85.html",controller:["$scope","$stateParams",function(e,t){if(e.isAndroid=Yf,e.isiOs=Jf,e.isMobileOrTablet=Zf||Qf,!t.url)return;const n=decodeURIComponent(t.url);e.downloadUrl=ES(n)}]})}]),angular.module("bandlab.explore",[]),angular.module("bandlab.explore").controller("PostsListCtrl",["$location","$q","$scope","$state","PlayerHistory","Post",function(e,t,n,o,r,i){var a,s=null,l=10,c=!1,u=e.url();function d(){if(c)return t.resolve([]);const e=n.genre?"trending"===n.sort?i.exploreGenreTrending:i.exploreGenre:n.contest?i.fromContest:i.explore;return a=e({after:s,contestId:n.contest?n.contest.id:null,forkable:n.filters&&!0===n.filters.song.isForkable,genres:n.genre?n.genre.id:null,limit:l,sort:"trending"===n.sort?null:n.sort,tags:n.tag?n.tag.id:null,timeRange:"trending"===n.sort?n.timeRange:null,types:"revision"}).$promise.then((function(e){return c=e.paging.itemsCount<e.paging.limit,s=_.get(e,"paging.cursors.after",0),e.data}))}function p(){return n.infiniteScrollEnded?t.resolve():a=a.then((function(e){n.infiniteScrollEnded=c,n.posts=n.posts||[];const t=n.posts.length;return n.posts=_.uniqBy(n.posts.concat(e),"id"),r.pushQueueSongs(n.posts.slice(t),u),d()}))}n.loadMore=p,r.setCurrentPageContext({contentSource:_p(o),loader:p,url:u}),n.$watch("filters.song.isForkable",(function(){n.posts&&(c=!1,n.infiniteScrollEnded=c,n.posts=null,s=null,d().then(n.loadMore))})),d().then(n.loadMore)}]),angular.module("bandlab.explore").component("carouselShelf",{bindings:{type:"="},restrict:"E",controller:["$scope","$element","$compile","$http","$injector","$rootScope","$state",function(e,t,n,o,r,i,a){const s=this;s.$onInit=function(){const l=import("./chunk-411247c2.js").then((function(l){let{mountCarouselShelf:c}=l;return c(t[0],{vm:s,scope:e.$parent,$compile:n,$http:o,$injector:r,$rootScope:i,$state:a})}));e.$on("$destroy",(async function(){(await l).unmount()}))}}]}),angular.module("bandlab.explore").directive("exploreChart",["$compile","$injector","$rootScope",function(e,t,n){return{replace:!0,restrict:"E",link:async function(o,r){const i=import("./chunk-65794fae.js").then((function(i){let{mount:a}=i;return a(r[0],{$compile:e,$injector:t,$rootScope:n,scope:o})}));o.$on("$destroy",(async function(){(await i).unmount()}))}}}]),angular.module("bandlab.explore").directive("exploreGenreButtons",["$injector",function(e){return{replace:!0,restrict:"E",scope:{channels:"="},link:async function(t,n){const o=t.channels,r=import("./chunk-ce4ce7c9.js").then((function(r){let{mount:i}=r;return i(n[0],{$injector:e,scope:t},{channels:o})}));t.$on("$destroy",(async function(){(await r).unmount()}))}}}]).directive("explorePopularThisMonthPlaylist",["$compile","$injector","$rootScope",function(e,t,n){return{replace:!0,restrict:"E",link:async function(o,r){const i=import("./chunk-4c51e3b2.js").then((function(i){let{mount:a}=i;return a(r[0],{$compile:e,$injector:t,$rootScope:n,scope:o})}));o.$on("$destroy",(async function(){(await i).unmount()}))}}}]).directive("exploreChannelHashtags",["$compile","$injector","$rootScope",function(e,t,n){return{replace:!0,restrict:"E",scope:{hashtags:"<"},link:async function(o,r){const i=import("./chunk-e1771929.js").then((function(i){let{mount:a}=i;return a(r[0],{$compile:e,$injector:t,$rootScope:n,scope:o},{hashtags:o.hashtags})}));o.$on("$destroy",(async function(){(await i).unmount()}))}}}]).directive("exploreCreatorConnect",["$injector",function(e){return{replace:!0,restrict:"E",link:async function(t,n){const o=import("./chunk-1fb01ad7.js").then((function(t){let{mount:o}=t;return o(n[0],{$injector:e})}));t.$on("$destroy",(async function(){(await o).unmount()}))}}}]),angular.module("bandlab.explore").directive("explorePreview",["$injector",function(e){return{link:async function(t,n){const o=import("./chunk-fa04e7d0.js").then((function(o){let{mount:r}=o;return r(n[0],{$injector:e,scope:t})}));t.$on("$destroy",(async function(){(await o).unmount()}))}}}]),angular.module("bandlab.explore.routes",["ui.router"]).config(["$stateProvider",function(e){r.$inject=["$stateParams"],o.$inject=["$stateParams"],i.$inject=["$http","Tag"];const t=["recent","trending","popular","inspiring"],n=["week","month"];function o(e){return _.includes(t,e.sort)?e.sort:t[0]}function r(e){return _.includes(n,e.timeRange)?e.timeRange:n[0]}function i(e,t){return Promise.all([t.getGenres(),e.get("https://www.bandlab.com/api/v2.0/contents/explore?types=genres",{cache:!0})]).then((function(e){let[t,{data:{data:n}}]=e;return n.map((function(e){const{imageUrl:n,name:o}=t.find((t=>t.id===e.id));return e.imageUrl=n,e.title=o,e}))})).catch((()=>[]))}e.state("explore",{url:"/explore",redirectTo:"explore.home",template:"<ui-view/>",onEnter:function(){Promise.resolve().then((()=>rb)).then((function(e){let{logExploreOpen:t}=e;t()}))}}).state("explore.home",{url:"/home",templateUrl:"https://www.bandlab.com/web-app/explore/views/explore-home-c7a8ccbc.html",resolve:{showRecentAlbums:function(){return Promise.resolve().then((()=>fv)).then((function(e){let{getFirebaseRemoteConfigValue:t}=e;return t("explore_show_recent_albums")})).catch((function(){return!1}))}},controller:["$http","$location","$scope","$timeout","Me","showRecentAlbums","Tag",function(e,t,n,o,r,i,a){n.me=r,n.showRecentAlbums=i,n.isPopularThisMonthVisible=!1,n.isLocalSceneTracksActive=!0,n.isLocalSceneArtistsActive=!0,n.isChartActive=!1,n.setIsLocalSceneTracksActive=function(e){n.isLocalSceneTracksActive=e},n.setIsLocalSceneArtistsActive=function(e){n.isLocalSceneArtistsActive=e},n.setIsChartActive=function(e){n.isChartActive=e},Promise.resolve().then((()=>Ap)).then((async e=>{let{getAmplitudeFeatureFlag:t}=e;const o=await t(r,"global_tracks_chart");n.isChartActive=o&&"true"===o})),function(e,t){return Promise.all([t.getGenres(),e.get("https://www.bandlab.com/api/v2.0/contents/explore?types=channels",{cache:!0})]).then((function(e){let[t,{data:{data:n}}]=e;return t.filter((function(e){return n.some((t=>t.id===e.id))}))})).catch((()=>[]))}(e,a).then((function(e){n.channels=e})),o((function(){const e=t.hash();e&&document.getElementById(e).scrollIntoView({behavior:"smooth",block:"center"})}),1e3)}]}).state("explore.genre",{url:"/{genre:[a-z0-9-]{3,30}}?sort&timeRange",resolve:{theGenres:i,theGenre:["$q","$stateParams","theGenres",function(e,t,n){const o=_.find(n,{id:t.genre});return o?e.resolve(o):e.reject({status:404})}],theSort:o,theTimeRange:r},views:{"":{templateUrl:"https://www.bandlab.com/web-app/explore/views/explore-genres-232a415a.html",controller:["$scope","Me","theGenre","theGenres","theSort","theTimeRange",function(e,t,n,o,r,i){e.me=t,e.genres=o,e.genre=n,e.me.isAnonymous()||(e.mygenres=e.genres.filter((e=>t.genres.map((e=>e.id)).includes(e.id))),e.othergenres=e.genres.filter((e=>!t.genres.map((e=>e.id)).includes(e.id)))),e.sort=r,e.timeRange=i,e.filters={song:{isForkable:!1}}}]},"sort@explore.genre":{templateUrl:"https://www.bandlab.com/web-app/explore/partials/_sort-0f64fe3c.html"},"list@explore.genre":{templateUrl:"https://www.bandlab.com/web-app/explore/partials/_explore-posts-63b729bb.html",controller:"PostsListCtrl"}},onEnter:["Page","theGenre",function(e,t){e.setMetadata({title:`${t.title} | BandLab`,image:t.imageUrl})}],onExit:["Page",function(e){e.clearMetadata()}]}).state("explore.channel",{url:"/channels/{channel:[a-z0-9-]{3,30}}",onEnter:["$stateParams","Page","theGenres",function(e,t,n){const{title:o}=n.find((t=>t.id===e.channel));t.setMetadata({title:o})}],onExit:["Page",function(e){e.clearMetadata()}],resolve:{theChannel:["$http","$stateParams",function(e,t){const{channel:n}=t;return e.get(`https://www.bandlab.com/api/v2.0/contents/explore?types=banners,communities,collections,hashtags&channel=${n}`,{cache:!0}).then((e=>e.data)).catch((()=>[]))}],theGenres:i},views:{"":{templateUrl:"https://www.bandlab.com/web-app/explore/views/explore-channel-7c898913.html",controller:["$scope","$stateParams","theChannel","theGenres",function(e,t,n,o){e.sectionVisibility={genrePlaylist:!0,featuredAlbums:!0,featuredArtists:!0,recentAlbums:!0},e.setSectionVisibility=function(t,n){e.sectionVisibility[t]=n},e.banners=(n.banners?.data??[]).slice(0,15),e.channel=_.find(o,{id:t.channel}),e.collections=_.get(n,"collections.data"),e.communities=_.get(n,"communities.data"),e.hashtags=_.get(n,"hashtags.data[0].tags")}]}}}).state("explore.filter",{url:"/filter",redirectTo:"explore.filter.tracks"}).state("explore.filter.tracks",{url:"/tracks?genres&sort&timerange&forkable",params:{genres:{dynamic:!0},sort:{dynamic:!0},timerange:{dynamic:!0},forkable:{dynamic:!0}},resolve:{isFilterForTracksEnabled:["$q","Me",function(e,t){return Promise.resolve().then((()=>Ap)).then((async n=>{let{getAmplitudeFeatureFlag:o}=n;return"true"===await o(t,"filters_for_tracks")?e.resolve():e.reject({status:404})}))}]},onEnter:["Page",function(e){e.setMetadata({title:"Filters"})}],onExit:["Page",function(e){e.clearMetadata()}],views:{"":{template:'<div id="vue"></div>',controller:["$element","$scope","$injector",function(e,t,n){const o=import("./chunk-473d133e.js").then((function(t){let{mountExploreFilterTracks:o}=t;return o(e[0].querySelector("#vue"),{$injector:n})}));t.$on("$destroy",(async function(){(await o).unmount()}))}]}}})}]),angular.module("bandlab.fanreach",[]),angular.module("bandlab.fanreach.routes",["ui.router"]).config(["$stateProvider",function(e){e.state("fanReachCreate",{url:"/fan-reach/campaign?draftId",params:{draftId:{value:null,squash:!0}},useTopBarForm:!0,views:{"":{templateUrl:"https://www.bandlab.com/web-app/fanreach/views/fanreach-creation-cf0a0a58.html",controller:["$cacheFactory","$injector","$rootScope","$scope","$state","$stateParams","$timeout","Album","AppNotifications","Loader","Me","Modal","Post","User",function(e,t,n,o,r,i,a,s,l,c,u,d,m,f){const{startPurchaseFlow:h}=tN(t,o,(function(e){o.membership=e&&"Free"!==e}));i.draftId?(f.getFanReachDraftEmail({userId:u.id,draftId:i.draftId}).$promise.then((function(e){o.campaign=e,e.trackId?(o.campaign.type="Track",m.get({id:e.trackId}).$promise.then((function(e){o.track=e}))):e.albumId?(o.campaign.type="Album",s.get({id:e.albumId}).$promise.then((function(e){o.album=e}))):o.campaign.type="Text"})).catch((function(e){404===e.status?r.go("404"):r.go("0")})),o.isNewCampaign=!1):(o.campaign={subject:"",message:"",type:"",trackId:"",albumId:""},o.isNewCampaign=!0,o.canProceedToStep2=!1),f.getMembershipStatus({userId:u.id}).$promise.then((function(e){o.membership=e,o.getMembership=function(){p()?h("fan_reach","artist_services"):new d({id:"paywallModal",templateUrl:"https://www.bandlab.com/web-app/membership/partials/_paywall-modal-ee6789e7.html",contentScope:{productAttribution:"fan_reach",productAttributionGroup:"artist_services"}}).show()}})),o.sendingPreview=!1,o.sendingCampaign=!1,o.removeAttachment=function(e){"Track"===e?(o.track={id:""},o.campaign={...o.campaign,trackId:""}):"Album"===e&&(o.album={id:""},o.campaign={...o.campaign,albumId:""}),o.canProceedToStep2=!1},o.openLibrary=function(){const e=new d({templateUrl:"https://www.bandlab.com/web-app/fanreach/partials/_fanreach-choose-from-library-modal-9508fa61.html",contentScope:{me:u,campaign:()=>o.campaign,tracks:()=>o.tracks,albums:()=>o.albums,selectProject:t=>{"Track"===o.campaign.type?(o.track=t,o.campaign.trackId=o.track.id):(o.album=t,o.campaign.albumId=o.album.id),o.canProceedToStep2=!0,o.fanreachCampaignForm.$setDirty(),e.destroy()},loadMore:b(o.campaign.type)},onCreate:()=>{b(o.campaign.type)}});e.show()};const g=c.create(m.getTracksFromUser,{userId:u.id,limit:20}),v=c.create(s.fromUser,{userId:u.id,limit:20});function b(e){return"Track"===e?g.get().then((function(e){return o.tracks=o.tracks||[],o.tracks=o.tracks.concat(e),e})):v.get().then((function(e){return o.albums=o.albums||[],o.albums=o.albums.concat(e),e}))}function y(){r.go("fanReachCreate.campaignType")}o.back=y,o.next=function(){r.go("fanReachCreate.editor"),Promise.resolve().then((()=>rb)).then((function(e){let{logFanReachCampaignCreate:t}=e;t(o.campaign)}))},o.$on("tabBarBack",y),o.$watch("campaign.type",(function(e){switch(e){case"Track":o.campaignMessagePlaceholder="Tell your fans about your track.";break;case"Album":o.campaignMessagePlaceholder="Tell your fans about your album.";break;case"Text":o.campaignMessagePlaceholder="Write anything from a quick Hello to an exciting personal update.";break;default:o.campaignMessagePlaceholder="Enter campaign message"}"fanReachCreate.campaignType"===r.current.name&&("Track"===e?(o.campaign={...o.campaign,trackId:o.track?o.track.id:"",albumId:""},""!==o.campaign.trackId?(o.canProceedToStep2=!0,o.fanreachCampaignForm.$setDirty()):(o.canProceedToStep2=!1,o.fanreachCampaignForm.$setPristine())):"Album"===e?(o.campaign={...o.campaign,albumId:o.album?o.album.id:"",trackId:""},""!==o.campaign.albumId?(o.canProceedToStep2=!0,o.fanreachCampaignForm.$setDirty()):(o.canProceedToStep2=!1,o.fanreachCampaignForm.$setPristine())):"Text"===e&&(o.campaign={...o.campaign,trackId:"",albumId:""},o.canProceedToStep2=!0,o.fanreachCampaignForm.$setPristine()))}),!0),o.createNewCampaign=function(){o.fanreachCampaignForm.$dirty?(l.addNotification({id:"fanReachCampaignSave",title:"Your draft is being saved",classList:"loading",autoclose:8e3}),f.updateFanReachDraftEmail({userId:u.id,draftId:o.campaign.draftId},o.campaign).$promise.then((function(){l.addNotification({id:"fanReachCampaignSave",title:"Your draft has been saved",classList:"success",autoclose:8e3}),r.go("fanReachCreate.campaignType",{draftId:null})})).catch((function(){l.addNotification({id:"fanReachCampaignSave",title:"Something went wrong, please try again later",classList:"alert",autoclose:8e3})}))):r.go("fanReachCreate.campaignType",{draftId:null})},o.sendCampaign=function(){o.sendingCampaign=!0,f.sendFanReachEmail({userId:u.id},o.campaign).$promise.then((function(){e.get("FanReach")?.removeAll(),a((()=>{r.go("dashboard.fanReach.sent",p()?{"#":"bl_closeWebView"}:{});const e=o.campaign.trackId?"Track Update":o.campaign.albumId?"Album Update":"Fan Update";l.addNotification({title:`Your ${e} was sent`,classList:"success",autoclose:8e3}),Promise.resolve().then((()=>rb)).then((function(e){let{logFanReachCampaignSend:t}=e;t(o.campaign)}))}),3e3)})).catch((function(e){a((()=>{o.sendingCampaign=!1;const t=e.data.errorCode;if(t===JD||t===XD){const e=zn((()=>import("./chunk-14e15eec.js")));Promise.resolve().then((()=>Tg)).then((function(n){let{createModal:o}=n;o(e,{emailUnconfirmed:t===XD})}))}else l.addNotification({title:e.data.message,classList:"alert",autoclose:8e3})}),3e3)}))},o.isWebview=p(),o.exitFromFooter=function(){n.$broadcast("topBarExit")},o.$on("topBarExit",(function(){if(o.fanreachCampaignForm.$dirty){const e=new d({template:'\n                      <div>\n                        <div class="modal-close" ng-click="cancel()"></div>\n                        <header class="modal-header-new">\n                          <h2 class="modal-header-title">\n                            Save changes?\n                          </h2>\n                        </header>\n                        <div class="modal-content modal-content-new">\n                          <div class="modal-confirm-message">\n                            Any unsaved changes will be lost once you leave this page.\n                          </div>\n                          <div class="modal-confirm-buttons">\n                            <button type="button" ng-click="discard()" class="modal-cancel button-scd-theme button-height-40 button-padding-fill button-rounded">\n                              Leave\n                            </button>\n                            <button ng-disabled="saving" type="button" ng-click="save()" class="modal-confirm button-cta button-height-40 button-padding-fill button-rounded">\n                              Save\n                            </button>\n                          </div>\n                        </div>\n                      </div>\n                    ',toFocusConfirm:!0,contentScope:{saving:!1,discard:function(){r.go("dashboard.fanReach.drafts",p()?{"#":"bl_closeWebView"}:{}),e.destroy()},save:function(){let t;t=o.isNewCampaign?f.createFanReachDraftEmail({userId:u.id},o.campaign).$promise:f.updateFanReachDraftEmail({userId:u.id,draftId:o.campaign.draftId},o.campaign).$promise,l.addNotification({id:"fanReachCampaignSave",title:"Your draft is being saved",classList:"loading",autoclose:8e3}),this.saving=!0,t.then((()=>{this.saving=!1,l.addNotification({id:"fanReachCampaignSave",title:"Your draft has been saved",classList:"success",autoclose:8e3}),r.go("dashboard.fanReach.drafts",p()?{"#":"bl_closeWebView"}:{}),e.destroy()})).catch((()=>{this.saving=!1,l.addNotification({id:"fanReachCampaignSave",title:"Something went wrong, please try again later",classList:"alert",autoclose:8e3})}))}},onCancel:function(){e.destroy()}});e.show()}else r.go("dashboard.fanReach.drafts",p()?{"#":"bl_closeWebView"}:{})}))}]},"topBarForm@":{templateUrl:"https://www.bandlab.com/web-app/fanreach/partials/_fanreach-creation-top-bar-bfaaede5.html",controller:["$rootScope","$scope",function(e,t){t.exitPage=function(){e.$broadcast("topBarExit")}}]},"tabBarForm@":{templateUrl:"https://www.bandlab.com/web-app/fanreach/partials/_fanreach-creation-tab-bar-102e2307.html",controller:["$rootScope","$scope",function(e,t){t.goBack=function(){e.$broadcast("tabBarBack")},t.exitPage=function(){e.$broadcast("topBarExit")}}]}},redirectTo:function(e){const t=e.injector().get("Me");return e.injector().get("User").getFanReachStatus({userId:t.id}).$promise.then((function(t){return t.featureAccess.isActivated&&t.permissions.reachSubscribers?e.params().draftId?{state:"fanReachCreate.editor",params:{draftId:e.params().draftId}}:{state:"fanReachCreate.campaignType"}:{state:"dashboard.fanReach",params:p()?{"#":"bl_closeWebView"}:{}}}))}}).state("fanReachCreate.campaignType",{url:"/step-1",useTopBarForm:!0,views:{"":{templateUrl:"https://www.bandlab.com/web-app/fanreach/views/fanreach-creation-campaign-type-4db4ac33.html"}},redirectTo:function(e){const t=e.injector().get("Me");return e.injector().get("User").getFanReachStatus({userId:t.id}).$promise.then((function(t){return t.featureAccess.isActivated&&t.permissions.reachSubscribers?e.params().draftId?{state:"fanReachCreate.editor",params:{draftId:e.params().draftId}}:void 0:{state:"dashboard.fanReach",params:p()?{"#":"bl_closeWebView"}:{}}}))}}).state("fanReachCreate.editor",{url:"/step-2",useTopBarForm:!0,views:{"":{templateUrl:"https://www.bandlab.com/web-app/fanreach/views/fanreach-creation-editor-04a859c6.html"}},redirectTo:function(e){const t=e.injector().get("Me");return e.injector().get("User").getFanReachStatus({userId:t.id}).$promise.then((function(t){return t.featureAccess.isActivated&&t.permissions.reachSubscribers?"fanReachCreate.campaignType"===e.from().name||e.params().draftId?void 0:{state:"fanReachCreate.campaignType"}:{state:"dashboard.fanReach",params:p()?{"#":"bl_closeWebView"}:{}}}))}}).state("fanReachFanCollector",{url:"/{username:[a-z0-9][a-z0-9_]{2,19}}/subscribe",templateUrl:"https://www.bandlab.com/web-app/fanreach/views/fanreach-fan-collector-aef5b89b.html",resolve:{theUser:["$stateParams","User",function(e,t){return t.get({id:e.username}).$promise}],theFan:["theUser","Me","User",function(e,t,n){return t.isAnonymous()?{isFan:!1}:n.getFanReachSubscriptionState({userId:e.id,meId:t.id}).$promise}],fanReachEnabled:["theUser","User",function(e,t){return t.getFanReachStatusUnauthorized({userId:e.id}).$promise}],redirectToUserProfile:["fanReachEnabled","$state","$stateParams",function(e,t,n){if(!e.isActivated)return t.go("user.feed",{username:n.username})}]},onEnter:["Page","theUser",function(e,t){e.setMetadata({title:`${t.name} | Fan Reach`,image:`${t.picture.url}360x360`,imageHeight:"360",imageWidth:"360"})}],onExit:["Page",function(e){e.clearMetadata()}],controller:["$scope","$state","AppNotifications","theFan","User","theUser","Me","Share",function(e,t,n,o,r,i,a,s){function l(){return t.href("fanReachFanCollector",{username:e.user.username},{absolute:!0})}e.isAnonymous=a.isAnonymous(),Object.assign(i,{fanReach:{isFan:o.isFan,subscribing:!1}}),e.user=i,e.subscriberEmail="",e.shareWithTwitter=function(){s.withTwitter(l())},e.shareWithFacebook=function(){s.withFacebook(l())},e.subscribe=function(){Object.assign(e.user,{fanReach:{subscribing:!0}}),r.subscribeViaLink({userId:e.user.id,email:e.subscriberEmail}).$promise.then((()=>{Object.assign(e.user,{fanReach:{isFan:!0}})})).catch((()=>{Object.assign(e.user,{fanReach:{subscribing:!1}}),n.addNotification({title:"Something went wrong, please try again later",classList:"warning",autoclose:8e3})}))}}]})}]),angular.module("bandlab.fanreach").controller("FanReachActivateModalCtrl",["$injector","$rootScope","$scope","$state","Me",function(e,t,n,o,r){n.modalActivateFanReach=function(){n.isActivating=!0,import("./chunk-3652b411.js").then((function(i){let{handleActivateFanReach:a}=i;a(r.id,e,{onSuccess:function(){o.go("dashboard.fanReach.sent"),t.$broadcast("fanreachActivateModal","close")},onError:function(){n.isActivating=!1},onErrorEmail:function(){t.$broadcast("fanreachActivateModal","close")}})}))}}]),angular.module("bandlab.fanreach").controller("FanReachConfirmEmailModalCtrl",["$scope",function(e){e.hasWebviewCookie=p()}]),angular.module("bandlab.fanreach").controller("FanReachMyFansCtrl",["$q","$scope","$state","AppNotifications","ConfirmModal","Me","Modal","User",function(e,t,n,o,r,i,a,s){!1===t.$parent.status.featureAccess.isActivated&&new a({id:"fanreachActivateModal",templateUrl:"https://www.bandlab.com/web-app/fanreach/partials/_fanreach-activate-modal-d44c9632.html",class:"artist-services-usps-modal-root"}).show(),s.getFanReachSubscriberCount({id:i.id}).$promise.then((function(e){t.stats=e})),t.view={sortDesc:!0};var l,c=null,u=!1;function d(){if(u)return e.resolve([]);var n={limit:50,after:c};return l=(l=s.getFanReachSubscribers(Object.assign(n,{meId:i.id,sort:"subscribedOn",sortOrder:t.view.sortDesc?"desc":"asc",status:"available"})).$promise).then((function(e){return u=e.paging.itemsCount<e.paging.limit,c=_.get(e,"paging.cursors.after",0),e.data=e.data.map((e=>(e.formattedSubscribedOn=WA(e.subscribedOn),e))),e.data}))}t.loadMoreSubscribers=function(){return t.subscribersInfiniteScrollEnded?e.resolve():l=l.then((function(e){return t.subscribersInfiniteScrollEnded=u,t.subscribers=t.subscribers||[],t.subscribers=t.subscribers.concat(e),d()}))},d().then(t.loadMoreSubscribers),t.removeSubscriber=function(e){return new r({confirmLabel:"Remove",contentScope:{title:"Removing fan",message:`You are about to remove ${e.email} from your mailing list. Are you sure you want to continue?`},onConfirm:function(){s.deleteFanReachSubscribers({meId:i.id},{ids:[e.id]}).$promise.then((function(){Gf(t.subscribers,e),t.stats.delta.subscribers--,t.stats.total.subscribers--}))}}).show()},t.toggleSubscribersSorting=function(){t.view.sortDesc=!t.view.sortDesc,delete t.subscribers,c=null,u=!1,t.subscribersInfiniteScrollEnded=!1,d().then(t.loadMoreSubscribers)},t.copyLink=function(){o.addNotification({title:"Copied to clipboard",classList:"success",autoclose:1e3})},t.subscribeLink=n.href("fanReachFanCollector",{username:i.username},{absolute:!0}),t.isWebview=p()}]),angular.module("bandlab.fanreach").controller("FanReachSettingsCtrl",["$injector","$rootScope","$scope","AppNotifications","Me","User",function(e,t,n,o,r,i){function a(e){const t=n.introMessage.isEnabled;n.savingIntroMessage=!0,i.updateFanReachIntroMessage({userId:r.id},n.introMessage).$promise.then((function(){n.savingIntroMessage=!1,o.addNotification({title:t?"Welcome Message saved":"Welcome Message disabled",classList:"success",autoclose:8e3}),e.$setPristine()})).catch((function(e){n.savingIntroMessage=!1,o.addNotification({content:e.data.message||"Something went wrong, please try again later",classList:"alert",autoclose:8e3})}))}n.status={...n.$parent.status,featureAccess:{...n.$parent.status.featureAccess,isActivated:n.$parent.status.featureAccess.isActivated}},n.toggleActivation=function(){const a=n.status.featureAccess.isActivated;a?import("./chunk-3652b411.js").then((function(t){let{handleActivateFanReach:n}=t;n(r.id,e)})):i.deactivateFanReach({userId:r.id}).$promise.then((function(e){Promise.resolve().then((()=>Ap)).then((function(e){let{setUserProperty:t}=e;t("fan_reach_activated",!1)})),t.$broadcast("$fanReach:statusChanged",{action:"deactivate",response:e}),o.addNotification({title:"Fan Reach has been deactivated",classList:"success",autoclose:8e3})})).catch((function(){n.status.featureAccess.isActivated=!a,o.addNotification({title:"Something went wrong, please try again later",classList:"alert",autoclose:8e3})}))},n.$on("$fanReach:statusToggled",(function(e,t){n.status.featureAccess.isActivated=t.isActivating})),n.$on("$fanReach:statusChanged",(function(e,t){n.status={...t.response,featureAccess:{...t.response.featureAccess,isActivated:t.response.featureAccess.isActivated}}})),i.getFanReachIntroMessage({userId:r.id}).$promise.then((function(e){n.introMessage=e,n.savingIntroMessage=!1})).catch((function(){o.addNotification({content:"Something went wrong, please try again later",classList:"alert",autoclose:8e3})})),n.updateIntroMessage=a,n.disableIntroMessage=function(e){!1===n.introMessage.isEnabled&&a(e)},n.previewIntroMessage=function(){const e=zn((()=>import("./chunk-00de050e.js")));Promise.resolve().then((()=>Tg)).then((function(t){let{createModal:o}=t;o(e,{subject:n.introMessage.subject,message:n.introMessage.message})}))}}]),angular.module("bandlab.global",[]),angular.module("bandlab.global").controller("FeedCtrl",["$location","$q","$scope","$state","$stateParams","$timeout","AppNotifications","Goals","Me","PlayerHistory","Post",function(e,t,n,o,r,i,a,s,l,c,u){const d=o.current.name;var p,m=10,f=null,h=!1,g=e.url();async function v(){if(h)return t.resolve([]);let e;const{getAmplitudeFeatureFlag:n}=await Promise.resolve().then((()=>Ap)),o="true"===await n(l,"feed-collaborative-filtering-improve");switch(d){case"feed.trending":e=o?u.fromTrendingExperiment({after:f,genres:l.genres?.map((e=>e.id)).join(",")||"all",limit:m,userId:l.id,musicOnly:r.musicOnly,xAdService:"none"}).$promise:u.fromTrending({after:f,limit:m,genres:l.genres?.map((e=>e.id)).join(",")||"all",userId:l.id,xAdService:"none"}).$promise;break;case"feed.forYou":e=u.fromForYou({after:f,limit:m,userId:l.id,genres:r.genre,timerange:r.period}).$promise;break;default:e=u.fromFollowees({after:f,limit:m,userId:l.id,musicOnly:r.musicOnly}).$promise}return p=e.then((function(e){return h=e.paging.itemsCount<e.paging.limit,f=_.get(e,"paging.cursors.after",0),e.data}))}function b(){return n.infiniteScrollEnded?t.resolve():(p=p.then((function(e){n.infiniteScrollEnded=h,n.posts=n.posts||[];const t=n.posts.length;return n.posts=_.chain(n.posts).concat(e).uniqBy("id").value(),async function(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;"feed.trending"===o.current.name?e="feed_trending":"feed.following"===o.current.name?e="feed_following":"feed.forYou"===o.current.name&&(e="feed_for_you"),e&&TD(e).then((function(o){let{ads:r}=o;r?.forEach((function(o){o.adCreative?.post&&"feed_trending"===e&&(o.adCreative.post.trendingPostType=5),n.ads.set(t+o.position,o)}))}))}(t),c.pushQueueSongs(n.posts.slice(t),g),v()})),p)}n.ads=new Map,n.loadMore=b,n.onPostCreate=function(e){e.canChangePinState=!1,o.is("feed.following")?n.posts.unshift(e):a.addNotification({title:"Post created",classList:"success",autoclose:8e3})},n.user=l,n.goals=s,n.state=o,c.setCurrentPageContext({contentSource:_p(o),loader:b,url:g}),localStorage.setItem("lastSelectedFeed",d),r.genre&&(localStorage.feedFiltersGenre=r.genre),r.period&&(localStorage.feedFiltersPeriod=r.period),v().then(n.loadMore).finally((function(){Promise.resolve().then((()=>lv)).then((function(e){let{logCustomEvent:t}=e;t("feed_load_complete")}))})),n.$on("$revision:changed",(function(e,t){"unpublish"===t.action?Gf(n.posts,(function(e){return e.revision&&e.revision.id===t.revision.id})):"create"===t.action&&t.revision.isPublic&&u.get({id:t.revision.postId}).$promise.then((function(e){n.posts.unshift(e)}))})),n.$on("$post:delete",(function(e,t){Gf(n.posts,(function(e){return e.id===t.post.id}))})),n.$on("$user:relationChanged",(function(e,t){"block"===t.type&&Gf(n.posts,(function(e){return e.creator.id===t.user.id}))})),n.$on("$destroy",(function(){i.cancel(void 0)}))}]),angular.module("bandlab.global").directive("feedFilters",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/global/partials/_feed-filters-308d42bb.html",controller:["$scope","$state","$stateParams","$transitions","Me","Tag",function(e,t,n,o,r,i){e.vm={};const a=e.vm;a.getGenreSummary=function(){if(!a.genres)return;var e;return`${a.periods.find((e=>e.value===a.selectedPeriod)).name}: ${a.selectedGenres.length>1?{one:`${e=a.selectedGenres.length} Genre`,other:`${e} Genres`}[new Intl.PluralRules("en").select(e)]:a.genres.find((e=>e.id===a.selectedGenres[0])).name}`},a.me=r,a.selectGenre=function(e,t){e.stopPropagation(),"all"!==t.id?a.selectedGenres.includes(t.id)?(a.selectedGenres=a.selectedGenres.filter((e=>e!==t.id)),0===a.selectedGenres.length&&(a.selectedGenres=["all"])):(a.selectedGenres.includes("all")&&(a.selectedGenres=[]),a.selectedGenres.push(t.id)):a.selectedGenres=["all"]},a.selectPeriod=function(e,t){e.stopPropagation(),a.selectedPeriod=t},a.updateFilters=function(){e.$broadcast("$dropdownMenu:close"),t.go(".",{genre:a.selectedGenres.join(","),period:a.selectedPeriod})},a.periods=[{name:"Popular today",value:"day"},{name:"Popular this week",value:"week"},{name:"Popular this month",value:"month"}],i.getGenres().then((function(e){a.genres=[{id:"all",name:"All"}].concat(e)})),l();const s=o.onSuccess({},(function(e){l();const{name:n}=e.from(),{name:o}=e.to();n!==o&&Promise.resolve().then((()=>rb)).then((function(e){let{logFeedTabOpen:n}=e;n(t)}))}));function l(){a.isFollowing="feed.following"===t.current.name,a.isForYou="feed.forYou"===t.current.name,a.musicOnly=n.musicOnly,a.selectedGenres=n.genre?.split(","),a.selectedPeriod=n.period}e.$on("$destroy",(function(){s()}))}]}})),angular.module("bandlab.global").directive("flyout",["$animate","Me",function(e,t){return{restrict:"E",replace:!0,scope:{},templateUrl:"https://www.bandlab.com/web-app/global/partials/_flyout-46caa3e8.html",link:function(n,o){function r(){e.leave(o[0],{removeClass:"visible"}),o.off("click",i),n.$digest(),document.body.classList.remove("flyout-visible")}function i(e){(e.target.closest("a")||e.target.closest("button"))&&r()}o.remove(),n.me=t,n.$on("siteTopBar:openFlyout",(function(){e.enter(o[0],document.body,document.body.lastChild),o.on("click",i),setTimeout((()=>{o.addClass("visible"),document.body.classList.add("flyout-visible")}))})),n.$on("siteTopBar:closeFlyout",r)},controller:["$analytics","$scope","$state",function(e,n,o){n.isLandingPages=function(){return o.is("albums")||o.is("boost")||o.is("features")||o.is("fanReach")||o.is("fx")||o.is("fxPreset")||o.is("landing")||o.is("mastering")||o.is("membership")||o.is("upload")||o.is("songStarter")||o.is("crowdReview")||o.is("promoteIt")||o.is("opportunitiesLandingPage")||o.is("distribution")||o.is("splitter")||o.is("products.cakewalk")||o.includes("sounds")},n.hasProductLogoState=function(){return o.is("mastering")||o.is("songStarter")||o.is("fanReach")||o.is("fx")||o.is("fxPreset")||o.is("membership")||o.is("splitter")||o.includes("sounds")},n.shouldOpenInNewTabByDefault=function(){return!(t.isAnonymous()||n.isLandingPages())},n.logOpenEvent=function(t,n){e.eventTrack(t,{platform:"firebase",params:{open_from:n}})};const r=n.$watch((()=>t.isUser()),(()=>{n.productsMenu.find((e=>"Create"===e.label)).items.find((e=>"Studio"===e.title)).state=t.isUser()?"mixEditor":"features",t.isUser()&&(lS(t).then((e=>{let{value:t}=e;n.hasDrops="true"===t})),r())}));n.productsMenu=[{label:"Create",items:[{state:"features",href:null,shouldOpenInNewTab:!1,title:"Studio",description:"Record, mix, and collaborate on your music projects wherever you are",imgSrc:"https://www.bandlab.com/web-app/images/home/studio-fc8210f5fd.svg"},{state:"soundsroot",href:null,shouldOpenInNewTab:!1,title:"Sounds",description:"Get unlimited access to the latest royalty-free artist packs and samples",imgSrc:"https://www.bandlab.com/web-app/images/home/sounds-99340af0dd.svg"},{state:"mastering",href:null,shouldOpenInNewTab:!1,title:"Mastering",description:"Sound your best with free, Grammy-winner designed mastering presets",imgSrc:"https://www.bandlab.com/web-app/images/home/mastering-05e711cb42.svg"},{state:"songStarter",href:null,shouldOpenInNewTab:!1,title:"SongStarter",description:"Generate royalty-free song ideas with our AI-powered feature",imgSrc:"https://www.bandlab.com/web-app/images/home/song-starter-275337685f.svg",isAi:!0},{state:"fx",href:null,shouldOpenInNewTab:!1,title:"Effects",description:"Craft your unique sound with free, diverse effects and presets",imgSrc:"https://www.bandlab.com/web-app/images/home/fx-83cb6ab318.svg"},{state:"splitter",href:null,shouldOpenInNewTab:!1,title:"Splitter",description:"Isolate vocals and instruments from any song",imgSrc:"https://www.bandlab.com/web-app/images/home/splitter-d1b747a215.svg",isAi:!0,isNew:!0}]},{label:"Grow",items:[{state:"boost",href:null,shouldOpenInNewTab:!1,title:"Boost",description:"Reach out to millions of BandLab users by boosting your music or posts",imgSrc:"https://www.bandlab.com/web-app/images/home/boost-4b7911e3ad.svg"},{state:"promoteIt",href:null,shouldOpenInNewTab:!1,title:"Promote",description:"Promote your music in seconds with a customized ad campaign",imgSrc:"https://www.bandlab.com/web-app/images/home/promote-it-369e34e4d1.svg"},{state:"distribution",href:null,shouldOpenInNewTab:!1,title:"Distribution",description:"Release your music on global music streaming platforms beyond BandLab",imgSrc:"https://www.bandlab.com/web-app/images/home/distribution-a6671f798a.svg",isNew:!0},{state:"fanReach",href:null,shouldOpenInNewTab:!1,title:"Fan Reach",description:"Connect with your fans by sending them a personal message",imgSrc:"https://www.bandlab.com/web-app/images/home/fan-reach-b4ce7f1da7.svg",isNew:!0},{state:"crowdReview",href:null,shouldOpenInNewTab:!1,title:"Crowd Review",description:"Get unbiased ratings and advanced insights on your song",imgSrc:"https://www.bandlab.com/web-app/images/home/crowd-review-01501b9b4e.svg"},{state:"opportunitiesLandingPage",href:null,shouldOpenInNewTab:!1,title:"Opportunities",description:"Submit your music to land gigs, features, record deals and more",imgSrc:"https://www.bandlab.com/web-app/images/home/opportunities-35f087adc8.svg"}]},{label:"Earn",items:[{state:null,href:"https://blog.bandlab.com/make-money-with-your-music-the-brand-new-tip-jar/",shouldOpenInNewTab:!0,title:"Tip Jar",description:"Receive tips from fans and listeners who want to support you",imgSrc:"https://www.bandlab.com/web-app/images/home/tipjar-907251b718.svg"},{state:null,href:"https://blog.bandlab.com/category/contests/",shouldOpenInNewTab:!0,title:"Contests",description:"Showcase your talent in a variety of contests to win cash and prizes",imgSrc:"https://www.bandlab.com/web-app/images/home/contests-239721487d.svg"},{state:null,href:"https://licensing.bandlab.com/",shouldOpenInNewTab:!0,title:"Licensing",description:"Start earning money from your music today.",imgSrc:"https://www.bandlab.com/web-app/images/home/licensing-c6efdd83fe.svg",isNew:!0}]},{label:"Other Products",items:[{state:null,href:"https://edu.bandlab.com/",shouldOpenInNewTab:!0,title:"BandLab for Education",description:null,imgSrc:"https://www.bandlab.com/web-app/images/home/other-products-b9ab884f9c.svg"},{state:"products.cakewalk",href:null,shouldOpenInNewTab:!0,title:"Cakewalk by BandLab",description:null,imgSrc:"https://www.bandlab.com/web-app/images/home/other-products-b9ab884f9c.svg"},{state:null,href:"https://blog.bandlab.com/what-is-audiostretch-and-how-do-i-use-it/",shouldOpenInNewTab:!0,title:"AudioStretch",description:null,imgSrc:"https://www.bandlab.com/web-app/images/home/other-products-b9ab884f9c.svg"}]},{label:"Subscriptions",items:[{state:"membership",href:null,shouldOpenInNewTab:!1,title:"Membership",description:null,imgSrc:"https://www.bandlab.com/web-app/images/home/subscription-membership-63762d0044.svg",isNew:!0}]}]}]}}]),angular.module("bandlab.global").component("ftue",{bindings:{goal:"="},templateUrl:"https://www.bandlab.com/web-app/global/partials/_ftue-dd85eca9.html",controller:["$element",function(e){const t=this,n=localStorage.getItem("ftueCards");n?t.cards=n.split(",").reduce((function(e,t){return e[t]=!0,e}),{}):e.remove(),t.dismissCard=function(n){t.cards[n]=!1;const o=Object.keys(t.cards).reduce((function(e,n){return t.cards[n]?[n,...e]:e}),[]);o.length?localStorage.setItem("ftueCards",o):(localStorage.removeItem("ftueCards"),e.remove())}}],controllerAs:"vm"}),angular.module("bandlab.global").component("siteFooter",{controller:["$element","$injector","$state",function(e,t,n){import("./chunk-b39f1dd8.js").then((function(o){let{mountSiteFooter:r}=o;r(e[0],{$injector:t,state:n})}))}]}),angular.module("bandlab.global").component("siteFooterCard",{templateUrl:"https://www.bandlab.com/web-app/global/partials/_site-footer-card-aa29d37d.html"}),angular.module("bandlab.global").component("siteNavBar",{templateUrl:"https://www.bandlab.com/web-app/global/partials/_site-nav-bar-3f60aa7e.html",controller:["$transitions","$state","Me",function(e,t,n){this.me=n,this.isWebview=p(),this.state=t.current.name||t.transition?.to().name.split(".")[0],e.onBefore({},(e=>{const{name:t}=e.to(),{username:o}=e.params();this.state=t.split(".")[0],"user"===this.state&&o===n.username&&(this.state="profile")})),this.isLandingPages=function(){return t.is("albums")||t.is("beats")||t.is("boost")||t.is("careers")||t.is("crowdReview")||t.is("distribution")||t.is("download")||t.is("fanReach")||t.is("features")||t.is("fx")||t.is("fxPreset")||t.is("landing")||t.is("mastering")||t.is("membership")||t.is("opportunitiesLandingPage")||t.is("promoteIt")||t.is("songStarter")||t.is("sounds")||t.is("splitter")||t.is("upload")},this.isFormPages=function(){return t.current.useTopBarForm}}],controllerAs:"vm"}).directive("siteNavBarSpy",(function(){return{controller:["$scope",function(e){document.body.classList.add("nav-bar-visible"),e.$on("$destroy",(function(){document.body.classList.remove("nav-bar-visible")}))}]}})),angular.module("bandlab.global").component("siteTabBar",{templateUrl:"https://www.bandlab.com/web-app/global/partials/_site-tab-bar-1c9bfab9.html",controller:["$rootScope","$scope","$state","Me","Modal",function(e,t,n,o,r){const i=this;n.stackSize=0,this.me=o,this.openFlyout=()=>e.$broadcast("siteTopBar:openFlyout"),this.state=n,this.goBack=function(){let e="feed";return n.is("explore.channel")||o.isAnonymous()?e="explore":n.is("dashboard.fanReach.myFans")||n.is("dashboard.fanReach.settings")?e="dashboard.fanReach":n.is("dashboard.distribution.earnings")&&(e="dashboard.distribution"),n.stackSize?window.history.back():n.go(e)},this.stepsFormGoBack=function(){e.$broadcast("tabBarBack")},this.exitPage=function(){e.$broadcast("topBarExit")},this.goBackLibrary=function(){if(n.includes("library.projects")){const e=n.params.category&&!["recent","my-projects","collaborations","bands"].includes(n.params.category)?"bands":"recent";return n.go("library.projects.songs",{category:e},{inherit:!1})}return n.includes("library.collections")?n.go("library.collections",{},{inherit:!1}):n.includes("library.albums")?n.go("library.albums",{},{inherit:!1}):void 0},this.isMainPageState=function(){return n.includes("sounds")||this.isLandingPageState()},this.isLandingPageState=function(){return n.is("mastering")||n.is("beats")||n.is("boost")||n.is("landing")||n.is("fanReach")||n.is("features")||n.is("fx")||n.is("fxPreset")||n.is("albums")||n.is("signUp")||n.is("distribution")||n.is("download")||n.is("membership")||n.is("songStarter")||n.is("crowdReview")||n.is("promoteIt")||n.is("opportunitiesLandingPage")||n.is("careers")||n.is("splitter")||n.is("playgroundLandingPage")||n.is("products.cakewalk")},this.isOnlyShowingSearchBar=function(){return document.body.classList.contains("sounds-searchResults")},this.isFormPageState=function(){return n.current.useTopBarForm},this.hasProductLogoState=function(){return n.is("mastering")||n.is("distribution")||n.is("songStarter")||n.is("fanReach")||n.is("fx")||n.is("fxPreset")||n.is("membership")||n.is("splitter")},this.handleMembershipTouchpointClick=function(){new r({id:"paywallModal",templateUrl:"https://www.bandlab.com/web-app/membership/partials/_paywall-modal-ee6789e7.html",contentScope:{productAttribution:"top_button",productAttributionGroup:"misc"}}).show()},this.shouldDisplayMembershipTouchpoint=function(){return i.isTopButtonMemFlagEnabled&&"Free"===Ig.plan&&!this.isLandingPageState()&&!n.includes("settings")&&!n.includes("membershipOnboarding")},t.$watch("vm.me.id",(function(){o.isUser()&&Promise.resolve().then((()=>Ap)).then((async e=>{let{getAmplitudeFeatureFlag:t}=e;const n=await t(o,"top_button_mem"),r=await t(o,"band_permissions_update_enabled");i.isTopButtonMemFlagEnabled="true"===n,i.isBandPermissionsUpdateEnabled="true"===r,i.isTopButtonMemFlagEnabled&&Gg(o.id,{useCache:!0,fallbackToFree:!0})}))})),e.$on("$user:viewProfile",((e,t)=>{this.user=t,this.showFanReachTooltip=!localStorage.getItem("fanReachTooltipClosed")})),e.$on("$track:project",((e,t)=>{let{trackPost:n,trackRevision:o,project:r,isPrivatelyShared:i}=t;this.trackPost=n,this.trackRevision=o,this.project=r,this.isPrivatelyShared=i})),function(e){const t=e.pushState;e.pushState=function(){return n.stackSize++,t.apply(e,arguments)}}(window.history),window.addEventListener("popstate",(function(){n.stackSize--}))}],controllerAs:"vm"}),angular.module("bandlab.global").component("siteTopBar",{template:'\n      <nav class="top-bar" role="navigation" ng-include="\'https://www.bandlab.com/web-app/global/partials/_site-top-bar-anonymous-2eb78a4b.html\'" ng-if="vm.me.isAnonymous()"></nav>\n      <nav class="top-bar" role="navigation" ng-include="\'https://www.bandlab.com/web-app/global/partials/_site-top-bar-product-4106ab92.html\'" ng-if="!vm.me.isAnonymous() && (vm.hasProductLogoState() || vm.isLandingPages()) && !vm.state.includes(\'sounds\')"></nav>\n      <nav class="top-bar" role="navigation" ng-include="\'https://www.bandlab.com/web-app/global/partials/_site-top-bar-form-e2dc2c6d.html\'" ng-if="!vm.me.isAnonymous() && vm.hasTopBarFormState()"></nav>\n      <nav class="top-bar" role="navigation" ng-include="\'https://www.bandlab.com/web-app/global/partials/_site-top-bar-sounds-ae9a347b.html\'" ng-if="!vm.me.isAnonymous() && vm.state.includes(\'sounds\')"></nav>\n      <nav class="top-bar" role="navigation" ng-include="\'https://www.bandlab.com/web-app/global/partials/_site-top-bar-ef6329bc.html\'" ng-if="!vm.me.isAnonymous() && !vm.hasProductLogoState() && !vm.hasTopBarFormState() && !vm.isLandingPages() && !vm.state.includes(\'sounds\')"></nav>\n    ',controller:["$analytics","$q","$scope","$state","$transitions","ChatCache","FloatingChat","Identity","Me","Modal","Page","User",function(e,t,n,o,r,i,a,s,l,c,u,d){var p=this;function m(){return d.get({id:l.id}).$promise.then((function(e){p.me.picture.url=e.picture.url}))}p.cache=i,p.me=l,p.state=o,(Zf||Qf&&Jf)&&(p.dropdownVariation="none"),p.hasProductLogoState=function(){return o.is("mastering")||o.is("distribution")||o.is("fanReach")||o.is("fx")||o.is("fxPreset")||o.is("membership")||o.is("songStarter")||o.is("splitter")},p.isLandingPages=function(){return o.is("albums")||o.is("beats")||o.is("boost")||o.is("fanReach")||o.is("features")||o.is("fx")||o.is("fxPreset")||o.is("landing")||o.is("mastering")||o.is("membership")||o.is("upload")||o.is("songStarter")||o.is("crowdReview")||o.is("promoteIt")||o.is("opportunitiesLandingPage")||o.is("distribution")||o.is("splitter")||o.is("playgroundLandingPage")||o.is("products.cakewalk")||o.includes("sounds")},p.hasTopBarFormState=function(){return o.current.useTopBarForm},p.handleMembershipTouchpointClick=function(){new c({id:"paywallModal",templateUrl:"https://www.bandlab.com/web-app/membership/partials/_paywall-modal-ee6789e7.html",contentScope:{productAttribution:"top_button",productAttributionGroup:"misc"}}).show()},p.openConversation=function(e){o.includes("chat")||o.includes("show")?o.go("chat.conversation",{id:e.id}):(e.isMinimized=!1,a.activeConversations=[e])},p.shouldDisplayMembershipTouchpoint=function(){return p.isTopButtonMemFlagEnabled&&"Free"===Ig.plan&&!n.isLandingPages()&&!o.includes("membershipOnboarding")},r.onFinish({},(function(){document.body.classList.remove("scrolled"),document.body.classList.add("top-bar-no-transition"),setTimeout((()=>{document.body.classList.remove("top-bar-no-transition")}))})),r.onSuccess({},ly((function(){l.isUser()&&t.all([s.counters({id:l.id}).$promise,s.getWarning({id:l.id}).$promise,Gg(l.id,{useCache:!0,fallbackToFree:!0})]).then((function(e){let[t,n]=e;p.me.counters={...p.me.counters,...n,...t.counters},u.update()}))}),6e4)),n.$on("profilePictureModal:updated",(function(){m()})),n.$on("$user:changed",(function(e,t){let{action:n}=t;"profilePicture"===n&&m()}));const f=n.$watch("vm.me.id",(function(){n.productsMenu.find((e=>"Create"===e.label)).items.find((e=>"Studio"===e.title)).state=l.isUser()?"mixEditor":"features",l.isUser()&&(Promise.resolve().then((()=>Ap)).then((async e=>{let{getAmplitudeFeatureFlag:t}=e;const n=await t(l,"top_button_mem");p.isTopButtonMemFlagEnabled="true"===n,p.isTopButtonMemFlagEnabled&&Gg(l.id,{useCache:!0,fallbackToFree:!0})})),f())}));n.isLandingPages=function(){return o.is("albums")||o.is("beats")||o.is("boost")||o.is("fanReach")||o.is("features")||o.is("fx")||o.is("fxPreset")||o.is("landing")||o.is("mastering")||o.is("membership")||o.is("upload")||o.is("songStarter")||o.is("crowdReview")||o.is("promoteIt")||o.is("opportunitiesLandingPage")||o.is("distribution")||o.is("splitter")||o.is("playgroundLandingPage")||o.is("products.cakewalk")||o.includes("sounds")},n.shouldOpenInNewTabByDefault=function(){return!(l.isAnonymous()||n.isLandingPages())},n.logOpenEvent=function(t,n){e.eventTrack(t,{platform:"firebase",params:{open_from:n}})},n.productsMenu=[{label:"Create",items:[{state:"features",href:null,shouldOpenInNewTab:!1,title:"Studio",description:"Record, mix, and collaborate on your music projects wherever you are",imgSrc:"https://www.bandlab.com/web-app/images/home/studio-fc8210f5fd.svg"},{state:"soundsroot",href:null,shouldOpenInNewTab:!1,title:"Sounds",description:"Get unlimited access to the latest royalty-free artist packs and samples",imgSrc:"https://www.bandlab.com/web-app/images/home/sounds-99340af0dd.svg"},{state:"mastering",href:null,shouldOpenInNewTab:!1,title:"Mastering",description:"Sound your best with free, Grammy-winner designed mastering presets",imgSrc:"https://www.bandlab.com/web-app/images/home/mastering-05e711cb42.svg"},{state:"songStarter",href:null,shouldOpenInNewTab:!1,title:"SongStarter",description:"Generate royalty-free song ideas with our AI-powered feature",imgSrc:"https://www.bandlab.com/web-app/images/home/song-starter-275337685f.svg",isAi:!0},{state:"fx",href:null,shouldOpenInNewTab:!1,title:"Effects",description:"Craft your unique sound with free, diverse effects and presets",imgSrc:"https://www.bandlab.com/web-app/images/home/fx-83cb6ab318.svg"},{state:"splitter",href:null,shouldOpenInNewTab:!1,title:"Splitter",description:"Isolate vocals and instruments from any song",imgSrc:"https://www.bandlab.com/web-app/images/home/splitter-d1b747a215.svg",isAi:!0,isNew:!0}]},{label:"Grow",items:[{state:"boost",href:null,shouldOpenInNewTab:!1,title:"Boost",description:"Reach out to millions of BandLab users by boosting your music or posts",imgSrc:"https://www.bandlab.com/web-app/images/home/boost-4b7911e3ad.svg"},{state:"promoteIt",href:null,shouldOpenInNewTab:!1,title:"Promote",description:"Promote your music in seconds with a customized ad campaign",imgSrc:"https://www.bandlab.com/web-app/images/home/promote-it-369e34e4d1.svg"},{state:"distribution",href:null,shouldOpenInNewTab:!1,title:"Distribution",description:"Release your music on global music streaming platforms beyond BandLab",imgSrc:"https://www.bandlab.com/web-app/images/home/distribution-a6671f798a.svg",isNew:!0},{state:"fanReach",href:null,shouldOpenInNewTab:!1,title:"Fan Reach",description:"Connect with your fans by sending them a personal message",imgSrc:"https://www.bandlab.com/web-app/images/home/fan-reach-b4ce7f1da7.svg",isNew:!0},{state:"crowdReview",href:null,shouldOpenInNewTab:!1,title:"Crowd Review",description:"Get unbiased ratings and advanced insights on your song",imgSrc:"https://www.bandlab.com/web-app/images/home/crowd-review-01501b9b4e.svg"},{state:"opportunitiesLandingPage",href:null,shouldOpenInNewTab:!1,title:"Opportunities",description:"Submit your music to land gigs, features, record deals and more",imgSrc:"https://www.bandlab.com/web-app/images/home/opportunities-35f087adc8.svg"}]},{label:"Earn",items:[{state:null,href:"https://blog.bandlab.com/make-money-with-your-music-the-brand-new-tip-jar/",shouldOpenInNewTab:!0,title:"Tip Jar",description:"Receive tips from fans and listeners who want to support you",imgSrc:"https://www.bandlab.com/web-app/images/home/tipjar-907251b718.svg"},{state:null,href:"https://blog.bandlab.com/category/contests/",shouldOpenInNewTab:!0,title:"Contests",description:"Showcase your talent in a variety of contests to win cash and prizes",imgSrc:"https://www.bandlab.com/web-app/images/home/contests-239721487d.svg"},{state:null,href:"https://licensing.bandlab.com/",shouldOpenInNewTab:!0,title:"Licensing",description:"Start earning money from your music today.",imgSrc:"https://www.bandlab.com/web-app/images/home/licensing-c6efdd83fe.svg",isNew:!0}]},{label:"Other Products",items:[{state:null,href:"https://edu.bandlab.com/",shouldOpenInNewTab:!0,title:"BandLab for Education",description:null,imgSrc:"https://www.bandlab.com/web-app/images/home/other-products-b9ab884f9c.svg"},{state:"products.cakewalk",href:null,shouldOpenInNewTab:!0,title:"Cakewalk by BandLab",description:null,imgSrc:"https://www.bandlab.com/web-app/images/home/other-products-b9ab884f9c.svg"},{state:null,href:"https://blog.bandlab.com/what-is-audiostretch-and-how-do-i-use-it/",shouldOpenInNewTab:!0,title:"AudioStretch",description:null,imgSrc:"https://www.bandlab.com/web-app/images/home/other-products-b9ab884f9c.svg"}]},{label:"Subscriptions",items:[{state:"membership",href:null,shouldOpenInNewTab:!1,title:"Membership",description:null,imgSrc:"https://www.bandlab.com/web-app/images/home/subscription-membership-63762d0044.svg",isNew:!0}]}]}],controllerAs:"vm"}),angular.module("bandlab.global.redirects",["ui.router"]).config(["$stateProvider",function(e){function t(e){return e.injector().get("Revision").get({id:e.params().id}).$promise.then((function(e){return{state:"track",params:{id:e.postId}}}))}e.state("bandId",{url:"/bands/{id:[a-zA-Z0-9-_]+}",redirectTo:function(e){return e.injector().get("Band").get({id:e.params().id}).$promise.then((function(e){return{state:"band.feed",params:{username:e.username}}}))}}).state("postId",{url:"/posts/{id:[a-zA-Z0-9-_]+}",redirectTo:function(e){return{state:"post",params:{id:e.params().id}}}}).state("oldRevisionId",{url:"/revision/{id:[a-zA-Z0-9-_]+}",redirectTo:t}).state("revisionId",{url:"/revisions/{id:[a-zA-Z0-9-_]+}",redirectTo:t}).state("songId",{url:"/songs/{id:[a-zA-Z0-9-_]+}",redirectTo:function(e){const t=e.injector().get("$state");return e.injector().get("Song").get({id:e.params().id}).$promise.then((function(e){return t.target("track",{id:e.revision.postId,revId:e.revision.id},{song:e})}))}}).state("userId",{url:"/users/{id:[a-zA-Z0-9-_]+}",params:{triggeredFrom:null},redirectTo:function(e){return e.injector().get("User").get({id:e.params().id}).$promise.then((function(t){return{state:"user.feed",params:{username:t.username,triggeredFrom:e.params().triggeredFrom}}}))}}).state("deleteAccount",{url:"/delete-account",redirectTo:"settings.deactivate"}).state("tipJarCampaign",{url:"/tip-jar/activate",redirectTo:"settings.payments"}).state("getStartedSongbookDrops",{url:"/get-started/songbook/drops",redirectTo:"unavailable"}).state("getStartedBeats",{url:"/get-started/beats",redirectTo:"unavailable"}).state("beatDescription",{url:"/beats/:beatId",redirectTo:"unavailable"}).state("redirectDeals",{url:"/deals",redirectTo:function(){window.location.href="https://deals.bandlab.com/"}})}]),angular.module("bandlab.global.routes",["ui.router"]).config(["$stateProvider",function(e){e.state("closeWebview",{url:"/_"}).state("landing",{url:"/",template:'<div id="vue"></div>',controller:["$analytics","$element","$injector","$scope","$state","$rootScope","appActions","AppNotifications","authService","Me","Player","RevisionImporter",function(e,t,n,o,r,i,a,s,l,c,u,d){Promise.all([import("./chunk-e5117f04.js").then((e=>{let{mountHome:t}=e;return t})),import("./chunk-62514720.js").then((e=>{let{detectAvif:t}=e;return t()}))]).then((function(p){let[m,f]=p;const h=m(t[0].querySelector("#vue"),{$analytics:e,$injector:n,$rootScope:i,appActions:a,AppNotifications:s,authService:l,hasAvif:f,Me:c,scope:o,state:r,Player:u,RevisionImporter:d});o.$on("$destroy",(function(){h.unmount()}))})),ql.getItem("accountDeleted")&&(s.addNotification({title:"Your account has been successfully deleted",classList:"success"}),ql.removeItem("accountDeleted"))}]}).state("feed",{url:"/feed",templateUrl:"https://www.bandlab.com/web-app/global/views/feed-layout-492148ad.html",redirectTo:function(e){const t=e.injector().get("Me");if(!t.isAnonymous())return Promise.resolve(t).then((async function(e){function n(){return"feed.trending"!==ql.getItem("lastSelectedFeed")&&e.counters.following?{state:"feed.following"}:{state:"feed.trending"}}return await async function(){const{getAmplitudeFeatureFlag:e}=await Promise.resolve().then((()=>Ap));try{switch(await e(t,"home_screen_default")){case"following":return{state:"feed.following"};case"trending":return{state:"feed.trending"};case"for_you":return{state:"feed.forYou"};case"remember":return function(){const e=ql.getItem("lastSelectedFeed");return e?{state:e}:{state:"feed.trending"}}();default:return n()}}catch(e){return n()}}()}))},resolve:{Goals:["$http","$q","Me",function(e,t,n){return n.goals?t.resolve(n.goals):e.get(`https://www.bandlab.com/api/v1.3/users/${n.id}/goals`).then((e=>e.data.goals||[])).catch((()=>[]))}]}}).state("feed.following",{url:"?musicOnly",views:{feed:{templateUrl:"https://www.bandlab.com/web-app/global/views/feed-posts-36a8144c.html",controller:"FeedCtrl"}}}).state("feed.trending",{url:"/trending",views:{feed:{templateUrl:"https://www.bandlab.com/web-app/global/views/feed-posts-36a8144c.html",controller:"FeedCtrl"}}}).state("feed.forYou",{url:"/for-you?genre&period",params:{genre:["Me",function(e){const t=e.genres?.map((e=>e.id)).join(",");return ql.feedFiltersGenre||t||"hip-hop"}],period:()=>ql.feedFiltersPeriod||"month"},views:{feed:{templateUrl:"https://www.bandlab.com/web-app/global/views/feed-posts-36a8144c.html",controller:"FeedCtrl"}}}).state("feed.following.shout",{url:"/shout?postId",params:{rewriteTracking:function(){return e=>e.replace(/\?postId=.*/g,"")}},reloadOnSearch:!1,resolve:{thePost:["$stateParams","Post",function(e,t){return t.get({id:e.postId}).$promise}]},onEnter:DL,onExit:jL,views:{"overlay@":{templateUrl:"https://www.bandlab.com/web-app/shout/views/shout-image-view-922d75e9.html",controller:["$scope","$state","thePost","Me",function(e,t,n,o){e.post=n,e.$on("$post:delete",(function(e,r){n.id===r.post.id&&t.go("user.feed",{username:o.username})})),e.$on("$user:relationChanged",(function(e,o){"block"===o.type&&n.creator.id===o.user.id&&t.go("^")})),e.updateCounter=function(t){e.post.counters.comments=t(e.post.counters.comments)}}]}}}).state("onboarding",{url:"/onboarding?force",reloadOnSearch:!1,redirectTo:function(e){if(e.injector().get("Me").isOnboarded&&!e.params().force)return{state:Oc,params:{}}},controller:["$analytics","authService","completeProfile",function(e,t,n){e.pageTrack("/onboarding/complete-profile"),n.start().then((function(){n.stop()})).then((function(){return t.redirectAfterAuth()}))}]}).state("download",{url:"/download",template:'<div id="vue"></div>',controller:["$document","$location","$element","$injector","$scope","$state",function(e,t,n,o,r,i){Promise.all([import("./chunk-7d8595ef.js").then((e=>{let{mountDownloadPage:t}=e;return t})),import("./chunk-62514720.js").then((e=>{let{detectAvif:t}=e;return t()})),Promise.resolve().then((()=>Du)).then((e=>{let{getLandingPageDownload:t}=e;return t()}))]).then((function(e){let[t,a,s]=e;const l=t(n[0].querySelector("#vue"),{$injector:o,contentful:s,hasAvif:a,state:i});r.$on("$destroy",(function(){l.unmount()}))})),setTimeout((function(){const n=t.hash();if(n){const t=angular.element(document.getElementById(n));e.scrollToElementAnimated(t,40)}}))}]}).state("features",{url:"/creation-features",template:'<div id="vue"></div>',controller:["$element","$injector","$scope","$state","Me","authService",function(e,t,n,o,r,i){Promise.all([import("./chunk-80330d00.js").then((e=>{let{mountFeatures:t}=e;return t})),import("./chunk-62514720.js").then((e=>{let{detectAvif:t}=e;return t()}))]).then((a=>{let[s,l]=a;const c=s(e[0].querySelector("#vue"),{$injector:t,authService:i,hasAvif:l,Me:r,scope:n,state:o});n.$on("$destroy",(()=>c.unmount()))}))}]}).state("albumsRedirect",{url:"/albums",redirectTo:"albums"}).state("albums",{url:"/features/albums",templateUrl:"https://www.bandlab.com/web-app/global/views/features-albums-324cf5c5.html",controller:["$scope",function(e){e.mobileOS=Yf?"Android":"iOS"}]}).state("warning",{url:"/community-guidelines/warnings/{id}",template:'<div id="vue"></div>',resolve:{theWarning:["$http","$stateParams","Me",function(e,t,n){return e.get(`https://www.bandlab.com/api/v1.3/users/${n.id}/warnings/${t.id}`).then((function(o){return e.patch(`https://www.bandlab.com/api/v1.3/users/${n.id}/warnings/${t.id}`,{ViewedOn:(new Date).toISOString()}).then((function(){const e=o.data.link;return e&&window.location.href!==e&&(window.location.href=e),o}))}))}]},controller:["$element","$scope","$injector","theWarning",function(e,t,n,o){import("./chunk-487a321d.js").then((r=>{let{mountAccountWarning:i}=r;const a=i(e[0].querySelector("#vue"),{$injector:n,theWarning:o});t.$on("$destroy",(()=>a.unmount()))}))}]}).state("nda",{url:"/nda?success",templateUrl:"https://www.bandlab.com/web-app/global/views/nda-1a85cd00.html",resolve:{script:function(){return xc("//na3.docusign.net/clickapi/sdk/latest/docusign-click.js")}},controller:["$scope","$state","$stateParams",function(e,t,n){e.changeSuccess=!!n.success,e.onSubmit=function(){window.location.href=`https://na3.docusign.net/clickapi/v1/accounts/3778278b-24ac-40c6-9746-eefee6b00aca/clickwraps/f5539f41-f0c9-44ed-947e-3487b53286a9/view?client_user_id=${e.user.email} ${new Intl.DateTimeFormat("en-US").format(e.user.date)}&return_url=${t.href(".",{success:!0},{absolute:!0})}`}}]})}]),angular.module("bandlab.library",[]);const mG=rd((function(e){return Promise.resolve().then((()=>Ap)).then((function(t){let{getAmplitudeFeatureFlag:n}=t;return n(e,"library-tracks")})).then((function(e){return"on"===e}))})),fG=Object.freeze(Object.defineProperty({__proto__:null,getLibraryTracksFeatureFlag:mG},Symbol.toStringTag,{value:"Module"}));function hG(e,t){const n=e.items[0].fields[t].sys.id;return e.includes.Entry.find((e=>e.sys.id===n))}function gG(e,t){return t?.length>0?t.map((t=>e.includes.Entry.find((e=>e.sys.id===t?.sys?.id)))):e.includes.Entry.find((e=>e.sys.id===t?.sys.id))}function vG(e,t,n){return e.includes.Asset.find((e=>e.sys.id===t.fields[n].sys.id)).fields.file?.url}function bG(e,t){return t.Entry.find((t=>t.sys.id===e.sys.id))}function yG(e,t){const n=t.Asset.find((t=>t.sys.id===e.sys.id));return{url:n.fields.file.url,alt:n.fields.description}}function wG(e,t){return e&&e.length?function(e,t){for(var n,o=-1,r=e.length;++o<r;){var i=t(e[o]);void 0!==i&&(n=void 0===n?i:n+i)}return n}(e,Vf(t)):0}function $G(e,t){return e<t}function kG(e){const t=240&e[0],n=e[2];return t===Zq&&0===n}angular.module("bandlab.library.routes",["ui.router"]).config(["$stateProvider",function(e){const t=["recent","my-projects","collaborations","bands","deleted"];function n(e){const t=document.querySelector(".library-filtered-title");t&&(t.textContent=e)}e.state("library",{url:"/library",redirectTo:"library.projects.songs",templateUrl:"https://www.bandlab.com/web-app/library/views/library-layout-500cb863.html",resolve:{theUser:["Me",function(e){return e}]},controller:["$scope","Me",function(e,t){e.isOwnProfile=!0,e.me=t,Promise.resolve().then((()=>fG)).then((function(e){let{getLibraryTracksFeatureFlag:n}=e;return n(t)})).then((function(t){e.libraryTracksEnabled=t}))}]}).state("library.projects",{url:"/projects",redirectTo:"library.projects.songs",templateUrl:"https://www.bandlab.com/web-app/library/views/library-projects-9cdd1905.html",controller:["$scope","$state","Band","Me",function(e,t,n,o){(function e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return n.fromUser({userId:o.id,offset:e.length,limit:50}).$promise}(t).then((function(n){return t=t.concat(n),n.length<50?t:e(t)}))})().then((e=>_.sortBy(e,(e=>e.name.toLowerCase())))).then((function(t){e.bands=t})),e.category="recent",e.$on("$band:changed",(function(t,n){"create"===n.action&&e.bands.unshift(n.band)})),e.selectCategory=function(e){t.go(".",{category:e})}}]}).state("library.projects.likes",{url:"/likes",onEnter:function(){document.body.classList.add("library-filtered"),n("Liked Music")},onExit:function(){document.body.classList.remove("library-filtered")},views:{list:{templateUrl:"https://www.bandlab.com/web-app/library/views/library-liked-posts-05177ad2.html",controller:"LikedMusicCtrl"}}}).state("library.projects.songs",{url:"/:category?filter&search",params:{category:"recent",rewriteTracking:["$stateParams",function(e){return n=>-1!==t.indexOf(e.category)?n:"/library/projects/band"}],search:{dynamic:!0}},resolve:{theBand:["$q","$stateParams","Band",function(e,n,o){return-1!==t.indexOf(n.category)?e.resolve():o.get({id:n.category.toLowerCase()}).$promise}],theUser:["$q","Me",function(e,t){return e.resolve(t)}]},onEnter:["$stateParams","theBand",function(e,t){switch(e.category){case"recent":break;case"my-projects":document.body.classList.add("library-filtered"),n("My Projects");break;case"collaborations":document.body.classList.add("library-filtered"),n("Collaborations");break;case"bands":document.body.classList.add("library-filtered"),n("Band Projects");break;case"deleted":document.body.classList.add("library-filtered"),n("Deleted Projects");break;default:document.body.classList.add("library-filtered"),t?.name&&n(t.name)}}],onExit:function(){document.body.classList.remove("library-filtered")},views:{header:{templateUrl:function(e){if("deleted"!==e.category)return"https://www.bandlab.com/web-app/library/views/library-projects-header-facf9864.html"},controller:["$scope","theBand",function(e,t){e.band=t}]},list:{templateUrl:function(e){return"deleted"===e.category?"https://www.bandlab.com/web-app/account/settings/views/deleted-projects-edit-9df9f9cd.html":"https://www.bandlab.com/web-app/project/views/projects-list-65d91317.html"},controller:"ProjectsCtrl"}}}).state("library.tracks",{url:"/tracks",redirectTo:"library.tracks.self",templateUrl:"https://www.bandlab.com/web-app/library/views/library-tracks-249bbadb.html"}).state("library.tracks.likes",{url:"/likes",redirectTo:function(e){const t=e.injector().get("Me");return mG({id:t.id}).then((function(e){if(!e)return"404"}))},views:{list:{templateUrl:"https://www.bandlab.com/web-app/library/views/library-liked-posts-05177ad2.html",controller:"LikedMusicCtrl"}}}).state("library.tracks.playbackhistory",{url:"/playback-history",redirectTo:function(e){const t=e.injector().get("Me");return mG({id:t.id}).then((function(e){if(!e)return"404"}))},views:{list:{templateUrl:"https://www.bandlab.com/web-app/playbackhistory/views/playback-history-f3affb7c.html",controller:"PlaybackHistoryCtrl"}}}).state("library.tracks.self",{url:"/:category?filter&search",params:{category:"recent",search:{dynamic:!0}},redirectTo:function(e){const t=e.injector().get("Me");return mG({id:t.id}).then((function(e){if(!e)return"404"}))},views:{header:{templateUrl:"https://www.bandlab.com/web-app/library/views/library-tracks-header-2e91c874.html"},list:{templateUrl:"https://www.bandlab.com/web-app/track/views/tracks-list-dce92255.html",controller:"TracksCtrl"}}}).state("library.collections",{url:"/collections?filter&likes&search",params:{rewriteTracking:["$stateParams",function(e){return()=>"/library/collections"+(e.likes?"/likes":"")}],search:{dynamic:!0}},onEnter:["$stateParams",function(e){e.likes&&(document.body.classList.add("library-filtered"),n("Liked Playlists"))}],onExit:function(){document.body.classList.remove("library-filtered")},templateUrl:"https://www.bandlab.com/web-app/library/views/library-collections-8261e8d4.html",controller:"UserCollectionsCtrl"}).state("library.albums",{url:"/albums?filter&purchased&likes&search",params:{search:{dynamic:!0}},onEnter:["$stateParams",function(e){e.likes?(document.body.classList.add("library-filtered"),n("Liked Albums")):e.purchased&&(document.body.classList.add("library-filtered"),n("Purchased Albums"))}],onExit:function(){document.body.classList.remove("library-filtered")},templateUrl:"https://www.bandlab.com/web-app/library/views/library-albums-92e8ce2d.html",controller:"UserAlbumsCtrl"}).state("library.bands",{url:"/bands?role&search",params:{rewriteTracking:["$stateParams",function(e){return()=>"/library/bands"+(e.role?`/${e.role}`:"")}],search:{dynamic:!0}},templateUrl:"https://www.bandlab.com/web-app/library/views/library-bands-c542555f.html",controller:"UserBandsCtrl"}).state("library.communities",{url:"/communities?role&search",params:{search:{dynamic:!0}},templateUrl:"https://www.bandlab.com/web-app/library/views/library-communities-50e94398.html",controller:"UserCommunitiesCtrl"})}]),angular.module("bandlab.library").controller("LikedMusicCtrl",["$location","$q","$scope","Me","PlayerHistory","Post",function(e,t,n,o,r,i){var a,s=5,l=null,c=!1,u=e.url();function d(){return c?t.resolve([]):a=i.liked({userId:n.user.id,types:"revision",after:l,limit:s}).$promise.then((function(e){return c=e.data.length<s,l=_.get(e,"paging.cursors.after",0),e.data}))}function p(){return n.infiniteScrollEnded?t.resolve():a=a.then((function(e){return n.infiniteScrollEnded=c,n.posts=n.posts||[],n.posts=n.posts.concat(e),r.pushQueueSongs(e,u),d()}))}n.user=o,n.loadMore=p,r.setCurrentPageContext({loader:p,url:u}),d().then(n.loadMore)}]),angular.module("bandlab.web").directive("colorfulPicture",(function(){return{restrict:"E",replace:!0,template:'<span class="colorful-picture"><img></span>',link:function(e,t,n){const o=t[0].querySelector("img"),r=n.src?e.$eval(n.src):`${e.me.picture.url}40x40`;t[0].style.setProperty("--colorful-picture-src",`url(${r})`),o.src=r}}})),angular.module("bandlab.web").component("librarySearch",{bindings:{refresh:"&"},template:'\n    <div class="search-form search-form-40">\n      <input\n        type="search"\n        enterkeyhint="search"\n        class="search-form-input"\n        ng-model="search"\n        placeholder="Search">\n      <span class="search-form-submit">\n        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">\n          <path fill-rule="evenodd" clip-rule="evenodd" d="m6.7 18.7-4 4-1.4-1.4 4-4 1.4 1.4ZM14 3a7 7 0 1 0 0 14 7 7 0 0 0 0-14Zm-9 7a9 9 0 1 1 18 0 9 9 0 0 1-18 0Z" fill="currentColor"/>\n        </svg>\n      </span>\n      <button class="search-form-clear" type="button" ng-click="search = \'\'" ng-show="search && !vm.loading">\n        \x3c!-- Icon/x --\x3e\n        <svg ng-show="search && !vm.loading" width="16" height="16" viewBox="0 0 16 16" fill="none">\n          <path d="m8 8.94 4.53 4.53.94-.94L8.94 8l4.53-4.53-.94-.94L8 7.06 3.47 2.53l-.94.94L7.06 8l-4.53 4.53.94.94L8 8.94Z" fill="currentColor"/>\n        </svg>\n      </button>\n      <span class="search-form-loader" ng-if="vm.loading">\n        <i class="loader-spinner"></i>\n      </span>\n    </div>\n    ',controller:["$state","$scope",function(e,t){const n=this;t.search=e.params.search,t.$watch("search",(function(e,t){n.loading=e!==t,o()}));const o=ay((function(){angular.isUndefined(t.search)||t.search===e.params.search?n.loading=!1:e.go(".",{search:t.search}).then((function(){return n.refresh({search:t.search})})).then((function(){n.loading=!1}))}),500)}],controllerAs:"vm"}),angular.module("bandlab.membership",[]),angular.module("bandlab.membership").controller("PaywallModalCtrl",["$rootScope","$scope","$state","$stateParams","AppNotifications","Me",function(e,t,n,o,r,i){t.billingInterval="Month",t.product="membership",t.redirectUrl=encodeURIComponent(JSON.stringify({name:n.current.name,params:Yk(o)})),t.getSubscribeLabel=function(e){return t.hasTrialPeriodExperiment&&t.isTrialAvailable&&"Month"===e?{one:"Try Free for 3 Day",other:"Try Free for 3 Days"}[new Intl.PluralRules("en").select(3)]:"Subscribe"},t.isReady=!1;const a=Ip("splitter_piano_enabled");Promise.allSettled([Mp(i,"trial_period").catch((e=>({error:e}))),Fu(i).catch((e=>({error:e}))),Gg(i.id).catch((e=>({error:e})))]).then((n=>{let[o,i,a]=n;if(t.hasTrialPeriodExperiment="on"===o.value,t.promoCampaign=i.value,"rejected"===a.status)return r.addNotification({title:"Membership service is down. Please try again later",classList:"warning",autoclose:5e3});"Free"!==a.value.plan&&(r.addNotification({title:"You already have BandLab Membership",classList:"warning",autoclose:8e3}),e.$broadcast("paywallModal","close")),t.isTrialAvailable=!a.value.isTrialUsed})).finally((()=>{t.isReady=!0,t.$apply()})),t.frequency=function(e){return"Year"===e?"yearly":"monthly"},t.$watchGroup(["hasTrialPeriodExperiment","isTrialAvailable","promoCampaign"],(function(){!function(){const e={title:'Power your creator journey with \n          <div class="paywall-modal-star">\n            <img src="https://www.bandlab.com/web-app/images/membership/membership-crown-a67deced58.svg">\n            Membership\n          </div>\n        ',subtitle:"Unlock these exclusive features and accelerate your music goals with BandLab Membership.",campaignImageDesktop:"https://www.bandlab.com/web-app/images/membership/paywall-desktop-685fcc09fa.png",campaignImageTablet:"https://www.bandlab.com/web-app/images/membership/paywall-tablet-c7dfb391cb.png",campaignImageMobile:"https://www.bandlab.com/web-app/images/membership/paywall-mobile-d80906d0d7.png"};if(t.promoCampaign){const[r]=t.promoCampaign.items,i={title:(n=r,o="title",n.fields[o].content[0].content),subtitle:r.fields.subtitle,campaignImageDesktop:r.fields.campaignImageDesktop&&vG(t.promoCampaign,r,"campaignImageDesktop"),campaignImageTablet:r.fields.campaignImageTablet&&vG(t.promoCampaign,r,"campaignImageTablet"),campaignImageMobile:r.fields.campaignImageMobile&&vG(t.promoCampaign,r,"campaignImageMobile")};Object.assign(e,i)}var n,o;t.contentData=e}(),function(){const e=[{value:"Year",badgeCopy:"Save 16%",title:"Annual, $149.5/year",description:"Only $12.46 per month"},{value:"Month",title:"Monthly, $14.95/mo",description:t.hasTrialPeriodExperiment&&t.isTrialAvailable?"3 days free trial":"",highlightDescription:!0}];if(t.promoCampaign){const[n]=t.promoCampaign.items,o=n.fields.billingIntervals&&gG(t.promoCampaign,n.fields.billingIntervals),r=o&&o.map((e=>e.fields));return t.billingIntervals=r||e,void(n.fields.defaultBillingInterval&&(t.billingInterval=n.fields.defaultBillingInterval))}t.billingIntervals=e}()})),t.features=[{title:"AI vocal tools",subtitle:"Polish your audio with Voice Cleaner and transform your vocals to 370+ instruments with VoicetoMIDI.",image:"https://www.bandlab.com/web-app/images/membership/paywall-ai-vocal-tools-image-baa11851de.svg",link:n.href("membership")},{title:"Bonus Splitter features",subtitle:a.value?"Isolate guitar and piano tracks. Jump the queue when demand is high.":"Enjoy faster stem separation speeds, and an additional guitar stem split to practice those solos.",image:"https://www.bandlab.com/web-app/images/membership/paywall-bonus-splitter-features-image-ba098354ed.svg",link:"https://blog.bandlab.com/splitter-updated-features/"},{title:"32track Studio",subtitle:"Double your 16track limit in Studio for even more creative possibilities.",image:"https://www.bandlab.com/web-app/images/membership/paywall-32-track-studio-image-90c8047f59.svg",link:n.href("membership")},{title:"Mastering upgrades",subtitle:"Unlock new presets for genres like acoustic and cinematic, plus preset intensity controls for more control over your desired sound.",image:"https://www.bandlab.com/web-app/images/membership/paywall-4-new-mastering-presets-image-f97148350d.svg",link:n.href("membership")},{title:"Opportunities",subtitle:"Apply to unlimited Opportunities for a chance to land record deals, radio play, and sync placements.",image:"https://www.bandlab.com/web-app/images/membership/paywall-opportunities-image-58082d4f1e.svg",link:"http://bnd.la/opportunities"},{title:"Distribution",subtitle:"Release your music to major music platforms, reach global audiences and keep 100% of your royalties.",image:"https://www.bandlab.com/web-app/images/membership/paywall-distribution-image-594cb4d100.svg",link:"https://blog.bandlab.com/intro-to-bandlab-distribution/"},{title:"Fan Reach",subtitle:"Engage your biggest supporters with customized messages and expand your fanbase.",image:"https://www.bandlab.com/web-app/images/membership/paywall-fan-reach-image-ac49cc959f.svg",link:n.href("membership")},{title:"Platform perks",subtitle:"Steal the spotlight on BandLab with Profile Boost, a custom profile banner, and multiple profile photos.",image:"https://www.bandlab.com/web-app/images/membership/paywall-platform-perks-image-a157f295a0.svg",link:n.href("membership")}],t.openCheckoutModal=function(e){t.onOpenCheckoutModal?.(),_g(zn((()=>import("./chunk-f7348b60.js"))),{onSuccess:t.checkoutSuccess,checkoutProps:{contentId:t.contentId,frequency:e,product:t.product,productAttribution:t.productAttribution,productAttributionGroup:t.productAttributionGroup,source:t.source,triggeredFrom:t.triggeredFrom}},{escapeClose:!1})},t.isObject=function(e){return angular.isObject(e)},Promise.resolve().then((()=>rb)).then((function(e){let{logMembershipPaywallModalOpen:n}=e;n(t.productAttribution,t.source,t.contentId,t.productAttributionGroup)}))}]),angular.module("bandlab.editor").directive("midiEditor",["EditorHelper","EditorHistory","EditorRevision","EditorScroll","EditorScrollState","EditorState","EditorTrack","MidiEditor","MidiEditorState","Soundbank",function(e,t,n,o,r,i,a,s,l,c){return{replace:!0,restrict:"E",scope:{actionShortcut:"=",getViewMode:"=",getPreferSharps:"=",savePreferSharps:"="},templateUrl:"https://www.bandlab.com/web-app/midi/partials/_midi-editor-d0cddeb1.html",link:function(e){function t(e){e&&o.focusedNotesRescale(e)}t(),gR.add("scale:notesTimeline",t),e.$on("$destroy",(function(){gR.remove("scale:notesTimeline",t)}))},controller:["$scope",function(o){function u(t){const n=s.getSelectedNotes();if(!n.length)return;const{snapDuration:i}=l,a=t*i,c=-_.minBy(n,"time").time,u=s.getShortestNoteToRegionEndDuration();t<0&&a<c||t>0&&a>u||(n.forEach((t=>{t.time=e.snapToGrid(t.time+a,i,{padding:i/2},l)})),s.updateRegions(),o.$applyAsync((()=>{!function(){const{scalePx:e,track:t,selectedNotesByRegion:n}=l,o=s.getSelectedNotes();if(!o.length)return;const i=t.regions.filter((e=>n[e.id])).sort(((e,t)=>e.startPosition-t.startPosition)),a=i[0].startPosition,c=i[i.length-1].startPosition,u=_.minBy(o,"time"),d=_.maxBy(o,(e=>e.time+e.duration)),p=(a+u.time)*e,m=(c+d.time+d.duration)*e-p,f=r.notesTimelineEl.getBoundingClientRect().width-Al-17;r.notesLeft=As(p-(f-m)/2,0,JS.SONG_DURATION_MAX*e)}()})))}function d(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=s.getSelectedNotes();if(!n.length)return;const i=QF.value&&!t,a=i?SB(n):s.getSelectedNotesBoundaries(n);e=Math.max(e,a.infDeltaMidiNote),e=Math.min(e,a.supDeltaMidiNote),n.forEach((function(t){i?t.midiNote=kB(t.midiNote,e):t.midiNote+=e})),s.previewSoloNote(n[0]),s.updateRegions(),t&&cB(),o.$applyAsync((()=>{!function(e){const{notesEl:t}=r,n=document.querySelector(".midi-editor-note.is-selected").getBoundingClientRect().y-s.getNoteHeight()*e,o=t.getBoundingClientRect().top+(t.clientHeight-17)/2;r.notesTop=o>=n?Math.max(0,r.notesTop-(o-n)):Math.min(t.scrollHeight,r.notesTop+(n-o))}(e)}))}function p(){if(l.track.samplerKit)return!1;if(!l.track.soundbank)return!0;const e=c.getPropertyValue(l.track.soundbank,"instrumentSlug");return"drum-pads"!==e&&"drum-kit"!==e&&"special-effects"!==e}o.state=i,o.midiEditorState=l,o.copyNotes=s.copyNotes,o.cutNotes=s.cutNotes,o.deleteNotes=s.deleteNotes,o.getNoteColor=s.getNoteColor,o.getNoteHeight=s.getNoteHeight,o.getNotePositionY=s.getNotePositionY,o.pasteNotes=s.pasteNotes,o.quantizeNotes=s.quantizeNotes,o.selectNotesOfSamePitch=s.selectNotesOfSamePitch,o.snapSettings=$l,o.transposeNotes=s.transposeNotes,o.copyNotesToNewTrack=function(e){t.pushUndo(n.current);var o=a.duplicateTrack(l.track);s.copyNotesToTrack(l.track,o,e),a.setSelected(o)},o.$on(yT,s.copyNotes),o.$on(wT,s.cutNotes),o.$on($T,s.deleteNotes),o.$on(CT,s.pasteNotes),o.$on(ET,(()=>s.quantizeNotes())),o.$on(IT,s.selectAllNotes),o.$on(kT,(()=>d(-1))),o.$on(MT,(()=>d(1))),o.$on(ST,(()=>d(-12,!0))),o.$on(TT,(()=>d(12,!0))),o.$on(_T,(()=>u(-1))),o.$on(PT,(()=>u(1))),l.isPianoRoll=p(),s.scrollToNotes(),o.$watch((function(){return l.isVisible?n.selectedTrack:{}}),(function(t,n){t.type!==Ks?t.soundbank||t.samplerKit?(l.addedNotesByRegion={},l.notesByRegion={},l.removedNotesByRegion={},l.selectedNotesByRegion={},l.track=t,t.id===n.id&&t.soundbank===n.soundbank||(l.isPianoRoll=p(),s.scrollToNotes())):e.displayAudioEditor():e.hidePanel()}))}]}}]),angular.module("bandlab.editor").directive("midiEditorAreaSelection",["EditorScrollState","MidiEditor","MidiEditorState","SharedMidiSynth",function(e,t,n,o){return{replace:!0,restrict:"A",link:function(r,i){const a=document.body.querySelector(".mix-editor-panel-track");function s(e){let{left:t=0,top:n=0,width:o=0,height:r=0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};requestAnimationFrame((function(){e.style.left=`${t}px`,e.style.top=`${n}px`,e.style.width=`${o}px`,e.style.height=`${r}px`}))}i.on("pointerdown",(function(l){if(l.preventDefault(),n.isDrawing||n.isDrawingWithShortcut||l.target!==i[0]&&!l.target.classList.contains("midi-editor-region")||3===l.which)return;const c=a.getBoundingClientRect().toJSON();c.top+=70,c.height-=70;const u={x:l.x+e.notesLeft,y:l.y+e.notesTop};t.unselectNotes(),o.stopNotes();const d=document.createElement("div");function p(o){o.preventDefault(),t.autoscroll({x:o.clientX,y:o.clientY},c);const i=o.x+e.notesLeft,a=o.y+e.notesTop,l=function(o,r,i){const a=293+t.getMidiRollLabelsWidth(),s=e.notesEl.scrollHeight-xl-17-1,l=o.y<r.y?Math.min(s,s-(o.y-i.top)):Math.min(s,o.y-i.top),c=o.x<r.x?n.containerWidth-(o.x-a):o.x-a;return{left:Math.max(Math.min(o.x,r.x)-a,0),top:Math.max(Math.min(o.y,r.y)-i.top,0),width:Math.min(Math.abs(r.x-o.x),c),height:Math.min(Math.abs(r.y-o.y),l)}}(u,{x:i,y:a},c);s(d,l),r.$broadcast(RT,l)}d.classList.add("midi-editor-area-selection"),s(d),i[0].appendChild(d),i[0].setPointerCapture(l.pointerId),r.$broadcast(RT,{}),angular.element(window).on("pointerup",(function e(){d.remove(),angular.element(window).off("pointerup",e),i.off("pointermove",p)})),i.on("pointermove",p)}))}}}]),angular.module("bandlab.editor").directive("midiEditorFocus",["MidiEditorState",function(e){return{restrict:"A",link:function(t,n){function o(){e.hasFocus||(e.hasFocus=!0,document.addEventListener("pointerdown",r,{capture:!0}))}function r(t){t.target.closest("[midi-editor-focus]")||t.target.closest(".audio-editor-region")||t.target.closest(".dropdown")||t.target.closest(".select-menu")||(e.hasFocus=!1,document.removeEventListener("pointerdown",r))}n[0].addEventListener("pointerdown",o,{capture:!0}),t.$on("$destroy",(function(){e.hasFocus=!1,n[0].removeEventListener("pointerdown",o,{capture:!0}),document.removeEventListener("pointerdown",r,{capture:!0})}))}}}]),angular.module("bandlab.editor").directive("midiEditorGrid",["EditorGrid","MidiEditorState",function(e,t){return{replace:!0,restrict:"E",templateUrl:"https://www.bandlab.com/web-app/midi/partials/_midi-editor-grid-d7f78aae.html",link:function(n){var o=document.getElementById("midi-editor-grid-pattern");function r(){e.updateRulerGrid({pattern:o,state:t})}n.$watchGroup(["midiEditorState.snapSetting","state.isTimeRuler"],r),gR.add("scale:notesTimeline",r)}}}]).directive("midiEditorGridVue",(function(){return{replace:!0,restrict:"E",template:"<div></div>",link:async function(e,t){import("./chunk-34b1cf43.js").then((n=>{let{mount:o}=n;const r=o(t[0]);e.$on("$destroy",r.unmount)}))}}})),angular.module("bandlab.editor").directive("midiEditorHeader",["MidiEditorState",function(e){return{replace:!0,restrict:"E",templateUrl:"https://www.bandlab.com/web-app/midi/partials/_midi-editor-header-a6dc3467.html",compile:function(e){const t=o_.map((function(e){return`<span class="midi-editor-drums-label" title="${e.name}" data-midi-code="${e.midi}" ng-class="{ active: isActive(${e.midi}), mapped: isMapped(${e.midi}) }"><icon-svg size="24" name="instrument-drum-${e.icon}"></icon-svg></span>`})).reverse().join(""),n=p_.map((function(e){return`<span class="midi-editor-pad-label {{ getColor(${e.midi}) }}" data-midi-code="${e.midi}" ng-class="{ active: isActive(${e.midi}), mapped: isMapped(${e.midi}) }">${e.shortcut}</span>`})).reverse().join("");e[0].querySelector(".midi-editor-drums").innerHTML=t,e[0].querySelector(".midi-editor-pads").innerHTML=n},controller:["$scope","editorEvents","EditorHistory","MidiEditor","SharedMidiSynth","Soundbank",function(t,n,o,r,i,a){const s=i.getSampler();t.press=r.previewNote,t.release=r.stopPreviewNote,t.$on("MidiMessage:noteEvent",(function(){t.$digest()})),t.$on(n.keyDown.toggleVelocity,(function(){t.toggleVelocity(),t.$apply()})),t.isActive=function(e){return!!i.current[e]||!!r.activePreviewNotes[e]},t.isMapped=function(t){return e.track?.soundbank?i.isNoteMapped(t):s.pads[fC(t)]?.id},t.getColor=function(e){const t=fC(a.getNoteWithOctave(e));return mC[s.pads[t]?.color]},t.toggleVelocity=function(){e.isVelocity=!0,e.isDrawing=!1,e.isDrawingWithShortcut=!1},t.getVelocity=function(){const t=0!==Object.keys(e.editingNotesByRegion).length?e.editingNotesByRegion:e.selectedNotesByRegion,n=e.track.regions.flatMap((function(e){return t[e.id]})).filter((e=>!!e));return n.length?wG(n,"velocity")/n.length:0},t.updateVelocity=function(){r.finishEditVelocity(),o.withSingleUndo((()=>{r.updateRegions()})),t.$applyAsync()};const l=uB.value.map((e=>t.$watch((()=>t.isActive(e)),(()=>{hB.value[e]=t.isActive(e)})))),c=uB.value.map((e=>t.$watch((()=>t.isMapped(e)),(()=>{gB.value[e]=t.isMapped(e)}))));t.$on("$destroy",(()=>{l.forEach((e=>e())),c.forEach((e=>e()))}))}]}}]).directive("midiEditorHeaderVue",["MidiEditor","MidiEditorState",function(e,t){return{replace:!0,restrict:"E",template:'<div class="midi-editor-header-menu"></div>',link:async function(n,o){const r=Mt({hasSelectedNotes:n.hasSelectedNotes(),isPianoRoll:t.isPianoRoll,isTrackTransposable:n.isTrackTransposable(),humanizeNotes:e.humanizeNotes,quantizeNotes:e.quantizeNotes,quantizationValue:t.quantizationValue,setLegato:e.setLegato,selectQuantizationValue:e=>{t.quantizationValue=e,n.$digest()},transposeNotes:e.transposeNotes});n.$watchGroup([()=>e.hasSelectedNotes(),()=>n.isTrackTransposable(),"midiEditorState.isPianoRoll","midiEditorState.quantizationValue"],(()=>{r.hasSelectedNotes=n.hasSelectedNotes(),r.isPianoRoll=t.isPianoRoll,r.isTrackTransposable=n.isTrackTransposable(),r.quantizationValue=t.quantizationValue})),import("./chunk-38455b55.js").then((i=>{let{mount:a}=i;const s=a(o[0],{scope:n,MidiEditor:e,MidiEditorState:t},r);n.$on("$destroy",s.unmount)}))}}}]).directive("midiEditorHeaderPianoRoll",["EditorPlayer","EditorScrollState","MidiEditor",function(e,t,n){return{replace:!0,restrict:"E",template:"<div></div>",link:async function(o,r){import("./chunk-1e63d783.js").then((i=>{let{mount:a}=i;const s=a(r[0],{scope:o,EditorScrollState:t,EditorPlayer:e,MidiEditor:n});o.$on("$destroy",s.unmount)}))}}}]),angular.module("bandlab.editor").directive("midiEditorTrackGrid",["EditorGrid","MidiEditorState",function(e,t){return{replace:!0,restrict:"E",templateUrl:"https://www.bandlab.com/web-app/midi/partials/_midi-editor-track-grid-2d3ec864.html",link:function(n){const o=document.getElementById("midi-editor-track-grid-pattern"),r=document.getElementById("midi-editor-track-highlight-pattern");function i(){1!==t.snapSetting.value&&0!==t.snapSetting.value||!t.isTripletGrid||(t.isTripletGrid=!1),e.updateTrackGrid({gridPattern:o,highlightPattern:r,state:t,height:24638})}n.$watchGroup(["midiEditorState.snapSetting","state.isTimeRuler","midiEditorState.isTripletGrid"],i),gR.add("scale:notesTimeline",i)}}}]),angular.module("bandlab.editor").directive("midiEditorKeyEvents",["$rootScope","EditorState","MidiEditorState",function(e,t,n){return{restrict:"A",link:function(o){function r(r){if(n.hasFocus&&t.canCollaborate){var i=r.ctrlKey||r.metaKey;if(i||r.shiftKey){if(i&&!r.shiftKey)switch(r.key){case"a":o.$broadcast(IT),r.preventDefault();break;case"c":o.$broadcast(yT);break;case"x":o.$broadcast(wT);break;case"v":o.$broadcast(CT)}else if(!i&&r.shiftKey)switch(r.key){case"ArrowUp":o.$broadcast(TT);break;case"ArrowDown":o.$broadcast(ST)}}else{switch(r.code){case"ArrowLeft":o.$broadcast(_T);break;case"ArrowRight":o.$broadcast(PT);break;case"ArrowUp":o.$broadcast(MT);break;case"ArrowDown":o.$broadcast(kT);break;case"Backspace":case"Delete":o.$broadcast($T)}"q"===r.key&&o.$broadcast(ET)}e.$applyAsync()}}document.addEventListener("keydown",r),o.$on("$destroy",(function(){document.removeEventListener("keydown",r)}))}}}]),angular.module("bandlab.editor").directive("midiEditorNoteLeft",["EditorHelper","MidiEditor","MidiEditorState",function(e,t,n){return{restrict:"A",link:function(o,r){var i;function a(t){t.preventDefault();var r=function(t,o){var r=o/n.scalePx,a=t.startPosition-t.sampleOffset+i.time+r;return r+=e.snapToGrid(a,n.snapDuration,{padding:5/n.scalePx},n)-a,r=Math.max(r,i.minDeltaTime),r=Math.min(r,i.maxDeltaTime)}(o.region,t.x-i.x);Object.values(n.selectedNotesByRegion).flat().forEach((function(e,t){e.duration=i.notes[t].duration-r,e.time=i.notes[t].time+r,n.noteDuration[n.track.id]=e.duration})),o.$apply()}function s(){angular.element(window).off("pointerup",s),r.off("pointermove",a),document.body.classList.remove("is-resizing"),t.updateRegions(),n.isResizing=!1,o.$apply()}r.on("pointerdown",(function(e){if(e.preventDefault(),t.selectNoteOnMousedown(o,e)){var l=t.getSelectedNotes(),c=_.sortBy(l,(function(e){return e.time+e.duration})),u=_.sortBy(l,"duration")[0],d=c[0];i={x:e.x,notes:_.cloneDeep(l),time:o.note.time,duration:o.note.duration,maxDeltaTime:u.duration-n.MIDI_NOTE_DURATION_MIN,minDeltaTime:-d.time},r[0].setPointerCapture(e.pointerId),angular.element(window).on("pointerup",s),r.on("pointermove",a),document.body.classList.add("is-resizing"),n.isResizing=!0,o.$apply()}}))}}}]),angular.module("bandlab.editor").directive("midiEditorNoteMove",["EditorAllowActions","EditorHelper","EditorHistory","EditorScrollState","MidiEditor","MidiEditorState",function(e,t,n,o,r,i){return{restrict:"A",link:function(a,s){const l=document.body.querySelector(".mix-editor-panel-track");s[0].draggable=!1,s.on("pointerdown",(function(c){if(c.preventDefault(),!r.selectNoteOnMousedown(a,c)||!e.isAllowed("editRegion"))return;const u=r.getSelectedNotes(),d=_.minBy(u,"time");let p=0;const m=l.getBoundingClientRect().toJSON();m.top+=70,m.height-=70;const f={dragged:!1,infDeltaTime:-d.time,noteIndex:i.selectedNotesByRegion[a.region.id].indexOf(a.note),notes:_.cloneDeep(u),supDeltaTime:r.getShortestNoteToRegionEndDuration(),velocityMean:wG(u,"velocity")/u.length,time:-a.note.time,x:c.x+o.notesLeft,y:c.y+o.notesTop,...QF.value?SB(u):r.getSelectedNotesBoundaries(u)};function h(e){e.preventDefault();const t=e.y+o.notesTop,n=(f.y-t)/100,i=As(f.velocityMean+n,.01,1);r.editSelectionVelocity(i),a.$applyAsync(),f.dragged=!0}function g(e){e.preventDefault();const n=e.x+o.notesLeft,s=e.y+o.notesTop,l=function(e){var n=e/i.scalePx;const o=a.region.startPosition-f.time+n;return n+=t.snapToGrid(o,i.snapDuration,{padding:i.snapDuration/2},i)-o,n=Math.min(n,f.supDeltaTime),n=Math.max(n,f.infDeltaTime)}(n-f.x),c=(u=s-f.y,d=-Math.floor(u/r.getNoteHeight()),d=Math.max(d,f.infDeltaMidiNote),d=Math.min(d,f.supDeltaMidiNote));var u,d;!f.dragged&&e.altKey&&(i.addedNotesByRegion=_.cloneDeep(i.selectedNotesByRegion),Object.values(i.addedNotesByRegion).flat().forEach((function(e){e.id=ad()})),i.selectedNotesByRegion={...i.addedNotesByRegion},Object.keys(i.addedNotesByRegion).forEach((function(e){[].push.apply(i.notesByRegion[e],i.addedNotesByRegion[e])}))),Object.values(i.selectedNotesByRegion).flat().forEach((function(e,t){e.time=f.notes[t].time+l,QF.value?e.midiNote=kB(f.notes[t].midiNote,c):e.midiNote=f.notes[t].midiNote+c})),p!==c&&(r.previewSoloNote(i.selectedNotesByRegion[a.region.id][f.noteIndex]||a.note),p=c),r.autoscroll({x:e.clientX,y:e.clientY},m),a.$applyAsync(),f.dragged=!0}s[0].setPointerCapture(c.pointerId),angular.element(window).on("pointerup",(function e(){angular.element(window).off("pointerup",e),s.off("pointermove",h),s.off("pointermove",g),document.body.classList.remove("is-moving"),document.body.classList.remove("is-velocitying"),f.dragged&&(i.isVelocity&&r.finishEditVelocity(),n.withSingleUndo((()=>{r.updateRegions()})),a.$applyAsync())})),i.isVelocity?(s.on("pointermove",h),document.body.classList.add("is-velocitying")):(s.on("pointermove",g),document.body.classList.add("is-moving"))}))}}}]),angular.module("bandlab.editor").directive("midiEditorNoteRight",["EditorHelper","MidiEditor","MidiEditorState",function(e,t,n){return{restrict:"A",link:function(o,r){var i;function a(t){t.preventDefault();var r=function(t,r){var a=r/n.scalePx,s=t+a;return a+=e.snapToGrid(o.note.time+s,n.snapDuration,{padding:5/n.scalePx},n)-o.note.time-s,a=Math.max(a,i.minDeltaDuration),a=Math.min(a,i.maxDeltaDuration)}(i.duration,t.x-i.x);Object.values(n.selectedNotesByRegion).flat().forEach((function(e,t){e.duration=i.notes[t].duration+r,n.noteDuration[n.track.id]=e.duration})),o.$apply()}function s(){r.off("pointermove",a),angular.element(window).off("pointerup",s),document.body.classList.remove("is-resizing"),t.updateRegions(),n.isResizing=!1,o.$apply()}r.on("pointerdown",(function(e){if(e.preventDefault(),t.selectNoteOnMousedown(o,e)){var l=t.getSelectedNotes(),c=_.sortBy(l,"duration")[0];i={x:e.x,notes:_.cloneDeep(l),duration:o.note.duration,maxDeltaDuration:t.getShortestNoteToRegionEndDuration(),minDeltaDuration:-c.duration+n.MIDI_NOTE_DURATION_MIN},r[0].setPointerCapture(e.pointerId),r.on("pointermove",a),angular.element(window).on("pointerup",s),document.body.classList.add("is-resizing"),n.isResizing=!0,o.$apply()}}))}}}]),angular.module("bandlab.editor").directive("midiEditorPencil",["editorEvents","EditorHelper","EditorHistory","EditorMidiSamples","EditorState","EditorTimeline","MetronomeState","MidiEditor","MidiEditorState",function(e,t,n,o,r,i,a,s,l){return{replace:!0,restrict:"A",link:function(c,u){var d,p,m;c.$on(e.keyDown.snapReleased,(function(){l.isDrawingWithShortcut=!1,c.$apply()})),c.$on(e.keyDown.snapPressed,(function(){l.isDrawingWithShortcut=!0,c.$apply()})),c.$watch((function(){return l.isDrawing||l.isDrawingWithShortcut}),(function(e){e?(u[0].style.cursor="url(https://www.bandlab.com/web-app/images/mix-editor/pencil-70884ba6a5.svg) 2 0, auto",u[0].classList.add("is-drawing")):(u[0].classList.remove("is-drawing"),u[0].style.cursor="")}));let f={};function h(e){return r.canCollaborate&&l.track&&!e.target.classList.contains("midi-editor-note")&&3!==e.which&&(e.target===u[0]||e.target.classList.contains("midi-editor-region"))}function g(e){const r=l.noteDuration[l.track.id]||l.snapDuration;var c=u[0].parentElement,f=c.getBoundingClientRect(),h=$s(a.settings);let g;const v=s.getHighestNoteInRoll(),b=Math.floor((e.y-f.top+c.scrollTop-xl)/s.getNoteHeight());if(g=l.isPianoRoll&&QF.value?uB.value[b]:v-1-b,(p={id:ad(),midiNote:g,duration:r,velocity:Ul}).time=(e.x-f.left-4)/l.scalePx,p.time=Math.max(p.time,0),s.previewSoloNote(p),d=_.find(l.track.regions,(function(e){return o.has(e.sampleId)&&e.startPosition<=p.time&&e.startPosition+t.getFirstLoopDuration(e)>p.time})))return void(m=y(d,p,e));if($=l.track.regions.filter((function(e){const t=2*h;return o.has(e.sampleId)&&!e.loopLength&&e.startPosition<=p.time&&e.endPosition+t>p.time})),k=e=>p.time-e.endPosition,d=$&&$.length?function(e,t,n){for(var o=-1,r=e.length;++o<r;){var i=e[o],a=t(i);if(null!=a&&(void 0===s?a==a&&!Gu(a):n(a,s)))var s=a,l=i}return l}($,Vf(k),$G):void 0){const t=Math.min(Math.ceil(p.time/h)*h,w(p.time));return d.endPosition=t,void(m=y(d,p,e))}var $,k;if(d=_.find(l.track.regions,(function(e){return o.has(e.sampleId)&&e.loopLength&&e.startPosition+t.getFirstLoopDuration(e)<p.time&&e.startPosition+e.loopLength+t.getExtraLoopDuration(e)>p.time})))return void n.withSingleUndo((()=>{const t=d.startPosition+d.loopLength*Math.floor((p.time-d.startPosition)/d.loopLength);d=i.createEmptyRegion(l.track,{startPosition:t,endPosition:Math.min(t+d.loopLength,d.endPosition,w(p.time)),sampleId:d.sampleId}),m=y(d,p,e)}));const S=Math.floor(p.time/h)*h,P=Math.min(S+h,w(p.time));n.withSingleUndo((()=>{d=i.createEmptyRegion(l.track,{startPosition:S,endPosition:P}),m=y(d,p,e)}))}function v(e){e.preventDefault();const n=l.selectedNotesByRegion[d.id][0],o=function(e,n,o){let r=o/l.scalePx;const i=n+r;return r+=t.snapToGrid(e.time+i,l.snapDuration,{padding:5/l.scalePx},l)-e.time-i,r}(n,m.duration,e.x-m.x),r=t.getFirstLoopDuration(d)-n.time;n.duration=As(m.duration+o,l.MIDI_NOTE_DURATION_MIN,r),l.noteDuration[l.track.id]=n.duration,c.$apply()}function b(){angular.element(window).off("pointerup",b),u.off("pointermove",v),document.body.classList.remove("is-moving"),l.selectedNotesByRegion[d.id][0].duration!==m.duration&&s.updateRegions()}function y(e,n,o){return r.isSnapping&&(n.time=t.snapToGrid(n.time-l.snapDuration/2,l.snapDuration,{padding:l.snapDuration/2},l)),n.time=Math.min(n.time,d.endPosition-n.duration),n.time=Math.max(n.time,d.startPosition),n.time-=e.startPosition,s.unselectNotes(),l.selectedNotesByRegion[e.id]=[n],l.addedNotesByRegion[e.id]=[n],l.notesByRegion[e.id]=l.notesByRegion[e.id]||[],l.notesByRegion[e.id].push(n),s.updateRegions(),{duration:n.duration,x:o.x}}function w(e){return l.track.regions.map((e=>e.startPosition)).sort().find((t=>t>e))||1/0}u.on("dblclick",(function(e){e.clientX===Math.floor(f.clientX)&&e.clientY===Math.floor(f.clientY)&&(e.preventDefault(),h(e)&&g(e))})),u.on("pointerdown",(function(e){e.preventDefault(),f=e,h(e)&&(l.isDrawing||l.isDrawingWithShortcut)&&(g(e),u[0].setPointerCapture(e.pointerId),angular.element(window).on("pointerup",b),u.on("pointermove",v),document.body.classList.add("is-moving"))}))}}}]),angular.module("bandlab.editor").directive("midiEditorPlayhead",["EditorCycle","EditorScroll","EditorScrollState","EditorState","MidiEditorState",function(e,t,n,o,r){return{replace:!0,restrict:"E",templateUrl:"https://www.bandlab.com/web-app/midi/partials/_midi-editor-playhead-1fea35a8.html",link:function(i,a){const s=new IntersectionObserver((function(i){0!==i[0].intersectionRatio||!o.isPlaying||!r.isFollowingPlayhead||o.crTime<0||!JS.FOLLOW_PLAYHEAD||r.isLocked||(n.notesLeft>r.scalePx*o.crTime?t.scrollNotesToX({time:e.get().startTime,scalePx:r.scalePx}):t.scrollNotesToX({direction:"right",offset:0}))}));let l;function c(){var e=Math.round(o.crTime*r.scalePx-7);l!==e&&(a[0].style.transform=`translateX(${e}px)`),l=e}s.observe(a[0]),gR.add("playing",c),i.$on("$destroy",(function(){gR.remove("playing",c),s&&s.disconnect()})),i.$on(xT,(()=>function(){const{clientWidth:e}=n.notesTimelineEl,{notesLeft:i}=n,a=i+e;(r.scalePx*o.crTime>a||r.scalePx*o.crTime<i)&&t.scrollNotesToX({time:o.crTime,scalePx:r.scalePx})}()))}}}]),angular.module("bandlab.editor").directive("midiEditorRegion",["EditorHelper","EditorState","MidiEditor","MidiEditorState",function(e,t,n,o){return{replace:!0,restrict:"E",templateUrl:"https://www.bandlab.com/web-app/midi/partials/_midi-editor-region-17fb19fa.html",link:function(r){r.$on(RT,(function(e,t){var i=function(e,t){var i=n.getNoteHeight(),a=n.getHighestNoteInRoll(),s={startTime:e.left/o.scalePx,endTime:(e.left+e.width)/o.scalePx};const l=Math.floor(e.top/i),c=Math.floor((e.top+e.height)/i);return o.isPianoRoll&&QF.value?(s.noteHigh=uB.value[l],s.noteLow=uB.value[c]):(s.noteHigh=a-1-l,s.noteLow=a-1-c),_.filter(t,(function(e){var t=r.region.startPosition+e.time+e.duration>s.startTime&&r.region.startPosition+e.time<s.endTime&&(!r.region.loopLength||r.region.loopLength&&e.time<r.region.loopLength),n=e.midiNote<=s.noteHigh&&e.midiNote>=s.noteLow;return t&&n}))}(t,r.notes),a=_.differenceBy(i,o.selectedNotesByRegion[r.region.id],"id");a.length>0&&n.previewSoloNote(a[0]),o.selectedNotesByRegion[r.region.id]=i,r.$applyAsync()})),r.getRegionColor=()=>e.getRegionColor(o.track,r.region,"midi"),r.getRegionStyle=function(){return{"box-shadow":`\n              inset ${(r.region.endPosition-r.region.startPosition)*o.scalePx}px 0px 0px 0px ${e.getRegionBackgroundColor(o.track,r.region,"midi")},\n              inset -${Math.round(e.getExtraLoopWidth(r.region)/t.scalePx*o.scalePx)}px 0px 0px 0px rgba(0, 0, 0, .3)\n            `,left:r.region.startPosition*o.scalePx+"px",width:(r.region.endPosition-r.region.startPosition)*o.scalePx+"px"}},r.getFirstLoopWidth=function(){return e.getFirstLoopWidth(r.region,o.scalePx)},r.isLoopVisible=function(){return e.getExtraLoopWidth(r.region)>0},r.getNoteUniqueIndex=function(e){return`${e.midiNote}-${e.time}-${e.id}`}},controller:["$scope","EditorHelper","EditorMidiSamples",function(e,t,r){var i=e.$watch("region.sampleId",(function(){r.has(e.region.sampleId)&&(i(),a(),i=e.$watchGroup(["region.sampleId","region.loopLength","region.isMoving",()=>t.getTotalDuration(e.region),()=>o.track.soundbank,()=>QF.value],a))}));function a(){e.notes=n.renderRegionNotes(e.region),o.notesByRegion[e.region.id]=e.notes,o.selectedNotesByRegion[e.region.id]=(o.selectedNotesByRegion[e.region.id]||[]).map((function(t){return _.find(e.notes,{id:t.id})})).filter((e=>!!e))}}]}}]),angular.module("bandlab.editor").directive("midiEditorRegionNote",["EditorPlayer","MidiEditor","MidiEditorState",function(e,t,n){return{restrict:"E",replace:!0,templateUrl:"https://www.bandlab.com/web-app/midi/partials/_midi-editor-region-note-e3ed4ce0.html",link:function(o,r){var i;i=ay((function(){t.previewSoloNote(o.note)}),250,{leading:!0,trailing:!1});let a={};r.on("dblclick",(function(e){e.clientX===Math.floor(a.clientX)&&e.clientY===Math.floor(a.clientY)&&(e.preventDefault(),t.deleteNotes(),o.$digest())})),r.on("pointerdown",(function(e){e.preventDefault(),a=e,n.isDrawing||n.isDrawingWithShortcut?i():t.previewSoloNote(o.note)})),o.noteName=o.note.noteName;const s=o.$watch((()=>o.note.midiNote),c),l=o.$watch((()=>JS.PREFER_SHARPS),c);async function c(){const t=await e.current.audioEngineNode.MusicUtils.midiToString(o.note.midiNote,!0,JS.PREFER_SHARPS);o.noteName=t,o.$digest()}c(),o.$on("$destroy",(()=>{s(),l()}))},controller:["$scope","MidiEditorState",function(e,t){e.isSelected=function(){return t.selectedNotesByRegion[e.region.id]=t.selectedNotesByRegion[e.region.id]||[],t.selectedNotesByRegion[e.region.id].indexOf(e.note)>-1},e.getNote=function(){return t.mapOriginalNoteToEditing.get(e.note)??e.note}}]}}]),angular.module("bandlab.editor").directive("midiEditorRuler",["EditorGrid","EditorHelper","EditorPlayer","EditorScroll","EditorScrollState","EditorState","MidiEditorState",function(e,t,n,o,r,i,a){return{replace:!0,restrict:"E",templateUrl:"https://www.bandlab.com/web-app/midi/partials/_midi-editor-ruler-3a99db64.html",link:function(t,n){const o=n[0].querySelector(".midi-editor-ruler-graduation");function i(){e.updateGridLabel({element:o,state:a,leftBounds:r.notesLeft-Al,viewportWidth:r.notesTimelineEl.getBoundingClientRect().width}),n[0].style.width=`${a.containerWidth}px`}t.$watch("state.isTimeRuler",i),gR.add("scale:notesTimeline",i),gR.add("scroll:notesLeft",i)},controller:["$scope",function(e){let s,l=angular.noop;function c(e){let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{snapDuration:r,scalePx:s}=a;e=Math.max(0,e),e=i.isTimeRuler||o?e:t.snapToGrid(e,r*s,{}),e=Math.min(e/s,JS.SONG_DURATION_MAX),n.setPlaybackPosition(e),gR.start("syncVolume")}function u(){const t=r.notesTimelineEl.getBoundingClientRect().width/2;r.notesLeft=i.crTime*a.scalePx-t,gR.start("scroll:notesLeft",!1,r.notesLeft,!0,!1),e.$applyAsync()}e.startMovingPlayhead=function(e,t){a.isDraggingPlayhead=!0,i.isInBackground=!0,c(t-Al)},e.finishMovingPlayhead=function(){clearInterval(s),i.isInBackground=!1,a.isDraggingPlayhead=!1},e.setCurrentTime=function(t,n,l,u,d){clearInterval(s);const p=function(e){const{notesEl:t,notesTimelineEl:n}=r,{left:o}=t.getBoundingClientRect(),{left:i,width:a}=n.getBoundingClientRect(),s=Math.ceil(o)<293;return e<i+32&&s?{left:!0}:e>i+a-32?{right:!0}:null}(d);if(p)s=setInterval((()=>{o.manualNotesScroll(p),c(n=p.left?Math.max(m(i.crTime)-r.SCROLL_STEP,0):Math.min(m(i.crTime)+r.SCROLL_STEP,m(JS.SONG_DURATION_MAX)),!0),e.$digest(),e.$applyAsync()}),30);else{const e=function(e){const{left:t,width:n}=r.notesEl.getBoundingClientRect();return e=Math.max(e-t,0),e=Math.min(e,n)}(d);c(n=(n-=Al)!==e?e:n)}function m(e){return a.scalePx*e}},e.$watch((()=>i.isDraggingPlayhead),(t=>{t?a.isLocked||(l=e.$watch("state.crTime",u)):l()}))}]}}]),angular.module("bandlab.editor").directive("midiEditorRulerRegion",["EditorHelper","EditorHistory","EditorRevision","EditorState","EditorTimeline","MidiEditorState",function(e,t,n,o,r,i){return{restrict:"A",link:function(t){t.getRegionStyle=function(){return{"background-color":e.getRegionBackgroundColor(i.track,t.region),"box-shadow":`\n              inset -${Math.round(e.getExtraLoopWidth(t.region)/o.scalePx*i.scalePx)+20}px 0px 0px -20px rgba(0, 0, 0, .3)\n            `,left:t.region.startPosition*i.scalePx+12+"px",width:(t.region.endPosition-t.region.startPosition)*i.scalePx+"px"}}},controller:["$scope",function(o){let a={};o.backupRegion=function(){t.pushUndo(n.current),n.selectedRegions=new Set([o.region]),a={duration:o.region.endPosition-o.region.startPosition,endPosition:o.region.endPosition,firstPosition:o.region.startPosition,firstTrack:i.track,lastPosition:o.region.startPosition,loopLength:o.region.loopLength,sampleOffset:o.region.sampleOffset,scalePx:i.scalePx,startPosition:o.region.startPosition,startPositions:{[o.region.id]:o.region.startPosition}},o.$applyAsync()},o.moveRegion=function(e){r.moveRegion(o.region,0,{...a,delta:-e,firstRegionSnapped:0},i),o.$apply()},o.moveRegionLeft=function(e){r.resizeRegionLeft(o.region,{...a,delta:e},i),o.$apply()},o.getRightHandleType=function(){return o.getExtraLoopDuration()>0?"loop":"trim"},o.resizingRight=function(e){r.resizeRegionRight(o.region,{...a,delta:e},i),o.$apply()},o.resizingFirstLoop=function(e){r.resizeFirstLoop(o.region,{...a,delta:e},i),o.$apply()},o.expandLoop=function(e){r.expandRegionLoop(o.region,{...a,delta:e},i),o.$apply()},o.updateTrack=function(){r.moveRegions(a.firstTrack)},o.updateTrackResetLoopLength=function(){e.getTotalDuration(o.region)<=o.region.loopLength&&(o.region.loopLength=0),o.updateTrack()},o.getExtraLoopDuration=function(){return e.getExtraLoopDuration(o.region)},o.getFirstLoopDuration=function(){return e.getFirstLoopDuration(o.region)},o.getTotalDuration=function(){return e.getTotalDuration(o.region)}}]}}]),angular.module("bandlab.editor").directive("midiEditorScrollbarHorizontal",["EditorScroll","EditorScrollState","EditorState","MidiEditorState",function(e,t,n,o){return{restrict:"E",replace:!0,templateUrl:"https://www.bandlab.com/web-app/midi/partials/_midi-editor-scrollbar-horizontal-801a2925.html",link:function(r,i){const a=i[0].querySelector(".midi-editor-scrollbar-horizontal"),s=new ResizeObserver(l);function l(){const{clientWidth:e,scrollLeft:i}=t.notesTimelineEl,s=o.scalePx*Math.min(Math.max(180,n.songDuration+30),JS.SONG_DURATION_MAX),l=Math.round(e/s*e),c=Math.max(l,40),u=Math.round(i/(s-e)*(e-c));r.barScale=l/c,r.scrollPercent=i/(s-e),a.style.width=`${c}px`,a.style.transform=`translateX(${u}px)`}s.observe(i[0]),gR.add("scale:notesTimeline",l),gR.add("scroll:notesLeft",l),setTimeout((function(){l()})),i[0].addEventListener("mousedown",(function(t){const n=a.getBoundingClientRect(),o=t.clientX;o<n.left?e.scrollNotesToX({direction:"left"}):o>n.right&&e.scrollNotesToX({direction:"right"})}),{capture:!0}),r.$on("$destroy",(function(){s.disconnect(),gR.remove("scale:notesTimeline",l),gR.remove("scroll:notesLeft",l)}))},controller:["EditorScroll","$scope",function(e,r){var i,a;r.backupPositionX=function(e,n,o){i=o.target.closest(".midi-editor-scrollbar-horizontal")?r.scrollPercent-(r.scrollPercent-e)*r.barScale:e,a=t.notesLeft},r.scrollX=function(t){e.scrollNotesToX({clickPosition:i,offsetPosition:a,percent:t,scrollWidth:Math.min(Math.max(180,n.songDuration+30),JS.SONG_DURATION_MAX)*o.scalePx})}}]}}]),angular.module("bandlab.editor").directive("midiEditorScrollbarVertical",["EditorScroll","EditorScrollState",function(e,t){return{restrict:"E",replace:!0,templateUrl:"https://www.bandlab.com/web-app/midi/partials/_midi-editor-scrollbar-vertical-8be6cdc6.html",link:function(n,o){const r=o[0].querySelector(".midi-editor-scrollbar-vertical"),i=new ResizeObserver(a);function a(){const{clientHeight:e,scrollHeight:n,scrollTop:i}=t.notesEl,a=e-xl,s=Math.round(a/n*a),l=Math.round(i/(n-a)*(a-s));r.style.height=`${s}px`,r.style.transform=`translateY(${l}px)`,o[0].classList.toggle("hidden",e>=n)}i.observe(o[0]),gR.add("scroll:notesTop",a),o[0].addEventListener("mousedown",(function(t){var n=r.getBoundingClientRect(),o=t.clientY;o<n.top?e.scrollNotesToY({direction:"up"}):o>n.bottom&&e.scrollNotesToY({direction:"down"})}),{capture:!0}),n.$on("$destroy",(function(){i.disconnect(),gR.remove("scroll:notesTop",a)})),n.$watch((()=>t.notesEl.clientHeight),a)},controller:["EditorScroll","$scope",function(e,n){var o,r;n.backupPositionY=function(e){o=1-e,r=t.notesTop},n.scrollY=function(t){e.scrollNotesToY({clickPosition:o,offsetPosition:r,percent:1-t})}}]}}]),angular.module("bandlab.editor").value("DrumMachineState",{_patterns:[],isLive:!1,kit:[],matrix:[],patterns:[],patternLengthInBars:1,selectedPattern:{},selectedPatternIndex:-1,swingAmount:0,velocityMode:!1}).factory("DrumMachine",["$rootScope","DrumMachineState","EditorData","EditorDB","editorEvents","EditorMidiSamples","EditorPlayer","EditorRevision","EditorState","EditorTimeline","MetronomeState",function(e,t,n,o,r,i,a,s,l,c,u){var d,p,m=$_(),f=16;const{queue:h,enqueue:g,useInstance:v,usedInstances:b}=gL((e=>a.current.getPatternEditor(e.id)));return{addDrumMachineTrack:async function(t,n){const{patterns:o,id:r}=await a.current.addDrumMachineTrack(t.name,t.soundbank);let i;t.patterns=o,t.id=r,s.current.tracks.push(t),e.$applyAsync();const c=new Promise((e=>{i=e}));e.$broadcast("MixEditor:onAfterAddDrumMachineTrack",{track:t,resolve:i}),await c,null===n?function(){const e=zn((()=>import("./chunk-08fb4407.js")));l.isInBackground=!0,_g(e,{setBeatStarterTemplate:_,setEmptyTemplate:P},{escapeClose:!1,overlayClose:!1,onClose:()=>{l.isInBackground=!1}})}():_(n)},clearPattern:function(){v(s.selectedTrack,(async function(e){await M(e,(async()=>await e.clearSelectedPattern()))}))},copyPattern:function(){v(s.selectedTrack,(async function(e){await e.copySelectedPattern(),zS.value={pattern:!await e.isClipboardEmpty()}}))},getAvailableKit:function(e){return new Promise((function(t){v(s.selectedTrack,(async function(n){const o=(await n.getAvailableNotesForRow(e)).map((e=>m[e]));t(o)}))}))},getCurrentKit:function(){return t.kit},getCurrentPreset:function(){return t.selectedPattern},getDrumMachinePatternLabel:function(e){const n=t._patterns.indexOf(e);return String.fromCharCode(97+n).toUpperCase()},getNonEmptyDrumMachinePatterns:function(){return t._patterns.filter((e=>!function(e){return e.cellStates.every((e=>e.every((e=>e<0))))}(e)))},getPatternDurationInSeconds:function(e){const n=t._patterns[e]?.length;return Fz(n,s.current.metronome.bpm)},getSupportedNotes:function(){return new Promise((e=>{v(s.selectedTrack,(async t=>{const n=(await t.getSupportedNotes()).map((e=>m[e]));e(n)}))}))},isActive:function(){return p},pastePattern:function(){v(s.selectedTrack,(async function(e){await M(e,(async()=>await e.pasteIntoSelectedPattern()))}))},previewNote:function(e){v(s.selectedTrack,(async function(t){t.previewMidi(e.midi)}))},selectPattern:function(e){t.selectedPattern=e,S(t.patterns.indexOf(e))},selectPatternByIndex:S,selectTrack:function(e){const n=p;(function(e){v(e,(async function(t){await t.stop(),await t.delete(),b.delete(e.id)})),$()})(e),t.patterns=e.patterns,v(e,(async function(e){n&&(await e.start(),w()),t._patterns=await e.getAllPatterns(),t.swingAmount=await e.getSwingAmount(),t.velocityMode=await e.getVelocityMode(),S(await e.getSelectedPatternIndex())}))},set:function(e,t){v(s.selectedTrack,(async function(n){const o=k(t);await M(n,(async()=>{await n.touchDown(e,o),await n.touchUp(e,o)}))}))},setSelectedPatternLengthInBars:function(n){t.patternLengthInBars!==n&&v(s.selectedTrack,(async function(t){await M(t,(async()=>await t.setSelectedPatternLengthInBars(n))),e.$applyAsync()}))},setSwingAmount:function(n){t.swingAmount!==n&&v(s.selectedTrack,(async function(o){await M(o,(async()=>await o.setSwingAmount(n))),t.swingAmount=n,e.$applyAsync()}))},setVelocityMode:function(n){v(s.selectedTrack,(async function(o){await o.setVelocityMode(n),t.velocityMode=n,e.$applyAsync()}))},stop:function(){g((async function(){for(const[e,t]of b){const n=await t;await n.stop(),b.delete(e.id)}$()}))},swapDrum:function(e,t){v(s.selectedTrack,(async function(n){await M(n,(async()=>await n.setNoteForRow(e,t)))}))},toggle:function(){v(s.selectedTrack,(async function(e){await e.toggle()?await w():await $()}))}};function y(){v(s.selectedTrack,(async function(n){const o=await n.patternPlayheadPosTick(),r=k(1),i=Math.floor(o/r),a=i+1===f*t.patternLengthInBars?0:i+1,s=1e3*Fz((i+1)*r-o,u.settings.bpm);d=setTimeout((()=>{p&&(e.$broadcast("DrumMachine:beat",a),y())}),s)}))}function w(){p=!0,clearTimeout(d),e.$broadcast("DrumMachine:beat",0),y(),l.isPlaying&&e.$broadcast(r.keyDown.play),e.$applyAsync()}function $(){p=!1,clearTimeout(d),e.$broadcast("DrumMachine:beat",-1),e.$applyAsync()}function k(e){var t=u.settings;return Bz(e/4/t.bpm*60,t.bpm)}function S(n){v(s.selectedTrack,(async function(o){await o.selectPatternByIndex(n);const[r]=await Promise.all([await o.getSelectedPattern(),p?o.start():o.stop()]);h.length>2||(t.selectedPatternIndex=n,t.selectedPattern={sampleId:t.patterns[n]?.sampleId||"",notes:r.noteRows},t.kit=r.noteRows.map((e=>m[e])),t.matrix=r.cellStates,t.patternLengthInBars=r.cellStates[0].length/f,e.$applyAsync())}))}function _(o){v(s.selectedTrack,(async function(r,i){Promise.resolve().then((()=>rb)).then((e=>{let{logStudioDrumMachinePatternSelect:t}=e;t(0===o?"default":"non_default")})),await M(r,(async()=>await r.setBeatStarterTemplate(o)));const{noteRows:a,cellStates:l}=await r.getSelectedPattern();t.kit=a.map((e=>m[e])),t.matrix=l,t.swingAmount=await r.getSwingAmount(),t.patternLengthInBars=l[0].length/f;const{patterns:u,_patterns:d}=t,p=c.createDrumMachineRegion(i,u[0].sampleId,d[0],0),h=c.createDrumMachineRegion(i,u[1].sampleId,d[1],p.endPosition);s.selectedRegions.clear(),s.selectedRegions.add(h),n.updateSongDuration(),e.$applyAsync()}))}function P(){Promise.resolve().then((()=>rb)).then((e=>{let{logStudioDrumMachinePatternSelect:t}=e;return t("empty")})),t.patterns.forEach((e=>{let{sampleId:t}=e;i.set(t,{id:t,name:"Drum Machine",notes:[],parentId:!1,trackId:s.selectedTrack.id,isSaved:!1})}));const o=t._patterns[0],r=c.createDrumMachineRegion(s.selectedTrack,t.patterns[0].sampleId,o,0),a=c.createDrumMachineRegion(s.selectedTrack,t.patterns[1].sampleId,o,r.endPosition);s.selectedRegions.clear(),s.selectedRegions.add(a),n.updateSongDuration(),e.$applyAsync()}async function M(n,r){const l=ad();await a.current.rememberCurrentState(l),await r();const c=await a.current.getChangeSet(l);a.current.forgetState(l);const u=c.modifiedTracks[0],d=u&&u.patterns?u.patterns.map((e=>e.sampleId)):[];t._patterns=await n.getAllPatterns(),await d.reduce((async(r,l,c)=>(await r,async function(n,r,l){const c=t._patterns[r];if(!i.has(n)&&(await a.current.getSampleMidFileFromVirtualFileSystem(n).then((e=>{o.updateFile({blob:e,sampleId:n})})),i.set(n,{id:n,name:"Drum Machine",notes:c.score,parentId:!1,trackId:s.selectedTrack.id,isSaved:!1}),t.patterns[r]&&e.$broadcast("DrumMachine:update",{oldSampleId:t.patterns[r].sampleId,newSampleId:n,pattern:c}),t.patterns[r]={sampleId:n,notes:c.noteRows},t.selectedPatternIndex===r)){t.selectedPattern.sampleId=n;const e=await l.getSelectedPattern();t.kit=e.noteRows.map((e=>m[e])),t.matrix=e.cellStates,t.selectedPattern.notes=e.noteRows,t.patternLengthInBars=e.cellStates[0].length/f}}(l,c,n))),Promise.resolve()),v(s.selectedTrack,(async function(e,t){b.delete(t.id),e.delete()})),a.updateSourcesInTracks()}}]),angular.module("bandlab.editor").factory("MidiDevice",["$analytics","$rootScope","EditorRevision","EditorState","InputDevice","MidiMapping","SharedMidiSynth",function(e,t,n,o,r,i,a){const s={id:-1,name:"No MIDI Device"},l={id:-1,name:"This browser doesnt support MIDI devices"},c=Ac((function(t){e.eventTrack("Connect MIDI device",{label:t})}));var u,d=127,p=[];return t.$on("MidiMapping:INSTRUMENT",(function(e,n){var o=240&n[0],r=n[2]?n[2]/d:null;switch(o){case Zq:a.noteOn(n[1],r);break;case Xq:a.noteOff(n[1],r)}t.$broadcast("MidiMessage:noteEvent",n[1])})),t.$on(bT,(function(e,t){t.length?b(t.find((e=>e.id===u?.id))||t[0]):v(),p=t})),{init:function(){return r.getMidiDevices().then((function(e){p=e,b(e[0])})).catch((function(){p=[l]}))},getMidiDevicesList:()=>0===p.length?[s]:p,getPluggedDevice:()=>u||s,plug:b,unplug:v};function m(e){return i.getCallbacks().reduce(((t,n)=>n(e)||t),!1)}function f(e){if(document.body.classList.contains("is-mapping"))return i.addMapping(e.data,e.currentTarget),void t.$applyAsync();m(e)&&t.$applyAsync()}function h(e){if(document.body.classList.contains("is-mapping"))return i.addMapping(e.data,e.currentTarget),void t.$applyAsync();var r=240&e.data[0],s=e.data[2]?e.data[2]/d:null;if(kG(e.data)&&(r=Xq),m(e))return t.$applyAsync(),void t.$broadcast("MidiMessage:noteEvent");switch(r){case Zq:if(XT(a.getSoundbank())){ZT(e.data[1],(function(e){a.noteOn(e,s),t.$broadcast("MidiMessage:noteEvent",e)}),(function(e){a.notesOn(e.map((e=>[e,s]))),e.forEach((e=>{t.$broadcast("MidiMessage:noteEvent",e)}))}),(function(e){a.notesOff(e.map((e=>[e,s]))),t.$broadcast("MidiMessage:noteEvent")}));break}a.noteOn(e.data[1],s),t.$broadcast("MidiMessage:noteEvent",e.data[1]);break;case Xq:if(VT.value&&VT.value?.root===e.data[1]){QT(VT.value?.root,(function(e){a.notesOff(e.map((e=>[e,s]))),t.$broadcast("MidiMessage:noteEvent")}));break}a.noteOff(e.data[1],s),t.$broadcast("MidiMessage:noteEvent");break;case ez:!function(e){switch(e.data[1]){case 64:case 11:a.setSustain(e.data[2]),t.$applyAsync();break;case 10:!function(e){let[,,r=64]=e;t.$broadcast("MidiMapping:TRACK_PAN",{pan:2*r/127-1,trackId:n.selectedTrack.id,crTime:o.crTime})}(e.data),t.$applyAsync();break;case 7:!function(e){let[,,r=64]=e;t.$broadcast("MidiMapping:TRACK_VOLUME",{trackId:n.selectedTrack.id,volume:2*r/127,crTime:o.crTime})}(e.data),t.$applyAsync()}}(e);break;case rz:return void a.setPitchBend(e.data)}}function g(e){e.onmidimessage=f}function v(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:p).forEach((function(e){e.onmidimessage=null})),u=null,o.isMidiActive=!1}function b(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p;u&&v(),(u=e)&&(u.onmidimessage=null,setTimeout((function(){u&&(u.onmidimessage=h)}),1e3),o.isMidiActive=!0,c(e.name)),t.filter((e=>e!==u)).forEach(g)}}]).factory("MidiMapping",["$rootScope","EditorRevision","EditorState","Katnip","MidiMappable","Soundbank",function(e,t,n,o,r,i){const a=[{event:"CONTROL_CHANGE",matcher:function(e,t,n){let{channel:o,deviceId:r,identifier:i}=n;const a=240&e[0],s=15&e[0];return t.id===r&&s===o&&a===ez&&i===e[1]},extend:function(e){return{value:e[2]}}},{event:"NOTE_ON_OFF",matcher:function(e,t,n){let{channel:o,deviceId:r,noteNumber:i}=n;const a=240&e[0],s=15&e[0];return t.id===r&&s===o&&(a===Zq||a===Xq)&&e[1]===i},extend:function(e){return{adsr:e[2]}}},{event:"PROGRAM_CHANGE",matcher:function(e,t,n){let{channel:o,deviceId:r,identifier:i}=n;const a=240&e[0],s=15&e[0];return t.id===r&&s===o&&192===a&&i===e[1]},extend:function(e){return{value:e[2]}}},{event:"PITCH_BEND",matcher:function(e,t,n){let{channel:o,deviceId:r,identifier:i}=n;const a=240&e[0],s=15&e[0];return t.id===r&&s===o&&a===rz&&i===e[1]},extend:function(e){return{value:e[2]}}}],s=[{target:"MASTER_VOLUME",callback:function(t,n){let{min:o,max:r,value:i}=n;const a=240&t[0];if(a===Xq||kG(t))return;let s=0;s=angular.isUndefined(o)||angular.isUndefined(r)?2*i/127:(r-o)*i/127+o,e.$broadcast("MidiMapping:MASTER_VOLUME",{min:o,max:r,toggle:a===Zq,volume:s})}},{target:"MASTER_PLAYBACK",callback:function(t,n){let{value:o}=n;const r=240&t[0];r===Xq||kG(t)||e.$broadcast("MidiMapping:MASTER_PLAYBACK",{toggle:r===Zq,value:o>64})}},{target:"MASTER_RECORD",callback:function(t,n){let{value:o}=n;const r=240&t[0];r===Xq||kG(t)||e.$broadcast("MidiMapping:MASTER_RECORD",{toggle:r===Zq,value:o>64})}},{target:"TRACK_SOLO",callback:function(t,n){let{trackId:o,value:r}=n;const i=240&t[0];i===Xq||kG(t)||e.$broadcast("MidiMapping:TRACK_SOLO",{toggle:i===Zq,trackId:o,value:r>64})}},{target:"TRACK_MUTE",callback:function(t,n){let{trackId:o,value:r}=n;const i=240&t[0];i===Xq||kG(t)||e.$broadcast("MidiMapping:TRACK_MUTE",{toggle:i===Zq,trackId:o,value:r>64})}},{target:"TRACK_PAN",callback:function(t,o){let{min:r,max:i,trackId:a,value:s}=o;const l=240&t[0];if(l===Xq||kG(t))return;let c=0;c=angular.isUndefined(r)||angular.isUndefined(i)?2*s/127-1:(i-r)*s/127+r,e.$broadcast("MidiMapping:TRACK_PAN",{min:r,max:i,toggle:l===Zq,pan:c,trackId:a,crTime:n.crTime})}},{target:"TRACK_VOLUME",callback:function(t,o){let{min:r,max:i,trackId:a,value:s}=o;const l=240&t[0];if(l===Xq||kG(t))return;let c=0;c=angular.isUndefined(r)||angular.isUndefined(i)?2*s/127:(i-r)*s/127+r,e.$broadcast("MidiMapping:TRACK_VOLUME",{min:r,max:i,toggle:l===Zq,trackId:a,volume:c,crTime:n.crTime})}},{target:"INSTRUMENT",callback:function(t,n){let{noteNumber:o,adsr:r,min:i,max:a}=n;angular.isUndefined(i)||angular.isUndefined(a)?r/=127:r=(a-i)*r/127+i,e.$broadcast("MidiMapping:INSTRUMENT",[t[0],o,r])}},{target:"OCTAVE_DOWN",callback:function(t,n){let{value:o}=n;const r=240&t[0];r===Xq||kG(t)||e.$broadcast("MidiMapping:OCTAVE_DOWN",{toggle:r===Zq,value:o>64})}},{target:"OCTAVE_UP",callback:function(t,n){let{value:o}=n;const r=240&t[0];r===Xq||kG(t)||e.$broadcast("MidiMapping:OCTAVE_UP",{toggle:r===Zq,value:o>64})}},{target:"TRACK_EFFECT_PARAMETER",callback:function(t,o){let{effectId:r,effectIndex:i,effectParameter:a,min:s,max:l,trackId:c,value:u}=o;const d=240&t[0];d===Xq||kG(t)||(angular.isUndefined(s)||angular.isUndefined(l)?u/=127:u=(l-s)*u/127+s,e.$broadcast("MidiMapping:TRACK_EFFECT_PARAMETER",{effectId:r,effectIndex:i,effectParameter:a,min:s,max:l,toggle:d===Zq,trackId:c,value:u,crTime:n.crTime}))}},{target:"TRACK_EFFECT_BYPASS",callback:function(t,n){let{effectId:o,effectIndex:r,effectSlug:i,trackId:a,value:s}=n;const l=240&t[0];l===Xq||kG(t)||e.$broadcast("MidiMapping:TRACK_EFFECT_BYPASS",{effectId:o,effectIndex:r,effectSlug:i,toggle:l===Zq,trackId:a,value:s<64})}}],l=[];if(ql.mappings)try{[].push.apply(l,JSON.parse(ql.mappings))}catch(e){}let c=l.map((function(e){let[t,n]=e;return p(t,n)}));return{addMapping:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r;if(!n.target)return;const o=function(e){const t=240&e[0],n=15&e[0];switch(t){case ez:return{event:"CONTROL_CHANGE",channel:n,identifier:e[1]};case 192:return{event:"PROGRAM_CHANGE",channel:n,identifier:e[1]};case Zq:return{event:"NOTE_ON_OFF",channel:n,noteNumber:e[1]};case rz:return{event:"PITCH_BEND",channel:n,identifier:e[1]};default:return}}(e);o&&(o.deviceName=t.name,o.deviceId=t.id,n={...n,noteNumber:n.noteNumber&&i.getNoteWithOctave(n.noteNumber)},l.find((e=>angular.equals(e[0],o)&&angular.equals(_.omit(e[1],["min","max"]),n)))||(n.min=d(n,"min"),n.max=d(n,"max"),"MASTER_PLAYBACK"===n.target?Gf(l,(e=>angular.equals(e[0],o)&&"MASTER_RECORD"===e[1].target)):"MASTER_RECORD"===n.target?Gf(l,(e=>angular.equals(e[0],o)&&"MASTER_PLAYBACK"===e[1].target)):Gf(l,(e=>angular.equals(e[1],n))),l.push([o,n]),u()))},clearMappings:function(){l.length=0,u()},getCallbacks:function(){return c},getDefault:d,getMappings:function(){return l},getMetadata:function(e){let{target:n,effectIndex:r,effectParameter:i,trackId:a}=e;if("MASTER_VOLUME"===n||"TRACK_VOLUME"===n)return pl;if("TRACK_PAN"===n)return ml;if("TRACK_EFFECT_PARAMETER"===n){const e=t.current.tracks.find((e=>e.id===a))?.effects?.[r]?.slug;return o.metadata[e]?.params?.[i]}return"INSTRUMENT"===n?{min:0,max:127,step:1}:void 0},getUnit:function(e){let{target:n,effectIndex:r,effectParameter:i,trackId:a}=e;if("MASTER_VOLUME"===n||"TRACK_VOLUME"===n)return"dB";if("TRACK_EFFECT_PARAMETER"===n){const e=t.current.tracks.find((e=>e.id===a)).effects[r]?.slug;return o.metadata[e]?.params?.[i]?.displayUnit||o.metadata[e]?.params?.[i]?.unit}return""},mapControl:p,pruneMappings:function(){Gf(l,(function(e){let[,n]=e;if(n.trackId){const e=t.current.tracks.find((e=>e.id===n.trackId));if(!e)return!0;if(n.effectId?n.effectIndex=e.effects.findIndex((e=>e.id===n.effectId)):Number.isInteger(n.effectIndex)&&(n.effectId=e.effects[n.effectIndex]?.id),Number.isInteger(n.effectIndex)||n.effectParameter){if(!1===("TRACK_EFFECT_BYPASS"===n.target?e.effects[n.effectIndex]:e.effects[n.effectIndex]?.params?.[n.effectParameter]??!1))return!0;if(n.effectSlug)return e.effects[n.effectIndex]?.slug!==n.effectSlug}}}))},removeMapping:function(e){Gf(l,(t=>angular.equals(t,e))),u()},updateMappings:u,getLimit:function(e,n){let{target:r,effectIndex:i,effectParameter:a,trackId:s}=e;if("MASTER_VOLUME"===r||"TRACK_VOLUME"===r)return(n=bs(n)).toFixed(1);if("TRACK_PAN"===r)return ks(n,ml);if("TRACK_EFFECT_PARAMETER"===r){const e=t.current.tracks.find((e=>e.id===s)).effects[i].slug,r=o.metadata[e].params[a];return ks(Ps(n,r),r)}return n},setLimit:function(e,n){let{target:r,effectIndex:i,effectParameter:a,trackId:s}=e;if("MASTER_VOLUME"===r||"TRACK_VOLUME"===r)return Math.pow(10,n/20);if("TRACK_PAN"===r)return _s(n,ml);if("TRACK_EFFECT_PARAMETER"===r){const e=t.current.tracks.find((e=>e.id===s)).effects[i].slug,r=o.metadata[e].params[a];return Ss(_s(n,r),r)}return n}};function u(){c=l.map((function(e){let[t,n]=e;return p(t,n)})),ql.mappings=JSON.stringify(l.map((function(e){let[t,{...n}]=e;return delete n.effectId,[t,n]})))}function d(e,n){let{target:r,effectIndex:i,effectParameter:a,trackId:s}=e;if("MASTER_VOLUME"===r||"TRACK_VOLUME"===r)return pl[n];if("TRACK_PAN"===r)return ml[n];if("TRACK_EFFECT_PARAMETER"===r){const e=t.current.tracks.find((e=>e.id===s))?.effects?.[i]?.slug,r=o.metadata[e]?.params?.[a];return Ss(r[n],r)}return"INSTRUMENT"===r?{min:0,max:127}[n]:void 0}function p(e,t){let{event:n,...o}=e,{target:r,...i}=t;const{matcher:l,extend:c}=a.find((e=>e.event===n)),{callback:u}=s.find((e=>e.target===r));return function(e){return!!l(e.data,e.currentTarget,o)&&(u(e.data,{...c(e.data),...i}),!0)}}}]).constant("MidiMappable",{effectIndex:null,effectParameter:null,noteNumber:null,target:null,trackId:null}).directive("mixEditorMappable",["$filter","MidiMappable","MidiMapping","Soundbank",function(e,t,n,o){return{restrict:"E",replace:!0,template:function(e,t){return`\n          <div class="mix-editor-mappable"\n            ng-click="selectMappable('${t.mappableTarget}', preset.id || track.id, ${t.mappableNoteNumber}, effectIndex, property, effect.slug, effectId)"\n            ng-class="{ selected: isMappableSelected('${t.mappableTarget}', preset.id || track.id, ${t.mappableNoteNumber}, effectIndex, property, effect.slug, effectId) }">\n            <div class="mix-editor-mappable-mapped">{{ isMappableMapped('${t.mappableTarget}', preset.id || track.id, ${t.mappableNoteNumber}, effectIndex, property, effect.slug, effectId) }}</div>\n          </div>\n        `},link:function(r){const i=e("midiMappableReadableEvent");r.selectMappable=function(e,n,o){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0;t.target=e,t.trackId=n,t.noteNumber=o,t.effectIndex=r,t.effectParameter=i,t.effectSlug=a,t.effectId=s},r.isMappableSelected=function(e,n,o){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0;return t.target===e&&t.trackId===n&&t.noteNumber===o&&(t.effectId&&s?t.effectId===s:t.effectIndex===r)&&t.effectParameter===i&&t.effectSlug===a},r.isMappableMapped=function(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4?arguments[4]:void 0,l=arguments.length>5?arguments[5]:void 0;r=r&&o.getNoteWithOctave(r);const c=n.getMappings().find((function(n){let[,{target:o,trackId:i,noteNumber:c,effectIndex:u,effectParameter:d,effectSlug:p}]=n;return o===e&&i===t&&c===r&&u===a&&d===s&&p===l}));return c?`${c[0].channel} - ${i(c[0])}${c[0].identifier??""}`:""}}}}]).filter("midiMappableReadableTarget",["EditorRevision","Katnip","MidiMapping",function(e,t,n){return function(o){let{target:r,trackId:i,effectIndex:a,effectParameter:s,effectSlug:l}=o;if("TRACK_EFFECT_PARAMETER"===r){const o=e.current.tracks.find((e=>e.id===i))?.effects[a]?.slug,r=t.metadata[o]?.params[s]?.display?.name;return r||void n.pruneMappings()}if("TRACK_EFFECT_BYPASS"===r){const t=e.current.tracks.find((e=>e.id===i))?.effects[a]?.slug;if(t!==l)return void n.pruneMappings()}return{CONTROL_CHANGE:"CC",PROGRAM_CHANGE:"PC",NOTE_ON_OFF:"NOTE",PITCH_BEND:"PITCH BEND",MASTER_RECORD:"Recording",MASTER_PLAYBACK:"Playback",MASTER_VOLUME:"Volume",TRACK_EFFECT_BYPASS:"Bypass",TRACK_SOLO:"Solo track",TRACK_MUTE:"Mute track",TRACK_PAN:"Track panning",TRACK_VOLUME:"Track volume",INSTRUMENT:"Instrument note"}[r]||r}}]).filter("midiMappableReadableEvent",(function(){return function(e){let{event:t,noteNumber:n}=e;return{CONTROL_CHANGE:"CC",PROGRAM_CHANGE:"PC",NOTE_ON_OFF:Oz(n),PITCH_BEND:"PB"}[t]||t}})).filter("midiMappableReadableTrackId",["EditorRevision","MidiMapping",function(e,t){return function(n){let{trackId:o}=n;const r=e.current.tracks.find((e=>e.id===o));if(r)return r.name;t.pruneMappings()}}]).directive("midiMappingRange",["MidiMapping",function(e){return{require:["ngModel"],scope:{midiMappingTarget:"=",midiMappingLimit:"@",ngModel:"="},link:function(t,n,o,r){let[i]=r;function a(n){i.$viewValue=s(n,e.getMetadata(t.midiMappingTarget).step),i.$render()}function s(e,t){return t?Math.round(Math.ceil(e/t)*t*1e3)/1e3:e}i.$formatters.push((function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.getDefault(t.midiMappingTarget,t.midiMappingLimit);if(setTimeout((function(){e.updateMappings()})),n=e.getLimit(t.midiMappingTarget,n),angular.isDefined(n))return s(n,e.getMetadata(t.midiMappingTarget).step)})),i.$parsers.push((function(n){if(isNaN(n)&&n!==-1/0||""===n)return function(e){i.$modelValue=e,t.ngModel=e}(n=e.getDefault(t.midiMappingTarget,t.midiMappingLimit)),a(e.getLimit(t.midiMappingTarget,n)),n;setTimeout((function(){e.updateMappings()}));const o=As(e.setLimit(t.midiMappingTarget,parseFloat(n)),"min"===t.midiMappingLimit?e.getDefault(t.midiMappingTarget,"min"):Math.max(e.getDefault(t.midiMappingTarget,"min"),t.midiMappingTarget.min),"max"===t.midiMappingLimit?e.getDefault(t.midiMappingTarget,"max"):Math.min(e.getDefault(t.midiMappingTarget,"max"),t.midiMappingTarget.max));return isNaN(o)?void 0:(a(e.getLimit(t.midiMappingTarget,o)),o)}))}}}]).directive("midiMappingRow",(function(){return{replace:!0,restrict:"E",scope:{mapping:"="},templateUrl:"https://www.bandlab.com/web-app/editor/partials/_midi-mapping-row-59f30947.html",controller:["$scope","MidiMapping",function(e,t){var n;e.getUnit=t.getUnit,e.removeMapping=t.removeMapping,e.minRangeStart=function(){n=e.mapping[1].min},e.minRangeMove=function(o,r){const i=t.getDefault(e.mapping[1],"min"),a=n+r/300;e.mapping[1].min=As(a,i,e.mapping[1].max)},e.maxRangeStart=function(){n=e.mapping[1].max},e.maxRangeMove=function(o,r){const i=t.getDefault(e.mapping[1],"max"),a=n+r/300;e.mapping[1].max=As(a,e.mapping[1].min,i)}}]}})),angular.module("bandlab.editor").value("MidiEditorState",{addedNotesByRegion:{},clipboard:null,hasFocus:!1,height:338,isDrawing:!1,isDrawingWithShortcut:!1,isFollowingPlayhead:!0,isPianoRoll:!0,isResizing:!1,isTripletGrid:!1,isVelocity:!1,isVisible:!1,notesByRegion:{},noteDuration:{},originalHeight:338,previewNote:Vt(!0),quantizationValue:16,removedNotesByRegion:{},selectedNotesByRegion:{},snapSetting:$l[0],editingNotesByRegion:{},mapEditingNoteToOriginal:new Map,mapOriginalNoteToEditing:new Map,track:{},MIDI_NOTE_DURATION_MIN:.001,MIDI_NOTE_UI_HEIGHT_LARGE:32,MIDI_ROLL_LABEL_WIDTH:parseInt(window.getComputedStyle(document.body).getPropertyValue("--midi-editor-roll-labels-width")),MIDI_ROLL_PIANO_KEYS_WIDTH:parseInt(window.getComputedStyle(document.body).getPropertyValue("--midi-editor-roll-piano-keys-width")),OCTAVES:8,TIME_APPROXIMATION:.03}).factory("MidiEditor",["$analytics","$q","$rootScope","$timeout","EditorData","EditorHelper","EditorHistory","EditorMidiSamples","EditorMidiScore","EditorPlayer","EditorRevision","EditorScrollState","EditorState","MidiEditorState","Soundbank",function(e,t,n,o,r,i,a,s,l,c,u,d,p,m,f){let h={highestVisibleNote:null,highestNoteScrollTopDist:null};const g={},v=new Map;return{activePreviewNotes:g,autoscroll:function(e,t){var n=d.SCROLL_STEP;switch(!0){case e.x>t.right-37:d.notesLeft+=n;break;case e.x<t.left:d.notesLeft-=n;break;case e.y<t.top:d.notesTop-=n;break;case e.y>t.bottom:d.notesTop+=n}},beforeFocusedScrollToNotesY:function(e){const t=d.notesTop-xl,n={oldMode:QF.value,noViewNotesTop:e===XF?d.notesTop:QF.value===XF&&h?h.noViewNotesTop:null};if(0===sB.value.length)return void(h=null);let o=function(){const{flattenNotes:e,getNotesTime:t}=l,n=d.notesLeft-Al,o=d.notesTop-xl,r=d.notesTimelineEl.getBoundingClientRect().width,i=n+r,a=o+d.notesEl.clientHeight,s=m.track.regions.filter((e=>{const t=e.startPosition*m.scalePx,o=e.endPosition*m.scalePx;return t<=i&&o>=n||o>=n&&t<=i}));if(0===s.length)return null;const c=I(),p=s.flatMap((r=>e(t(r.sampleId,u.current.metronome.bpm),r).map((e=>(e.notePosX=(e.time+r.startPosition)*m.scalePx,e.notePosY=c[e.midiNote],e))).filter((e=>{let{notePosX:t,notePosY:r}=e;return t>n&&t<=i&&r>o&&r<=a}))));return 0===p.length?null:p}();if(!o)return void(h=null);const r=o.some((e=>e.inLoop)),i=o.some((e=>!e.inLoop));r&&i&&(o=o.filter((e=>!e.inLoop)));const a=o.sort(((e,t)=>t.midiNote-e.midiNote))[0],s=a.notePosY-t;h={...n,highestVisibleNote:a,noteDistToNotesTop:s}},copyNotes:M,copyNotesToTrack:function(e,t,n){var o;o=e.regions.map((function(e){var t,n;return t=s.get(e.sampleId),n=_.filter(t.notes,(function(t){return _.find(m.selectedNotesByRegion[e.id],{id:t.id})})),!!n.length&&l.editScore(t,n)})),t.regions=_.filter(t.regions,(function(e,t){return!!o[t]&&(e.sampleId=o[t].id,!0)})),u.selectedRegions=new Set(t.regions),n&&e.regions.forEach((function(e){var t,n,o;if(n=s.get(e.sampleId),o=_.filter(n.notes,(function(t){return!_.find(m.selectedNotesByRegion[e.id],{id:t.id})})),o.length===n.notes.length)return!1;t=l.editScore(n,o),l.updateMidiRegionWithScore(e,t)}))},cutNotes:function(){M(),C()},deleteNotes:C,focusedScrollToNotesY:function(){if(0===sB.value.length)return void function(){let e=60;if(QF.value===ZF){const t=`${BS.value.tonal||BS.value.label}4`;e=[...dB.value].find((e=>t===e.name||t===`${e.enharmonic}${e.oct}`)).midi}E(I()[e]+xl-d.notesEl.clientHeight/2+k()/2)}();if(!h)return void A();if(null!==h.noViewNotesTop&&h.oldMode===XF)return E(h.noViewNotesTop),void(h.noViewNotesTop=null);const{highestVisibleNote:e,noteDistToNotesTop:t}=h,n=d.notesTop-xl,o=I()[e.midiNote],r=o-n,i=o<=d.notesTop?-Math.abs(r)-t:r-t;E(d.notesTop+i)},getHighestNoteInRoll:$,getNoteColor:function(e,t){const n=9===t.length?t.slice(7,9):"",o=9===t.length?t.slice(0,7):t,r=Math.round(255*Math.max(0,Math.min(e,1))),i=r.toString(16).padStart(2,"0");return`${o}${n?Math.round(parseInt(n,16)/255*r).toString(16).padStart(2,"0"):i}`},getNoteHeight:k,getNotePositionY:function(e){return m.isPianoRoll&&QF.value?pB.value.indexOf(e)*k()+"px":e*k()+"px"},getMidiRollLabelsWidth:function(){return m.isPianoRoll?m.MIDI_ROLL_PIANO_KEYS_WIDTH:m.MIDI_ROLL_LABEL_WIDTH},getSelectedNotes:y,getSelectedNotesBoundaries:function(e){var t=_.sortBy(e,"midiNote"),n=t[t.length-1];return{infDeltaMidiNote:-t[0].midiNote,supDeltaMidiNote:$()-1-n.midiNote}},getShortestNoteToRegionEndDuration:function(){const e=Object.entries(m.selectedNotesByRegion).map((function(e){let[t,n]=e;if(!n.length)return;const o=[].concat(n).sort((function(e,t){return e.time+e.duration-(t.time+t.duration)})).pop(),r=_.find(m.track.regions,{id:t});return r&&i.getFirstLoopDuration(r)-(o.time+o.duration)})).filter((e=>!!e));return Math.min(...e)},hasSelectedNotes:function(){return p.canCollaborate&&Object.values(m.selectedNotesByRegion).flat().length>0},humanizeNotes:function(){a.withSingleUndo((()=>{_.chain(m.track.regions).filter((function(e){return m.selectedNotesByRegion[e.id].length>0})).forEach((function(e){_.forEach(m.selectedNotesByRegion[e.id],(function(t){t.time=.02*Math.random()+(t.time-.01),t.time=Math.min(e.endPosition-e.startPosition,t.time),t.time=Math.max(0,t.time)}))})).value(),D()}))},pasteNotes:function(){if(m.clipboard.length){var e,t,n,o=p.crTime,r=_.find(m.track.regions,(function(e){return e.startPosition<=o&&e.startPosition+i.getFirstLoopDuration(e)>o}));r&&(a.pushUndo(u.current),n=s.get(r.sampleId),e=o-(r.startPosition-r.sampleOffset),t=_.map(m.clipboard,(function(t){return{...t,id:ad(),duration:`${Bz(t.duration,u.current.metronome.bpm)}i`,time:`${Bz(t.time+e,u.current.metronome.bpm)}i`}})),n=l.editScore(n,n.notes.concat(t)),l.updateMidiRegionWithScore(r,n),m.selectedNotesByRegion[r.id]=t,c.updateSourcesInTracks(),p.hasRevisionChanges=!0)}},previewNote:x,previewSoloNote:async function(e){const t=u.selectedTrack.id;var n=m.isPianoRoll?e.midiNote:S(e.midiNote);await O(t),x(n,e.velocity),o((function(){L(n)}),Math.min(1e3*e.duration,2e3*$s(u.current.metronome)))},previewStopNotes:O,quantizeNotes:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m.quantizationValue;Number.isInteger(e)||(e=1/m.snapSetting.value);var t=e!==1/0?ws(u.current.metronome)*u.current.metronome.signature.notesCount/e:m.snapDuration;a.pushUndo(u.current),m.track.regions.filter((function(e){return m.selectedNotesByRegion[e.id].length>0})).forEach((function(e){var n=s.get(e.sampleId),o=_.map(n.notes,(function(n){var o,r,a=_.find(m.selectedNotesByRegion[e.id],{id:n.id});return a?(o=e.startPosition+a.time-e.sampleOffset,r=i.snapToGrid(o+e.sampleOffset,t,{force:!0,padding:t/2},m),a.time+=r-o,{...n,time:`${Bz(Math.max(a.time,0),u.current.metronome.bpm)}i`}):n}));n=l.editScore(n,o),l.updateMidiRegionWithScore(e,n),c.updateSourcesInTracks()}))},quantizeNotesInRegion:function(e,t){Number.isInteger(e)||(e=1/m.snapSetting.value);var n=e!==1/0?ws(u.current.metronome)*u.current.metronome.signature.notesCount/e:m.snapDuration;a.pushUndo(u.current),t.forEach((function(e){const t=N(e);var o=s.get(e.sampleId),r=_.map(o.notes,(function(o){var r,a,s=_.find(t,{id:o.id});return s?(r=e.startPosition+s.time-e.sampleOffset,a=i.snapToGrid(r+e.sampleOffset,n,{force:!0,padding:n/2},m),s.time+=a-r,{...o,time:`${Bz(Math.max(s.time,0),u.current.metronome.bpm)}i`}):o}));o=l.editScore(o,r),l.updateMidiRegionWithScore(e,o),c.updateSourcesInTracks()}))},refreshRollLayout:function(){setTimeout((function(){d.notesTop=d.notesEl.scrollTop,d.tracksTop=d.tracksEl.scrollTop})),e.eventTrack("Resize height editor",{category:"Mix Editor",label:m.isVisible?"MIDI":"Audio"})},deleteMidiEditor:async function(e){v.has(e)&&(v.get(e).delete(),v.delete(e))},renderRegionNotes:N,resizeRollHeight:function(e,t){m.height=m.originalHeight+t,m.height=Math.max(m.height,0),m.height=Math.min(m.height,window.innerHeight-192),document.body.style.setProperty("--mix-editor-panel-height",`${m.height}px`)},scrollToNotes:A,scrollToRegion:function(e){const t=e?e.startPosition*m.scalePx:d.notesLeft;d.notesLeft=t,setTimeout((function(){gR.start("scroll:notesLeft",!1,d.notesLeft)}))},selectAllNotes:function(){m.selectedNotesByRegion=_.reduce(m.track.regions,(function(e,t){return e[t.id]=_.filter(m.notesByRegion[t.id],{inLoop:0}),e}),{})},selectNoteOnMousedown:function(e,t){var n=m.selectedNotesByRegion[e.region.id];if(n.indexOf(e.note)<0&&!t.shiftKey)T(),m.selectedNotesByRegion[e.region.id]=[e.note],e.$apply();else if(n.indexOf(e.note)<0&&t.shiftKey)n.push(e.note),e.$digest();else if(n.indexOf(e.note)>0&&t.shiftKey&&3!==t.which)return m.selectedNotesByRegion[e.region.id]=_.filter(n,(function(t){return t!==e.note})),e.$digest(),!1;return 3!==t.which},selectNotesOfSamePitch:function(){var e=_.chain(m.selectedNotesByRegion).values().flatten().map("midiNote").uniq().value();m.track.regions.forEach((function(t){if(m.selectedNotesByRegion[t.id].length){var n=[];m.notesByRegion[t.id].forEach((function(t){-1!==e.indexOf(t.midiNote)&&0===t.inLoop&&n.push(t)})),m.selectedNotesByRegion[t.id]=n}}))},selectNotesOfSamePitchByMidi:function(e){m.track.regions.forEach((t=>{const n=m.notesByRegion[t.id];if(0===n.length)return;const o=n.filter((t=>t.midiNote===e&&0===t.inLoop));m.selectedNotesByRegion[t.id]=[...o,...m.selectedNotesByRegion[t.id]]}))},setLegato:function(){a.withSingleUndo((()=>{_.chain(m.track.regions).filter((function(e){return m.selectedNotesByRegion[e.id].length>0})).forEach((function(e){_.forEach(m.selectedNotesByRegion[e.id],(function(t){const n=function(){const n=_.find(m.notesByRegion[e.id],(e=>e.time>t.time+t.duration));return n?n.time:e.endPosition-e.startPosition}();t.duration=n-t.time}))})).value(),D()}))},setRandomVelocity:function(){a.withSingleUndo((()=>{_.forEach(y(),(function(e){e.velocity=Math.random()*(.95-.5)+.5})),D()}))},stopPreviewNote:L,storeRollHeight:function(){m.originalHeight=m.height},transposeKeys:Es,transposeNotes:function(e){a.pushUndo(u.current),_.chain(m.track.regions).filter((function(e){return m.selectedNotesByRegion[e.id].length>0})).forEach((function(t){var n=s.get(t.sampleId),o=_.map(n.notes,(function(n){var o,r=_.find(m.selectedNotesByRegion[t.id],{id:n.id});return r?(o=r.midiNote+e,o=Math.min(127,o),o=Math.max(0,o),12===Math.abs(e)&&o!==r.midiNote+e?n:{...n,midiNote:o}):n}));n=l.editScore(n,o),l.updateMidiRegionWithScore(t,n),c.updateSourcesInTracks()})).value(),QF.value&&cB()},transposeRegions:function(e,n,o){a.pushUndo(u.current),_.reduce(e.tracks,(function(e,r){return t.resolve(e).then((function(){return _.chain(r.regions).filter((function(e){return s.has(e.sampleId)&&o.has(e)})).groupBy("sampleId").reduce((function(e,o,i){return t.resolve(e).then((function(){return w(i,n,r.soundbank)})).then((function(e){_.forEach(o,(function(t){l.updateMidiRegionWithScore(t,e),t.pitchShift=0,c.updateSourcesInTracks()}))}))}),{}).value()}))}),{})},transposeRevision:function(e,n){var o=Es(e.key,n);_.reduce(e.tracks,(function(e,n){return t.resolve(e).then((function(){return n.soundbank?f.getBank({slug:n.soundbank}):Promise.resolve()})).then((function(){return i.isTrackTransposable(n)?_.chain(n.regions).filter((function(e){return s.has(e.sampleId)})).groupBy("sampleId").reduce((function(e,r,i){return t.resolve(e).then((function(){const e=s.get(i);let t=(e.pitchShift+o+12)%12;return t>6&&(t-=12),w(i,-e.pitchShift+t,n.soundbank,{scorePitchShift:t})})).then((function(e){_.forEach(r,(function(t){l.updateMidiRegionWithScore(t,e),c.updateSourcesInTracks()}))}))}),{}).value():{}}))}),{})},transposeScoreKey:function(e,t,n,o){return w(e,Es(t,n),o)},unselectNotes:T,unselectNotesOfSamePitchByMidi:function(e){m.track.regions.forEach((t=>{const n=m.notesByRegion[t.id];if(0===n.length)return;const o=n.filter((t=>t.midiNote===e&&0===t.inLoop));m.selectedNotesByRegion[t.id]=m.selectedNotesByRegion[t.id].filter((e=>!o.includes(e)))}))},updateRegions:D,editSelectionVelocity:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(0===Object.keys(m.editingNotesByRegion).length||t){m.editingNotesByRegion=_.cloneDeep(m.selectedNotesByRegion);const e=_.chain(m.editingNotesByRegion).values().flatten().value(),t=_.chain(m.selectedNotesByRegion).values().flatten().value();for(let n=0;n<e.length;n++){const o=e[n],r=t[n];m.mapEditingNoteToOriginal.set(o,r),m.mapOriginalNoteToEditing.set(r,o)}}const n=_.chain(m.editingNotesByRegion).values().flatten().value(),o=_.chain(m.selectedNotesByRegion).values().flatten().value();if(t)return void n.forEach((function(t){t.velocity=Math.max(.01,Math.min(1,e))}));const r=wG(o,"velocity")/o.length,i=e;let a=0,s=0;for(const e of o){const t=e.velocity-r;a=Math.min(a,t),s=Math.max(s,t)}const l=s-a<1e-4;let c=l?0:1;l||(c=Math.min(c,(1-i)/s),c=Math.min(c,(.01-i)/a)),n.forEach((function(e){const t=m.mapEditingNoteToOriginal.get(e),n=c*(t.velocity-r);e.velocity=Math.max(.01,Math.min(1,i+n))}))},finishEditVelocity:function(){const e=_.chain(m.editingNotesByRegion).values().flatten().value();if(e.length){for(const t of e)m.mapEditingNoteToOriginal.get(t).velocity=t.velocity;m.editingNotesByRegion={},m.mapEditingNoteToOriginal.clear(),m.mapOriginalNoteToEditing.clear()}}};async function b(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Array.from({length:128},((e,t)=>t));if(v.has(e))return v.get(e);const n=await c.current.getMidiEditor(e,t);return n&&v.set(e,n),n}function y(){return Object.values(m.selectedNotesByRegion).flat()}function w(e,n,o){let{scorePitchShift:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var a=s.get(e),c=_.map(a.notes,(function(e){return Object.assign({},e,{midiNote:e.midiNote+n})}));return function(e,n,o,r){let{scorePitchShift:a}=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return i.isSoundbankTransposable(r)?t.resolve().then((function(){return l.editScore(e,n,{pitchShift:a})})).finally((()=>{QF.value&&cB()})):t.resolve(e)}(a,c,n,o,{scorePitchShift:r})}function $(){return m.isPianoRoll?128:m.track.samplerKit?d_.length:o_.length}function k(){return m.isPianoRoll?CB.value:m.MIDI_NOTE_UI_HEIGHT_LARGE}function S(e){return m.track.samplerKit?p_[e].midi:o_[e].midi}function P(e){return[...d_].sort(((e,t)=>e.midi-t.midi))[e].midi}function M(){var e;m.clipboard=_.chain(m.selectedNotesByRegion).values().flatten().map((function(e){let{...t}=e;return t.id=null,m.isPianoRoll||(t.midiNote=S(t.midiNote)),t})).sortBy("time").value(),m.clipboard.length&&(e=m.clipboard[0].time,m.clipboard=_.map(m.clipboard,(function(t){return t.time-=e,t})))}function T(){Object.keys(m.selectedNotesByRegion).forEach((function(e){m.selectedNotesByRegion[e]=[]}))}function C(){a.withSingleUndo((()=>{m.removedNotesByRegion={...m.selectedNotesByRegion},D(),T()}))}function E(e){d.notesTop=e,gR.start("scroll:notesTop",!1,d.notesTop),setTimeout((()=>{d.notesTop=e,gR.start("scroll:notesTop",!1,d.notesTop)}))}function I(){const e=k();return[...uB.value].reduce(((t,n,o)=>(t[n]=o*e,t)),{})}function R(e){return(QF.value?uB.value.indexOf(e):$()-e)*k()}function A(e){let{always:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e){const t=m.track.regions.filter((e=>u.selectedRegions.has(e)&&s.has(e.sampleId)));e=_.minBy(t,"startPosition")}const n=e?N(e):[],o=_.chain(n).minBy("midiNote").get("midiNote").value(),r=_.chain(n).minBy("time").get("time").value()??0;let i;if(m.isPianoRoll){const e=o?12*Math.floor(o/12):f.getPropertyValue(m.track.soundbank,"defaultOctave");i=R(e)-d.notesEl.clientHeight}else i=o?($()-o)*m.MIDI_NOTE_UI_HEIGHT_LARGE-d.notesEl.clientHeight:0;const a=e?(e.startPosition+r)*m.scalePx:d.notesLeft;(t||a<d.notesLeft||a>d.notesLeft+d.notesTimelineEl.clientWidth)&&(d.notesLeft=a);const l=R(o),c=d.notesTop<=l&&l<=d.notesEl.clientHeight+d.notesTop;c||(d.notesTop=i),gR.start("scroll:notesTop",!1,d.notesTop),gR.start("scroll:notesLeft",!1,d.notesLeft),setTimeout((function(){c||(d.notesTop=i),gR.start("scroll:notesTop",!1,d.notesTop),gR.start("scroll:notesLeft",!1,d.notesLeft)}))}async function x(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!m.previewNote.value)return;const o=u.selectedTrack.id,r=await b(o);r&&(await r.startNoteAtRowWithVelocity(e,Math.round(127*t)),g[e]=!0,n.$broadcast("MidiMessage:noteEvent"))}async function L(e){const t=u.selectedTrack.id,o=await b(t);o&&(await o.stopNoteAtRow(e),g[e]=!1,n.$broadcast("MidiMessage:noteEvent"))}async function O(e){if(!e)return;const t=await b(e);t&&(await t.stopAllNotes(),Object.keys(g).forEach((e=>delete g[e])))}function j(e,t){return{id:t.id,duration:`${Bz(t.duration,u.current.metronome.bpm)}i`,time:`${Bz(t.time+e.sampleOffset,u.current.metronome.bpm)}i`,midiNote:m.isPianoRoll?t.midiNote:m.track.samplerKit?P(t.midiNote):S(t.midiNote),velocity:t.velocity}}function D(){_.chain(m.track.regions).filter((function(e){var t=m.selectedNotesByRegion[e.id];return t&&t.length>0})).forEach((function(e){var t=function(e,t,n,o){var r,i=s.get(e.sampleId);return a.pushUndo(u.current),r=_.map(i.notes,(function(n){var o=_.find(t,{id:n.id});return o?j(e,o):n})),n&&(r=r.concat(_.map(n,(function(t){return j(e,t)})))),o&&(r=_.reject(r,(function(e){return _.find(o,{id:e.id})}))),l.editScore(i,r)}(e,m.selectedNotesByRegion[e.id],m.addedNotesByRegion[e.id],m.removedNotesByRegion[e.id]);m.addedNotesByRegion[e.id]=[],m.removedNotesByRegion[e.id]=[],l.updateMidiRegionWithScore(e,t),c.updateSourcesInTracks()})).value(),p.hasRevisionChanges=!0,r.updateSongDuration()}function N(e){return _.chain(l.flattenNotes(l.getNotesTime(e.sampleId,u.current.metronome.bpm),e)).filter((function(e){return angular.isDefined(e.midiNote)&&(m.isPianoRoll||_.some(o_,{midi:e.midiNote}))})).map((function(e){if(m.isPianoRoll||m.track.samplerKit)!m.isPianoRoll&&m.track.samplerKit&&(e.midiNote=[...d_].sort(((e,t)=>e.midi-t.midi)).findIndex((t=>t.midi===e.midiNote)));else{const t=_.findIndex(o_,{midi:e.midiNote});e.midiNote=t}return e})).value()}}]),angular.module("bandlab.editor").factory("MidiKeyboardHandler",["$document","$rootScope","SharedMidiSynth","Soundbank",function(e,t,n,o){var r,i=[],a=[];return{changeKeymap:function(e){e!==r&&(r=e,qS.octave=2,i=function(e,t){switch(e){case"creators-kit":return d_.reduce((function(e,t){return e[t.code]=t.midi,e}),{});case h_:return function(e){const t=JS.IS_LEGACY_KEYBOARD?i_:r_;let n=12*e;const o=t.reduce((function(e,t){return e[t]=n++,e}),{});return JS.IS_LEGACY_KEYBOARD?{...o,...c_,SemiColon:o.Digit1,Slash:o.KeyQ}:{...o,...l_}}(t);case f_:return S_().reduce(((e,t)=>(e[t.code]=t.midi,e)),{});default:return w_().reduce((function(e,t){return e[t.code]=t.midi,e}),{})}}(e,qS.octave))},disable:f,enable:function(){f(),e.on("keydown",p),e.on("keyup",m),window.addEventListener("blur",d)},octaveDown:l,octaveUp:s,press:c,release:u,releaseAll:d,updatePianoKeyMap:function(){r===h_&&(i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t={},n=T_();for(let o=0;o<n.length;o++)t[n[o]]=e[o];return JS.IS_LEGACY_KEYBOARD?{...t,...c_,SemiColon:t.Digit1,Slash:t.KeyQ}:{...t,...l_}}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]))}};function s(){qS.octave<8&&(qS.octave++,n.stopNotes())}function l(){qS.octave>-1&&(qS.octave--,n.stopNotes())}function c(e){if(!a[e]){if(a[e]=!0,["creators-kit",m_,f_].includes(r))n.noteOn(e,Ul);else switch(e){case"sustain":n.setSustain(127);break;case 300:l();break;case a_:s();break;default:if(XT(n.getSoundbank())){ZT(e,(function(e){n.noteOn(e,n.getFixedVelocity()),t.$broadcast("MidiMessage:noteEvent",e)}),(function(e){n.notesOn(e.map((e=>[e,n.getFixedVelocity()]))),e.forEach((e=>{t.$broadcast("MidiMessage:noteEvent",e)}))}),(function(e){n.notesOff(e.map((e=>[e,0]))),t.$broadcast("MidiMessage:noteEvent")}));break}n.noteOn(e,n.getFixedVelocity())}t.$broadcast("MidiMessage:noteEvent",e)}}function u(e){if(VT.value&&VT.value?.root===e)QT(VT.value?.root,(function(e){n.notesOff(e.map((e=>[e,0]))),t.$broadcast("MidiMessage:noteEvent")}));else if(n.noteOff(e),"creators-kit"===r){const t=fC(o.getNoteWithOctave(e)),r=n.getSampler().pads[t];"Gate"===r?.launchMode&&r?.samplerPad.forceStop()}"sustain"===e&&n.setSustain(0),a[e]=!1,t.$broadcast("MidiMessage:noteEvent")}function d(){a=[],n.setSustain(0),n.stopNotes(),t.$applyAsync()}function p(e){e.ctrlKey||e.metaKey||e.repeat||-1!==["INPUT","TEXTAREA"].indexOf(e.target.nodeName)||"true"===e.target.getAttribute("contenteditable")||e.code in i&&(e.preventDefault(),c(i[e.code]))}function m(e){e.code in i&&u(i[e.code])}function f(){d(),e.off("keydown",p),e.off("keyup",m),window.removeEventListener("blur",d)}}]),angular.module("bandlab.editor").factory("MidiSynth",["$injector","EditorPlayer","Soundbank",function(e,t,n){return function(){let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lh();const r=Mt({}),i=Mt({bindMultipadSampler:()=>{},loading:!1,pads:[],pad:{},recordingPad:{},multipadSampler:null,waveforms:[]});var a=Ul,s=0,l={};return{getFixedVelocity:function(){return a},getSampler:function(){return i},isNoteMapped:function(e){return"VASynth"===l.synth||"FMSynth"===l.synth?null!==e&&e>=0&&e<=127:(t=l.slug,n=e,RL[t]?.[n]);var t,n},isSustaining:function(){return s>64},noteOff:function(e,t,n){r[e]=null,p(e,t,n)},noteOn:function(e,t,n){r[e]=!0,function(e,t,n){const r=n+m(o);f().onEvent([144,e,Math.round(127*t)],r)}(e,t,n)},notesOff:function(e,t){e.forEach((e=>{let[t]=e;r[t]=null})),function(e,t){const n=t+m(o),r=e.reduce(((e,t)=>{let[n,o]=t;return e.concat([128,n,Math.round(127*o)])}),[]);f().onEventStream(r,n)}(e,t)},notesOn:function(e,t){e.forEach((e=>{let[t]=e;r[t]=!0})),function(e,t){const n=t+m(o),r=e.reduce(((e,t)=>{let[n,o]=t;return e.concat([144,n,Math.round(127*o)])}),[]);f().onEventStream(r,n)}(e,t)},setFixedVelocity:function(e){a=e},setInput:function(e){let{samplerKit:t,soundbank:o,soundbankSlug:r}=e;return o?(u(o),Promise.resolve()):r?function(e){return n.getList().then((function(t){return n.getBank(_.find(t,{slug:e}))}))}(r).then((e=>u(e))):t?c(t):void 0},setSustain:function(e){d([ez,64,e]),s=e},setPitchBend:function(e){let[t,n,o]=e;d([t,n,o])},setSampler:c,setSoundbank:u,getSoundbank:function(){return l},stopNotes:function(){Object.keys(r).filter((function(e){return r[e]})).forEach((function(e){p(e),r[e]=null}))},current:r};function c(n){return i.loading=!0,t.current.prepareMix().then((function(){return t.current.updateMix()})).then((function(){const t=i.pads.indexOf(i.pad),{bindMultipadSampler:o,clipboard:r,duplicatePad:a,getEmptyPad:s,getIsPlayingMap:l,loadSamplerKit:c,movePad:u,multipadSampler:d,pads:p,recordingPad:m,selectedPad:f,startRecording:h,stopRecording:g,swapPads:v}=function(e,t,n){const o=e.get("EditorPlayer"),r=Vt(null),i=Vt(null),a=Vt(null),s=Vt(new Map),l=Vt((()=>Promise.resolve()));d();const c=Array.from({length:16},(function(e,t){const n=Gi((function(){return s.value.get(t)})),a=Vt(0),l=Vt(""),c=Gi({get:()=>a.value,set:async function(e){a.value=e,n.value&&(await n.value.setAttackTime(e,!1),l.value=await n.value.getAttackTimeDisplayValue())}}),u=Vt(0),d=Gi({get:()=>u.value,set:function(e){u.value=e,n.value&&n.value.setColor(e)}}),p=Vt(0),m=Gi({get:()=>p.value,set:function(e){p.value=e,n.value&&n.value.setEndTime(e,!1)}}),f=Vt(null),h=Gi({get:()=>f.value,set:()=>{}}),g=Vt("Gate"),v=Gi({get:()=>g.value,set:async function(e){g.value=e,n.value&&(n.value.setLaunchMode(e),g.value=await n.value.getLaunchMode())}}),b=Vt(0),y=Gi({get:()=>b.value,set:function(e){b.value=e,n.value&&n.value.setMutexGroup(e)}}),w=Vt(0),$=Vt(""),k=Gi({get:()=>w.value,set:async function(e){w.value=e,n.value&&(await n.value.setPan(e,!1),$.value=await n.value.getPanDisplayValue())}}),S=Vt(0),_=Vt(""),P=Gi({get:()=>S.value,set:async function(e){S.value=e,n.value&&(await n.value.setPitchShift(e,!1),_.value=await n.value.getPitchShiftDisplayValue())}}),M=Vt(0),T=Vt(""),C=Gi({get:()=>M.value,set:async function(e){M.value=e,n.value&&(await n.value.setReleaseTime(e,!1),T.value=await n.value.getReleaseTimeDisplayValue())}}),E=Vt(0),I=Gi({get:()=>E.value,set:()=>{}}),R=Vt(0),A=Gi({get:()=>R.value,set:function(e){R.value=e,n.value&&n.value.setStartTime(e,!1)}}),x=Vt(0),L=Vt(""),O=Gi({get:()=>x.value,set:async function(e){x.value=e,n.value&&(await n.value.setTone(e,!1),L.value=await n.value.getToneDisplayValue())}}),j=Vt(0),D=Vt(""),N=Gi({get:()=>j.value,set:async function(e){j.value=e,n.value&&(await n.value.setVolume(e,!1),D.value=await n.value.getVolumeDisplayValue())}}),U=Vt(null);return Lr([A,m],(async function(){n.value&&(U.value=await F(n.value))})),Lr(n,(async function(){if(!n.value)return f.value=null,void(U.value=null);[a.value,u.value,p.value,f.value,g.value,b.value,w.value,S.value,M.value,E.value,R.value,x.value,j.value,l.value,$.value,_.value,T.value,L.value,D.value,U.value]=await Promise.all([n.value.getAttackTime(),n.value.getColor(),n.value.getEndTime(),n.value.getId(),n.value.getLaunchMode(),n.value.getMutexGroup(),n.value.getPan(),n.value.getPitchShift(),n.value.getReleaseTime(),n.value.getSampleLength(),n.value.getStartTime(),n.value.getTone(),n.value.getVolume(),n.value.getAttackTimeDisplayValue(),n.value.getPanDisplayValue(),n.value.getPitchShiftDisplayValue(),n.value.getReleaseTimeDisplayValue(),n.value.getToneDisplayValue(),n.value.getVolumeDisplayValue(),F(n.value)])}),{immediate:!0}),{attackTime:c,color:d,endTime:m,id:h,launchMode:v,mutexGroup:y,pan:k,pitchShift:P,releaseTime:C,sampleLength:I,startTime:A,tone:O,volume:N,waveform:U,readableAttackTime:l,readableReleaseTime:T,readablePan:$,readablePitchShift:_,readableTone:L,readableVolume:D,samplerPad:n,crop:async function(){n.value&&i.value&&(n.value.crop(),s.value=await i.value.getAllPads())},normalize:async function(){n.value&&i.value&&(n.value.normalize(),s.value=await i.value.getAllPads())},remove:async function(){i.value&&(await i.value.removePadFrom(t),s.value=await i.value.getAllPads())},reverse:async function(){n.value&&i.value&&(n.value.reverse(),s.value=await i.value.getAllPads(),zC("me_sampler_pad_actions",{action:"delete"}))},copy:async function(){r.value=t},paste:async function(){r.value&&i.value&&(await i.value.copyPad(r.value,t),s.value=await i.value.getAllPads())},loadSample:async function(e,n){if(!i.value)return;await o.current.writeSample(e,n),await i.value.loadSample(e,t);const r=await i.value.getPadAt(t);await r.setAttackTime(0,!1),await r.delete(),s.value=await i.value.getAllPads()},getWaveform:async function(e,t){if(n.value)return n.value.getWaveform(e,t)}};async function F(e){const t=await e.getWaveform(oC(55),!0);return hC(oC(55),t)}})),u=Vt(c[Math.max(n,0)]);return{clipboard:r,multipadSampler:i,pads:c,recordingPad:a,selectedPad:u,bindMultipadSampler:d,startRecording:async function(t,n,r){const u=await o.current.startRecordingSampler(t,n,r);a.value=c[n],l.value=async function(){if(!i.value)return;l.value=()=>Promise.resolve(),await u(),s.value=await i.value.getAllPads(),a.value=null;const t=await i.value.getKit();if(!t)return;const n=qC(t);Object.assign(r.samplerKit,WC(n)),jC(e,0,r)}},stopRecording:l,getEmptyPad:function(){for(let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e<16;e++)if(!s.value.has(e))return e;return-1},getIsPlayingMap:async function(){const e=new Map;if(!i.value)return Promise.resolve(e);for(const[t,n]of await i.value.getAllPads()){const o=await n.isPlaying();e.set(t,o)}return e},duplicatePad:async function(e,t){i.value&&(await i.value.copyPad(e,t),s.value=await i.value.getAllPads(),u.value=c[t])},loadSamplerKit:async function(e){i.value&&(await o.current.putSamplerKitsIntoVirtualFileSystem([e]),await i.value.loadKit({...e,kit:JSON.stringify(e.kit)}),s.value=await i.value.getAllPads())},movePad:async function(e,t){i.value&&(await i.value.copyPad(e,t),await i.value.removePadFrom(e),s.value=await i.value.getAllPads(),u.value=c[t])},swapPads:async function(e,t){if(!i.value)return;const n=await i.value.getKit();if(!n)return;const o=n.kit,r=JSON.parse(o),a=c[e],l=c[t],d=r.layers.find((e=>e.id===l.id.value)),p=l.attackTime.value,m=l.color.value,f=l.endTime.value,h=l.launchMode.value,g=l.mutexGroup.value,v=l.pan.value,b=l.pitchShift.value,y=l.releaseTime.value,w=l.startTime.value,$=l.tone.value,k=l.volume.value;await i.value.copyPad(e,t),await i.value.removePadFrom(e),await i.value.loadSample(d.sampleId,e),s.value=await i.value.getAllPads(),a.attackTime.value=p,a.color.value=m,a.endTime.value=f,a.launchMode.value=h,a.mutexGroup.value=g,a.pan.value=v,a.pitchShift.value=b,a.releaseTime.value=y,a.startTime.value=w,a.tone.value=$,a.volume.value=k,u.value=c[t]}};async function d(){i.value=await o.current.getMultipadSamplerForTrack(t,!0),i.value&&(s.value=await i.value.getAllPads(),await i.value.setAutoOnsetDetection(!0),await i.value.setDenoiseAfterRecording(!1))}}(e,n,t);i.bindMultipadSampler=o,i.clipboard=r,i.duplicatePad=a,i.getEmptyPad=s,i.getIsPlayingMap=l,i.loadSamplerKit=c,i.movePad=u,i.multipadSampler=d,i.pad=f,i.pads=p,i.recordingPad=m,i.startRecording=h,i.stopRecording=g,i.swapPads=v,i.track=n,i.loading=!1}))}function u(e){l=e}function d(e){let[t,n,r]=e;const i=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)+m(o);f().onEvent([t,n,r],i)}function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=(arguments.length>2?arguments[2]:void 0)+m(o);f().onEvent([128,e,Math.round(127*t)],n)}function m(e){return.001*(performance.now()-e.getOutputTimestamp().performanceTime)}function f(){return t.current.audioEngineNode.MIDISource}}}]),angular.module("bandlab.editor").factory("SharedMidiSynth",["MidiSynth",function(e){return new e}]),angular.module("bandlab.notification",[]).config(["$stateProvider",function(e){e.state("notifications",{url:"/notifications",redirectTo:"notifications.activities",templateUrl:"https://www.bandlab.com/web-app/notification/views/notifications-layout-8f1f0e1d.html",controller:["$scope","Me",function(e,t){e.me=t}]}).state("notifications.activities",{url:"/activities",templateUrl:"https://www.bandlab.com/web-app/notification/views/notifications-activities-b0532e56.html",controller:"NotificationsActivitiesCtrl"}).state("notifications.invites",{url:"/invites?id",reloadOnSearch:!1,templateUrl:"https://www.bandlab.com/web-app/notification/views/notifications-invites-c341a025.html",controller:"NotificationsInvitesCtrl"}).state("notifications.requests",{url:"/requests",templateUrl:"https://www.bandlab.com/web-app/notification/views/follow-requests-760ed745.html",controller:"FollowRequestsCtrl"})}]),angular.module("bandlab.notification").controller("FollowRequestsCtrl",["$q","$scope","Me","User","UserHelper",function(e,t,n,o,r){var i,a=null,s=!1;function l(){return s?e.resolve([]):i=o.relation({id:n.id,rel:"followers",limit:20,after:a,isApproved:!1}).$promise.then((function(e){let{data:t,paging:n}=e;return s=n.itemsCount<n.limit,a=n.cursors.after,t}))}t.loadMore=function(){return t.infiniteScrollEnded?e.resolve():(i=i.then((function(e){return t.infiniteScrollEnded=s,t.users=t.users||[],t.users=t.users.concat(e),l()})),i)},l().then(t.loadMore),t.toggleFollow=function(e){r.toggleFollowUser(e)},t.updateRequest=function(e,t){"accept"===t?o.followRequest({id:n.id,followerId:e.id,isApproved:!0}).$promise.then((function(){e.followAccepted=!0})):o.unfollow({id:n.id,followerId:e.id}).$promise.then((function(){e.followDeclined=!0}))}}]),angular.module("bandlab.notification").controller("InviteCtrl",["$rootScope","$timeout","AppNotifications","authService","Invite",function(e,t,n,o,r){this.acceptInvite=function(i){return r.update({id:i.id}).$promise.then((function(){return i.accepted=!0,t((function(){e.$broadcast("$invite:changed",{invite:i}),o.refreshMe()}),1e3),Promise.resolve().then((()=>rb)).then((function(e){let{logBandJoin:t,logBandRequestAccept:n,logCommunityJoin:o}=e;"RequestToBand"===i.type?n({bandId:i.band.id}):"InviteToBand"===i.type?t({bandId:i.band.id}):i.community&&o()})),i})).catch((function(e){var t,o="Unable to accept invite";return 64===e.data.errorCode?i.band||i.bandId?(o="This band is currently full",t=i.isUserRequest?"To add a new member, remove someone first.":"Try again once a member leaves, or message the owner/admin for help."):t="Youve reached the max number of members. Band can only have 50 members.":t=_.get(e,"data.message"),n.addNotification({title:o,content:t,classList:"alert",autoclose:5e3}),i}))},this.declineInvite=function(n){r.remove({id:n.id}).$promise.then((function(){n.declined=!0,t((function(){e.$broadcast("$invite:changed",{invite:n}),o.refreshMe()}),1e3)}))}}]),angular.module("bandlab.notification").controller("NotificationsActivitiesCtrl",["$http","$q","$scope","Identity","Me","Notification",function(e,t,n,o,r,i){var a,s=null,l=!1;function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return l?t.resolve(e):a=i.me({after:s,limit:20}).$promise.then((function(t){const n=[...e,...t.data];return l=t.paging.itemsCount<20,s=_.get(t,"paging.cursors.after",0),n.length<20&&t.data.length!==t.paging.itemsCount?c(n):n}))}n.isPrivate=r.isPrivate,e.get(`https://www.bandlab.com/api/v1.3/users/${r.id}/followers/count`).then((function(e){let{data:t}=e;n.followRequestCount=t.count})),o.getWarning({id:r.id}).$promise.then((function(e){let{userWarnings:t}=e;n.userWarnings=t})),n.loadMore=function(){return n.infiniteScrollEnded?t.resolve():a=a.then((function(e){return n.infiniteScrollEnded=l,n.activities=n.activities||[],n.activities=n.activities.concat(e),c()}))},c().then(n.loadMore).then((function(){new i({unread:!1,lastReadOn:(new Date).toISOString()}).$dismiss().then((function(){r.counters={...r.counters,unreadYouNotifications:0}}))}))}]),angular.module("bandlab.notification").controller("NotificationsDropdownCtrl",["$http","$scope","Identity","Invite","Me","Notification","Page",function(e,t,n,o,r,i,a){t.isPrivate=r.isPrivate,e.get(`https://www.bandlab.com/api/v1.3/users/${r.id}/followers/count`).then((function(e){let{data:n}=e;t.followRequestCount=n.count})),n.getWarning({id:r.id}).$promise.then((function(e){let{userWarnings:n}=e;t.userWarnings=n})),i.me({limit:10}).$promise.then((function(e){let{data:n}=e;return t.activities=n,0===t.activities.length?o.query({id:r.id,entity:"users",types:"band;community;song",limit:10}).$promise.then((function(e){t.invites=e})):t.invites=[],new i({unread:!1,lastReadOn:(new Date).toISOString()}).$dismiss()})).then((function(){r.counters={...r.counters,unreadYouNotifications:0},a.update()}))}]),angular.module("bandlab.notification").controller("NotificationsInvitesCtrl",["$q","$scope","$state","$stateParams","Invite","Me","Notification",function(e,t,n,o,r,i,a){var s,l=0,c=!1;function u(){return c?e.resolve([]):((s=r.query({id:i.id,entity:"users",types:"band;community;song",offset:l,limit:20}).$promise).then((function(e){c=0===e.length||e.length<20,l+=e.length})),s)}t.$on("$user:relationChanged",(function(e,n){let{type:o,user:r}=n;"block"===o&&(t.invites=t.invites.filter((function(e){return e.sender.id!==r.id})),t.invites.length<20&&!c&&t.loadMore())})),t.loadMore=function(){return t.infiniteScrollEnded?e.resolve():s=s.then((function(e){return t.infiniteScrollEnded=c,t.invites=t.invites||[],t.invites=t.invites.concat(e),u()}))},u().then(t.loadMore).then((function(){n.includes("notifications")&&o.id&&r.get({id:o.id}).$promise.then((function(e){return r.update({id:e.id}),Promise.resolve().then((()=>rb)).then((function(t){let{logBandJoin:n,logBandRequestAccept:o,logCommunityJoin:r}=t;"RequestToBand"===e.type?o({bandId:e.band.id}):"InviteToBand"===e.type?n({bandId:e.band.id}):e.community&&r()})),e})).then((function(e){var o=_.find(t.invites,{id:e.id});o?o.accepted=!0:t.invites.unshift(e),n.go(".",{},{inherit:!1})})).catch((function(){n.go(".",{},{inherit:!1})}))})).then((function(){new a({type:"invites",lastReadOn:(new Date).toISOString()}).$dismiss().then((function(){i.counters={...i.counters,unreadInviteNotifications:0,bandInvites:0}}))}))}]),angular.module("bandlab.notification").component("invitationCard",{bindings:{band:"=",community:"=",inviteId:"<"},templateUrl:"https://www.bandlab.com/web-app/notification/partials/_invitation-card-0d12b6ea.html",controller:["Invite",function(e){const t=this;t.$onInit=function(){t.inviteId&&e.get({id:t.inviteId}).$promise.then((function(e){t.invite=e}))}}],controllerAs:"vm"}),angular.module("bandlab.notification").component("notificationActivityTile",{bindings:{activity:"<"},templateUrl:"https://www.bandlab.com/web-app/notification/partials/_notification-activity-tile-4c28324a.html",controller:["$location","$rootScope","Me",function(e,t,n){this.openObject=function(n,o){n.target.closest("a")||(e.url(o.url),"Post"===o.object.type&&o.object.nestedEntityId?t.$broadcast("$comment:highlight",o.object.nestedEntityId):"Reply"===o.object.type&&o.object.subNestedEntityId&&t.$broadcast("$comment:highlight",o.object.subNestedEntityId))},this.me=n}],controllerAs:"vm"}),angular.module("bandlab.notification").component("notificationInviteTile",{bindings:{invite:"<"},templateUrl:"https://www.bandlab.com/web-app/notification/partials/_notification-invite-tile-cfe1be3c.html",controller:"InviteCtrl",controllerAs:"vm"}),angular.module("bandlab.notification").factory("Notification",["$http","$resource","$state","Me",function(e,t,n,o){var r=`https://www.bandlab.com/api/v1.3/users/${o.id}/notifications`;return t(r,{},{me:{method:"GET",cache:!1,params:{limit:10},preservePagination:!0,url:r,transformResponse:[...e.defaults.transformResponse,function(e,t,r){return 200===r&&e.data.forEach((function(e){e.url=function(e){switch(e.object.type){case"Album":return n.href("albumId",{id:e.object.id,commentId:e.object.nestedEntityId,replyId:e.object.subNestedEntityId});case"Collection":case"Playlist":return n.href("collectionId",{id:e.object.id});case"Community":return n.href("communityId",{id:e.object.id});case"Band":return n.href("bandId",{id:e.object.id});case"FeaturedAlbum":return n.href("explore.home",{"#":"featured-albums"});case"FeaturedArtist":return n.href("explore.home",{"#":"featured-artists"});case"FeaturedTrack":return n.href("explore.home",{"#":"featured-tracks"});case"Post":return n.href("post",{id:e.object.id,commentId:e.object.nestedEntityId,replyId:null});case"Song":return n.href("songId",{id:e.object.id});case"RecommendedAlbum":return n.href("explore.home",{"#":"recent-albums"});case"Reply":return n.href("post",{id:e.object.id,commentId:e.object.nestedEntityId,replyId:e.object.subNestedEntityId});case"Revision":return n.href("revisionId",{id:e.object.id});case"User":return e.object.id===o.id?n.href("userId",{id:e.from.id}):n.href("userId",{id:e.object.id});default:return n.href("userId",{id:e.from.id})}}(e),e.message=`${e.message.replace(/<from>(.*)<\/from>/,`<a href="${n.href("user.feed",{username:e.from.username})}"><span>$1</span></a>`).replace(/<object>(.*)<\/object>/,`<a href="${e.url}"><span>$1</span></a>`)}`})),e}]},dismiss:{method:"PATCH",params:{type:"@type"},url:`${r}/:type`}})}]),angular.module("bandlab.opportunities",[]),angular.module("bandlab.opportunities.routes",["ui.router"]).config(["$stateProvider",function(e){e.state("opportunitiesTerms",{url:"/opportunities/promoters/terms-and-conditions?success",templateUrl:"https://www.bandlab.com/web-app/opportunities/views/opportunities-terms-and-conditions-743da96f.html",resolve:{script:function(){return xc("//na3.docusign.net/clickapi/sdk/latest/docusign-click.js")}},controller:["$scope","$state","$stateParams",function(e,t,n){e.changeSuccess=!!n.success,e.onSubmit=function(){window.location.href=`https://na3.docusign.net/clickapi/v1/accounts/3778278b-24ac-40c6-9746-eefee6b00aca/clickwraps/f8f8a254-8c17-447e-8d4a-9373bceb02c5/view?client_user_id=${e.user.email} ${new Intl.DateTimeFormat("en-US").format(e.user.date)}&return_url=${t.href(".",{success:!0},{absolute:!0})}`}}]}).state("opportunitiesLandingPage",{url:"/opportunities",template:"<div></div>",controller:["$element","$injector","$scope","$state","authService","Me",function(e,t,n,o,r,i){Promise.all([import("./chunk-cc78ab72.js").then((e=>{let{mountOpportunities:t}=e;return t})),import("./chunk-62514720.js").then((e=>{let{detectAvif:t}=e;return t()}))]).then((function(a){let[s,l]=a;const c=s(e[0].querySelector("div"),{$injector:t,authService:r,hasAvif:l,state:o,Me:i});n.$on("$destroy",(function(){c.unmount()}))}))}]}).state("opportunities",{url:"/opportunities",abstract:!0,templateUrl:"https://www.bandlab.com/web-app/opportunities/views/opportunities-layout-1d3b4870.html",controller:"OpportunitiesCtrl"}).state("opportunities.list",{url:"/list?types&q&genres&sort&distance",params:{search:{dynamic:!0}},templateUrl:"https://www.bandlab.com/web-app/opportunities/views/opportunities-list-8c0deee8.html",controller:"OpportunitiesListCtrl"}).state("opportunitiesSubmission",{url:"/opportunities/campaign/{id:[0-9-_]+}?content_id",resolve:{selectedCampaign:["$state","$stateParams","Opportunities",function(e,t,n){const{id:o}=t;return n.getById({opportunityId:o}).$promise.then(nN).catch((()=>e.go("404")))}]},redirectTo:function(e){if(p()&&!e.params().content_id)return{state:"opportunitiesSubmission",params:{id:e.params().id,content_id:e.params().id}}},onEnter:["Page","selectedCampaign",function(e,t){const n=document.createElement("div");n.innerHTML=t.description||t.instructions;const o=n.querySelector("p")||n,r=t.picture?.startsWith("//")?`https:${t.picture}`:t.picture;e.setMetadata({title:`${t.name} | BandLab Opportunities`,description:o.innerText,image:r,imageHeight:"360",imageWidth:"360"})}],onExit:["Page",function(e){e.clearMetadata()}],templateUrl:"https://www.bandlab.com/web-app/opportunities/views/opportunities-submission-a9982ad3.html",controller:"OpportunitySelectionCtrl"})}]);const SG={distance:"-1",online:!0,open_for_submissions:!0,page:1,per_page:20,sort:[{dir:"desc",field:"recommended"}],status:["Running","Offer"]},_G={exclusive:{label:"BandLab Platform",variants:["exclusive"]},live:{label:"Live",variants:["festival","showcase","gig","venue","tour_slot"]},publication:{label:"Publication",variants:["publication"]},radioplay:{label:"Radio Play",variants:["radio_play","college_radio_play"]},licensing:{label:"Licensing",variants:["licensing"]},conference:{label:"Conference",variants:["conference"]},recordlabel:{label:"Record Label",variants:["record_label"]},professionalservices:{label:"Professional Services",variants:["professional_services"]},other:{label:"Other",variants:["other","award_shows","contest_giveaway","songwriting_competition","tv_performance","video_play","talent_pool"]}},PG={alternative:{label:"Alternative"},ambient:{label:"Ambient"},americana:{label:"Americana"},bluegrass:{label:"Bluegrass"},blues:{label:"Blues"},bollywoodtollywood:{label:"Bollywood/Tollywood"},celtic:{label:"Celtic"},childrens:{label:"Childrens"},christianrock:{label:"Christian Rock"},christiangospel:{label:"Christian/Gospel"},classical:{label:"Classical"},comedy:{label:"Comedy"},country:{label:"Country"},dj:{label:"DJ"},dance:{label:"Dance"},dubstep:{label:"Dubstep"},edm:{label:"EDM"},electronica:{label:"Electronica"},experimental:{label:"Experimental"},folk:{label:"Folk"},funk:{label:"Funk"},grime:{label:"Grime"},hiphop:{label:"Hip Hop"},holiday:{label:"Holiday"},house:{label:"House"},indie:{label:"Indie"},instrumental:{label:"Instrumental"},jam:{label:"Jam"},jazz:{label:"Jazz"},latin:{label:"Latin"},metal:{label:"Metal"},other:{label:"Other"},pop:{label:"Pop"},punk:{label:"Punk"},rnbsoul:{label:"R&B/Soul"},rap:{label:"Rap"},reggae:{label:"Ragea"},rock:{label:"Rock"},rockabilly:{label:"Rockabilly"},singersongwriter:{label:"Singer Songwriter"},ska:{label:"Ska"},spiritual:{label:"Spiritual"},spokenword:{label:"Spoken Word"},world:{label:"World"}};function MG(e,t){return[].concat(e).some((e=>e===t))}angular.module("bandlab.opportunities").factory("ListCache",(function(){return{save:function(e){localStorage.setItem("listParams",JSON.stringify(e))},get:function(){return JSON.parse(localStorage.getItem("listParams"))},invalidate:function(){localStorage.removeItem("listParams")}}})).controller("OpportunitiesCtrl",["$scope","$state","$stateParams","Me",function(e,t,n,o){e.loading=!1,e.search="",e.searchIsActive=!1,e.typeIsActive=!0,e.genreIsActive=!!n.genres,e.isAnonymous=o.isAnonymous(),e.isTypesChecked=!1,e.isGenresChecked=!1,e.hasWebviewCookie=p,o.isAnonymous()||Gg(o.id,{fallbackToFree:!0}).then((t=>{e.isTrial=t?.isTrial})),Promise.resolve().then((()=>Ap)).then((function(t){let{getAmplitudeFeatureFlag:n}=t;n(o,"opportunities_user_education").then((t=>{e.isEducationFlagEnabled="true"===t}))})),e.search=n.q,e.opTypes=Object.keys(_G).map((e=>({label:_G[e].label,checked:MG(n.types,e)}))),e.opGenres=Object.keys(PG).map((e=>({label:PG[e].label,checked:MG(n.genres,e)}))),e.resetFilter=function(t){switch(t){case"types":i(e.opTypes);break;case"genres":i(e.opGenres);break;default:i(e.opTypes),i(e.opGenres),e.search=""}},e.setLoadingState=function(t){e.loading=t,t||(e.searchIsActive=t)};const r=ay((function(){s()}),500);function i(e){e.forEach((e=>{e.checked=!1}))}function a(e,t){return t.filter((e=>e.checked)).map((t=>Object.keys(e).filter((n=>e[n].label===t.label))[0]))}function s(){const n=a(_G,e.opTypes),o=a(PG,e.opGenres);return t.go("opportunities.list",{types:n.length?n:null,genres:o.length?o:null,q:e.search?e.search:null})}e.$watch("search",(function(t,n){t!==n&&(e.searchIsActive=!0,r())}),!0),e.$watch("opTypes",(function(){e.isTypesChecked=e.opTypes.filter((e=>e.checked)).length,s()}),!0),e.$watch("opGenres",(function(){e.isGenresChecked=e.opGenres.filter((e=>e.checked)).length,s()}),!0)}]).controller("OpportunitiesListCtrl",["$scope","$stateParams","$timeout","$transition$","$window","ListCache","Me","Opportunities","User",function(e,t,n,o,r,i,a,s,l){e.hasWebviewCookie=p,e.submittedList=[];const c={...t};function u(t){const n=e.submittedList.findIndex((e=>e.opportunityId===t.id));return-1!==n?{...t,submitted:!0,submittedAt:new Date(e.submittedList[n].submittedOn).toLocaleDateString("en",{month:"long",day:"numeric"})}:t}if("submission_ends_at"===t.sort?c.sort=[{dir:"asc",field:t.sort},...SG.sort]:"geo"===t.sort||"event_start_on"===t.sort?c.sort=[{dir:"asc",field:t.sort}]:t.sort&&(c.sort=[{dir:"desc",field:`${c.sort}`}]),c.types=t.types&&[].concat(t.types).flatMap((function(e){const t=Object.keys(_G).filter((t=>t===e))[0];return t?_G[t].variants:""})),Object.keys(c).map((e=>!c[e]&&delete c[e])),e.parseOpportunityTypeLabel=rN,e.cacheParams=function(){i.save({list:e.opportunities,queryParams:c,hash:r.pageYOffset})},"opportunitiesSubmission"!==o.from().name&&i.invalidate(),i.get()){const t=i.get();if(t.queryParams.page&&(c.page=t.queryParams.page),gf(c,t.queryParams))return e.opportunities=t.list,n((function(){r.scrollTo({top:t.hash,behavior:"instant"})})),void i.invalidate();delete c.page,i.invalidate()}e.setLoadingState(!0),Promise.allSettled([a.isAnonymous()?[]:l.getSubmissionsList({userId:a.id}).$promise,s.getList({search:t.q,types:t.types&&[].concat(t.types).join(";"),genres:t.genres&&[].concat(t.genres).join(";"),sort:{submission_ends_at:"endingsoon",geo:"geo",event_start_on:"eventdate",offered_at:"recentlyadded"}[t.sort]}).$promise.then((e=>e)).catch((()=>[]))]).then((t=>{let[n,o=[]]=t;e.$applyAsync(),e.setLoadingState(!1),e.submittedList=n.value&&[...n.value]||[],e.opportunities=o.value.map(u)}))}]).controller("OpportunitySelectionCtrl",["$http","$injector","$scope","$stateParams","appActions","AppNotifications","ListCache","Me","Modal","selectedCampaign","User",function(e,t,n,o,r,i,a,s,l,c,u){const{id:d}=o,{startPurchaseFlow:m}=tN(t,n,(function(e){n.activeMembership=e&&"Free"!==e}));n.campaignId=d,n.isMobile=Zf,n.isAnonymous=s.isAnonymous(),n.campaign=c,n.isCollapsable=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{description:t,instructions:n="",aboutPromoter:o}=e;return[t,n.concat(o)].some((e=>e&&e.replace(/<[^>]*>/g,"").split(" ").length>70))}(n.campaign),async function(){var e;n.pageInit=!0,s.isAnonymous()||await Promise.all([Gg(s.id,{fallbackToFree:!0}),u.getOpportunitiesStatus({userId:s.id}),(e=n.campaign,u.checkSubmissionState({userId:s.id,opportunityId:e.id}).$promise.then((t=>{let{isSubmitted:o}=t;n.campaign={...e,submitted:o}})).catch((()=>{n.campaign=e})))]).then((e=>{let[t,o]=e;n.membershipStatus=t,n.opportunitiesStatus=o})),n.activeMembership=n.membershipStatus&&"Free"!==n.membershipStatus.tier,n.isMembershipServiceDown=!n.membershipStatus&&!s.isAnonymous(),n.isTrial=n.membershipStatus?.isTrial,n.trialSubmissionRemaining=n.membershipStatus?.isTrial?n.opportunitiesStatus.featureAccess?.remainingSubmissions:null,n.shouldLoadTrialSubmissionsAlert=!s.isAnonymous()&&n.isTrial,n.pageInit=!1,n.$applyAsync()}(),Promise.resolve().then((()=>Ap)).then((function(e){let{getAmplitudeFeatureFlag:t}=e;t(s,"opportunities_user_education").then((e=>{n.isEducationFlagEnabled="true"===e}))})),n.parseOpportunityTypeLabel=rN,n.onTrialSubmissionsAlertMounted=function(){n.isTrialSubmissionsAlertMounted=!0},n.expandAccordion=function(e){e.preventDefault(),n.isExpanded=!0},n.subscribe=function(){n.isMembershipServiceDown?i.addNotification({title:"Membership service is down. Please try again later",classList:"warning",autoclose:5e3}):p()?m("opportunities","artist_services",o.content_id):r.checkAllowed("submitToOpportunity",{toState:"opportunitiesSubmission",toParams:o},{title:"Sign up to subscribe"})&&n.openPaywallModal()},n.submitTriggered=function(t){t.preventDefault(),n.submitSubmission=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";n.sendingSubmission=!0,u.submitOpportunity({id:s.id,opportunityId:d,topStreamedSongLink:e,topViewedMusicVideoLink:t}).$promise.then((()=>{a.invalidate(),n.campaign.submitted=!0,n.openSubmissionModal(),Promise.all([Promise.resolve().then((()=>Ap)),Promise.resolve().then((()=>lv)),Promise.resolve().then((()=>fv))]).then((e=>{let[{logEvent:t},{logCustomEvent:o},{logEvent:r}]=e;t("opportunities_submit_success",{opportunity_id:d,opportunity_name:n.campaign.name}),o("opportunities_submit_success",{opportunity_id:d,opportunity_name:n.campaign.name}),r("opportunities_submit_success",{opportunity_id:d,opportunity_name:n.campaign.name})}))})).catch((e=>{!function(e,t){if(t?.data?.errorCode===JD||t?.data?.errorCode===XD){const e=zn((()=>import("./chunk-14e15eec.js")));Promise.resolve().then((()=>Tg)).then((function(n){let{createModal:o}=n;o(e,{emailUnconfirmed:t.data.errorCode===XD})}))}else e.addNotification({title:"Something went wrong, please try again later",classList:"alert",autoclose:8e3})}(i,e)})).finally((()=>{n.sendingSubmission=!1}))},n.retrievingUserInfo=!1,Promise.resolve().then((()=>Ap)).then((function(e){let{getAmplitudeFeatureFlag:t}=e;return n.retrievingUserInfo=!0,t(s,"opp_submission_requirements")})).then((function(t){return"true"===t||"on"===t?e.get(`https://www.bandlab.com/api/v1.3/users/${s.id}`).then((e=>{let{data:t}=e;return t})).catch((()=>{})).then((e=>{if(n.retrievingUserInfo=!1,e.isPrivate)return void i.addNotification({title:"Your account is private",classList:"alert",autoclose:5e3});const t=[{title:"Profile picture",isFilled:!(o=e).picture.isDefault||!1},{title:"About",isFilled:o.about?.length>0},{title:"Links",isFilled:o.links&&Object.keys(o.links).length>0},{title:"Inspired by",isFilled:o.inspiredBy&&o.inspiredBy.length>0},{title:"Talents",isFilled:o.skills&&o.skills.length>0},{title:"Favorite genres",isFilled:o.genres&&o.genres.length>0}];var o;!function(e){return e.every((e=>!0===e.isFilled))}(t)?Promise.all([import("./chunk-eab46554.js"),Promise.resolve().then((()=>Tg))]).then((async function(n){let[{default:o},{createModal:r}]=n;r(o,{user:e,requirements:t})})):(n.retrievingUserInfo=!1,n.openSupportingLinksModal())})):(n.retrievingUserInfo=!1,n.openSupportingLinksModal()),"true"===t}))},n.openSupportingLinksModal=function(){Promise.all([import("./chunk-9e681f7e.js"),Promise.resolve().then((()=>Tg))]).then((async function(e){let[{default:t},{createModal:o}]=e;o(t,{submitOpportunity:(e,t)=>{n.submitSubmission(e,t)}})}))},n.openSubmissionModal=function(){Promise.all([import("./chunk-0f962b46.js"),Promise.resolve().then((()=>Tg))]).then((async function(e){let[{default:t},{createModal:o}]=e;o(t,{campaign:n.campaign||{}})}))},n.openPaywallModal=function(){new l({id:"paywallModal",templateUrl:"https://www.bandlab.com/web-app/membership/partials/_paywall-modal-ee6789e7.html",contentScope:{contentId:d,productAttribution:"opportunities",productAttributionGroup:"artist_services"}}).show()}}]).directive("opportunitiesTrialSubmissionsAlertWrapper",["$injector","Me","User",function(e,t,n){return{scope:{onMounted:"="},link:function(o,r){n.getOpportunitiesStatus({userId:t.id}).$promise.then((t=>{const n=Mt({noOfSubmissionsRemaining:t.featureAccess.remainingSubmissions,maxTrialSubmissions:t.featureAccess.maxTrialSubmissions}),i=Promise.all([import("./chunk-cc78ab72.js")]).then((function(t){let[{mountOpportunitiesTrialSubmissionsAlert:i}]=t;return o.$applyAsync(),i(r[0],{scope:o,$injector:e},n)})).then((function(e){return angular.isFunction(o.onMounted)&&o.onMounted(),e}));o.$on("$destroy",(async function(){(await i).unmount()}))})).catch((()=>{}))}}}]).directive("opportunitiesEducateAlertWrapper",["$injector",function(e){return{scope:{isSubmissionPage:"="},link:function(t,n){const o=Mt({isSubmissionPage:t.isSubmissionPage}),r=Promise.all([import("./chunk-cc78ab72.js")]).then((function(r){let[{mountOpportunitiesEducateAlert:i}]=r;return t.$applyAsync(),i(n[0],{scope:t,$injector:e},o)}));t.$on("$destroy",(async function(){(await r).unmount()}))}}}]),angular.module("bandlab.opportunities").controller("SubmissionPageThemeCtrl",(function(){const e=document.querySelector(".submission-page"),t=function(){const e=localStorage.getItem("colors");if(e)try{const{color:t,palette:n}=JSON.parse(e);return[t,n]}catch{return}}();if(!t)return e.style.setProperty("--submission-bg","var(--color-bg-level-1)"),e.style.setProperty("--submission-text-main","unset"),e.style.setProperty("--submission-text-accent","unset"),e.style.setProperty("--submission-text-secondary","unset"),e.style.setProperty("--submission-bg-secondary","var(--color-bg-level-2)"),e.style.setProperty("--submission-button-color","#282c32"),e.style.setProperty("--submission-button-hover","#010101"),e.style.setProperty("--submission-button-text-color","#fff"),e.style.setProperty("--submission-divider-color","var(--color-bg-level-3)"),e.style.setProperty("--checkmark-bg","var(--color-bg-level-3)"),void e.style.setProperty("--recommendation-hover","var(--color-bg-level-3)");var n,o;!function(t){let{colors:n}=t;const{body:o}=n,r=fy(_y(a=o))<=50?my({hex:a,ratio:.8}):my({hex:a,ratio:-.4}),i=function(e){const[t,n,o]=e;return[Math.ceil(25.5)+Math.ceil(.9*t),Math.ceil(25.5)+Math.ceil(.9*n),Math.ceil(25.5)+Math.ceil(.9*o)]}(r);var a;function s(e,t){return`rgb(${(Py({hex:e})?py({hex:e,ratio:-1*t}):py({hex:e,ratio:t})).join(",")})`}e.style.setProperty("--submission-bg",`rgba(${r.join(",")},1)`),e.style.setProperty("--submission-bg-secondary",Ty(i)),e.style.setProperty("--checkmark-bg",s(Ty(r),.15)),e.style.setProperty("--submission-divider-color","var(--submission-bg)"),e.style.setProperty("--recommendation-hover",s(Ty(i),-.02))}((n=t[0],{colors:(o=function(e){return[py({rgb:e,ratio:.03*(fy(e)>127.5?-1:1)})]}(n),{body:o.map((e=>Ty(e)))[0]})}))})),angular.module("bandlab.opportunities").component("opportunitiesCarousel",{restrict:"E",controller:["$scope","$element",function(e,t){this.$onInit=function(){const n=import("./chunk-3a3d6a57.js").then((function(e){let{mountOpportunitiesCarousel:n}=e;return n(t[0])}));e.$on("$destroy",(async function(){(await n).unmount()}))}}]}),angular.module("bandlab.opportunities").directive("opportunitiesFilters",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/opportunities/partials/_opportunities-filters-9a305909.html",controller:["$scope",function(e){e.vm={}}]}})),angular.module("bandlab.opportunities").component("suggestedOpportunities",{bindings:{id:"="},restrict:"E",controller:["$scope","$element","$injector",function(e,t,n){const o=this;o.$onInit=function(){const r=import("./chunk-00dea8f0.js").then((function(e){let{mountSuggestedOpportunities:r}=e;return r(t[0],{$injector:n},{id:o.id})}));e.$on("$destroy",(async function(){(await r).unmount()}))}}]}),angular.module("bandlab.opportunities").filter("dateRange",(function(){return function(e){let t=Date.parse(e.eventStartsOn),n=Date.parse(e.eventEndsOn||e.eventStartsOn);if(t&&n){t=new Date(t),n=new Date(n),t=new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds()),n=new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds());const e=["January","February","March","April","May","June","July","August","September","October","November","December"],o=t.getDate()===n.getDate(),r=t.getMonth()===n.getMonth(),i=t.getFullYear()===n.getFullYear(),a=e[t.getMonth()].concat(" ").concat(t.getDate()).concat(i?"":", ".concat(t.getFullYear())),s=(r&&i?"":e[n.getMonth()]).concat(o&&r&&i?"":" ".concat(n.getDate())).concat(", ").concat(n.getFullYear());return o&&r&&i?a.concat(", ").concat(t.getFullYear()):a.trim().concat("  ").concat(s.trim())}return""}})),angular.module("bandlab.opportunities").filter("daysLeftToSubmit",(function(){return oN})),angular.module("bandlab.opportunities").filter("setLocationString",(function(){return function(e){if(angular.isString(e))return e||"Online";if(e?.city){let t=e.city;return e?.state&&(t=`${t}, ${e.state}`),e?.country&&(t=`${t}, ${e.country}`),t}return"Online"}})),angular.module("bandlab.opportunities").factory("Opportunities",["$resource",function(e){var t="https://www.bandlab.com/api/v1.3/opportunities";return e(t,{},{getList:{method:"GET",params:{search:"@search",genres:"@genres",types:"@types",sort:"@sort"},isArray:!0,url:t},getById:{method:"GET",params:{opportunityId:"@opportunityId"},url:`${t}/:opportunityId`}})}]),angular.module("bandlab.payment",[]),angular.module("bandlab.payment").controller("CheckoutCtrl",["$element","$injector","$scope","$state","$stateParams",function(e,t,n,o,r){const i=["checkout.summary","checkout.payment","checkout.complete"];function a(){return r.sourceUrl?u(r.sourceUrl):s()}function s(){u(r.redirectCancelUrl)}function l(e){o.go(i[e])}function c(){u(r.redirectUrl)}function u(e){if(p()&&!e?.includes("dashboard.promote"))o.go(".",{"#":"bl_closeWebView"});else if(e){const t=JSON.parse(decodeURIComponent(e));o.go(t.name,t.params,{location:"replace"})}else o.go("settings.membership")}import("./chunk-aa2ef87a.js").then((function(u){let{mountCheckout:d}=u;const p=d(e[0],{$injector:t},{frequency:{monthly:"Month",yearly:"Year",daily:"Day"}[r.frequency],initStep:i.indexOf(o.current.name),onBack:a,onCancel:s,onChangeStep:l,onSuccess:c,contentId:r.contentId,product:"booster"===r.product?"boost":r.product,productAttribution:r.productAttribution,productAttributionGroup:r.productAttributionGroup,promoCode:r.promoCode,source:r.source,triggeredFrom:r.triggeredFrom,productId:r.productId,paymentIntentId:r.paymentIntentId,forcePaddle:r.forcePaddle});n.$on("$destroy",(function(){p.unmount()}))}))}]),angular.module("bandlab.payment").controller("TipJarPaymentCtrl",["$analytics","$cookies","$scope","$state","$timeout","appActions","AppNotifications","Chat","ConfirmModal","Me","Share","Stripe","theUser",function(e,t,n,o,r,i,a,s,l,c,u,d,m){function f(){return o.href("userTip",{username:n.user.username},{absolute:!0})}n.isOwnProfile=m.id===c.id,n.isWebview=p(),n.user=m,n.me=c,n.$on("$user:relationChanged",(function(e,t){n.user.id===t.user.id&&Object.assign(n.user,t.user)})),n.goBack=function(){return"true"===t.get("webview")?window.history.back():o.go("user.feed",{username:n.user.username})},n.shareWithFacebook=function(){u.withFacebook(f())},n.shareWithTwitter=function(){u.withTwitter(f(),encodeURIComponent("bandlab"))},n.shareWithWebShare=function(){return navigator.share({url:f()})},n.sendMessage=function(){return s.getOneConversation(n.user.conversationId).then((function(e){return Promise.all([e,s.sendMessage({conversation:e,content:"Hey! I wanted to send you a tip, but your Tip Jar wasnt configured. You can configure your tip jar here: https://www.bandlab.com/settings/tip-jar to receive tips in the future."})])})).then((function(e){let[n]=e;return"true"===t.get("webview")?window.history.back():r((()=>o.go("chat.conversation",{id:n.id})),1e3)})).catch((function(){a.addNotification({title:"This feature is locked",content:"Confirm your email to access all features.",image:"https://www.bandlab.com/web-app/images/settings/warning-54e511afc4.svg",action:`\n              <a class="button-scd button-height-32 button-padding-16 button-rounded" href="${o.href("settings.account")}"><i class="icon-arrow-right"></i></a>\n            `,classList:"light"})}))},n.supportWebShare=(Zf||Qf)&&navigator.share&&navigator.canShare,n.tipShareUrl=o.href("userTip",{id:n.user.username},{absolute:!0});const h=n;function g(){const t=100*h.tipValue;return Ag(c.id,h.user.id,t,h.user.id,"tip").then((function(t){return d.confirmCardPayment(t).then((function(){h.thankYouMessage=!0,e.eventTrack("Tip Sent",{category:"Send Tip",label:"User"}),Promise.resolve().then((()=>Ap)).then((function(e){let{logEvent:t}=e;t("tipjar_transaction_complete",{result:"success"})}))}))})).catch((e=>{Sentry.onLoad((function(){Sentry.captureException(e.name,{extra:{err:e,message:e.message,name:e.name,stack:e.stack}})})),Promise.resolve().then((()=>Ap)).then((function(t){let{logEvent:n}=t;"payment_intent_authentication_failure"===e.error?.code?n("tipjar_transaction_cancel",{cancel_step:"3d_secure"}):n("tipjar_transaction_complete",{result:"fail"})})),a.addNotification({title:"Unable to proceed with payment",content:e.message,classList:"alert",autoclose:8e3})}))}h.submitSendTip=function(){if(!i.checkAllowed("tip"))return void h.tipForm.$setPristine();Promise.resolve().then((()=>Ap)).then((function(e){let{logEvent:t}=e;t("tipjar_transaction_start")}));const e=`Tip to ${h.user.name}`;return("browser"===h.paymentMethod?d.requirePayment(100*h.tipValue,e):d.requireCard()).then((function(){return parseFloat(h.tipValue)>100?new l({confirmLabel:"Confirm",contentScope:{title:"Before We Proceed",message:`<p>Please confirm your tip amount of <strong>USD${h.tipValue}</strong>.</p>`},onConfirm:()=>{h.tipForm.$setSubmitted(),g()},onCancel:()=>h.tipForm.$setPristine()}).show():g()})).catch((()=>!1)).finally((function(){h.tipForm.$setPristine(),n.$applyAsync()}))},h.tipValue=isNaN(o.params.amount)?5:parseFloat(o.params.amount)}]),angular.module("bandlab.payment").component("adMaterials",{bindings:{placement:"="},templateUrl:"https://www.bandlab.com/web-app/payment/partials/_ad-materials-40a5c362.html",controller:["$element","$scope",function(e,t){const n=this;n.$onInit=function(){TD(n.placement).then((function(o){let{ads:r}=o;0===r.length&&e.remove(),n.ads=r,t.$applyAsync()}))}}],controllerAs:"vm"}),angular.module("bandlab.payment").directive("boostPostButton",["$injector",function(e){return{restrict:"E",replace:!0,scope:{buttonClass:"@",post:"=",triggeredFrom:"<"},link:function(t,n){import("./chunk-e83932c2.js").then((function(o){let{mountBoostPostButton:r}=o;const i=r(n[0],{$injector:e},{buttonClass:t.buttonClass,post:t.post,triggeredFrom:t.triggeredFrom});t.$on("$destroy",(function(){i.unmount()}))}))}}}]),angular.module("bandlab.payment").directive("giftBoostPostButton",["$injector",function(e){return{restrict:"E",replace:!0,scope:{post:"=",triggeredFrom:"<"},link:function(t,n){const o=import("./chunk-0cb43f07.js").then((function(o){let{mountGiftBoostPostButton:r}=o;return r(n[0],{$injector:e},{post:t.post,triggeredFrom:t.triggeredFrom})}));t.$on("$destroy",(async function(){(await o).unmount()}))}}}]),angular.module("bandlab.payment").directive("googleAdMaterial",["$injector",function(e){return{restrict:"E",replace:!0,scope:{height:"=",width:"="},link:function(t,n){n.addClass("google-ad-material-container");const o=import("./chunk-fbcc6962.js").then((function(o){let{mountGoogleAdMaterial:r}=o;return r(n[0],{$injector:e},{height:t.height,width:t.width})}));t.$on("$destroy",(async function(){(await o).unmount()}))}}}]),angular.module("bandlab.payment").component("stripeCard",{bindings:{analyticsProduct:"=",card:"=",hideOptions:"<"},templateUrl:"https://www.bandlab.com/web-app/payment/partials/_stripe-card-e1c94f5b.html",controller:["AppNotifications","ConfirmModal","Me","Stripe","$scope",function(e,t,n,o,r){const i=this;i.me=n,i.isRequestActive=!1,i.displayAddCardModal=function(t){i.isRequestActive=!0,Promise.resolve().then((()=>Ap)).then((function(e){let{logEvent:t}=e;t("payments_add_card_open",{product:i.analyticsProduct})})),o.displayCardModal(t,null!==i.card.last4).then((function(e){i.card=e,Promise.resolve().then((()=>Ap)).then((function(e){let{logEvent:t}=e;t("payments_add_card_save",{product:i.analyticsProduct})}))})).catch((function(t){t?(i.card.last4=null,e.addNotification({autoclose:8e3,title:"Unable to add card",content:t?.message,classList:"alert"})):Promise.resolve().then((()=>Ap)).then((function(e){let{logEvent:t}=e;t("payments_add_card_cancel",{product:i.analyticsProduct})}))})).finally((function(){i.isRequestActive=!1,r.$applyAsync()}))},i.removeCard=function(){return i.isRequestActive=!0,new t({confirmLabel:"Remove",contentScope:{title:"Remove card",message:"Are you sure you want to remove this card?"},onConfirm:function(){return Promise.resolve().then((()=>tv)).then((function(e){let{deletePayer:t}=e;return t(n.id)})).then((function(){i.card.last4=null})).finally((function(){i.isRequestActive=!1,r.$applyAsync()}))}}).show()}}],controllerAs:"vm"}),angular.module("bandlab.payment").component("stripeCardForm",{bindings:{isLoading:"=?",onSuccess:"&",onCancel:"&",submitLabel:"="},templateUrl:"https://www.bandlab.com/web-app/payment/partials/_stripe-card-form-0a326ea8.html",controller:["$scope","$timeout","Stripe",function(e,t,n){const o=this;function r(){const t=["number","expiry","cvc"].map((e=>`${o.elementId}-card-${e}`));n.appendNewFormTo(...t,(function(t){switch(t.elementType){case"cardCvc":o.cvcError=t.error?.message,o.formValidity.cvc=t.complete;break;case"cardExpiry":o.expiryError=t.error?.message,o.formValidity.expiry=t.complete;break;case"cardNumber":o.numberError=t.error?.message,o.formValidity.number=t.complete}e.$applyAsync()})).then((function(e){let{reset:t,submit:n}=e;o.submitForm=function(){return o.isLoading=!0,n({name:o.cardholderName}).then((function(e){o.onSuccess({token:e})})).catch((function(e){o.onCancel({err:e})}))},o.$onDestroy=function(){t()}}))}o.$onInit=function(){var e;e=r,setTimeout((function(){setTimeout((function(){setTimeout((function(){t(e)}),0)}),0)}),0)},o.formValidity={cvc:!1,expiry:!1,number:!1},o.isCardReady=function(){return Object.values(o.formValidity).every((e=>e))},o.elementId=Array.from({length:10}).map((()=>"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(51*Math.random())))).join("")}],controllerAs:"vm"}),angular.module("bandlab.payment").directive("tipIcon",["appActions","Modal",function(e,t){return{restrict:"E",replace:!0,scope:{user:"="},link:function(n,o){import("./chunk-fcc804db.js").then((function(r){let{mountTipIcon:i}=r;const a=i(o[0],{appActions:e,Modal:t,user:n.user});n.$on("$destroy",(function(){a.unmount()}))}))}}}]),angular.module("bandlab.payment").directive("paymentMethods",["Stripe",function(e){return{replace:!0,restrict:"E",require:"?ngModel",template:'\n        <div class="payment-form-buttons">\n          <div class="loader-spinner" ng-if="!walletHasCard"></div>\n          <button\n             type="submit"\n             ng-if="walletHasCard && browserPaymentMethod"\n             ng-click="setMethod(\'browser\')"\n             ng-disabled="disabled"\n             class="button-dark button-height-40 button-padding-fill button-rounded">\n             <img ng-src="{{ browserPaymentIcon }}">\n          </button>\n          <button\n             type="submit"\n             ng-if="walletHasCard"\n             ng-click="setMethod(\'card\')"\n             ng-disabled="disabled"\n             class="button-prm button-height-40 button-padding-fill button-rounded">\n            <span ng-if="!loading">Credit or debit card</span>\n            <span ng-if="loading" class="loader-spinner" style="margin: 0"></span>\n          </button>\n        </div>\n      ',scope:{disabled:"=",loading:"=",userId:"="},link:function(t,n,o,r){Promise.resolve().then((()=>tv)).then((e=>{let{getWallets:n}=e;return n(t.userId)})).then((e=>{t.walletHasCard=e.some((e=>["Stripe","Tipalti"].includes(e.gateway))),t.$applyAsync()})),e.canMakePayment().then((function(e){t.browserPaymentMethod=e,t.browserPaymentIcon="google"===e?"https://www.bandlab.com/web-app/images/icon-google-pay-59a158ef89.svg":"https://www.bandlab.com/web-app/images/icon-apple-pay-469ea95433.svg"})),t.setMethod=function(e){r.$setViewValue(e)}}}}]),angular.module("bandlab.payment").component("tipUserForm",{bindings:{successCallback:"=",user:"=",albumId:"=",tipValue:"<"},templateUrl:"https://www.bandlab.com/web-app/payment/partials/_tip-user-form-02ee0609.html",controller:["$analytics","$rootScope","$scope","$state","Album","appActions","AppNotifications","ConfirmModal","Me","Stripe",function(e,t,n,o,r,i,a,s,l,c){const u=this;function d(){const n=100*u.tipValue,i=u.albumId||u.user.id,s=u.albumId?"album":"tip";return Ag(l.id,u.user.id,n,i,s).then((function(n){return c.confirmCardPayment(n).then((function(){u.albumId&&(e.eventTrack("Album Payment",{category:"Album",label:"Tip"}),r.purchaseWithRetry({albumId:u.albumId,userId:l.id,tipId:n.id}).then((function(){t.$broadcast("Album:supportSuccess")}))),u.thankYouMessage=!0,u.successCallback&&u.successCallback(u.tipValue),e.eventTrack("Tip Sent",{category:"Send Tip",label:o.current.name.includes("show")?"Show":o.current.name.includes("album")?"Album":"User"}),Promise.resolve().then((()=>Ap)).then((function(e){let{logEvent:t}=e;t("tipjar_transaction_complete",{result:"success"})}))}))})).catch((e=>{Sentry.onLoad((function(){Sentry.captureException(e.name,{extra:{err:e,message:e.message,name:e.name,stack:e.stack}})})),Promise.resolve().then((()=>Ap)).then((function(t){let{logEvent:n}=t;"payment_intent_authentication_failure"===e.error?.code?n("tipjar_transaction_cancel",{cancel_step:"3d_secure"}):n("tipjar_transaction_complete",{result:"fail"})})),a.addNotification({title:"Unable to proceed with payment",content:e.message,classList:"alert",autoclose:8e3})}))}u.$onInit=function(){u.tipJarLink=o.href("userTip",{username:u.user.username},{absolute:!0}),u.tipValue=u.tipValue||3},u.copyLink=function(){a.addNotification({title:"Copied to clipboard",classList:"success",autoclose:1e3})},u.submitSendTip=function(){i.checkAllowed("tip")&&(e.eventTrack("Send Tip",{category:"Send Tip",label:o.current.name.includes("show")?"Show":o.current.name.includes("album")?"Album":"User"}),Promise.resolve().then((()=>Ap)).then((function(e){let{logEvent:t}=e;t("tipjar_transaction_start")})),("browser"===u.paymentMethod?c.requirePayment(100*u.tipValue,`Tip to ${u.user.name}`):c.requireCard()).then((function(){return parseFloat(u.tipValue)>100?new s({confirmLabel:"Confirm",contentScope:{title:"Before We Proceed",message:`<p>Please confirm your tip amount of <strong>USD${u.tipValue}</strong>.</p>`},onConfirm:()=>d(),onCancel:()=>u.tipForm.$setPristine()}).show():d()})).catch((()=>!1)).finally((function(){u.tipForm.$setPristine(),n.$applyAsync()})))}}],controllerAs:"vm"}).directive("tipUserPrompt",["$state","Modal","User",function(e,t,n){return{restrict:"E",replace:!0,templateUrl:"https://www.bandlab.com/web-app/payment/partials/_tip-user-prompt-9e93ce3e.html",link:function(o,r){const i=new Date;let a=!1;function s(){setTimeout((()=>{a?s():c()}),1e4)}function c(){o.isVisible=!1,o.$applyAsync()}setTimeout((async()=>{if("showTipPrompt"===e.params["#"]&&e.params.username){const t=await n.get({id:e.params.username}).$promise;t.isTippable&&o.$broadcast("tipUserPrompt:show",{variant:"variant-1",user:t})}}),1e3),o.displaySendTip=function(){return c(),l.set("showLessTipPrompt",!0,{expires:i}),Promise.resolve().then((()=>Ap)).then((function(e){let{logEvent:t}=e;t("tipjar_send_tip_start")})),new t({id:"tipSetModal",template:'<tip-user-form user="user"></tip-user-form>',contentScope:{user:o.user}}).show()},o.hide=c,o.showLess=function(){c(),l.set("showLessTipPrompt",!0,{expires:i})},o.$on("tipUserPrompt:show",(function(e,t){let{variant:n,user:l}=t;o.isVisible=!0,o.user=l,i.setDate((new Date).getDate()+("variant-3"===n?30:7)),s(),r.on("mouseenter",(function(){a=!0})),r.on("mouseleave",(function(){a=!1}))})),o.$on("tipUserPrompt:hide",(function(){c(),o.user=null}))}}}]),angular.module("bandlab.payment").directive("tipaltiAccount",["$injector",function(e){return{restrict:"E",replace:!0,scope:{account:"="},link:function(t,n){import("./chunk-701d49d2.js").then((function(o){let{mountTipaltiAccount:r}=o;const i=r(n[0],{$injector:e},{account:t.account});t.$on("$destroy",(function(){i.unmount()}))}))}}}]);const TG={components:{Button:Dd,IconClose:Bd,LoaderWave:zn((()=>import("./chunk-6fc0e733.js")))},props:{redirectUrl:{type:String,default:null},redirectName:{type:String,default:"settings.payments"},redirectParams:{type:Object,default:null}},emits:["closeModal"],setup(e){const t=Zo("$injector"),n=t.get("Me"),o=t.get("$state"),r=Vt(null),i=Vt(null),a=Vt(!1),s=Vt(null);return function(){const t=o.href("updateTipaltiAccount",{redirect:encodeURIComponent(JSON.stringify({name:e.redirectName,params:e.redirectParams}))},{absolute:!0});Promise.resolve().then((()=>tv)).then((function(e){let{getTipaltiFrameUrl:o}=e;return o(n.id,encodeURIComponent(t))})).then((function(e){let{url:t}=e;s.value=t}))}(),Lr(i,(()=>{i.value&&(i.value.onload=l)})),{container:r,iframe:i,isReady:a,tipaltiUrl:s};function l(){a.value=!0}}},CG={class:"modal-tipalti"},EG={class:"tipalti-top-bar top-bar"},IG=bi("img",{src:"https://www.bandlab.com/web-app/images/bandlab-logotype-466ab31274.svg",height:"28",width:"123",alt:"BandLab"},null,-1),RG={ref:"container",class:"tipalti-container"},AG=["src"],xG=ld(TG,[["render",function(e,t,n,o,r,i){const a=vo("IconClose"),s=vo("Button"),l=vo("LoaderWave");return si(),pi("aside",CG,[bi("div",EG,[IG,yi(s,{type:"button",color:"secondary",size:"small",padding:"default",onClick:t[0]||(t[0]=t=>e.$emit("closeModal"))},{"trailing-icon":Tn((e=>[yi(a,{size:18,class:ae([e.class,"ds-glyphs-secondary"])},null,8,["class"])])),default:Tn((()=>[ki(me("Exit")+" ",1)])),_:1})]),bi("div",RG,[Cn(yi(l,null,null,512),[[wa,!o.isReady]]),Cn(bi("iframe",{ref:"iframe",src:o.tipaltiUrl,title:"Tipalti Setup"},null,8,AG),[[wa,o.isReady]])],512)])}]]);angular.module("bandlab.payment.routes",["ui.router"]).config(["$stateProvider",function(e){e.state("userTipRedirect",{url:"/{username:[a-z0-9][a-z0-9_]{2,19}}/tip",redirectTo:function(e){return{state:"userTip",params:{username:e.params().username}}}}).state("userTip",{url:"/{username:[a-z0-9][a-z0-9_]{2,19}}/tipjar?amount",templateUrl:"https://www.bandlab.com/web-app/payment/views/tip-layout-f957fb41.html",resolve:{theUser:["$stateParams","User",function(e,t){return t.get({id:e.username}).$promise}]},onEnter:["Page","theUser",function(e,t){e.setMetadata({title:`${t.name} | TipJar`,description:`Support ${t.name} on BandLab - 100% of the tip goes directly to artist`,image:`${t.picture.url}360x360`,imageHeight:"360",imageWidth:"360"})}],onExit:["Page",function(e){e.clearMetadata()}],controller:"TipJarPaymentCtrl"}).state("connectTipaltiAccount",{url:"/tipalti/connect?redirect",template:"<div></div>",controller:["Me","$state",function(e,t){if(!p()){if(kg.value)o();else{const e=Lr(kg,(()=>{kg.value&&(e(),o())}))}return}const n=t.href("updateTipaltiAccount",t.params.redirect?{redirect:t.params.redirect}:{"#":"bl_closeWebView"},{absolute:!0});function o(){const{name:e,params:n}=t.params.redirect?JSON.parse(decodeURIComponent(t.params.redirect)):{name:"settings.payments",success:!0};_g(xG,{redirectName:e,redirectParams:n,onCloseModal:()=>t.go(e,n)},{escapeClose:!1})}Promise.resolve().then((()=>tv)).then((function(t){let{getTipaltiFrameUrl:o}=t;return o(e.id,encodeURIComponent(n))})).then((function(e){let{url:t}=e;window.location.replace(t)}))}]}).state("updateTipaltiAccount",{url:"/tipalti/callback?redirect",controller:["$state","AppNotifications","Me",function(e,t,n){return Promise.resolve().then((()=>tv)).then((e=>{let{updateTipaltiPayeeDetails:t}=e;return t(n.id)})).then((function(){t.addNotification({title:"Youre all set!",content:"You will receive the incoming payouts",autoclose:8e3,classList:"success"})})).catch((async function(e){const n=await e.response.json();t.addNotification({title:"Tipalti account not connected",content:n.message,classList:"alert",autoclose:8e3})})).finally((function(){if(e.params.redirect){const t=JSON.parse(decodeURIComponent(e.params.redirect));e.go(t.name,t.params,{location:"replace"})}}))}]}).state("checkout",{url:"/checkout?"+["product","promoCode","redirectUrl","redirectCancelUrl","sourceUrl","forcePaddle","frequency","productAttribution","productAttributionGroup","source","contentId","triggeredFrom","paymentIntentId","productId"].join("&"),params:{step:{value:null,dynamic:!0,squash:!0}},redirectTo:"checkout.summary",controller:"CheckoutCtrl"}).state("checkout.summary",{url:"/summary",template:"<div></div>",hideGlobalPlayer:!0}).state("checkout.payment",{url:"/payment",template:"<div></div>"}).state("checkout.complete",{url:"/complete",template:"<div></div>",redirectTo:function(e){return"membership"!==e.params().product||{state:"membershipOnboarding",params:{redirectUrl:e.params().redirectUrl}}}}).state("checkoutProduct",{url:"/checkout/:productId?id"}).state("getMembership",{url:`/get-membership?${["source","productAttribution","productAttributionGroup","contentId","persistWebview"].join("&")}`,controller:["$state","$stateParams","$transitions","AppNotifications","Me","Modal",function(e,t,n,o,r,i){e.go("user.feed",{username:r.username},{location:"replace"});const a=n.onSuccess({entering:"user.feed"},(function(){a(),Promise.resolve().then((()=>tv)).then((e=>{let{getUserMembership:t}=e;return t(r.id)})).then((function(e){"Free"===e.plan?new i({id:"paywallModal",templateUrl:"https://www.bandlab.com/web-app/membership/partials/_paywall-modal-ee6789e7.html",contentScope:{source:t.source,productAttribution:t.productAttribution,productAttributionGroup:t.productAttributionGroup,contentId:t.contentId}}).show():o.addNotification({title:"You already have BandLab Membership",classList:"warning",autoclose:8e3})}))}))}]}).state("membershipOnboarding",{url:"/membership-onboarding?redirectUrl&settings",useTopBarForm:!0,hideGlobalPlayer:!0,redirectTo:"membershipOnboarding.welcome",views:{"":{controller:["$element","$injector","$scope","$state","$transitions",function(e,t,n,o,r){const i=Mt({stateName:o.current.name,onChangeStep:function(e){o.go(e)},onComplete:function(){if(o.params.redirectUrl){const{name:e,params:t}=JSON.parse(decodeURIComponent(o.params.redirectUrl));return o.go(e,t)}o.go("settings.membership")}}),a=import("./chunk-71c7bd7f.js").then((function(n){let{mountMembershipOnboarding:o}=n;return o(e[0],{$injector:t},i)})),s=r.onSuccess({},(function(e){i.stateName=e.to().name}));n.$on("$destroy",(async function(){(await a).unmount(),s()}))}]},"topBarForm@":{templateUrl:"https://www.bandlab.com/web-app/membership/partials/_membership-onboarding-form-top-bar-545a3bc5.html",controller:["$scope","$state",function(e,t){e.exitPage=function(){t.go("settings.membership")}}]},"tabBarForm@":{templateUrl:"https://www.bandlab.com/web-app/membership/partials/_membership-onboarding-form-tab-bar-f8cb9367.html",controller:["$scope","$state",function(e,t){e.exitPage=function(){t.go("settings.membership")}}]}}}).state("membershipOnboarding.welcome",{url:"/welcome",useTopBarForm:!0,hideGlobalPlayer:!0}).state("membershipOnboarding.aiTools",{url:"/ai-tools",useTopBarForm:!0,hideGlobalPlayer:!0}).state("membershipOnboarding.mastering",{url:"/mastering",useTopBarForm:!0,hideGlobalPlayer:!0}).state("membershipOnboarding.splitter",{url:"/splitter",useTopBarForm:!0,hideGlobalPlayer:!0}).state("membershipOnboarding.distribution",{url:"/distribution",useTopBarForm:!0,hideGlobalPlayer:!0}).state("membershipOnboarding.opportunities",{url:"/opportunities",useTopBarForm:!0,hideGlobalPlayer:!0}).state("membershipOnboarding.trial",{url:"/trial",useTopBarForm:!0,hideGlobalPlayer:!0}).state("membershipOnboarding.explore",{url:"/explore",useTopBarForm:!0,hideGlobalPlayer:!0}).state("membershipOnboarding.boost",{url:"/boost",useTopBarForm:!0,hideGlobalPlayer:!0,redirectTo:"membershipOnboarding.welcome"}).state("membershipOnboarding.boostInsights",{url:"/boost-insights",useTopBarForm:!0,hideGlobalPlayer:!0,redirectTo:"membershipOnboarding.welcome"}).state("membershipOnboarding.fanReach",{url:"/fan-reach",useTopBarForm:!0,hideGlobalPlayer:!0,redirectTo:"membershipOnboarding.welcome"})}]),angular.module("bandlab.payment").factory("Stripe",["$q","$timeout","AppNotifications","Me","Modal",function(e,t,n,o,r){const i=xc("https://js.stripe.com/v3/").then((()=>Stripe("pk_live_51JSz2GBVc8rZLwKP73Zzt8NVXtPC15MhCRqQ7wBbOlIlQzn2XSCBeRuVrjAm3OxuaWltgsr0IJMUkWlU1ZI94zZK00Pq0jDU9E")));let a,s;return{appendNewFormTo:async function(t,n,o,r){const a=(await i).elements({fonts:[{cssSrc:"https://bandlab.github.io/bandlab-fonts/bandlab-sans.css"}]}),s={base:{color:"#282c32",fontFamily:'"BandLab Sans", "Source Sans Pro", "Helvetica Neue", Helvetica, Arial, sans-serif',fontSize:"14px",fontSmoothing:"antialiased","::placeholder":{color:"#7e8999"}},invalid:{color:"#282c32"}},l=a.create("cardNumber",{style:s,showIcon:!0}),c=a.create("cardExpiry",{style:s}),u=a.create("cardCvc",{style:s});return l.mount(`#${t}`),c.mount(`#${n}`),u.mount(`#${o}`),l.on("change",r),c.on("change",r),u.on("change",r),{reset:function(){u.unmount(),c.unmount(),l.unmount()},submit:async function(t){return(await function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i.then((o=>t?o.createToken(t,n):e.reject("Stripe element is missing"))).then((t=>t.error?e.reject(t.error):t.token))}(l,t)).id}}},confirmCardPayment:function(e){let{clientSecret:t,publishableKey:n}=e;return xc("https://js.stripe.com/v3/").then((()=>Stripe(n||"pk_live_51JSz2GBVc8rZLwKP73Zzt8NVXtPC15MhCRqQ7wBbOlIlQzn2XSCBeRuVrjAm3OxuaWltgsr0IJMUkWlU1ZI94zZK00Pq0jDU9E"))).then((e=>e.confirmCardPayment(t,{payment_method:s?.paymentMethod?.id},{handleActions:!1}).then((function(n){return n.error?(s?.complete("fail"),s=null,n):(s?.complete("success"),s=null,"requires_action"===n.paymentIntent.status||"requires_source_action"===n.paymentIntent.status?e.confirmCardPayment(t):n)})))).then((function(e){return e.error?Promise.reject(e):Promise.resolve(e)}))},canMakePayment:l,createPayerFromToken:c,displayCardModal:u,requireCard:function(){return Ng(o.id).then((function(e){return null!==e.stripeCard.last4||u("Add Card",!1,!0)})).catch((function(t){return t?(n.addNotification({title:"Unable to add card",content:t?.message,classList:"alert",autoclose:8e3}),e.reject(t)):e.reject()}))},requirePayment:async function(e,n){return a||await l(),new Promise((function(r,i){a.update({total:{label:n,amount:e}}),a.show(),a.on("token",(async function(e){s=e,a=null;try{const n=await Ng(o.id);null===n.stripeCard.last4?await jg(o.email,e.token.id):n.stripeCard.last4!==e.token.card.last4&&(await Dg(o.id),await t((()=>{}),3e3),await jg(o.email,e.token.id)),r(!0)}catch{s?.complete("fail"),s=null,a=null,i()}})),a.on("cancel",(function(){s=null,a=null,i()}))}))}};function l(){return(a?Promise.resolve(a):i.then((function(e){return e.paymentRequest({country:"US",currency:"usd",total:{label:"BandLab Payment",amount:0}})}))).then((function(e){return a=e,a.canMakePayment()})).then((function(e){return e?e.applePay?"apple":"google":null}))}async function c(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&await Dg(o.id).then((()=>t((()=>{}),3e3))),jg(o.email,e)}function u(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!1;return e((function(e,a){const s=new r({template:'\n            <div>\n              <div class="modal-close" zf-close></div>\n              <header class="modal-header-new">\n                <h2 class="modal-header-title">{{ ::title }}</h2>\n              </header>\n              <div class="modal-content modal-content-small modal-content-new" style="overflow: initial;">\n                <stripe-card-form\n                  on-success="onSuccess(token)"\n                  on-cancel="onCancel(err)"\n                  submit-label="\'Save\'"\n                ></stripe-card-form>\n                <div class="modal-footer">\n                  <a href="https://stripe.com/" target="_blank" rel="noopener">\n                    <img src="https://cdn.brandfolder.io/KGT2DTA4/at/rvgw5pc69nhv9wkh7rw8ckv/Powered_by_Stripe_-_blurple.svg" alt="Powered By Stripe badge" width="119" height="26">\n                  </a>\n                </div>\n              </div>\n            </div>\n          ',contentScope:{title:t,onSuccess:function(t){c(t,n).then(e).catch((function(e){return a(e)})).finally((function(){i=!0,s.destroy()}))},onCancel:function(e){if(s.destroy(),e)return a(e)}},onDestroy:function(){return o&&!i&&Promise.resolve().then((()=>Ap)).then((function(e){let{logEvent:t}=e;t("tipjar_transaction_cancel",{cancel_step:"add_card"})})),a()}});s.show()}))}}]),angular.module("bandlab.playbackhistory",[]),angular.module("bandlab.playbackhistory").controller("PlaybackHistoryCtrl",["$location","$q","$scope","Me","Player","PlayerHistory","Post","User",function(e,t,n,o,r,i,a,s){var l,c=50,u=null,d=!1,p=e.url();function m(){return d?t.resolve([]):l=s.postsPlaybackHistory({after:u,id:o.id,limit:c}).$promise.then((function(e){return d=e.data.length<c,u=_.get(e,"paging.cursors.after",0),e.data}))}function f(){return n.infiniteScrollEnded?t.resolve():l=l.then((function(e){if(n.infiniteScrollEnded=d,e.length)return n.playbackHistory=n.playbackHistory||[],e.forEach((e=>{if(n.playbackHistory.length>0){const t=new Date(e.playedOn),o=new Date(n.playbackHistory[n.playbackHistory.length-1][0].playedOn);t.getFullYear()===o.getFullYear()&&t.getMonth()===o.getMonth()&&t.getDate()===o.getDate()?n.playbackHistory[n.playbackHistory.length-1].push(e):n.playbackHistory.push([e])}else n.playbackHistory.push([e])})),i.pushQueueSongs(e.map((e=>e.post)),p),m()}))}n.me=o,n.infiniteScrollEnded=!1,n.loadMore=f,i.setCurrentPageContext({contentSource:"playback_history",loader:f,url:p}),a.fromRecommendations({userId:o.id,limit:3}).$promise.then((function(e){let{data:t}=e;n.relatedTracks=t})),n.$on("$playbackhistory:remove",(function(e,t){for(const e of n.playbackHistory.slice())Gf(e,(e=>e===t.item)),0===e.length&&Gf(n.playbackHistory,(t=>t===e));r.removeRevisionFromQueue(t.item.post.revisionId,t.item.post.id)})),m().then(n.loadMore)}]),angular.module("bandlab.playbackhistory").controller("PlaybackHistoryRemoveCtrl",["$rootScope","$scope","Me","User",function(e,t,n,o){t.removeFromHistory=function(t){o.removeFromPostsPlaybackHistory({userId:n.id,postId:t.post.id}).$promise.then((function(){e.$broadcast("$playbackhistory:remove",{item:t})}))}}]),angular.module("bandlab.playbackhistory").component("playbackHistoryCard",{templateUrl:"https://www.bandlab.com/web-app/playbackhistory/partials/_playback-history-card-58b8e647.html",controllerAs:"vm",controller:["$element","$q","$scope","Me","PlayerHistory","User",function(e,t,n,o,r,i){let a=t.resolve();function s(){return a=i.postsPlaybackHistory({id:o.id,limit:3}).$promise.then((function(t){let{data:o}=t;o.length||e.remove();const i=o.map((e=>e.post));return r.pushQueueSongs(i,n.playerQueueContext,!0),o})),a}this.$onInit=function(){s().then((function(e){n.playbackHistoryArray=e}))},this.$onDestroy=function(){r.removeQueueContext(n.playerQueueContext)},n.me=o,n.playerQueueContext=ad(),n.$on("$playbackhistory:remove",(function(){s().then((function(e){n.playbackHistoryArray=e}))}))}]}),angular.module("bandlab.playbackhistory.routes",["ui.router"]).config(["$stateProvider",function(e){e.state("playbackhistory",{url:"/playback-history",onEnter:["Page",function(e){e.setMetadata({tapBarTitle:"Playback History"})}],onExit:["Page",function(e){e.clearMetadata()}],controller:"PlaybackHistoryCtrl",templateUrl:"https://www.bandlab.com/web-app/playbackhistory/views/playback-history-layout-7d45b962.html"})}]),angular.module("bandlab.player",[]),angular.module("bandlab.player").controller("PlayerQueueCtrl",["$scope","AppNotifications","Player","PlayerHistory",function(e,t,n,o){e.playNext=function(r){const i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.getContentSource();o.playNext(r,i),n.getCurrentSong().id?t.addNotification({title:"Track will play next",classList:"success",autoclose:4e3}):n.next(),mv("playback_queue_play_next")},e.getContentSource=function(){let{collection:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e?"Playlist"===e.type?"playlist":"album":o.getCurrentPageContext().contentSource||"other"}}]),angular.module("bandlab.player").constant("playerEvents",{ENDED:"$playerEnded",PAUSED:"$playerPausePlay",PLAY:"$playerStartPlay",PROGRESS:"$playerUpdateTime",REQUESTING:"$playerRequestingSource"});const LG="$player:counter";angular.module("bandlab.player").directive("globalPlayer",["$state","Player","playerEvents","PlayerHistory",function(e,t,n,o){return{restrict:"E",replace:!0,scope:{},templateUrl:"https://www.bandlab.com/web-app/player/partials/_global-player-3541cd33.html",link:function(t){angular.element(document.body).on("keydown",(function(n){-1!==["INPUT","TEXTAREA"].indexOf(n.target.nodeName)&&"file"!==n.target.type||!document.body.classList.contains("player-visible")||!e.includes("sounds")||document.body.classList.contains("sounds-sampler-editor-visible")||document.body.classList.contains("sounds-sample-details-editor-visible")||32!==n.which||(n.preventDefault(),document.activeElement.blur(),t.togglePlay())}))},controller:["$scope","$state","$transitions","$analytics","Me","AppNotifications",function(e,r,i,a,s,l){var c=t.getAudio();function u(t){let{name:o}=t,{type:r=o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(r){case n.PAUSED:return e.status="loaded",void d();case n.REQUESTING:return void(e.status="loading");case n.PROGRESS:return e.status="loaded",e.currentTime=c.currentTime,e.duration=c.duration||1,void(e.progress=c.currentTime/e.duration*100);case n.ENDED:return void(e.currentTime=c.duration||1)}}function d(){const e=""!==t.getCurrentSong().id&&!r.current.hideGlobalPlayer;document.body.classList.toggle("player-visible",e)}e.me=s,e.LOOP_STATES={DONT_REPEAT:"dont-repeat",REPEAT_ONE:"repeat-one",REPEAT_ALL:"repeat-all"},e.playerHistory=o,e.revision=t.getCurrentSong(),e.status="",e.loop=e.LOOP_STATES.DONT_REPEAT,e.$on(n.PAUSED,u),e.$on("$player",u),e.$on(n.REQUESTING,u),e.$on(n.PROGRESS,u),e.$on(n.ENDED,u),e.$on(n.PLAY,d),i.onSuccess({to:e=>e.hideGlobalPlayer},t.pause),i.onSuccess({from:e=>e.hideGlobalPlayer},d),e.$on("$revision:changed",(function(n,r){var i=t.getCurrentSong();r.revision.id===i.id&&Object.assign(i,r.revision),"master"===r.action&&(o.removeRevision(r.revision.id),r.revision.id===i.id&&(t.pause(),i.id="",e.hideQueue()))})),e.playPrevious=function(){o.hasPrevious()&&c.currentTime<3?t.prev():t.goToPercent(0),a.eventTrack("Play Previous",{category:"Player",label:"global_player"})},e.playNext=function(){t.next(),a.eventTrack("Play Next",{category:"Player",label:"global_player"})},e.isSocialDisabled=function(){return r.includes("album.create.tracks")},e.isPlaying=function(){return!c.paused},e.toggleLoop=function(){switch(e.loop){case e.LOOP_STATES.DONT_REPEAT:default:e.loop=e.LOOP_STATES.REPEAT_ALL,t.setOneTrackLoop(!1),o.setRepeat(!0);break;case e.LOOP_STATES.REPEAT_ALL:e.loop=e.LOOP_STATES.REPEAT_ONE,t.setOneTrackLoop(!0),o.setRepeat(!1);break;case e.LOOP_STATES.REPEAT_ONE:e.loop=e.LOOP_STATES.DONT_REPEAT,t.setOneTrackLoop(!1),o.setRepeat(!1)}},e.toggleQueue=function(){e.queue=!e.queue,e.queue&&(a.eventTrack("Open Queue",{category:"Player",label:"global_player"}),l.clearAll())},e.hideQueue=function(){e.queue=!1},e.togglePlay=function(){c.paused?(t.play(null,{navigatingHistory:!0}),a.eventTrack("Play",{category:"Player",label:"global_player"})):(t.pause(),a.eventTrack("Pause",{category:"Player",label:"global_player"}))}}]}}]),angular.module("bandlab.player").directive("globalPlayerProgress",["$filter","Player",function(e,t){return{restrict:"E",replace:!0,link:function(t,n){var o=angular.element(n[0].querySelector(".global-player-progress-go"));function r(r){var i,a,s=Math.max(0,r.offsetX||(a=((i=(i=r)||window.event).target||i.srcElement).getBoundingClientRect(),i.clientX-a.left));o.css("left",`${s}px`),o.text(e("soundTime")(s/n[0].getBoundingClientRect().width*(t.duration||1)))}n.on("mouseenter",(function(){n.on("mousemove",r)})),n.on("mouseleave",(function(){n.off("mousemove",r)}))},controller:["$scope",function(e){e.setProgressTime=function(e){t.goToPercent(e)}}],templateUrl:"https://www.bandlab.com/web-app/player/partials/_global-player-progress-18fc7253.html"}}]),angular.module("bandlab.player").directive("globalPlayerQueue",["$transitions","PlayerHistory",function(e,t){return{restrict:"E",replace:!0,scope:{hideQueue:"&"},link:function(n,o){const r=o[0].children[1];function i(e){e.target.closest(".global-player")||e.target.closest(".modal-overlay")||(a(),document.body.removeEventListener("mousedown",i))}function a(){n.hideQueue(),n.$applyAsync()}setTimeout((function(){document.body.addEventListener("mousedown",i);const e=t.getIndex()-1;if(e>=1){const t=r.children[e];r.scrollTo({top:t.offsetTop})}})),e.onSuccess({},(function(){a()})),n.$on("$destroy",(function(){document.body.removeEventListener("mousedown",i)}))},controller:["$scope","PlayerHistory",function(e,t){e.playerHistory=t,e.dropdownMenu={},t.getStack().forEach(((t,n)=>{e.dropdownMenu[n]={open:!1}})),e.toggleThisMenu=function(t){t in e.dropdownMenu||(e.dropdownMenu[t]={open:!1});for(const n of Object.keys(e.dropdownMenu))parseInt(n)!==t?e.dropdownMenu[n]={open:!1}:e.dropdownMenu[n].open=!e.dropdownMenu[n].open},e.closeThisMenu=function(t){e.dropdownMenu[t].open=!1}}],templateUrl:"https://www.bandlab.com/web-app/player/partials/_global-player-queue-a271e60a.html"}}]),angular.module("bandlab.player").directive("globalPlayerQueueItemDragHandler",["PlayerHistory",function(e){let t=null,n=null,o=null;return{restrict:"A",link:function(r,i){const a=i[0].parentElement,s=i[0];function l(e){e.preventDefault()}s.draggable=!0,s.addEventListener("dragstart",(function(e){e.stopPropagation(),t=r.$index,e.dataTransfer.setData("text/plain",""),e.dataTransfer.effectAllowed="move",a.style.opacity="30%",a.addEventListener("dragover",l)})),s.addEventListener("dragend",(function(){t!==n&&null!==n&&e.reorderStack(t,n),a.style.removeProperty("opacity"),null!==o&&(o.classList.remove("is-dropped-above"),o.classList.remove("is-dropped-below")),a.removeEventListener("dragover",l),t=null,n=null,o=null,r.$applyAsync()})),a.addEventListener("dragover",(function(e){if(e.preventDefault(),e.target.contains(a)||null===t||t===r.$index)return;e.dataTransfer.dropEffect="move";const i=function(e,t){const n=e.getBoundingClientRect();return n.top+n.height-t.y>n.height/2}(a,e),s=t<r.$index;o=a,n=i||s?i&&s?r.$index-1:r.$index:r.$index+1,function(e,t){return o===a&&(n<e||!t&&n===e)}(r.$index,s)?a.classList.add("is-dropped-above"):a.classList.remove("is-dropped-above"),function(e,t){return o===a&&(n>e||t&&n===e)}(r.$index,s)?a.classList.add("is-dropped-below"):a.classList.remove("is-dropped-below")})),a.addEventListener("dragleave",(function(){a.classList.remove("is-dropped-above"),a.classList.remove("is-dropped-below")}))}}}]),angular.module("bandlab.player").directive("globalPlayerVolume",["Player",function(e){return{restrict:"E",replace:!0,templateUrl:"https://www.bandlab.com/web-app/player/partials/_global-player-volume-6de8e8e5.html",controller:["$scope",function(t){var n;t.volume=e.getVolume(),t.storeVolume=function(e){n=t.volume,t.setVolume(e),localStorage.setItem("globalPlayerVolume",t.volume)},t.setVolume=function(n){t.volume=e.setVolume(n),t.isMuted=0===t.volume},t.mute=function(){t.isMuted?(t.volume=e.setVolume(n),t.isMuted=!1):(n=t.volume,t.volume=e.setVolume(0),t.isMuted=!0)}}]}}]),angular.module("bandlab.player").directive("playCounter",["$filter",function(e){return{restrict:"E",require:"ngModel",link:function(t,n,o,r){var i=0;if(t.counter="0",!r||angular.isUndefined(o.id))return;r.$render=function(){i=r.$viewValue||0,t.counter=e("bigNumber")(i)};const a=t.$on(LG,(function(n,r){r.id===o.id&&(i++,t.counter=e("bigNumber")(i),a())}))}}}]),angular.module("bandlab.player").directive("playerAudio",["$analytics","$state","Player","playerEvents","PlayerHistory",function(e,t,n,o,r){return{restrict:"A",priority:50,link:function(i,a,s){var l,c=i.$eval(s.playerAudio),u=i.$eval(s.collection),d=i.$eval(s.navigatingHistory),p=i.$eval(s.post),m=angular.noop,f=angular.noop,h=angular.noop,g=angular.noop;const v=i.$eval(s.playerStackIndex)??null;function b(){m(),h(),f(),g()}function y(e,t){let{name:n}=e;switch(n){case o.PROGRESS:return void(null===v&&t.id===c.id||null!==v&&v===t.playerStackIndex&&t.id===c.id?(t.isPaused||(i.playStatus="playing"),i.currentTime=t.timePassed):(i.playStatus="stopped",b()));case o.PAUSED:return void(null===v&&c&&t.id===c.id||null!==v&&v===t.playerStackIndex&&c&&t.id===c.id?i.playStatus="paused":(i.currentTime=0,i.playStatus="stopped",b()));case o.ENDED:return void((null===v&&t.id===c.id||null!==v&&v===t.playerStackIndex&&t.id===c.id)&&(i.currentTime=0,i.playStatus="stopped",b()));case o.REQUESTING:return void(null===v&&c&&t.id===c.id||null!==v&&v===t.playerStackIndex&&c&&t.id===c.id?i.playStatus="loading":i.playStatus="stopped");case o.PLAY:return void((null===v&&c&&t.id===c.id||null!==v&&v===t.playerStackIndex&&c&&t.id===c.id)&&w())}}function w(){h=i.$on(o.PROGRESS,y),f=i.$on(o.PAUSED,y),g=i.$on(o.ENDED,y)}i.$on(o.REQUESTING,y),i.$on(o.PLAY,y),c||(a.remove(),b(),i.isPlaying=function(){return!1}),i.isPlaying=function(){return null!==v?n.isPlayingSong(c.id,v):n.isPlayingSong(c.id)},i.isPlaying()?w():(i.playStatus=c.id!==n.getCurrentSong().id||v!==r.getIndex()&&null!==v?"stopped":"paused",i.currentTime=0),(l=a[0].querySelector("[player-audio-button-toggle]")?angular.element(a[0].querySelector("[player-audio-button-toggle]")):a).on("click",(function(o){o.target.hasAttribute("href")||i.$apply((function(){var o;o={collection:u,contentSource:s.contentSource,contextId:s.contextId,element:a,navigatingHistory:d,playerStackIndex:v,triggeredFrom:_p(t,a)},c&&(n.isPlayingSong(c.id,v)?(n.pause(),e.eventTrack("Pause",{category:"Revision".type,label:s.eventLabel?s.eventLabel:""})):(n.pause(),n.play(c,o,p),e.eventTrack("Play",{category:"Revision",label:s.eventLabel?s.eventLabel:""})))}))})),a.on("click",(function(e){e.target.hasAttribute("player-audio-button-play")&&c.id!==n.getCurrentSong().id&&l[0].click()}))}}}]).directive("playerAudioButton",(function(){return{restrict:"E",template:"<div><div>",link:function(e,t){const n=import("./chunk-b34f2a07.js").then((function(e){let{mountPlayerAudioButton:n}=e;return n(t[0])}));e.$on("$destroy",(async function(){(await n).unmount()}))}}})),angular.module("bandlab.player").directive("playerAudioCollectionToggle",["$state","Player",function(e,t){return{restrict:"A",priority:50,link:function(n,o,r){var i=n.$eval(r.playerAudioCollectionToggle);const a=n.$eval(r.playerAudioAlbum),s=n.$eval(r.playerAudioUserTopTracks);n.getCollectionStatus=function(){return t.getCollectionStatus(i.id)},o.on("click",(function(){"playing"!==n.getCollectionStatus()?t.playCollection(i,_p(e,o),e,o,{isAlbum:a,isUserTopTracks:s}):t.pause()}))}}}]),angular.module("bandlab.common").directive("waveformBars",["$http","$timeout","Player","playerEvents",function(e,t,n,o){return{restrict:"E",replace:!0,scope:{barWidth:"=",dominantColor:"=",revisionId:"@",waveformUrl:"@"},template:'<canvas class="waveform-bars" progress progress-on-start="setProgressTime" progress-on-move="setProgressTime"></canvas>',link:function(r,i){var a,s=i,l=s[0].getContext("2d"),c={progress:angular.noop,request:angular.noop},u=0,d=0,p=[],m=!1;function f(){return r.$on(o.PROGRESS,h)}function h(e){let{name:t}=e,{type:n=t,...a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(n){case o.PLAY:return void(a.id===r.revisionId?(c={progress:f(),request:r.$on(o.REQUESTING,h)},i.on("mousemove",g),i.on("mouseleave",v),m=!0):m&&(c.progress(),c.request(),d=0,i.off("mousemove",g),i.off("mouseleave",v),sC(l,p,0,0,r.barWidth,r.dominantColor),m=!1));case o.REQUESTING:return d=0,void sC(l,p,0,0,r.barWidth,r.dominantColor);case o.PROGRESS:return void(a.id===r.revisionId&&(d=a.timePassed/a.duration,sC(l,p,d,u,r.barWidth,r.dominantColor)))}}function g(e){var t=e.offsetX||e.pageX-(s[0].getBoundingClientRect().left+document.body.scrollLeft);u=t/e.target.width,sC(l,p,d,u,r.barWidth,r.dominantColor)}function v(){sC(l,p,d,u=null,r.barWidth,r.dominantColor)}function b(){var e,t=i.parent();s.attr("width",Math.round(t[0].getBoundingClientRect().width)),s.attr("height",Math.round(t[0].getBoundingClientRect().height)),(e=Math.floor(l.canvas.width/(r.barWidth+1)))>1&&(p=function(e,t){const n=Math.floor(e.values.length/t),o=Math.ceil(e.values.length/n),r=o-t,i=Math.floor(o/r),a=[];let s=0;for(;s<e.values.length;){const t=a.length%i==0?Math.min(2*n,e.values.length-s):Math.min(n,e.values.length-s),o=[];for(let n=0;n<t;n++)o.push(e.values[s+n]/e.maxValue*100);a.push(fs(o)),s+=t}return a}(a,e),sC(l,p,d,0,r.barWidth,r.dominantColor))}function y(){return w(r.waveformUrl).then((function(e){a=e,b()}))}function w(t){return e({url:t,cache:!0}).then((function(e){return e.data}))}return r.$on(o.PLAY,h),r.dominantColor||(r.dominantColor="#282C32"),(r.waveformUrl?w(r.waveformUrl):Promise.reject()).catch((function(){return w("https://static.bandlab.com/defaults/waveform.json")})).then((function(e){a=e,b();var o=ay(b,300);window.addEventListener("resize",o),r.$on("$mixdown:changed",(()=>r.$applyAsync((()=>t(y))))),r.$on("$destroy",(function(){window.removeEventListener("resize",o)})),r.revisionId===n.getCurrentSong().id&&(c.progress=f(),i.on("mousemove",g),i.on("mouseleave",v))})).catch((function(){i.remove(),r.$destroy()}))},controller:["$scope",function(e){e.setProgressTime=function(t){n.getCurrentSong().id===e.revisionId?n.goToPercent(t):function(t){var r=e.$on(o.PROGRESS,(function(){n.getCurrentSong().id===e.revisionId&&(r(),n.goToPercent(t))}))}(t)}}]}}]),angular.module("bandlab.player").factory("Player",["$analytics","$http","$q","$rootScope","$state","Album","Collection","Me","playerEvents","PlayerHistory","Post","VideoTile",function(e,t,n,o,r,i,a,s,l,c,u,d){const p=function(){const e=new Audio;return e.addEventListener("error",U),e.addEventListener("ended",N),e.addEventListener("pause",O),e.addEventListener("timeupdate",D),"IE"!==nh.browser.name&&"Safari"!==nh.browser.name&&"iOS"!==nh.os.name&&window.addEventListener("storage",(function(e){"playing"===e.key&&O()})),e.volume=Number(ql.getItem("globalPlayerVolume"))||1,e}(),m={id:""},f=new Map;let h=angular.noop,g="other",v="other";var b={},y=n.resolve(),w=n.resolve(!0);const $="track_stream_quality_threshold_hit",k=.6;return{fastBackward:P,fastForward:M,getAudio:function(){return p},getCollectionStatus:function(e){if(b.id===e){if(0===y.$$state.status||-1===y.$$state.status)return"loading";if(!p.paused)return"playing"}return"paused"},getCurrentCollection:function(){return b},getCurrentSong:function(){return m},getCurrentTime:function(){return p.readyState>=3?p.currentTime:null},getVolume:function(){return p.volume},goToPercent:function(e){p.readyState>=3?T(e*p.duration):(h(),h=o.$on(l.PLAY,(()=>{h(),T(e*p.duration)})))},goToTime:T,goToTimeAndPlay:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;T(arguments.length>1?arguments[1]:void 0),R(e,{navigatingHistory:!0})},isPlaying:function(){return!p.paused},isPlayingSong:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null!==t?!p.paused&&m.id===e&&c.getIndex()===t:!p.paused&&m.id===e},isCurrentSong:C,next:L,pause:O,pauseOtherTabs:B,play:R,playCollection:function(t,o,r,s){let{isAlbum:l,isUserTopTracks:d}=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(b.id&&b.id===t.id)return void E();const p=b;b=t,y=(t.posts?n.resolve(t):l?i.get({id:t.id}).$promise:d?u.getTopTracksFromUser({userId:t.id,limit:5}).$promise.then((e=>(t.posts=e,n.resolve(t)))):a.get({id:t.id}).$promise).then((function(t){return c.forcePushQueueSongs(t.posts,null,{contentSource:W(l?"album":"playlist"),id:t.id}),g=c.getCurrentPlayerContext().contentSource,l||d?l&&p.id!==b.id&&F(r,s):e.eventTrack("Collection",{category:"Play"}),L({triggeredFrom:o,contentSource:W(g)})}))},playLoop:function(e,t,n,o){const r=e.map((e=>({...e,song:{isSounds:!0,name:e.name,picture:e.imageUrl?bS(e.imageUrl,yS,60):e.image,download:()=>o(e)},contentSource:"sounds"})));return c.forcePushQueueSongs(r,n,{contentSource:"sounds",url:t}),R(null,{contentSource:"sounds",navigatingHistory:!0})},playLoopPack:function(e,t){Object.assign(m,e),m.song={isSounds:!0,name:e.name,picture:bS(e.imageUrl,yS,60),download:t},c.forcePushQueueSongs([m],m,{contentSource:"sounds"}),R(null,{contentSource:"sounds"})},populateSamplesInQueue:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=e.map((e=>({...e,song:{isSounds:!0,name:e.name,picture:e.imageUrl?bS(e.imageUrl,yS,60):e.image,download:n},contentSource:"sounds"})));c.forcePushQueueSongs(o,c.getStack()[c.getIndex()],{contentSource:"sounds",url:t})},prev:x,removeRevisionFromQueue:function(e){C(arguments.length>1&&void 0!==arguments[1]?arguments[1]:e)||c.removeRevision(e)},setOneTrackLoop:function(e){p.loop=e},setVolume:function(e){return p.volume=Math.max(Math.min(1,e),0),p.volume}};function S(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={content_source:W(g),genre:m.genres?.[0].id??null,player_can_edit:m.post?.revision?.canEdit??(_(m)?m.canEdit:"no_revision"),post_creator_user_id:m.post?.revision?.creator.id??m.creator?.id,post_id:m.post.id??m.postId,post_type:m.post?.type?.toLowerCase()??m.type?.toLowerCase()??(_(m)?"revision":void 0),post_visibility:m.post?.state?.toLowerCase()??m.state?.toLowerCase(),triggered_from:v,trending_post_type:m.post?.trendingPostType,...t};void 0===n.trending_post_type&&delete n.trending_post_type,"private"!==n.post_visibility&&(s.isAnonymous()||Promise.all([Promise.resolve().then((()=>Ap)),Promise.resolve().then((()=>lv)),Promise.resolve().then((()=>fv))]).then((function(t){let[{logEvent:o},{logCustomEvent:r},{logEvent:i}]=t;o(e,n),i(e,n),e===$&&r(e,n)})))}function _(e){return"volume"in e}function P(){return p.readyState>=3&&(p.currentTime=p.currentTime-5,D(),!0)}function M(){return p.readyState>=3&&(p.currentTime=p.currentTime+5,D(),!0)}function T(e){return p.readyState>=3?(p.currentTime=Math.min(e,p.duration-.1),D(),!0):(h(),h=o.$on(l.PLAY,(()=>{h(),p.currentTime=Math.min(e,p.duration-.1),D()})),!0)}function C(e){return m.id===e}function E(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;d.current&&d.current.pause(),vj(),w=w.then((()=>p.play())).then((()=>{D(),o.$broadcast(l.PLAY,{id:m.id,playerStackIndex:e}),"mediaSession"in navigator&&(navigator.mediaSession.metadata=new MediaMetadata({title:m?.song?.name??"BandLab",artist:m?.song?.author?.name??m?.revision?.creator?.name,album:b.name,artwork:[{src:m?.song?.picture?.m,sizes:"640x640",type:"image/jpeg"},{src:m?.song?.picture?.s,sizes:"360x360",type:"image/jpeg"}]}),navigator.mediaSession.setActionHandler("previoustrack",x),navigator.mediaSession.setActionHandler("nexttrack",L),navigator.mediaSession.setActionHandler("seekbackward",P),navigator.mediaSession.setActionHandler("seekforward",M),navigator.mediaSession.setActionHandler("seekto",(function(e){let{seekTime:t}=e;T(t)})))})).catch((()=>{}))}function I(){m.canEdit=!1,m.mixdown=null,m.post=null,m.revision={},m.track=null,m.isExplicit=!1,m.isPublic=!1,m.creator=null,m.samplesCount=null,m.features=null,m.id=null}function R(e,i){let{collection:a=!1,contentSource:s,contextId:u=null,element:d,navigatingHistory:f=!1,playerStackIndex:h=null,silent:w=!1,triggeredFrom:$="other"}=i,k=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const S=n.resolve();if(v=$,e&&m.id!==e.id){m.id!==e.id&&(I(),m.post=k,m.revision=k.revision,Object.assign(m,e)),w||o.$broadcast(l.REQUESTING,{id:e.id,playerStackIndex:h||(f?c.getIndex():null)});const n=e.track?.sample.audioUrl??e.mixdown?.file;p.src!==n&&(e.src=n,p.src=n),w||E(h||(f?c.getIndex():null)),e.track?function(e){t.post(`https://www.bandlab.com/api/v1.3/posts/${e.id}/plays`).then((function(t){A(t)&&o.$broadcast(LG,{id:e.id})}))}(m):e.isPublic&&function(e){t.post(`https://www.bandlab.com/api/v1.3/revisions/${e.id}/plays`).then((function(t){A(t)&&o.$broadcast(LG,{id:e.id})}))}(e)}else E(h||(f?c.getIndex():null));if("sounds"===s){I();const e=c.getStack()[c.getIndex()];p.src=e.audioUrl,Object.assign(m,e),E()}if(a){const t="Playlist"===a.type,n=b;b=a,y=S,c.forcePushQueueSongs(a.posts,e,{contentSource:W(t?"playlist":"album"),id:a.id}),t||n.id===b.id||F(r,d)}else f||(b={},u?c.forcePushQueueSongs(null,e,{id:u,...s?{contentSource:W(s)}:{}}):c.forcePushQueueSongs(null,e));return g=W(s||c.getCurrentPlayerContext().contentSource||"other"),null!==h?c.setIndex(h):e&&!f&&c.setRevision(e),k.adEngagementEvent&&k.placement&&_D(k.adEngagementEvent,"engagement",k.placement),B(),S}function A(e){return[202,204].includes(e.status)}function x(){const e=c.previous();if(j(),!e)return;const{contentSource:t,...n}=e;return n&&R(n.revision,{navigatingHistory:!0,contentSource:t})}function L(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=c.next();if(j(),!t)return;const{contentSource:n,...o}=t;return o&&R(o.revision,{...e,contentSource:n??e.contentSource,navigatingHistory:!0},o)}function O(){""!==p.src&&(p.pause(),o.$broadcast(l.PAUSED,{id:m.id,playerStackIndex:c.getIndex()}),o.$applyAsync(),h())}function j(){p.paused||(p.pause(),p.currentTime=0,p.load(),h())}function D(){p.readyState<1||(o.$broadcast(l.PROGRESS,{id:m.id,timePassed:p.currentTime,duration:p.duration,isPaused:p.paused,playerStackIndex:c.getIndex()}),o.$applyAsync(),m.song.isSounds||function(){f.has(m.id)||f.set(m.id,{logPostPlay:rd((()=>S("post_play",{playlist_id:b.id}))),logTrackStream:rd((()=>S("track_stream",{playlist_id:b.id}))),logTrackStreamQualityThresholdHit:rd((()=>S($,{threshold_percentage:100*k,threshold_time:Math.round(p.duration*k),total_track_duration:Math.round(p.duration)}))),listeningTime:0,songDuration:p.duration});const e=f.get(m.id),t=p.currentTime,n=+new Date/1e3;Math.abs(t-e.currentTime-(n-e.timestamp))<.1?e.listeningTime+=t-e.currentTime:e.listeningTime=0,e.listeningTime>=3&&e.logPostPlay(),e.listeningTime>=10&&e.logTrackStream(),e.listeningTime>=.6*e.songDuration&&e.logTrackStreamQualityThresholdHit(),e.currentTime=t,e.timestamp=n}(m.id))}async function N(){await w,o.$broadcast(l.PROGRESS,{id:m.id,timePassed:p.currentTime,duration:p.duration,playerStackIndex:c.getIndex()}),e.eventTrack("Played till end",{category:"Player",label:m.id}),o.$broadcast(l.ENDED,{id:m.id,playerStackIndex:c.getIndex()}),j(),c.hasNext()&&!m.song.isSounds&&L({triggeredFrom:"auto_play"}),o.$applyAsync()}function U(){j(),p.src=""}function F(e,t){Promise.resolve().then((()=>rb)).then((function(n){let{logAlbumPlay:o}=n;o(e,t)}))}function B(){ql.playing=Date.now()}function W(e){return v.startsWith("explore_")?v:e}}]),angular.module("bandlab.player").factory("PlayerHistory",(function(){var e=-1,t={},n=Promise.resolve(),o={},r={},i=!1,a=[],s=[],l=!1;return{getCurrentPageContext:function(){return o},getCurrentPlayerContext:function(){return t},setCurrentPageContext:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o.url!==e.url&&this.removeQueueContext(o.url),o=e},forcePushQueueSongs:function(n){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o;const p=d.id??d.url;if(!n&&!r[p])return;l=!1,t=d.id?d:o,_.differenceBy(n,s,"id").length&&(e=-1);const m=a[e];n&&(r[p]=n.slice());let f=0;i&&(f=r[p].findIndex((e=>e.id===i.id||e.id===i.postId))),s=r[p].slice(),a=s.slice(),n&&i?u(f):c(m)},pushQueueSongs:function(){let e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter((e=>"Ready"===_.get(e,"revision.mixdown.status")));if(e in r&&!n?r[e].push(...o):r[e]=o,t.url===e||t.id===e){if(n)return s=o,void(a=l?_.shuffle(o):o);s.push(...o),l?a.push(..._.shuffle(o)):a.push(...o)}},removeQueueContext(e){[t.url,t.id].includes(e)||delete r[e]},getStack:function(){return a},playNext:function(t,n){const o=t.revision?{contentSource:n,...t}:{creator:t.creator,type:"Revision",id:t.postId,revision:t,contentSource:n};a.splice(e+1,0,o),s.splice(e+1,0,o)},getIndex:function(){return e},setIndex:u,setRevision:c,setRepeat:function(e){i=e},isShuffled:function(){return l},toggleShuffle:function(){(l=!l)?(a=a.slice(0,e+1).concat(_.shuffle(a.slice(e+1))),l=!0):function(){const t=a[e];a=s.slice(),c(t),l=!1}()},removeItemByIndex:function(t){if(t!==e){if(l){const[e]=a.splice(t,1),n=s.findIndex((t=>t.id===e.id||t.id===e.postId));s.splice(n,1)}else a.splice(t,1),s.splice(t,1);t<e&&(e-=1)}},removeRevision:function(e){Gf(a,(function(t){return t.revisionId===e||t.revision.id===e})),Gf(s,(function(t){return t.revisionId===e||t.revision.id===e}))},removeSong:function(t){const n=a[e],o={revision:{song:{id:t}}};Gf(a,o),Gf(s,o),c(n)},reorderStack:function(t,n){const[o]=a.splice(t,1);a.splice(n,0,o),l||(s.splice(t,1),s.splice(n,0,o)),t<e&&n>=e?e-=1:t>e&&n<=e?e+=1:t===e&&(e=n)},previous:function(){return e=0===e&&i?a.length-1:e-1,d(),a[e]},hasPrevious:function(){return i||!!a[e-1]},next:function(){return e=e===a.length-1&&i?0:e+1,d(),a[e]},hasNext:function(){return i||!!a[e+1]}};function c(t){if(!t)return void(e=-1);const n=t.revision?t.revision.id:t.id;e=_.findIndex(a,(e=>n===e.revision.id)),d()}function u(t){e=t,d()}function d(){n=n.then((function(){if(t.loader&&e>=a.length-2)return t.loader().catch((()=>{}))}))}})),angular.module("bandlab.post",[]).directive("postExplicitBadge",(function(){return{scope:{size:"<?"},link:function(e,t){const n=import("./chunk-d76af66b.js").then((function(n){let{mountPostExplicitBadge:o}=n;return o(t[0],{size:e.size})}));e.$on("$destroy",(async function(){(await n).unmount()}))}}})).directive("postPrivateBadge",(function(){return{scope:{withTooltip:"="},link:function(e,t){const n=import("./chunk-f30c834d.js").then((function(n){let{mountPostPrivateBadge:o}=n;return o(t[0],{withTooltip:e.withTooltip})}));e.$on("$destroy",(async function(){(await n).unmount()}))}}})).directive("postUnlistedBadge",(function(){return{link:function(e,t){const n=import("./chunk-901a0d5e.js").then((function(e){let{mountPostUnlistedBadge:n}=e;return n(t[0])}));e.$on("$destroy",(async function(){(await n).unmount()}))}}})).directive("postCardCaption",["$injector",function(e){return{restrict:"E",replace:!0,scope:{text:"=",maxLines:"<"},link:function(t,n){const o=import("./chunk-e7c9590d.js").then((function(o){let{mountPostCardCaption:r}=o;return r(n[0],{$injector:e,scope:t})}));t.$on("$destroy",(async function(){(await o).unmount()}))}}}]).directive("postCardHeaderAvatar",(function(){return{scope:{post:"<",isBoosted:"<",triggeredFrom:"<"},templateUrl:"https://www.bandlab.com/web-app/post/partials/_post-card-header-avatar-0f597e4c.html"}})).directive("postCardHeaderContent",(function(){return{scope:{post:"<",isBoosted:"<",triggeredFrom:"<",engagementEventProfileOpen:"&",isOpenToCollabEnabled:"<"},templateUrl:"https://www.bandlab.com/web-app/post/partials/_post-card-header-content-8c4184c7.html"}})).directive("postRelatedAlbum",(function(){return{scope:{album:"="},templateUrl:"https://www.bandlab.com/web-app/post/partials/_post-related-album-8a76be0f.html"}})).directive("postRelatedBand",["Me",function(e){return{scope:{band:"="},templateUrl:"https://www.bandlab.com/web-app/post/partials/_post-related-band-ff053b26.html",controller:["$scope","User","Tag",function(t,n,o){t.getMembers=function(e){return n.fromBand(Object.assign(e,{bandId:t.band.id,accepted:!0})).$promise},Promise.resolve().then((()=>Ap)).then((t=>{let{getAmplitudeFeatureFlag:n}=t;return n(e,"follow_bands_enabled")})).then((e=>{t.isFollowBandsEnabled="true"===e})),o.getGenres().then((function(e){const n=e.filter((e=>_.some(t.band.genres,{id:e.id})));t.bandGenres=n}))}]}}]).directive("postRelatedRecommended",(function(){return{scope:{posts:"="},templateUrl:"https://www.bandlab.com/web-app/post/partials/_post-related-recommended-4cd46b9c.html"}})).directive("postRelatedOriginal",(function(){return{scope:{original:"="},templateUrl:"https://www.bandlab.com/web-app/post/partials/_post-related-original-c18f2b09.html"}})).directive("postRelatedCollaborators",(function(){return{scope:{collaborators:"="},templateUrl:"https://www.bandlab.com/web-app/post/partials/_post-related-collaborators-f4b75839.html"}})).directive("postsFromSameCreator",(function(){return{scope:{posts:"<",contextId:"<"},templateUrl:"https://www.bandlab.com/web-app/post/partials/_posts-from-same-creator-779facb9.html"}})).directive("postCardReactionsButton",["$injector",function(e){return{restrict:"E",replace:!0,scope:{onEngagementEvent:"&",onLikeEvent:"&",post:"=",triggeredFrom:"<"},link:function(t,n){const o=import("./chunk-d9718b3f.js").then((function(o){let{mountPostCardReactionsButton:r}=o;return r(n[0],{$injector:e,scope:t})}));t.$on("$destroy",(async function(){(await o).unmount()}))}}}]).directive("postCardReactionsPreview",["$injector",function(e){return{restrict:"E",replace:!0,scope:{getReactors:"=",reactionsMap:"=",reactionsCount:"=",initiatorReaction:"=",likersEntityType:"=",likersEntityId:"=",postCreatorId:"<"},link:function(t,n){const o=import("./chunk-c555549f.js").then((function(o){let{mountPostCardReactionsPreview:r}=o;return r(n[0],{$injector:e,scope:t})}));t.$on("$destroy",(async function(){(await o).unmount()}))}}}]).directive("trendingVideosCarousel",["$injector",function(e){return{restrict:"E",replace:!0,scope:{},link:function(t,n){const o=import("./chunk-6eb9ccb2.js").then((function(o){let{mountTrendingVideosCarousel:r}=o;return r(n[0],{$injector:e,scope:t})}));t.$on("$destroy",(async function(){(await o).unmount()}))}}}]),angular.module("bandlab.post").controller("PostCtrl",["Me",function(e){var t=this;t.$onInit=function(){t.post.revision&&(t.post.revision.postId=t.post.id,t.post.revision.isExplicit=t.post.isExplicit)},t.me=e,t.onEngagement=function(){t.engagementEvent&&_D(t.engagementEvent,"engagement",t.post.placement)},t.onImpression=function(){t.impressionEvent&&_D(t.impressionEvent,"impression",t.post.placement)}}]),angular.module("bandlab.post").controller("PostEditCtrl",["$analytics","$rootScope","$scope","$state","AppNotifications","ChatHelper","ConfirmModal","Me","Post",function(e,t,n,o,r,i,a,s,l){function c(e){const t=(o.current.name.includes("band.feed")?"bands":o.current.name.includes("community.feed")&&"communities")||"users";return{type:t,id:"bands"===t&&e.band.id||"communities"===t&&e.community.id||e.creator.id}}n.post=new l(n.post),i.resetMessageAttachmentsCache(),n.$watch("post.caption",(function(e,t){n.post.backgroundId&&n.post.caption.split(/\n/).reduce(((e,t)=>t.length>25?e+Math.ceil(t.length/25):e+1),0)>7&&(n.post.caption=t)})),n.editPost=function(){l.update({id:n.post.id,caption:n.post.caption.trim(),link:n.post.link}).$promise.then((function(o){e.eventTrack("Edit Post",{category:"Post",label:vg(o.type)}),n.$parent.post.caption=o.caption,n.$parent.post.link=o.link,t.$broadcast("editPostModal","close")})).catch((()=>{n.postForm.$setPristine()}))},n.pinPost=function(){return l.get({id:n.post.id}).$promise.then((function(e){const{type:o,id:i}=c(e);return l[{bands:"fromBand",communities:"fromCommunity"}[o]||"fromUser"]({[{bands:"bandId",communities:"communityId"}[o]||"userId"]:i,limit:1}).$promise.then((function(){let{data:[{isPinned:e}]=[{}]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e?new a({confirmLabel:"Pin",contentScope:{title:"Pin to Top",message:"<p>This will replace any previously pinned post.</p>"},onConfirm:s}).show():s();function s(){return l.pinPost({entityType:o,entityId:i,id:n.post.id}).$promise.then((function(){n.$parent.post.isPinned=!0,t.$broadcast("$post:pin",{post:n.post}),r.addNotification({content:"Post pinned",classList:"light",autoclose:5e3})})).catch((function(){r.addNotification({content:"Something went wrong, please try again later",classList:"alert",autoclose:5e3})}))}}))}))},n.unpinPost=function(){return l.get({id:n.post.id}).$promise.then((function(e){const{type:o,id:i}=c(e);return l.unpinPost({entityType:o,entityId:i,id:n.post.id}).$promise.then((function(){n.$parent.post.isPinned=!1,t.$broadcast("$post:unpin",{post:n.post}),r.addNotification({content:"Post unpinned",classList:"light",autoclose:5e3})}))})).catch((function(){r.addNotification({content:"Something went wrong, please try again later",classList:"alert",autoclose:5e3})}))},n.deletePost=function(n){return new a({confirmLabel:"Delete",contentScope:{title:"Delete this post?",message:"<p>You wont be able to undo this action.</p>"},onConfirm:function(){return l.delete({id:n.id}).$promise.then((function(){e.eventTrack("Delete Post",{category:"Post",label:vg(n.type)}),t.$broadcast("$post:delete",{post:n})}))}}).show()},n.hideCreatorFromTrending=function(e){return new a({confirmLabel:"Hide",contentScope:{title:"Hide this post?",message:`<p>You will see less posts from @${e.creator.username} from now on.</p>`},onConfirm:()=>{return n=e.creator.id,void l.hideCreatorFromTrending({userId:s.id,creatorId:n}).$promise.then((()=>{r.addNotification({title:"You will see less posts like this from now on.",classList:"success",autoclose:5e3}),t.$broadcast("$post:delete",{post:e})})).catch((()=>{r.addNotification({content:"Something went wrong, please try again later",classList:"alert",autoclose:5e3})}));var n}}).show()}}]),angular.module("bandlab.post").controller("PostTrackEditCtrl",["$rootScope","$scope","ConfirmModal","Player","Post",function(e,t,n,o,r){const i=t.post;t.post=new r({...t.post,track:{...t.post.track}}),t.makeTrackPostPrivate=function(){new n({confirmLabel:"Make Private",toFocusConfirm:!0,contentScope:{title:"Make track private",message:"<p>Making your track private will prevent this post from appearing on public feeds.</p>"},onConfirm:function(){return r.update({id:t.post.id},{state:"Private"}).$promise.then((function(){i.state="Private",e.$broadcast("$revision:changed",{action:"unpublish",revision:{id:i.id}}),o.removeRevisionFromQueue(i.id)}))}}).show()}}]),angular.module("bandlab.post").directive("draggablePostTile",["Collection","Me","Player","PlayerHistory",function(e,t,n,o){let r=null,i=null,a=null;return{link:function(s,l){const c=s.vm.collection,u=s.vm.post;let d;if(c.creator.id!==t.id)return;const p=l[0].closest("revision-list-item")||l[0].closest("album-track-tile");function m(e){e.preventDefault()}l[0].draggable=!0,l[0].addEventListener("dragstart",(function(e){if(e.stopPropagation(),r=u,e.dataTransfer.setData("text/plain",""),e.dataTransfer.setDragImage){d=this.parentElement.cloneNode(!0);const t=d.querySelector(".post-tile-action");t&&t.remove();const n=d.querySelector(".player-audio-controls");n&&n.remove(),d.style.borderRadius="2px",d.style.padding="4px",d.style.transform="translateX(-500px)",d.style.width="400px",document.body.appendChild(d),e.dataTransfer.setDragImage(d,0,0)}p.addEventListener("dragover",m)})),l[0].addEventListener("dragend",(function(){d&&document.body.removeChild(d);const t=c.posts.indexOf(r);t!==a&&null!==a&&(c.posts.splice(t,1),c.posts.splice(a,0,r),e.updatePostOrder({id:c.id,postId:r.id,order:a}),n.getCurrentCollection().id&&n.getCurrentCollection().id===c.id&&o.forcePushQueueSongs(c.posts)),i=null,r=null,a=null,s.isDroppedAbove=!1,s.isDroppedBelow=!1,p.removeEventListener("dragover",m),s.$applyAsync()})),p.addEventListener("dragover",(function(e){if(e.target.contains(this)||null===r||r===u)return;const t=function(e,t){const n=e.getBoundingClientRect();return n.top+n.height-t.y>n.height/2}(p,e),n=c.posts.indexOf(r)<c.posts.indexOf(u),o=c.posts.indexOf(u);i=u,a=t||n?t&&n?o-1:o:o+1,s.isDroppedAbove=function(e,t){return i===u&&(a<e||!t&&a===e)}(o,n),s.isDroppedBelow=function(e,t){return i===u&&(a>e||t&&a===e)}(o,n),s.$applyAsync()})),p.addEventListener("dragleave",(function(){s.isDroppedAbove=!1,s.isDroppedBelow=!1,s.$applyAsync()}))}}}]),angular.module("bandlab.post").component("openGraphCard",{bindings:{link:"<"},templateUrl:"https://www.bandlab.com/web-app/post/partials/_open-graph-card-1496356b.html",controllerAs:"vm"}),angular.module("bandlab.post").component("postAttachment",{bindings:{canRemoveLink:"<",post:"<",triggeredFrom:"<"},templateUrl:"https://www.bandlab.com/web-app/post/partials/_post-attachment-15148196.html",controller:["$element","$scope","$state","Album","ChatHelper",function(e,t,n,o,r){const i=this;t.displayCustomAttachment=function(e){let{type:t}=e;return i.post.link&&t===_.get(i,"post.attachment.type")},t.removeLink=function(){i.post.link=null,i.post.pending=null};const a=ay((()=>{i.pendingAttachmentType="",r.getMessageAttachments(`${_.get(i,"post.link.url","")} ${i.post.caption}`).then((async function(e){let[t]=e;t&&(i.pendingAttachmentType=t?.type,t.object=await t.object,i.post.attachment="Revision"===t?.object?.type?{object:{postId:t.object.id,...t.object.revision,post:t.object},type:"Revision"}:function(e){if("Revision"===e?.type){const t=e.object;return t?s({...t.post,creator:t.creator,revision:t}):s()}return"Album"===e?.type?l(e.object):e}(t))})).finally((function(){i.isPendingInternalUrl=!1}))}),1e3,{leading:!0});function s(e){return e?{object:{...e,post:{...e,attachment:{object:e,type:"Revision"}}},type:"Revision"}:{object:null,type:"Revision"}}function l(e){return e?{object:{...e,post:{...o.albumToPost(e),attachment:{object:e,type:"Album"}}},type:"Album"}:{object:null,type:"Album"}}i.$onInit=function(){const e=function(e){switch(e?.type){case"Album":return e.album&&(e.album.posts=e.album.posts.map((t=>o.trackPostToPost(t,e.album)))),l(e.album);case"RevisionPost":return s(e.revisionPost)}}(i.post.linkEntity);e?i.post.attachment=e:"Text"!==i.post.type&&"Link"!==i.post.type||(i.isPendingInternalUrl=r.isInternalUrl(`${_.get(i,"post.link.url","")}`),a(),i.post.canEdit&&t.$watch("vm.post.caption",((e,t)=>{e!==t&&(i.isPendingInternalUrl=r.isInternalUrl(`${_.get(i,"post.link.url","")} ${i.post.caption}`),a())})))},i.getOrigin=()=>_p(n,e),i.sendInsights=function(e,t,n){Promise.resolve().then((()=>rb)).then((function(o){let{logPlaylistShare:r}=o;"Collection"===i.post.attachment.type&&r(e,t,n)}))}}],controllerAs:"vm"}).component("postAttachmentLoader",{bindings:{canRemoveLink:"<",removeLink:"&",type:"<"},templateUrl:"https://www.bandlab.com/web-app/post/partials/_post-attachment-loader-d89890a7.html",controllerAs:"vm"}).component("postAttachmentSkeleton",{bindings:{type:"<"},templateUrl:"https://www.bandlab.com/web-app/post/partials/_post-attachment-skeleton-b11d643b.html",controllerAs:"vm"}),angular.module("bandlab.post").component("postCard",{bindings:{adEventSource:"=",canHidePost:"<",collection:"<",commentId:"<",creativeFormat:"<",displayComments:"<",hideComments:"<",engagementEvent:"=",commentEvent:"=",followEvent:"=",likeEvent:"=",playEvent:"=",profileOpenEvent:"=",shareOpenEvent:"=",impressionEvent:"=",isAttachment:"=",isBoosted:"=",isLast:"<",index:"<",openToCollabEnabled:"<",post:"=",shouldDisplayReactions:"=",replyId:"<",triggeredFrom:"<"},templateUrl:"https://www.bandlab.com/web-app/post/partials/_post-card-efa8a472.html",controller:["$element","$scope","$state","Me","Tag",function(e,t,n,o,r){var i=this;function a(e){const{adEvent:t,adType:n}=function(e){return{...AD[e]}}(e);i[t]&&Promise.resolve().then((()=>ID)).then((function(e){let{logEvent:o}=e;o(i[t],n,i.adEventSource)}))}i.$onInit=function(){i.isBandFollowInitiallyAvailable=i.post.band&&"None"===i.post.band.followingState,i.post.revision&&(i.post.revision.postId=i.post.id,i.post.revision.isExplicit=i.post.isExplicit),i.ctaFollowFormat=i.isBoosted&&"follow_cta_feed"===i.creativeFormat,i.isFollowButtonAvailable="None"===i.post.creator.followingState,i.triggeredFrom??=_p(n,e),i.displayComments=!angular.isDefined(i.displayComments)||i.displayComments,i.postMaxCharacters=o.isBetaUser?2500:250,Promise.all([Mp(o,"feed_hide_play_count"),Mp(o,"follow_bands_enabled")]).then((e=>{let[t,n]=e;i.shouldHideVideoPlayCounts="true"===t,i.isFollowBandsEnabled="true"===n})),Mp(o,"open_to_collab_enabled").then((e=>{i.isOpenToCollabEnabled="true"===e})),Mp(o,"band_permissions_update_enabled").then((e=>{i.isBandPermissionsUpdateEnabled="true"===e}))},i.me=o,i.updateCounter=function(e){i.post.counters.comments=e(i.post.counters.comments)},i.onClick=function(){a("click")},i.onComment=function(){a("comment")},i.onFollow=function(){a("follow")},i.onLike=function(){a("like")},i.onPlay=function(){a("play")},i.onShareOpen=function(){a("shareOpen")},i.onProfileOpen=function(){a("profile")},i.onImpression=function(){Promise.resolve().then((()=>rb)).then((function(e){let{logPostImpression:t,logFeedThirdPostView:o,logFeedTenthPostView:r}=e;t(i.post,i.triggeredFrom),2===i.index?o(n):9===i.index&&r(n)})),i.impressionEvent&&Promise.resolve().then((()=>ID)).then((function(e){let{logEvent:t}=e;t(i.impressionEvent,"impression",i.adEventSource)}))},i.isBandFollowAvailable=function(){return i.isFollowBandsEnabled&&i.isBandFollowInitiallyAvailable&&!n.is("feed.following")&&!i.post.band.isMember&&!i.isBoosted&&!i.post.isBoosted&&(i.post.isPostedAsBand||i.post.band&&i.post.revision)},r.getGenres().then((function(e){t.genres=e})),t.$on("$user:relationChanged",(function(e,t){let{user:n,type:o}=t;n.username===i.post.creator.username&&["follow","unfollow"].includes(o)&&(i.post.creator.followingState=n.followingState,i.post.creator.isFollower=n.isFollower)})),t.$on("$albumTrack:changed",(function(e,n){n.id===i.post.id&&(i.post.caption=n.caption,i.post.revision.song.name=n.track.name,i.post.revision.song.picture=n.track.picture,i.post.track.picture=n.track.picture,i.post.track.name=n.track.name,i.post.state=n.state,i.post.isExplicit=n.isExplicit,i.post.revision.genres=t.genres.filter((e=>e.id===n.track.genreId)))})),t.$on("$post:reactionChanged",(function(e,t){let{post:n}=t;n.id===i.post.id&&(i.post.initiatorReaction=n.initiatorReaction,i.post.counters.reactions=n.counters.reactions,i.post.reactions=n.reactions)}))}],controllerAs:"vm"}).controller("PostShareCtrl",["$element","$scope","$state",function(e,t,n){t.getOrigin=()=>_p(n,e),t.sendInsights=function(e,t,n){Promise.resolve().then((()=>rb)).then((function(o){let{logPostShare:r}=o;r(e,t,n)}))}}]),angular.module("bandlab.post").component("postCardSmall",{bindings:{post:"<",triggeredFrom:"<"},templateUrl:"https://www.bandlab.com/web-app/post/partials/_post-card-small-ed469b3a.html",controller:"PostCtrl",controllerAs:"vm"}),angular.module("bandlab.post").component("postTileSocial",{bindings:{onEngagementEvent:"&",onLikeEvent:"&",onShareOpenEvent:"&",post:"=",isBoosted:"=",shouldDisplayReactions:"=",shouldHideVideoPlayCounts:"=",revision:"=",triggeredFrom:"<"},templateUrl:"https://www.bandlab.com/web-app/post/partials/_post-tile-social-c58d9b12.html",controller:["$scope","appActions","AppNotifications","Me","Modal","User",function(e,t,n,o,r,i){const a=this;e.$on("views",((e,t)=>{const{id:n,views:o}=t;if(a.post.video&&a.post.video.id===n)return a.post.video.counters.views=o,i.videoViews({videoId:n}).$promise})),a.me=o,a.getLikers=function(e){return Object.assign(e,{entity:"posts",entityId:a.post.id}),i.likersWithCursor(e).$promise},a.getReactors=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2?arguments[2]:void 0;return Object.assign(e,{entity:"posts",postCompositeId:a.post.postCompositeId,userId:o.id,limit:t,after:n}),i.reactionsWithCursor(e).$promise},Mp(o,"gift_boost_post_enabled").then((e=>{a.isGiftBoostPostEnabled="true"===e})),a.$onInit=function(){a.shouldShowPromote="Revision"===a.post.type&&a.post.creator.id===a.me.id}}],controllerAs:"vm"}),angular.module("bandlab.post").component("postAttachmentSocial",{bindings:{post:"="},templateUrl:"https://www.bandlab.com/web-app/post/partials/_post-attachment-social-597e61c6.html",controllerAs:"vm"}),angular.module("bandlab.post").directive("textPostInput",["ChatHelper",function(e){return{restrict:"A",require:"ngModel",link:function(t,n,o,r){const i=new WeakSet;r.$viewChangeListeners.push(ay((()=>{const n=r.$viewValue;t.post.link||["Image","Video"].includes(t.post.type)||(t.post.pending=!0,e.getLinkPreview(n).then((function(e){let[o]=e;n===t.post.caption&&(t.post.link=o&&!i.has(o)&&o.object||null,o&&i.add(o))})).finally((function(){delete t.post.pending})))}),1e3,{leading:!0}))}}}]),angular.module("bandlab.post.routes",["ui.router"]).config(["$stateProvider",function(e){e.state("postNew",{url:"/post/new?caption&link",template:"",controller:["$compile","$stateParams","ChatHelper","Me","Post",function(e,t,n,o,r){function i(t){const n=angular.element('\n              <textarea\n                class="no-validate"\n                name="caption"\n                msd-elastic\n                autofocus\n                ng-model="post.caption"\n                ng-model-options="{ allowInvalid: true }"\n                ng-trim="false"\n                placeholder="Whats new?"\n                spellcheck="true"\n                aria-multiline="true"\n                aria-label="Whats new?"\n                search-suggestions\n                bl-choose-suggestion-callback="completeMention(suggestion)"\n                bl-history="false"\n                bl-suggestions="suggestions"\n                bl-template="https://www.bandlab.com/web-app/search/partials/_search-suggestions-97848614.html"\n                gramm_editor="false"\n                text-post-input>\n              </textarea>\n            ');return e(n)(t),n}Promise.all([import("./chunk-4f7d777b.js"),Promise.resolve().then((()=>Tg)),t.link?n.getExternalUrl(t.link).then((e=>{let[t]=e;return t})).catch((()=>({}))):{}]).then((async function(e){let[{default:n},{createModal:a},{object:s}]=e;const l=Vt(!1),c=Vt({canEdit:!0,caption:t.caption??"",...s?{link:s}:{},type:s?"Link":"Text"});a(n,{allowBackground:!1,allowMedia:!1,compileTextarea:i,entity:o,entityType:"user",isSubmitting:l,post:c,onSubmit:()=>{l.value=!0,r.createPost({caption:c.value.caption,entity:"users",id:o.id,link:c.value.link}).$promise.then((function(e){const t=e.link&&e.link.url.includes("airbit.com")?{airbit_share:!0}:{},n=c.link?"link":"text";return Promise.all([Promise.resolve().then((()=>rb)).then((function(o){let{logPostCreate:r}=o;return r({...t,destination:"feed",post_id:e.id,post_type:n})}))])})).finally((function(){l.value=!1,window.close()}))}})}))}]}).state("post",{url:"/post/{id:[a-zA-Z0-9-_]+}?{commentId:int}&{replyId:int}&{from:string}",params:{rewriteTracking:function(){return()=>"/post"}},templateUrl:"https://www.bandlab.com/web-app/post/views/post-layout-658ff7cd.html",redirectTo:function(e){return e.injector().getAsync("thePost").then((function(t){if("Revision"===t.type||"Track"===t.type)return{state:"track",params:{id:t.id,revId:t.revision.id,commentId:e.params().commentId,replyId:e.params().replyId,from:e.params().from}}}))},resolve:{thePost:["$stateParams","Post","User",function(e,t,n){return t.get({id:e.id}).$promise.then((function(e){return"followingState"in e.creator?e:n.get({id:e.creator.id}).$promise.then((function(t){return e.creator=t,e}))}))}]},onEnter:["Me","Page","thePost",function(e,t,n){let o=n.creator.picture.url,r=n.creator.name;n.isPostedAsBand&&(o=n.band.picture.url,r=n.band.name),t.setMetadata({image:`${o}0x360`,imageHeight:"360",imageWidth:"360",title:`A post by ${r} | BandLab`,description:`${n.caption?`${n.caption} | `:""}Listen to music from ${r} and follow their creative process on BandLab.`}),t.update()}],onExit:["Page",function(e){e.clearMetadata()}],controller:["$injector","$location","$scope","$state","PlayerHistory","Post","thePost","Me",function(e,t,n,o,r,i,a,s){n.post=a,n.postsFromSameCreatorContext=ad(),n.recommendedPostsContext=ad(),n.$on("$post:delete",(function(e,t){a.id===t.post.id&&o.go("user.feed",{username:s.username})})),s.genres?.length&&i.fromRecommendations({userId:s.id,limit:4,genres:s.genres[0].id}).$promise.then((function(e){let{data:t}=e;n.recommendedPosts=t.filter((e=>e.id!==n.post.id)).slice(0,3),r.pushQueueSongs(n.recommendedPosts,n.recommendedPostsContext),n.$on("$destroy",(()=>r.removeQueueContext(n.recommendedPostsContext)))})),(a.isPostedAsBand?i.fromBand({bandId:a.band.id,limit:4,types:"revision"}).$promise:i.getTracksFromUser({userId:a.creator.id,limit:4}).$promise).then((function(e){let{data:t}=e;n.postsFromSameCreator=t.filter((e=>e.id!==n.post.id)).slice(0,3),r.pushQueueSongs(n.postsFromSameCreator,n.postsFromSameCreatorContext,!0),n.$on("$destroy",(()=>r.removeQueueContext(n.postsFromSameCreatorContext)))})),Promise.resolve().then((()=>tv)).then((t=>{let{trackActionsAndPromptTip:o}=t;o(e,n,{user:a.creator,entityId:a.id})}))}]}).state("post.boost",{url:"/boost",redirectTo:function(e){if(e.injector().get("appActions").checkAllowed("boost"))return e.injector().getAsync("thePost").then((function(e){if(!e.canEdit)return"post"}))}}).state("post.boost.history",{url:"/history",redirectTo:"post.boost.history.recent"}).state("post.boost.history.recent",{url:"/recent"}).state("post.shout",{url:"/shout",reloadOnSearch:!1,resolve:{thePost:["$stateParams","Post",function(e,t){return t.get({id:e.id}).$promise}]},onEnter:DL,onExit:jL,views:{"overlay@":{templateUrl:"https://www.bandlab.com/web-app/shout/views/shout-image-view-922d75e9.html",controller:["$scope","$state","thePost","Me",function(e,t,n,o){e.post=n,e.$on("$post:delete",(function(e,r){n.id===r.post.id&&t.go("user.feed",{username:o.username})})),e.updateCounter=function(t){e.post.counters.comments=t(e.post.counters.comments)}}]}}})}]),angular.module("bandlab.post").factory("Post",["$cacheFactory","$http","$resource",function(e,t,n){var o="https://www.bandlab.com/api/v1.3/posts",r=e("TracksCache");const i=n(o,{},{delete:{method:"DELETE",params:{id:"@id"},url:`${o}/:id`},explore:{method:"GET",preservePagination:!0},exploreGenre:{method:"GET",preservePagination:!0,url:"https://www.bandlab.com/api/v1.3/genres/:genres/posts"},exploreGenreTrending:{method:"GET",preservePagination:!0,url:"https://www.bandlab.com/api/v1.3/genres/:genres/posts/trending"},exploreGeolocatedTracks:{method:"GET",url:"https://www.bandlab.com/api/v1.3/explore/geolocated/track-posts",transformResponse:[...t.defaults.transformResponse,function(e,t,n){return 200===n&&e.items.forEach((function(e){l(e,0,n)})),e}]},exploreTrendingVideos:{method:"GET",isArray:!0,url:"https://www.bandlab.com/api/v1.3/explore/trending-videos"},fromRecommendations:{method:"GET",preservePagination:!0,url:"https://www.bandlab.com/api/v1.3/users/:userId/recommendations/posts",transformResponse:[...t.defaults.transformResponse,a],interceptor:{request:function(e){return e.url=e.url.replace("users/00000000-0000-0000-0000-000000000000/",""),e}}},fromForYou:{method:"GET",preservePagination:!0,url:"https://www.bandlab.com/api/v1.3/users/:userId/feeds/for-you/posts",transformResponse:[...t.defaults.transformResponse,a],interceptor:{request:function(e){return e.headers={"x-reactions-enabled":e.params.xReactionsEnabled},delete e.params.xReactionsEnabled,e}}},fromTrending:{method:"GET",preservePagination:!0,url:"https://www.bandlab.com/api/v1.3/users/:userId/feeds/trending/posts",interceptor:{request:function(e){return e.headers={"X-Ad-Service":e.params.xAdService,"x-reactions-enabled":e.params.xReactionsEnabled},delete e.params.xReactionsEnabled,delete e.params.xAdService,e}}},fromTrendingExperiment:{method:"GET",preservePagination:!0,url:"https://www.bandlab.com/api/v1.3/experiment/users/:userId/feeds/trending/posts",interceptor:{request:function(e){return e.headers={"X-Ad-Service":e.params.xAdService,"x-reactions-enabled":e.params.xReactionsEnabled},delete e.params.xReactionsEnabled,delete e.params.xAdService,e}}},fromBand:{method:"GET",params:{bandId:"@bandId",types:"revision;image;video;text;link"},preservePagination:!0,url:"https://www.bandlab.com/api/v1.3/bands/:bandId/posts",transformResponse:[...t.defaults.transformResponse,a]},fromCommunity:{method:"GET",params:{communityId:"@communityId",types:"revision;image;video;text;link"},preservePagination:!0,url:"https://www.bandlab.com/api/v1.3/communities/:communityId/posts"},fromContest:{method:"GET",preservePagination:!0,url:"https://www.bandlab.com/api/v1.3/contests/:contestId/posts",transformResponse:[...t.defaults.transformResponse,a]},fromFollowees:{method:"GET",params:{userId:"@userId",types:"revision;image;video;text;link;show"},interceptor:{request:function(e){return e.headers={"x-reactions-enabled":e.params.xReactionsEnabled},delete e.params.xReactionsEnabled,e}},preservePagination:!0,url:"https://www.bandlab.com/api/v1.3/users/:userId/feeds/following/posts"},fromRevisionForks:{method:"GET",params:{revisionId:"@revisionId",types:"revision"},preservePagination:!0,url:"https://www.bandlab.com/api/v1.3/revisions/:revisionId/forks/posts"},fromSong:{method:"GET",params:{songId:"@songId",limit:50},preservePagination:!0,url:"https://www.bandlab.com/api/v1.3/songs/:songId/posts"},fromUser:{method:"GET",params:{userId:"@userId",types:"revision;image;video;text;link",excludePinned:"@excludePinned"},interceptor:{request:function(e){return e.headers={"x-reactions-enabled":e.params.xReactionsEnabled},delete e.params.xReactionsEnabled,e}},preservePagination:!0,url:"https://www.bandlab.com/api/v1.3/users/:userId/posts"},get:{method:"GET",params:{id:"@id",sharedKey:"@sharedKey"},url:`${o}/:id`,transformResponse:[...t.defaults.transformResponse,l]},getPostAlbums:{method:"GET",isArray:!0,params:{id:"@id"},url:`${o}/:id/albums`},liked:{method:"GET",params:{id:"@userId",limit:5,types:"revision;image;video;text"},preservePagination:!0,url:"https://www.bandlab.com/api/v1.3/users/:userId/likes/posts"},postReaction:{method:"POST",params:{userId:"@userId",postCompositeId:"@postCompositeId"},url:"https://www.bandlab.com/api/v1.3/posts/:postCompositeId/reactions/users/:userId"},updateReaction:{method:"PATCH",params:{userId:"@userId",postCompositeId:"@postCompositeId"},url:"https://www.bandlab.com/api/v1.3/posts/:postCompositeId/reactions/users/:userId"},deleteReaction:{method:"DELETE",params:{userId:"@userId",postCompositeId:"@postCompositeId"},url:"https://www.bandlab.com/api/v1.3/posts/:postCompositeId/reactions/users/:userId"},update:{method:"PATCH",params:{id:"@id"},url:`${o}/:id`},createImagePost:{method:"POST",params:{imageId:"@imageId"},url:"https://www.bandlab.com/api/v1.3/images/:imageId/posts"},createVideoPost:{method:"POST",params:{videoId:"@videoId"},url:"https://www.bandlab.com/api/v1.3/videos/:videoId/posts"},createPost:{method:"POST",params:{id:"@id",entity:"@entity"},url:"https://www.bandlab.com/api/v1.3/:entity/:id/posts"},pinPost:{method:"POST",params:{id:"@id",entityType:"@entityType",entityId:"@entityId"},url:"https://www.bandlab.com/api/v1.3/:entityType/:entityId/pins/posts/:id"},unpinPost:{method:"DELETE",params:{id:"@id",entityType:"@entityType",entityId:"@entityId"},url:"https://www.bandlab.com/api/v1.3/:entityType/:entityId/pins/posts/:id"},getNewPrivateLink:{method:"POST",params:{id:"@id"},url:`${o}/:id/sharings`},getPrivateLink:{method:"GET",params:{id:"@id"},url:`${o}/:id/sharings`},getTracksFromUser:{method:"GET",params:{userId:"@userId"},preservePagination:!0,url:"https://www.bandlab.com/api/v1.3/users/:userId/track-posts",transformResponse:[...t.defaults.transformResponse,function(e,t,n){return 200===n&&e.data.forEach((function(e){l(e,0,n)})),e}]},getTracksFromUserSorted:{method:"GET",params:{userId:"@userId",sort:"@sort"},cache:r,preservePagination:!0,url:"https://www.bandlab.com/api/v1.3/users/:userId/track-posts",transformResponse:[...t.defaults.transformResponse,function(e,t,n){return 200===n&&e.data.forEach((function(e){l(e,0,n)})),e}]},getTopTracksFromUser:{method:"GET",params:{userId:"@userId"},isArray:!0,url:"https://www.bandlab.com/api/v1.3/users/:userId/top-track-posts",transformResponse:[...t.defaults.transformResponse,function(e,t,n){return 200===n&&e.forEach((function(e){l(e,0,n)})),e}]},getLibraryTracksFromUser:{method:"GET",params:{userId:"@userId"},preservePagination:!0,url:"https://www.bandlab.com/api/v1.3/users/:userId/library/track-posts",transformResponse:[...t.defaults.transformResponse,function(e,t,n){return 200===n&&e.data.forEach((function(e){l(e,0,n)})),e}]},updateTrack:{method:"PATCH",params:{id:"@id"},url:"https://www.bandlab.com/api/v1.3/track-posts/:id"},hideCreatorFromTrending:{method:"PUT",params:{userId:"@userId",creatorId:"@creatorId"},url:"https://www.bandlab.com/api/v1.3/users/:userId/feeds/trending/hidden-creators/:creatorId"}});return Object.assign(i,{explorePosts:function(e,n){return t({method:"GET",preservePagination:!0,url:"https://www.bandlab.com/api/v1.3/explore/posts",timeout:e.promise,params:n}).then((e=>{let{data:t}=e;return t}))}});function a(e,t,n){return 200===n&&e.data.forEach(s),e}function s(e){e.revision&&(e.revision.postId=e.id)}function l(e,t,n){return 200===n&&kD(e),e}}]),angular.module("bandlab.product.routes",["ui.router"]).config(["$stateProvider",function(e){e.state("products",{url:"/products",redirectTo:"products.cakewalk"}).state("redirectAssistant",{url:"/assistant",redirectTo:"products.assistant"}).state("products.assistant",{url:"/desktop/assistant",templateUrl:"https://www.bandlab.com/web-app/product/views/assistant-layout-294e224a.html",controller:["$element","$scope",function(e,t){const n=document.querySelector("#assistant-upload"),o=new IntersectionObserver((function(e){let[t]=e;t.intersectionRatio>.8&&(n.classList.add("became-active"),o.disconnect())}),{threshold:1});o.observe(n),t.download=function(e){fetch("windows"===e?"https://static.bandlab.com/assistant/latest.yml":"https://static.bandlab.com/assistant/latest-mac.yml").then((function(e){return e.text()})).then((function(t){const[,n]=t.match(/version: ((.)+)/);window.location.href="windows"===e?`https://static.bandlab.com/assistant/BandLab Assistant Setup ${n}.exe`:`https://static.bandlab.com/assistant/BandLab Assistant-${n}.dmg`}))},import("./chunk-a1fb015b.js").then((function(n){let{mountAssistant:o}=n;const r=o(e[0].querySelector("#vue"));t.$on("$destroy",(function(){r.unmount()}))}))}]}).state("beats",{url:"/beats",template:'<div id="vue"></div>',controller:["$element","$injector","$scope","$state","authService","Me",function(e,t,n,o,r,i){Promise.all([import("./chunk-e1e29e5c.js").then((e=>{let{mountBeatsLanding:t}=e;return t})),import("./chunk-62514720.js").then((e=>{let{detectAvif:t}=e;return t()}))]).then((function(a){let[s,l]=a;const c=s(e[0].querySelector("#vue"),{$injector:t,authService:r,hasAvif:l,state:o,Me:i});n.$on("$destroy",(function(){c.unmount()}))}))}]}).state("boost",{url:"/boost",template:'<div id="vue"></div>',controller:["$element","$scope","$injector","appActions","AppNotifications","authService","Loader","Me","Modal","Revision","Song",function(e,t,n,o,r,i,a,s,l,c,u){Promise.all([import("./chunk-c7fc82c7.js").then((e=>{let{mountBoostLanding:t}=e;return t})),import("./chunk-62514720.js").then((e=>{let{detectAvif:t}=e;return t()})),Promise.resolve().then((()=>Bu)).then((e=>{let{getBoostContentful:t}=e;return t()}))]).then((function(d){let[p,m,f]=d;const h=p(e[0].querySelector("#vue"),{authService:i,contentful:f,hasAvif:m,$injector:n,Me:s,scope:t});t.$on("$destroy",(async function(){await async function(){return(await h).unmount()}()})),t.getPromote=function(){o.checkAllowed("getPromote",{toState:"getPromote"})&&t.openLibraryModal()};let g={},v={};function b(e){const t=`https://zire.com/onboarding/review-release?revision_id=${e.id}`;window.open(t,"_blank")}t.loadMore=function(){return g.get().then((function(e){return t.infiniteScrollEnded=e.length<10,t.projects=t.projects||[],t.projects=t.projects.concat(e),e}))},t.$on("$revision:changed",(function(e,t){let{revision:n}=t;v&&v.destroy(),b(n)})),t.openLibraryModal=function(){v=new l({templateUrl:"https://www.bandlab.com/web-app/crowdreview/partials/_crowd-review-library-256cd61f.html",contentScope:{me:s,projects:()=>t.projects,zireValid:!0,selectProjectToReview:async e=>{const t=await async function(e){return await u.get({id:e.id}).$promise.then((e=>c.get({id:e.revision.id}).$promise))}(e);uN(t,null,r)&&b(t)},loadMore:t.loadMore},onCreate:function(){g=a.create(u.fromUserWithCursor,{id:s.id,limit:10}),t.infiniteScrollEnded=!1,t.loadMore()},onDestroy:function(){t.projects=null}}),v.show()}}))}]}).state("beatsDownloadRedirect",{url:"/beats/download",redirectTo:"beatsDownload"}).state("beatsDownload",{url:"/beats-download",template:'<div id="vue"></div>',controller:["$element","$scope","Me",function(e,t,n){import("./chunk-9b96e04b.js").then((function(o){let{mountBeatsDownloadPage:r}=o;const i=r(e[0].querySelector("#vue"),{Me:n});t.$on("$destroy",(function(){i.unmount()}))}))}]}).state("products.cakewalk",{url:"/cakewalk",templateUrl:"https://www.bandlab.com/web-app/product/views/cakewalk-layout-d80471af.html",resolve:{loadCakewalkFonts:OG}}).state("products.cakewalkWhatsNew",{url:"/cakewalk/whats-new",templateUrl:"https://www.bandlab.com/web-app/product/views/cakewalk-whatsnew-layout-49f18378.html",resolve:{theChangelog:["$http",function(e){return e.get("https://bandlab.github.io/cakewalk-changelog/changelog.json").then((e=>{let{data:t}=e;return t}))}]},controller:["$scope","theChangelog",function(e,t){e.changelog=t}]}).state("audiostretch",{url:"/audiostretch",redirectTo:function(){if(!Zf)return"unavailable";window.location.href="https://blog.bandlab.com/what-is-audiostretch-and-how-do-i-use-it/"}}).state("redirectCakewalk",{url:"/cakewalk",redirectTo:"products.cakewalk"}).state("soundsroot",{url:"/sounds",redirectTo:"sounds"}).state("sounds",{url:"/sounds/:path/:subpath/:innerSubpath?id&characters&instruments&genres&packId&query&bpm&keys&features&sort&direction&code",params:{path:"browse",subpath:{squash:!0,value:null},innerSubpath:{squash:!0,value:null}},template:'<div id="vue"></div>',controller:["$analytics","$element","$compile","$http","$injector","$rootScope","$scope","$state","$urlRouter","appActions","AppNotifications","AudioStretch","authService","Me","Modal","Page","Player","ProjectUploader","Share","User","UserHelper",function(e,t,n,o,r,i,a,s,l,c,u,d,p,m,f,h,g,v,b,y,w){function $(e,t,n){new f({id:"sharePackModal",templateUrl:"https://www.bandlab.com/web-app/sounds/partials/_sounds-share-pack-modal-4ab98c45.html",contentScope:{title:e,imageUrl:bS(t,wS,80),shareUrl:window.location.href,sharePack:n}}).show()}function k(){return new Promise((function(e,t){new f({templateUrl:"https://www.bandlab.com/web-app/sounds/partials/_sounds-sampler-confirmation-modal-f8c724fc.html",confirmLabel:"Discard Changes",cancelLabel:"Keep editing",contentScope:{title:"Close Sample Editor?",message:"All your changes will be lost."},onConfirm:e,onCancel:t}).show()}))}function S(e,t,n){new f({id:"paywallModal",templateUrl:"https://www.bandlab.com/web-app/membership/partials/_paywall-modal-ee6789e7.html",contentScope:{useCheckoutModal:!0,checkoutSuccess:()=>n(),productAttribution:e,productAttributionGroup:"my_sounds"},onCancel:function(){t()}}).show()}!m.isAnonymous()||"browse"!==s.params.path&&"home"!==s.params.path||document.body.classList.add("sounds-home"),Promise.all([Promise.resolve().then((()=>Wk)).then((e=>{let{mountSounds:t}=e;return t})),import("./chunk-62514720.js").then((e=>{let{detectAvif:t}=e;return t()}))]).then((async function(f){let[_,P]=f;l.listen(!1);const M=_(t[0].querySelector("#vue"),{$analytics:e,$compile:n,$http:o,$injector:r,$rootScope:i,appActions:c,AppNotifications:u,AudioStretch:d,authService:p,hasAvif:P,Me:m,askConfirmationForClosingEditor:k,showPaywallModal:S,showSharePackModal:$,Page:h,Player:g,ProjectUploader:v,Share:b,scope:a,state:s,$urlRouter:l,User:y,UserHelper:w});a.$on("$destroy",(function(){M.unmount(),l.listen(!0),document.body.classList.forEach((function(e){e.startsWith("sounds-")&&document.body.classList.remove(e)}))}))})),m.isAnonymous()||(dS.value=!0,Promise.all([I$({userId:m.id}),E$({userId:m.id})]).then((e=>{let[t,n]=e;mS.value=t.ids,pS.value=n.ids})).finally((()=>{dS.value=!1})),fS.value=!0,A$({userId:m.id}).then((e=>{e&&(hS.value=[...e])})).finally((()=>{fS.value=!1})))}],resolve:{templates:["$templateCache","$templateRequest","$q",function(e,t,n){return n.all([t("https://www.bandlab.com/web-app/global/partials/_site-top-bar-sounds-ae9a347b.html"),t("https://www.bandlab.com/web-app/global/partials/_site-tab-bar-1c9bfab9.html")]).then((function(t){t.forEach(e.put)})).catch((function(){}))}]}}).state("distribution",{url:"/distribution",template:'<div id="vue"></div>',controller:["$element","$injector","$scope","appActions","authService","Me",function(e,t,n,o,r,i){Promise.all([import("./chunk-e01967e7.js").then((e=>{let{mountDistribution:t}=e;return t})),import("./chunk-62514720.js").then((e=>{let{detectAvif:t}=e;return t()})),Promise.resolve().then((()=>Du)).then((e=>{let{getLandingPageDistribution:t}=e;return t()}))]).then((function(a){let[s,l,c]=a;const u=s(e[0].querySelector("#vue"),{$injector:t,appActions:o,authService:r,hasAvif:l,Me:i,contentful:c});n.$on("$destroy",(function(){u.unmount()}))}))}]}).state("effects",{url:"/effects",redirectTo:"fx"}).state("fanReach",{url:"/fan-reach",controller:["$element","$injector","$scope","authService","appActions","Me","$state",function(e,t,n,o,r,i,a){const s=Promise.all([import("./chunk-91644797.js").then((e=>{let{mountFanReach:t}=e;return t})),import("./chunk-62514720.js").then((e=>{let{detectAvif:t}=e;return t()})),Promise.resolve().then((()=>Du)).then((e=>{let{getLandingPageFanReach:t}=e;return t()}))]).then((function(s){let[l,c,u]=s;return l(e[0],{$injector:t,$scope:n,authService:o,appActions:r,contentful:u,hasAvif:c,Me:i,$state:a})}));n.$on("$destroy",(function(){s.then((e=>{let{unmount:t}=e;return t()}))}))}]}).state("fx",{url:"/fx",template:'<div id="vue"></div>',resolve:{willSeeNewPresets:["Me","EditorState",function(e,t){if(!e.isAnonymous())return Gg(e.id,{fallbackToFree:!0,useCache:!0}).then((e=>{t.hasMembership=t.isUnderAutoPitchExperiment="Free"!==e.plan&&!1}));t.hasMembership=t.isUnderAutoPitchExperiment=!1}]},controller:["$compile","$element","$injector","$rootScope","$scope","$state","authService","Me",function(e,t,n,o,r,i,a,s){Promise.all([import("./chunk-66b50847.js").then((e=>e.F)).then((e=>{let{mountFx:t}=e;return t})),import("./chunk-62514720.js").then((e=>{let{detectAvif:t}=e;return t()}))]).then((function(l){let[c,u]=l;const d=c(t[0].querySelector("#vue"),{authService:a,$compile:e,hasAvif:u,$injector:n,$rootScope:o,scope:r,$state:i,Me:s});r.$on("$destroy",(function(){d.unmount()}))})).catch((e=>{}))}]}).state("fxPreset",{url:"/fx-preset",controller:["$compile","$element","$injector","$rootScope","$scope","$state","authService","Me",function(e,t,n,o,r,i,a,s){const l=Promise.all([import("./chunk-66b50847.js").then((e=>e.F)).then((e=>{let{mountFxPreset:t}=e;return t})),import("./chunk-62514720.js").then((e=>{let{detectAvif:t}=e;return t()}))]).then((function(l){let[c,u]=l;return c(t[0],{$compile:e,$element:t,$injector:n,$rootScope:o,$scope:r,$state:i,authService:a,hasAvif:u,Me:s})}));r.$on("$destroy",(function(){l.then((e=>{let{unmount:t}=e;return t()}))}))}]}).state("splitter",{url:"/splitter/:state",isCompatible:()=>oh(!1),params:{state:{squash:!0,value:null}},template:'<div id="vue"></div>',controller:["$element","$http","$injector","$rootScope","$scope","$state","$analytics","appActions","authService","Me","Modal","Player",function(e,t,n,o,r,i,a,s,l,c,u,d){Promise.all([import("./chunk-1e57610f.js").then((e=>{let{mountSplitterLandingPage:t}=e;return t})),import("./chunk-62514720.js").then((e=>{let{detectAvif:t}=e;return t()}))]).then((function(t){let[i,a]=t;const s=i(e[0].querySelector("#vue"),{$injector:n,authService:l,hasAvif:a,$rootScope:o,scope:r,Me:c,Modal:u,Player:d});r.$on("$destroy",(function(){s.unmount()}))}))}]}).state("crowdReview",{url:"/crowd-review",template:'<div id="vue"></div>',controllerAs:"vm",controller:["$element","$injector","$scope","appActions","AppNotifications","authService","Loader","Me","Modal","Song",function(e,t,n,o,r,i,a,s,l,c){Promise.all([import("./chunk-40b10cd1.js").then((e=>{let{mountCrowdReview:t}=e;return t})),import("./chunk-62514720.js").then((e=>{let{detectAvif:t}=e;return t()}))]).then((function(u){let[d,p]=u;const m=d(e[0].querySelector("#vue"),{$injector:t,authService:i,hasAvif:p,Me:s,Modal:l,scope:n});n.$on("$destroy",(function(){m.unmount()})),n.getReviews=function(){o.checkAllowed("getReviews",{toState:"crowdReview"})&&n.openLibraryModal()};const f=a.create(c.fromUserWithCursor,{id:s.id,limit:10});n.infiniteScrollEnded=!1,n.loadMore=function(){return f.get().then((function(e){return n.infiniteScrollEnded=e.length<10,n.projects=n.projects||[],n.projects=n.projects.concat(e),e}))},n.openLibraryModal=function(){new l({templateUrl:"https://www.bandlab.com/web-app/crowdreview/partials/_crowd-review-library-256cd61f.html",contentScope:{me:s,projects:()=>n.projects,selectProjectToReview:async e=>{const t=await async function(e){return await c.get({id:e.id}).$promise.then((e=>e.revision))}(e);if(!cN(t,null,r))return;const n=`https://www.reverbnation.com/c/bandlab/crowd_review/${s.id}?revision_id=${t.id}`;window.open(n,"_blank")},loadMore:n.loadMore},onCreate:function(){n.loadMore()}}).show()}}))}]}).state("promoteIt",{url:"/promote-your-track",template:'<div id="vue"></div>',controllerAs:"vm",controller:["$element","$injector","$scope","appActions","AppNotifications","authService","Loader","Me","Modal","Revision","Song",function(e,t,n,o,r,i,a,s,l,c,u){Promise.all([import("./chunk-dcca2009.js").then((e=>{let{mountPromoteIt:t}=e;return t})),import("./chunk-62514720.js").then((e=>{let{detectAvif:t}=e;return t()}))]).then((function(d){let[p,m]=d;const f=p(e[0].querySelector("#vue"),{$injector:t,authService:i,hasAvif:m,Me:s,Modal:l,scope:n});n.$on("$destroy",(function(){f.unmount()})),n.getPromote=function(){o.checkAllowed("getPromote",{toState:"getPromote"})&&n.openLibraryModal()};let h={},g={};function v(e){const t=`https://zire.com/onboarding/review-release?revision_id=${e.id}`;window.open(t,"_blank")}n.loadMore=function(){return h.get().then((function(e){return n.infiniteScrollEnded=e.length<10,n.projects=n.projects||[],n.projects=n.projects.concat(e),e}))},n.$on("$revision:changed",(function(e,t){let{revision:n}=t;g&&g.destroy(),v(n)})),n.openLibraryModal=function(){g=new l({templateUrl:"https://www.bandlab.com/web-app/crowdreview/partials/_crowd-review-library-256cd61f.html",contentScope:{me:s,projects:()=>n.projects,zireValid:!0,selectProjectToReview:async e=>{const t=await async function(e){return await u.get({id:e.id}).$promise.then((e=>c.get({id:e.revision.id}).$promise))}(e);uN(t,null,r)&&v(t)},loadMore:n.loadMore},onCreate:function(){h=a.create(u.fromUserWithCursor,{id:s.id,limit:10}),n.infiniteScrollEnded=!1,n.loadMore()},onDestroy:function(){n.projects=null}}),g.show()}}))}]}).state("jobs",{url:"/jobs",redirectTo:"careers"}).state("careers",{url:"/careers?search&team",template:'<div id="vue"></div>',controller:["$element","$injector","$scope","authService","Me",function(e,t,n,o,r){Promise.all([import("./chunk-8e792c7e.js").then((e=>{let{mountCareers:t}=e;return t})),import("./chunk-62514720.js").then((e=>{let{detectAvif:t}=e;return t()}))]).then((function(i){let[a,s]=i;const l=a(e[0].querySelector("#vue"),{$injector:t,hasAvif:s,authService:o,Me:r});n.$on("$destroy",(function(){l.unmount()}))}))}]}).state("membership",{url:"/membership",controller:["$element","$injector","$scope","appActions","authService",function(e,t,n,o,r){const i=Promise.all([import("./chunk-cdaa2c58.js").then((e=>{let{mountMembershipHome:t}=e;return t})),import("./chunk-62514720.js").then((e=>{let{detectAvif:t}=e;return t()})),Promise.resolve().then((()=>Du)).then((e=>{let{getLandingPageMembership:t}=e;return t()}))]).then((function(i){let[a,s,l]=i;return a(e[0],{$injector:t,$scope:n,contentful:l,hasAvif:s,appActions:o,authService:r})}));n.$on("$destroy",(async function(){(await i).unmount()}))}]})}]);const OG=Ac((function(){const e=document.createElement("link");e.rel="stylesheet",e.href="https://bandlab.github.io/cakewalk-fonts/fonts.css",document.head.appendChild(e)}));function jG(e){return Uu.get(`https://www.bandlab.com/api/v1.3/experiment/users/${e}/purchases/beats`).json()}function DG(e){return Uu.get(`https://www.bandlab.com/api/v1.3/experiment/beats/${e}`).json()}function NG(e,t){Promise.resolve().then((()=>ZD)).then((function(n){let{CODE_NO_EMAIL:o,CODE_UNCONFIRMED_EMAIL:r}=n;if(t.data.errorCode===o||t.data.errorCode===r){const e=zn((()=>import("./chunk-14e15eec.js")));Promise.resolve().then((()=>Tg)).then((function(n){let{createModal:o}=n;o(e,{emailUnconfirmed:t.data.errorCode===r})}))}else e.addNotification({title:t.data?.message||"Something went wrong, please try again later",classList:"alert",autoclose:8e3})}))}function UG(e){const{slug:t,revId:n}=e.params();if(!n)return{state:"404"};const o=e.injector().get("Me"),r=e.injector().get("AppNotifications");return e.injector().getAsync("proList").catch((function(e){return NG(r,e),{state:"userSong",params:{username:o.username,slug:t,revisionId:n}}}))}angular.module("bandlab.beats.routes",["ui.router"]).config(["$stateProvider",function(e){e.state("beatsPurchase",{url:"/beats-purchase/{beatId:[a-zA-Z0-9-_]+}?promoCode&source",template:'\n          <div class="content-main">\n            <loader-wave></loader-wave>\n          </div>\n        ',controller:["$state","$stateParams","AppNotifications",function(e,t,n){DG(t.beatId).then((function(o){return o.isPurchased?e.go("beatsDownload"):Lg("beats","paddle",{beatId:t.beatId,promoCode:t.promoCode}).then((function(n){let{id:o}=n;e.go("checkout",{contentId:t.beatId,paymentIntentId:o,product:"beats",productAttribution:"beats",redirectUrl:encodeURIComponent(JSON.stringify({name:"beatsDownload"})),redirectCancelUrl:encodeURIComponent(JSON.stringify({name:"beats"})),source:t.source,forcePaddle:!0},{location:"replace"})})).catch((function(t){n.addNotification({title:navigator.onLine?"Something went wrong, please try again later":"Check your internet connection and try again",classList:"alert",content:t?.message||"Something went wrong, please try again later",autoclose:8e3}),e.go("0")}))}))}]})}]),angular.module("bandlab.profeedback",["ui.router"]).config(["$stateProvider",function(e){e.state("proFeedback",{url:"/pro-feedback/:slug?revId",redirectTo:UG,resolve:{proList:["ProFeedback",function(e){return e.getList().$promise}],selectedRevision:["$stateParams","Song",function(e,t){const{revId:n}=e;return t.getByRevision({revId:n}).$promise}]},useTopBarForm:!0,hideGlobalPlayer:!0,views:{"":{template:'<div id="vue"></div>',controller:["$compile","$element","$rootScope","$scope","$state","$stateParams","appActions","AppNotifications","Me","ProFeedback","proList","selectedRevision",function(e,t,n,o,r,i,a,s,l,c,u,d){import("./chunk-3d5dff15.js").then((e=>{let{mountFeedback:t}=e;return t})).then((function(p){const m=p(t[0].querySelector("#vue"),{$compile:e,$rootScope:n,appActions:a,AppNotifications:s,Me:l,ProFeedback:c,proList:u,slug:i.slug,selectedRevision:d,revision:i.revId,state:r});o.$on("$destroy",(function(){m.unmount()})),o.$on("topBarExit",(function(){return r.stackSize?window.history.back():r.go("userSong",{username:l.username,slug:i.slug,revId:i.revId})}))}))}]},topBarForm:{templateUrl:"https://www.bandlab.com/web-app/profeedback/partials/_profeedback-form-top-bar-3b812af7.html",controller:["$rootScope","$scope",function(e,t){t.exitPage=function(){e.$broadcast("topBarExit")}}]},tabBarForm:{templateUrl:"https://www.bandlab.com/web-app/profeedback/partials/_profeedback-form-tab-bar-5af2893a.html",controller:["$rootScope","$scope",function(e,t){t.exitPage=function(){e.$broadcast("topBarExit")}}]}},onEnter:["Player",function(e){e.pause()}]})}]),angular.module("bandlab.profeedback").factory("ProFeedback",["$resource",function(e){var t="https://www.bandlab.com/api/v1.3/pro-feedback";return e(t,{},{getList:{method:"GET",isArray:!0,url:`${t}/pros`}})}]),angular.module("bandlab.project",[]),angular.module("bandlab.project").controller("ProjectsCtrl",["$q","$scope","$stateParams","$timeout","Song","theBand","theUser",function(e,t,n,o,r,i,a){var s,l=null,c=!1;function u(){let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.search;if(c)return e.resolve([]);var i={limit:30,after:l,isFork:{forked:!0}[n.filter],isPublic:{public:!0,private:!1}[n.filter],search:o};return s=(s="recent"===t.category?r.fromUserWithCursor(Object.assign(i,{id:a.id})).$promise:"my-projects"===t.category?r.fromUserWithCursor(Object.assign(i,{id:a.id,authorId:a.id})).$promise:"collaborations"===t.category?r.fromUserWithCursor(Object.assign(i,{id:a.id,collaboration:!0})).$promise:"bands"===t.category?r.fromUserWithCursor(Object.assign(i,{id:a.id,author:"band"})).$promise:"deleted"===t.category?r.fromUserWithCursor(Object.assign(i,{id:a.id,status:"deleted"})).$promise:r.fromBandWithCursor(Object.assign(i,{id:t.band.id})).$promise).then((function(e){return c=e.paging.itemsCount<e.paging.limit,l=_.get(e,"paging.cursors.after",0),e.data}))}function d(e){_.find(t.projects,{id:e.id})||("recent"===t.category||"my-projects"===t.category||"band"===t.category&&e.author.id===t.band.id)&&o((function(){return r.get({id:e.id}).$promise}),1e3).then((function(e){t.projects.unshift(e)}))}t.isMobile=Zf,i?(t.band=i,t.category="band"):t.category=n.category,t.loadMore=function(){return t.infiniteScrollEnded?e.resolve():s=s.then((function(e){return t.infiniteScrollEnded=c,t.projects=t.projects||[],t.projects=t.projects.concat(e),u()}))},u().then(t.loadMore),"collaborations"===t.category&&(t.triggeredFrom="user_library_collaborations"),t.refreshSearch=function(e){return l=null,c=!1,u(e).then((function(){return s=s.then((function(e){return t.infiniteScrollEnded=c,t.projects=e,u()}))})).then(t.loadMore)},t.$on("$song:changed",(function(e,n){if(["mark-deleted","unmark-deleted"].includes(n.action)){const e=_.find(t.projects,{id:n.song.id});e&&(e.isDeleting="mark-deleted"===n.action||null)}else{if("move"===n.action&&"recent"===t.category){const e=_.findIndex(t.projects,{id:n.song.id});return Gf(t.projects,{id:n.song.id}),void o((function(){t.projects.splice(e,0,n.song)}),500)}if("delete"===n.action||"leave"===n.action||"move"===n.action||"restore"===n.action)return Gf(t.projects,{id:n.song.id}),void(t.projects.length<30&&t.loadMore());if("update"!==n.action)"create"===n.action&&d(n.song);else{const e=_.find(t.projects,{id:n.song.id});e&&Object.assign(e,n.song)}}})),t.$on("$revision:changed",(function(e,t){"create"===t.action&&d(t.revision.song)}))}]),angular.module("bandlab.project").component("projectAuthor",{bindings:{revision:"<",song:"<",triggeredFrom:"<"},templateUrl:"https://www.bandlab.com/web-app/project/partials/_project-author-64a17f3a.html",controller:["$element","$scope","$state","Me","User",function(e,t,n,o,r){var i=this;i.$onInit=function(){i.triggeredFrom??=_p(n,e)},i.getCollaborators=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r.getCollaborators(Object.assign({songId:i.song.id,includeOwner:!0},e)).$promise},i.hasWebviewCookie=p}],controllerAs:"vm"}),angular.module("bandlab.project").component("projectProfilePopover",{bindings:{song:"<"},template:'\n      <div class="popover-content">\n        <project-tile song="vm.song" class="collapse"></project-tile>\n      </div>\n    ',controllerAs:"vm"}),angular.module("bandlab.project").component("projectsCard",{templateUrl:"https://www.bandlab.com/web-app/project/partials/_projects-card-b318d203.html",controller:["$element","$scope","$timeout","Me","Song",function(e,t,n,o,r){const i=this;r.fromUserWithCursor({id:o.id,limit:3,sort:"recent"}).$promise.then((t=>{let{data:n}=t;n.length||e.remove(),i.songs=n})),t.$on("$song:changed",(function(e,t){if(["mark-deleted","unmark-deleted"].includes(t.action)){const e=_.find(i.songs,{id:t.song.id});e&&(e.isDeleting="mark-deleted"===t.action||null)}else{if("move"===t.action){const e=_.findIndex(i.songs,{id:t.song.id});return Gf(i.songs,{id:t.song.id}),void n((function(){i.songs.splice(e,0,t.song)}),500)}"delete"!==t.action&&"leave"!==t.action||n((()=>{r.fromUserWithCursor({id:o.id,limit:3,sort:"recent"}).$promise.then((e=>{let{data:t}=e;i.songs=t}))}),1500)}}))}],controllerAs:"vm"}),angular.module("bandlab.project").directive("projectsDropzone",["$q","$stateParams","$window","AppNotifications","RevisionImporter",function(e,t,n,o,r){return{restrict:"A",replace:!0,link:function(i,a,s){function l(e){_.chain(e).get("dataTransfer.items",[]).some((e=>e.type.includes("audio"))).value()&&(i.isDragging=!0,i.$applyAsync())}function c(){i.isDragging=!1,i.$applyAsync()}function u(e){return r.isAudioFileValid(e,{loader:!1}).then((function(e){let[t,n]=e;return[t,n]})).catch((t=>[e,null,t]))}(n=angular.element(n)).on("dragover",l),n.on("dragleave",c),a.on("drop",(function(n){var a;n.preventDefault(),n.stopPropagation(),a=n.dataTransfer.files,e.all(Array.from(a).map(u)).then((function(e){const[n,a]=_.partition(e,(function(e){let[,t]=e;return t}));a.length&&o.addNotification({title:"Unable to import file. Please check that your file is not corrupted.",content:`${a.map((e=>{let[t,,n]=e;return`<div style="margin: 4px 0">${t.name}<br>${n.message}<div>`})).join("")}`,classList:"alert"}),_.map(n,(function(e){let[n,o]=e;return function(e,n){if("track"===s.importAs)return r.createTrackFromUploadQueue(e,n);const o=_.find(i.bands,{username:t.category});return r.createRevisionFromUploadQueue(e,{bandId:o?o.id:null,duration:n})}(n,o)}))})),i.isDragging=!1,i.$applyAsync()})),a.on("dragover",(function(e){e.preventDefault(),e.stopPropagation(),i.isDragging=!0,e.dataTransfer.dropEffect="copy",i.$applyAsync()})),a.on("dragleave",(function(){i.isDragging=!1,i.$applyAsync()})),i.$on("$destroy",(function(){n.off("dragover",l),n.off("dragleave",c)}))}}}]);const FG={class:"ds-modal ds-modal-size-small"},BG={class:"ds-modal-header"},WG={class:"ds-modal-title"},VG={class:"ds-modal-content",style:{textAlign:"left"}},qG={key:0,class:"ds-modal-content-p"},zG={key:1,class:"ds-modal-content-p"},HG={class:"ds-modal-footer ds-modal-footer-two-buttons"},GG=Vn({__name:"ProjectCopyrightModal",props:{song:{}},emits:["closeModal"],setup(e){const t=Zo("$injector").get("Me"),n=e;return(e,o)=>(si(),pi("section",FG,[bi("header",BG,[bi("h2",WG,me("Copyright Notice"),1)]),bi("section",VG,[n.song.author.id===t.id?(si(),pi("p",qG,me(`Your project ${e.song.name} has been disabled at the request of the copyright owner. Only you can see this project.\n\nPlease check your BandLab registered email to submit an appeal.`),1)):n.song.collaborators.some((e=>t.id===e.id&&"Owner"!==e.role))?(si(),pi("p",zG,me(`Your collaboration project, ${e.song.name}, has been disabled at the request of the copyright owner. Only the project owner can submit an appeal.`),1)):_i("v-if",!0)]),bi("footer",HG,[yi(Dd,{as:"a",size:"medium",padding:"default",color:"secondary",href:"https://blog.bandlab.com/learn-about-copyright/",target:"_blank"},{default:Tn((()=>[ki(me("Learn More"),1)])),_:1}),yi(Dd,{type:"button",size:"medium",padding:"default",color:"primary",onClick:o[0]||(o[0]=t=>e.$emit("closeModal"))},{default:Tn((()=>[ki(me("Got It"),1)])),_:1})]),yi(ib,{onClick:o[1]||(o[1]=t=>e.$emit("closeModal"))})]))}});angular.module("bandlab.project").component("projectTile",{bindings:{song:"<",triggeredFrom:"<"},templateUrl:"https://www.bandlab.com/web-app/project/partials/_project-tile-50246f5b.html",controller:["User","Me",function(e,t){const n=this;n.$onInit=async function(){const e=await Mp(t,"distro_user_library");n.shouldShowDistroInUserLibrary="on"===e||"true"===e,n.hasMembership="Free"!==(await Gg(t.id,{fallbackToFree:!0,useCache:!0})).plan,n.hasDuplicateProjectsFlag="true"===await Mp(t,"studio_duplicate_projects")},n.getCanDuplicate=function(){const e=n.song,o=e.author.id===t.id&&"User"===e.author.type&&0===e.counters.collaborators;return e.canEdit&&o&&!e.isFork&&n.hasDuplicateProjectsFlag&&n.hasMembership},n.getCollaborators=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.getCollaborators(Object.assign({songId:n.song.id,includeOwner:!0},t)).$promise},n.displayDMCAModal=function(){_g(GG,{song:n.song})}}],controllerAs:"vm"}),angular.module("bandlab.project").value("ProjectUploader",{queue:[],isMinimized:!1,isVisible:!1}).directive("projectUploader",["$analytics","$window","ProjectUploader",function(e,t,n){return{restrict:"E",replace:!0,templateUrl:"https://www.bandlab.com/web-app/project/partials/_project-uploader-0050b2eb.html",link:function(o){t.addEventListener("beforeunload",(function(e){"100"!==o.getPercentageUploaded()&&(e.returnValue=!0)})),t.addEventListener("unload",(function(){"100"!==o.getPercentageUploaded()&&o.cancelAll()})),o.projectUploader=n,o.getPercentageUploaded=function(){const e=n.queue.filter((function(e){return!e.failed})),t=e.reduce((function(e,t){return e+(t.total||t.file.size)}),0);return 0===t?"100":(e.reduce((function(e,t){return e+t.loaded}),0)/t*100).toFixed(0)},o.hasSoundsSamples=function(){return n.queue.some((function(e){return e.isSounds}))},o.hasError=function(){return n.queue.some((function(e){return e.failed}))},o.hasRetryableError=function(){return n.queue.some((function(e){return e.failed&&!e.isOnlyCancellable}))},o.hasCancellableError=function(){return n.queue.some((function(e){return e.failed&&e.isOnlyCancellable}))},o.retryAll=function(){n.queue.forEach((function(e){e.failed&&!e.isOnlyCancellable&&e.retry()}))},o.cancelAll=function(){let t,o;[...n.queue].forEach((function(e){e.progress<1&&!e.complete?(e.cancel({isBatch:!0}),o++):t++})),e.eventTrack("blsounds_my_sounds_batch_upload_cancel",{platform:"firebase",params:{num_files_uploaded:t,num_files_not_uploaded:o}})},o.closeProjectUploader=function(){n.queue.filter((function(e){return!e.failed&&e.loaded!==e.total})).map((function(e){e.cancel()})),n.queue=[],n.isVisible=!1},o.$watch("projectUploader.queue.length",(function(e){e&&(n.isVisible=!0,n.isMinimized=!1),0==+e&&(n.isVisible=!1)}))}}}]),angular.module("bandlab.promote",["ui.router"]).config(["$stateProvider",function(e){e.state("promoteWizard",{url:"/boost/create?postId&campaignId&redirect&budget&duration",params:{value:null,dynamic:!0,squash:!0},useTopBarForm:!0,hideGlobalPlayer:!0,resolve:{campaignDraft:["$stateParams","Me",function(e,t){const{campaignId:n}=e;return n?UN(t.id,n):null}],boostRemoteConfig:["activatedFlow","Me",function(e,t){return"boost"===e?eF(t):null}],estimates:["campaignDraft",function(e){return e?FN():null}],thePost:["$state","$stateParams","Post",function(e,t,n){const{postId:o}=t;return n.get({id:o}).$promise.catch((()=>e.go("404")))}],postCampaignsList:["$stateParams","Me",async function(e,t){const{postId:n}=e;return function(e,t){const n=`https://www.bandlab.com/api/v1.3/users/${e}/promote/posts/${t}/statistics?status=${arguments.length>2&&void 0!==arguments[2]?arguments[2]:"active,paid,inreview"}`;return Uu.get(n.toString()).json()}(t.id,n)}],activatedFlow:["$state",function(e){return e.transition?.to().name.split(".")[1]}],activeBoostCampaign:["postCampaignsList",function(e){return e?.lastCampaigns?.postBandLab}],activeWebCampaign:["postCampaignsList",function(e){return e?.campaignCount?.musicWeb}],activeBoostedPost:["$state","activatedFlow","activeBoostCampaign",function(e,t,n){if("boost"===t&&n)return e.go("promoteOverview",{campaignId:n,type:t})}]},views:{"":{template:'<div id="vue"></div>',controller:["$compile","$element","$injector","$rootScope","$scope","$state","$stateParams","activeBoostCampaign","activatedFlow","activeWebCampaign","boostRemoteConfig","campaignDraft","estimates","thePost","Me",function(e,t,n,o,r,i,a,s,l,c,u,d,p,m,f){import("./chunk-243fa5cb.js").then((function(i){let{mountPromoteWizard:h}=i;const g=h(t[0].querySelector("#vue"),{$compile:e,$injector:n,$rootScope:o,$stateParams:a,activatedFlow:l,activeBoostCampaign:s,activeWebCampaign:c,boostRemoteConfig:u,campaignDraft:d,estimates:p,thePost:m,Me:f});r.$on("$destroy",(function(){g.unmount()}))})),r.$on("topBarExit",(function(){const{redirect:e}=a;return e?function(e){const t=JSON.parse(decodeURIComponent(e));i.go(t.name,t.params,{location:"replace"})}(e):i.go("user.feed",{username:f.username})}))}]},"topBarForm@":{templateUrl:"https://www.bandlab.com/web-app/promote/partials/_promote-form-top-bar-88348964.html",controller:["$rootScope","$scope",function(e,t){t.exitPage=function(){e.$broadcast("topBarExit")}}]},"tabBarForm@":{templateUrl:"https://www.bandlab.com/web-app/promote/partials/_promote-form-tab-bar-9cd6cb3c.html",controller:["$rootScope","$scope",function(e,t){t.goBack=function(){e.$broadcast("tabBarBack")},t.exitPage=function(){e.$broadcast("topBarExit")}}]}}}).state("promoteWizard.boost",{url:"/post-boost",useTopBarForm:!0}).state("promoteOverview",{url:"/boost/stats?campaignId&type",template:'<div id="vue"></div>',controller:["$element","$scope","$stateParams","$injector","Me",function(e,t,n,o,r){import("./chunk-41b6c760.js").then((function(i){let{mountCampaignStats:a}=i;const s=a(e[0].querySelector("#vue"),{$stateParams:n,$injector:o,Me:r});t.$on("$destroy",(function(){s.unmount()}))}))}]})}]),angular.module("bandlab.promote").directive("campaignsFilters",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/promote/partials/_states-dropdown-3af932eb.html",controller:["$scope",function(e){e.vm={}}]}})),angular.module("bandlab.promote").directive("promotePostButton",["$injector",function(e){return{restrict:"E",replace:!0,scope:{post:"="},link:function(t,n){import("./chunk-eaa7bd32.js").then((function(o){let{mountPromotePostButton:r}=o;const i=r(n[0],{$injector:e},{post:t.post});t.$on("$destroy",(function(){i.unmount()}))}))}}}]),angular.module("bandlab.report.routes",["ui.router"]).config(["$stateProvider",function(e){function t(e,t,n,o,r,i,a,s,l){const{type:c,id:u,subObjectId:d,objectId:p,objectCreatorId:m,creatorId:f,chat:h,sharedKey:g}=e.params();return function(){if(f||m){const e=f||m;return()=>l.get({id:e}).$promise}return{albums:()=>n.get({id:u}).$promise.then((e=>{let{creator:t}=e;return t})),bands:()=>o.get({id:u}).$promise.then((e=>{let{creator:t}=e;return t})),collections:()=>r.get({id:u}).$promise.then((e=>{let{creator:t}=e;return t})),communities:()=>i.get({id:u}).$promise.then((e=>{let{creator:t}=e;return t})),posts:()=>a.get({id:u,sharedKey:g}).$promise.then((e=>{let{creator:t}=e;return t})),shows:()=>s.get({id:u}).$promise.then((e=>{let{creator:t}=e;return t})),users:()=>l.get({id:u}).$promise}[c]||(()=>t.resolve(null))}()().then((function(e){return{creator:e,objectId:"comments"===c?p:u,objectType:v(c),isChat:"true"===h,subObjectId:"comments"===c?u:d,objectCreatorId:m}}));function v(e){return{albums:"Album",bands:"Band",chatmessage:"ChatMessage",collections:"Collection",comments:"Comment",communities:"Community",posts:"Post",projects:"Project",revisions:"Revision",shows:"Show",songs:"Song",users:"User"}[e]||e}}t.$inject=["$transition$","$q","Album","Band","Collection","Community","Post","Show","User"],e.state("reportEntity",{url:"/report/:type/:id?step&reason&subObjectId&objectId&objectCreatorId&creatorId&chat&sharedKey",params:{step:{dynamic:!0}},templateUrl:"https://www.bandlab.com/web-app/report/views/report-layout-7123ba65.html",controller:["$scope","theEntity",function(e,t){e.toReport=t}],resolve:{theEntity:t}}).state("reportGeneral",{url:"/report/:type?step&reason",params:{step:{dynamic:!0}},templateUrl:"https://www.bandlab.com/web-app/report/views/report-layout-7123ba65.html",controller:["$scope","theEntity",function(e,t){e.toReport=t}],resolve:{theEntity:t}}).state("report",{url:"/report?step&reason",templateUrl:"https://www.bandlab.com/web-app/report/views/report-layout-7123ba65.html",controller:["$scope","theEntity",function(e,t){e.toReport=t}],resolve:{theEntity:t}})}]);const KG=["width","height","aria-hidden"],YG=[bi("path",{fill:"currentColor",d:"M12 10h6l-7.97 13H9.01l3-10H6l8-12h1z"},null,-1)],JG={__name:"product-boost",props:{size:{type:Number,required:!0}},setup:e=>(t,n)=>(si(),pi("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none","aria-hidden":t.$attrs["aria-label"]||t.$attrs["aria-labelledby"]?null:"true"},YG,8,KG))},XG=Object.freeze(Object.defineProperty({__proto__:null,default:JG},Symbol.toStringTag,{value:"Module"})),ZG=["width","height","aria-hidden"],QG=[bi("path",{fill:"currentColor",d:"M13 18v-5h-2v5z"},null,-1),bi("path",{fill:"currentColor","fill-rule":"evenodd",d:"M6 6a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3h3v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9h3zm10 0v3H8V6c0-1.1.9-2 2-2h4a2 2 0 0 1 2 2M5 11v7c0 1.1.9 2 2 2h10a2 2 0 0 0 2-2v-7z","clip-rule":"evenodd"},null,-1)],eK={__name:"lock",props:{size:{type:Number,required:!0}},setup:e=>(t,n)=>(si(),pi("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none","aria-hidden":t.$attrs["aria-label"]||t.$attrs["aria-labelledby"]?null:"true"},QG,8,ZG))},tK=Object.freeze(Object.defineProperty({__proto__:null,default:eK},Symbol.toStringTag,{value:"Module"})),nK={class:"boost-modal-private-banner text-left"},oK={class:"boost-modal-private-banner-header"},rK={class:"semibold-16/24"},iK={class:"regular-14/20"},aK=["href"],sK=["href"],lK={class:"regular-16/24"},cK={__name:"BoostPrivateBanner",setup(e){const t=Zo("$injector").get("$state");return(e,n)=>(si(),pi("div",nK,[bi("div",oK,[bi("div",rK,me("Your account is private"),1),bi("div",iK,me("Nothing wrong with that, but you will get better boost result if you change account to public."),1)]),bi("a",{style:{"flex-shrink":"0","margin-right":"16px"},class:"button-orange button-height-32 button-padding-16 button-rounded hide-for-medium-down",href:Gt(t).href("settings.privacy")},me("Privacy Settings"),9,aK),bi("a",{class:"flex-for-medium-down boost-modal-private-banner-footer",href:Gt(t).href("settings.privacy")},[yi(eK,{size:24}),bi("span",lK,me("Privacy Settings"),1),yi(mb,{size:24,style:{"margin-left":"auto",opacity:".5"}})],8,sK)]))}},uK=["width","height","aria-hidden"],dK=[bi("path",{fill:"currentColor","fill-rule":"evenodd",d:"M12 23a11 11 0 1 0 0-22 11 11 0 0 0 0 22m5.7-13.3-1.4-1.4-5.3 5.29-3.3-3.3-1.4 1.42 4.7 4.7z","clip-rule":"evenodd"},null,-1)],pK={__name:"checkmark-circle-filled",props:{size:{type:Number,required:!0}},setup:e=>(t,n)=>(si(),pi("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none","aria-hidden":t.$attrs["aria-label"]||t.$attrs["aria-labelledby"]?null:"true"},dK,8,uK))},mK=Object.freeze(Object.defineProperty({__proto__:null,default:pK},Symbol.toStringTag,{value:"Module"})),fK=["width","height","aria-hidden"],hK=[bi("path",{fill:"currentColor",d:"M13.2 2.12v6h-2v-6zM9.9 8.66 5.66 4.4 4.24 5.83l4.25 4.24z"},null,-1),bi("path",{fill:"currentColor","fill-rule":"evenodd",d:"M12.2 11.02a1 1 0 0 0-1.14 1.33L14.62 22a1 1 0 0 0 1.7.3l6.52-7.57a1 1 0 0 0-.56-1.63zm3.7 8.7-2.34-6.38 6.66 1.38z","clip-rule":"evenodd"},null,-1),bi("path",{fill:"currentColor",d:"M8.12 11.2h-6v2h6z"},null,-1)],gK={__name:"click-traking",props:{size:{type:Number,required:!0}},setup:e=>(t,n)=>(si(),pi("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none","aria-hidden":t.$attrs["aria-label"]||t.$attrs["aria-labelledby"]?null:"true"},hK,8,fK))},vK=Object.freeze(Object.defineProperty({__proto__:null,default:gK},Symbol.toStringTag,{value:"Module"})),bK=["width","height","aria-hidden"],yK=[bi("path",{fill:"currentColor","fill-rule":"evenodd",d:"M3.77 3.8a9.4 9.4 0 0 1 6.7-2.8h3.06a9.5 9.5 0 0 1 7.04 15.85l-1.5-1.33A7.49 7.49 0 0 0 13.54 3h-3.06A7.4 7.4 0 0 0 5.2 5.2 7.5 7.5 0 0 0 3 10.6a7.63 7.63 0 0 0 7.7 7.4h3.45c2.29 0 4.36.74 6 2.33l1.02 1-1.4 1.43-1.01-1a6.4 6.4 0 0 0-4.6-1.76h-3.47A9.63 9.63 0 0 1 1 10.61 9.5 9.5 0 0 1 3.77 3.8","clip-rule":"evenodd"},null,-1)],wK={__name:"comment",props:{size:{type:Number,required:!0}},setup:e=>(t,n)=>(si(),pi("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none","aria-hidden":t.$attrs["aria-label"]||t.$attrs["aria-labelledby"]?null:"true"},yK,8,bK))},$K=Object.freeze(Object.defineProperty({__proto__:null,default:wK},Symbol.toStringTag,{value:"Module"})),kK=["width","height","aria-hidden"],SK=[bi("path",{fill:"currentColor","fill-rule":"evenodd",d:"M7 5a4 4 0 1 0 0 8 4 4 0 0 0 0-8M5 9a2 2 0 1 1 4 0 2 2 0 0 1-4 0","clip-rule":"evenodd"},null,-1),bi("path",{fill:"currentColor",d:"M1.77 19.7a7.4 7.4 0 0 1 11.45.06l1.56-1.26a9.4 9.4 0 0 0-14.55-.1zm13.49-2.6a7.4 7.4 0 0 1 6.96 2.66l1.56-1.26a9.4 9.4 0 0 0-10.26-3.02q.45.29.85.62.55.44.89 1"},null,-1),bi("path",{fill:"currentColor","fill-rule":"evenodd",d:"M17 5a4 4 0 1 0 0 8 4 4 0 0 0 0-8m-2 4a2 2 0 1 1 4 0 2 2 0 0 1-4 0","clip-rule":"evenodd"},null,-1)],_K={__name:"users",props:{size:{type:Number,required:!0}},setup:e=>(t,n)=>(si(),pi("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none","aria-hidden":t.$attrs["aria-label"]||t.$attrs["aria-labelledby"]?null:"true"},SK,8,kK))},PK=Object.freeze(Object.defineProperty({__proto__:null,default:_K},Symbol.toStringTag,{value:"Module"})),MK=["width","height","aria-hidden"],TK=[bi("path",{fill:"currentColor","fill-rule":"evenodd",d:"M18.75 4.44c-2.05-1.09-4.87-.06-5.83 2.13a1 1 0 0 1-1.84 0 4.4 4.4 0 0 0-5.83-2.13C3.82 5.18 2.94 6.88 3 8.74c.06 1.75.61 2.74 1.88 4.4A28 28 0 0 0 12 19.8a27 27 0 0 0 7.11-6.64c1.27-1.7 1.83-2.67 1.89-4.42.06-1.85-.83-3.56-2.25-4.3m.93-1.77A6.35 6.35 0 0 0 12 4.3a6.4 6.4 0 0 0-7.68-1.64C2.1 3.83.92 6.34 1 8.81c.09 2.36.92 3.75 2.29 5.55a31 31 0 0 0 8.16 7.48 1 1 0 0 0 1.1 0 30 30 0 0 0 8.17-7.5c1.34-1.79 2.2-3.16 2.28-5.53.08-2.45-1.08-4.98-3.32-6.14","clip-rule":"evenodd"},null,-1)],CK={__name:"heart",props:{size:{type:Number,required:!0}},setup:e=>(t,n)=>(si(),pi("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none","aria-hidden":t.$attrs["aria-label"]||t.$attrs["aria-labelledby"]?null:"true"},TK,8,MK))},EK=Object.freeze(Object.defineProperty({__proto__:null,default:CK},Symbol.toStringTag,{value:"Module"})),IK=["width","height","aria-hidden"],RK=[bi("path",{fill:"currentColor",d:"M10 2.03A7.97 7.97 0 0 0 2.03 10v2h1.94v-2c0-3.33 2.7-6.03 6.03-6.03h6.98V2.03zM20.03 12v2c0 3.33-2.7 6.03-6.03 6.03H7v1.94h7c4.4 0 7.97-3.57 7.97-7.97v-2z"},null,-1),bi("path",{fill:"currentColor","fill-rule":"evenodd",d:"M10.62 6.26A.97.97 0 0 0 9.03 7v10a.97.97 0 0 0 1.6.74l6-5a.97.97 0 0 0 0-1.48zM14.5 12l-3.52 2.93V9.07z","clip-rule":"evenodd"},null,-1)],AK={__name:"insights-plays-total",props:{size:{type:Number,required:!0}},setup:e=>(t,n)=>(si(),pi("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none","aria-hidden":t.$attrs["aria-label"]||t.$attrs["aria-labelledby"]?null:"true"},RK,8,IK))},xK=Object.freeze(Object.defineProperty({__proto__:null,default:AK},Symbol.toStringTag,{value:"Module"})),LK={},OK={class:"ds-modal-content",style:{"margin-top":"var(--ds-space-500)"}},jK=[Si('<div class="modal-boost-skeleton row-gap-16"><div class="skeleton-avatar-square"></div><div class="skeleton-md skeleton-height-32"></div><div class="skeleton-sm skeleton-height-16"></div><div class="skeleton-avatar-circle"></div><div class="skeleton-x-sm skeleton-height-16"></div><div class="skeleton-content"></div><div class="skeleton-sm skeleton-height-16"></div></div>',1)],DK=ld(LK,[["render",function(e,t){return si(),pi("section",OK,jK)}]]),NK={class:"ds-modal ds-modal-size-large"},UK={key:1,style:{display:"contents"}},FK={class:"modal-boost-insights-header modal-boost-insights"},BK={class:"modal-boost-insights-header-title typography-title-section"},WK={class:"ds-modal-content modal-boost-insights-content row-gap-16"},VK={class:"modal-boost-insights-content-text-container row-gap-8"},qK={key:0,class:"modal-boost-insights-content-text-container-description"},zK={class:"modal-boost-insights-content-text-container-views"},HK={class:"modal-boost-insights-content-text-container-views-p"},GK={key:0,class:"modal-boost-insights-content-info"},KK=["innerHTML"],YK={class:"modal-boost-insights-content-stats"},JK={class:"stats-item"},XK={class:"typography-body-default-medium"},ZK={class:"typography-title-section"},QK={key:0,class:"show-for-medium-down"},eY={key:2,class:"row-gap-12"},tY=["innerHTML"],nY={class:"text-scd ds-modal-content-p"},oY={key:0,class:"ds-modal-footer show-for-medium-down"},rY="667d1a3cc326cc00010ef747",iY={__name:"PostBoostInsightsModal",props:{post:{type:Object,required:!0}},emits:["closeModal","success"],setup(e,t){let{emit:n}=t;const o=n,r=e,i=Zo("$injector"),a=i.get("Me"),s=i.get("AppNotifications"),l=Vt(0),c=Vt(!1),u=Vt(new Date),d=Vt(0),p=Vt(!0),m=Vt(0),f=Vt(0),h=Vt(0),g=Vt(0),v=Vt(0),b=Vt(0),y=Vt(0),w=Vt(""),$=Vt(!1),k=Gi((()=>"live"===w.value)),S=Gi((()=>"completed"===w.value)),_=Gi((()=>"paused"===w.value)),P=Gi((()=>k.value?"Your Boost is live!":S.value?"Your Boost completed!":_.value?"Your Boost stopped":null)),M=Gi((()=>_.value?"Your campaign was stopped, because you made your post or profile private. Please reach out to support if it was done by accident.":null)),T=Gi((()=>{const e=(y.value-d.value)/d.value*100;return e>=5?`Your post did well! It got <strong>${Math.round(e)}% more</strong> views than the target <strong>${d.value} views</strong>.`:null})),C=Gi((()=>{const e=DA(m.value,"USD",{trailingZeroDisplay:"stripIfInteger"}),t=DA(l.value,"USD",{trailingZeroDisplay:"stripIfInteger"});return`Paid ${e} ${m.value!==l.value?` <s>${t}</s>`:""} on ${qA(u.value)}`})),E=Gi((()=>[{id:"clicks",title:" Clicks",number:LA(b.value)},{id:"plays",title:"Plays",number:LA(v.value)},{id:"likes",title:"Likes",number:LA(g.value)},{id:"comments",title:"Comments",number:LA(f.value)},{id:"followers",title:"Followers",number:LA(h.value)}]));function I(e){c.value=e.boostAgain,l.value=e.campaignPrice/100,u.value=new Date(e.createdAt),d.value=e.estimatedViews,m.value=e.paidAmount/100,w.value=e.campaignStatus,f.value=e.comments,h.value=e.followers,g.value=e.likes,v.value=e.plays,b.value=e.taps,y.value=e.views,p.value=!1}function R(){($.value=!0,new Promise(((e,t)=>{!async function(n,o,r,i){if(o.getElementById(r))return window.iterate("uninstall",rY),window.iterate("onLoad",(()=>$.value=!1)),e();function s(){s.c(arguments)}window.iterateSettings={apiKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjb21wYW55X2lkIjoiNjViMmNmMjA0ZTA4NzgwMDAxZDAwOTRkIiwiaWF0IjoxNzA2MjE3MjQ4fQ.J7RVD3q7uJX6YlZF8k1jJY4G6ef98EXuOpAedqDviig"},n.IterateObjectName=i,s.q=[],s.c=function(e){s.q.push(e)},n[i]=s,await Promise.resolve().then((()=>Lc)).then((function(n){let{load:i}=n;i("https://platform.iteratehq.com/loader.js",o.head,{id:r}).then((()=>(window.iterate("identify",{email:a.email,user_id:a.id,first_name:a.name}),window.iterate("onLoad",(()=>$.value=!1)),e()))).catch((()=>($.value=!1,t())))}))}(window,document,"iterate-js","iterate")}))).then((()=>{window.iterate("install",rY)})).catch((()=>{s.addNotification({title:"Something went wrong, please try again later",classList:"alert",autoclose:5e3})})).finally((()=>{Promise.resolve().then((()=>Ap)).then((e=>{let{logEvent:t}=e;t("boost_satisfaction_triggered")}))}))}function A(){o("success",{triggeredFrom:OY.boostAgain}),o("closeModal")}return wv("post"),ao((()=>{CD("bandlab_post",r.post.id,{useCache:!0}).then(I)})),uo((()=>{ED("bandlab_post",r.post.id)})),(e,t)=>(si(),pi("section",NK,[p.value?(si(),mi(DK,{key:0})):(si(),pi("div",UK,[bi("header",FK,[k.value?(si(),mi(JG,{key:0,size:48,style:{color:"var(--ds-color-tint-purple-base)"}})):S.value?(si(),mi(pK,{key:1,size:48,style:{color:"var(--ds-color-tint-purple-base)"}})):_.value?(si(),mi(YW,{key:2,size:48,style:{color:"var(--ds-color-tint-purple-base)"}})):_i("v-if",!0),bi("h2",BK,me(P.value),1)]),bi("section",WK,[bi("div",VK,[M.value?(si(),pi("h3",qK,me(M.value),1)):_i("v-if",!0),bi("div",zK,[bi("span",null,me(y.value),1),bi("p",HK,me("views"),1)])]),!k.value&&T.value?(si(),pi("div",GK,[bi("p",{class:"ds-modal-content-p",innerHTML:T.value},null,8,KK)])):_i("v-if",!0),k.value&&Gt(a).isPrivate?(si(),mi(cK,{key:1,style:{margin:"0"}})):_i("v-if",!0),bi("div",YK,[(si(!0),pi(ti,null,So(E.value,((e,t)=>(si(),pi(ti,{key:e.title},[bi("div",JK,["clicks"===e.id?(si(),mi(gK,{key:0,size:24})):"plays"===e.id?(si(),mi(AK,{key:1,size:24})):"likes"===e.id?(si(),mi(CK,{key:2,size:24})):"comments"===e.id?(si(),mi(wK,{key:3,size:24})):"followers"===e.id?(si(),mi(_K,{key:4,size:24})):_i("v-if",!0),bi("span",XK,me(e.title),1),bi("span",ZK,me(e.number),1)]),t!==E.value.length-1?(si(),pi("hr",QK)):_i("v-if",!0)],64)))),128))]),c.value||!k.value?(si(),pi("div",eY,[c.value?(si(),mi(Dd,{key:0,class:"modal-boost-insights-content-button hide-for-medium-down",type:"button",size:"medium",color:"boost",padding:"default",onClick:A},{default:Tn((()=>[ki(me("Boost Again"),1)])),_:1})):_i("v-if",!0),k.value?_i("v-if",!0):(si(),mi(Dd,{key:1,class:"modal-boost-insights-content-button","is-loading":$.value,type:"button",size:"medium",color:"secondary",padding:"default",onClick:R},{default:Tn((()=>[ki(me("Rate this Boost"),1)])),_:1},8,["is-loading"]))])):_i("v-if",!0),bi("p",{class:"text-scd ds-modal-content-p",innerHTML:C.value},null,8,tY),bi("p",nY,me("Analytics includes organic traffic and may have slight delays. Displayed data could differ due to changes in user engagement."),1)]),c.value?(si(),pi("footer",oY,[yi(Dd,{class:"ds-button-full-width",type:"button",size:"medium",color:"boost",padding:"default",onClick:A},{default:Tn((()=>[ki(me("Boost Again"),1)])),_:1})])):_i("v-if",!0)])),yi(ib,{onClick:t[0]||(t[0]=t=>e.$emit("closeModal"))})]))}},aY={class:"ds-modal ds-modal-size-small boost-offer-modal"},sY={class:"ds-modal-header",style:{"padding-top":"32px"}},lY=bi("svg",{width:"64",height:"64",viewBox:"0 0 64 64",fill:"none"},[bi("rect",{width:"64",height:"64",rx:"32",fill:"#00C37D"}),bi("path",{d:"m24 30.68 5.67 6.17c.07.08.2.08.29 0L40 27",stroke:"#fff","stroke-width":"2"})],-1),cY={class:"ds-modal-title boost-offer-title"},uY={class:"ds-modal-content boost-offer-modal-content"},dY={class:"ds-modal-content-p"},pY={class:"ds-modal-footer ds-modal-footer-two-buttons"},mY={__name:"BoostPostOfferModal",props:{post:{type:Object,required:!0}},emits:["closeModal"],setup(e){const t=e,n=Zo("$injector"),o=Vt(!1);function r(){o.value=!0;const e=OY.postCreateNotification;return jY(n,t.post,e).finally((function(){o.value=!1}))}return(t,n)=>(si(),pi("section",aY,[bi("header",sY,[lY,bi("h2",cY,me("Your Post is Live!"),1)]),bi("section",uY,[bi("p",dY,me("Try Boost to reach out to more people with this post."),1)]),bi("footer",pY,[Cn((si(),mi(Dd,{as:"a",size:"medium",color:"transparent",padding:"default"},{default:Tn((()=>[ki(me("View Post"),1)])),_:1})),[[Gt(tU),{name:"postId",params:{id:e.post.id}}]]),yi(Dd,{type:"button",size:"medium",color:"boost",padding:"default","is-loading":o.value,onClick:r},{"leading-icon":Tn((e=>{let{class:t}=e;return[yi(JG,{size:20,class:ae(t)},null,8,["class"])]})),default:Tn((()=>[ki(" "+me("Boost"),1)])),_:1},8,["is-loading"])]),yi(ib,{onClick:n[0]||(n[0]=e=>t.$emit("closeModal"))})]))}},fY={components:{BoostSlider:zn((()=>import("./chunk-fb2b6411.js"))),Button:zn((()=>Promise.resolve().then((()=>Nd)))),LoaderWave:zn((()=>import("./chunk-6fc0e733.js"))),LoadingIcon:zn((()=>Promise.resolve().then((()=>Od)))),TimeHistoryIcon:zn((()=>import("./chunk-acd7970e.js"))),ModalCloseButton:zn((()=>Promise.resolve().then((()=>ab))))},directives:{sref:tU},props:{remoteConfig:{type:Object,default:()=>{}},postId:{type:String,required:!0},triggeredFrom:{type:String,default:null},post:{type:Object,required:!0}},emits:["closeModal"],setup(e){const t=Vt(!1),n=Zo("$injector"),o=n.get("$state"),r=n.get("AppNotifications"),i=n.get("Me"),a=Vt(!1),s=Vt(null),l=Gi((()=>e.post.creator.id!==i.id)),c=Vt(!0),u=Gi((function(){const e=DA(y.value*$.value,"USD",{trailingZeroDisplay:"stripIfInteger"});if(f.value&&a.value){const t=DA(y.value*$.value-d.value,"USD",{trailingZeroDisplay:"stripIfInteger"});return(n=>{const o=new Intl.PluralRules("en");return{one:`<s class="text-scd">${e}</s> ${t} over ${n} day`,other:`<s class="text-scd">${e}</s> ${t} over ${n} days`}[o.select(n)]})($.value)}return(t=>{const n=new Intl.PluralRules("en");return{one:`${e} over ${t} day`,other:`${e} over ${t} days`}[n.select(t)]})($.value)})),d=Gi((function(){return f.value&&a.value&&y.value*$.value*(a.value/100)})),{impressions:p,impressionsString:m,isEligibleForDiscount:f,loadingEstimates:h,syncEstimates:g}=rF(),v=QU(e.remoteConfig);$v(e.triggeredFrom);const b=l.value?'Support your favorite creator with <span style="color: #b400ff; white-space: nowrap;"><svg width="41" height="40" viewBox="0 0 41 40" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="m20.2 16.3 4.05-11.98c.14-.43-.34-.77-.6-.42L11.92 19.6c-.4.54-.06 1.36.55 1.36h6.66c.25 0 .43.29.34.56L14.8 35.4c-.22.65.53 1.15.92.61L28.34 18.2c.38-.53.05-1.33-.55-1.33h-7.26c-.25 0-.42-.3-.33-.56Z" fill="currentColor"/></svg>BandLab Boost</span>':'Supercharge your content with <span style="color: #b400ff; white-space: nowrap;"><svg width="41" height="40" viewBox="0 0 41 40" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="m20.2 16.3 4.05-11.98c.14-.43-.34-.77-.6-.42L11.92 19.6c-.4.54-.06 1.36.55 1.36h6.66c.25 0 .43.29.34.56L14.8 35.4c-.22.65.53 1.15.92.61L28.34 18.2c.38-.53.05-1.33-.55-1.33h-7.26c-.25 0-.42-.3-.33-.56Z" fill="currentColor"/></svg>BandLab Boost</span>',y=Vt(v.costDefault),w=Vt({max:v.costMax,min:v.costMin,checkpoints:v.costCheckpoints,step:v.costStep,label:Gi((()=>`$${y.value} Daily`))}),$=Vt(v.durationDefault),k=Vt({max:v.durationMax,min:v.durationMin,checkpoints:v.durationCheckpoints,step:v.durationStep,label:Gi((()=>$.value>1?`${$.value} Days`:`${$.value} Day`))});function S(){g({budget:y.value,duration:$.value})}function _(){return _g(iY,{post:e.post,onSuccess:e=>{let{triggeredFrom:t}=e;return $v(t)}})}return ao((()=>{S(),CD("bandlab_post",e.postId,{useCache:!0}).then((e=>{s.value=e,o.current.name.includes("boost.history.recent")&&s.value&&_()})).catch((()=>null)).finally((()=>c.value=!1))})),Lr([y,$],(function(){S()})),Mp(i,"boost_discount_campaign").then((function(e){Object.keys(HU).includes(e)&&(a.value=e)})),{boostTitleTemplate:b,boostDiscountCampaign:a,budget:y,budgetSliderParams:w,createPaymentIntent:function(){kv(y.value,$.value,d.value&&y.value*$.value-d.value),t.value=!0;const n=encodeURIComponent(JSON.stringify({name:"post",params:{id:e.postId}}));Lg("boost",Fg(),{postId:e.postId,budget:100*y.value,duration:$.value,...f.value?{promo:HU[a.value]}:{}}).then((function(e){let{paymentIntentId:t,productId:r}=e;o.go("checkout",{paymentIntentId:t,productId:r,product:"boost",productAttribution:"boost_post",redirectUrl:n,redirectCancelUrl:n})})).catch((function(e){r.addNotification({classList:"alert",title:"Something went wrong, please try again later",content:e.message||"Something went wrong with our servers. Please try again."})})).finally((function(){t.value=!1}))},duration:$,durationSliderParams:k,formatCurrencyString:DA,impressions:p,impressionsString:m,isCreatingPaymentIntent:t,isEligibleForDiscount:f,isGiftBoost:l,isLoading:c,formatBigNumber:LA,loadingEstimates:h,previousCampaignInsights:s,pricingSummaryTemplate:u,showPreviousCampaignInsights:_}}},hY={class:"ds-modal ds-modal-size-large modal-boost"},gY={key:0,class:"modal-boost-loader"},vY={class:"boost-modal-header"},bY=["innerHTML"],yY={key:1,class:"ds-modal-content-p boost-modal-header-subtitle"},wY={key:2,class:"ds-modal-content-p boost-modal-header-subtitle"},$Y={class:"ds-modal-content boost-modal-content row-gap-16"},kY={key:1,class:"boost-modal-discount-container"},SY={class:"boost-modal-discount-text"},_Y=bi("br",{class:"show-for-medium-down"},null,-1),PY={class:"boost-modal-info-container"},MY={class:"boost-modal-info"},TY={class:"semibold-24/32"},CY={class:"boost-modal-info"},EY={class:"semibold-24/32"},IY={class:"semibold-16 row-gap-16 boost-modal-estimates"},RY=["innerHTML"],AY={key:0},xY=ld(fY,[["render",function(e,t,n,o,r,i){const a=vo("LoaderWave"),s=vo("TimeHistoryIcon"),l=vo("Button"),c=vo("BoostSlider"),u=vo("LoadingIcon"),d=vo("ModalCloseButton");return si(),pi("section",hY,[o.isLoading?(si(),pi("div",gY,[yi(a)])):_i("v-if",!0),bi("header",vY,[bi("h2",{class:"boost-modal-header-title",innerHTML:o.boostTitleTemplate},null,8,bY)]),o.isGiftBoost?(si(),pi("p",yY," Help "+me(n.post.creator.name)+" reach a larger audience. Choose the higher budget and duration to maximize the impact. ",1)):(si(),pi("p",wY,me("BandLab will help you to find a bigger audience for your post. Find the best budget/duration ratio to continue."),1)),bi("div",$Y,[o.previousCampaignInsights?(si(),mi(l,{key:0,type:"button",size:"medium",color:"secondary",padding:"default",style:{"align-self":"center","margin-bottom":"12px"},onClick:t[0]||(t[0]=e=>o.showPreviousCampaignInsights())},{"leading-icon":Tn((e=>{let{class:t}=e;return[yi(s,{size:20,class:ae(t)},null,8,["class"])]})),default:Tn((()=>[ki(" Previous Boost Insights ")])),_:1})):_i("v-if",!0),o.boostDiscountCampaign&&o.isEligibleForDiscount?(si(),pi("div",kY,[bi("h3",SY,[ki(me("Limited time offer!")+" ",1),_Y,ki(" "+me(`${o.boostDiscountCampaign}% off your first Boost `),1)])])):_i("v-if",!0),bi("div",PY,[bi("div",MY,[bi("div",TY,me("Budget"),1),yi(c,Ci(o.budgetSliderParams,{modelValue:o.budget,"onUpdate:modelValue":t[1]||(t[1]=e=>o.budget=e)}),null,16,["modelValue"])]),bi("div",CY,[bi("div",EY,me("Duration"),1),yi(c,Ci(o.durationSliderParams,{modelValue:o.duration,"onUpdate:modelValue":t[2]||(t[2]=e=>o.duration=e)}),null,16,["modelValue"])])]),bi("div",IY,[bi("span",null,[ki(me("Total")+": ",1),bi("span",{innerHTML:o.pricingSummaryTemplate},null,8,RY)]),o.loadingEstimates?(si(),mi(u,{key:1,size:20,class:"loader loader-spinning"})):(si(),pi("span",AY,me("Estimated reach")+": "+me((e=>{const t=()=>o.impressionsString,n=new Intl.PluralRules("en");return{one:`${t()} view`,other:`${t()} views`}[n.select(e)]})(o.impressions)),1))]),yi(l,{size:"large",class:"boost-modal-button",color:"boost",padding:"default","is-loading":o.isCreatingPaymentIntent,onClick:o.createPaymentIntent},{default:Tn((()=>[ki(me("Boost"),1)])),_:1},8,["is-loading","onClick"])]),yi(d,{onClick:t[3]||(t[3]=t=>e.$emit("closeModal"))})])}]]),LY=Object.freeze(Object.defineProperty({__proto__:null,default:xY},Symbol.toStringTag,{value:"Module"})),OY={"band.feed":"band",boostAgain:"boost_again","feed.following":"following",post:"post_page","post.boost":"deeplink",postCreateNotification:"post_create_notification","search.results":"hashtag",track:"artist_services_track_page","track.boost":"deeplink","user.feed":"user_profile"};function jY(e,t,n){const o=e.get("Me");return new Promise((function(r){PD("bandlab_post",t.id).then((()=>_g(iY,{post:t},{onClose:()=>r(!0)}))).catch((async function(i){if(404===i.response?.status){const e=await eF(o);return o.isPrivate?_g(JN,{onConfirm:()=>_g(xY,{remoteConfig:e,postId:t.id,triggeredFrom:n,post:t},{onClose:()=>r(!1)})},{onClose:()=>r(!1)}):_g(xY,{remoteConfig:e,postId:t.id,triggeredFrom:n,post:t},{onClose:()=>r(!1)})}e.get("AppNotifications").addNotification({autoclose:8e3,content:"Something went wrong, please try again later",classList:"alert"}),r(!1)}))}))}function DY(e,t){if(!t.isPostedAsBand)return _g(mY,{post:t})}function NY(e){let{Me:t,post:n}=e;return new Promise((function(e){const o=localStorage.getItem(`${t.id}teaser${n.id}`),r=FY(n.createdOn)>7;return o||r?e(!1):PD("bandlab_post",n.id).catch((t=>{404===t.response?.status&&e(!0)}))}))}function UY(e){let{Me:t,id:n}=e;localStorage.setItem(`${t.id}teaser${n}`,!0)}function FY(e){const t=Date.now()-new Date(e).getTime();return Math.ceil(t/864e5)}const BY=Object.freeze(Object.defineProperty({__proto__:null,BOOST_LOCATION:OY,deactivateBoostTeaser:UY,getBoostTeaserStatus:NY,getDaysPassed:FY,openBoostPostModal:jY,openBoostPostOfferModal:DY},Symbol.toStringTag,{value:"Module"}));angular.module("bandlab.project").controller("ReverbNationCtrl",["$injector","$rootScope","$scope","$state","AppNotifications","Me","Modal","ProFeedback","Release","Revision","Song","User",function(e,t,n,o,r,i,a,s,l,c,u,d){async function p(e){const t=await u.get({id:e.id}).$promise;return c.get({id:t.revision.id}).$promise}n.goToCrowdReview=async function(e,t,n){t=t??await p(e),function(e,t,n,o,r,i,a){cN(i,a,t)&&new o({templateUrl:"https://www.bandlab.com/web-app/reverbnation/partials/_get-reviews-confirmation-c43fccd0.html",class:"artist-services-usps-modal-root",contentScope:{revision:i,song:r,link:`https://www.reverbnation.com/c/bandlab/crowd_review/${n.id}?revision_id=${i.id}`}}).show()}(0,r,i,a,e,t,n)},n.goToZire=async function(e,t,n){t=t??await p(e),function(e,t,n,o,r,i){uN(r,i,t)&&new n({templateUrl:"https://www.bandlab.com/web-app/reverbnation/partials/_promote-confirmation-3ead8cb6.html",class:"artist-services-usps-modal-root",contentScope:{revision:r,song:o,link:`https://zire.com/onboarding/review-release?revision_id=${r.id}`}}).show()}(0,r,a,e,t,n)},n.goToDistributionCreate=async function(e,s,c,u){s=s??await p(e),async function(e,t,n,o,r,i,a,s,l){let c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:"revision_page",u=arguments.length>10&&void 0!==arguments[10]?arguments[10]:{name:"track",params:{postId:s?.postId}};if(!function(e,t,n){return lN(t)?vN(t,n)?!!aN(t,n)||e.addNotification({title:"BandLab Distribution",content:"Only the creator can submit",classList:"warning",autoclose:8e3}):e.addNotification({title:"BandLab Distribution",content:"Your track must be longer than 60 seconds",classList:"warning",autoclose:8e3}):e.addNotification({title:"BandLab Distribution",content:"Currently processing. Please wait a few seconds before trying again.",classList:"warning",autoclose:8e3})}(o,s))return;const d=await l.getMembershipStatus({userId:r.id}).$promise,p=await hN(r);if("Free"!==d.plan)m();else{if(!p)return f("reachedReleaseLimitModal","https://www.bandlab.com/web-app/distribution/partials/_distribution-reached-release-limit-modal-f828b105.html");(await a.getAccess({userId:r.id}).$promise).featureAccess.remainingReleases<=0?f("reachedReleaseLimitModal","https://www.bandlab.com/web-app/distribution/partials/_distribution-reached-release-limit-modal-f828b105.html"):f("packageSelectionModal","https://www.bandlab.com/web-app/distribution/partials/_distribution-package-selection-modal-06e6c654.html")}async function m(){e.$broadcast("reachedReleaseLimitModal","close"),await pN(o,r,a)&&_N(null,t,n,r,a,0,s,!1,c,u)}function f(e,t){document.getElementById(e)||new i({id:e,templateUrl:t,contentScope:{isPilotUser:p,getMembership:()=>{new i({id:"paywallModal",templateUrl:"https://www.bandlab.com/web-app/membership/partials/_paywall-modal-ee6789e7.html",contentScope:{productAttribution:"distro",productAttributionGroup:"artist_services"}}).show()},createDraft:m}}).show()}}(t,n,o,r,i,a,l,s,d,c,u)},n.goToProFeedback=async function(e,t){t=t??await p(e),function(e,t,n,o,r){o.getList().$promise.then((()=>{new n({templateUrl:"https://www.bandlab.com/web-app/profeedback/partials/_profeedback-modal-5c427d3e.html",contentScope:{continue:function(){return e.go("proFeedback",{slug:r.song.slug,revId:r.id})}}}).show()})).catch((e=>{NG(t,e)}))}(o,r,a,s,t)},n.openBoostPostModal=function(t,n){const r=n||OY[`${o.current.name}`];jY(e,t,r)},n.onBoostButtonInit=function(){if("track.boost"===o.current.name){const e=OY[`${o.current.name}`];n.openBoostPostModal(n.data.innerPost.value,e)}},n.artistServicesAvailable=function(e,t){return e.author.id===t.id&&0===e.counters.collaborators&&!e.isFork}}]),angular.module("bandlab.search",[]);let WY="",VY=rd(zY);const qY=ay((e=>VY(e)),3e3);function zY(e){qY.cancel(),e.length<3||e===WY||(WY=e,Promise.resolve().then((()=>rb)).then((function(t){let{logSearchPerform:n}=t;n(e)})))}function HY(e,t,n){return 200===n&&(e.post.creator=e.creator),e}function GY(e,t){if(!t)return;let[n,o,r]=function(e){let[t,n,o]=_y(e);t/=255,n/=255,o/=255;const r=Math.max(t,n,o),i=Math.min(t,n,o);let a,s;const l=(r+i)/2;if(r===i)a=s=0;else{var c=r-i;switch(s=l>.5?c/(2-r-i):c/(r+i),r){case t:a=(n-o)/c+(n<o?6:0);break;case n:a=(o-t)/c+2;break;case o:a=(t-n)/c+4}a/=6}return[a,s,l]}(t);r=r>=.8?.6:r;const i=e.style;i.setProperty("--dominant-color",`hsl(${360*n}, ${100*o}%, ${100*r}%)`),i.setProperty("--dominant-color-background",`hsla(${360*n}, ${100*o}%, ${100*r}%, .2)`),i.setProperty("--dominant-color-background-hover",`hsla(${360*n}, ${100*o}%, ${100*r}%, .4)`),i.setProperty("--dominant-color-text",`hsl(${360*n}, ${100*o}%, ${.7*r*100}%)`),i.setProperty("--dominant-color-button",`hsl(${360*n}, ${100*o}%, ${.7*r*100}%)`),i.setProperty("--dominant-color-button-hover",`hsl(${360*n}, ${100*o}%, ${.5*r*100}%)`)}angular.module("bandlab.search").controller("SearchCtrl",["$element","$filter","$scope","$state","$stateParams","$transitions","Search","SearchHistory",function(e,t,n,o,r,i,a,s){var l,c=!1;const u=i.onSuccess({},(function(){n.search=r.q,u(),p(n.search)}));function d(){return{"0history":t("limitTo")(s.get(),8),"1users":[]}}function p(e){angular.isUndefined(e)||0===e.length?n.suggestions=d():(e.length<3?(VY=rd(zY),qY.cancel()):qY(n.search),c||m(e))}function m(e){n.suggestions["0history"]=[],l=e,c=!0,a.users({query:e,limit:8}).then((function(e){let{data:o}=e;n.search===l&&(n.suggestions["1users"]=t("limitTo")(o,8))})).finally((function(){c=!1,n.search&&n.search!==l&&m(n.search)}))}n.logSearchPerform=zY,n.suggestions=d(),n.goToResults=function(e){o.go("search.results",{q:e,reveal:null}),zY(e),VY=rd(zY)},e.on("click",(function(t){if(t.target.closest("[ui-sref]")&&n.search){const o=function(t){return Array.from(e[0].querySelectorAll("[ui-sref]")).findIndex((e=>e.contains(t.target)))}(t);Promise.resolve().then((()=>rb)).then((function(e){let{logSearchClickthrough:t}=e;t("user_profile_open",o)})),zY(n.search),VY=rd(zY)}})),n.$watch("search",p)}]),angular.module("bandlab.search").controller("SearchResultsCtrl",["$analytics","$element","$location","$q","$scope","$stateParams","hiddenTag","PlayerHistory","Search",function(e,t,n,o,r,i,a,s,l){var c,u=i.q,d=12,p=null,m=!1,f=n.url();if(r.loadMore=v,r.$parent.query=i.q,r.filter=i.filter,r.isHiddenTag=a,r.isHiddenResults=!i.reveal,!u||0===u.length)return r.results=[],void(r.infiniteScrollEnded=!0);function h(e,n){return Array.from(t[0].querySelectorAll(e)).findIndex((e=>e.contains(n.target)))}if(e.eventTrack(`Search in ${r.filter}`,{category:"Search",label:u}),t.on("click",(function(e){if(e.target.hasAttribute("href")){const t=function(e){switch(!0){case!!e.target.closest("user-tile"):return["user_profile_open",h("user-tile",e)];case!!e.target.closest("band-tile"):return["band",h("band-tile",e)];case!!e.target.closest("post-card"):return["hashtag_post",h("post-card",e)];case!!e.target.closest("project-tile"):return["project",h("project-tile",e)];case!!e.target.closest("album-tile"):return["album_open",h("album-tile",e)];case!!e.target.closest("collection-tile"):return["playlist_open",h("collection-tile",e)];case!!e.target.closest("community-tile"):return["community",h("community-tile",e)];default:return[]}}(e);if(!t.length)return;Promise.resolve().then((()=>rb)).then((function(e){let{logSearchClickthrough:n}=e;n(...t)}))}})),"top"===r.filter)return s.setCurrentPageContext({loader:null,url:f}),void o.all([l.users({limit:3,query:u}).then((function(e){let{data:t}=e;r.users=t})),l.bands({limit:3,query:u}).then((function(e){let{data:t}=e;r.bands=t})),l.projects({limit:3,query:u}).then((function(e){let{data:t}=e;r.projects=t})),l.collections({limit:3,query:u}).then((function(e){let{data:t}=e;r.collections=t})),l.posts({limit:10,tag:u.replace("#","")}).then((function(e){let{data:t}=e;r.posts=t,s.pushQueueSongs(t,f)})),l.albums({limit:3,query:u}).then((function(e){let{data:t}=e;r.albums=t})),l.communities({limit:3,query:u}).then((function(e){let{data:t}=e;r.communities=t}))]).then((function(){r.infiniteScrollEnded=!0,r.results={length:r.users.length+r.bands.length+r.projects.length+r.collections.length+r.posts.length+r.albums.length+r.communities.length}}));function g(){return m?o.resolve({data:[]}):((c=l[r.filter]({after:p,limit:d,query:"posts"!==r.filter?u:null,tag:"posts"===r.filter?u.replace("#",""):null})).then((function(e){m=e.paging.itemsCount<d,p=e.paging.cursors.after})),c)}function v(){return r.infiniteScrollEnded?o.resolve():c=c.then((function(e){let{data:t}=e;r.infiniteScrollEnded=m,r.results=r.results||[];const n=r.results.length;return r.results=_.uniqBy(r.results.concat(t),"id"),s.pushQueueSongs(r.results.slice(n),f),g()}))}Promise.resolve().then((()=>rb)).then((function(e){let{logSearchCategoryOpen:t}=e;t({collections:"playlists",posts:"hashtag_posts"}[r.filter]??r.filter)})),"posts"===r.filter&&s.setCurrentPageContext({loader:v,url:f}),g().then(r.loadMore),r.$on("$song:changed",(function(e,t){"delete"===t.action&&(Gf(r.results,{id:t.song.id}),r.results.length<d&&r.loadMore())}))}]),angular.module("bandlab.search").directive("blSuggestions",["$animate","$compile","$templateRequest","$transitions","SearchHistory",function(e,t,n,o,r){return{restrict:"A",scope:{chooseSuggestionCallback:"&blChooseSuggestionCallback",blurOnSelect:"=blBlurOnSelect",history:"=blHistory",search:"=ngModel",suggestions:"=blSuggestions"},link:function(i,a,s){var l,c,u,d,p=angular.isDefined(s.blChooseSuggestionCallback),m="parent"===s.blSuggestionsContainer&&a[0].parentElement||a[0].closest("main")||a[0].closest(".view-overlay")||a[0].closest(".modal-overlay")||document.body,f=!!a[0].closest(".view-overlay"),h=a[0].closest(".view-overlay")?null:"down";function g(){u(),window.removeEventListener("mousedown",b,{capture:!0}),window.removeEventListener("resize",v),window.removeEventListener("wheel",v),l&&e.leave(l).then((function(){c=null,l=null}))}function v(){const e=a[0].getBoundingClientRect();h||(h=e.bottom>window.innerHeight-200?"up":"down"),"parent"===s.blSuggestionsContainer?(l[0].style.left=0,l[0].style.top="100%"):(l[0].style.left=`${e.left}px`,"down"===h?l[0].style.top=`${e.bottom+window.scrollY}px`:l[0].style.bottom=`${window.innerHeight-e.top+window.scrollY}px`)}function b(e){l[0].contains(e.target)||a[0].contains(e.target)||g()}function y(){i.active=null,d=null,_.forEach(i.suggestions,(function(e,t){i.suggestions[t]=[]})),g()}function w(e,t){var n=e.charAt(0),o=Object.keys(i.suggestions).sort(),r=t?o[+n-1]:o[+n+1];return r=r||(t?o[o.length-1]:o[0]),i.suggestions[r].length>0?r:w(r,t)}i.isActive=function(e){return i.active===e},i.setActive=function(e,t){i.active=e,d=t},i.chooseSuggestion=function(e,t){i.blurOnSelect?a[0].blur():a[0].focus(),i.history&&r.push(e),p&&(t.preventDefault(),t.stopPropagation(),i.chooseSuggestionCallback({suggestion:e}),i.active=null)},i.clearHistory=function(e){e.stopPropagation(),r.clear(),i.suggestions["0history"]=[]},i.$watchCollection("suggestions",(function(e){e&&e[d]&&(i.active=e[d][0],l&&(l[0].scrollTop=0))})),i.i18n={history:"History",users:"Users"},a.on("keydown mousedown",(function(r){var h,$,k;(c=c||n(s.blTemplate).then((function(n){l=t(`<div class="bl-suggestions-positioner">${n}</div>`)(i),v(),e.enter(l,m,m.lastChild),window.addEventListener("resize",v),window.addEventListener("mousedown",b,{capture:!0}),u=o.onStart({},g),i.$on("$destroy",g),f&&window.addEventListener("wheel",v)}))).then(v),h=Object.values(i.suggestions||{}).some((function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).length})),h&&document.activeElement===a[0]&&(d||(d=Object.keys(i.suggestions).sort()[0]),40===r.which||38===r.which?(r.preventDefault(),$=i.suggestions[d].indexOf(i.active),$=40===r.which?$+1:$-1,i.active=i.suggestions[d][$],angular.isUndefined(i.active)&&(d=w(d,38===r.which),k=40===r.which?0:i.suggestions[d].length-1,i.active=i.suggestions[d][k]),setTimeout((function(){const e=l[0].querySelector(".mentions-suggestion.active");e&&e.scrollIntoView({block:"nearest"})}))):13===r.which||9===r.which?(i.active&&(p||l[0].querySelector(".search-suggestion-item-active a").click(),i.chooseSuggestion(i.active,r),i.$apply()),y()):27===r.which?(y(),r.preventDefault()):i.active=null,i.$digest())}))}}}]).filter("highlight",["$sce",function(e){return function(t,n){if(t){var o=n?t.replace(new RegExp(n.replace(/[^\w\s]/gi,""),"gi"),"<mark>$&</mark>"):t;return e.trustAsHtml(o)}}}]),angular.module("bandlab.search").directive("miniSearch",["$state",function(e){return{restrict:"A",require:"?ngModel",controller:["$scope",function(t){t.goToResults=function(t){if(e.includes("library"))e.go(".",{search:t},{reload:!0});else if(angular.isDefined(t)&&""!==t){if(e.go("search.results",{q:t}),t.length<3)return;Promise.resolve().then((()=>rb)).then((function(e){let{logSearchPerform:n}=e;n(t)}))}}}],link:function(e,t){function n(e){if(e.relatedTarget&&(e.relatedTarget.closest(".tab-bar-search")||e.relatedTarget.closest(".search-form")))return;const o=e.relatedTarget&&e.relatedTarget.closest(".search-dropdown")?500:0;t[0].querySelector('input[type="search"]').removeEventListener("blur",n),setTimeout((function(){t.removeClass("active"),document.activeElement.blur()}),o)}e.toggleInput=function(e){if(t.hasClass("active"))t.removeClass("active"),document.activeElement.blur();else{e.preventDefault(),t.addClass("active");const o=t[0].querySelector('input[type="search"]');o.focus(),o.removeEventListener("blur",n),o.addEventListener("blur",n)}}}}}]),angular.module("bandlab.search").directive("searchSuggestions",["$rootScope","Search",function(e,t){return{restrict:"A",require:"ngModel",link:function(e,n,o,r){var i,a,s,l=!1;function c(){e.suggestions={"0users":[],"1tags":[]}}function u(n,o){l=!0,("users"===o?t.suggestedUsers({query:n,limit:15}):t.tags({query:n,limit:15})).then((function(t){let{data:n}=t;s||(e.suggestions="users"===o?{"0users":n,"1tags":[]}:{"0users":[],"1tags":n})})).finally((function(){l=!1,""===a||a===n||s||u(a,o)}))}r.$formatters.push((function(e){return""===e&&c(),e})),r.$viewChangeListeners.push((function(){if(i=(i=r.$viewValue.substring(0,n[0].selectionStart)).replace(/\n/g," "),/\s$/.test(i))return c();i=(i=i.split(" "))[i.length-1],a=i.substring(1),"@"===i.charAt(0)&&a.length&&!s?l||u(a,"users"):"#"===i.charAt(0)&&a.length&&!s?l||u(a,"tags"):c(),s=!1})),e.completeMention=function(e){var t,o=e.username?e.username:e.name,i=r.$viewValue,l=i.substring(0,n[0].selectionStart-a.length),u=i.substring(n[0].selectionStart,i.length);c(),s=!0,r.$setViewValue(`${l+o} ${u}`),r.$render(),t=l.length+o.length+1,n[0].setSelectionRange(t,t)}}}}]),angular.module("bandlab.search.routes",["ui.router"]).config(["$stateProvider",function(e){e.state("search",{url:"/search",redirectTo:"search.results",templateUrl:"https://www.bandlab.com/web-app/search/views/search-layout-ea8f4325.html"}).state("search.results",{url:"/:filter?q&{reveal:bool}&triggeredFrom",params:{filter:"top",q:"bandlab",rewriteTracking:["$stateParams",function(e){return()=>`/search/${e.filter}`}]},templateUrl:"https://www.bandlab.com/web-app/search/views/search-results-0d649a8b.html",controller:"SearchResultsCtrl",resolve:{hiddenTag:["$http","$stateParams",function(e,t){return e.get("https://www.bandlab.com/api/v2.0/options",{cache:!0}).then((e=>{let{data:{hiddenTags:n=[]}}=e;return n.tags.indexOf(t.q.toLowerCase().replace("#",""))>-1})).catch(angular.noop)}]}}).state("search.results.shout",{url:"/shout?postId",reloadOnSearch:!1,resolve:{thePost:["$stateParams","Post",function(e,t){return t.get({id:e.postId}).$promise}]},onEnter:DL,onExit:jL,views:{"overlay@":{templateUrl:"https://www.bandlab.com/web-app/shout/views/shout-image-view-922d75e9.html",controller:["$scope","$state","$stateParams","thePost",function(e,t,n,o){e.post=o,e.$on("$post:delete",(function(e,r){o.id===r.post.id&&t.go("search.results",{filter:n.filter})})),e.$on("$user:relationChanged",(function(e,n){"block"===n.type&&o.creator.id===n.user.id&&t.go("^")})),e.updateCounter=function(t){e.post.counters.comments=t(e.post.counters.comments)}}]}}})}]),angular.module("bandlab.search").factory("Search",["$http","$q",function(e,t){const n="https://www.bandlab.com/api/v1.3/search";return{albums:function(e){return o(`${n}/albums`,e)},all:function(e){return o(n,e)},bands:function(e){return o(`${n}/bands`,e)},collaborators:function(e){return o(`${n}/collaborators`,e)},collections:function(e){return o(`${n}/collections`,e)},communities:function(e){return o(`${n}/communities`,e)},posts:function(){let{types:e="image;link;revision;text;video",...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o("https://www.bandlab.com/api/v1.3/posts",{types:e,...t}).then((function(e){return e.data.forEach((function(e){e.revision&&(e.revision.postId=e.id)})),e}))},projects:function(e){return o(`${n}/songs`,e)},suggestedUsers:function(e){return o("https://www.bandlab.com/api/v1.3/mentions/suggestions",e)},tags:function(e){return o(`${n}/tags`,e)},users:function(e){return o(`${n}/users`,e)}};function o(t,n){return e({url:t,params:{limit:10,...n},cache:!0,preservePagination:!0}).then((function(e){return e.data}))}}]),angular.module("bandlab.search").factory("SearchHistory",(function(){var e;try{e=JSON.parse(ql.history)}catch(t){e=[]}return{clear:function(){ql.removeItem("history"),e=[]},get:function(){return e},push:function(t){var n=_.find(e,(function(e){return e.id===t.id}));angular.isDefined(n)||(e.unshift(t),ql.history=JSON.stringify(e))}}})),"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("/service-worker.js?v=1723013681604").catch((()=>{}))})),angular.module("bandlab.shout",[]),angular.module("bandlab.shout").directive("backgroundCaptionTile",(function(){return{restrict:"E",replace:!0,scope:{post:"="},templateUrl:"https://www.bandlab.com/web-app/shout/partials/_background-caption-tile-4f08f9f4.html"}})),angular.module("bandlab.shout").directive("imageTile",(function(){return{restrict:"E",replace:!0,scope:{image:"=",post:"="},templateUrl:"https://www.bandlab.com/web-app/shout/partials/_image-tile-572cc9de.html"}})),angular.module("bandlab.shout").factory("VideoTile",(function(){var e={current:null};return"IE"!==nh.browser.name&&"Safari"!==nh.browser.name&&"iOS"!==nh.os.name&&window.addEventListener("storage",(function(t){"playing"===t.key&&e.current&&e.current.pause()})),e})).directive("videoTile",["$injector",function(e){return{restrict:"E",replace:!0,scope:{file:"=?",post:"=?",video:"=?",attachment:"=?",thumbnail:"=?",onPlayEvent:"&"},template:'<div style="display: contents;"></div>',link:async function(t,n){const o=Mt({attachment:t.attachment,file:t.file,onPlayEvent:t.onPlayEvent,post:t.post,thumbnail:t.thumbnail,video:t.video});t.$watch((function(){Object.assign(o,{attachment:t.attachment,file:t.file,onPlayEvent:t.onPlayEvent,post:t.post,thumbnail:t.thumbnail,video:t.video})}));const r=import("./chunk-a5d786a0.js").then((function(r){let{mount:i}=r;return i(n[0],{$injector:e,scope:t},o)}));t.$on("$destroy",(async function(){(await r).unmount()}))}}}]),angular.module("bandlab.show.routes",["ui.router"]).config(["$stateProvider",function(e){r.$inject=["Page"],o.$inject=["$transition$","Page","theShow"];const t=document.createElement("video");function n(){t.muted=!1,window.removeEventListener("pointerdown",n),window.removeEventListener("keydown",n)}function o(e,t,n){t.setMetadata({title:`${n.name} by ${n.creator.name} | BandLab`,description:n.description?n.description:"",image:`${n.picture.url}640x360`,imageHeight:"360",imageWidth:"640"}),vj()}function r(e){e.clearMetadata()}t.id="livestream",t.setAttribute("autoplay",""),t.setAttribute("disablePictureInPicture","true"),t.setAttribute("playsinline",""),t.muted=!0,window.addEventListener("pointerdown",n),window.addEventListener("keydown",n),e.state("show",{url:"/shows/{id}",onEnter:o,onExit:r,isCompatible:function(){if(!("MediaSource"in window))return"unavailable"},resolve:{theShow:["$transition$","Show",function(e,t){const{id:n}=e.params();return t.get({id:n}).$promise}]},templateUrl:"https://www.bandlab.com/web-app/show/views/show-page-8507a3f5.html",controller:["$analytics","$compile","$injector","$scope","$state","authService","appActions","AppNotifications","Chat","ChatNotifications","ConfirmModal","Me","Player","Modal","ShowModals","theShow","User",function(e,n,o,r,i,a,s,l,c,u,d,p,m,f,h,g,v){const b=n('\n        <span\n          users-modal-list="vm.getLikers"\n          likers\n          likers-count="{{ show.post.counters.likes }}"\n          likers-entity-type="posts"\n          likers-entity-id="{{ ::show.post.id }}">\n          <like\n            class="{{ show.post.isLiked ? \'button-cta-light\' : \' button-scd\' }} button-height-32 button-padding-12 button-rounded"\n            ng-model="show.post"\n            like-entity="post"\n            resource-id="{{ ::(show.post.id) }}"\n            ng-click="toggleLike()">\n            <svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path d="M12 19.5c.21 0 .53-.16.78-.32 4.6-2.88 7.55-6.26 7.55-9.68 0-2.95-2.1-5-4.72-5-1.64 0-2.87.88-3.61 2.2a4 4 0 00-3.6-2.2c-2.63 0-4.73 2.05-4.73 5 0 3.42 2.95 6.8 7.55 9.68.25.16.57.32.78.32z" fill="currentColor"/></svg>\n            <span class="semibold-12" ng-if="show.post.counters.likes">\n              {{ show.post.counters.likes | bigNumber }}\n            </span>\n          </like>\n        </span>\n      ')(r),y=n('\n        <a class="dropdown-menu-link"\n           share-modal\n           share-modal-callback="sendInsights"\n           share-modal-type="\'Show\'"\n           share-modal-object="show">\n          <i class="icon-share"></i>\n          <span>Share</span>\n        </a>\n      ')(r);r.show=g,r.sendInsights=h.sendInsights,r.vm={getLikers:function(){return v.likersWithCursor({entity:"posts",entityId:g.post.id}).$promise}};const{reportMessage:w}=XO(o);function $(e){function t(n){return c.getBlockedUsers({conversationId:g.conversationId,limit:100,after:n}).then((function(n){return n&&n.data&&n.data.find((t=>t.id===e.id))?(l.addNotification({title:"The user is already restricted from messaging in this chat",classList:"alert",autoclose:8e3}),!0):!!n.paging.cursors.after&&t(n.paging.cursors.after)}))}new d({confirmLabel:"Restrict",contentScope:{title:`Restrict ${e.username}?`,message:"New comments from this user will not be visible to anyone in the live stream."},onConfirm:function(){t().then((function(t){t||c.addBlockUser({conversationId:g.conversationId,userId:e.id}).then((function(){l.addNotification({title:`Actions restricted for ${e.username}`,classList:"success",autoclose:8e3})}))}))}}).show()}function k(){new f({id:"displayBlockedModal",templateUrl:"https://www.bandlab.com/web-app/show/partials/_blocked-users-modal-bd31e0c2.html",contentScope:{show:g}}).show()}function S(e){new f({id:"createShowModal",templateUrl:"https://www.bandlab.com/web-app/contact/partials/report-5c109c3e.html",contentScope:{toReport:e}}).show()}function _(t){let{user:n,successCallback:o}=t;e.eventTrack("Support Me",{category:"Send Tip",label:"Show"}),Promise.resolve().then((()=>Ap)).then((function(e){let{logEvent:t}=e;t("tipjar_send_tip_start")})),new f({id:"tipSetModal",template:'<tip-user-form user="user" success-callback="successCallback"></tip-user-form>',contentScope:{user:n,successCallback:o}}).show()}function P(){new f({id:"createShowModal",templateUrl:"https://www.bandlab.com/web-app/show/partials/_go-live-a95c8927.html"}).show()}function M(e){switch(e.type){case"share-post-modal":return h.sharePostModal(g);case"modal":return h.shareAsyncModal(e,g)}}m.pause(),Promise.all([import("./chunk-40ada0e4.js"),import("./chunk-db4836aa.js"),import("./chunk-0ff63c58.js"),import("./chunk-19bfaadd.js"),import("./chunk-666495bd.js"),import("./chunk-7364ae50.js"),import("./chunk-72c44959.js"),u.getWebSocket(p.isAnonymous&&g.id),xc("https://player.live-video.net/1.16.0/amazon-ivs-player.min.js")]).then((e=>{let[{renderShowPage:n,unmountShowPage:o},{stopShow:c},{mountEndedShow:u},{mountShareToFeed:d},{mountStreamSettings:m},{mountPlayer:f},{mountShow:v},T]=e;const C=IVSPlayer.create();C.attachHTMLVideoElement(t),n({$likeButton:b,$shareButton:y,AppNotifications:l,show:{...g},viewer:p,confirmEmail:()=>a.displayConfirmationEmailError("comment"),stopShow:c,displayBlockUserModal:$,displayBlockedModal:k,reportMessage:w,displayReportModal:S,displayTipModal:_,checkAllowed:s.checkAllowed,chatConnection:T,createShout:h.createShout,video:t,startNewLivestream:P,$state:i,ivsPlayer:C,shareShow:M,mountEndedShow:u,mountPlayer:f,mountShareToFeed:d,mountStreamSettings:m,mountShow:v}),r.$on("$destroy",(()=>{C.delete(),o()}))})).catch((e=>{404===e.status&&i.go("404",{},{location:"replace"})})),Promise.resolve().then((()=>tv)).then((function(e){let{trackActionsAndPromptTip:t}=e;t(o,r,{user:g.creator,entityId:g.id})}))}]})}]),angular.module("bandlab.web").controller("ShowBlockedUsersCtrl",["$q","$scope","Chat",function(e,t,n){var o,r=null,i=!1;function a(){return i?e.resolve([]):o=n.getBlockedUsers({after:r,limit:20,conversationId:t.show.conversationId}).then((function(e){return i=e.paging.itemsCount<e.paging.limit,r=e.paging?.cursors?.after||0,e.data}))}t.loadMore=function(){return t.infiniteScrollEnded?e.resolve():(o=o.then((function(e){return t.infiniteScrollEnded=i,t.users=t.users||[],t.users=t.users.concat(e),a()})),o)},t.unblockUser=function(e){n.removeBlockUser({conversationId:t.show.conversationId,userId:e}).then((function(){t.users=t.users.filter((t=>t.id!==e))}))},a().then(t.loadMore)}]),angular.module("bandlab.web").controller("ShowCreateCtrl",["$analytics","$rootScope","$scope","$state","$timeout","appActions","Me","Show",function(e,t,n,o,r,i,a,s){const l=a;n.show=new s({name:`${l.name}s Show`,state:"Starting"}),n.closeModal=()=>{t.$broadcast("createShowModal","close")},n.createShow=()=>{if(i.checkAllowed("stream"))return delete n.errorMessage,n.isLoading=!0,n.show.$save({id:l.id}).then((i=>(t.$broadcast("createShowModal","close"),t.$broadcast("$show:changed",{action:"create",show:i}),e.eventTrack("Create Show",{category:"Show"}),localStorage.removeItem("wasShared"),function(e){r((()=>{n.isLoading=!1,o.go("show",{id:e.id})}),1e3)}(i),i))).catch((e=>(n.isLoading=!1,n.showForm.$setPristine(),n.errorMessage=e.data.message,403===e.status&&(n.error="suspended"),Promise.reject(e))))}}]),angular.module("bandlab.web").directive("showsCard",["$injector",function(e){return{link:function(t,n){const o=import("./chunk-42ab9ca8.js").then((function(t){let{mountShowsCard:o}=t;return o(n[0],{$injector:e,removeElement:r})}));function r(){n.remove()}t.$on("$destroy",(async function(){(await o).unmount()}))}}}]),angular.module("bandlab.web").component("showTile",{bindings:{post:"=",show:"="},templateUrl:"https://www.bandlab.com/web-app/show/partials/_show-tile-33da9534.html",controllerAs:"vm"}),angular.module("bandlab.web").factory("Show",["$http","$resource",function(e,t){const n="https://www.bandlab.com/api/v1.3/shows";return t(n,{},{save:{method:"POST",params:{id:"@id"},url:"https://www.bandlab.com/api/v1.3/users/:id/shows"},delete:{method:"DELETE",params:{id:"@id"},url:`${n}/:id`},get:{method:"GET",params:{id:"@id"},url:"https://www.bandlab.com/api/v1.3/shows/:id",transformResponse:[...e.defaults.transformResponse,HY]},getLiveShows:{method:"GET",preservePagination:!0,url:"https://www.bandlab.com/api/v1.3/shows"}})}]),angular.module("bandlab.web").factory("ShowModals",["$analytics","$rootScope","$state","appActions","AppNotifications","ChatHelper","Me","Modal","Post",function(e,t,n,o,r,i,a,s,l){const c={shareWithCommunityModal:"https://www.bandlab.com/web-app/community/partials/_share-with-community-modal-17658a58.html",messageModal:"https://www.bandlab.com/web-app/chat/partials/_share-as-message-modal-b30bb0c1.html"};let u;function d(e){return m(e.id).then((function(t){return{...e.post,creator:e.creator,type:"Link",link:t}}))}function p(e,t){Promise.resolve().then((()=>rb)).then((function(o){let{logPostShare:r}=o;r(e,t,_p(n))}))}function m(e){return i.getLinkPreview(`https://www.bandlab.com/shows/${e}`).then((e=>{let[t]=e;return t.object}))}return{sendInsights:p,sharePostModal:function(e){if(o.checkAllowed("shareOnBandLab"))return p(e,"repost"),d(e).then((function(n){u=new s({class:"share-post-modal",templateUrl:"https://www.bandlab.com/web-app/common/share/_share-post-modal-07fae8fd.html",contentScope:{me:a,post:n,submitPost:f(e),shareModalCallback:p},onCreate:e=>{u.element=e[0].querySelector(".modal"),u.element&&u.element.classList.remove("modal"),setTimeout((()=>t.$broadcast("elastic:adjust")),0)},onDestroy:function(){u=null}}),u.show()}))},shareAsyncModal:function(e,t){let{id:n}=e;if(o.checkAllowed("shareOnBandLab"))return p(t,"messageModal"===n?"bl_chat":"community"),d(t).then((function(e){u=new s({templateUrl:c[n],id:n,contentScope:{attachment:{object:{...e,caption:e.message},type:"Show"},modalId:n,shareModalCallback:p},onDestroy:function(){u=null}}),u.show()}))},createShout:function(t){return m(t.id).then((function(e){return{caption:`Streaming at https://www.bandlab.com/shows/${t.id}    #liveonbandlab`,link:e}})).then((function(e){return l.createPost({caption:t.description||e.caption,id:a.id,entity:"users",link:e.link,backgroundId:null}).$promise})).then((()=>{e.eventTrack("Create Post",{category:"Post",label:"Show Link"}),r.addNotification({autoclose:5e3,content:"Post published",title:"Upload completed"})})).catch((()=>{r.addNotification({autoclose:5e3,content:"Unable to publish post",classList:"alert",title:"Unable to upload  check your connection"})}))}};function f(e){return function(t,n){return m(e.id).then((function(e){return l.createPost({caption:t,id:a.id,entity:"users",link:e}).$promise})).then((function(){n.$setPristine(),u.destroy(),r.addNotification({content:"Post shared to feed",autoclose:3e3})})).catch((function(){r.addNotification({title:"Unable to create post",classList:"alert",autoclose:5e3})}))}}}]),angular.module("bandlab.song",[]),angular.module("bandlab.song").controller("ProjectCollaboratorsCtrl",["$scope","ConfirmModal","Invite","User",function(e,t,n,o){function r(){o.getCollaborators({songId:e.song.id,accepted:!0,limit:50}).$promise.then((function(t){let{data:n}=t;e.collaborators=n}))}function i(){n.query({id:e.song.id,entity:"songs",accepted:!1,limit:50}).$promise.then((function(t){e.pendingInvitedUser=[],e.pendingInvitedExternalUser=[],t.forEach((function(t){var n;t.user?((n=new o(t.user)).invite=t,e.pendingInvitedUser.push(n)):((n=new o({email:t.email})).invite=t,e.pendingInvitedExternalUser.push(n))}))}))}e.removeCollaborator=function(n){new t({confirmLabel:"Remove",contentScope:{title:"Remove this collaborator?",message:`<p>${n.name} will lose access to the existing project.</p>`},onConfirm:function(){e.song.$leave({id:e.song.id,userId:n.id}).then((function(){e.collaborators=e.collaborators.filter((function(e){return e!==n}))}))}}).show()},e.$on("$invite:changed",(function(){r(),i()})),r(),i()}]),angular.module("bandlab.song").controller("ProjectEditCtrl",["$analytics","$cookies","$rootScope","$scope","$state","AppNotifications","Band","ConfirmModal","Me","Modal","PlayerHistory","Song",function(e,t,n,o,r,i,a,s,l,c,u,d){function p(){return n.$broadcast("$song:changed",{action:"mark-deleted",song:o.song}),new d(o.song).$delete().then((function(){u.removeSong(o.song.id),n.$broadcast("$song:changed",{action:"delete",song:o.song}),e.eventTrack("Delete Song",{category:"Song"}),r.includes("track")&&r.go("library")})).catch((e=>{n.$broadcast("$song:changed",{action:"unmark-deleted",song:o.song}),i.addNotification({title:"Unable to delete project",content:_.get(e,"data.message")||_.get(e,"message","Unknown error"),autoclose:5e3,classList:"alert"})}))}o.songBackup=o.song,o.song=new d(o.song),o.changeError=!1,o.getBands=function(){o.bands=a.fromUser({userId:l.id,limit:50})},o.$on("$file:uploadSuccess",(function(e,t){o.song.picture={...t}})),o.$on("$song:changed",(function(e,t){let{action:n,data:r}=t;"picture"===n&&Object.assign(o.song.picture,r.picture)})),o.createBandFirst=function(){const e=o.$on("$band:changed",(function(e,t){"create"===t.action&&o.bands.unshift(t.band)}));return new c({id:"createBandModal",templateUrl:"https://www.bandlab.com/web-app/band/partials/_band-new-cb8b2674.html",onConfirm:()=>e()}).show()},o.moveProject=async function(){var t={id:o.song.id,bandId:o.songForm.bandId.$modelValue};let i="You wont be able to undo this action.";"true"===await Mp(l,"band_permissions_update_enabled")&&(i="The project will be permanently moved to the selected band. Only admins of the band will be able to delete the project");const a=new s({confirmLabel:"Move",contentScope:{title:"Move this project?",message:`<p>${i}</p>`},onConfirm:function(){o.moveError=!1,o.movePending=!0,o.moveSuccess=!1,d.update(t).$promise.then((function(t){o.movePending=!1,Object.assign(o.song,t),e.eventTrack("Move Song",{category:"Song"}),n.$broadcast("$song:changed",{action:"move",song:o.song}),"library.projects.songs"!==r.current.name?(o.moveSuccess=!0,r.go("library.projects.songs",{category:t.author.username})):(n.$broadcast("moveProjectModal","close"),a.destroy())})).catch((function(){o.songForm.$setPristine(),o.moveError=!0,o.movePending=!1}))},onDestroy:function(){o.songForm.$setPristine()}});a.show()},o.updateSong=function(){var t={description:o.song.description||"",id:o.song.id,isForkable:o.song.isForkable,name:o.song.name,slug:o.song.slug};d.update(t).$promise.then((function(t){Object.assign(o.songBackup,t),o.song=t,o.songForm.$setPristine(),i.addNotification({title:"Project settings updated",action:`<a class="button-scd button-height-32 button-padding-16 button-rounded" href="${r.href("songId",{id:o.song.id})}"><i class="icon-arrow-right"></i></a>`,classList:"success",autoclose:8e3}),n.$broadcast("$song:changed",{action:"update",id:o.song.id,song:o.song}),n.$broadcast("renameProjectModal","close"),e.eventTrack("Update Song",{category:"Song"})})).catch((function(e){o.changeError=e?.data?.errorCode??!0,o.songForm.$setPristine()}))},o.duplicateSong=async function(){const e={description:o.song.description??"",isForkable:o.song.isForkable,name:o.song.name};o.song.picture.id&&(e.pictureId=o.song.picture.id);const t=await Uu.post(`https://www.bandlab.com/api/v1.3/projects/${o.song.id}/duplicates`,{json:e}).json();Promise.resolve().then((()=>rb)).then((function(e){let{logDuplicateSong:n}=e;n({original_project_id:o.song.id,project_id:t.id,triggered_from:"user_library"})})),r.go("songId",{id:t.id})},o.confirmDeleteProject=function(){new s({confirmLabel:"Delete",toFocusConfirm:!0,contentScope:{title:"Delete this project?",message:`<p>${o.song.bandId?"All band members will lose access to any existing projects owned by the band.":"You can restore your project within the next 30 days."}</p>`},onConfirm:p}).show()},o.confirmLeaveProject=function(){new s({confirmLabel:"Leave",contentScope:{title:"Leave collaboration?",message:"<p>You wont be able to undo this action.</p>"},onConfirm:function(){o.song.$leave({id:o.song.id,userId:l.id}).then((function(){n.$broadcast("$song:changed",{action:"leave",song:o.song}),e.eventTrack("Leave Song",{category:"Song"})}))}}).show()},o.restoreProject=function(e){return n.$broadcast("$song:changed",{action:"mark-deleted",song:e}),d.update({id:e.id,status:"Active"}).$promise.then((function(e){n.$broadcast("$song:changed",{action:"restore",song:e}),"true"!==t.get("webview")&&i.addNotification({title:"Project restored",content:"Your project has been restored to your Library.",image:`${e.picture.url}48x48 1x, ${e.picture.url}96x96 2x`,action:`\n              <div ng-click="hide()">\n                <a class="button-scd button-height-32 button-padding-16 button-rounded" href="${r.href(`${e.author.type.toLowerCase()}Song`,{username:e.author.username,slug:e.slug})}"><i class="icon-arrow-right"></i></a>\n              </div>\n            `,classList:"project",autoclose:5e3})})).catch((t=>{n.$broadcast("$song:changed",{action:"unmark-deleted",song:e}),i.addNotification({title:"Cannot restore project",content:_.get(t,"data.message")||_.get(t,"message","Unknown error"),autoclose:5e3,classList:"alert"})}))}}]),angular.module("bandlab.song").controller("RevisionDownloadCtrl",["$analytics","$http","$scope","EditorLoader","RevisionImporter",function(e,t,n,o,r){n.isLoading=!1,n.isDone=!1,n.openDownloadModal=r.downloadMixdown,n.openDownloadStemsModal=r.downloadStems,n.downloadMixdown=function(i,a){if(n.isLoading)return;let s=n.$on("$destroy",(function(){s(),s=null}));n.isLoading=!0;const l=`https://www.bandlab.com/api/v1.3/revisions/${i.id}/mixdown/download-options/${a.id}`,c=performance.now();return t.post(l).then((function(){return r.pollOnDemand(l,(()=>!s))})).then((function(t){let{data:{id:o,url:r}}=t;e.eventTrack("Download Mixdown",{category:"Revision",label:o}),"mastered"===a.version?Promise.resolve().then((()=>rb)).then((function(e){let{logMasteringDownload:t}=e;t({mastering_preset:mu(i.mastering.preset),file_type:"mixdown"})})):i.mastering&&(r=r.replace(new RegExp(i.mixdown.id,"g"),i.mastering.drySampleId)),Gh(r),Promise.resolve().then((()=>fv)).then((e=>{let{logEvent:t}=e;t("download_success",{format:a.id,time:(performance.now()-c)/1e3})})),n.isLoading=!1,n.isDone=!0,setTimeout((function(){n.isDone=!1,n.$applyAsync()}),3e3)})).catch((function(){o.flushQueue()}))}}]),angular.module("bandlab.song").controller("RevisionEditCtrl",["$analytics","$cookies","$injector","$rootScope","$scope","ConfirmModal","Me","Post","Revision",function(e,t,n,o,r,i,a,s,l){var c=r.$parent.revision;function u(t){const i=r.revision.availabilitySetting,a=r.revision.isExplicit;return s.update({id:c.postId,isExplicit:a,state:i}).$promise.then((function(e){return r.revision.post=e,l.update({description:r.revision.description,genres:r.revision.genres,id:r.revision.id,mastering:r.revision.mastering,mixdown:r.revision.mixdown}).$promise.then((function(t){return Object.assign(t.post,e),t}))})).then((function(t){return Object.assign(t.song,c.song,t.song),Object.assign(c,t),o.$broadcast("$revision:changed",{action:"edit",revision:c}),o.$broadcast("editRevisionModal","close"),e.eventTrack("Update Revision",{category:"Revision"}),r.resolve?.(r.revision),"Public"===i&&bH(t,n),t})).catch((function(e){r.errorMessage=_.get(e,"data.message","Please try again"),t.$setPristine()}))}r.me=a,r.revision=new l({description:c.description,genres:c.genres,id:c.id,isPublic:c.isPublic,mastering:c.mastering,mixdown:c.mixdown,song:c.song}),s.get({id:c.postId}).$promise.then((function(e){r.revision.isExplicit=e.isExplicit,r.revision.availabilitySetting=e.state,"Private"===r.revision.availabilitySetting&&!1===r.canBePrivate&&(r.revision.availabilitySetting="Public")})),r.editRevision=function(e){delete r.errorMessage;const n="Private"!==r.revision.availabilitySetting&&!1===r.canBePrivate;if(r.revision.genres[0]&&"other"===r.revision.genres[0].id&&n&&!t.get("modalGenreWarnSeen")){const n=new Date(Date.now()+31536e6);return t.put("modalGenreWarnSeen","true",{expires:n}),new i({cancelLabel:"Change Genre",confirmLabel:"Continue",contentScope:{title:"Want to be discovered?",message:"<p>Your revision wont be visible on Explore unless you choose a different genre.</p>"},onCancel:function(){r.revisionForm.$setPristine()},onConfirm:function(){return u(e)}}).show()}return u(e)}}]),angular.module("bandlab.song").controller("RevisionForksCtrl",["$q","$scope","Post",function(e,t,n){var o,r=null,i=!1;if(0===t.revision.counters.forks)return t.infiniteScrollEnded=!0,void(t.posts=[]);function a(){return i?e.resolve([]):o=n.fromRevisionForks({revisionId:t.revision.id,after:r,limit:10}).$promise.then((function(e){return i=e.paging.itemsCount<e.paging.limit,r=_.get(e,"paging.cursors.after",0),e.data}))}t.loadMore=function(){return t.infiniteScrollEnded?e.resolve():o=o.then((function(e){return t.infiniteScrollEnded=i,t.posts=t.posts||[],t.posts=t.posts.concat(e),a()}))},a().then(t.loadMore)}]),angular.module("bandlab.song").controller("RevisionInviteLinkCtrl",["$scope","AppNotifications","EditorSocket",function(e,t,n){e.copyLink=function(){t.addNotification({title:"Copied to clipboard",classList:"success",autoclose:1e3})},n.getLink({song:e.song}).then((function(t){e.link=t}))}]),angular.module("bandlab.song").controller("RevisionMasterCtrl",["$scope","RevisionImporter",function(e,t){e.masterRevision=t.masterRevision}]),angular.module("bandlab.song").controller("RevisionMetadataFormCtrl",["$cookies","$scope","ConfirmModal","Me",function(e,t,n,o){function r(){t.resolve(t.revision),t.revisionForm.$setPristine()}t.me=o,t.defaultAvailability?t.revision.availabilitySetting=t.defaultAvailability:t.revision.availabilitySetting=t.canBePrivate?"Private":"Public",t.$watch("revision.song.isForkable",(function(e){e&&(t.displayAdvancedSettings=!0,t.revision.availabilitySetting="Public")})),t.$on("$file:uploadSuccess",(function(e,n){t.revision.song.pictureId=n.id,t.revision.song.picture=n,t.revisionForm.$setDirty()})),t.setRevisionData=function(){if(t.revision.isExplicit&&(t.revision.post={isExplicit:!0}),t.revision.genres[0]&&"other"===t.revision.genres[0].id&&"Private"!==t.revision.availabilitySetting&&!e.get("modalGenreWarnSeen")){const o=new Date(Date.now()+31536e6);return e.put("modalGenreWarnSeen","true",{expires:o}),new n({cancelLabel:"Change Genre",confirmLabel:"Continue",contentScope:{title:"Want to be discovered?",message:"<p>Your revision wont be visible on Explore unless you choose a different genre.</p>"},onCancel:function(){t.revisionForm.$setPristine()},onConfirm:function(){r()}}).show()}r()}}]),angular.module("bandlab.song").controller("RevisionSharePrivateCtrl",["$analytics","$scope","$state","Modal","Post",function(e,t,n,o,r){t.displayPrivateLink=function(t){r.getPrivateLink({id:t.postId}).$promise.then((function(i){e.eventTrack("Get Private Link",{category:"Revision"});var a={shareUrl:n.href("revisionSharedKey",{postId:t.postId,sharedKey:i.sharedKey},{absolute:!0})};return new o({contentScope:{modalData:a,renewLink:function(){r.getNewPrivateLink({id:t.postId}).$promise.then((function(o){e.eventTrack("Get New Private Link",{category:"Revision"}),a.shareUrl=n.href("revisionSharedKey",{postId:t.postId,sharedKey:o.sharedKey},{absolute:!0})}))}},templateUrl:"https://www.bandlab.com/web-app/song/partials/_revision-private-share-7c6cf62d.html"}).show()}))}}]),angular.module("bandlab.song").controller("RevisionUnpublishCtrl",["$analytics","$rootScope","$scope","ConfirmModal","Post",function(e,t,n,o,r){n.unpublishRevision=function(n){new o({confirmLabel:"Make Private",toFocusConfirm:!0,contentScope:{title:"Make track private",message:"<p>Making this track private will stop the active boost campaign and prevent this post from appearing on public feeds.</p>"},onConfirm:function(){return r.update({id:n.postId,state:"Private"}).$promise.then((function(o){n.isPublic=!1,n.post=o,t.$broadcast("$revision:changed",{action:"unpublish",revision:n}),e.eventTrack("Update Revision",{category:"Revision",label:"Unpublish"})}))}}).show()}}]),angular.module("bandlab.song").controller("SongRevisionsFeedCtrl",["$location","$scope","$state","$timeout","Band","Me","PlayerHistory","Post","Song","theSong","User",function(e,t,n,o,r,i,a,s,l,c,u){const d=e.url();let p=[];function m(e){e.target.closest(".project-history")||e.target.closest(".modal-overlay")||!t.visible||(t.visible=!1,o((function(){n.go("^")}),300))}function f(e){27===e.keyCode&&t.visible&&(t.visible=!1,o((function(){n.go("^")}),300))}function h(){let{after:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s.fromSong({songId:t.song.id,after:e}).$promise}a.setCurrentPageContext({loader:h,url:d}),c.collaborators=c.collaborators?.filter((e=>"Owner"!==e.role)),t.song=c,t.getCollaborators=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return u.getCollaborators(Object.assign({songId:c.id,includeOwner:!0},e)).$promise},t.exitSongTree=function(){return n.stackSize?window.history.back():n.go("^")},t.canPublish=function(e){return!!e&&(e.canPublish&&!e.isPublic)},t.openPermissionsModal=function(){_g(zn((()=>import("./chunk-991023ce.js"))))},o((function(){t.visible=!0})),function e(n){return n().then((function(n){let{paging:o,data:r}=n;const i=r.map((function(e){return e.revision.postId=e.id,e.revision.post=e,e}));return p=p.concat(i),a.pushQueueSongs(i,d),o.itemsCount<o.limit?function(e){t.latest=e.shift(),t.posts=e,t.song.original&&(t.originalRevision=t.song.original,l.get({id:t.song.original.songId}).$promise.then((function(e){t.originalSong=e})))}(p):e((()=>h(o.cursors)))}))}(h),Promise.all([Gg(i.id,{fallbackToFree:!0,useCache:!0}),Mp(i,"studio_duplicate_projects")]).then((e=>{let[n,o]=e;t.hasMembership="Free"!==n.plan,t.hasDuplicateProjectsFlag="true"===o})),t.getCanDuplicate=function(){const e=c,n=e.author.id===i.id&&"User"===e.author.type&&0===e.counters.collaborators;return e.canEdit&&n&&!e.isFork&&t.hasDuplicateProjectsFlag&&t.hasMembership},Mp(i,"band_permissions_update_enabled").then((e=>{t.isBandPermissionsUpdateEnabled="true"===e})),t.$on("$destroy",(function(){document.body.removeEventListener("keydown",f),document.body.removeEventListener("mousedown",m)})),document.body.addEventListener("mousedown",m),document.body.addEventListener("keydown",f),"User"===c.author.type?u.get({id:c.author.id}).$promise.then((function(e){t.projectAuthor=e})):r.get({id:c.author.id}).$promise.then((function(e){return t.projectAuthor=e,u.fromBand({bandId:c.author.id}).$promise})).then((function(e){let{data:n}=e;t.bandOwner=n.find((e=>"Owner"===e.role))}))}]),angular.module("bandlab.song").component("fork",{bindings:{revision:"<",song:"<"},transclude:!0,template:'<div ng-click="vm.displayForkModal()" ng-transclude></div>',controller:["$analytics","$element","$rootScope","$state","appActions","Modal","Song",function(e,t,n,o,r,i,a){var s=this;function l(e,r,i){a.fork({revisionId:e}).$promise.then((function(a){s.forkedSong=a,s.forkResult="success",n.$broadcast("$song:changed",{action:"create",song:a}),Promise.resolve().then((()=>rb)).then((function(n){let{logRevisionFork:a}=n;a(e,r,i,t,o)}))})).catch((function(e){s.forkResult="error",60===e.code?s.errorStatus="notFound":140===e.code?s.errorStatus="notAllowed":403===e.code&&(s.errorStatus="notPermitted")}))}s.displayForkModal=function(){if(!r.checkAllowed("fork"))return;const e=_.get(s,"revision.id")||_.get(s,"song.revision.id"),t=s.revision?.postId??s.song?.revision.postId,n=_.get(s,"revision.creator.id")||_.get(s,"song.revision.creator.id");e?l(e,t,n):s.song?a.get({id:s.song.id}).$promise.then((e=>l(e.revision.id,t))).catch((()=>{s.forkResult="error"})):s.forkResult="error",new i({id:"songForkModal",templateUrl:"https://www.bandlab.com/web-app/song/partials/_song-fork-d039c1ba.html",contentScope:{vm:s}}).show()}}],controllerAs:"vm"}),angular.module("bandlab.song").directive("projectFormName",(function(){return{restrict:"E",replace:!0,templateUrl:"https://www.bandlab.com/web-app/song/partials/_project-form-name-ecd3dbdd.html"}})).directive("revisionFormAvailability",(function(){return{restrict:"E",replace:!0,templateUrl:"https://www.bandlab.com/web-app/song/partials/_revision-form-availability-dfb27971.html"}})).directive("revisionFormDescription",(function(){return{restrict:"E",replace:!0,templateUrl:"https://www.bandlab.com/web-app/song/partials/_revision-form-description-8108c996.html"}})).directive("revisionFormFork",(function(){return{restrict:"E",replace:!0,templateUrl:"https://www.bandlab.com/web-app/song/partials/_revision-form-fork-2d564fff.html"}})).directive("revisionFormExplicit",(function(){return{restrict:"E",replace:!0,templateUrl:"https://www.bandlab.com/web-app/song/partials/_revision-form-explicit-fa905c97.html"}})).directive("revisionFormGenre",(function(){return{restrict:"E",replace:!0,scope:{revision:"="},templateUrl:"https://www.bandlab.com/web-app/song/partials/_revision-form-genre-a154fb9a.html",controller:["$scope","Tag",function(e,t){t.getDefaultGenre().then((function(t){e.revision.genres=e.revision.genres||[],e.revision.genres[0]||(e.revision.genres[0]=t),e.genre=e.revision.genres[0]})),t.getGenres().then((function(t){e.genres=t}))}]}})).directive("revisionFormListing",(function(){return{restrict:"E",replace:!0,templateUrl:"https://www.bandlab.com/web-app/song/partials/_revision-form-listing-8e3648b3.html"}})).directive("revisionFormMasteringExisting",(function(){return{restrict:"E",replace:!0,templateUrl:"https://www.bandlab.com/web-app/song/partials/_revision-form-mastering-existing-dda058db.html",scope:{revision:"="},controller:["$scope",function(e){function t(e){return fu(e?.preset)}e.originalMastering=e.revision.mastering,e.masteringSetting=t(e.originalMastering),e.$on("$revision:changed",(function(n,o){let{revision:r}=o;e.masteringSetting=t(r.mastering),e.revision.mastering=r.mastering,e.originalMastering=r.mastering}))}]}})).directive("revisionFormMasteringNew",(function(){return{restrict:"E",replace:!0,templateUrl:"https://www.bandlab.com/web-app/song/partials/_revision-form-mastering-new-8b825044.html"}})).directive("revisionFormKey",(function(){return{restrict:"E",replace:!0,templateUrl:"https://www.bandlab.com/web-app/song/partials/_revision-form-key-aebea3e5.html",controller:["$scope",function(e){e.revision.key=e.revision.key||null,e.keys=[],e.init=function(){const t=lh();uh(t).then((async n=>{let[{AudioEngineWorkletNode:o}]=n;const{getKeySignatureMenuKeyForIndex:r,getKeySignatureMenuList:i,getSimplestEnharmonicKeySignature:a,keySigToString:s}=new o(t).MusicUtils,l=await i(),c=[];for(const[e,t]of l.entries())if("-"!==t)if(t.includes("/")){const n=await r(e),o=await a(n),i=await s(o);c.push({value:i,label:t})}else c.push({value:t,label:t});else c.push({value:null,label:t});e.keys=c}))},e.init()}]}})).directive("revisionFormBpm",(function(){return{restrict:"E",replace:!0,templateUrl:"https://www.bandlab.com/web-app/song/partials/_revision-form-bpm-69a238e9.html",controller:["$scope",function(e){e.revision.metronome.bpm=e.revision.metronome.bpm||120}]}})),angular.module("bandlab.song").component("revisionImporter",{bindings:{bandId:"<",defaultAvailability:"@",importAs:"@",parentRevision:"<"},transclude:!0,template:'<div ng-click="vm.selectFile();" ng-transclude></div>',controller:["$analytics","$injector","$rootScope","$state","$timeout",function(e,t,n,o,r){const i=this;i.selectFile=function(){return Fh({accept:Uh}).then((function(n){return function(n){const a=t.get("RevisionImporter");return"track"===i.importAs?a.createTrackFromFile(n):(e.eventTrack("Upload New Revision",{category:"Revision"}),a.createRevisionFromFile(n,{bandId:["recent","my-projects","collaborations","bands"].includes(i.bandId)?null:i.bandId,parentRevision:i.parentRevision,defaultAvailability:i.defaultAvailability}).then((e=>r((()=>{o.go("track",{id:e.postId})}),1e3))))}(n[0])}))}}],controllerAs:"vm"}),angular.module("bandlab.song").component("revisionMobileInspiredBy",{bindings:{revision:"<",song:"<",creator:"<",canMessageOriginalAuthor:"<",shareWithOriginalAuthor:"&"},templateUrl:"https://www.bandlab.com/web-app/song/partials/_revision-mobile-inspired-by-9b040d98.html",controllerAs:"vm"}),angular.module("bandlab.song").component("revisionPlayerAudio",{bindings:{barWidth:"<",currentTime:"<",revision:"<"},templateUrl:"https://www.bandlab.com/web-app/song/partials/_revision-player-audio-9aa70df0.html",controllerAs:"vm",controller:["$analytics","Revision",function(e,t){this.$onInit=function(){this.revision.isRecentlyUpdated=(new Date-new Date(this.revision.createdOn))/1e3/60/10<1},this.reprocessMixdown=function(n){return e.eventTrack("Reprocess Mixdown",{category:"Revision"}),t.reprocessMixdown({revisionId:n}).$promise.then((()=>{this.revision.isRecentlyUpdated=!0}))}}]}),angular.module("bandlab.song").directive("revisionPlayerSmall",(function(){return{restrict:"E",replace:!0,scope:{contentSource:"@contentSource",contextId:"@contextId",post:"=post",revision:"=revision"},transclude:!0,templateUrl:"https://www.bandlab.com/web-app/song/partials/_revision-player-small-9e29c531.html",controller:["$scope",function(e){"User"===e.revision.song.author.type?e.user=e.revision.song.author:e.band=e.revision.song.author}]}})),angular.module("bandlab.song").component("revisionTile",{bindings:{author:"<",collection:"<",currentTime:"<",onPlayEvent:"&",post:"<",revision:"<"},templateUrl:"https://www.bandlab.com/web-app/song/partials/_revision-tile-7e2510c8.html",controller:["$element","$injector","$scope","Me","User",function(e,t,n,o,r){const i=this;i.$onInit=function(){i.revision.post=i.post,GY(e[0],i.revision.song.picture.color);const{canMessageOriginalAuthor:n,shareWithOriginalAuthor:o}=$D(t);i.canMessageOriginalAuthor=()=>n(i.revision,i.revision.song.original),i.shareWithOriginalAuthor=()=>o(i.revision,i.revision.song.original.conversationId)},i.getCollaborators=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r.getCollaborators(Object.assign({songId:i.revision?.song?.id,includeOwner:!0},e)).$promise},i.me=o,n.$on("$albumTrack:changed",(function(t,n){GY(e[0],n.track.picture.color)})),n.handlePlayEvent=function(e){angular.isFunction(i.onPlayEvent)&&"playing"!==n.playStatus&&(e.stopPropagation(),i.onPlayEvent())}}],controllerAs:"vm"}).component("revisionTileDescription",{bindings:{revision:"=",maxLines:"="},controller:["$element","$injector","$scope",function(e,t,n){const o=this;o.$onInit=function(){const r=import("./chunk-ace77dac.js").then((function(n){let{mountRevisionTileDescription:r}=n;return r(e[0],{$injector:t},{revision:o.revision,maxLines:o.maxLines})}));n.$on("$destroy",(async function(){(await r).unmount()}))}}],controllerAs:"vm"}).directive("colorTheme",["Me",function(e){return{scope:{colorTheme:"="},link:function(e,t){GY(t[0],e.colorTheme)}}}]),angular.module("bandlab.song").directive("revisionTileSmall",(function(){return{restrict:"E",replace:!0,scope:{revision:"="},templateUrl:"https://www.bandlab.com/web-app/song/partials/_revision-tile-small-376ce387.html"}})),angular.module("bandlab.song").component("songLink",{bindings:{dynamic:"<",song:"<",revision:"<",revisionId:"<",targetBlank:"<",openInStudio:"<",openAttribution:"<"},transclude:!0,template:'<a ng-href="{{ vm.url }}" ng-transclude></a>',controller:["$element","$state",function(e,t){const n=this;function o(){n.url=r(),e[0].querySelector("a").href=n.url}function r(){return n.openInStudio&&(n.revision?.id||n.revisionId)?t.href("mixEditor",{id:n.revision?.id||n.revisionId,open_attribution:n.openAttribution}):n.revision?t.href("track",{id:n.revision.postId,revId:n.revision.id}):n.song?t.href("songId",{id:n.song.id}):void 0}n.$onInit=function(){if(n.url="Deleted"!==n.song.status?r():null,n.$onChanges=n.dynamic?o:angular.noop,n.targetBlank){const t=e[0].querySelector("a");t.setAttribute("target","_blank"),t.setAttribute("rel","noopener")}}}],controllerAs:"vm"}),angular.module("bandlab.song").component("timeMarkers",{bindings:{revision:"<"},templateUrl:"https://www.bandlab.com/web-app/song/partials/_time-markers-135e76f2.html",controllerAs:"vm",controller:["$analytics","$element","$scope","Player",function(e,t,n,o){const r=this,i=t[0].closest("revision-player-audio"),a=t[0].parentNode.querySelector("canvas");r.tempComment=null,r.comments=[],r.markers=[],r.goToTimeAndPlay=function(t){o.goToTimeAndPlay(r.revision,t.time),e.eventTrack("Time Marker Click",{category:"Revision",label:"Waveform Marker"})};const s=ay((()=>{r.markers=_.chain(r.comments).concat(r.tempComment).compact().map((e=>function(e){let{timestamp:t=0,comment:n}=e;const o=r.revision.mixdown.duration,i=t>=o?0:t,s=i/o;if(i)return{comment:{...n,truncate:!1},revision:r.revision,time:i,left:9*Math.floor(s*(a.clientWidth-8)/9)}}({timestamp:e.timestamp,comment:e}))).compact().sortBy("left").uniqBy("left").value(),r.markers.length?i.classList.add("has-time-markers"):i.classList.remove("has-time-markers"),n.$applyAsync()}),100);n.$on("$comments:loaded",((e,t)=>{let{revision:n,comments:o}=t;n.id===r.revision.id&&(r.comments=o,s())})),n.$on("$timeMarker:addTempTimeMarker",((e,t)=>{let{revisionId:n,comment:o}=t;r.revision.id===n&&(r.tempComment=o,s())})),n.$on("$timeMarker:removeTempTimeMarkers",(()=>{r.tempComment&&(r.tempComment=null,s())})),window.addEventListener("resize",s),n.$on("$destroy",(()=>{window.removeEventListener("resize",s)}))}]}),angular.module("bandlab.song").factory("Revision",["$analytics","$http","$resource","$state","Me",function(e,t,n,o,r){const i="https://www.bandlab.com/api/v1.3/revisions",a=[],s=[],l=[],c=[];return n(i,{},{get:{method:"GET",params:{id:"@id",edit:!1},url:`${i}/:id`},save:{method:"POST",interceptor:{request:function(e){return s.push(e.data.triggeredFrom),delete e.data.triggeredFrom,l.push(e.data.projectOrigin),delete e.data.projectOrigin,c.push(e.data.autokeyUsedCount),delete e.data.autokeyUsedCount,e}},transformRequest:[function(e){const t=["auxChannels","description","genres","key","lyrics","mastering","metronome","placeId","post","samples","sampleId","song","tracks","trackGroups","volume"].reduce((function(t,n){return t[n]=angular.copy(e.revision[n]),t}),{});t.parentId=e.revision.id,t.auxChannels.forEach((function(e){delete e.effects}));const n=new Set;return t.tracks.forEach((function(e){delete e.color,delete e.sampleId,e.regions.forEach((function(e){delete e.sampleStartPosition,e.sampleOffset=Math.max(e.sampleOffset,0),e.startPosition=Math.max(e.startPosition,0),n.add(e.sampleId)})),"0.0"===e.autoPitch?.version&&(e.autoPitch.version=null)})),t.samples=t.samples.filter((function(e){return n.has(e.id)})).map((function(e){let{...t}=e;return delete t.buffer,t})),a.push(t),t},angular.toJson],transformResponse:[...t.defaults.transformResponse,function(n,i,u){const d=a.pop(),p=l.pop(),m=s.pop(),f=c.pop();return 201===u?(Promise.resolve().then((()=>Ap)).then((function(e){let{incrementProperty:t}=e;o.is("mastering")&&t("used mastering")})),e.eventTrack("Create Revision",{extra:{song:n.song,revision:n,cleanedRevision:d,createdFrom:o.is("mixEditor")?"me":o.is("mastering")?"mastering":o.is("songStarter")?"songstarter":"quick_upload",projectOrigin:p,triggeredFrom:m,autokeyUsedCount:f}}),Mp(r,"traceability_save_enabled").then((function(e){"true"===e&&t.patch(`https://www.bandlab.com/api/v1.3/tracks/${n.id}/insights`,{projectId:n.song.id,projectOrigin:p})}))):u>=400&&Promise.resolve().then((()=>rb)).then((function(e){let{logRevisionCreateFailure:t}=e;t()})),n}]},update:{method:"PATCH",params:{id:"@id"},url:`${i}/:id`},reprocessMixdown:{method:"POST",url:"https://www.bandlab.com/api/v1.3/revisions/:revisionId/mixdown/reprocess",params:{revisionId:"@revisionId"}},getCrowdReviews:{method:"GET",isArray:!0,params:{id:"@id"},url:`${i}/:id/crowd-reviews`}})}]);const KY=ld({props:{modelValue:{required:!0,type:[Array,Number,Object,String,Boolean,null]},size:{required:!0,validator:e=>["small","medium","large"].includes(e)}},setup(e){const t="--segmented-control-selected-label",n=Vt(null),o=Vt("0px"),r=Mt(new Map),i=Gi((function(){return e.modelValue})),a=new ResizeObserver((function(e){let[{target:t}]=e;s(t)}));return Xo("childRef",(function(e,t){t?r.set(e.value,t):r.delete(e.value)})),ao((function(){const{paddingLeft:e}=getComputedStyle(n.value);o.value=e})),uo((function(){a.disconnect()})),Lr([i,r],(async function(e,o){let[i]=e,[l]=o;if(await hn(),i!==l&&n.value.classList.toggle("active",r.has(l)),r.has(i)){const e=r.get(i);a.disconnect(),a.observe(e),s(e),n.value.style.removeProperty(`${t}-background-color`)}else n.value.style.setProperty(`${t}-background-color`,"transparent")}),{immediate:!0}),{radioGroup:n};function s(e){n.value.style.setProperty(`${t}-width`,`${e.clientWidth}px`),n.value.style.setProperty(`${t}-background-position-x`,`calc(${e.offsetLeft}px - ${o.value})`)}}},[["render",function(e,t,n,o,r,i){return si(),pi("fieldset",{ref:"radioGroup",class:ae(["segmented-control",`segmented-control-${n.size}`])},[Po(e.$slots,"default")],2)}]]),YY=Object.freeze(Object.defineProperty({__proto__:null,default:KY},Symbol.toStringTag,{value:"Module"})),JY={props:{modelValue:{required:!0,type:[Array,Number,Object,String,Boolean,null]}},emits:["update:modelValue"],setup(e,t){let{attrs:n,emit:o}=t;const r=Zo("childRef");return{attrs:n,childRef:r,onClick:function(){o("update:modelValue",n.value)}}}},XY=["aria-pressed"],ZY=ld(JY,[["render",function(e,t,n,o,r,i){return si(),pi("button",{ref:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return o.childRef(o.attrs,...t)},"aria-pressed":n.modelValue===o.attrs.value,type:"button",onClick:t[0]||(t[0]=function(){return o.onClick&&o.onClick(...arguments)})},[Po(e.$slots,"default")],8,XY)}]]),QY=Object.freeze(Object.defineProperty({__proto__:null,default:ZY},Symbol.toStringTag,{value:"Module"})),eJ=["width","height","aria-hidden"],tJ=[bi("path",{fill:"currentColor",d:"M13 12.59V2h-2v10.59l-3.3-3.3-1.4 1.42 5.7 5.7 5.7-5.7-1.4-1.42zM21 20v2H3v-2z"},null,-1)],nJ={__name:"import",props:{size:{type:Number,required:!0}},setup:e=>(t,n)=>(si(),pi("svg",{width:e.size,height:e.size,viewBox:"0 0 24 24",fill:"none","aria-hidden":t.$attrs["aria-label"]||t.$attrs["aria-labelledby"]?null:"true"},tJ,8,eJ))},oJ=Object.freeze(Object.defineProperty({__proto__:null,default:nJ},Symbol.toStringTag,{value:"Module"})),rJ={class:"ds-modal ds-modal-size-medium"},iJ={class:"ds-modal-header"},aJ={class:"ds-modal-title"},sJ={class:"ds-modal-content"},lJ={class:"stem-title"},cJ={class:"stem-track-length"},uJ={class:"stem-region-container"},dJ={class:"stem-track-end"},pJ=["title","disabled","onClick"],mJ=Vn({__name:"DownloadStemsModal",props:{hasNewTrackHeadUpdate:{type:Boolean},revision:{},download:{type:Function}},emits:["closeModal"],setup(e){const t=e,n=[{value:"aac-44100-16bit-192kbps",label:"M4A"},{value:"wav-44100-16bit",label:"WAV"}],o=Vt(n[0].value);function r(e,n){const o=t.revision.mixdownDuration,{startPosition:r,endPosition:i}=n;return{"background-color":e.color,left:r/o*100+"%",width:(Math.min(i,o)-r)/o*100+"%"}}function i(e,n){return t.hasNewTrackHeadUpdate?`${`${n+1}`.padStart(2,"0")}_${e}`:e}return(e,t)=>(si(),pi("section",rJ,[bi("header",iJ,[bi("h2",aJ,me("Download Stems"),1)]),bi("section",sJ,[yi(KY,{modelValue:o.value,"onUpdate:modelValue":t[1]||(t[1]=e=>o.value=e),size:"large",style:{"--mobile-top-padding":"8px","margin-bottom":"16px"}},{default:Tn((()=>[(si(),pi(ti,null,So(n,(e=>yi(ZY,{key:e.value,modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=e=>o.value=e),value:e.value},{default:Tn((()=>[ki(me(e.label),1)])),_:2},1032,["modelValue","value"]))),64))])),_:1},8,["modelValue"]),(si(!0),pi(ti,null,So(e.revision.tracks,((t,n)=>(si(),pi("div",{key:t.id,class:"stem-tracks"},[bi("div",lJ,me(i(t.name,n)),1),bi("div",{class:"stem-track",style:te({"--accent-color":t.color})},[bi("div",cJ,[bi("div",uJ,[(si(!0),pi(ti,null,So(t.regions,(e=>(si(),pi("div",{key:e.id,class:"stem-region",style:te(r(t,e))},null,4)))),128))])]),bi("div",dJ,[t.isDownloading?_i("v-if",!0):(si(),pi("button",{key:0,type:"button",class:"stem-download-button",title:"Download",disabled:t.isLoading,onClick:n=>e.download(t,o.value)},[t.isLoading?(si(),mi(Ld,{key:0,class:"ds-button-loading-icon",size:16})):(si(),mi(nJ,{key:1,size:16}))],8,pJ))])],4)])))),128))]),yi(ib,{onClick:t[2]||(t[2]=t=>e.$emit("closeModal"))})]))}});angular.module("bandlab.song").factory("RevisionImporter",["$analytics","$filter","$http","$injector","$q","$rootScope","$timeout","$transitions","AppNotifications","EditorLoader","EditorModel","EditorState","Me","Modal","Post","ProjectUploader","Revision","Sample","Song","Soundbank","User",function(e,t,n,o,r,i,a,s,l,c,u,d,p,m,f,h,g,v,b,y,w){var $=!1;return{createRevisionFromFile:function(n){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var i="auto",a="Public";return $?r.reject(yh):M(n).then((function(n){let[s,l]=n;var u,d,p,f,h=ad();return $=!0,(p=P({name:t("limitTo")(s.name.replace(/\.[^/.]+$/,""),100),duration:l,sampleId:h,bandId:o.bandId,parentRevision:o.parentRevision}),f=o.defaultAvailability,r((function(e,t){var n;n=new m({templateUrl:"https://www.bandlab.com/web-app/song/partials/_revision-new-9e40f8e6.html",overlayClose:!1,contentScope:{canBePrivate:!0,defaultAvailability:f,revision:p,resolve:function(t){e(t),n.destroy()}},onCancel:function(){t({message:dh})}}),n.show()}))).then((function(t){return i=t.masteringSetting,a=t.availabilitySetting,u=c.pushTask("uploadMeta"),"manual"===i&&(d=c.pushTask("masterTrack")),v.upload({blob:s,sampleId:h,sampleType:"samples"}).then((function(){return e.eventTrack("Upload Sample",{category:"Projects",label:s.type,value:parseInt(l)}),t}))})).then((function(e){return"auto"===i&&(e.mastering={preset:"cdMaster"}),e.post=e.post||{},e.post.state=a,e})).then((function(t){return t.song.id&&t.song.canEdit?b.update({id:t.song.id,name:t.song.name,isForkable:t.song.isForkable}).$promise.then((function(){return e.eventTrack("Create Project",{category:"Projects"}),g.save({revision:t}).$promise})):g.save({revision:t}).$promise})).then((function(e){return k(e,vg(i))})).then((function(e){return c.finishTask(u),"manual"===i?S(e).then((function(){return T(e,d)})):e})).finally((function(){$=!1}))})).catch((function(e){return c.flushQueue(),e.message===dh?r.reject(dh):(202!==e?.data?.errorCode&&l.addNotification({content:e.message||"Unable to import file. Please check that your file is not corrupted.",classList:"alert",autoclose:8e3}),r.reject(fh))}))},createRevisionFromMasteringUploader:function(n){let{presetSlug:o,isBypass:r,name:i,blob:a,duration:s}=n;const l=t("limitTo")(i.replace(/\.[^/.]+$/,""),100),c=ad(),d=u.createTrack({name:"Imported Track"}),p=u.createRegion({endPosition:s,name:l,sampleId:c,trackId:d.id});d.regions=[p];const m=u.createRevision({mastering:r?null:{preset:o},song:new b({bandId:"",isForkable:!1,name:l}),tracks:[d]}),f={createdAt:performance.now(),name:l,file:a,preset:hu[cu(o)]?.name,progress:0,loaded:0,complete:!1,upload:y(),cancel:function(){Gf(h.queue,f),f.upload.cancel()},retry:function(){f.upload=y(),f.failed=!1}};function y(){const t=v.upload({blob:a,sampleId:c,sampleType:"samples"},1,w),n=t.cancel;return Object.assign(t.then((function(){return g.save({revision:m}).$promise})).then((function(t){return e.eventTrack("Create Project",{category:"Projects"}),e.eventTrack("Save revision",{category:"Mastering"}),k(t)})).then((function(e){return f.complete=!0,f.revision=e,f})).catch((function(e){f.failed=!0})),{cancel:()=>n()})}function w(e){f.total=e.total,f.loaded=e.loaded,f.progress=e.loaded/e.total}h.queue.push(f)},createRevisionFromUploadQueue:function(n,o){let{duration:r,bandId:i}=o;var a=ad(),s=P({name:t("limitTo")(n.name.replace(/\.[^/.]+$/,""),100),duration:r,sampleId:a,bandId:i}),l={createdAt:performance.now(),name:n.name,file:n,progress:0,loaded:0,complete:!1,cancel:function(){Gf(h.queue,l),l.upload.cancel()},upload:c(),retry:function(){l.upload=c(),l.failed=!1},index:h.queue.length,previousTask:h.queue.length?h.queue[h.queue.length-1]:null};function c(){const t=v.upload({blob:n,sampleId:a,sampleType:"samples"},1,u),o=t.cancel;return Object.assign(t.then((function(){return e.eventTrack("Upload Sample",{category:"Projects",label:n.type,value:parseInt(r)}),g.save({revision:s}).$promise})).then((function(t){return e.eventTrack("Create Project",{category:"Projects"}),t})).then(k).then((function(e){return l.complete=!0,l.revision=e,l})).catch((function(e){l.failed=!0})),{cancel:()=>o()})}function u(e){l.total=e.total,l.loaded=e.loaded,l.progress=e.loaded/e.total}h.queue.push(l)},createRevisionFromSongStarter:async function(t,n,o){let{mixData:r,tracks:i,songName:a,lyric:s}=t;await y.getList(),await Promise.all(r.tracks.map((e=>e.soundbank?y.getBank({slug:e.soundbank}):Promise.resolve())));const{rev:l,samples:c}=await Promise.all([Nx(r,ad()),jx(r.tracks)]).then((e=>{let[t,n]=e;return{rev:t,samples:n}})),d=c.reduce(((e,t)=>e+t.blob.size),0);l.tracks.forEach(((e,t)=>{e.type=u.getTrackType(e),e.auxSends[0].automation=[],i&&(e.colorName=i[t].colorName)}));const p=u.createRevision({...l,song:new b({bandId:"",isForkable:!1,name:a}),lyrics:{content:s},id:null}),m={createdAt:performance.now(),name:a,progress:0,loaded:0,complete:!1,total:d,upload:f(o),cancel:function(){Gf(h.queue,m),m.upload.cancel()},retry:function(){m.upload=f(o),m.failed=!1}};function f(t){const o=c.map((e=>{if(!QS[e.id])return v.upload({blob:e.blob,sampleId:e.id,sampleType:"samples"},1,w)}));return Object.assign(Promise.all(o).then((function(){return g.save({revision:p,projectOrigin:"songstarter"}).$promise})).then((function(t){return e.eventTrack("Create Project",{category:"Projects"}),e.eventTrack("Save revision",{category:"SongStarter"}),k(t)})).then((function(e){return m.progress=1,m.loaded=d,m.complete=!0,m.revision=e,t(e.id,r.id,n),m})).catch((function(e){m.failed=!0})),{cancel:()=>{o.forEach((e=>{e.cancel()}))}})}function w(e){m.loaded+=e.loaded,m.progress=m.loaded/d}h.queue.push(m)},createTrackFromFile:function(e){return M(e).then((function(e){let[o,a]=e;const s={createdAt:performance.now(),name:t("limitTo")(o.name.replace(/\.[^/.]+$/,""),100),file:o,progress:0,loaded:0,complete:!1,cancel:function(){Gf(h.queue,s),s.upload.cancel()},upload:l(),retry:function(){s.upload=l(),s.failed=!1},index:h.queue.length,previousTask:h.queue.length?h.queue[h.queue.length-1]:null};function l(){const e=r.defer();return Object.assign(Hh(o).then((function(n){const o=w.createTrackPost({userId:p.id,state:"Private",track:{name:t("limitTo")(n.name.replace(/\.[^/.]+$/,""),100),genreId:"other",sample:{audioFormat:Ih(n.type),duration:a}}});return e.promise.then((()=>o.$cancelRequest())),Promise.all([o.$promise,n])})).then((function(t){let[o,r]=t;const{"Content-Type":i}=Object.fromEntries(new URLSearchParams(o.track.sample.uploadUrl));return s.post=o,n({method:"PUT",url:o.track.sample.uploadUrl,data:r,headers:{"Content-Type":i},uploadEventHandlers:{progress:function(e){s.total=e.total,s.loaded=e.loaded,s.progress=e.loaded/e.total}},timeout:e.promise})})).then((function(){s.complete=!0,i.$broadcast("$track:uploaded",{post:s.post})})).catch((e=>{s.failed=!0})),{progress:{},cancel:function(){e.resolve(),s.post&&f.delete({id:s.post.id})}})}h.queue.push(s)})).catch((function(e){return c.flushQueue(),e.message===dh?r.reject(dh):(202!==e?.data?.errorCode&&l.addNotification({content:"Ensure that the file format is MP3, M4A or WAV, and that it isnt corrupted.",classList:"alert",autoclose:8e3}),r.reject(fh))}))},createTrackFromUploadQueue:function(e,o){const a={createdAt:performance.now(),name:t("limitTo")(e.name.replace(/\.[^/.]+$/,""),100),file:e,progress:0,loaded:0,complete:!1,cancel:function(){Gf(h.queue,a),a.upload.cancel()},upload:s(),retry:function(){a.upload=s(),a.failed=!1},index:h.queue.length,previousTask:h.queue.length?h.queue[h.queue.length-1]:null};function s(){const s=r.defer();return Object.assign(Hh(e).then((function(e){const n=w.createTrackPost({userId:p.id,state:"Private",track:{name:t("limitTo")(e.name.replace(/\.[^/.]+$/,""),100),genreId:"other",sample:{audioFormat:Ih(e.type),duration:o}}});return s.promise.then((()=>n.$cancelRequest())),Promise.all([n.$promise,e])})).then((function(e){let[t,o]=e;const{"Content-Type":r}=Object.fromEntries(new URLSearchParams(t.track.sample.uploadUrl));return a.post=t,n({method:"PUT",url:t.track.sample.uploadUrl,data:o,headers:{"Content-Type":r},uploadEventHandlers:{progress:function(e){a.total=e.total,a.loaded=e.loaded,a.progress=e.loaded/e.total}},timeout:s.promise})})).then((function(){a.complete=!0,i.$broadcast("$track:uploaded",{post:a.post})})).catch((e=>{a.failed=!0})),{progress:{},cancel:function(){s.resolve(),a.post&&f.delete({id:a.post.id})}})}h.queue.push(a)},displayMultipleFilesWarning:function(){l.addNotification({content:"You can upload only one file at a time.",autoclose:5e3})},downloadMixdown:function(e){const t=[{...Zh,size:jA(44100*e.mixdown.duration*16*2/8)},{...Xh,size:jA(32e4*e.mixdown.duration/8)},{...Jh,size:jA(192e3*e.mixdown.duration/8)},{...Yh,size:jA(128e3*e.mixdown.duration/8)}];new m({templateUrl:"https://www.bandlab.com/web-app/song/partials/_download-mixdown-modal-67ad9034.html",contentScope:{revision:e,files:t}}).show()},downloadStems:function(t){g.get({id:t.id,edit:!0}).$promise.then((function(o){let r=!1;d.isInBackground=!0,_g(mJ,{hasNewTrackHeadUpdate:d.hasNewTrackHeadUpdate,revision:{mixdownDuration:o.mixdown.duration,tracks:o.tracks},download:function(o,i){e.eventTrack("Download Stem",{category:"Revision",label:"Format M4A"}),o.isLoading=!0;const s=`https://www.bandlab.com/api/v1.3/revisions/${t.id}/tracks/${o.id}/download-options/${i}`;return n.post(s).then((function(){return C(s,(()=>r))})).then((function(e){let{data:{url:t}}=e;Gh(t),a((function(){o.isLoading=!1}),3e3)}))}},{onClose:()=>{r=!0,d.isInBackground=!1}})})),e.eventTrack("Download Stems",{category:"Revision"})},isAudioFileValid:M,getMetadataFromFile:function(e){return import("./chunk-5ddb832d.js").then((e=>e.j)).then((function(t){let{default:n}=t;return new Promise((function(t){n.read(e,{onSuccess:function(){let{tags:{covr:e,picture:n,title:o}={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=e?.data||n;t({coverArt:r&&new Blob([new Uint8Array(r.data)],{type:r.format}),title:o})},onError:function(e){t()}})}))})).catch((function(e){}))},masterRevision:T,pollMixdown:S,pollOnDemand:C,AppNotifications:l,Sample:v,$q:r,$timeout:a};function k(e){return i.$broadcast("$revision:changed",{action:"create",revision:e}),e}function S(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.defer();const n=i.$on("Mastering:cancel",(function(){t.reject()}));return r.race([a((function t(){return g.get({id:e.id}).$promise.then((function(e){return"Ready"===e.mixdown.status?e:a(t,5e3)})).finally(n)}),2e4),t.promise])}function P(e){var t,n,o;return o=u.createTrack({name:"Imported Track"}),t=u.createRegion({endPosition:e.duration,name:e.name,sampleId:e.sampleId,trackId:o.id}),o.regions=[t],n=e.parentRevision?e.parentRevision.song:new b({bandId:e.bandId||"",canEdit:!0,isForkable:!1,name:e.name}),u.createRevision({id:e.parentRevision?e.parentRevision.id:null,masteringSetting:"auto",post:{state:"Private"},song:n,tracks:[o]})}function M(e){let{loader:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=t&&c.pushTask("loadSample");return v.getOptions().then((function(t){let{maxSongDuration:n}=t;return qh(e,n)})).then((function(e){return zh(e).then((function(t){return[e,t.duration]}))})).finally((function(){return a((function(){c.finishTask(n)}),1e3)}))}function T(t,n){var a=_.get(t,"mastering.drySampleId")||_.get(t,"mixdown.id"),u=angular.noop,d=angular.noop,f=r.defer();if(!a)return r.reject("Revision cannot be mastered: dry sample id is missing.");n=n||c.pushTask("masterTrack"),d=s.onStart({},(function(){f.reject()})),u=i.$on("Mastering:cancel",(function(){f.reject()}));const h=`https://static.bandlab.com/revisions-formatted/${a}/${a}.m4a`;return r.race([async function(){const a=await v.getBuffer(h),{makeMasteringState:s}=await import("./chunk-938bfe77.js"),{masteringPresetSlugs:l,rootMasteringPresetSlugs:u}=await Promise.resolve().then((()=>ku)),d=Vt(!p.isAnonymous()&&"Free"!==(await w.getMembershipStatus({userId:p.id}).$promise).plan),b=t.mastering||{},y=l.find((e=>e===b.preset))??"cdMaster",$=s(o);await $.initialisePromise,c.finishTask(n);const k=r.defer(),S=new m({overlayClose:!1,contentScope:{props:{arrayBuffer:a,displayPresetSlugs:u,defaultPresetSlug:y,masteringState:$,songName:t.song.name,isMember:d,openPaywall:function(e){let{attribution:t}=e;new m({id:"paywallModal",templateUrl:"https://www.bandlab.com/web-app/membership/partials/_paywall-modal-ee6789e7.html",contentScope:{useCheckoutModal:!0,product:"membership",productAttribution:t,productAttributionGroup:"mastering",onOpenCheckoutModal:()=>{S.destroy()},checkoutSuccess:()=>{d.value=!0}}}).show()},applyPreset:function(n,o){t.mastering=o?null:{preset:n};var a,s=c.pushTask("uploadMixdown");return t.mastering?(e.eventTrack("Update Mastering",{category:"Revision",label:`${vg(t.mastering.preset)} mastering`}),a=g.update({id:t.id,mastering:t.mastering}).$promise):(e.eventTrack("Update Mastering",{category:"Revision",label:"No mastering"}),a=g.update({id:t.id,mastering:null}).$promise),r.race([a,f.promise]).then((function(e){t.mastering=e.mastering,t.mixdown=e.mixdown,t.isRecentlyUpdated=!0,e.isRecentlyUpdated=!0,i.$broadcast("$revision:changed",{action:"master",revision:e})})).finally((function(){S.destroy(),c.finishTask(s),k.resolve(t)}))},close:function(){S.destroy()}}},class:"light",template:'<mastering-preview-modal props="props"></mastering-preview-modal>'});return S.show(),k.promise}(),f.promise]).catch((function(e){void 0!==e&&l.addNotification({content:e.message||mh,classList:"alert",autoclose:5e3})})).finally((function(){c.finishTask(n),d(),u()}))}function C(e,t){return t()?Promise.reject():a(angular.noop,5e3).then((function(){return n.get(e)})).then((function(e){return e.data.url?e:Promise.reject()})).catch((function(){return a((()=>C(e,t)),5e3)}))}}]),angular.module("bandlab.web").factory("RevisionSocket",["$rootScope","Revision",function(e,t){let n;return{disconnect:function(){clearTimeout(n)},join:function(e){let{revisionId:t}=e;o(t)}};function o(r){n=setTimeout((()=>{t.get({id:r}).$promise.then((function(t){if("Ready"!==t.mixdown.status)return o(r);e.$broadcast("$mixdown:changed",{mixdown:t.mixdown})}))}),5e3)}}]),angular.module("bandlab.song").factory("Song",["$http","$injector","$resource",function(e,t,n){var o="https://www.bandlab.com/api/v1.3/songs";return n(o,{},{delete:{method:"DELETE",params:{id:"@id"},url:`${o}/:id`},fork:{method:"POST",url:`${o}/forks`},forkToBand:{method:"POST",params:{revisionId:"@revisionId",bandId:"@bandId"},url:"https://www.bandlab.com/api/v1.3/revisions/:revisionId/forks/bands/:bandId"},fromBandWithCursor:{method:"GET",params:{id:"@id",limit:50},preservePagination:!0,url:"https://www.bandlab.com/api/v1.3/bands/:id/songs",transformResponse:[...e.defaults.transformResponse,r]},fromUserWithCursor:{method:"GET",params:{id:"@id",authorId:"@authorId",limit:50,status:null,search:"@search"},preservePagination:!0,url:"https://www.bandlab.com/api/v1.3/users/:id/songs",transformResponse:[...e.defaults.transformResponse,r]},getDistroProjects:{method:"GET",params:{id:"@id",limit:50},preservePagination:!0,url:"https://www.bandlab.com/api/v1.3/experiment/users/:id/distro-projects",transformResponse:[...e.defaults.transformResponse,r]},getBySlug:{method:"GET",params:{entity:"@entity",username:"@username",slug:"@slug"},url:"https://www.bandlab.com/api/v1.3/:entity/:username/songs/:slug"},get:{method:"GET",params:{id:"@id"},url:`${o}/:id`},getByRevision:{method:"GET",params:{revId:"@revId"},url:`${o}?revisionId=:revId`},leave:{method:"DELETE",params:{id:"@id",userId:"@userId"},url:`${o}/:id/collaborators/:userId`},update:{method:"PATCH",params:{id:"@id"},url:`${o}/:id`}});function r(e,n,o){const r=t.get("Song");return 200===o&&(e.data=e.data.map((function(e){return new r(e)}))),e}}]);var fJ=Math.floor,hJ=Math.random;function gJ(e,t){return e+fJ(hJ()*(t-e+1))}function vJ(e,t){var n=-1,o=e.length,r=o-1;for(t=void 0===t?o:t;++n<t;){var i=gJ(n,r),a=e[i];e[i]=e[n],e[n]=a}return e.length=t,e}function bJ(e){return vJ(JL(e))}function yJ(e){return null==e?[]:function(e,t){return Cf(t,(function(t){return e[t]}))}(e,Vm(e))}function wJ(e){return vJ(yJ(e))}function $J(e){return(im(e)?bJ:wJ)(e)}function kJ(e){return e.injector().getAsync("theParams").then((function(t){const{commentId:n,download:o,replyId:r}=e.params();return{state:"track",params:{...t,commentId:n,download:o,replyId:r}}}))}function SJ(e){return e.injector().getAsync("theParams").then((function(e){return{state:"track.tree",params:e}}))}angular.module("bandlab.song.routes",["ui.router"]).config(["$stateProvider",function(e){function t(e,t,n,o,r){const i=n.params(),a=i.revId;return a?o.get({id:a}).$promise.then((function(e){return{id:e.postId,revId:e.id}})):r.getBySlug({entity:"bandSong"===t.name?"bands":"users",username:i.username,slug:i.slug}).$promise.then((function(e){return{id:e.revision.postId,revId:e.revision.id}}))}function n(e,t,n,o){t.setMetadata({title:`${o.name} by ${o.author.name} | BandLab`,description:`${o.description?`${o.description} | `:""}Listen to music from ${o.author.name} and follow their creative process on BandLab.`,image:`${o.picture.url}360x360`,imageHeight:"360",imageWidth:"360",player:n.getEmbedRevisionUrl(o.revision)})}function o(e){e.clearMetadata()}o.$inject=["Page"],n.$inject=["$transition$","Page","Share","theSong"],t.$inject=["$q","$state$","$transition$","Revision","Song"],e.state("revisionSharedKey",{url:"/revisions/:postId?sharedKey",redirectTo:function(e){const t=e.params();return{state:"track",params:{id:t.postId,sharedKey:t.sharedKey}}}}).state("userSong",{url:"/{username:[a-z0-9][a-z0-9_]{2,19}}/{slug:[a-z0-9-]{1,128}}?revId&download&{commentId:int}&{replyId:int}",resolve:{theParams:t},redirectTo:kJ}).state("userSong.boost",{url:"/boost",redirectTo:function(e){return e.injector().getAsync("theParams").then((function(e){return{state:"track.boost",params:e}}))}}).state("distributionEdit",{url:"/distribution/edit?releaseId",useTopBarForm:!0,hideGlobalPlayer:!0,views:{"":{controller:"DistributionCtrl",templateUrl:"https://www.bandlab.com/web-app/distribution/views/creation-8da43e71.html"},"tabBarForm@":{controller:["$rootScope","$scope",function(e,t){t.exitPage=function(){e.$broadcast("topBarExit")}}],templateUrl:"https://www.bandlab.com/web-app/distribution/partials/_distribution-form-tab-bar-5af2893a.html"},"topBarForm@":{controller:["$rootScope","$scope",function(e,t){t.exitPage=function(){e.$broadcast("topBarExit")}}],templateUrl:"https://www.bandlab.com/web-app/distribution/partials/_distribution-form-top-bar-6fa8a9a5.html"}},resolve:{theAccess:["Me","Release",function(e,t){return mN(e,t)}],theMembershipStatus:["Me","User",function(e,t){return fN(e,t)}],theRelease:["$stateParams","Me","Release",function(e,t,n){return n.get({userId:t.id,releaseId:e.releaseId}).$promise}],theReleaseSongs:["$transition$","Revision",async function(e,t){const n=await e.injector().getAsync("theRelease"),o=n.assets,r=[];for(const e of o)e.artists=e.artists.map((e=>({...e,type:e.role}))),r.push({...e,artists:e.artists.length?e.artists:[JSON.parse(JSON.stringify({...n.artist,type:"Primary"}))],hasBeenReleasedBefore:e.hasBeenReleasedBefore||!1,explicitContent:null===e.hasBeenReleasedBefore?null:e.explicitContent,duration:0===e.duration?(await t.get({id:e.audioId}).$promise).mixdown.duration:e.duration});return r}],isPilotUser:["Me",function(e){return hN(e)}],theGenres:["Release","Me",function(e,t){return yN(e,t)}]},onEnter:["Player",function(e){EN(e),p()&&(ql.shouldLogDistroReleaseDismiss=JSON.stringify({state:"Distro Release - Closed/Dismissed"}))}],onExit:["Player",function(e){EN(e)}],redirectTo:IN}).state("distributionCreate",{url:"/distribution/create?releaseId&redirect",useTopBarForm:!0,hideGlobalPlayer:!0,reloadOnSearch:!1,views:{"":{controller:"DistributionCtrl",templateUrl:"https://www.bandlab.com/web-app/distribution/views/creation-8da43e71.html"},"tabBarForm@":{controller:["$rootScope","$scope",function(e,t){t.exitPage=function(){e.$broadcast("topBarExit")}}],templateUrl:"https://www.bandlab.com/web-app/distribution/partials/_distribution-form-tab-bar-5af2893a.html"},"topBarForm@":{controller:["$rootScope","$scope",function(e,t){t.exitPage=function(){e.$broadcast("topBarExit")}}],templateUrl:"https://www.bandlab.com/web-app/distribution/partials/_distribution-form-top-bar-6fa8a9a5.html"}},resolve:{theAccess:["Me","Release",function(e,t){return mN(e,t)}],theMembershipStatus:["Me","User",function(e,t){return fN(e,t)}],theRelease:["$stateParams","Me","Release",function(e,t,n){return n.get({userId:t.id,releaseId:e.releaseId}).$promise}],theReleaseSongs:["$transition$",async function(e){const t=await e.injector().getAsync("theRelease"),n=t.assets,o=[];for(const e of n){for(const t of e.artists)t.type=t.role;o.push({...e,artists:e.artists.length?e.artists:[JSON.parse(JSON.stringify({...t.artist,type:"Primary"}))],hasBeenReleasedBefore:e.hasBeenReleasedBefore||!1})}return o}],isPilotUser:["Me",function(e){return hN(e)}],theGenres:["Release","Me",function(e,t){return yN(e,t)}]},onEnter:["Player",function(e){EN(e),p()&&(ql.shouldLogDistroReleaseDismiss=JSON.stringify({state:"Distro Release - Closed/Dismissed"}))}],onExit:["Player",function(e){EN(e)}],redirectTo:IN}).state("distributionSuccess",{url:"/distribution/success?redirect",templateUrl:"https://www.bandlab.com/web-app/distribution/views/creation-success-0d5cc1a7.html",controller:["$rootScope","$scope","$state","Modal","Me","AppNotifications","Loader","Release","Revision","Song",function(e,t,n,o,r,i,a,s,l,c){t.$on("topBarExit",(function(){p()?n.go("dashboard.distribution",{"#":"bl_closeWebView"}):n.go("dashboard.distribution")})),t.openLibrary=function(){SN(e,t,n,0,a,r,o,s,0,c)},t.goToDistributionAfterSuccess=function(){if(p())return ql.shouldLogDistroReleaseDismiss=JSON.stringify({state:"Distro Release - Completed"}),n.go(".",{"#":"bl_closeWebView"});Promise.resolve().then((()=>rb)).then((function(e){let{logDistroReleaseDismiss:t,logDistroRating:o}=e;return document.addEventListener("ratingEvent",(function e(t){o(t.detail),document.removeEventListener("ratingEvent",e)})),t("Distro Release - Completed"),n.go("dashboard.distribution")}))},t.hasWebviewCookie=p,import("./chunk-aa59b2f2.js").then((function(e){let{mountReleaseSuccessFAQ:n}=e;const o=n(document.querySelector("#releaseSuccessVue"),{});t.$on("$destroy",(function(){o.unmount()}))}))}],onEnter:["Player",function(e){e.pause()}]}).state("bandSong",{url:"/band/{username:[a-z][0-9a-z_]{1,19}}/{slug:[a-z0-9-]{1,128}}?revId&download&{commentId:int}&{replyId:int}",resolve:{theParams:t},redirectTo:kJ}).state("userSong.tree",{url:"/tree",redirectTo:SJ}).state("bandSong.tree",{url:"/tree",redirectTo:SJ}).state("song",{url:"/song/{songId:[a-zA-Z0-9-_]+}",params:{rewriteTracking:function(){return e=>e.replace(/^\/song\/[a-fA-F0-9-]*(($|\/).*)/g,"/project$1")}},redirectTo:function(e){return{state:"song.edit.profile",params:{songId:e.params().songId}}},template:'<div class="grid-block" ui-view="content"></div>',resolve:{theSong:["$transition$","Song",function(e,t){return t.get({id:e.params().songId}).$promise}]},onEnter:n,onExit:o,controller:["$scope","theSong",function(e,t){e.song=t,e.$on("$song:changed",(function(t,n){"update"===n.action&&e.song.$get({id:e.song.id})})),e.$on("$revision:changed",(function(){e.song.$get({id:e.song.id})}))}]}).state("song.edit",{url:"/edit",redirectTo:function(e){return{state:"song.edit.profile",params:{songId:e.params().songId}}},resolve:{canEdit:["$q","theSong",function(e,t){return e((function(e,n){t.canEdit?e(!0):n({status:403})}))}]},views:{content:{templateUrl:"https://www.bandlab.com/web-app/song/views/song-edit-layout-3391f16b.html"}}}).state("song.edit.profile",{url:"?focus",templateUrl:"https://www.bandlab.com/web-app/song/views/song-edit-profile-cda5a22a.html",controller:"ProjectEditCtrl"}).state("song.edit.collaborators",{url:"/collaborators",templateUrl:"https://www.bandlab.com/web-app/song/views/song-edit-collaborators-a6ddf52a.html",controller:"ProjectCollaboratorsCtrl"}).state("song.duplicate",{url:"/duplicate?focus",resolve:{canEdit:["$q","theSong",function(e,t){return e((function(e,n){t.canEdit?e(!0):n({status:403})}))}]},views:{content:{templateUrl:"https://www.bandlab.com/web-app/song/views/song-duplicate-bcd64d04.html",controller:"ProjectEditCtrl"}}}).state("joinProject",{url:"/join/:code",params:{rewriteTracking:function(){return()=>"/join"}},controller:["$http","$state","$stateParams","Me",function(e,t,n,o){return e.put(`https://www.bandlab.com/api/v1.3/users/${o.id}/invites/${n.code}`).then((function(e){let{data:n}=e;return t.go("mixEditor",{id:n.song.latestRevisionId,autoconnect:!0})})).catch((function(e){return 68===e.data.errorCode?t.go("projectFull"):t.go("404",{},{custom:e.data})}))}]}).state("track",{url:"/track/:id?revId&{commentId:int}&{replyId:int}&sharedKey&download",templateUrl:"https://www.bandlab.com/web-app/song/views/track-layout-9cdd472a.html",reloadOnSearch:!1,onEnter:["$transition$","Page","Share","thePost","theRevision",function(e,t,n,o,r){return r?function(e,t,n,o){t.setMetadata({tapBarTitle:"Track",title:`${o.song.name} by ${o.song.author.name} | BandLab`,description:`${o.description?`${o.description} | `:""}Listen to music from ${o.song.author.name} and follow their creative process on BandLab.`,image:`${o.song.picture.url}360x360`,imageHeight:"360",imageWidth:"360",player:n.getEmbedRevisionUrl(o)})}(0,t,n,r):"Track"===o.type?function(e,t){e.setMetadata({tapBarTitle:"Track",title:`${t.track.name} by ${t.creator.name} | BandLab`,description:`${t.caption?`${t.caption} | `:""}Listen to music from ${t.creator.name} and follow their creative process on BandLab.`,image:`${t.track.picture.url}360x360`,imageHeight:"360",imageWidth:"360"})}(t,o):function(e,t){e.setMetadata({tapBarTitle:"Track",title:`${t.revision.song.name} by ${t.revision.creator.name} | BandLab`,description:`${t.caption?`${t.caption} | `:""}Listen to music from ${t.creator.name} and follow their creative process on BandLab.`,image:`${t.revision.song.picture.url}360x360`,imageHeight:"360",imageWidth:"360"})}(t,o)}],onExit:o,resolve:{theAlbums:["$transition$","Post",function(e,t){return e.injector().getAsync("thePost").then((function(e){if("Revision"!==e.type)return"Track"===e.type?t.getPostAlbums({id:e.id}).$promise:void 0}))}],theBand:["$transition$","Band",function(e,t){return e.injector().getAsync("theSong").then((function(e){if("Band"===e?.author.type)return t.get({id:e.author.id}).$promise}))}],theCreator:["$transition$","User",function(e,t){return e.injector().getAsync("thePost").then((function(e){return t.get({id:e.creator.id}).$promise}))}],theInsights:["$transition$","$http","Me",function(e,t,n){return Mp(n,"traceability_ui_enabled").then((function(n){if("true"===n)return e.injector().getAsync("theRevision").then((function(e){if(e?.id)return t.get(`https://www.bandlab.com/api/v1.3/tracks/${e.id}/insights`).then((e=>{let{data:t}=e;return t})).catch((()=>{}))}))}))}],theOriginal:["$transition$","Song",function(e,t){return e.injector().getAsync("theRevision").then((function(e){if(e?.song.original)return t.get({id:e.song.original.songId}).$promise.catch((()=>{}))}))}],theOriginalRevision:["$transition$","Revision",function(e,t){return e.injector().getAsync("theRevision").then((function(e){if(e?.song.original)return t.get({id:e.song.original.revisionId}).$promise.catch((()=>{}))}))}],thePost:["$stateParams","Post",function(e,t){const n=e.sharedKey;return t.get({id:e.id,sharedKey:n}).$promise}],theRevision:["$stateParams","$transition$","Revision",function(e,t,n){return t.injector().getAsync("thePost").then((function(e){return"Revision"===e.type&&(e.revision.isPublic||e.revision.canEdit)?n.get({id:e.revision.id}).$promise:"Track"===e.type&&e.revisionId?n.get({id:e.revisionId}).$promise:void 0}))}],theSong:["$transition$","Song",function(e,t){const{song:n}=e.options();return n||e.injector().getAsync("theRevision").then((function(e){if(e)return t.get({id:e.song.id}).$promise}))}]},controller:["$injector","$location","$rootScope","$scope","$state","$stateParams","Band","Me","RevisionImporter","RevisionSocket","Tag","PlayerHistory","Post","Revision","User","theAlbums","theBand","theCreator","theInsights","theOriginal","theOriginalRevision","thePost","theRevision","theSong",function(e,t,n,o,r,i,a,s,l,c,u,d,p,m,f,h,g,v,b,y,w,$,k,S){o.logSocialLinkVisit=function(e){s.id!==o.creator.id&&(e=e.toLowerCase(),Promise.resolve().then((()=>rb)).then((function(t){let{logSocialLinkVisit:n}=t;n({destination:e,triggeredFrom:_p(r),userId:o.creator.id})})))},o.getLikers=function(e){return Object.assign(e,{entity:"posts",entityId:o.revision.postId}),f.likersWithCursor(e).$promise},o.getReactors=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2?arguments[2]:void 0;return Object.assign(e,{entity:"posts",postCompositeId:o.post.postCompositeId,userId:s.id,limit:t,after:n}),f.reactionsWithCursor(e).$promise},o.me=s,o.post=$,o.isPrivatelyShared=!!i.sharedKey,o.revision=k,o.originalRevision=w,o.getCollaborators=function(){let{limit:e,offset:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return f.getCollaborators({songId:k.song.id,accepted:!0,limit:e,offset:t,includeOwner:!0}).$promise},o.getSocialLinksCount=function(){return o.creator.links?Object.keys(o.creator.links).length:0},o.song=S,o.creator=v,o.insights=b,o.isValidForDistribution=bN,o.data=function(e){let{albums:t,band:n,original:o,originalRevision:r,revision:i,revisionPost:a,song:s,trackPost:l}=e;const c=Mt(t),u=Mt(n),d=Mt(o),p=Mt(r),m=Mt(i),f=Mt(a),h=Mt(s),g=Mt(l),v=Gi((function(){if(u)return u})),b=Gi((function(){return f?f.isCommentingAllowed:g?g.isCommentingAllowed:void 0})),y=Gi((function(){return!!f&&f.canEdit&&"Ready"===f.revision.mixdown.status})),w=Gi((function(){return f?f.canEdit:!!g&&g.permissions.edit})),$=Gi((function(){return f?f.revision.canPublish:g?g.permissions.edit:!!m&&m.canPublish})),k=Gi((function(){})),S=Gi((function(){return f?f.creator:g?g.creator:null})),_=Gi((function(){return f?f.creator.name:g?g.creator.name:""})),P=Gi((function(){return f?f.creator.username:g?g.creator.username:""})),M=Gi((function(){return f?f.creator.picture.url:g?g.creator.picture.url:""})),T=Gi((function(){if(h)return h.collaborators})),C=Gi((function(){return f?f.counters.comments:g?g.counters.comments:void 0})),E=Gi((function(){return f?f.comments:g?g.comments:void 0})),I=Gi((function(){return f?f.revision.song.picture.url:g?g.track.picture.url:void 0})),R=Gi((function(){return f?f.revision.song.picture.color:g?g.track.picture.color:"#282C32"})),A=Gi((function(){return f?f.createdOn:g?g.createdOn:""})),x=Gi((function(){return g?g.caption:m?m.description:void 0})),L=Gi((function(){if(m)return m.counters.forks})),O=Gi((function(){return f?f.revision.genres:g?g.revision.genres:[]})),j=Gi((function(){if(c)return c})),D=Gi((function(){return f||g||void 0})),N=Gi((function(){return m||(f?f.revision:g?g.revision:h?h.revision:void 0)})),U=Gi((function(){return f?f.isExplicit:!!g&&g.isExplicit})),F=Gi((function(){return f?f.revision.isFork:!!m&&m.isFork})),B=Gi((function(){return f?f.revision.song.isForkable:!!m&&m.song.isForkable})),W=Gi((function(){return g?g.isLiked:!!f&&f.isLiked})),V=Gi((function(){return m?"Ready"===m.mixdown.status:f?"Ready"===f.revision.mixdown.status:g?"Ready"===g.track.sample.status:void 0})),q=Gi((function(){return m?"Private"===m.post.state:f?"Private"===f.state:!!g&&"Private"===g.state})),z=Gi((function(){return m?"Public"===m.post.state:f?"Public"===f.state:!!g&&"Public"===g.state})),H=Gi((function(){return m?"Unlisted"===m.post.state:f?"Unlisted"===f.state:!!g&&"Unlisted"===g.state})),G=Gi((function(){return g?g.counters.likes:f?f.counters.likes:0})),K=Gi((function(){return f?f.revision.lyrics?.content:m?m.lyrics?.content:void 0})),Y=Gi((function(){return m?m.mixdown.duration:f?f.revision.mixdown.duration:g?g.track.sample.duration:0})),J=Gi((function(){return d||(m?m.song.original:void 0)})),X=Gi((function(){return f?f.revision.counters.plays:g?g.counters.plays:0})),Z=Gi((function(){return f?f.id:g?g.id:m?m.postId:void 0})),Q=Gi({get:function(){return m?m.post.state:f?f.state:g?g.state:void 0},set:function(e){m&&(m.post.state=e),f&&(f.state=e),g&&(g.state=e)}}),ee=Gi((function(){return h||(f?f.revision.song:m?m.song:void 0)})),te=Gi((function(){return f?f.revision.song.id:m?m.song.id:h?h.id:void 0})),ne=Gi((function(){return m&&f?{...m,post:{...f}}:m&&g?{...m,post:{...g}}:g?{...g.revision,post:{...g}}:void 0})),oe=Gi((function(){return f?f.revision.id:g?g.revisionId:m?m.id:void 0})),re=Gi({get:function(){return g?g.track.name:m?m.song.name:f?f.revision.song.name:h?h.name:""},set:function(e){g&&(g.track.name=e),m&&(m.song.name=e),f&&(f.revision.song.name=e),h&&(h.name=e)}}),ie=Gi((function(){return f?f.revision.mixdown.waveform:g?g.track.sample.waveformUrl:"https://static.bandlab.com/defaults/waveform.json"}));return{band:u,canComment:b,canDownload:y,canEdit:w,canPublish:$,canReprocessMixdown:k,commentCount:C,comments:E,coverArt:I,coverColor:R,creationDate:A,creator:S,creatorName:_,creatorProfilePicture:M,creatorUsername:P,description:x,forkCount:L,genres:O,innerAlbums:j,innerBand:v,innerCollaborators:T,innerOriginal:J,innerPost:D,innerRevision:N,isExplicit:U,isFork:F,isForkable:B,isLiked:W,isMixdownReady:V,isPrivate:q,isPublic:z,isUnlisted:H,likeCount:G,lyrics:K,mixdownDuration:Y,original:d,originalRevision:p,playCount:X,postId:Z,postState:Q,project:ee,projectId:te,revisionId:oe,revisionWithFullPost:ne,title:re,trackPost:g,waveformUrl:ie}}({albums:h,band:g,original:y,originalRevision:w,revision:k,revisionPost:"Revision"===$.type?$:null,song:S,trackPost:"Track"===$.type?$:null});const _=t.url();let P;d.setCurrentPageContext({loader:null,url:_,contentSource:_p(r)}),d.pushQueueSongs([$],_,!0),k&&k.genres?P=k.genres.length>0?k.genres[0].id:"other":"Track"===$.type&&(P=$.track.genreId?$.track.genreId:"other"),P&&p.exploreGenreTrending({genres:P,limit:20,forkable:!1,timerange:"week"}).$promise.then((function(e){let{data:t}=e;const n=$J(t);d.pushQueueSongs(n,_,!1)})),NY({Me:s,post:o.data.innerPost.value}).then((e=>{o.boostTeaserActive=e})),Mp(s,"reaction_track_post").then((e=>{o.shouldDisplayTrackPageReactions="true"===e})),Mp(s,"band_permissions_update_enabled").then((e=>{o.isBandPermissionsUpdateEnabled="true"===e})),o.hideBoostTeaser=function(){UY({Me:s,id:o.data.innerPost.value.id}),o.boostTeaserActive=!1},n.$broadcast("$track:project",{trackPost:o.data.innerPost.value,trackRevision:o.data.innerRevision.value,project:o.data.project.value,isPrivatelyShared:o.isPrivatelyShared}),i.download&&k&&"Ready"===k.mixdown.status&&k.canEdit&&l.downloadMixdown(k),!1===o.data.isMixdownReady.value&&(c.join({revisionId:o.data.revisionId.value}),o.$on("$destroy",c.disconnect)),o.$on("$mixdown:changed",(function(e,t){Object.assign(o.data.innerRevision.value.mixdown,t.mixdown)}));const M=document.querySelector(".tab-bar-title");if(M&&(M.style.display="none"),o.reorderedLinks=function(e){if(e.links){const t=["website","instagram","spotify","youTube","tikTok","soundCloud","airbit"],n={};for(const o of t)o in e.links&&(n[o]=e.links[o]);return n}return{}}(o.creator),o.$on("$post:reactionChanged",(function(e,t){let{post:n}=t;n.id===o.post.id&&(o.post.initiatorReaction=n.initiatorReaction,o.post.counters.reactions=n.counters.reactions,o.post.reactions=n.reactions)})),o.$on("$albumTrack:changed",(function(e,t){o.data.trackPost.caption=t.caption,o.data.postState.value=t.state,o.data.innerPost.value.track.genreId=t.track.genreId,o.data.genres.value[0].id=t.track.genreId,u.getGenres().then((e=>{const n=e.find((e=>e.id===t.track.genreId));o.data.genres.value[0].name=n.name}))})),o.$on("$song:changed",(function(e,t){"update"===t.action&&(o.data.title.value=t.song.name)})),o.$on("$revision:changed",(function(e,t){o.data.postState.value=t.revision.post.state,"master"===t.action&&(c.disconnect(),c.join({revisionId:o.data.revisionId.value}))})),o.updateCommentCounter=function(e){o.data.innerPost.value.counters.comments=e(o.data.innerPost.value.counters.comments)},p.fromRecommendations({userId:s.id,limit:4,genres:o.data.genres.value?.[0].id??"other"}).$promise.then((function(e){let{data:t}=e;o.relatedPosts=t.filter((e=>e.id!==o.post.id)).slice(0,3)})),k){const{shareWithOriginalAuthor:t,canMessageOriginalAuthor:n}=$D(e);o.shareWithOriginalAuthor=()=>t(o.revision,o.revision.song.original.conversationId),o.canMessageOriginalAuthor=()=>n(o.revision,o.originalRevision),o.link=`https://www.reverbnation.com/c/bandlab/crowd_review/${o.me.id}?revision_id=${k.id}`,k.song.author.id===s.id&&0===k.song.counters.collaborators&&m.getCrowdReviews({id:k.id}).$promise.then((function(e){e.length>0&&(o.crowdReview=e[0],o.totalCrowdReviews=e.length,o.crowdReview.color=o.crowdReview.score<4?"#F12C18":o.crowdReview.score<7?"#FFAF13":"#00C37D")}))}}],redirectTo:function(e){const{revId:t,...n}=e.params();if(!t)return e.injector().getAsync("theRevision").then((t=>{if(t)return{to:e.to().name,params:{...n,revId:t.id}}}))}}).state("track.boost",{url:"/boost",redirectTo:function(e){if(e.injector().get("appActions").checkAllowed("boost"))return e.injector().getAsync("thePost").then((function(e){if(!e.canEdit&&!e.permissions.edit)return"post"}))}}).state("track.boost.history",{url:"/history",redirectTo:"track.boost.history.recent"}).state("track.boost.history.recent",{url:"/recent"}).state("track.tree",{url:"/tree",reloadOnSearch:!1,onEnter:DL,onExit:jL,views:{"overlay@":{templateUrl:"https://www.bandlab.com/web-app/song/views/song-tree-view-e94108be.html",controller:"SongRevisionsFeedCtrl"}}})}]),angular.module("bandlab.audio").factory("SongStarter",["$http","Revision",function(e,t){return{getIdeasInfo:function(t){let{text:n,characterId:o,displayedGenre:r}=t;return e({method:"GET",url:"https://songstarter.bandlab.io/v2/ideas"+(n?`?text=${n}`:r?`?displayed_genre=${r}`:o?`?character=${o}`:""),withCredentials:!0}).then((function(e){return e.data}))},getRevision:function(e){return t.get({id:e,edit:!0}).$promise},getDemo:function(t){let{characterId:n,displayedGenre:o}=t;return e({method:"GET",url:"https://songstarter.bandlab.io/v2/demo"+(o?`?displayed_genre=${o}`:n?`?character=${n}`:"")}).then((function(e){return e.data}))},getCharacters:function(){return e({method:"GET",url:"https://songstarter.bandlab.io/v1/characters"}).then((function(e){return e.data}))},getDisplayedGenres:function(){return e({method:"GET",url:"https://songstarter.bandlab.io/v1/displayed_genres"}).then((function(e){return e.data.map((e=>({id:e.id,displayName:e.display_name})))}))}}}]),angular.module("bandlab.track",[]),angular.module("bandlab.track").controller("TracksCtrl",["$location","$q","$scope","$stateParams","Me","PlayerHistory","Post",function(e,t,n,o,r,i,a){var s,l=null,c=!1,u=e.url();function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.search;if(c)return t.resolve([]);var n={limit:30,after:l,state:{public:"Public",private:"Private",unlisted:"Unlisted"}[o.filter],search:e};return s=(s=a.getLibraryTracksFromUser(Object.assign(n,{userId:r.id})).$promise).then((function(e){return c=e.paging.itemsCount<e.paging.limit,l=_.get(e,"paging.cursors.after",0),e.data}))}i.setCurrentPageContext({loader:n.loadMore,url:u}),n.loadMore=function(){return n.infiniteScrollEnded?t.resolve():s=s.then((function(e){return n.infiniteScrollEnded=c,n.tracks=n.tracks||[],n.tracks=n.tracks.concat(e),i.pushQueueSongs(e,u),d()}))},d().then(n.loadMore),n.refreshSearch=function(e){return l=null,c=!1,d(e).then((function(){return s=s.then((function(e){return n.infiniteScrollEnded=c,n.tracks=e,d()}))})).then(n.loadMore)},n.$on("$albumTrack:changed",(function(e,t){const o=_.find(n.tracks,{id:t.id});o&&Object.assign(o,t)})),n.$on("$track:uploaded",(function(e,t){const o=kD(t.post);n.tracks.unshift(o)}))}]),angular.module("bandlab.track").controller("TrackStateCtrl",["$rootScope","$scope","Album","ConfirmModal",function(e,t,n,o){t.unpublishTrack=function(t){new o({confirmLabel:"Make Private",contentScope:{title:"Make revision private",message:"<p>Making your revision private will prevent this post from appearing on public feeds.</p>"},onConfirm:function(){return n.updatePost({id:t.id,state:"Private"}).$promise.then((function(){t.state="Private",e.$broadcast("$albumTrack:changed",t)}))}}).show()},t.getRevisionPostId=function(e){const[,t]=e.split("_");return[t.substring(0,8),t.substring(8,12),t.substring(12,16),t.substring(16,20),t.substring(20,32)].join("-")},t.publishTrack=function(t){new o({confirmLabel:"Publish Track",contentScope:{title:"Publish Track",message:"<p>This Track will appear in public feeds.</p>"},onConfirm:function(){return n.updatePost({id:t.id,state:"Public"}).$promise.then((function(){t.state="Public",e.$broadcast("$albumTrack:changed",t)}))}}).show()}}]),angular.module("bandlab.track").component("trackTile",{bindings:{track:"<"},templateUrl:"https://www.bandlab.com/web-app/track/partials/_track-tile-a423f235.html",controller:function(){},controllerAs:"vm"}),angular.module("bandlab.user").controller("BlockUserCtrl",["$rootScope","$scope","appActions","Me","User",function(e,t,n,o,r){function i(t,n){("block"===n?r.block({meId:o.id,userId:t.id}).$promise:r.unblock({meId:o.id,userId:t.id}).$promise).then((function(){t.isBlocked=!0,t.isFollower=!1,setTimeout((()=>{r.get({id:t.id}).$promise.then((o=>{Object.assign(t,o),e.$broadcast("$user:relationChanged",{type:n,user:t}),e.$broadcast("$conversation:leave",{id:t.conversationId})}))}),1e3)})).catch((function(t){404===t.status&&e.$broadcast("reportModal","close")}))}t.blockUser=function(e){if(!n.checkAllowed("blockUser"))return;const t=zn((()=>import("./chunk-f8183022.js")));Promise.resolve().then((()=>Tg)).then((function(n){let{createModal:o}=n;o(t,{user:e,onConfirm:()=>i(e,"block")})}))},t.unblockUser=e=>i(e,"unblock")}]),angular.module("bandlab.user").controller("FollowUserCtrl",["$scope","UserHelper",function(e,t){e.toggleFollowUser=t.toggleFollowUser}]),angular.module("bandlab.user").controller("InviteRequestsCtrl",["$rootScope","$scope","AppNotifications","Invite",function(e,t,n,o){function r(){e.$broadcast("$invite:changed")}function i(e,t){if(t&&t.data&&t.data.message){var o,i="Unable to accept invite";64===t.data.errorCode?e.band||e.bandId?(i="This band is currently full",o=e.isUserRequest?"To add a new member, remove someone first.":"Try again once a member leaves, or message the owner/admin for help."):o="Youve reached the max number of members. Band can only have 50 members.":o=_.get(t,"data.message"),n.addNotification({title:i,content:o,classList:"alert",autoclose:5e3})}r()}t.acceptInvite=function(e,t,n){e.preventDefault(),o.update({id:t}).$promise.then((function(){r(),Promise.resolve().then((()=>rb)).then((function(e){let{logBandJoin:t,logBandRequestAccept:o,logCommunityJoin:r}=e;"RequestToBand"===n.type?o({bandId:n.band.id}):"InviteToBand"===n.type?t({bandId:n.band.id}):n.community&&r()}))})).catch((e=>i(n,e)))},t.revokeInvite=function(e,t,n){e.preventDefault(),o.remove({id:t}).$promise.then((function(){r()})).catch((e=>i(n,e)))}}]),angular.module("bandlab.user").controller("InviteUserCtrl",["$q","$rootScope","$scope","Invite","User",function(e,t,n,o,r){let i,a;if(n.band)i="bands",a=n.band.id;else if(n.school)i="schools",a=n.school.id;else if(n.song)i="songs",a=n.song.id;else{if(!n.community)throw new Error("Entity missing for invite user");i="communities",a=n.community.id}function s(){o.query({id:a,entity:i,accepted:!1,limit:50}).$promise.then((function(e){n.pendingInvitedUser=[],n.pendingInvitedExternalUser=[],e.forEach((function(e){if(e.user){const t=new r(e.user);t.invite=e,n.pendingInvitedUser.push(t)}else{const t=new r({email:e.email});t.invite=e,n.pendingInvitedExternalUser.push(t)}}))}))}n.sendInvite=function(){const e=[],r=[];delete n.inviteSent,n.users.forEach((function(t){"email"!==t.type||_.find(n.pendingInvitedExternalUser,{email:t.email})?"user"!==t.type||_.find(n.pendingInvitedUser,{id:t.id})||e.push(t.id):r.push(t.email)}));const l=new o({id:a,emails:r,userIds:e,message:n.inviteMessage});l.$save({rel:i}).then((function(){n.inviteSent=!0,n.inviteMessage="",n.users=[],t.$broadcast("$invite:changed",{invite:l}),n.community&&Promise.resolve().then((()=>rb)).then((function(e){let{logCommunityInvitationSend:t}=e;t()}))})).catch((function(e){n.inviteSent=!1,n.errorMessage=e.data.message})).finally((function(){n.formInviteUser.$setPristine(),s()}))},n.$on("$invite:changed",s),n.$watchCollection("users",(function(t){if(!t)return;const o=document.createElement("input");o.type="email",n.areEmailsValid=t.filter((e=>"email"===e.type)).reduce(((e,t)=>(o.value=t.email,t.hasValidEmail=o.checkValidity(),e&&t.hasValidEmail)),!0);const i=t.filter((e=>"user"===e.type)).reduce((function(t,n){const o=new r({id:n.username});return e.all([t,o.$get()]).then((function(e){let[t]=e;return n.isValid=!0,Object.assign(n,o),t&&!0})).catch((function(){return n.isValid=!1,!1}))}),e.resolve(!0));n.areUsernamesValid=!1,e.resolve(i).then((function(e){n.areUsernamesValid=e}))})),s()}]),angular.module("bandlab.user").controller("SubscribeToFanReachCtrl",["$scope","AppNotifications","Me","User",function(e,t,n,o){e.toggleFanReachSubscription=function(e){let r;r=e.fanReach.isFan?o.unsubscribeFromFanReach({userId:e.id,meId:n.id}).$promise:o.subscribeToFanReach({userId:e.id,meId:n.id}).$promise,r.then((function(){Object.assign(e,{fanReach:{permissions:{...e.fanReach.permissions},isFan:!e.fanReach.isFan}}),e.fanReach.isFan&&Promise.resolve().then((()=>rb)).then((function(t){let{logFanReachSubscribe:n}=t;n(e)})),t.addNotification({title:e.fanReach.isFan?"You've subscribed as a fan!":"You're not a subscribed fan any more!",content:e.fanReach.isFan?null:"Subscribe again any time to get email updates from this creator.",image:e.fanReach.isFan?"https://www.bandlab.com/web-app/images/notifications/mail-sent-ea59d0e6a8.svg":"https://www.bandlab.com/web-app/images/notifications/mail-x-6448926fa2.svg",autoclose:8e3}),localStorage.setItem("fanReachTooltipClosed",!0)})).catch((function(e){Promise.resolve().then((()=>ZD)).then((function(n){let{CODE_NO_EMAIL:o,CODE_UNCONFIRMED_EMAIL:r}=n;const i=e.data.errorCode;if(i===o||i===r){const e=zn((()=>import("./chunk-14e15eec.js")));Promise.resolve().then((()=>Tg)).then((function(t){let{createModal:n}=t;n(e,{emailUnconfirmed:i===r})}))}else 409===i?t.addNotification({title:e.data.message,classList:"alert",autoclose:8e3}):t.addNotification({title:"Something went wrong, please try again later",classList:"alert",autoclose:8e3})}))}))},e.subscribeViaEmail=function(e){const r=o.subscribeToFanReach({userId:e.id,meId:n.id}).$promise;Object.assign(e,{fanReach:{isFan:!1,subscribing:!0}}),r.then((function(){Object.assign(e,{fanReach:{isFan:!0,subscribing:!1}}),Promise.resolve().then((()=>rb)).then((function(t){let{logFanReachSubscribe:n}=t;n(e)}))})).catch((function(n){Promise.resolve().then((()=>ZD)).then((function(e){let{CODE_NO_EMAIL:o,CODE_UNCONFIRMED_EMAIL:r}=e;const i=n.data.errorCode;if(i===o||i===r){const e=zn((()=>import("./chunk-14e15eec.js")));Promise.resolve().then((()=>Tg)).then((function(t){let{createModal:n}=t;n(e,{emailUnconfirmed:i===r})}))}else t.addNotification({title:n.data.message,classList:"alert",autoclose:8e3})})),Object.assign(e,{fanReach:{isFan:!1,subscribing:!1}})}))}}]),angular.module("bandlab.user").controller("SubscribeToUserPostsCtrl",["$scope","AppNotifications","Me","User",function(e,t,n,o){e.toggleSubscribe=function(e){o.followRequest({id:e.id,followerId:n.id,isSubscriber:!e.isSubscriber}).$promise.then((function(n){Object.assign(e,{isSubscriber:n.isSubscriber}),t.addNotification({title:n.isSubscriber?"Well notify you when this user posts something":"We wont notify you when this user posts something",image:n.isSubscriber?"https://www.bandlab.com/web-app/images/settings/notifications-on-fd107b9345.svg":"https://www.bandlab.com/web-app/images/settings/notifications-off-be2e6599e1.svg",autoclose:8e3})})).catch((function(){t.addNotification({title:"Something went wrong, please try again later",classList:"alert",autoclose:8e3})}))}}]),angular.module("bandlab.user").controller("UserAlbumsCtrl",["$q","$scope","$state","$stateParams","Album","AppNotifications","Me","theUser",function(e,t,n,o,r,i,a,s){var l,c=null,u=!1;function d(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.search;if(u)return e.resolve([]);const i={userId:s.id,after:c,limit:20,search:t};if(o.likes)l=r.liked(i).$promise;else if(o.purchased)l=r.purchased(i).$promise;else{const e="user.albums"===n.current.name?"Released":!!o.filter&&("released"===o.filter?"Released":"Draft");l=r.fromUser(e?{...i,state:e}:i).$promise}return l=l.then((function(e){return u=e.paging.itemsCount<e.paging.limit,c=_.get(e,"paging.cursors.after",0),e.data}))}t.isTippable=a.isTippable,t.loadMore=function(){return t.infiniteScrollEnded?e.resolve():l=l.then((function(e){return t.infiniteScrollEnded=u,t.albums=t.albums||[],t.albums=t.albums.concat(e.map((e=>(e.creator||(e.creator=s),e)))),d()}))},d().then(t.loadMore).catch((function(e){403===e?.data?.errorCode&&(t.infiniteScrollEnded=!0,n.reload(),i.addNotification({content:e.data.message,classList:"alert",autoclose:5e3}))})),t.refreshSearch=function(e){return c=null,u=!1,d(e).then((function(){return l=l.then((function(e){return t.infiniteScrollEnded=u,t.albums=e.map((e=>(e.creator||(e.creator=s),e))),d()}))})).then(t.loadMore)},t.$on("$album:changed",(function(e,n){if(["mark-deleted","unmark-deleted"].includes(n.action)){const e=_.find(t.albums,{id:n.album.id});e&&(e.isDeleting="mark-deleted"===n.action||null)}else{if("deleted"===n.action)return Gf(t.albums,{id:n.album.id}),void(t.albums&&t.albums.length<20&&t.loadMore());"create"===n.action&&t.albums.unshift(n.album)}})),t.createAlbum=function(e){e.stopPropagation(),e.preventDefault(),n.go("album.new")}}]),angular.module("bandlab.user").controller("UserBandsCtrl",["$q","$scope","$state","$stateParams","AppNotifications","Band","Me","theUser",function(e,t,n,o,r,i,a,s){var l,c=0,u=!1;function d(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.search;return u?e.resolve([]):((l=i.fromUser({userId:s.id,offset:c,limit:20,role:o.role,search:t}).$promise).then((function(e){u=0===e.length||e.length<20,c+=e.length})),l)}t.isNewBandFeaturesAlertActive=!ql.getItem("isNewBandFeaturesAlertDismissed"),t.loadMore=function(){return t.infiniteScrollEnded?e.resolve():l=l.then((function(e){return t.infiniteScrollEnded=u,t.bands=t.bands||[],t.bands=t.bands.concat(e),d()}))},t.dismissNewBandFeaturesAlert=function(){ql.setItem("isNewBandFeaturesAlertDismissed",!0),t.isNewBandFeaturesAlertActive=!1},d().then(t.loadMore).catch((function(e){403===e?.data?.errorCode&&(t.infiniteScrollEnded=!0,n.reload(),r.addNotification({content:e.data.message,classList:"alert",autoclose:5e3}))})),t.refreshSearch=function(e){return c=0,u=!1,d(e).then((function(){return l=l.then((function(n){return t.state.params.search=e,t.infiniteScrollEnded=u,t.bands=n,d()}))})).then(t.loadMore)},t.$on("$band:changed",(function(e,n){if(["mark-deleted","unmark-deleted"].includes(n.action)){const e=_.find(t.bands,{id:n.band.id});e&&(e.isDeleting="mark-deleted"===n.action||null)}else{if("delete"===n.action)return Gf(t.bands,{id:n.band.id}),void(t.bands.length<20&&t.loadMore());"create"===n.action&&t.bands.unshift(n.band)}})),t.$on("$band:left",(function(e,n){a.id===s.id?Gf(t.bands,n.band):(n.band.isMember=!1,Gf(n.band.members,{id:a.id}))}))}]),angular.module("bandlab.user").controller("UserCollectionsCtrl",["$q","$scope","$state","$stateParams","AppNotifications","Collection","theUser",function(e,t,n,o,r,i,a){var s,l=null,c=!1;function u(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.search;if(c)return e.resolve([]);const n={userId:a.id,after:l,limit:20,includePrivate:!o.likes&&"public"!==o.filter,search:t};return s=(s=o.likes?i.liked(n).$promise:i.fromUser(n).$promise).then((function(e){return c=e.paging.itemsCount<e.paging.limit,l=_.get(e,"paging.cursors.after",0),e.data}))}t.loadMore=function(){return t.infiniteScrollEnded?e.resolve():s=s.then((function(e){return t.infiniteScrollEnded=c,t.collections=t.collections||[],t.collections=t.collections.concat(e),u()}))},u().then(t.loadMore).catch((function(e){403===e?.data?.errorCode&&(t.infiniteScrollEnded=!0,n.reload(),r.addNotification({content:e.data.message,classList:"alert",autoclose:5e3}))})),t.refreshSearch=function(e){return l=null,c=!1,u(e).then((function(){return s=s.then((function(e){return t.infiniteScrollEnded=c,t.collections=e,u()}))})).then(t.loadMore)},t.$on("$collection:changed",(function(e,n){if(["mark-deleted","unmark-deleted"].includes(n.action)){const e=_.find(t.collections,{id:n.collection.id});e&&(e.isDeleting="mark-deleted"===n.action||null)}else{if("delete"===n.action)return Gf(t.collections,{id:n.collection.id}),void(t.collections&&t.collections.length<20&&t.loadMore());"create"===n.action&&t.collections.unshift(n.collection)}}))}]),angular.module("bandlab.user").controller("UserCommunitiesCtrl",["$q","$scope","$stateParams","Community","Me","theUser",function(e,t,n,o,r,i){var a,s=0,l=!1;function c(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.search;return l?e.resolve([]):((a=o.fromUser({userId:i.id,offset:s,limit:20,role:n.role,search:t}).$promise).then((function(e){l=0===e.length||e.length<20,s+=e.length})),a)}t.loadMore=function(){return t.infiniteScrollEnded?e.resolve():a=a.then((function(e){return t.infiniteScrollEnded=l,t.communities=t.communities||[],t.communities=t.communities.concat(e),c()}))},c().then(t.loadMore),t.refreshSearch=function(e){return s=0,l=!1,c(e).then((function(){return a=a.then((function(e){return t.infiniteScrollEnded=l,t.communities=e,c()}))})).then(t.loadMore)},t.$on("$community:changed",(function(e,n){if(["mark-deleted","unmark-deleted"].includes(n.action)){const e=_.find(t.communities,{id:n.community.id});e&&(e.isDeleting="mark-deleted"===n.action||null)}else{if("delete"===n.action)return Gf(t.communities,{id:n.community.id}),void(t.communities.length<20&&t.loadMore());"create"===n.action&&t.communities.unshift(n.community)}})),t.$on("$community:left",(function(e,n){r.id===i.id?Gf(t.communities,n.community):(n.community.isMember=!1,Gf(n.community.members,{id:r.id}))}))}]);const _J={class:"ds-modal-header"},PJ={class:"ds-modal-title"},MJ={key:0,class:"ds-modal-content"},TJ={key:0,class:"ds-modal-content-p"},CJ=["innerHTML"],EJ=Vn({__name:"BasicModal",props:{title:{},subtitle:{},subtitleVHtml:{},actions:{},size:{},bumpZIndex:{type:Boolean}},emits:["closeModal"],setup(e,t){let{emit:n}=t;const o=n;return(e,t)=>(si(),pi("section",{class:ae(["ds-modal",[`ds-modal-size-${e.size}`,{"ds-modal-bump-z-index":e.bumpZIndex}]])},[bi("header",_J,[bi("h2",PJ,me(e.title),1)]),e.subtitle||e.subtitleVHtml?(si(),pi("section",MJ,[e.subtitle?(si(),pi("p",TJ,me(e.subtitle),1)):(si(),pi("p",{key:1,class:"ds-modal-content-p",innerHTML:e.subtitleVHtml},null,8,CJ))])):_i("v-if",!0),e.actions?.length?(si(),pi("footer",{key:1,class:ae(["ds-modal-footer",{"ds-modal-footer-two-buttons":2===e.actions.length,"ds-modal-footer-one-button":1===e.actions.length}])},[(si(!0),pi(ti,null,So(e.actions,(e=>(si(),mi(Dd,{key:e.label,color:e.color,size:"medium",type:"button",padding:"default",onClick:t=>{e.onClick?.(t),o("closeModal")}},{default:Tn((()=>[ki(me(e.label),1)])),_:2},1032,["color","onClick"])))),128))],2)):_i("v-if",!0),yi(ib,{onClick:t[0]||(t[0]=e=>o("closeModal"))})],2))}}),IJ={components:{Button:Dd,BoostPrivateBanner:cK,IconStopSign:zn((()=>import("./chunk-2d7bcba4.js"))),IconReload:zn((()=>Promise.resolve().then((()=>eV))))},props:{userId:{type:String,default:""}},emits:["closeModal"],setup(e){const t=Zo("$injector"),n=t.get("AppNotifications"),o=t.get("Me"),r=Vt(null),i=Vt(!1),a=Vt(!0),s=Vt(!1),c=Vt(0),u=Vt(0),d=Gi((()=>0===u.value&&0===c.value)),p=Vt("true"===l.get("hasSeenStopProfileBoostButtonTooltip")),m=Gi((()=>`<span class="semibold-40" style="margin-right: 8px;">${c.value}</span> Engagements`)),f=Gi((()=>`<span class="semibold-40" style="margin-right: 8px;">${u.value}</span> Impressions`)),h=Gi((()=>VA(r?.value?.isTrial?r?.value?.trialPeriodEndDate:r?.value?.expiresOn)));function g(){MD("bandlab_user",e.userId).then((function(e){c.value=e?.gain?.engagements||0,u.value=e?.gain?.impressions||0,a.value="active"===e?.campaign.status}))}function v(){s.value=!0,Jg(o.id).then((()=>{a.value=!1,xv()})).catch((e=>{n.addNotification({title:e?.data?.message||"Something went wrong, please try again later",classList:"alert",autoclose:8e3})})).finally((()=>{s.value=!1}))}function b(){if("true"===l.get("hasSeenStopProfileBoostButtonTooltip"))return!1;l.set("hasSeenStopProfileBoostButtonTooltip",!0),p.value=!0}return ao((()=>{wv("profile"),g(),Gg(o.id).then((function(e){r.value=e}))})),uo((()=>{ED("bandlab_user",e.userId)})),{engagementTemplate:m,expiryDateString:h,impressionTemplate:f,isZerocase:d,Me:o,isLoading:s,isLoadingProfileBoostCreation:i,isProfileAutoBoostActive:a,hasSeenStopProfileBoostButtonTooltip:p,handleBoostModalContainerClick:function(){b()},openStopBoostConfirmationModal:function(){b(),_g(EJ,{size:"small",title:"Stop profile autoboost?",subtitle:"Your profile will no longer be promoted on the Feed and Explore pages.",actions:[{label:"Cancel",color:"secondary"},{label:"Stop",color:"destructive",onClick:v}]})},markStopProfileBoostButtonTooltipAsSeen:b,restartProfileBoostCampaign:function(){i.value=!0,Yg(o.id).then((function(){i.value=!1,a.value=!0,g()})).catch((async function(e){const t=await e.response.json();n.addNotification({title:t.message||"Something went wrong, please try again later",classList:"alert",autoclose:8e3}),i.value=!1}))}}}},RJ={class:"modal-header-new"},AJ={style:{"margin-bottom":"24px"},width:"54",height:"54",viewBox:"0 0 54 54",fill:"none"},xJ=[bi("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"m27 20.25 4.64 2.11L33.75 27l2.12-4.64 4.63-2.11-4.63-2.11-2.12-4.64-2.11 4.64L27 20.25Zm-15.88 6.61L9 31.5l-2.12-4.64-4.63-2.11 4.63-2.11L9 18l2.12 4.64 4.63 2.11-4.63 2.11Zm10.46-12.03-2.45 5.42-2.46-5.42-5.42-2.46 5.42-2.45 2.45-5.42 2.46 5.42L27 12.38l-5.42 2.45Zm2.05 17.77-13.5 13.52-3.38-3.37 16.88-16.9 9 9L45.83 20H43v-4h10v10h-4v-2.81L32.62 41.6l-9-9Z",fill:"#B400FF"},null,-1)],LJ={class:"boost-modal-header-title"},OJ={key:0,class:"modal-profile-boost-header-subtitle"},jJ=bi("br",null,null,-1),DJ={key:1,class:"modal-profile-boost-header-subtitle"},NJ={key:2,class:"modal-profile-boost-header-subtitle"},UJ={key:0,class:"modal-content modal-content-new row-gap-24"},FJ={class:"boost-modal-info-container"},BJ=["innerHTML"],WJ={class:"regular-14/20"},VJ=["innerHTML"],qJ={class:"regular-14/20"},zJ={class:"boost-modal-footer"},HJ={key:0,class:"boost-modal-footer-container"},GJ={class:"boost-modal-footer-text"},KJ={class:"boost-modal-footer-cta"},YJ={class:"tooltip-opener"},JJ={key:1,class:"boost-modal-footer-container"},XJ={class:"boost-modal-footer-text"},ZJ={class:"boost-modal-footer-cta"},QJ=ld(IJ,[["render",function(e,t,n,o,r,i){const a=vo("BoostPrivateBanner"),s=vo("IconStopSign"),l=vo("Button"),c=vo("IconReload");return si(),pi("aside",{class:ae(["modal modal-profile-boost",{"modal-boost-zerocase":o.isZerocase}]),onClick:t[1]||(t[1]=function(){return o.handleBoostModalContainerClick&&o.handleBoostModalContainerClick(...arguments)})},[bi("div",{class:"modal-close",onClick:t[0]||(t[0]=t=>e.$emit("closeModal"))}),bi("header",RJ,[(si(),pi("svg",AJ,xJ)),bi("h2",LJ,me("Profile auto-boost"),1),o.isZerocase?(si(),pi("div",OJ,[ki(me("No campaign insights yet")+" ",1),jJ,ki(" "+me("Check back later."),1)])):o.isProfileAutoBoostActive?(si(),pi("div",DJ,me("Track your auto-boost and see how it performs on BandLab."),1)):(si(),pi("div",NJ,me("Your campaign is stopped and will automatically resume with the next BandLab Membership charge. You can also restart it manually anytime by clicking the button below."),1))]),o.isZerocase?_i("v-if",!0):(si(),pi("div",UJ,[o.Me.isPrivate?(si(),mi(a,{key:0})):_i("v-if",!0),bi("div",FJ,[bi("div",{class:ae(["boost-modal-info",{muted:!o.isProfileAutoBoostActive}])},[bi("div",{class:"semibold-24/32",innerHTML:o.engagementTemplate},null,8,BJ),bi("div",WJ,me("Total number of times a user has interacted with your profile."),1)],2),bi("div",{class:ae(["boost-modal-info",{muted:!o.isProfileAutoBoostActive}])},[bi("div",{class:"semibold-24/32",innerHTML:o.impressionTemplate},null,8,VJ),bi("div",qJ,me("Total number of times your profile was seen on BandLab"),1)],2)])])),bi("footer",zJ,[o.isProfileAutoBoostActive?(si(),pi("div",HJ,[bi("div",GJ,me("Do you want to stop the promotion?"),1),bi("div",KJ,[bi("span",YJ,[yi(l,{class:"boost-modal-footer-cta-button",type:"button",size:"small",color:"transparent",padding:"default",onClick:o.openStopBoostConfirmationModal},{"leading-icon":Tn((()=>[yi(s,{size:14})])),default:Tn((()=>[ki(" "+me("Stop AutoBoost"),1)])),_:1},8,["onClick"]),bi("div",{class:ae(["tooltip tooltip-top tooltip-small-only",{hide:o.hasSeenStopProfileBoostButtonTooltip}])},me("Click the button if you want to stop the Profile Boost promotion campaign"),3)])])])):(si(),pi("div",JJ,[bi("div",XJ,me("Do you want to reset the stats and restart the promotion?"),1),bi("div",ZJ,[yi(l,{class:"boost-modal-footer-cta-button",type:"button",size:"small",color:"transparent","is-loading":o.isLoadingProfileBoostCreation,padding:"default",onClick:o.restartProfileBoostCampaign},{"leading-icon":Tn((e=>[yi(c,Ci(e,{size:16}),null,16)])),default:Tn((()=>[ki(" "+me("Restart"),1)])),_:1},8,["is-loading","onClick"])])]))])],2)}]]);function eX(e){return e&&!/^https?:\/\//i.test(e)?`//${e}`:e}angular.module("bandlab.user").controller("UserCtrl",["$http","$rootScope","$scope","$state","appActions","AppNotifications","Me","Modal","User",function(e,t,n,o,r,i,a,s,c){const u=this;u.$onInit=function(){u.isOwnProfile=a.id===u.user.id,u.showProfileCounter=1===u.user.counters?.profilePictures&&u.isOwnProfile||u.user.counters?.profilePictures>1,u.tipJarLink=o.href("userTip",{username:u.user.username},{absolute:!0}),localStorage.getItem("collabTooltip")&&(u.collabTooltipCount=parseInt(localStorage.getItem("collabTooltip"))),u.firstSocialLink=u.user.links&&{name:Object.keys(u.user.links)[0],link:Object.values(u.user.links)[0]},u.tikTok=eX(u.user.links?.tikTok),u.website=eX(u.user.links?.website),u.isOwnProfile||u.me.isAnonymous()||c.getFanReachSubscriptionState({userId:u.user.id,meId:u.me.id}).$promise.then((function(e){u.user.fanReach=e})),Promise.all([Kg(u.user.id),Mp(a,"le_multiple_profile_pics_enabled"),Mp(a,"open_to_collab_enabled"),Mp(a,"collab_preferences_enabled")]).then((async function(e){let[t,o,r,i]=e;u.isMembershipLoading=!1,u.hasMembership=t.isActive,u.multipleProfilePicsEnabled="true"===o,u.openToCollabEnabled="true"===r,u.collabPreferencesEnabled="true"===i,n.$applyAsync(),g()})).then((function(){u.collabPreferencesEnabled&&c.getCollaborationPreferences({userId:u.user.id}).$promise.then((function(e){u.collaborationPreferences=e}))}))},u.$onDestroy=function(){d(),p(),m(),f()},u.copyLink=function(){i.addNotification({title:"Copied to clipboard",classList:"success",autoclose:1e3})},u.displaySendTip=function(){if(r.checkAllowed("tip"))return Promise.resolve().then((()=>Ap)).then((function(e){let{logEvent:t}=e;t("tipjar_send_tip_start")})),new s({id:"tipSetModal",template:'<tip-user-form user="user"></tip-user-form>',contentScope:{user:u.user}}).show()},u.displayProfilePictures=function(){_g(Xb,{user:u.user,isOwnProfile:u.isOwnProfile,triggeredFrom:"user_profile"})},u.displayUploadProfilePicture=function(){c.getProfilePictures({userId:a.id}).$promise.then((function(e){new s({id:"pictureUploadSuccess",templateUrl:"https://www.bandlab.com/web-app/account/settings/partials/_picture-upload-4824490a.html",contentScope:{hasMembership:u.hasMembership,me:u.me,multipleProfilePicsEnabled:u.multipleProfilePicsEnabled,profilePictures:e,triggeredFrom:"user_profile"}}).show()}))},u.getFollowers=function(e){return c.relation(Object.assign(e,{id:u.user.id,rel:"followers"})).$promise},u.getFollowing=function(e){return c.relation(Object.assign(e,{id:u.user.id,rel:"following"})).$promise},u.isBlockedOrBlockedByMe=function(){return u.user.isBlockingMe||u.user.isBlocked},u.isMembershipLoading=!0,u.isPrivateAndHidden=function(){return u.user.isPrivate&&"Following"!==u.user.followingState&&!u.isOwnProfile},u.logSocialLinkVisit=function(e){a.id!==u.user.id&&Promise.resolve().then((()=>rb)).then((function(t){let{logSocialLinkVisit:n}=t;n({destination:e,triggeredFrom:_p(o),userId:u.user.id})}))},u.logCollabSettingsLinkVisit=function(){Promise.resolve().then((()=>rb)).then((function(e){let{logCreatorConnectSettingsOpen:t,logCreatorConnectFindTalentsOpen:n}=e;"Ready"===u.user.collaborationStatus&&u.collaborationPreferences.lookingFor.skills.length?n("user_profile"):t("user_profile")}))},u.me=a,u.onBoostProfileClick=function(){u.hasMembership?_g(QJ,{userId:a.id}):new s({id:"paywallModal",templateUrl:"https://www.bandlab.com/web-app/membership/partials/_paywall-modal-ee6789e7.html",contentScope:{productAttribution:"boost_profile",productAttributionGroup:"artist_services"}}).show()},u.shouldHideStopBoostCampaignTooltip=v,u.markProfileBoostButtonTooltipAsSeen=function(){if(v())return!1;l.set("hasSeenProfileBoostButtonTooltip",!0)},new Set(["fca75734-ee16-4927-bb9e-f7125fee6221","c93a2dbd-09f5-49f8-9292-c5c2e74c86ec","224f90e0-5904-4f2e-b2ed-1be2a511fcb0","7cb32981-391f-e511-80c4-0003ff466cc6"]).has(u.me.id)&&e.get("https://api.airtable.com/v0/appcKqKDRNBEoL0HJ/artists",{headers:{Authorization:"Bearer patLApJNce8OvU1HB.1fdf1c23cd8e824a11281be360f583cf6f4e85cdc9309d151bdeaee4c07a7b3e"}}).then((function(e){let{data:{records:t}}=e;n.discogsToBandLab=t.map((e=>e.fields)).reduce((function(e,t){return e[t.discogs_id]=t,e}),{})}));const d=t.$on("$user:relationChanged",(function(e,t){u.user.id===t.user.id&&Object.assign(u.user,t.user)})),p=t.$on("profilePictureModal:updated",(function(){h().then((function(){b(),g()}))})),m=t.$on("$user:changed",(function(e,t){let{action:n}=t;"profilePicture"===n&&h().then((()=>{u.isOwnProfile&&(u.me.picture.isDefault=u.user.picture.isDefault)}))})),f=t.$on("profilePictureModal:closed",(function(){b(),g()}));function h(){return c.get({id:u.user.id}).$promise.then((function(e){u.user.counters.profilePictures=e.counters.profilePictures,u.user.picture.url=e.picture.url,u.user.picture.isDefault=e.picture.isDefault}))}function g(){setTimeout((function(){const e=document.querySelector(".profile-picture-counter");e&&(e.style.opacity="0")}),1500)}function v(){const e="true"===l.get("hasSeenProfileBoostButtonTooltip");return!u.isOwnProfile||!u.hasMembership||e}function b(){const e=document.querySelector(".profile-picture-counter");e&&u.showProfileCounter&&(e.style.opacity="1")}}]),angular.module("bandlab.user").component("boostedUserCard",{bindings:{ad:"=",adEventSource:"@",size:"@"},templateUrl:"https://www.bandlab.com/web-app/user/partials/_boosted-user-card-42180f1a.html",controller:["$state","Me","PlayerHistory",function(e,t,n){const o=this;o.me=t,o.onEngagement=function(){Promise.resolve().then((()=>ID)).then((function(e){let{logEvent:t}=e;t(o.ad.adEngagementEvent,"engagement",o.adEventSource)}))},o.onImpression=function(){Promise.resolve().then((()=>ID)).then((function(e){let{logEvent:t}=e;t(o.ad.adImpressionEvent,"impression",o.adEventSource)}))},o.$onDestroy=function(){n.removeQueueContext(o.playerQueueContext)},o.$onInit=function(){o.user=o.ad.adCreative.user,o.userSkills=o.user.skills?.map((e=>e.name)).join(", "),o.userTrack=o.ad.adCreative.posts&&o.ad.adCreative.posts[0],n.pushQueueSongs([o.userTrack],o.playerQueueContext,!0)},o.contentSource=_p(e),o.playerQueueContext=ad()}],controllerAs:"vm"}),angular.module("bandlab.user").directive("boostedUserTooltip",["$document",function(e){return{restrict:"A",scope:{excludeSelectors:"=",onDismiss:"&"},link:async function(t){function n(e){let n=!1;if(t.excludeSelectors.forEach((t=>{e.target===document.querySelector(t)&&(n=!0)})),n)return!1;t.onDismiss(),t.$applyAsync(),o()}function o(){e.off("click",n)}e.on("click",n),t.$on("$destroy",(function(){o()}))}}}]),angular.module("bandlab.user").component("followersCard",{bindings:{user:"<"},templateUrl:"https://www.bandlab.com/web-app/user/partials/_followers-card-d457b03e.html",controller:["$element","$stateParams","$rootScope","$timeout","Me","User",function(e,t,n,o,r,i){var a=this;function s(){t.followers&&function(){const t=e[0].querySelector("[users-modal]");o((()=>{})).then((function(){t.click()}))}(),l({limit:10}).then((function(e){let{data:t}=e;a.users=t}))}function l(e){return i.relation(Object.assign(e,{id:a.user.id,rel:"followers"})).$promise}a.$onInit=s,a.getFollowers=l,a.me=r,a.logFollowerSectionView=Ev,n.$on("$user:relationChanged",s)}],controllerAs:"vm"}),angular.module("bandlab.user").directive("likers",["$compile","Comment","Me","User",function(e,t,n,o){return{restrict:"A",link:function(r,i,a){const s=angular.element(`<div class="tooltip tooltip-users" ${a.usersModalList?"users-modal":""} users-modal-list="${a.usersModalList}" users-modal-title="Likes" ng-click="$event.stopPropagation()"><span class="tooltip-text">Loading</span></div>`);let l=null;function c(){return(a.likersCommentId?t.likersWithCursor({entity:`${a.likersEntityType}`,entityId:a.likersEntityId,id:a.likersCommentId,limit:11},{cache:!0}).$promise:o.likersWithCursor({entity:a.likersEntityType,entityId:a.likersEntityId,limit:11},{cache:!0}).$promise).then((function(e){let{data:t}=e;const o=t.some((function(e){return e.id===n.id}));return!0!==l||o?!1===l&&(t=t.filter((function(e){return e.id!==n.id}))):t.unshift(n),function(e){if(e.length){var t='<span class="popover-placeholder"></span>',n=parseInt(a.likersCount);s.empty(),e.forEach((function(e){t+=`<span class="tooltip-text">${e.name}</span>`})),n>10&&(t+=`<span class="tooltip-text tooltip-info">+${n-10} More</span>`),s.append(t),u()}}(t.slice(0,10))})).catch((function(){s.remove()}))}function u(){i[0].getBoundingClientRect().top-s[0].getBoundingClientRect().height<40||function(e){let t=e.parentElement;for(;t;){const n=getComputedStyle(t).overflowY;if(("scroll"===n||"auto"===n)&&t.scrollHeight>t.clientHeight){const n=t.getBoundingClientRect(),o=e.getBoundingClientRect();if(n.top>o.top)return!0}t=t.parentElement}return!1}(s[0])?s.removeClass("above").addClass("below"):s.addClass("above").removeClass("below")}e(s)(r),i.on("mouseenter",(function(){a.likersCount&&0!==parseInt(a.likersCount)&&a.likersEntityType&&a.likersEntityId&&(i.css("position","relative"),i.css("padding-top",a.likersPadding||"8px"),i.css("margin-top",a.likersPadding?`-${a.likersPadding}`:"-8px"),i.append(s),s.addClass("active"),u(),c())})),i.on("mouseleave",(function(){s&&s.removeClass("active")})),r.$on("like",(function(e,t){t.id===a.likersEntityId&&t.commentId===a.likersCommentId&&(l=t.isLiked,s&&c(t.isLiked,t.count))}))}}}]),angular.module("bandlab.user").directive("selectMultipleUsers",["$q","Search",function(e,t){return{restrict:"E",templateUrl:"https://www.bandlab.com/web-app/user/partials/_select-multiple-users-168a15de.html",scope:{users:"=",placeholder:"@",suggestedUsers:"<",allowEmails:"<",allowUsers:"<",pendingExternalUsers:"<",pendingUsers:"<",excludeBand:"<",excludeCommunity:"<",excludeSong:"<"},link:function(n,o){const r=o[0].querySelector("input");let i,a;function s(o){if(angular.isUndefined(o)||0===o.length)n.suggestions["0users"]=[];else{if(n.suggestedUsers){const t=o.trim().replace(/\s+/," ").toLowerCase();i=e.resolve(n.suggestedUsers.filter((e=>_.includes(e.name.toLowerCase(),t)||_.includes(e.username.toLowerCase(),t))))}else i=t.users({excludeBand:_.get(n,"excludeBand.id"),excludeCommunity:_.get(n,"excludeCommunity.id"),excludeSong:_.get(n,"excludeSong.id"),query:o,limit:15}).then((e=>{let{data:t}=e;return t}));i.then((e=>{if(a!==o&&o)return s(a);n.suggestions["0users"]=e.filter((e=>!(n.users.find((t=>t.id===e.id))||n.pendingUsers.find((t=>t.id===e.id)))))}))}}function l(){if(!n.allowEmails)return void(n.inviteUser=n.inviteUser.replace(/[,]+$/,",").replace(/[;]+$/,";"));const e=new Set(n.inviteUser.split(/[;,]/).map((e=>e.trim())).filter(Boolean));if(!/[;,]$/.test(n.inviteUser)&&e.size<2)return;const t=Array.from(e).flatMap((e=>e.indexOf("@")>0?{type:"email",email:e}:n.allowUsers?{type:"user",username:e.replace("@","")}:[])).filter((e=>e.email?!(n.users.find((t=>t.email===e.email))||n.pendingExternalUsers.find((t=>t.email===e.email))):!(n.users.find((t=>t.username===e.username))||n.pendingUsers.find((t=>t.username===e.username)))));n.users=n.users.concat(t),t.length||!n.inviteUser.endsWith(",")&&!n.inviteUser.endsWith(";")?n.inviteUser="":n.inviteUser=n.inviteUser.slice(0,-1)}n.allowEmails=!1!==n.allowEmails,n.allowUsers=!1!==n.allowUsers,n.placeholder=n.placeholder||n.allowEmails&&n.allowUsers&&"Username or email"||n.allowEmails&&"Email"||n.allowUsers&&"Username"||"",n.inviteUser="",n.suggestions={"0users":[]},n.users=n.users||[],n.pendingExternalUsers=n.pendingExternalUsers||[],n.pendingUsers=n.pendingUsers||[],o[0].closest(".modal").addEventListener("click",(function(e){!e.target.closest(".select-multiple-users")&&n.inviteUser&&(n.inviteUser+=";",l(),n.$applyAsync())})),n.setUser=function(e){e.type="user",n.users.push(e),n.inviteUser=""},n.handleKeys=function(e){8!==e.which||n.inviteUser?(9===e.which&&n.inviteUser||13===e.which)&&(e.preventDefault(),setTimeout((function(){n.inviteUser&&(n.inviteUser+=";",l())}))):n.users.pop()},n.removeUser=function(e){Gf(n.users,e),r.focus()},n.clearSuggestions=function(){n.suggestions={"0users":[]}},n.$watch("inviteUser",(function(){n.users.length>=10?n.inviteUser="":(a=n.inviteUser,l(),i&&0===_.get(i,"$$state.status")||s(a))}))}}}]),angular.module("bandlab.user").component("suggestedUsersCard",{templateUrl:"https://www.bandlab.com/web-app/user/partials/_suggested-users-card-472fe0e8.html",controllerAs:"vm",controller:["$q","$scope","Me","User",function(e,t,n,o){const r=this,i=3;let a=e.resolve();function s(){return l().then((function(e){r.users=e}))}function l(){return 0===a.$$state.status?e.reject("Request already pending."):(a=o.suggested({limit:i}).$promise.then((function(e){return e.length?e:o.getRecommendations({limit:i}).$promise})),a.then((function(e){const t=[];return e.filter((function(e){return t.indexOf(e.id)<0&&(t.push(e.id),!0)}))})))}r.$onInit=s,r.refreshWhoToFollow=s,t.$on("$user:relationChanged",(function(e,t){"follow"===t.type&&l().then((function(e){!function(e,t){if(r.users=r.users.filter((function(t){return t.id!==e})),r.users.length>=i)return;const n=t.find((function(e){return!r.users.some((t=>t.id===e.id))}));n&&r.users.push(n)}(t.user.id,e)}))}))}]}),angular.module("bandlab.user").component("userCard",{bindings:{user:"="},templateUrl:"https://www.bandlab.com/web-app/user/partials/_user-card-37f32c05.html",controller:"UserCtrl",controllerAs:"vm"}),angular.module("bandlab.user").directive("userTabs",(function(){return{replace:!0,templateUrl:"https://www.bandlab.com/web-app/user/partials/_user-tabs-7aa664ff.html",controller:["$rootScope","$scope","$state","$stateParams","$transitions",function(e,t,n,o,r){const i=this;i.logFirebaseEvent=function(e){Promise.resolve().then((()=>fv)).then((t=>{let{logEvent:n}=t;n("user_profile_tracks_sort",{type:e})}))},l();const a=r.onSuccess({},(function(){l()})),s=e.$on("$tracks:loaded",(function(e,t){i.tracksLength=t.tracksLength}));function l(){i.isTracks="user.tracks"===n.current.name,i.sort=o.sort||"popular"}t.$on("$destroy",(function(){a(),s()}))}],controllerAs:"vm"}})),angular.module("bandlab.user").directive("userFollow",["$state","Me","UserHelper",function(e,t,n){return{restrict:"A",scope:{user:"=userFollow"},link:function(o,r,i){const[a,s]=r[0].classList.contains("unfollow-text")?["button-dark","button-scd"]:r[0].classList.contains("inline-follow-text")?["text-scd",""]:r[0].classList.contains("user-topbar-follow-button")?["ds-button-secondary","ds-button-primary"]:["button-scd","button-dark"];o.user&&o.user.id!==t.id?(o.$watch("user.followingState",(function(){r.toggleClass(s,!(o.user.isFollower||"ApprovalPending"===o.user.followingState)),r.toggleClass(a,o.user.isFollower||"ApprovalPending"===o.user.followingState),r[0].classList.contains("follow-icon")?o.user.isFollower||"Following"===o.user.followingState?r[0].innerHTML='<svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">\n                  <path fill="currentColor" fill-rule="evenodd" d="M21 9a5 5 0 1 0-10 0 5 5 0 0 0 10 0m-5-3a3 3 0 1 1 0 6 3 3 0 0 1 0-6" clip-rule="evenodd"></path>\n                  <path fill="currentColor" d="M9.2 10.2 4 15.42l-3.7-3.7 1.4-1.42L4 12.6l3.8-3.8zm13.05 10.46A8.8 8.8 0 0 0 16 18c-2.4 0-4.9 1.07-6.24 2.65l-1.52-1.3C10.02 17.26 13.1 16 16 16c2.86 0 5.98 1.31 7.75 3.34z"></path>\n                </svg>':"ApprovalPending"===o.user.followingState?r[0].classList.contains("follow-text")?r[0].innerHTML="Pending":r[0].innerHTML='<svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">\n                    <path d="M7.75 7.44a.94.94 0 111.87 0V9h1.57a.94.94 0 110 1.88h-2.5a.94.94 0 01-.94-.94v-2.5z" fill="#282C32"/>\n                    <path fill-rule="evenodd" clip-rule="evenodd" d="M16.5 9a7.5 7.5 0 10-15 0 7.5 7.5 0 0015 0zM3.44 9a5.55 5.55 0 1111.11 0 5.55 5.55 0 01-11.1 0z" fill="#282C32"/>\n                  </svg>':r[0].classList.contains("follow-text")?r[0].innerHTML="Follow":r[0].innerHTML='<svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">\n                    <path fill="currentColor" fill-rule="evenodd" d="M21 9a5 5 0 1 0-10 0 5 5 0 0 0 10 0m-5-3a3 3 0 1 1 0 6 3 3 0 0 1 0-6M6 13v3H4v-3H1v-2h3V8h2v3h3v2zm16.25 7.66A8.8 8.8 0 0 0 16 18c-2.4 0-4.9 1.07-6.24 2.65l-1.52-1.3C10.02 17.26 13.1 16 16 16c2.86 0 5.98 1.31 7.75 3.34z" clip-rule="evenodd"></path>\n                  </svg>':r[0].classList.contains("follow-icon-text")?r[0].innerHTML='<svg style="margin-right: 8px;" xmlns="http://www.w3.org/2000/svg" width="16" height="17" fill="none">\n              <path fill="#fff" fill-rule="evenodd" d="M14 6.5a3.333 3.333 0 1 0-6.667 0A3.333 3.333 0 0 0 14 6.5Zm-3.333-2a2 2 0 1 1 0 4 2 2 0 0 1 0-4ZM4 9.166v2H2.667v-2h-2V7.833h2v-2H4v2h2v1.333H4ZM14.831 14.272c-.9-1.032-2.597-1.772-4.164-1.772-1.596 0-3.264.714-4.16 1.765l-1.014-.864c1.186-1.393 3.25-2.235 5.174-2.235 1.908 0 3.987.876 5.168 2.229l-1.004.877Z" clip-rule="evenodd"/>\n            </svg>Follow':r[0].classList.contains("unfollow-text")?o.user.isFollower||"Following"===o.user.followingState?r[0].innerHTML="Unfollow":r[0].innerHTML="Unfollowed":o.user.isFollower||"Following"===o.user.followingState?r[0].innerHTML="Following":"ApprovalPending"===o.user.followingState?r[0].innerHTML="Pending":r[0].innerHTML="Follow"})),r.on("click",(()=>{n.toggleFollowUser(o.user,i.eventLabel||_p(e,r))}))):r.remove()}}}]),angular.module("bandlab.user").component("userNavCard",{bindings:{user:"<"},templateUrl:"https://www.bandlab.com/web-app/user/partials/_user-nav-card-d878f459.html",controller:["Me","User",function(e,t){const n=this;n.$onInit=function(){n.user||(n.user=e)},n.getFollowers=function(e){return t.relation(Object.assign(e,{id:n.user.id,rel:"followers"})).$promise},n.getFollowing=function(e){return t.relation(Object.assign(e,{id:n.user.id,rel:"following"})).$promise}}],controllerAs:"vm"}),angular.module("bandlab.user").component("userProfilePopover",{bindings:{user:"<",triggeredFrom:"<"},template:'\n      <div class="popover-content">\n        <user-tile user="vm.user" class="collapse" triggered-from="vm.triggeredFrom">\n          <user-tile-actions></user-tile-actions>\n        </user-tile>\n      </div>\n    ',controllerAs:"vm"}),angular.module("bandlab.user").directive("usersModal",["$q","Me","Modal",function(e,t,n){return{restrict:"A",scope:{usersFn:"=usersModalList",userRole:"=usersModalRole",title:"@usersModalTitle",zeroCaseTitle:"@usersModalZeroCaseTitle",zeroCaseMessage:"@usersModalZeroCaseMessage",hasZeroCaseAction:"@usersModalZeroCaseAction",triggeredFrom:"<usersModalTriggeredFrom"},link:function(o,r){var i,a,s,l,c;function u(){return o.status.infiniteScrollEnded?e.resolve():a=a.then((function(e){return o.status.infiniteScrollEnded=s,o.users.push.apply(o.users,e),l()}))}r.on("click",(function(e){e.stopPropagation(),i=15,c=null,a=null,s=!1,o.users=[],o.loadMore=u,o.status={infiniteScrollEnded:null},new n({id:"usersModal",templateUrl:"https://www.bandlab.com/web-app/user/partials/_users-modal-57d1a6bf.html",contentScope:{title:o.title,users:o.users,loadMore:o.loadMore,me:t,status:o.status,userRole:o.userRole,zeroCaseTitle:o.zeroCaseTitle,zeroCaseMessage:o.zeroCaseMessage,hasZeroCaseAction:o.hasZeroCaseAction,triggeredFrom:o.triggeredFrom}}).show(),l().then(u)})),l=function(){return s?e.resolve([]):(a=o.usersFn({limit:i,after:c}).then((function(e){let{paging:t,data:n}=e;return c=t.cursors?.after,s=!c,n})),a)}}}}]),angular.module("bandlab.user").component("userTile",{bindings:{user:"=",triggeredFrom:"<"},transclude:{actions:"?userTileActions",bottom:"?userTileBottom"},templateUrl:"https://www.bandlab.com/web-app/user/partials/_user-tile-1ef2d0a9.html",controller:"UserCtrl",controllerAs:"vm"}),angular.module("bandlab.user").component("userTileSmall",Object.assign({bindings:{adEventSource:"@",user:"=",userFollowEventLabel:"@",triggeredFrom:"<"},transclude:{actions:"?userTileSmallActions"},templateUrl:"https://www.bandlab.com/web-app/user/partials/_user-tile-small-50c85ab3.html",controllerAs:"vm"},{controller:function(){const e=this;e.onEngagement=function(){e.user.trackingEvents&&Promise.resolve().then((()=>ID)).then((function(t){let{logEvent:n}=t;n(e.user.trackingEvents.engagement,"engagement",e.adEventSource)}))},e.onImpression=function(){e.user.trackingEvents&&Promise.resolve().then((()=>ID)).then((function(t){let{logEvent:n}=t;n(e.user.trackingEvents.impression,"impression",e.adEventSource)}))}}})),angular.module("bandlab.user").factory("Invite",["$http","$resource","$state",function(e,t,n){var o="https://www.bandlab.com/api/v1.3/invites";return t(o,{},{query:{method:"GET",isArray:!0,params:{id:"@id",entity:"users"},transformResponse:[...e.defaults.transformResponse,function(e,t,o){return 200===o?e.data.map((function(e){let t=e.text;return t?(t.includes("<user>")&&(t=t.replace("<user>",`<a href="${n.href("user.feed",{username:e.sender.username})}"><span>`).replace("</user>","</span></a>")),t.includes("<band>")&&(t=t.replace("<band>",`<a href="${n.href("band.feed",{username:e.band.username})}"><span>`).replace("</band>","</span></a>")),t.includes("<community>")&&(t=t.replace("<community>",`<a href="${n.href("community.feed",{username:e.community.username})}"><span>`).replace("</community>","</span></a>")),t.includes("<song>")&&(t=t.replace("<song>","<span>").replace("</song>","</span>")),e.text=t,e):e})):e}],url:"https://www.bandlab.com/api/v1.3/:entity/:id/invites"},get:{method:"GET",params:{id:"@id"},url:`${o}/:id`},remove:{method:"DELETE",params:{id:"@id"},url:`${o}/:id`},save:{method:"POST",isArray:!0,params:{id:"@id"},url:"https://www.bandlab.com/api/v1.3/:rel/:id/invites",transformResponse:[...e.defaults.transformResponse,function(e,t,n){return 403===n&&201===e?.errorCode&&(e.action="invite"),e}]},update:{method:"PUT",params:{id:"@id"},url:`${o}/:id`}})}]),angular.module("bandlab.user").factory("Role",["$http",function(e){return{getUserRole:function(n){let{userId:o,...r}=n;return e({url:`https://www.bandlab.com/api/v1.3/${t(r)}/members/${o}`,method:"GET"}).then((e=>e.data))},removeUserRole:function(n){let{userId:o,...r}=n;return e({url:`https://www.bandlab.com/api/v1.3/${t(r)}/members/${o}`,method:"DELETE"}).then((e=>e.data))},setNotifications:function(n){let{userId:o,settings:r={},...i}=n;return e({url:`https://www.bandlab.com/api/v1.3/${t(i)}/members/${o}`,method:"PATCH",data:r}).then((e=>e.data))},setUserRole:function(n){let{role:o,userId:r,...i}=n;return e({url:`https://www.bandlab.com/api/v1.3/${t(i)}/members/${r}`,method:"PATCH",data:{role:o}}).then((e=>e.data))}};function t(e){let{bandId:t,communityId:n,schoolId:o}=e;return t?`bands/${t}`:n?`communities/${n}`:o?`schools/${o}`:void 0}}]),angular.module("bandlab.user").factory("User",["$cacheFactory","$http","$q","$resource",function(e,t,n,o){var r="https://www.bandlab.com/api/v1.3/users",i=e("FanReach"),a=e("blockedId");return o(r,{},{block:{method:"POST",params:{meId:"@meId",userId:"@userId"},url:`${r}/:meId/blocks/users/:userId`,interceptor:{response:function(e){return a.remove(e.config.url),e}}},blockedId:{method:"GET",params:{meId:"@meId",userId:"@userId"},cache:a,url:`${r}/:meId/blocks/users/:userId`},blocked:{method:"GET",preservePagination:!0,params:{id:"@id",limit:20},url:`${r}/:id/blocks/users`,transformResponse:t.defaults.transformResponse.concat((function(e,t,n){return 200===n&&e.data.forEach((function(e){e.isBlocked=!0})),e}))},checkSubmissionState:{method:"GET",params:{userId:"@userId",opportunityId:"@opportunityId"},url:`${r}/:userId/opportunities/:opportunityId/submissions`},createFanReachDraftEmail:{method:"POST",params:{userId:"@userId"},url:`${r}/:userId/fan-reach/email-drafts`},createTrackPost:{method:"POST",params:{userId:"@userId"},url:`${r}/:userId/track-posts`,cancellable:!0},deactivateFanReach:{method:"DELETE",params:{userId:"@userId"},url:`${r}/:userId/fan-reach/activations`},deleteFanReachDraftEmail:{method:"DELETE",params:{draftId:"@draftId",userId:"@userId"},url:`${r}/:userId/fan-reach/email-drafts/:draftId`},deleteFanReachSubscribers:{method:"DELETE",params:{meId:"@meId"},hasBody:!0,url:`${r}/:meId/fan-reach/subscribers`},deleteProfilePicture:{method:"DELETE",params:{userId:"@userId",pictureId:"@pictureId"},url:"https://www.bandlab.com/api/v1.3/users/:userId/profile-pictures/:pictureId"},follow:{method:"POST",params:{id:"@id"},url:`${r}/:id/followers`},followRequest:{method:"PATCH",params:{id:"@id",followerId:"@followerId"},url:`${r}/:id/followers/:followerId`},fromBand:{method:"GET",params:{bandId:"",limit:50},preservePagination:!0,url:"https://www.bandlab.com/api/v1.3/bands/:bandId/members"},fromCommunity:{method:"GET",params:{communityId:"",limit:10},preservePagination:!0,url:"https://www.bandlab.com/api/v1.3/communities/:communityId/members"},get:{method:"GET",params:{id:"@id"},url:`${r}/:id`},getWithAnalytics:{method:"GET",params:{id:"@id"},url:`${r}/:id`,headers:{"X-Analytics":!0}},getAchievements:{method:"GET",params:{userId:"@userId"},url:`${r}/:userId/achievements`},getCollaborationPreferences:{method:"GET",params:{userId:"@userId"},url:`${r}/:userId/collaboration-preferences`},getCollaborators:{method:"GET",params:{includeOwner:!1,songId:"",limit:10},preservePagination:!0,url:"https://www.bandlab.com/api/v1.3/songs/:songId/collaborators"},getFanReachDraftEmail:{method:"GET",params:{userId:"@userId",draftId:"@draftId"},url:`${r}/:userId/fan-reach/email-drafts/:draftId`},getFanReachIntroMessage:{method:"GET",params:{userId:"@userId"},url:`${r}/:userId/fan-reach/intro-message`},getFanReachStatus:{method:"GET",cache:i,params:{userId:"@userId"},url:`${r}/:userId/fan-reach`},getFanReachStatusUnauthorized:{method:"GET",params:{userId:"@userId"},url:`${r}/:userId/fan-reach/activation-status`},getFanReachSubscriberCount:{method:"GET",params:{id:"@id"},url:`${r}/:id/artist-stats/fan-reach/30-days`},getFanReachSubscribers:{method:"GET",params:{meId:"@meId"},preservePagination:!0,url:`${r}/:meId/fan-reach/subscribers`},getFanReachSubscriptionState:{method:"GET",params:{userId:"@userId",meId:"@meId"},url:`${r}/:userId/fan-reach/fans/:meId`},getMembershipStatus:{method:"GET",params:{userId:"@userId"},url:"https://www.bandlab.com/api/v1.3/users/:userId/membership",interceptor:{request:function(e){return e.params&&(e.fallbackToFree=e.params.fallbackToFree,delete e.params.fallbackToFree),e},responseError:function(e){return e.config?.fallbackToFree?{plan:"Free"}:n.reject(e)},response:function(e){return Promise.resolve().then((()=>tv)).then((function(t){let{setMembership:n}=t;n(e.data)})),e.data}}},getOpportunitiesStatus:{method:"GET",params:{userId:"@userId"},url:"https://www.bandlab.com/api/v1.3/users/:userId/opportunities"},getProfilePictures:{method:"GET",isArray:!0,params:{userId:"@userId"},url:"https://www.bandlab.com/api/v1.3/users/:userId/profile-pictures"},getSubmissionsList:{method:"GET",isArray:!0,params:{userId:"@userId"},url:`${r}/:userId/opportunities/submissions`},getRecommendations:{method:"GET",isArray:!0,params:{limit:20,skills:"all",sort:"random"},url:"https://www.bandlab.com/api/v1.3/recommendations/users"},likersWithCursor:{method:"GET",params:{entityId:"",entity:"revisions",limit:10},preservePagination:!0,url:"https://www.bandlab.com/api/v1.3/:entity/:entityId/likes/users"},postProfilePicture:{method:"POST",url:"https://www.bandlab.com/api/v1.3/users/:userId/profile-pictures"},reactionsWithCursor:{method:"GET",headers:{"x-reactions-enabled":!0},params:{userId:"@userId",entity:"posts",postCompositeId:"@postCompositeId",limit:"@limit",after:"@after"},preservePagination:!0,url:"https://www.bandlab.com/api/v1.3/:entity/:postCompositeId/reactions/users"},postsPlaybackHistory:{method:"GET",params:{id:"@id",limit:50},preservePagination:!0,url:`${r}/:id/posts-playback-history`,transformResponse:[...t.defaults.transformResponse,function(e,t,n){return 200===n&&e.data.forEach((function(e){!function(e,t,n){200===n&&kD(e)}(e.post,0,n)})),e}]},relation:{method:"GET",params:{id:"@id",limit:10},preservePagination:!0,url:`${r}/:id/:rel`},removeFromPostsPlaybackHistory:{method:"DELETE",params:{userId:"@userId",postId:"@postId"},preservePagination:!0,url:`${r}/:userId/playback-history/posts/:postId`},replaceProfilePicture:{method:"PUT",params:{userId:"@userId",pictureId:"@pictureId"},url:"https://www.bandlab.com/api/v1.3/users/:userId/profile-pictures/:pictureId",data:{newPictureId:"@newPictureId"}},sendFanReachEmail:{method:"POST",params:{userId:"@userId"},url:`${r}/:userId/fan-reach/emails`},setProfilePictureAsMain:{method:"PUT",params:{userId:"@userId",pictureId:"@pictureId"},url:"https://www.bandlab.com/api/v1.3/users/:userId/profile-pictures/:pictureId/main"},submitOpportunity:{method:"POST",params:{id:"@id",opportunityId:"@opportunityId",topStreamedSongLink:"@topStreamedSongLink",topViewedMusicVideoLink:"@topViewedMusicVideoLink"},url:`${r}/:id/opportunities/:opportunityId/submissions`},subscribeToFanReach:{method:"POST",params:{userId:"@userId",meId:"@meId"},url:`${r}/:userId/fan-reach/fans/:meId`},subscribeViaLink:{method:"POST",params:{userId:"@userId"},url:`${r}/:userId/fan-reach/subscribe-link/subscribers`,data:{email:"@email"}},suggested:{method:"GET",isArray:!0,params:{limit:20,offset:0},url:`${r}/suggested`},unblock:{method:"DELETE",params:{meId:"@meId",userId:"@userId"},url:`${r}/:meId/blocks/users/:userId`,interceptor:{response:function(e){return a.remove(e.config.url),e}}},unfollow:{method:"DELETE",params:{id:"@id",followerId:"@followerId"},url:`${r}/:id/followers/:followerId`},unsubscribeFromFanReach:{method:"DELETE",params:{userId:"@userId",meId:"@meId"},url:`${r}/:userId/fan-reach/fans/:meId`},update:{method:"PATCH",params:{id:"@id"},url:`${r}/:id`},updateCollaborationPreferences:{method:"PUT",params:{userId:"@userId"},url:`${r}/:userId/collaboration-preferences`},updateFanReachDraftEmail:{method:"PUT",params:{userId:"@userId",draftId:"@draftId"},url:`${r}/:userId/fan-reach/email-drafts/:draftId`},updateFanReachIntroMessage:{method:"PUT",params:{userId:"@userId"},url:`${r}/:userId/fan-reach/intro-message`},videoViews:{method:"POST",params:{videoId:"@videoId"},url:"https://www.bandlab.com/api/v1.3/videos/:videoId/views"}})}]),angular.module("bandlab.user").factory("UserHelper",["$analytics","$q","$rootScope","$timeout","appActions","AppNotifications","authService","ConfirmModal","Me","User",function(e,t,n,o,r,i,a,s,l,c){const u=new WeakMap;return{toggleFollowUser:function(n){let p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!r.checkAllowed("follow"))return t.reject();if(u.has(n))return u.get(n);var m=n.isFollower||"ApprovalPending"===n.followingState||"Following"===n.followingState?"unfollow":"follow";return function(e){return new Promise((function(t,n){if("ApprovalPending"===e.followingState)return new s({confirmLabel:"Remove",contentScope:{title:"Remove your follow request?"},onCancel:function(){n()},onConfirm:function(){t()}}).show();t()}))}(n).then((function(){!function(e){e.isFollower||"None"!==e.followingState?(e.followingState="None",e.isFollower=!1):(e.followingState=e.isPrivate?"ApprovalPending":"Following",e.isFollower=!e.isPrivate),"ApprovalPending"!==e.followingState&&e.counters&&(e.counters.followers+=e.isFollower||"Following"===e.followingState?1:-1)}(n);const r=c[m]({id:n.id,followerId:l.id}).$promise.then((()=>(o((()=>{a.refreshMe()}),1500),e.eventTrack("follow"===m?"Follow":"Unfollow",{category:"User",extra:{following_user_id:n.id,triggered_from:p}}),d(n,m)))).catch((e=>(d(n,m),403===e.status&&"follow"===m&&202!==e.data?.errorCode&&i.addNotification({content:'Following is not allowed for this user. <a target="_blank" rel="noopener" href="https://help.bandlab.com/hc/en-us/articles/360038284894-Why-can-t-I-follow-any-more-users-">Learn More</a>',classList:"alert"}),t.reject(e)))).finally((function(){u.delete(n)}));return u.set(n,r),r})).catch((()=>{}))}};function d(e,t){return o((()=>{}),1e3).then((function(){return c.get({id:e.id}).$promise})).then((o=>{o.isBoosted=e.isBoosted,Object.assign(e,o),n.$broadcast("$user:relationChanged",{type:t,user:e})}))}}]),angular.module("bandlab.user.routes",["ui.router"]).config(["$stateProvider",function(e){e.state("me",{url:"/me",redirectTo:"me.feed"}).state("me.tracks",{url:"/tracks",onEnter:["$state","Me",function(e,t){e.go("user.tracks",{username:t.username},{location:"replace"})}]}).state("me.feed",{onEnter:["$state","Me",function(e,t){e.go("user.feed",{username:t.username},{location:"replace"})}]}).state("userMe",{url:"/users/me",onEnter:["$state","Me",function(e,t){e.go("user.feed",{username:t.username},{location:"replace"})}]}).state("user",{url:"/{username:[a-z0-9][a-z0-9_]{2,19}}",abstract:!0,params:{rewriteTracking:["$stateParams","Me",function(e,t){return n=>{const o=t.isAnonymous()&&Zf;return n.replace(/^\/[a-z0-9][a-z0-9_]{2,19}(($|\/).*)/g,`/${e.username===t.username?"me":"user"}${o?"/promo":""}$1`)}}]},templateUrl:"https://www.bandlab.com/web-app/user/views/user-layout-4a75b16a.html",resolve:{theUser:["$stateParams","User",function(e,t){return t.getWithAnalytics({id:e.username}).$promise}]},onEnter:["$filter","Page","theUser",function(e,t,n){const o=e("bigNumber");var r;t.setMetadata({title:`${n.name} (@${n.username})  BandLab - Make Music Online`,description:`${(e=>{const t=e=>o(e),n=new Intl.PluralRules("en");return{one:`${t(e)} Follower`,other:`${t(e)} Followers`}[n.select(e)]})(n.counters.followers)}, ${r=n.counters.following,{one:`${r} Following`,other:`${r} Following`}[new Intl.PluralRules("en").select(r)]} - ${n.about||`Listen to music from ${n.name} and follow their creative process on BandLab.`}`,image:`${n.picture.url}360x360`,imageHeight:"360",imageWidth:"360",tapBarTitle:n.name})}],onExit:["Page",function(e){e.clearMetadata()}],controller:["$injector","$rootScope","$scope","$state","$timeout","Me","Post","theUser",function(e,t,n,o,r,i,a,s){n.isOwnProfile=s.id===i.id,n.me=i,n.user=s,n.isPrivateHidden=!n.isOwnProfile&&s.isPrivate&&"Following"!==s.followingState,n.logSocialLinkVisit=function(e){i.id!==s.id&&Promise.resolve().then((()=>rb)).then((function(t){let{logSocialLinkVisit:n}=t;n({destination:e,triggeredFrom:_p(o),userId:s.id})}))},n.prependProtocol=eX,n.buttonAnimation=function(){if(!s.isFollower&&s.fanReach.permissions.becomeFan){n.buttonAnimationIsActive=!0;const e=document.getElementById("user-topbar-follow-placeholder");r((function(){e.classList.add("user-topbar-button-fadeout")}),300),r((function(){n.buttonAnimationIsActive=!1}),1200)}},n.buttonAnimationIsActive=!1,n.$on("$user:relationChanged",(function(e,o){n.user.id===o.user.id&&(Object.assign(n.user,o.user),n.isPrivateHidden=n.user.isPrivate&&"Following"!==n.user.followingState,t.$broadcast("$user:viewProfile",n.user))})),t.$broadcast("$user:viewProfile",n.user),n.$on("$band:changed",(function(){n.user.$get({id:n.user.id})})),Promise.resolve().then((()=>Ap)).then((async function(e){let{getAmplitudeFeatureFlag:t}=e;const o=await t(i,"soundcloud-social-link"),r=await t(i,"tiktok-social-link");"true"!==o&&(delete n.user?.links.soundCloud,delete n.user?.links.soundCloudV2),"true"!==r&&(delete n.user?.links.tikTok,delete n.user?.links.tikTokV2)})),Promise.resolve().then((()=>tv)).then((t=>{let{trackActionsAndPromptTip:o}=t;o(e,n,{user:s})})),s.genres.length&&a.fromRecommendations({userId:i.id,limit:4,genres:s.genres[0].id}).$promise.then((function(e){let{data:t}=e;n.recommendedPosts=t.filter((e=>e.creator.id!==s.id)).slice(0,3)}))}]}).state("user.feed",{url:"?followers&following",params:{triggeredFrom:null},views:{content:{templateUrl:"https://www.bandlab.com/web-app/user/views/user-feed-4c465b2b.html",controller:["$location","$q","$scope","$state","$timeout","AppNotifications","Me","PlayerHistory","Post","theUser",function(e,t,n,o,r,i,a,s,l,c){var u,d=5,p=null,m=!1,f=e.url();function h(){return m?t.resolve([]):u=l.fromUser({userId:n.user.id,after:p,limit:d}).$promise.then((function(e){return m=e.data.length<d,p=_.get(e,"paging.cursors.after",0),e.data})).catch((function(e){403===e?.data?.errorCode&&(n.infiniteScrollEnded=!0,o.reload(),i.addNotification({content:e.data.message,classList:"alert",autoclose:5e3}))}))}function g(){return n.infiniteScrollEnded?t.resolve():u=u.then((function(e){n.infiniteScrollEnded=m,n.posts=n.posts||[];const t=e.filter((e=>!e.isPinned)),o=e.filter((e=>e.isPinned));return n.posts=n.posts.concat(t),n.pinned=n.pinned||o,s.pushQueueSongs([...o,...t],f),h()}))}n.loadMore=g,n.me=a,n.onPostCreate=function(e){n.posts.unshift(e)},s.setCurrentPageContext({contentSource:"user_profile",loader:g,url:f}),o.params.triggeredFrom&&a.id!==c.id&&Kv(c,o.params.triggeredFrom),l.getTracksFromUserSorted({userId:c.id,limit:20,sort:"popular"}).$promise.then((function(e){n.userPopularTracks=e.data,n.topPopularTracksQueueContext=ad(),s.pushQueueSongs(n.userPopularTracks,n.topPopularTracksQueueContext,!0),n.$on("$destroy",(()=>s.removeQueueContext(n.topPopularTracksQueueContext)))})),h().then(n.loadMore),Promise.resolve().then((()=>Ap)).then((async function(e){let{getAmplitudeFeatureFlag:t}=e;const o=await t(a,"top_popular_tracks_profile_enabled");n.topPopularTracksProfileEnabled="true"===o})),n.$on("$revision:changed",(function(e,t){"unpublish"===t.action?n.pinned.length&&Gf(n.pinned,(function(e){return e.revision&&e.revision.id===t.revision.id})):"create"===t.action&&t.revision.isPublic&&l.get({id:t.revision.postId}).$promise.then((function(e){n.posts.unshift(e)}))})),n.$on("$post:pin",(function(e,t){let{post:i}=t;_.find(n.posts,{id:i.id})&&r((()=>o.reload("user.feed")),1e3)})),n.$on("$post:repost",(function(){c.id===a.id&&r((()=>o.reload("user.feed")),1e3)})),n.$on("$post:unpin",(function(e,t){let{post:i}=t;_.find(n.pinned,{id:i.id})&&r((()=>o.reload("user.feed")),1e3)})),n.$on("$post:delete",(function(e,t){Gf(n.posts,(function(e){return e.id===t.post.id})),n.pinned.length&&Gf(n.pinned,(function(e){return e.id===t.post.id}))})),n.$on("$albumTrack:changed",(function(e,t){const o=n.userPopularTracks.find((e=>e.revision.id===t.id));o.caption=t.caption,o.track=t.track,o.revision.track=t.track,o.isExplicit=t.isExplicit,o.state=t.state}))}]}}}).state("user.feed.shout",{url:"/shout?postId",reloadOnSearch:!1,resolve:{thePost:["$stateParams","Post",function(e,t){return t.get({id:e.postId}).$promise}]},onEnter:DL,onExit:jL,views:{"overlay@":{templateUrl:"https://www.bandlab.com/web-app/shout/views/shout-image-view-922d75e9.html",controller:["$scope","$state","thePost","Me",function(e,t,n,o){e.post=n,e.$on("$post:delete",(function(e,r){n.id===r.post.id&&t.go("user.feed",{username:o.username})})),e.$on("$user:relationChanged",(function(e,o){"block"===o.type&&n.creator.id===o.user.id&&t.go("^")})),e.updateCounter=function(t){e.post.counters.comments=t(e.post.counters.comments)}}]}}}).state("user.tracks",{url:"/tracks?sort",views:{content:{templateUrl:"https://www.bandlab.com/web-app/user/views/user-tracks-726f4548.html",controller:["$location","$q","$rootScope","$scope","$state","$stateParams","AppNotifications","Me","PlayerHistory","Post",function(e,t,n,o,r,i,a,s,l,c){var u,d=20,p=null,m=!1,f=e.url();function h(){return m?t.resolve([]):u=c.getTracksFromUserSorted({userId:o.user.id,after:p,limit:d,sort:i.sort}).$promise.then((function(e){return m=e.data.length<d,p=_.get(e,"paging.cursors.after",0),n.$broadcast("$tracks:loaded",{tracksLength:e.data.length}),e.data})).catch((function(e){403===e?.data?.errorCode&&(o.infiniteScrollEnded=!0,r.reload(),a.addNotification({content:e.data.message,classList:"alert",autoclose:5e3}))}))}function g(){return o.infiniteScrollEnded?t.resolve():u=u.then((function(e){return o.infiniteScrollEnded=m,o.posts=o.posts||[],o.posts=o.posts.concat(e),l.pushQueueSongs(e,f),h()}))}o.loadMore=g,o.me=s,l.setCurrentPageContext({loader:g,url:f}),o.$on("$albumTrack:changed",(function(e,t){const n=o.posts.find((e=>e.revision.id===t.id));n.caption=t.caption,n.track=t.track,n.revision.track=t.track,n.isExplicit=t.isExplicit,n.state=t.state})),h().then(o.loadMore),o.$on("$revision:changed",(function(e,t){"unpublish"===t.action?Gf(o.posts,(function(e){return e.revision&&e.revision.id===t.revision.id})):"create"===t.action&&t.revision.isPublic&&c.get({id:t.revision.postId}).$promise.then((function(e){o.posts.unshift(e)}))}))}]}}}).state("user.videos",{url:"/videos",views:{content:{template:'<div id="vue"></div>',controller:["$element","$scope","$injector","theUser",function(e,t,n,o){const r=import("./chunk-fca83891.js").then((function(t){let{mountUserVideos:r}=t;return r(e[0].querySelector("#vue"),{$injector:n,theUser:o})}));t.$on("$destroy",(async function(){(await r).unmount()}))}]}}}).state("user.bands",{url:"/bands",views:{content:{templateUrl:"https://www.bandlab.com/web-app/user/views/user-bands-569315d0.html",controller:"UserBandsCtrl"}}}).state("user.collections",{url:"/collections",views:{content:{templateUrl:"https://www.bandlab.com/web-app/user/views/user-collections-5ab2ee0c.html",controller:"UserCollectionsCtrl"}}}).state("user.albums",{url:"/albums",views:{content:{templateUrl:"https://www.bandlab.com/web-app/user/views/user-albums-a6e4ebca.html",controller:"UserAlbumsCtrl"}}}).state("user.likedPosts",{url:"/likes/posts",resolve:{canAccess:["$q","Me","theUser",function(e,t,n){return e((function(e,o){t.id===n.id?e(!0):o({status:403})}))}]},views:{content:{templateUrl:"https://www.bandlab.com/web-app/user/views/user-likes-posts-bce0d1c7.html",controller:["$location","$q","$scope","PlayerHistory","Post",function(e,t,n,o,r){var i,a=5,s=null,l=!1,c=e.url();function u(){return l?t.resolve([]):i=r.liked({userId:n.user.id,after:s,limit:a}).$promise.then((function(e){return l=e.data.length<a,s=_.get(e,"paging.cursors.after",0),e.data}))}function d(){return n.infiniteScrollEnded?t.resolve():i=i.then((function(e){return n.infiniteScrollEnded=l,n.posts=n.posts||[],n.posts=n.posts.concat(e),o.pushQueueSongs(e,c),u()}))}n.loadMore=d,o.setCurrentPageContext({loader:d,url:c}),u().then(n.loadMore)}]}}}).state("user.likedPosts.shout",{url:"/shout?postId",reloadOnSearch:!1,resolve:{thePost:["$stateParams","Post",function(e,t){return t.get({id:e.postId}).$promise}]},onEnter:DL,onExit:jL,views:{"overlay@":{templateUrl:"https://www.bandlab.com/web-app/shout/views/shout-image-view-922d75e9.html",controller:["$scope","$state","thePost","Me",function(e,t,n,o){e.post=n,e.$on("$post:delete",(function(e,r){n.id===r.post.id&&t.go("user.likedPosts",{username:o.username})})),e.$on("$user:relationChanged",(function(e,o){"block"===o.type&&n.creator.id===o.user.id&&t.go("^")})),e.updateCounter=function(t){e.post.counters.comments=t(e.post.counters.comments)}}]}}})}]),window.Sentry={onLoad:()=>{}},Math.random()<=.1&&!navigator.userAgent.includes("Edge/")&&!navigator.userAgent.includes("prerender")&&!navigator.userAgent.includes("PlayStation")&&"file:"!==window.location.protocol&&hp.get("allowSentry").then((function(){return xc("https://js.sentry-cdn.com/b0afa098ef574589a68db1157c1baba4.min.js")})).then((function(){Sentry.forceLoad(),Sentry.onLoad((function(){Sentry.init({environment:"production",release:"10.1.47",denyUrls:[/i18n\/pixel\//,/ads\/pixel\.js/,/analytics\.js/,/pagead\/viewthroughconversion\//,/recaptcha\//],ignoreErrors:[/.ru\//,/\$templateRequest:tpload/,/\[object Event\]/,/^No error$/,/__show__deepen/,/_avast_submit/,/AbortError: The operation was aborted/,/Access is denied/,/anonymous function: captureException/,/Blocked a frame with origin/,/can't redefine non-configurable property "userAgent"/,/change_ua/,/console is not defined/,/cordova/,/DataCloneError/,/dynamically imported module/,/Error: AccessDeny/,/event is not defined/,/Failed to fetch/,/feedConf/,/Firebase Installation/,/ibFindAllVideos/,/Illegal invocation/,/Importing a module script failed/,/Importing a module script is canceled/,/myGloFrameList/,/MyIPhoneApp/,/NetworkError/,/NotAllowedError/,/Resource blocked by content blocker/,/promise rejection/,/QuotaExceededError/,/Remote Config/,/safari-extension/,/Script error/,/SecurityError/,/ServiceWorker/,/SystemJS/,/snapchat.com/,/Unexpected end of script/,/Unexpected number/,/Unexpected token/,/UnhandledRejection/,/vid_mate_check is not defined/,/win\.document\.body/,/window\._sharedData\.entry_data/,/window\.regainData/,/zaloJSV2/,/ztePageScrollModule/]})}))}));export{dd as $,ss as A,Mb as B,_i as C,Yv as D,_g as E,ti as F,zn as G,Gt as H,rd as I,Cn as J,wa as K,tU as L,ld as M,ib as N,vo as O,Ig as P,UA as Q,FW as R,DA as S,wr as T,Lr as U,uo as V,Hg as W,Gg as X,Ng as Y,wo as Z,Dd as _,Op as a,AE as a$,md as a0,yg as a1,wg as a2,l as a3,ao as a4,Pg as a5,Ci as a6,EJ as a7,Uu as a8,lh as a9,RF as aA,VF as aB,WF as aC,BF as aD,HF as aE,JS as aF,Mt as aG,Nl as aH,As as aI,qS as aJ,Ul as aK,gR as aL,UC as aM,BC as aN,CC as aO,NC as aP,zC as aQ,xC as aR,AC as aS,FC as aT,EC as aU,RC as aV,Rj as aW,cb as aX,mb as aY,xI as aZ,DI as a_,hu as aa,vu as ab,co as ac,bu as ad,yu as ae,wu as af,$u as ag,qd as ah,Si as ai,lu as aj,Fh as ak,Uh as al,Zf as am,Qf as an,gV as ao,vV as ap,p as aq,yI as ar,AF as as,TF as at,OF as au,DF as av,qF as aw,GF as ax,EF as ay,IF as az,zI as b,uh as b$,bI as b0,YS as b1,bl as b2,DS as b3,ZY as b4,Wt as b5,xS as b6,LS as b7,KY as b8,kb as b9,Et as bA,ye as bB,we as bC,Kt as bD,Xo as bE,hn as bF,Ct as bG,xi as bH,_o as bI,se as bJ,wi as bK,Md as bL,hd as bM,os as bN,uu as bO,oS as bP,QW as bQ,Ss as bR,H$ as bS,u$ as bT,cC as bU,dC as bV,mV as bW,fV as bX,Bd as bY,sV as bZ,cu as b_,ql as ba,pI as bb,hT as bc,gI as bd,vI as be,Po as bf,Lb as bg,wI as bh,mT as bi,mI as bj,Ar as bk,Vs as bl,hI as bm,gf as bn,Mv as bo,Pv as bp,ad as bq,Ao as br,Ja as bs,en as bt,c$ as bu,s$ as bv,l$ as bw,ay as bx,na as by,qt as bz,dx as c,hs as c$,Tx as c0,qh as c1,Oh as c2,zh as c3,Sh as c4,Iv as c5,su as c6,Kh as c7,eL as c8,Rv as c9,AS as cA,RS as cB,JT as cC,WT as cD,cB as cE,ml as cF,Ls as cG,Os as cH,_s as cI,Ts as cJ,gs as cK,pl as cL,fl as cM,xs as cN,vs as cO,kL as cP,_L as cQ,SL as cR,$L as cS,wL as cT,TL as cU,gu as cV,Ps as cW,Cs as cX,ks as cY,nh as cZ,Ld as c_,mu as ca,ih as cb,rh as cc,e as cd,t as ce,Ac as cf,Lx as cg,Ox as ch,Ax as ci,Jf as cj,gJ as ck,yJ as cl,CS as cm,s as cn,fL as co,vg as cp,Ya as cq,Qa as cr,cs,Ns as ct,tS as cu,Xt as cv,m$ as cw,a$ as cx,BS as cy,WS as cz,Vf as d,qg as d$,js as d0,Ds as d1,SC as d2,bC as d3,HS as d4,gC as d5,GS as d6,wC as d7,vC as d8,pC as d9,pj as dA,fj as dB,Dh as dC,JO as dD,z$ as dE,dj as dF,wj as dG,ui as dH,NB as dI,DL as dJ,sD as dK,au as dL,Mh as dM,Th as dN,DY as dO,eg as dP,kg as dQ,Sg as dR,Ba as dS,bd as dT,kd as dU,gv as dV,zg as dW,Vg as dX,RD as dY,Wg as dZ,xG as d_,nS as da,DP as db,lj as dc,cj as dd,hj as de,gj as df,Uv as dg,VA as dh,KO as di,YO as dj,QO as dk,ZO as dl,HO as dm,GO as dn,Nb as dp,FA as dq,HA as dr,XO as ds,yj as dt,oj as du,zO as dv,qO as dw,uj as dx,mj as dy,Ov as dz,pi as e,hk as e$,NU as e0,zA as e1,JD as e2,XD as e3,Yk as e4,Fj as e5,WA as e6,Gf as e7,ZN as e8,JG as e9,NN as eA,XU as eB,pF as eC,$N as eD,kN as eE,TN as eF,KA as eG,iU as eH,wN as eI,Yf as eJ,vG as eK,AW as eL,MF as eM,Al as eN,xl as eO,Ll as eP,Ol as eQ,n as eR,EA as eS,IA as eT,vA as eU,dA as eV,RA as eW,nC as eX,ms as eY,kF as eZ,_F as e_,tN as ea,Zb as eb,Qb as ec,ey as ed,bG as ee,yG as ef,m as eg,Og as eh,Qg as ei,Lg as ej,Fu as ek,gG as el,Zg as em,Fg as en,Ug as eo,Rg as ep,xg as eq,Bg as er,ZU as es,aF as et,sF as eu,uF as ev,dF as ew,GU as ex,KU as ey,DN as ez,bi as f,kx as f$,qj as f0,SF as f1,bF as f2,Xf as f3,yF as f4,Ys as f5,Js as f6,Ks as f7,Zs as f8,Qs as f9,Fs as fA,UT as fB,UB as fC,XA as fD,al as fE,FB as fF,HB as fG,BB as fH,NS as fI,Wu as fJ,Nh as fK,Vh as fL,Ah as fM,zs as fN,Uc as fO,Bh as fP,Qx as fQ,Ex as fR,Dx as fS,Vx as fT,Bx as fU,Cx as fV,hL as fW,t_ as fX,sL as fY,Kx as fZ,yx as f_,Xs as fa,xT as fb,ys as fc,vJ as fd,JL as fe,nd as ff,Sq as fg,b$ as fh,v$ as fi,I$ as fj,E$ as fk,pS as fl,mS as fm,A$ as fn,hS as fo,x$ as fp,vS as fq,KS as fr,xq as fs,Lq as ft,Pq as fu,Fq as fv,Yn as fw,BA as fx,tC as fy,qT as fz,yi as g,vB as g$,fx as g0,hx as g1,Px as g2,Sx as g3,Yx as g4,oC as g5,bz as g6,vz as g7,gz as g8,hz as g9,Tz as gA,Nz as gB,Cz as gC,Jq as gD,kz as gE,$z as gF,Sz as gG,_z as gH,Mz as gI,Pz as gJ,Dz as gK,cl as gL,sl as gM,ll as gN,rC as gO,YW as gP,qA as gQ,Tv as gR,cI as gS,Rp as gT,xA as gU,Ro as gV,Cv as gW,Vk as gX,Mg as gY,dB as gZ,CB as g_,fz as ga,mz as gb,iz as gc,lz as gd,az as ge,yz as gf,dz as gg,uz as gh,cz as gi,pz as gj,sz as gk,rz as gl,oz as gm,nz as gn,ez as go,Qq as gp,Zq as gq,Xq as gr,wz as gs,tz as gt,Oz as gu,Wz as gv,Uz as gw,Lz as gx,Vz as gy,jz as gz,mi as h,jL as h$,gB as h0,$B as h1,QF as h2,XF as h3,sB as h4,tB as h5,fB as h6,hB as h7,bB as h8,Rl as h9,oV as hA,aC as hB,TS as hC,r$ as hD,i$ as hE,o$ as hF,bw as hG,tg as hH,hG as hI,pK as hJ,Wv as hK,rF as hL,QU as hM,_K as hN,xN as hO,ON as hP,LN as hQ,cF as hR,UN as hS,AN as hT,RN as hU,JU as hV,oF as hW,YU as hX,io as hY,Vv as hZ,FN as h_,uB as ha,kB as hb,Eu as hc,QD as hd,$J as he,rN as hf,oN as hg,jY as hh,OY as hi,PD as hj,Sv as hk,eF as hl,Qh as hm,tV as hn,ly as ho,CK as hp,eb as hq,tb as hr,nb as hs,jt as ht,LA as hu,bS as hv,wS as hw,Ib as hx,jG as hy,uC as hz,im as i,jq as i$,iF as i0,FY as i1,tF as i2,gK as i3,nF as i4,Bv as i5,vj as i6,NA as i7,DG as i8,HW as i9,_S as iA,Gk as iB,Hk as iC,Zk as iD,Es as iE,S$ as iF,fs as iG,qk as iH,Kk as iI,so as iJ,h$ as iK,dS as iL,fS as iM,$q as iN,jA as iO,Xw as iP,T$ as iQ,Gh as iR,ho as iS,kD as iT,Lv as iU,fI as iV,yL as iW,wx as iX,$x as iY,Za as iZ,dk as i_,VW as ia,YA as ib,vH as ic,Av as id,_p as ie,aS as ig,sS as ih,yS as ii,sk as ij,dV as ik,wq as il,Nk as im,kS as io,Oo as ip,SS as iq,hV as ir,yq as is,eh as it,nJ as iu,w$ as iv,zk as iw,Jr as ix,j$ as iy,Hz as iz,ki as j,NI as j$,Cq as j0,Oq as j1,Iq as j2,Xn as j3,Uq as j4,Nq as j5,Uk as j6,Eq as j7,Zn as j8,Tq as j9,pd as jA,fd as jB,yd as jC,Sd as jD,Od as jE,Nd as jF,Wd as jG,zd as jH,Ap as jI,Tg as jJ,rv as jK,lv as jL,fv as jM,rb as jN,ab as jO,ub as jP,fb as jQ,Sb as jR,Tb as jS,Rb as jT,Ob as jU,Ub as jV,J$ as jW,lk as jX,pk as jY,gk as jZ,LI as j_,Bk as ja,rS as jb,Fk as jc,iS as jd,cS as je,uS as jf,VC as jg,xD as jh,OD as ji,GA as jj,_D as jk,TD as jl,Ij as jm,VO as jn,NT as jo,iC as jp,wk as jq,f$ as jr,eS as js,lS as jt,_$ as ju,P$ as jv,_q as jw,Hd as jx,gS as jy,M$ as jz,Gi as k,AA as k0,vL as k1,Aj as k2,Nj as k3,Bj as k4,zj as k5,lD as k6,ID as k7,QN as k8,aU as k9,UU as ka,_B as kb,xW as kc,BW as kd,qW as ke,JW as kf,eV as kg,nV as kh,rV as ki,lV as kj,pV as kk,XG as kl,tK as km,mK as kn,vK as ko,$K as kp,PK as kq,EK as kr,xK as ks,LY as kt,YY as ku,QY as kv,oJ as kw,yo as l,ps as m,ae as n,si as o,Ki as p,xc as q,So as r,Vn as s,me as t,Zo as u,Vt as v,Tn as w,Mp as x,Kg as y,te as z};
//# sourceMappingURL=bootstrap-3e4029b0.js.map
